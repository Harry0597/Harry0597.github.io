<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/ico" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/hackerrank.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harry0597.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="â€œåŒ•é¦–åæ¡ï¼Œæ€æ­»æ‡’æƒ°â€ï¼Œè¿™é‡Œæ˜¯è‡ª2022å¹´1æœˆ5æ—¥å¼€å§‹çš„æ¯æ—¥è®°å½•ğŸ›">
<meta property="og:type" content="article">
<meta property="og:title" content="å¯’å‡ä¿®ç‚¼è®°ï¼ˆäºŒï¼‰">
<meta property="og:url" content="https://harry0597.com/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/index.html">
<meta property="og:site_name" content="Harry&#39;s Blog">
<meta property="og:description" content="â€œåŒ•é¦–åæ¡ï¼Œæ€æ­»æ‡’æƒ°â€ï¼Œè¿™é‡Œæ˜¯è‡ª2022å¹´1æœˆ5æ—¥å¼€å§‹çš„æ¯æ—¥è®°å½•ğŸ›">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/01/05/OYNIbvuctwnxG75.png">
<meta property="og:image" content="https://s2.loli.net/2022/01/07/TPJt3RyIE4gzN5C.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/9f5f381cfd61460c7f43f2e945e6ad89.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200725123733532.png">
<meta property="og:image" content="https://s2.loli.net/2022/01/12/mYJrT2woEeVjf1W.png">
<meta property="og:image" content="https://s2.loli.net/2022/01/13/SwvhZ7cDOLHtesE.png">
<meta property="og:image" content="https://s2.loli.net/2022/01/13/lhSzUnIQe7TVigO.png">
<meta property="article:published_time" content="2021-12-30T06:15:14.000Z">
<meta property="article:modified_time" content="2022-08-15T10:32:05.530Z">
<meta property="article:author" content="Harry0597">
<meta property="article:tag" content="æ‚">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/01/05/OYNIbvuctwnxG75.png">

<link rel="canonical" href="https://harry0597.com/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>å¯’å‡ä¿®ç‚¼è®°ï¼ˆäºŒï¼‰ | Harry's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Harry's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">æ¸©æ•…çŸ¥æ–°</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Harry0597" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://harry0597.com/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/IMG_2550.JPG">
      <meta itemprop="name" content="Harry0597">
      <meta itemprop="description" content="Pondering'll do you wonders.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Harry's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          å¯’å‡ä¿®ç‚¼è®°ï¼ˆäºŒï¼‰
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-12-30 14:15:14" itemprop="dateCreated datePublished" datetime="2021-12-30T14:15:14+08:00">2021-12-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-08-15 18:32:05" itemprop="dateModified" datetime="2022-08-15T18:32:05+08:00">2022-08-15</time>
              </span>

          
    <span>&emsp;</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span>
    <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
    <span id="busuanzi_value_page_pv"></span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>102k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1:33</span>
            </span>
            <div class="post-description">â€œåŒ•é¦–åæ¡ï¼Œæ€æ­»æ‡’æƒ°â€ï¼Œè¿™é‡Œæ˜¯è‡ª2022å¹´1æœˆ5æ—¥å¼€å§‹çš„æ¯æ—¥è®°å½•ğŸ›</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="1-5"><a href="#1-5" class="headerlink" title="1.5"></a>1.5</h1><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Dw411f7Ht?p=12&spm_id_from=333.788.b_6d756c74695f70616765.12">è¯¾ç¨‹</a></p>
<h2 id="RSAÂ·dpã€dqæ³„æ¼"><a href="#RSAÂ·dpã€dqæ³„æ¼" class="headerlink" title="RSAÂ·dpã€dqæ³„æ¼"></a>RSAÂ·dpã€dqæ³„æ¼</h2><h3 id="ä»€ä¹ˆæ˜¯dpã€dq"><a href="#ä»€ä¹ˆæ˜¯dpã€dq" class="headerlink" title="ä»€ä¹ˆæ˜¯dpã€dq"></a>ä»€ä¹ˆæ˜¯dpã€dq</h3><blockquote>
<p>dp = d mod (p-1)<br>dq = d mod (q-1)</p>
</blockquote>
<h3 id="é‡è¦ç»“è®º"><a href="#é‡è¦ç»“è®º" class="headerlink" title="é‡è¦ç»“è®º"></a>é‡è¦ç»“è®º</h3><h4 id="å½“m-lt-p-æˆ–-qæ—¶"><a href="#å½“m-lt-p-æˆ–-qæ—¶" class="headerlink" title="å½“m &lt; p æˆ– qæ—¶"></a>å½“m &lt; p æˆ– qæ—¶</h4><p>m&lt;p:</p>
<p>$$ m = c^d \mod p$$   </p>
<p>$$ m = c ^ {dp} \mod p $$</p>
<p>m&lt;q:</p>
<p>$$ m = c^d \mod q$$   </p>
<p>$$ m = c ^ {dp} \mod p $$</p>
<h3 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p><img src="https://s2.loli.net/2022/01/05/OYNIbvuctwnxG75.png" alt="image-20220105105634124"></p>
<h5 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="built_in">pow</span>(c, dp, p)</span><br></pre></td></tr></table></figure>

<h4 id="æ›´ä¸€èˆ¬çš„"><a href="#æ›´ä¸€èˆ¬çš„" class="headerlink" title="æ›´ä¸€èˆ¬çš„"></a>æ›´ä¸€èˆ¬çš„</h4><blockquote>
<p>å·²çŸ¥æ¡ä»¶<br>c = m^e mod n<br>m = c^d mod n<br>Ï•(n)= (pâˆ’1)<em>(qâˆ’1)<br>d</em>eâ‰¡ 1 mod Ï•(n)<br>dp= d mod (pâˆ’1)<br>dq= d mod (qâˆ’1)</p>
<p>m=c^d mod n<br>m=c^d+k*n</p>
<p>å› ä¸º n=p<em>q<br>m=c^d+p</em>q*k</p>
<p>åŒæ—¶å–ä½™qå’Œp</p>
<p>å¼1 m1=c^d mod q<br>å¼1 c^d=kp+m1</p>
<p>å¼2 m2=c^d mod p</p>
<p>å¼1å¸¦å…¥å¼2<br>m2=(kp+m1) mod q</p>
<p>ç­‰å¼ä¸¤è¾¹åŒæ—¶å‡å»m1<br>(m2âˆ’m1)â‰¡kp mod q</p>
<p>å› ä¸ºgcd(p,q)=1<br>æ‰€ä»¥å¯ä»¥æ±‚pçš„é€†å…ƒï¼Œå¾—åˆ°<br>(m2âˆ’m1)*pâˆ’1â‰¡k mod q</p>
<p>å¾—åˆ°å¦‚ä¸‹ä¸¤ä¸ªå¼å­<br>kâ‰¡(m2âˆ’m1)*pâˆ’1 mod q</p>
<p>c^d=kp+m1<br>mâ‰¡c^d mod n</p>
<p>ä¸Šä¸‹ä¸¤ä¸ªå¼å­åˆå¹¶</p>
<p>c^d = ((m2âˆ’m1)*pâˆ’1 mod q)p+m1<br>m â‰¡ c^d mod n</p>
<p>æœ€åå¯ä»¥æœ‰</p>
<p>mâ‰¡(((m2âˆ’m1)*pâˆ’1 mod q)p+m1) mod n</p>
<p>åªå‰©æœ€åä¸€æ­¥äº†</p>
<p>m1â‰¡cd mod q<br>m2â‰¡cd mod p</p>
<p>m1å’Œm2æ€ä¹ˆæ±‚</p>
<p>dâ‰¡dp mod (pâˆ’1)<br>dâ‰¡dq mod (qâˆ’1)</p>
<p>é‚£ä¹ˆåˆ†åˆ«å¸¦å…¥</p>
<p>m1â‰¡cdq mod (qâˆ’1) mod q<br>m2â‰¡cdp mod (pâˆ’1) mod p</p>
<p>è´¹é©¬å°å®šç†å³å‡å¦‚pæ˜¯è´¨æ•°ï¼Œä¸”gcd(a,p)=1<br>a^(pâˆ’1)â‰¡1 mod p</p>
<p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬æœ‰ç­‰å¼</p>
<p>d=dp+k*(pâˆ’1)</p>
<p>ç›´æ¥å¸¦å…¥<br>m2â‰¡c^dp+k*(pâˆ’1) mod p</p>
<p>è¿™é‡Œçš„æŒ‡æ•°ï¼Œæˆ‘ä»¬æ‹†å¼€ï¼Œä¸º<br>m2â‰¡c^dp<em>ck</em>(pâˆ’1) mod p</p>
<p>ck*(pâˆ’1)â‰¡1 mod p</p>
<p>å› ä¸ºpæ˜¯å¤§ç´ æ•°ï¼Œæ˜¾ç„¶å’Œcäº’ç´ æ‰€ä»¥å¯ä»¥ç›´æ¥å¾—åˆ°<br>m2â‰¡cd^p mod p</p>
<p>é‚£ä¹ˆm1æ ¹æ®å¯¹ç§°æ€§ä¹Ÿå¯ä»¥åŒç†å¾—åˆ°</p>
<p>m1â‰¡cd^q mod q</p>
<p>æ•…æ­¤ï¼Œæˆ‘ä»¬ç°åœ¨æ‹¥æœ‰äº†æ‰€æœ‰æ¡ä»¶ï¼Œä¸‹é¢å½’çº³ä¸€ä¸‹ä¸º</p>
<p>m1â‰¡cd^q mod q<br>m2â‰¡cd^p mod p<br>mâ‰¡(((m2âˆ’m1)*pâˆ’1 mod q)p+m1) mod n </p>
</blockquote>
<h5 id="ä»£ç å®ç°-1"><a href="#ä»£ç å®ç°-1" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">dp,dq,p,q,c</span>):</span></span><br><span class="line">    InvQ = gmpy2.invert(q, p)</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">    mq = <span class="built_in">pow</span>(c, dq, q)</span><br><span class="line">    m = (((mp-mq)*InvQ) % p)*q+mq</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br><span class="line"></span><br><span class="line">p= <span class="number">160332148422085773419118366054725936852233416334843123745197905865814122767542980683547268180832158164485150298039693727719040683372172258525148659296087240380682418673910965969383538696724039000114078510939033236731476700182949760779821042982194738324421029616780752077145649691266297077244661585947836997447</span></span><br><span class="line">q= <span class="number">148424511925430832355285085986622242653116164650119278601839811809456838348201308360579207172541711367335049779204390510911294031319604192881139002646252381246691575112024047502962776542023275076827456857946499013733968522162634588753330857821421229306405469212854327011240808908334404955299250060931240865821</span></span><br><span class="line">dq= <span class="number">46499718919891753512042256824043332562579628188599554881257534157373206051013462063558177543473555667701042801266834703603013397791386747764400964376350060145521940586234916815399419075649204020285050341140996959732454059493770135591854817473937175643058380668604376797759987312600851466228301604453060674993</span></span><br><span class="line">dp= <span class="number">142333710655003285129381975633061553108365353347897720974344479656881847851071160049571693284111493690735707224010091720382284617217647771503015838348510851051285580945849520119912938971503190396671148935203517916795662212439446680229030750273953490024181996476865040448118374338738013091140796970725623029913</span></span><br><span class="line">c= <span class="number">19717919131356145411002342007533511479254120775597684622452661875292805564648015749422307039514664862428413419529876049533096947970606477676695854787457286807502628964582922773374784879459806551819337741730331777937597915727889640104583136339578788518904647309084873362461758500783634423921343109980901514994298280728150961559886893338458119937441920391275957965781890308011172861718172757876950159723089326843019779174406022143147201642738466470809603008292152193968160973116769118512212438656127645018486302418482079051867180606083540035964208124143457540388206274742292869004756069240519187723267661857029470809099</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">decrypt(dp,dq,p,q,c)</span><br></pre></td></tr></table></figure>

<h2 id="RSAÂ·næ˜¯pçš„ræ¬¡æ–¹"><a href="#RSAÂ·næ˜¯pçš„ræ¬¡æ–¹" class="headerlink" title="RSAÂ·næ˜¯pçš„ræ¬¡æ–¹"></a>RSAÂ·næ˜¯pçš„ræ¬¡æ–¹</h2><h3 id="å½“-n-p-r-æ—¶"><a href="#å½“-n-p-r-æ—¶" class="headerlink" title="å½“$ n = p^{r} $æ—¶"></a>å½“$ n = p^{r} $æ—¶</h3><p>$$ phi = p^r - p^{r-1} $$</p>
<p>æ¯”è¾ƒç®€å•ï¼Œåœ¨rsaåŸç†å­¦ä¹ å°±å·²ç»æåŠï¼Œç•¥ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum </span><br><span class="line"><span class="keyword">import</span> gmpy2 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n=<span class="number">23219089633250510580388184338893261190159425274266091829251069678345101374315005119889075848991325948461687799542168350589180122396501651434531030343667226410506241902501479054317717625217008857112114881864252928341340770771920275461651508679148124345837511394681152499950625703121385320234450147885925563601</span> </span><br><span class="line"></span><br><span class="line">e= <span class="number">65537</span> </span><br><span class="line"></span><br><span class="line">c=<span class="number">4777659110099869449331032200405354033599223023041765916601886190091487314989244505694085724093454432510462782520998688417537643026221506529296297782026160739262075190691284018675189858368054339063575534858807322887095235742287437139426799368719305846674897884286541494038433345483824310623372192122891409065</span> <span class="comment">#åˆ†è§£n #yafu-x64.exe factor() </span></span><br><span class="line"></span><br><span class="line">p=<span class="number">69416273731307471601239913553838998413594935515871627319658832112504691596643</span> </span><br><span class="line"></span><br><span class="line">phi_n=p**<span class="number">4</span>-p**<span class="number">3</span></span><br><span class="line">d=libnum.invmod(e,phi_n) </span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure>

<h3 id="å½“-n-p-r-Â·q-s-æ—¶"><a href="#å½“-n-p-r-Â·q-s-æ—¶" class="headerlink" title="å½“$ n = p^{r}Â·q^{s} $æ—¶"></a>å½“$ n = p^{r}Â·q^{s} $æ—¶</h3><p><a href="https://harry0597.com/2021/12/08/CryptoÂ·RSAåŸç†å­¦ä¹ /">RSAåŸç†å­¦ä¹ ç¯‡</a>ä¸­ï¼Œå·²çŸ¥ï¼š</p>
<blockquote>
<p><em>å¦‚æœnå¯ä»¥åˆ†è§£æˆä¸¤ä¸ª*</em>äº’è´¨<strong>çš„æ•´æ•°ä¹‹ç§¯*ï¼Œ</strong>n = p1 Ã— p2*<em>ï¼Œ</em>åˆ™*ï¼š</p>
<p><strong>Ï†(n) = Ï†(p1p2) = Ï†(p1)Ï†(p2)</strong></p>
</blockquote>
<p>æ‰€ä»¥Ï†(n) =Ï†($p^{r} $)  Â·  Ï†($q^{s} $)</p>
<p>$$ Ï†(n) = (p^{r} - p^{r-1})*(q^{s} - q^{s-1}) $$</p>
<p>é€šå¸¸ä¸ºäº†è®¡ç®—æ–¹ä¾¿ï¼Œå…¬å› å¼æå‡ºæ¥ã€‚</p>
<h4 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><p>$$ n = p^{3}*q $$</p>
<p>æ˜“çŸ¥ï¼š$ Ï†(n) = (p^{3} - p^{2})*(q-1) $</p>
<p>æå…¬å› å¼ $ p^2 $,å¾—ï¼š</p>
<p>$$ Ï†(n) = (p-1)p^{2}(q-1) $$ </p>
<p>ä¹‹åå°±æ˜¯å¸¸è§„çš„æ±‚è§£ï¼Œç•¥ã€‚</p>
<h2 id="RSAÂ·nåˆ†è§£ä¸ºå¤šä¸ªç´ æ•°"><a href="#RSAÂ·nåˆ†è§£ä¸ºå¤šä¸ªç´ æ•°" class="headerlink" title="RSAÂ·nåˆ†è§£ä¸ºå¤šä¸ªç´ æ•°"></a>RSAÂ·nåˆ†è§£ä¸ºå¤šä¸ªç´ æ•°</h2><h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><p>ä¾‹ï¼š n = p* q * r</p>
<p>åˆ™<strong>Ï†(n) = Ï†(pqr) = Ï†(p)Ï†(q)Ï†(r)=(p-1)(q-1)(r-1)</strong></p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><blockquote>
<p><em>å¦‚æœnå¯ä»¥åˆ†è§£æˆä¸¤ä¸ª*</em>äº’è´¨<strong>çš„æ•´æ•°ä¹‹ç§¯*ï¼Œ</strong>n = p1 Ã— p2<strong>ï¼Œ<em>åˆ™</em>ï¼š<br> **Ï†(n) = Ï†(p1p2) = Ï†(p1)Ï†(p2)</strong></p>
</blockquote>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="comment">#ç”Ÿæˆéšæœºç´ æ•°</span></span><br><span class="line">p=libnum.generate_prime(<span class="number">32</span>)</span><br><span class="line">q=libnum.generate_prime(<span class="number">32</span>)</span><br><span class="line">r=libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">m=<span class="string">&quot;flag&#123;20d6e2da95dcc1fa5f5432a436c4be18&#125;&quot;</span></span><br><span class="line"><span class="comment">#å­—ç¬¦ä¸²è½¬æ•°å­—</span></span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q*r</span><br><span class="line">phi_n=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line"><span class="comment">#æ±‚é€†å…ƒ</span></span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;c=&quot;</span>,c)</span><br></pre></td></tr></table></figure>

<h2 id="RSAÂ·eå’Œphiä¸äº’ç´ "><a href="#RSAÂ·eå’Œphiä¸äº’ç´ " class="headerlink" title="RSAÂ·eå’Œphiä¸äº’ç´ "></a>RSAÂ·eå’Œphiä¸äº’ç´ </h2><p>eå’Œphiä¸äº’ç´ ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ã€‚</p>
<p>åœ¨<a href="https://harry0597.com/2021/12/08/CryptoÂ·RSAåŸç†å­¦ä¹ /">rsaåŸç†å­¦ä¹ ç¯‡</a>ä¸­ï¼Œä¹Ÿæœ‰è¯´åˆ°ï¼šeå¾—ä¸phiäº’ç´ </p>
<p>å¦åˆ™,<strong>æ±‚ä¸å‡ºeçš„é€†å…ƒd</strong></p>
<p>æ²¡æœ‰ç§é’¥dï¼Œæ±‚è§£rsaä¾¿æ˜¯æ— ç¨½ä¹‹è°ˆäº†</p>
<h3 id="å¯¹ç­–"><a href="#å¯¹ç­–" class="headerlink" title="å¯¹ç­–"></a>å¯¹ç­–</h3><p>æ€»ä½“è€Œè¨€ï¼Œä¸¤å­—ï¼š<strong>æ„é€ </strong></p>
<ol>
<li><p>å…ˆæ‰¾åˆ°eä¸phiçš„å…¬çº¦æ•°</p>
<p>t1 = gcd(e, phi)</p>
</li>
<li><p>å¾—åˆ°ä¸phiäº’ç´ çš„t2</p>
<p>t2 = e // t1</p>
</li>
<li><p>t1ã€t2ä»£å…¥</p>
<p>$ c = m^{e}modn = (m^{t1})^{t2}modn$</p>
</li>
<li><p>$ m^{t1} $å½“ä½œæ–°çš„æ˜æ–‡Mï¼›t2å½“ä½œæ–°çš„åŠ å¯†æŒ‡æ•°Eï¼Œåˆ™æœ‰ï¼š</p>
<p>$ c = M^{E}modn $</p>
</li>
</ol>
<p>t2(E)ä¸phiäº’ç´ ï¼Œé€šè¿‡æ„é€ ï¼Œé—®é¢˜å·²ç»å˜å¾—å¸¸è§„äº†ã€‚</p>
<p>æœ€åï¼Œå¯¹è§£å‡ºçš„Må¼€t1æ¬¡æ–¹ï¼Œå³å¾—m.</p>
<h3 id="ä»£ç å®ç°-2"><a href="#ä»£ç å®ç°-2" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“eçº¦å»å…¬çº¦æ•°åä¸phiäº’ç´ </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">p, q, e, c</span>):</span></span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    t = gmpy2.gcd(e, phi)</span><br><span class="line">    d = gmpy2.invert(e // t, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    msg = gmpy2.iroot(m, t)</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line">    <span class="keyword">if</span> msg[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(msg[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">p= <span class="number">127577058764408216374028752283743628765651360507566484643526093715329608267323381565274095814069864692746147152580906850350743742856555229701448239882612922698102985146366639955081466129923966803267071097174222576416224094182123529282235807472362341680183683025490897702891081336913842652559163341223338641607</span></span><br><span class="line">q= <span class="number">156492273708587234539506501480609692085997989594717058472605523051244522493701609615085173280972894139427194976925940854142835807192417391269823151398439665817176522629246535810290194301862945052149450578938260979300632842291287807430486629994530805358742405299538986591596966945727494262182814875780600646003</span></span><br><span class="line">e= <span class="number">750</span></span><br><span class="line">c= <span class="number">7029383721249299532521086933490698266831518266762255492452526410777276825803657150303837084263410309063739203644435184397762022380085273363900423091223180151147964276354189658062571415744140073426572149093499560918765793389358300893454490774387180728097370701432534877005948330689495694820361726719418371072834639369078180094444137972424909816959445043108154884587947573054460257114169961823509538355580857411319157089278918107229480661280354242839678709689654304688727345294473487201644985815128413154870914132135222144633969959773621933444285994038028721862094040876152694240238708737727034258171506516394913692187</span></span><br><span class="line"></span><br><span class="line">decrypt(p, q, e, c)</span><br></pre></td></tr></table></figure>



<h2 id="RSAÂ·NCä¸äº’ç´ "><a href="#RSAÂ·NCä¸äº’ç´ " class="headerlink" title="RSAÂ·NCä¸äº’ç´ "></a>RSAÂ·NCä¸äº’ç´ </h2><h3 id="é¢˜å‹"><a href="#é¢˜å‹" class="headerlink" title="é¢˜å‹"></a>é¢˜å‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2021ç»¿åŸæ¯Â·RSA-1</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">M = <span class="number">2021</span> * m * <span class="number">1001</span> * p</span><br><span class="line">c = <span class="built_in">pow</span>(M,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n = 17365231154926348364478276872558492775911760603002394353723603461898405740234715001820111548600914907617003806652492391686710256274156677887101997175692277729648456087534987616743724646598234466094779540729413583826355145277980479040157075453694250572316638348121571218759769533738721506811175866990851972838466307594226293836934116659685215775643285465895317755892754473332034234495795936183610569571016400535362762699517686781602302045048532131426035260878979892169441059467623523060569285570577199236309888155833013721997933960457784653262076135561769838704166810384309655788983073376941843467117256002645962737847</span></span><br><span class="line"><span class="comment">#c = 6944967108815437735428941286784119403138319713455732155925055928646536962597672941805831312130689338014913452081296400272862710447207265099750401657828165836013122848656839100854719965188680097375491193249127725599660383746827031803066026497989298856420216250206035068180963797454792151191071433645946245914916732637007117085199442894495667455544517483404006536607121480678688000420422281380539368519807162175099763891988648117937777951069899975260190018995834904541447562718307433906592021226666885638877020304005614450763081337082838608414756162253825697420493509914578546951634127502393647068722995363753321912676</span></span><br></pre></td></tr></table></figure>

<h3 id="ç»“è®º-1"><a href="#ç»“è®º-1" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><ul>
<li><p>å½“åŠ å¯†æ–¹å¼ä¸ºï¼š</p>
<p>$$ c = (m*p)^{e}modn $$</p>
</li>
<li><p>æœ‰ï¼š<strong>p = gcd(n, c)</strong></p>
<p>å³ï¼š<strong>å½“nï¼Œcä¸äº’ç´ æ—¶ï¼Œå®ƒä»¬çš„æœ€å¤§å…¬çº¦æ•°å¿…ç„¶æ˜¯p</strong></p>
</li>
</ul>
<h3 id="è¯æ˜-1"><a href="#è¯æ˜-1" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><ol>
<li><p>ç”±$ c = (m*p)^{e}modn $ï¼Œå¾—:</p>
<p>c  = $ (m*p)^{e} - kn $</p>
</li>
<li><p>ä¸¤è¾¹åŒæ—¶æ¨¡pï¼Œåˆ™ï¼š</p>
<p>$$ c \mod p = (mâ€¢p)^{e} \mod p = ((mâ€¢p)\mod p)^{e} \mod p  =[(m \mod p)â€¢(p\mod p)]\mod p)^{e}\mod p $$</p>
</li>
<li><p>ç”±$ p \mod p = 0 $ï¼Œå¾—ï¼š</p>
<p>$$ c \mod p = 0$$</p>
<p>å³ï¼š <strong>c = kp</strong></p>
</li>
<li><p>å› ä¸ºn = pqï¼Œæ‰€ä»¥æœ‰ï¼š</p>
<p><strong>gcd(n, c) = p</strong></p>
<h3 id="ä»£ç æ±‚è§£"><a href="#ä»£ç æ±‚è§£" class="headerlink" title="ä»£ç æ±‚è§£"></a>ä»£ç æ±‚è§£</h3></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n = <span class="number">17365231154926348364478276872558492775911760603002394353723603461898405740234715001820111548600914907617003806652492391686710256274156677887101997175692277729648456087534987616743724646598234466094779540729413583826355145277980479040157075453694250572316638348121571218759769533738721506811175866990851972838466307594226293836934116659685215775643285465895317755892754473332034234495795936183610569571016400535362762699517686781602302045048532131426035260878979892169441059467623523060569285570577199236309888155833013721997933960457784653262076135561769838704166810384309655788983073376941843467117256002645962737847</span></span><br><span class="line">c = <span class="number">6944967108815437735428941286784119403138319713455732155925055928646536962597672941805831312130689338014913452081296400272862710447207265099750401657828165836013122848656839100854719965188680097375491193249127725599660383746827031803066026497989298856420216250206035068180963797454792151191071433645946245914916732637007117085199442894495667455544517483404006536607121480678688000420422281380539368519807162175099763891988648117937777951069899975260190018995834904541447562718307433906592021226666885638877020304005614450763081337082838608414756162253825697420493509914578546951634127502393647068722995363753321912676</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p = gmpy2.gcd(n, c)</span><br><span class="line">q = n // p</span><br><span class="line"><span class="keyword">assert</span> n == p * q</span><br><span class="line">phi_n=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi_n)</span><br><span class="line">M=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="comment">#M= 2021 * 1001 * p*m</span></span><br><span class="line">m=M//(<span class="number">2021</span> * <span class="number">1001</span> * p)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h2 id="RSAÂ·rabinç®—æ³•"><a href="#RSAÂ·rabinç®—æ³•" class="headerlink" title="RSAÂ·rabinç®—æ³•"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/Sway_F/article/details/109074460">RSAÂ·rabinç®—æ³•</a></h2><h3 id="ç‰¹å¾"><a href="#ç‰¹å¾" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h3><blockquote>
<p><strong>e = 2</strong> </p>
</blockquote>
<h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><ul>
<li><p>ç›´æ¥ç»™äº†å‚æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">p=<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q=<span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">n=<span class="number">87924348264132406875276140514499937145050893665602592992418171647042491658461</span></span><br><span class="line">e=<span class="number">2</span></span><br><span class="line">c=<span class="number">45617141162985597041928941111553655146539175146765096976546144304138540198644</span></span><br><span class="line">inv_p = invert(p, q)</span><br><span class="line">inv_q = invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="comment">#å› ä¸ºrabin åŠ å¯†æœ‰å››ç§ç»“æœï¼Œå…¨éƒ¨åˆ—å‡ºã€‚</span></span><br><span class="line">aa=[a,b,c,d]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(i)))</span><br></pre></td></tr></table></figure>




</li>
</ul>
<ul>
<li><p>æ–‡ä»¶å½¢å¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="comment">#å¯¼å…¥å…¬é’¥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pubkey.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    n =key.n</span><br><span class="line">    e =key.e</span><br><span class="line"><span class="comment">#å¯¼å…¥å¯†æ–‡</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c=libnum.s2n(f.read())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="comment">#n åœ¨çº¿åˆ†è§£</span></span><br><span class="line">p=<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q=<span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">inv_p = gmpy2.invert(p, q)</span><br><span class="line">inv_q = gmpy2.invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="comment">#å› ä¸ºrabin åŠ å¯†æœ‰å››ç§ç»“æœï¼Œå…¨éƒ¨åˆ—å‡ºã€‚</span></span><br><span class="line">aa=[a,b,c,d]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(i)))</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h1 id="1-6-1-7"><a href="#1-6-1-7" class="headerlink" title="1.6/1.7"></a>1.6/1.7</h1><blockquote>
<p> ä¸€æœˆå…­æ—¥ï¼Œæ‰¾åˆ°å¹¶å°è¯•æ”¹äº†äº†ç¬¬äºŒå±ŠBMZCTFèµ›çš„é¢˜è§£çš„æ ¼å¼</p>
</blockquote>
<h2 id="Sage"><a href="#Sage" class="headerlink" title="Sage"></a>Sage</h2><h3 id="M1-macOSÂ·Sageå®‰è£…"><a href="#M1-macOSÂ·Sageå®‰è£…" class="headerlink" title="M1 macOSÂ·Sageå®‰è£…"></a>M1 macOSÂ·Sageå®‰è£…</h3><h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><p><a target="_blank" rel="noopener" href="https://blog.slight-wind.com/2021/10/09/install-sagemath-for-apple-silicon-m1/index/">Sageä¸‹è½½å®‰è£…å­¦ä¹ </a></p>
<h4 id="Install-conda"><a href="#Install-conda" class="headerlink" title="Install conda"></a>Install conda</h4><p>å®˜ç½‘ä¸Šæ²¡æœ‰ç›´æ¥ç»™å‡ºM1 Macç‰ˆæœ¬çš„SageMathäºŒè¿›åˆ¶å®‰è£…æ–‡ä»¶ï¼Œä¸è¿‡ç»™å‡ºäº†ä½¿ç”¨condaå®‰è£…Sageçš„æ–¹æ³•ï¼Œå‚è€ƒ<a target="_blank" rel="noopener" href="https://doc.sagemath.org/html/en/installation/conda.html">Install from conda-forge</a>ã€‚</p>
<p>æ‰€ä»¥å¦‚æœè‡ªå·±çš„Macä¸Šè¿˜æ²¡æœ‰å®‰è£…condaçš„è¯ï¼Œå¯ä»¥å…ˆå®‰è£…ä¸€ä¸‹ï¼Œç„¶åä½¿ç”¨condaå®‰è£…SageMathã€‚</p>
<p>é¦–å…ˆä¸‹è½½<a target="_blank" rel="noopener" href="https://downloads.slight-wind.com/SageMath/Apple-Silicon-M1/Miniforge3-MacOSX-arm64.sh">Miniforge3-MacOSX-arm64.sh</a>ï¼Œcdè¿›å…¥<code>Miniforge3-MacOSX-arm64.sh</code>æ‰€åœ¨çš„ç›®å½•ã€‚</p>
<table>
<thead>
<tr>
<th>Mentioned files</th>
<th align="center">-</th>
<th align="center">-</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="http://miniforge3-macosx-arm64.sh/">Miniforge3-MacOSX-arm64.sh</a></td>
<td align="center"><a target="_blank" rel="noopener" href="https://downloads.slight-wind.com/SageMath/Apple-Silicon-M1/Miniforge3-MacOSX-arm64.sh">æœ¬åœ°ä¸‹è½½</a></td>
<td align="center"><a target="_blank" rel="noopener" href="https://share.weiyun.com/BbrjO45U">è…¾è®¯å¾®äº‘</a></td>
</tr>
</tbody></table>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">bash</span> Miniforge<span class="number">3</span>-MacOSX-arm<span class="number">64</span>.sh</span><br></pre></td></tr></table></figure>

<p>æ¥ç€ä¸€è·¯å›è½¦ï¼Œç›´åˆ°ç¡®è®¤æ¡æ¬¾ï¼š</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Do</span> you accept the license terms? [<span class="literal">yes</span>|<span class="literal">no</span>]  </span><br><span class="line">[<span class="literal">no</span>] &gt;&gt;&gt; <span class="literal">yes</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åç¼–è¾‘é…ç½®æ–‡ä»¶<code>vim ~/.zshrc</code>ï¼Œåœ¨æœ€ä¸‹é¢åŠ å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path=(<span class="string">&#x27;/Users/ã€Œè¿™é‡Œæ›¿æ¢æˆMacç”¨æˆ·åã€/miniforge3/bin&#x27;</span> <span class="variable">$path</span>)  </span><br><span class="line"><span class="builtin-name">export</span> PATH</span><br></pre></td></tr></table></figure>

<p>å…ˆæŒ‰<code>esc</code>é”®ï¼Œåè¾“å…¥ <code>wq</code>ä¿å­˜å¹¶é€€å‡ºï¼Œç„¶å<code>source ~/.zshrc</code>ï¼Œ<code>conda info</code>åº”è¯¥å°±å¯ä»¥çœ‹åˆ°äº†ï¼Œåˆ°è¿™é‡Œcondaå®‰è£…å®Œæˆã€‚</p>
<p>åœ¨ç»ˆç«¯è¾“å…¥ä¸‹é¢è¿™äº›ï¼Œç»™condaæ¢åˆ°æ¸…åæºï¼Œè¿™æ ·åœ¨ä½¿ç”¨å›½å†…ç½‘ç»œä¸èµ°ä»£ç†çš„æƒ…å†µä¸‹å®‰è£…ä¸€äº›ä¸œè¥¿å°±æ›´å¿«äº†ï¼š</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>pkgs<span class="regexp">/main/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>pkgs<span class="regexp">/free/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/conda-forge/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/msys2/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/bioconda/</span>  </span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.ustc.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/menpo/</span>  </span><br><span class="line">conda config --set show_channel_urls yes</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¾“å…¥<code>conda config --show | grep https</code>å¯ä»¥çœ‹åˆ°å·²ç»æ›´æ–°æˆåŠŸçš„ä¸Šé¢çš„é“¾æ¥ã€‚</p>
<blockquote>
<p>å¦‚æœæ˜¯ç›´æ¥æ–°å¼€çš„ç»ˆç«¯ï¼Œç›´æ¥è¾“å…¥condaæ˜¯æ²¡æœ‰ååº”çš„ï¼Œéœ€è¦å…ˆ<code>source ~/.zshrc</code>ä¸€ä¸‹ã€‚</p>
</blockquote>
<h4 id="Install-SageMath"><a href="#Install-SageMath" class="headerlink" title="Install SageMath"></a>Install SageMath</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">conda<span class="built_in"> config </span>--append channels conda-forge</span><br><span class="line">conda<span class="built_in"> config </span>--<span class="builtin-name">set</span> channel_priority strict</span><br><span class="line">conda create -n sage sage <span class="attribute">python</span>=3.9</span><br><span class="line"></span><br><span class="line"><span class="comment"># Proceed ([y]/n)? y</span></span><br><span class="line"><span class="comment"># ç„¶åå°±å¼€å§‹ä¸‹è½½å®‰è£…äº†</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="M1-macOSÂ·Sageè¿è¡Œ"><a href="#M1-macOSÂ·Sageè¿è¡Œ" class="headerlink" title="M1 macOSÂ·Sageè¿è¡Œ"></a>M1 macOSÂ·Sageè¿è¡Œ</h3><p>è¿™æ—¶è¾“å…¥<code>conda activate sage</code>ï¼Œç„¶åè¾“å…¥<code>sage</code>å°±å¯ä»¥çœ‹åˆ°sageå¯åŠ¨äº†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>sage xxx.sage</code>æ¥æ‰§è¡Œä¸€ä¸ªsageè„šæœ¬ï¼Œè¿™æ ·å°±æ˜¯å®‰è£…å®Œæˆäº†ã€‚</p>
<blockquote>
<p>æ³¨æ„æ¯æ¬¡å¯åŠ¨éƒ½éœ€è¦å…ˆ<code>conda activate sage</code>è¿›å…¥sageã€‚</p>
</blockquote>
<h4 id="SageÂ·äº¤äº’æ¨¡å¼"><a href="#SageÂ·äº¤äº’æ¨¡å¼" class="headerlink" title="SageÂ·äº¤äº’æ¨¡å¼"></a>SageÂ·äº¤äº’æ¨¡å¼</h4><p><code>conda activate sage</code>åè¾“å…¥<code>sage</code></p>
<h4 id="SageÂ·ç½‘é¡µæ¨¡å¼ï¼ˆæ¨è"><a href="#SageÂ·ç½‘é¡µæ¨¡å¼ï¼ˆæ¨è" class="headerlink" title="SageÂ·ç½‘é¡µæ¨¡å¼ï¼ˆæ¨è"></a>SageÂ·ç½‘é¡µæ¨¡å¼ï¼ˆæ¨è</h4><p><code>conda activate sage</code>åè¾“å…¥<code>sage -n</code></p>
<p><img src="https://s2.loli.net/2022/01/07/TPJt3RyIE4gzN5C.png" alt="image-20220107193401892"></p>
<h2 id="1-8"><a href="#1-8" class="headerlink" title="1.8"></a>1.8</h2><h3 id="mé«˜ä½"><a href="#mé«˜ä½" class="headerlink" title="mé«˜ä½"></a>mé«˜ä½</h3><h3 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phase2</span>(<span class="params">high_m, n, c</span>):</span></span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    m = high_m + x</span><br><span class="line">    M = m((m^<span class="number">3</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(M)))</span><br><span class="line"></span><br><span class="line">n= <span class="number">16375911057984467860173028499662793813198989070891462046702689271326139635781678292779095962528585009670015786235494254339716198163498114440710970519760731615457538963588012609421435357625310123852269659556877780556282784378911243624799312161395869291700339099744622787092292212808041739935363726641015733082591519285930439717736591210957039387077203590963514630879038078615201950805057733038622070074246926048776699133348654093003217709061073510046710565744672093957004519016895478465918909294337641778357708633353664132944153092793959582685432330892190960961439661225639169934805918097911051922729785720701933534021</span></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= <span class="number">175676150266403934024028881165956357569100114594293998449367661494592439256350774016927790942005197030835672661768700955232102741828268826317608643103085037913845664530507219457425306700667637263739558920826441431873842792152100711788904901597274447160613809337879563457097769364821425046114008763402341</span></span><br><span class="line">high_m= <span class="number">56006392793404656900162277604003911130977996870658599363889243117614813715239971694356275604343488512</span></span><br><span class="line"></span><br><span class="line">phase2(high_m, n, c)</span><br></pre></td></tr></table></figure>

<h2 id="pé«˜ä½æ”»å‡»"><a href="#pé«˜ä½æ”»å‡»" class="headerlink" title="pé«˜ä½æ”»å‡»"></a>pé«˜ä½æ”»å‡»</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">22127806011633861727954101002390179580447625543207045612671617864341845851658260004006826435219665722338399712799144283442305160095371386129132285556214330279867129279885732638085139970894386809975772641941102438472230541606849251235636928502018782288977994793382547376630461074356449893196487276906629063423071245785206275636191377977712166746567658967286739276282635616277590864547265366547379387583014365390660407286148179073747800137068237371705680826025177248889969809158386539617738762070772471531610084135064141878988874470291949704156926711239213996266350299670204058121040684469621186909795304289942430452869</span></span><br><span class="line">p4=<span class="number">0xd8bf1376aaae63b3c4d693ca7f3d8a76270b7310bb8bd4608a98c9fdd85fc1ccc7c246b364e2779034057f0ec7a101bad64269d9dcca69f9b5c3462b058b94db0987aa09426c5e7634b3e19f56872693206790c6feef0c9ae662d73f1b12c3cd</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">pbits = <span class="number">1024</span></span><br><span class="line">kbits = pbits - p4.nbits()</span><br><span class="line"><span class="built_in">print</span>(p4.nbits())</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p = p4+<span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;n: &quot;</span>, n)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;p: &quot;</span>, p)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;q: &quot;</span>, n/p)</span><br></pre></td></tr></table></figure>

<h1 id="è‡³ä»Š"><a href="#è‡³ä»Š" class="headerlink" title="è‡³ä»Š"></a>è‡³ä»Š</h1><h2 id="é”®ç›˜ä¹‹äº‰-Â·-84"><a href="#é”®ç›˜ä¹‹äº‰-Â·-84" class="headerlink" title="é”®ç›˜ä¹‹äº‰ Â· 84"></a>é”®ç›˜ä¹‹äº‰ Â· 84</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><blockquote>
<p>ä½ å¬è¯´è¿‡é”®ç›˜ä¹‹äº‰å—ï¼Ÿæäº¤ä½ æ‰¾åˆ°çš„å­—ç¬¦ä¸²md5å€¼ã€‚</p>
<p>ypau_kjg;â€g;â€ypau+</p>
</blockquote>
<p>å¥½çš„ï¼ŒğŸ‘€çœ‹äº†åŠå¤©ï¼Œå•¥ä¹Ÿæ²¡çœ‹å‡ºæ¥</p>
<h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><blockquote>
<p>é”®ç›˜å¸ƒå±€æœ‰qwertyã€dvorakã€colemak<br>æ­¤é¢˜è€ƒå¯Ÿçš„æ˜¯å°†qwertyå¸ƒå±€è½¬ä¸ºdvorak</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9f5f381cfd61460c7f43f2e945e6ad89.png" alt="img"></p>
<h4 id="ä»£ç å®ç°-3"><a href="#ä»£ç å®ç°-3" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">dic=&#123;<span class="string">r&quot;&#x27;&quot;</span>:<span class="string">&quot;q&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;,&quot;</span>:<span class="string">&quot;w&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;.&quot;</span>:<span class="string">&quot;e&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;p&quot;</span>:<span class="string">&quot;4&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;y&quot;</span>:<span class="string">&quot;t&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;f&quot;</span>:<span class="string">&quot;y&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;g&quot;</span>:<span class="string">&quot;u&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;c&quot;</span>:<span class="string">&quot;i&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;r&quot;</span>:<span class="string">&quot;o&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;l&quot;</span>:<span class="string">&quot;p&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;/&quot;</span>:<span class="string">r&quot;[&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;=&quot;</span>:<span class="string">r&quot;]&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&#x27;&quot;&#x27;</span>:<span class="string">&#x27;Q&#x27;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&lt;&quot;</span>:<span class="string">&quot;W&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&gt;&quot;</span>:<span class="string">&quot;E&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;P&quot;</span>:<span class="string">&quot;R&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;Y&quot;</span>:<span class="string">&quot;T&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;F&quot;</span>:<span class="string">&quot;Y&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;G&quot;</span>:<span class="string">&quot;U&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;C&quot;</span>:<span class="string">&quot;I&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;R&quot;</span>:<span class="string">&quot;O&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;L&quot;</span>:<span class="string">&quot;P&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;?&quot;</span>:<span class="string">r&quot;&#123;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;+&quot;</span>:<span class="string">r&quot;&#125;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;a&quot;</span>:<span class="string">&quot;a&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;A&quot;</span>:<span class="string">&quot;A&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;o&quot;</span>:<span class="string">&quot;s&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;O&quot;</span>:<span class="string">&quot;S&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;e&quot;</span>:<span class="string">&quot;d&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;E&quot;</span>:<span class="string">&quot;D&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;u&quot;</span>:<span class="string">&quot;f&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;U&quot;</span>:<span class="string">&quot;F&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;i&quot;</span>:<span class="string">&quot;g&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;I&quot;</span>:<span class="string">&quot;G&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;d&quot;</span>:<span class="string">&quot;h&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;D&quot;</span>:<span class="string">&quot;H&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;h&quot;</span>:<span class="string">&quot;j&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;H&quot;</span>:<span class="string">&quot;J&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;t&quot;</span>:<span class="string">&quot;k&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;T&quot;</span>:<span class="string">&quot;K&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;n&quot;</span>:<span class="string">&quot;l&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;N&quot;</span>:<span class="string">&quot;L&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;s&quot;</span>:<span class="string">&quot;;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;S&quot;</span>:<span class="string">&quot;:&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;-&quot;</span>:<span class="string">r&quot;&#x27;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&#x27;_&#x27;</span>:<span class="string">r&#x27;&quot;&#x27;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;;&quot;</span>:<span class="string">&quot;z&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;:&quot;</span>:<span class="string">&quot;Z&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;q&quot;</span>:<span class="string">&quot;x&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;Q&quot;</span>:<span class="string">&quot;X&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;j&quot;</span>:<span class="string">&quot;c&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;J&quot;</span>:<span class="string">&quot;C&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;k&quot;</span>:<span class="string">&quot;v&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;K&quot;</span>:<span class="string">&quot;V&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;x&quot;</span>:<span class="string">&quot;b&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;X&quot;</span>:<span class="string">&quot;B&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;b&quot;</span>:<span class="string">&quot;n&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;B&quot;</span>:<span class="string">&quot;N&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;m&quot;</span>:<span class="string">&quot;m&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;M&quot;</span>:<span class="string">&quot;M&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;w&quot;</span>:<span class="string">r&quot;,&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;W&quot;</span>:<span class="string">r&quot;&lt;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;v&quot;</span>:<span class="string">r&quot;.&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;V&quot;</span>:<span class="string">r&quot;&gt;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;z&quot;</span>:<span class="string">r&quot;/&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;Z&quot;</span>:<span class="string">r&quot;?&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&#x27;!&#x27;</span>:<span class="string">&quot;!&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;@&quot;</span>:<span class="string">r&quot;@&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;#&quot;</span>:<span class="string">r&quot;#&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;$&quot;</span>:<span class="string">r&quot;$&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;%&quot;</span>:<span class="string">r&quot;%&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;^&quot;</span>:<span class="string">r&quot;^&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&amp;&quot;</span>:<span class="string">r&quot;&amp;&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;*&quot;</span>:<span class="string">r&quot;*&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;(&quot;</span>:<span class="string">r&quot;(&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;)&quot;</span>:<span class="string">r&quot;)&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;[&quot;</span>:<span class="string">r&quot;-&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;]&quot;</span>:<span class="string">r&quot;=&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&#123;&quot;</span>:<span class="string">r&quot;_&quot;</span>,</span><br><span class="line"> </span><br><span class="line"><span class="string">r&quot;&#125;&quot;</span>:<span class="string">r&quot;+&quot;</span>&#125;</span><br><span class="line"> </span><br><span class="line">s=<span class="string">r&#x27;ypau_kjg;&quot;g;&quot;ypau+&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">	<span class="built_in">print</span> (<span class="string">&quot; &quot;</span>.join([key <span class="keyword">for</span> key, value <span class="keyword">in</span> dic.items() <span class="keyword">if</span> value == i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">m = hashlib.md5()</span><br><span class="line"></span><br><span class="line">m.update(*b*<span class="string">&#x27;this_is_flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span> + m.hexdigest() + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="easy-CRC-Â·-92"><a href="#easy-CRC-Â·-92" class="headerlink" title="easy_CRC Â· 92"></a>easy_CRC Â· 92</h2><h3 id="é¢˜ç›®-1"><a href="#é¢˜ç›®-1" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><blockquote>
<p>1:C4E68E3A<br>2:08FF301C<br>3:F6FBA587<br>4:B85C2F9A<br>5:F1B73D20<br>6:C6F1D9D7</p>
<p>flag=1+2+3+4+5+6<br>Each serial number consists of 4 characters</p>
</blockquote>
<h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å·²çŸ¥æ˜æ–‡é•¿åº¦çš„CRCçˆ†ç ´ï¼Œå…·ä½“å­¦ä¹ å¯è§ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/110206427">PythonÂ·CRCçˆ†ç ´å­¦ä¹ </a></p>
<h4 id="ä»£ç -3"><a href="#ä»£ç -3" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># å››å­—èŠ‚çˆ†ç ´</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_crc</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-------------Start Crack CRC-------------&#x27;</span>)</span><br><span class="line">    crc_list = [<span class="number">0xC4E68E3A</span>, <span class="number">0x08FF301C</span>, <span class="number">0xF6FBA587</span>, <span class="number">0xB85C2F9A</span>, <span class="number">0xF1B73D20</span>, <span class="number">0xC6F1D9D7</span>]  <span class="comment"># æ–‡ä»¶çš„CRC32å€¼åˆ—è¡¨ï¼Œæ³¨æ„é¡ºåº</span></span><br><span class="line">    comment = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    chars = string.printable</span><br><span class="line">    <span class="keyword">for</span> crc_value <span class="keyword">in</span> crc_list:</span><br><span class="line">        <span class="keyword">for</span> char1 <span class="keyword">in</span> chars:</span><br><span class="line">            <span class="keyword">for</span> char2 <span class="keyword">in</span> chars:</span><br><span class="line">                <span class="keyword">for</span> char3 <span class="keyword">in</span> chars:</span><br><span class="line">                    <span class="keyword">for</span> char4 <span class="keyword">in</span> chars:</span><br><span class="line">                        res_char = char1 + char2 + char3 + char4<span class="comment">#è·å–éå†çš„ä»»æ„4Byteå­—ç¬¦</span></span><br><span class="line">                        char_crc = binascii.crc32(res_char.encode())<span class="comment">#è·å–éå†å­—ç¬¦çš„CRC32å€¼</span></span><br><span class="line">                        calc_crc = char_crc &amp; <span class="number">0xffffffff</span><span class="comment">#å°†éå†çš„å­—ç¬¦çš„CRC32å€¼ä¸0xffffffffè¿›è¡Œä¸è¿ç®—</span></span><br><span class="line">                        <span class="keyword">if</span> calc_crc == crc_value:<span class="comment">#å°†è·å–å­—ç¬¦çš„CRC32å€¼ä¸æ¯ä¸ªæ–‡ä»¶çš„CRC32å€¼è¿›è¡ŒåŒ¹é…</span></span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&#x27;[+] &#123;&#125;: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(crc_value),res_char))</span><br><span class="line">                            comment += res_char</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-----------CRC Crack Completed-----------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Result: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(comment))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    crack_crc()</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    -------------Start Crack CRC-------------</span></span><br><span class="line"><span class="string">[+] 0xc4e68e3a: b323</span></span><br><span class="line"><span class="string">[+] 0x8ff301c: 1e94</span></span><br><span class="line"><span class="string">[+] 0xf6fba587: f045</span></span><br><span class="line"><span class="string">[+] 0xb85c2f9a: e76e</span></span><br><span class="line"><span class="string">[+] 0xf1b73d20: 5932</span></span><br><span class="line"><span class="string">[+] 0xc6f1d9d7: 66f4</span></span><br><span class="line"><span class="string">-----------CRC Crack Completed-----------</span></span><br><span class="line"><span class="string">Result: b3231e94f045e76e593266f4</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h2 id="rsa-Â·-97"><a href="#rsa-Â·-97" class="headerlink" title="rsa Â· 97"></a>rsa Â· 97</h2><h3 id="é¢˜ç›®-2"><a href="#é¢˜ç›®-2" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><blockquote>
<p>4153372421328787064168548641845708183921443446990158572506114559735441950501706984118235944441928889749083563790293558028143373121367441549974248211570336802004821051820943229232421937298269855190652251294220483768084460779714162849925877879859830009443131489814222929347727735616113359695228615432020363240247474622132986939108457393618346100033147945959684443762976681454755482192433993286205527003029269574787026484389622816932835184754540312561890719407986296481186847292967270288752616</p>
</blockquote>
<h1 id="AFCTF2018-MagicNum"><a href="#AFCTF2018-MagicNum" class="headerlink" title="[AFCTF2018]MagicNum"></a>[AFCTF2018]MagicNum</h1><p><img src="https://img-blog.csdnimg.cn/20200725123733532.png" alt="é¢˜ç›®"></p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">72065910510177138000000000000000.000000</span></span><br><span class="line">c1=<span class="number">0b0110000101100110011000110111010000111101</span>#è¿™é‡ŒæŠŠåé¢çš„<span class="number">0</span>ç»™å»æ‰äº†ï¼Œæœ¬æ¥æœ‰<span class="number">64</span>ä½</span><br><span class="line">#<span class="number">71863209670811371000000.000000</span></span><br><span class="line">c2=<span class="number">0b0110011001111011011100110110010100111101</span></span><br><span class="line">#<span class="number">18489682625412760000000000000000.000000</span></span><br><span class="line">c3=<span class="number">0b0110001101011111011010010111001100111101</span></span><br><span class="line">#<span class="number">72723257588050687000000.000000</span></span><br><span class="line">c4=<span class="number">0b0101111101100101011101100110010100111101</span></span><br><span class="line">#<span class="number">4674659167469766200000000.000000</span></span><br><span class="line">c5=<span class="number">0b0111001001111001011101110110100000111101</span></span><br><span class="line">#<span class="number">19061698837499292000000000000000000000.000000</span></span><br><span class="line">c6=<span class="number">0b0110010101110010011001010111110100111101</span></span><br><span class="line">import binascii</span><br><span class="line">flag=b&#x27;&#x27;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">7</span>):</span><br><span class="line">    s=&#x27;c&#x27;+str(i)</span><br><span class="line">    <span class="built_in">print</span>(binascii.unhexlify(hex(<span class="built_in">eval</span>(s))[<span class="number">2</span>:]))</span><br><span class="line">    flag+=binascii.unhexlify(hex(<span class="built_in">eval</span>(s))[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="AFCTF2018-ä½ å¬è¿‡ä¸€æ¬¡ä¸€å¯†ä¹ˆï¼Ÿ"><a href="#AFCTF2018-ä½ å¬è¿‡ä¸€æ¬¡ä¸€å¯†ä¹ˆï¼Ÿ" class="headerlink" title="[AFCTF2018]ä½ å¬è¿‡ä¸€æ¬¡ä¸€å¯†ä¹ˆï¼Ÿ"></a>[AFCTF2018]ä½ å¬è¿‡ä¸€æ¬¡ä¸€å¯†ä¹ˆï¼Ÿ</h2><h2 id="é¢˜ç›®-3"><a href="#é¢˜ç›®-3" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">25030206463</span>d<span class="number">3</span>d<span class="number">393131555</span>f<span class="number">7</span>f<span class="number">1</span>d<span class="number">061</span>d<span class="number">4052111</span>a<span class="number">19544e2</span>e<span class="number">5</span>d</span><br><span class="line"><span class="number">0</span>f<span class="number">020606150</span>f<span class="number">203</span>f<span class="number">307</span>f<span class="number">5</span><span class="keyword">c</span><span class="number">0</span>a<span class="number">7</span>f<span class="number">24070747130e16545000035</span>d</span><br><span class="line"><span class="number">1203075429152</span>a<span class="number">7020365</span><span class="keyword">c</span><span class="number">167</span>f<span class="number">390</span>f<span class="number">1013170</span>b<span class="number">1006481e1314</span></span><br><span class="line"><span class="number">0</span>f<span class="number">4610170e1</span>e<span class="number">2235787</span>f<span class="number">7853372</span><span class="keyword">c</span><span class="number">0</span>f<span class="number">065752111</span>b<span class="number">15454e0</span>e<span class="number">09</span></span><br><span class="line"><span class="number">081543000e1</span>e<span class="number">6</span>f<span class="number">3</span>f<span class="number">3</span>a<span class="number">3348533</span>a<span class="number">270</span>d<span class="number">064</span>a<span class="number">02111</span>a<span class="number">1</span>b<span class="number">5</span>f<span class="number">4e0</span>a<span class="number">18</span></span><br><span class="line"><span class="number">0909075412132e247436425332281</span>a<span class="number">1</span><span class="keyword">c</span><span class="number">561</span>f<span class="number">04071</span>d<span class="number">520</span>f<span class="number">0</span>b<span class="number">11</span></span><br><span class="line"><span class="number">4116111</span>b<span class="number">101e2170203011113</span>a<span class="number">69001</span>b<span class="number">475206011552050219</span></span><br><span class="line"><span class="number">041006064612297020375453342</span><span class="keyword">c</span><span class="number">17545</span>a<span class="number">01451811411</span>a<span class="number">470</span>e</span><br><span class="line"><span class="number">021311114</span>a<span class="number">5</span>b<span class="number">0335207</span>f<span class="number">7</span><span class="keyword">c</span><span class="number">167</span>f<span class="number">22001</span>b<span class="number">44520</span><span class="keyword">c</span><span class="number">15544801125</span>d</span><br><span class="line"><span class="number">06140611460</span><span class="keyword">c</span><span class="number">26243</span><span class="keyword">c</span><span class="number">7</span>f<span class="number">5</span><span class="keyword">c</span><span class="number">167</span>f<span class="number">3</span>d<span class="number">015446010053005907145</span>d</span><br><span class="line"><span class="number">0</span>f<span class="number">05110</span>d<span class="number">160</span>f<span class="number">263</span>f<span class="number">3</span>a<span class="number">7</span>f<span class="number">4210372</span><span class="keyword">c</span><span class="number">03111313090415481</span>d<span class="number">49</span></span><br></pre></td></tr></table></figure>

<h2 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><ul>
<li><p><strong>ä¸€æ¬¡ä¸€å¯†</strong>ï¼šå¼‚æˆ–åŠ å¯†ã€‚</p>
<blockquote>
<p>å°†æ˜æ–‡åˆ†ç»„ï¼Œä¸å¯†é’¥æŒ‰ä½å¼‚æˆ–å³å¯ã€‚</p>
</blockquote>
</li>
<li><p><strong>æ”»å‡»åŸç†</strong></p>
<p>é¢˜ç›®æ˜¯ç”¨åŒä¸€ä¸ªå¯†é’¥å»åŠ å¯†å¤šæ¡æ˜æ–‡ï¼Œå½“å¯†æ–‡æ¡æ•°è¾ƒå¤šæ—¶å°±å¾ˆå®¹æ˜“è¢«æ”»å‡»ï¼Œä¾‹å¦‚Many Time Padã€‚ </p>
<ul>
<li><p><strong>Many Time Padæ”»å‡»</strong> </p>
<blockquote>
<p>åŸç†:c1âŠ•c2 = m1âŠ•m2.</p>
<p>é€šè¿‡m1âŠ•m2å¯ä»¥åˆ†æå‡ºm1å’Œm2ï¼Œå› æ­¤m1ä¸m2ä¸å†å®‰å…¨ã€‚</p>
</blockquote>
<p>æ³¨ï¼šâŠ•ä¸ºå¼‚æˆ–ç¬¦å·</p>
</li>
</ul>
</li>
</ul>
<h3 id="ä»£ç -4"><a href="#ä»£ç -4" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><ul>
<li><a target="_blank" rel="noopener" href="https://paiza.io/projects/LSykKY75a19pzlH5sAULww?language=python"><strong>åœ¨çº¿Python2</strong></a></li>
</ul>
<p>æ¬è¿è‡ªGithub</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">## OTP - Recovering the private key from a set of messages that were encrypted w/ the same private key (Many time pad attack) - crypto100-many_time_secret @ alexctf 2017</span></span><br><span class="line"><span class="comment"># Original code by jwomers: https://github.com/Jwomers/many-time-pad-attack/blob/master/attack.py)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> sets, sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 11 unknown ciphertexts (in hex format), all encrpyted with the same key</span></span><br><span class="line"></span><br><span class="line">c1=<span class="string">&#x27;25030206463d3d393131555f7f1d061d4052111a19544e2e5d&#x27;</span></span><br><span class="line">c2=<span class="string">&#x27;0f020606150f203f307f5c0a7f24070747130e16545000035d&#x27;</span></span><br><span class="line">c3=<span class="string">&#x27;1203075429152a7020365c167f390f1013170b1006481e1314&#x27;</span></span><br><span class="line">c4=<span class="string">&#x27;0f4610170e1e2235787f7853372c0f065752111b15454e0e09&#x27;</span></span><br><span class="line">c5=<span class="string">&#x27;081543000e1e6f3f3a3348533a270d064a02111a1b5f4e0a18&#x27;</span></span><br><span class="line">c6=<span class="string">&#x27;0909075412132e247436425332281a1c561f04071d520f0b11&#x27;</span></span><br><span class="line">c7=<span class="string">&#x27;4116111b101e2170203011113a69001b475206011552050219&#x27;</span></span><br><span class="line">c8=<span class="string">&#x27;041006064612297020375453342c17545a01451811411a470e&#x27;</span></span><br><span class="line">c9=<span class="string">&#x27;021311114a5b0335207f7c167f22001b44520c15544801125d&#x27;</span></span><br><span class="line">c10=<span class="string">&#x27;06140611460c26243c7f5c167f3d015446010053005907145d&#x27;</span></span><br><span class="line">c11=<span class="string">&#x27;0f05110d160f263f3a7f4210372c03111313090415481d49&#x27;</span></span><br><span class="line">ciphers = [c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11]</span><br><span class="line"><span class="comment"># The target ciphertext we want to crack</span></span><br><span class="line"><span class="comment">#target_cipher = &quot;0529242a631234122d2b36697f13272c207f2021283a6b0c7908&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># XORs two string</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">strxor</span>(<span class="params">a, b</span>):</span>     <span class="comment"># xor two strings (trims the longer input)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(x) ^ <span class="built_in">ord</span>(y)) <span class="keyword">for</span> (x, y) <span class="keyword">in</span> <span class="built_in">zip</span>(a, b)])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">target_fix</span>(<span class="params">target_cipher</span>):</span></span><br><span class="line">    <span class="comment"># To store the final key</span></span><br><span class="line">    final_key = [<span class="literal">None</span>]*<span class="number">150</span></span><br><span class="line">    <span class="comment"># To store the positions we know are broken</span></span><br><span class="line">    known_key_positions = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># For each ciphertext</span></span><br><span class="line">    <span class="keyword">for</span> current_index, ciphertext <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphers):</span><br><span class="line">        counter = collections.Counter()</span><br><span class="line">        <span class="comment"># for each other ciphertext</span></span><br><span class="line">        <span class="keyword">for</span> index, ciphertext2 <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphers):</span><br><span class="line">            <span class="keyword">if</span> current_index != index: <span class="comment"># don&#x27;t xor a ciphertext with itself</span></span><br><span class="line">                <span class="keyword">for</span> indexOfChar, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(strxor(ciphertext.decode(<span class="string">&#x27;hex&#x27;</span>), ciphertext2.decode(<span class="string">&#x27;hex&#x27;</span>))): <span class="comment"># Xor the two ciphertexts</span></span><br><span class="line">                    <span class="comment"># If a character in the xored result is a alphanumeric character, it means there was probably a space character in one of the plaintexts (we don&#x27;t know which one)</span></span><br><span class="line">                    <span class="keyword">if</span> char <span class="keyword">in</span> string.printable <span class="keyword">and</span> char.isalpha(): counter[indexOfChar] += <span class="number">1</span> <span class="comment"># Increment the counter at this index</span></span><br><span class="line">        knownSpaceIndexes = []</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Loop through all positions where a space character was possible in the current_index cipher</span></span><br><span class="line">        <span class="keyword">for</span> ind, val <span class="keyword">in</span> counter.items():</span><br><span class="line">            <span class="comment"># If a space was found at least 7 times at this index out of the 9 possible XORS, then the space character was likely from the current_index cipher!</span></span><br><span class="line">            <span class="keyword">if</span> val &gt;= <span class="number">7</span>: knownSpaceIndexes.append(ind)</span><br><span class="line">        <span class="comment">#print knownSpaceIndexes # Shows all the positions where we now know the key!</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Now Xor the current_index with spaces, and at the knownSpaceIndexes positions we get the key back!</span></span><br><span class="line">        xor_with_spaces = strxor(ciphertext.decode(<span class="string">&#x27;hex&#x27;</span>),<span class="string">&#x27; &#x27;</span>*<span class="number">150</span>)</span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> knownSpaceIndexes:</span><br><span class="line">            <span class="comment"># Store the key&#x27;s value at the correct position</span></span><br><span class="line">            final_key[index] = xor_with_spaces[index].encode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">            <span class="comment"># Record that we known the key at this position</span></span><br><span class="line">            known_key_positions.add(index)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Construct a hex key from the currently known key, adding in &#x27;00&#x27; hex chars where we do not know (to make a complete hex string)</span></span><br><span class="line">    final_key_hex = <span class="string">&#x27;&#x27;</span>.join([val <span class="keyword">if</span> val <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="string">&#x27;00&#x27;</span> <span class="keyword">for</span> val <span class="keyword">in</span> final_key])</span><br><span class="line">    <span class="comment"># Xor the currently known key with the target cipher</span></span><br><span class="line">    output = strxor(target_cipher.decode(<span class="string">&#x27;hex&#x27;</span>),final_key_hex.decode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Fix this sentence:&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join([char <span class="keyword">if</span> index <span class="keyword">in</span> known_key_positions <span class="keyword">else</span> <span class="string">&#x27;*&#x27;</span> <span class="keyword">for</span> index, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(output)])+<span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># WAIT.. MANUAL STEP HERE </span></span><br><span class="line">    <span class="comment"># This output are printing a * if that character is not known yet</span></span><br><span class="line">    <span class="comment"># fix the missing characters like this: &quot;Let*M**k*ow if *o&#123;*a&quot; = &quot;cure, Let Me know if you a&quot;</span></span><br><span class="line">    <span class="comment"># if is too hard, change the target_cipher to another one and try again</span></span><br><span class="line">    <span class="comment"># and we have our key to fix the entire text!</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#sys.exit(0) #comment and continue if u got a good key</span></span><br><span class="line"></span><br><span class="line">    target_plaintext = <span class="string">&quot;cure, Let Me know if you a&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Fixed:&quot;</span></span><br><span class="line">    <span class="built_in">print</span> target_plaintext+<span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">    key = strxor(target_cipher.decode(<span class="string">&#x27;hex&#x27;</span>),target_plaintext)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Decrypted msg:&quot;</span></span><br><span class="line">    <span class="keyword">for</span> cipher <span class="keyword">in</span> ciphers:</span><br><span class="line">        <span class="built_in">print</span> strxor(cipher.decode(<span class="string">&#x27;hex&#x27;</span>),key)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;\nPrivate key recovered: &quot;</span>+key+<span class="string">&quot;\n&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ciphers:</span><br><span class="line">    target_fix(i)</span><br></pre></td></tr></table></figure>

<h1 id="Buuctf-Â·-Crypto"><a href="#Buuctf-Â·-Crypto" class="headerlink" title="Buuctf Â· Crypto"></a>Buuctf Â· Crypto</h1><h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><h3 id="é¢˜ç›®-4"><a href="#é¢˜ç›®-4" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">p</span> = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line"><span class="attr">q</span> = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line"><span class="attr">dp</span> = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line"><span class="attr">dq</span> = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line"><span class="attr">c</span> = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-3"><a href="#é¢˜è§£-3" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>æ˜æ˜¾å¯è§ï¼Œ<strong>dpã€dqæ³„æ¼ã€‚</strong></p>
<p>ä¸Šä»£ç </p>
<h4 id="ä»£ç -5"><a href="#ä»£ç -5" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span></span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span></span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span></span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span></span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">I = gmpy2.invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, dq, q)               <span class="comment">#æ±‚å¹‚å–æ¨¡è¿ç®—</span></span><br><span class="line"></span><br><span class="line">m = (((mp-mq)*I)%p)*q+mq       <span class="comment">#æ±‚æ˜æ–‡å…¬å¼</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># b&#x27;noxCTF&#123;W31c0m3_70_Ch1n470wn&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="old-fashion"><a href="#old-fashion" class="headerlink" title="old-fashion"></a>old-fashion</h2><h2 id="é¢˜ç›®-5"><a href="#é¢˜ç›®-5" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Os</span> drnuzearyuwn, y jtkjzoztzoes douwlr oj y ilzwex eq lsdexosa kn pwodw tsozj eq ufyoszlbz yrl rlufydlx pozw douwlrzlbz, ydderxosa ze y rlatfyr jnjzli; mjy gfbmw vla xy wbfnsy symmyew (mjy vrwm qrvvrf), hlbew rd symmyew, mebhsymw rd symmyew, vbomgeyw rd mjy lxrzy, lfk wr dremj. Mjy eyqybzye kyqbhjyew mjy myom xa hyedrevbfn lf bfzyewy wgxwmbmgmbrf. Wr mjy dsln bw f<span class="number">1</span>_<span class="number">2</span>jyf-k<span class="number">3</span>_jg<span class="number">1</span>-vb-vl_l</span><br></pre></td></tr></table></figure>

<h2 id="é¢˜è§£-4"><a href="#é¢˜è§£-4" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><a target="_blank" rel="noopener" href="https://quipqiup.com">quipqiupçˆ†ç ´</a>,å¾—åˆ°ç»“æœ</p>
<p><img src="https://s2.loli.net/2022/01/12/mYJrT2woEeVjf1W.png" alt="image-20220112191539049"></p>
<blockquote>
<p>flag{n1_2hen-d3_hu1-mi-ma_a}</p>
</blockquote>
<h2 id="RSA3"><a href="#RSA3" class="headerlink" title="RSA3"></a>RSA3</h2><h3 id="é¢˜ç›®-6"><a href="#é¢˜ç›®-6" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">c1</span>=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line"><span class="attr">n</span>=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line"><span class="attr">e1</span>=<span class="number">11187289</span></span><br><span class="line"><span class="attr">c2</span>=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line"><span class="attr">e2</span>=<span class="number">9647291</span></span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-5"><a href="#é¢˜è§£-5" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å…±æ¨¡æ”»å‡»</p>
<p>ä¸Šä»£ç </p>
<h4 id="ä»£ç -6"><a href="#ä»£ç -6" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br><span class="line"></span><br><span class="line">s, s1, s2 = gmpy2.gcdext(e1, e2)  <span class="comment"># sä¸ºgcd(e1, e2)</span></span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="RSA2"><a href="#RSA2" class="headerlink" title="RSA2"></a>RSA2</h2><h3 id="é¢˜ç›®-7"><a href="#é¢˜ç›®-7" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line"><span class="attr">dp</span> = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line"></span><br><span class="line"><span class="attr">c</span> = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-6"><a href="#é¢˜è§£-6" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>dpæ³„æ¼</p>
<h4 id="ä»£ç -7"><a href="#ä»£ç -7" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> (dp*e-<span class="number">1</span>) % a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n % ((dp*e-<span class="number">1</span>) // a + <span class="number">1</span>) == <span class="number">0</span>:  <span class="comment"># ! å…³é”®ï¼Œæ˜“é”™</span></span><br><span class="line">            p = (dp*e-<span class="number">1</span>) // a + <span class="number">1</span></span><br><span class="line">            q = n // p</span><br><span class="line">            phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">            d = gp.invert(e, phi)</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        a += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="RSAROLL"><a href="#RSAROLL" class="headerlink" title="RSAROLL"></a>RSAROLL</h2><h3 id="é¢˜ç›®-8"><a href="#é¢˜ç›®-8" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># é¢˜ç›®.txt</span></span><br><span class="line">RSA rollï¼rollï¼rollï¼</span><br><span class="line">Only number and a-z</span><br><span class="line">ï¼ˆdon&#x27;t use editor</span><br><span class="line">which MS provideï¼‰</span><br><span class="line"></span><br><span class="line"># data.txt</span><br><span class="line">&#123;<span class="number">92013971</span>3,19&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">70479679</span>2</span><br><span class="line"><span class="number">75221115</span>2</span><br><span class="line"><span class="number">27470416</span>4</span><br><span class="line"><span class="number">18414022</span></span><br><span class="line"><span class="number">36827083</span>5</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">26307290</span>5</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">66355179</span>2</span><br><span class="line"><span class="number">47520680</span>4</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">42831337</span>4</span><br><span class="line"><span class="number">47520680</span>4</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">42539213</span>7</span><br><span class="line"><span class="number">70479679</span>2</span><br><span class="line"><span class="number">45826567</span>7</span><br><span class="line"><span class="number">34152465</span>2</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">53414950</span>9</span><br><span class="line"><span class="number">42539213</span>7</span><br><span class="line"><span class="number">42831337</span>4</span><br><span class="line"><span class="number">42539213</span>7</span><br><span class="line"><span class="number">34152465</span>2</span><br><span class="line"><span class="number">45826567</span>7</span><br><span class="line"><span class="number">26307290</span>5</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">82850979</span>7</span><br><span class="line"><span class="number">34152465</span>2</span><br><span class="line"><span class="number">42539213</span>7</span><br><span class="line"><span class="number">47520680</span>4</span><br><span class="line"><span class="number">42831337</span>4</span><br><span class="line"><span class="number">48329523</span>5</span><br><span class="line"><span class="number">47520680</span>4</span><br><span class="line"><span class="number">45978847</span>6</span><br><span class="line"><span class="number">30622014</span>8</span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-7"><a href="#é¢˜è§£-7" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>ä¸çŸ¥é“é¢˜ç›®çš„è€ƒç‚¹åœ¨å“ªï¼Œæ— ä»ä¸‹æ‰‹ã€‚</p>
<p>å­¦ä¹ ä»–äººé¢˜è§£åï¼Œå¾—çŸ¥ï¼š</p>
<ul>
<li><p>{920139713,19} </p>
<p>n = 920139713,</p>
<p>e = 19</p>
</li>
<li><p>åˆ†è§£ nå¾—åˆ°ï¼š</p>
<p>q = 18443 </p>
<p>p = 49891</p>
</li>
<li><p>å¸¸è§„æ±‚phiã€dåï¼Œå¯¹æ¯ä¸€è¡Œå¯†æ–‡ï¼ˆcï¼‰è¿›è¡Œè§£å¯†</p>
</li>
</ul>
<h4 id="ä»£ç -8"><a href="#ä»£ç -8" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">920139713</span></span><br><span class="line">q = <span class="number">18443</span></span><br><span class="line">p = <span class="number">49891</span></span><br><span class="line">e = <span class="number">19</span></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e , (p-<span class="number">1</span>) * (q-<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;&#x27;&#x27;704796792</span></span><br><span class="line"><span class="string">752211152</span></span><br><span class="line"><span class="string">274704164</span></span><br><span class="line"><span class="string">18414022</span></span><br><span class="line"><span class="string">368270835</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">263072905</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">663551792</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">704796792</span></span><br><span class="line"><span class="string">458265677</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">534149509</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">458265677</span></span><br><span class="line"><span class="string">263072905</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">828509797</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">306220148&#x27;&#x27;&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> c.split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">	flag += <span class="built_in">chr</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(ii),d,n))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h2><h3 id="é¢˜ç›®-9"><a href="#é¢˜ç›®-9" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">import</span> hashlib</span><br><span class="line"><span class="built_in">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="attr">N</span> = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line"><span class="attr">e</span> = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"></span><br><span class="line"><span class="attr">flag</span> = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(hex(d).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-8"><a href="#é¢˜è§£-8" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>çœ‹å‡ºæ¥æ±‚då†md5è½¬æ¢åå³å¯ã€‚</p>
<ul>
<li><p>è¿™é‡Œè€ƒå¯Ÿæœ¬æ„æ˜¯eè¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ç»´çº³æ”»å‡»</p>
<p><a target="_blank" rel="noopener" href="https://www.codeleading.com/article/48225801201/">eè¿‡å¤§çš„ç»´çº³æ”»å‡»</a></p>
</li>
</ul>
<p>ä½†æ­¤é¢˜çš„pã€qå‘ç°å¯æ‹†ï¼Œåˆ™æœ‰ä»¥ä¸‹</p>
<h4 id="ä»£ç -9"><a href="#ä»£ç -9" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> hashlib</span><br><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">N</span> = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"><span class="attribute">p</span> = <span class="number">9046853915223503351787031888977627106934564043204783593118678181991596316582877057556463152579621699010610569526573031954779520781448550677767565207407183</span></span><br><span class="line"><span class="attribute">q</span> = <span class="number">11273732364123571293429600400343309403733952146912318879993851141423284675797325272321856863528776914709992821287788339848962916204774010644058033316303937</span></span><br><span class="line"><span class="attribute">phi</span> = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"><span class="attribute">d</span> = gmpy<span class="number">2</span>.invert(e, phi)</span><br><span class="line"><span class="attribute">print</span>(d)</span><br><span class="line"><span class="comment"># 8920758995414587152829426558580025657357328745839747693739591820283538307445</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">flag</span> = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md<span class="number">5</span>(hex(int(d)).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="attribute">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;8159e6c4abdd3b94ce461ed9a1a24017&#125;   âŒ     Py3</span></span><br><span class="line"><span class="comment"># flag&#123;2cf5122fc7b4e0e24c93d8c2f8323b10&#125;   âŒ     CMD5 </span></span><br><span class="line"><span class="comment"># flag&#123;47bf28da384590448e0b0d23909a25a4&#125;   âœ…     Py2</span></span><br></pre></td></tr></table></figure>

<p>äº¤äº†å¥½å‡ æ¬¡flagéƒ½é”™äº†ï¼Œå¯¹æ¯”ä»–äººé¢˜è§£ï¼Œå¾—çŸ¥ï¼š</p>
<ul>
<li><p>dæ²¡é”™ï¼Œæ­¤æ–¹æ³•å¯è¡Œ</p>
</li>
<li><p>å› ä¸ºPy2ä¸Py3çš„å·®å¼‚ï¼Œå¯¼è‡´ç›¸åŒå€¼çš„md5å€¼ä¸åŒ</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/myli_binbin/article/details/84333071">PythonÂ·md5æ³¨æ„äº‹é¡¹</a></p>
</li>
<li><p>å…¶ååœ¨cmd5ç½‘ç«™åŠ å¯†åçš„ç»“æœä¸å¦ä¸€éƒ¨åˆ†é¢˜è§£ç›¸åŒï¼Œä½†ä»ä¸æ­£ç¡®</p>
</li>
<li><p>å¿…é¡»åœ¨Py2ç¯å¢ƒä¸‹md5åŠ å¯†</p>
</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><strong>Python2.Xçš„ç¯å¢ƒè¿˜å¾—ç•™ç€ï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€</strong></p>
<h2 id="RSA5"><a href="#RSA5" class="headerlink" title="RSA5"></a>RSA5</h2><h3 id="é¢˜ç›®-10"><a href="#é¢˜ç›®-10" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">m</span> = xxxxxxxx</span><br><span class="line"><span class="attr">e</span> = <span class="number">65537</span></span><br><span class="line">========== n <span class="attr">c</span> ==========</span><br><span class="line"><span class="attr">n</span> = <span class="number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span></span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = <span class="number">26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span></span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-9"><a href="#é¢˜è§£-9" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p><strong>ç›¸åŒmã€eï¼Œ ä¸åŒn</strong></p>
<p>å¾ˆåƒæ˜¯å¹¿æ’­æ”»å‡»ï¼Œä½†åŠ å¯†æŒ‡æ•°ä¸ä½ğŸ¤”</p>
<p>è¿˜æ˜¯è¯•äº†ä¸‹ï¼Œæ²¡æˆåŠŸ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii, gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">mi, ai</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd, mi) == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å¾—nã€cæ•°æ®</span></span><br><span class="line">n_list = []</span><br><span class="line">c_list = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/Users/wenhui/Desktop/1.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> f:</span><br><span class="line">        <span class="keyword">if</span> each.startswith(<span class="string">&quot;n =&quot;</span>):</span><br><span class="line">            n_list.append(<span class="built_in">int</span>(each[<span class="number">4</span>:].strip(<span class="string">&#x27;\n&#x27;</span>)))</span><br><span class="line">        <span class="keyword">elif</span> each.startswith(<span class="string">&quot;c =&quot;</span>):</span><br><span class="line">            c_list.append(<span class="built_in">int</span>(each[<span class="number">4</span>:].strip(<span class="string">&#x27;\n&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = gmpy2.iroot(CRT(n_list, c_list), e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>æ€ç»´çªƒå–ing</p>
<p>å¥¥ï¼Œæ‹†ä¸å‡ºæ¥çš„pã€q</p>
<p>ä¸”é‚£ä¹ˆæ­£å¸¸çš„e ä¸è¯¥æ˜¯ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡» ä½†nçœŸçš„å¾ˆå¤šï¼Œå°±è¯¥è€ƒè™‘<strong>nä¸äº’ç´ </strong>ï¼Œæ‰¾åˆ°p</p>
<p>è·å¾—æ€è·¯åï¼Œå†å†™ä»£ç ï¼</p>
<h4 id="ä»£ç -10"><a href="#ä»£ç -10" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å¾—nã€cæ•°æ®</span></span><br><span class="line"><span class="attribute">n_list</span> =<span class="meta"> []</span></span><br><span class="line"><span class="attribute">c_list</span> =<span class="meta"> []</span></span><br><span class="line"><span class="attribute">with</span> open(<span class="string">&quot;/Users/wenhui/Desktop/1.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) as f:</span><br><span class="line">    <span class="attribute">for</span> each in f:</span><br><span class="line">        <span class="attribute">if</span> each.startswith(<span class="string">&quot;n =&quot;</span>):</span><br><span class="line">            <span class="attribute">n_list</span>.append(int(each[<span class="number">4</span>:].strip(&#x27;\n&#x27;)))</span><br><span class="line">        <span class="attribute">elif</span> each.startswith(<span class="string">&quot;c =&quot;</span>):</span><br><span class="line">            <span class="attribute">c_list</span>.append(int(each[<span class="number">4</span>:].strip(&#x27;\n&#x27;)))</span><br><span class="line"></span><br><span class="line"><span class="attribute">s</span> = <span class="number">0</span>  # è®°å½•xä½ç½®</span><br><span class="line"><span class="attribute">for</span> x in n_list:</span><br><span class="line">    <span class="attribute">n</span> = s + <span class="number">1</span>  # è®°å½•è¢«æ¯”è¾ƒé¡¹ä½ç½®</span><br><span class="line">    <span class="attribute">while</span> n + <span class="number">1</span> &lt;= len(n_list):</span><br><span class="line">        <span class="attribute">if</span> gmpy<span class="number">2</span>.gcd(x, n_list[n]) != <span class="number">1</span>:</span><br><span class="line">            <span class="attribute">print</span>(<span class="string">&quot;n1:\n&quot;</span>, x, <span class="string">&quot;\n n2: \n&quot;</span>, n_list[n], <span class="string">&quot;\n p: \n&quot;</span>, gmpy<span class="number">2</span>.gcd(x, n_list[n]), <span class="string">&quot;\n\n\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ä¸€ç»„ï¼Œæ­£å¸¸æ±‚è§£RSA</span></span><br><span class="line">            <span class="attribute">n1</span> = x</span><br><span class="line">            <span class="attribute">p</span> = gmpy<span class="number">2</span>.gcd(x, n_list[n])</span><br><span class="line">            <span class="attribute">q</span> = n<span class="number">1</span> // p</span><br><span class="line">            <span class="attribute">phi</span> = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">            <span class="attribute">c</span> = c_list[s]</span><br><span class="line">            <span class="attribute">d</span> = int(gmpy<span class="number">2</span>.invert(e, phi))</span><br><span class="line">            <span class="attribute">m</span> = gmpy<span class="number">2</span>.powmod(c, d, n<span class="number">1</span>)</span><br><span class="line">            <span class="attribute">print</span>(libnum.n<span class="number">2</span>s(int(m)))</span><br><span class="line">        <span class="attribute">n</span> += <span class="number">1</span></span><br><span class="line">    <span class="attribute">s</span> += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><blockquote>
<p> ä¸åšé¢˜å°±æ²¡æœ‰è®°å¿†ç‚¹</p>
</blockquote>
<p><strong>ä¸äº’ç´ </strong>åœ¨æ— æ€è·¯æ—¶åº”è¯¥å¤šè¯•è¯•ã€‚</p>
<h2 id="NCTF2019-childRSA"><a href="#NCTF2019-childRSA" class="headerlink" title="[NCTF2019]childRSA"></a>[NCTF2019]childRSA</h2><h3 id="é¢˜ç›®-11"><a href="#é¢˜ç›®-11" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime, sieve_base <span class="keyword">as</span> primes</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPrime</span>(<span class="params">bits</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> n.bit_length() &lt; bits:</span><br><span class="line">            n *= choice(primes)</span><br><span class="line">        <span class="keyword">if</span> isPrime(n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> n + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag.encode(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">p, q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span></span><br><span class="line"><span class="comment"># c = 26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span></span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-10"><a href="#é¢˜è§£-10" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p><strong>ç›´æ¥æ‹†nå¾—åˆ°pã€q</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span></span><br><span class="line">c = <span class="number">26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span></span><br><span class="line">p = <span class="number">178449493212694205742332078583256205058672290603652616240227340638730811945224947826121772642204629335108873832781921390308501763661154638696935732709724016546955977529088135995838497476350749621442719690722226913635772410880516639651363626821442456779009699333452616953193799328647446968707045304702547915799734431818800374360377292309248361548868909066895474518333089446581763425755389837072166970684877011663234978631869703859541876049132713490090720408351108387971577438951727337962368478059295446047962510687695047494480605473377173021467764495541590394732685140829152761532035790187269724703444386838656193674253139</span></span><br><span class="line">q = <span class="number">184084121540115307597161367011014142898823526027674354555037785878481711602257307508985022577801782788769786800015984410443717799994642236194840684557538917849420967360121509675348296203886340264385224150964642958965438801864306187503790100281099130863977710204660546799128755418521327290719635075221585824217487386227004673527292281536221958961760681032293340099395863194031788435142296085219594866635192464353365034089592414809332183882423461536123972873871477755949082223830049594561329457349537703926325152949582123419049073013144325689632055433283354999265193117288252918515308767016885678802217366700376654365502867</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))  <span class="comment"># déœ€è¦è½¬æ¢ä¸ºæ•´æ•°å‹</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<h2 id="HDCTF2019-bbbbbbrsa"><a href="#HDCTF2019-bbbbbbrsa" class="headerlink" title="[HDCTF2019]bbbbbbrsa"></a>[HDCTF2019]bbbbbbrsa</h2><h3 id="é¢˜ç›®-12"><a href="#é¢˜ç›®-12" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># enc</span></span><br><span class="line"><span class="attribute">p</span> = <span class="number">177077389675257695042507998165006460849</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span></span><br><span class="line"><span class="attribute">c</span> = ==gMzYDNzIjMxUTNyIzNzIjMyYTM<span class="number">4</span>MDM<span class="number">0</span>gTMwEjNzgTM<span class="number">2</span>UTN<span class="number">4</span>cjNwIjN<span class="number">2</span>QzM<span class="number">5</span>ADMwIDNyMTO<span class="number">4</span>UzM<span class="number">2</span>cTM<span class="number">5</span>kDN<span class="number">2</span>MTOyUTO<span class="number">5</span>YDM<span class="number">0</span>czM<span class="number">3</span>MjM</span><br><span class="line"></span><br><span class="line"><span class="comment"># encode.py</span></span><br><span class="line"><span class="attribute">from</span> base<span class="number">64</span> import b<span class="number">64</span>encode as b<span class="number">32</span>encode</span><br><span class="line"><span class="attribute">from</span> gmpy<span class="number">2</span> import invert,gcd,iroot</span><br><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="attribute">from</span> binascii import a<span class="number">2</span>b_hex,b<span class="number">2</span>a_hex</span><br><span class="line"><span class="attribute">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="attribute">flag</span> = <span class="string">&quot;******************************&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">nbit</span> = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">p</span> = getPrime(nbit)</span><br><span class="line"><span class="attribute">q</span> = getPrime(nbit)</span><br><span class="line"><span class="attribute">n</span> = p*q</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span> p</span><br><span class="line"><span class="attribute">print</span> n</span><br><span class="line"></span><br><span class="line"><span class="attribute">phi</span> = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="attribute">e</span> = random.randint(<span class="number">50000</span>,<span class="number">70000</span>)</span><br><span class="line"></span><br><span class="line"><span class="attribute">while</span> True:</span><br><span class="line">	<span class="attribute">if</span> gcd(e,phi) == <span class="number">1</span>:</span><br><span class="line">		<span class="attribute">break</span>;</span><br><span class="line">	<span class="attribute">else</span>:</span><br><span class="line">		<span class="attribute">e</span> -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="attribute">c</span> = pow(int(b<span class="number">2</span>a_hex(flag),<span class="number">16</span>),e,n)</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span> b<span class="number">32</span>encode(str(c))[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2373740699529364991763589324200093466206785561836101840381622237225512234632</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-11"><a href="#é¢˜è§£-11" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><ul>
<li><p>q: é¢˜ç›®äº¤ä»£äº†pã€n, æ‰€ä»¥ q = n \ q </p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">p</span> = <span class="number">177077389675257695042507998165006460849</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span></span><br><span class="line"><span class="attr">q</span> = n // p</span><br><span class="line"><span class="attr">phi</span> = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>c: é¢˜ç›®æ‰€ç¤ºï¼Œå…ˆå°†flagè½¬ä¸º16è¿›åˆ¶ï¼Œå†è½¬10è¿›åˆ¶ï¼›æœ€ååœ¨RSAåŠ å¯†åï¼Œ<strong>base32ç¼–ç </strong>å†å€’åºæ‰“å°</p>
<p>å¯¹æ­¤ï¼Œåªéœ€è¦å°†cå€’åºåœ¨è§£ç åRSAè§£å¯†ï¼Œå³å¯</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> base<span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">c</span> = base<span class="number">64</span>.b<span class="number">32</span>decode(c[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p>ä½†ï¼Œè¿™ä¹ˆå†™ï¼Œæ‰§è¡Œèµ·æ¥ä¼šæŠ¥é”™,<strong>binascii.Error: Non-base32 digit found</strong></p>
<p>å¾ˆè®©äººéƒé—·ï¼Œä»¥ä¸ºå†™æ³•æœ‰é—®é¢˜ï¼Œæ”¹äº†å¤šæ¬¡ï¼Œæœªæœ</p>
<p>æœ€åä¸ŠCyberChefğŸ‘¨â€ğŸ³,çœ‹åˆ°ç”¨çš„æ˜¯<strong>base64è§£ç </strong>ğŸ˜…ï¼Œ<strong>æ‰€ä»¥æ˜¯é¢˜ç›®å†™é”™äº†å§ğŸ¤”</strong></p>
<p>ï¼ˆç°åœ¨çœ‹åˆ°äº†<strong>from base64 import b64encode as b32encode</strong>ï¼Œå•Šè¿™</p>
<p><img src="https://s2.loli.net/2022/01/13/SwvhZ7cDOLHtesE.png" alt="image-20220113151520874"></p>
</li>
<li><p>e: RSAè§£å¯†ä¸­å”¯ä¸€çš„é—®é¢˜åœ¨äºï¼Œä¸çŸ¥é“e</p>
<p>å› ä¸ºçŸ¥é“eçš„èŒƒå›´æ˜¯äº”ä¸‡åˆ°ä¸ƒä¸‡ï¼Œæ‰‹åŠ¨çˆ†ç ´å³å¯(ä½¿ç”¨æ¯ä¸€ä¸ªä¸phiäº’ç´ çš„eï¼Œçœ‹æœ€åè§£å‡ºæ¥æ˜¯ä¸æ˜¯ä¹±ç )</p>
<p>éœ€è¦æ‰‹åŠ¨æœç´¢å…³é”®è¯</p>
<figure class="highlight stan"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># çˆ†ç ´e</span></span><br><span class="line"><span class="built_in">e</span> = <span class="number">50000</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">e</span> &lt; <span class="number">70000</span>:</span><br><span class="line">    <span class="keyword">if</span> gcd(<span class="built_in">e</span>, phi) == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">e</span>)</span><br><span class="line">        d = <span class="keyword">int</span>(gmpy2.invert(<span class="built_in">e</span>, phi))</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(m), <span class="string">&quot;\n\n&quot;</span>)</span><br><span class="line">        <span class="built_in">e</span> += <span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">e</span> += <span class="number">1</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<p><img src="https://s2.loli.net/2022/01/13/lhSzUnIQe7TVigO.png" alt="image-20220113145655280"></p>
<p>ğŸ˜…æç„¶å‘ç°ï¼Œé¢˜ç›®æœ€åä¸€è¡Œæ³¨é‡Šé‡Œçªå…€çš„æ•°å­—æ˜¯åè¿›åˆ¶çš„c</p>
<p>æœ€åï¼Œç»è¿‡ä¸€ç‚¹ç‚¹å®Œå–„</p>
<h4 id="ä»£ç -11"><a href="#ä»£ç -11" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, base64, libnum</span><br><span class="line"></span><br><span class="line">p = <span class="number">177077389675257695042507998165006460849</span></span><br><span class="line">n = <span class="number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–c</span></span><br><span class="line"><span class="comment"># å¯¹ cå€’åº å† base64è§£ç </span></span><br><span class="line">c = <span class="string">&quot;==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM&quot;</span></span><br><span class="line">c = <span class="built_in">int</span>(base64.b64decode(c[::-<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># çˆ†ç ´eï¼Œè¿›è¡ŒRSAè§£ï¼Œæ‰‹åŠ¨ç­›é€‰å…³é”®è¯</span></span><br><span class="line">e = <span class="number">50000</span></span><br><span class="line"><span class="keyword">while</span> e &lt; <span class="number">70000</span>:</span><br><span class="line">    <span class="keyword">if</span> gcd(e, phi) == <span class="number">1</span>:</span><br><span class="line">        d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        flag = libnum.n2s(m)</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;flag&quot;</span> <span class="keyword">or</span> <span class="string">&quot;ctf&quot;</span>) <span class="keyword">in</span> <span class="built_in">str</span>(flag).lower():</span><br><span class="line">            <span class="built_in">print</span>(flag.decode())</span><br><span class="line">        e += <span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        e += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="BJDCTF2020-RSA"><a href="#BJDCTF2020-RSA" class="headerlink" title="[BJDCTF2020]RSA"></a>[BJDCTF2020]RSA</h2><h3 id="é¢˜ç›®-13"><a href="#é¢˜ç›®-13" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">flag=open(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">assert(e&lt;<span class="number">100000</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line">print <span class="built_in">pow</span>(<span class="number">294</span>,e,n)</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(<span class="string">&quot;BJD&quot;</span>*<span class="number">32</span>)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">output:</span><br><span class="line"><span class="number">12641635617803</span><span class="number">74615033223264</span><span class="number">63545962927078</span><span class="number">61480200207537</span><span class="number">19914118362443</span><span class="number">83037571205700</span><span class="number">96741248020236</span><span class="number">66696575579800</span><span class="number">96565477386163</span><span class="number">99025300123043</span><span class="number">76625551859614</span><span class="number">93489304445998</span><span class="number">20675230046423</span><span class="number">37305305163193</span><span class="number">25572308490834</span><span class="number">26859490183732</span><span class="number">30375174400487</span><span class="number">41830625948568</span><span class="number">70318614289991</span><span class="number">67598006354831</span><span class="number">64994869089232</span><span class="number">09627563871554</span><span class="number">87561270207910</span><span class="number">05670186989929</span><span class="number">35818206109087</span><span class="number">56816609739231</span><span class="number">41057175554829</span><span class="number">26141030505639</span><span class="number">57170887621316</span><span class="number">71121879625844</span><span class="number">84065321545727</span><span class="number">59413517536923</span><span class="number">39259225077949</span><span class="number">99607323536976</span><span class="number">82418316292338</span><span class="number">50056699304034</span><span class="number">48853465141405</span><span class="number">84683591984290</span><span class="number">84697875473417</span><span class="number">52365471892495</span><span class="number">20430764458616</span><span class="number">13932287760420</span><span class="number">15534147913888</span><span class="number">33831624416912</span>0  <span class="number">13508774104460</span><span class="number">20974330671403</span><span class="number">45467041372476</span><span class="number">27344981133461</span><span class="number">80195347973601</span><span class="number">70214017258188</span><span class="number">08462898375994</span><span class="number">76737562774949</span><span class="number">48396719445438</span><span class="number">22403059978073</span><span class="number">81312244140761</span><span class="number">25306581689429</span><span class="number">87820256786583</span><span class="number">00694700171174</span><span class="number">92301935423705</span><span class="number">70950705530167</span><span class="number">92170283562712</span><span class="number">24014752510390</span><span class="number">00775017381633</span><span class="number">90022247472739</span><span class="number">68237086950631</span><span class="number">36246115652622</span><span class="number">25976963459130</span><span class="number">94217612695482</span><span class="number">60984426148824</span><span class="number">64128501073098</span><span class="number">32153775092550</span><span class="number">11298737827621</span><span class="number">61115803297642</span><span class="number">00116625478545</span><span class="number">15610597955628</span><span class="number">89807356968415</span><span class="number">82256783334745</span><span class="number">43920326532893</span><span class="number">44684980811283</span><span class="number">74766843900309</span><span class="number">76472053905069</span><span class="number">85552229785068</span><span class="number">80269607011865</span><span class="number">43428139843783</span><span class="number">90762431727479</span><span class="number">69262488295434</span><span class="number">13464754127208</span><span class="number">84307033106303</span>7</span><br><span class="line"><span class="number">38163126882580</span><span class="number">64695181663703</span><span class="number">87352035475775</span><span class="number">67716361573075</span><span class="number">94543439135636</span><span class="number">15970881967332</span><span class="number">40770990123563</span><span class="number">77189361841989</span><span class="number">30226303761876</span><span class="number">51710120867710</span><span class="number">73110060657280</span><span class="number">14220477966000</span><span class="number">62096405661605</span><span class="number">86769998789769</span><span class="number">43319063836649</span><span class="number">08508537757727</span><span class="number">32147923715487</span><span class="number">75204594097887</span><span class="number">07889859846389</span><span class="number">24401415779745</span><span class="number">44939268247818</span><span class="number">93793660701310</span><span class="number">08081697586750</span><span class="number">42264568547764</span><span class="number">03162843141472</span><span class="number">79221685809984</span><span class="number">94695800403043</span><span class="number">31240664352763</span><span class="number">76674663184736</span><span class="number">69542326169218</span><span class="number">66536642304357</span><span class="number">90033884866341</span><span class="number">67642663495896</span><span class="number">60728215580833</span><span class="number">19023511885001</span><span class="number">97960905672207</span><span class="number">04657964705276</span><span class="number">45794118143056</span><span class="number">89137519860880</span><span class="number">91646727205677</span><span class="number">86414427589401</span><span class="number">35016400808740</span><span class="number">38714450815635</span><span class="number">806795521501</span>8</span><br><span class="line"><span class="number">97915337055253</span><span class="number">51534984774597</span><span class="number">20877329811204</span><span class="number">68820838754382</span><span class="number">61225821324042</span><span class="number">14848454954722</span><span class="number">48708665806140</span><span class="number">87952238050222</span><span class="number">02997613522014</span><span class="number">73698345212107</span><span class="number">38600548513023</span><span class="number">43517756732701</span><span class="number">02666706276590</span><span class="number">62776268792154</span><span class="number">57936330799698</span><span class="number">81275597305755</span><span class="number">76209301727788</span><span class="number">59116538571207</span><span class="number">10042499083850</span><span class="number">82551276166373</span><span class="number">34499680058645</span><span class="number">41178692530236</span><span class="number">87904147682486</span><span class="number">11809358160197</span><span class="number">55436925545867</span><span class="number">54501094579876</span><span class="number">98749584630551</span><span class="number">17757749204340</span><span class="number">36564199682851</span><span class="number">63536823819817</span><span class="number">57353135649723</span><span class="number">61543426899145</span><span class="number">25321673807925</span><span class="number">45865185476851</span><span class="number">23963553897408</span><span class="number">63270148775362</span><span class="number">74444811558163</span><span class="number">96293263623421</span><span class="number">60548500035000</span><span class="number">15609721544688</span><span class="number">12510555054657</span><span class="number">13854173913142</span><span class="number">04097638250043</span><span class="number">518544252172</span>1  <span class="number">12806210903061</span><span class="number">36836905430957</span><span class="number">51593603740223</span><span class="number">44774547459345</span><span class="number">21690712819395</span><span class="number">75929380718158</span><span class="number">65954073287532</span><span class="number">54594737067183</span><span class="number">83721448065397</span><span class="number">53829484356064</span><span class="number">91935728562330</span><span class="number">52096006805709</span><span class="number">75224639214396</span><span class="number">80512435086277</span><span class="number">21592723627787</span><span class="number">68036844634760</span><span class="number">91761270872178</span><span class="number">73201593184324</span><span class="number">56050806227784</span><span class="number">43509116111998</span><span class="number">26139873032559</span><span class="number">95543165395426</span><span class="number">65805946211005</span><span class="number">64313925175487</span><span class="number">17447898084915</span><span class="number">16766117236298</span><span class="number">42512016886394</span><span class="number">69652283452307</span><span class="number">71282139885701</span><span class="number">64875907949965</span><span class="number">44468826705600</span><span class="number">33220853520144</span><span class="number">33222672987471</span><span class="number">17528882985955</span><span class="number">37524642481261</span><span class="number">64783271823994</span><span class="number">61709978893464</span><span class="number">09324513553013</span><span class="number">54300078422233</span><span class="number">89360212803439</span><span class="number">85086761512114</span><span class="number">80500348877675</span><span class="number">84693608776323</span><span class="number">25223325426104</span>7</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-12"><a href="#é¢˜è§£-12" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å¸¸è§„é¢˜ç›®</p>
<ul>
<li><p><strong>n1ã€n2ä¸äº’ç´ </strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">n1</span> = <span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line"><span class="attr">n2</span> = <span class="number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line"><span class="attr">q</span> = gcd(n1, n2)</span><br><span class="line"><span class="attr">p1</span> = n1 // q</span><br><span class="line"><span class="attr">p2</span> = n2 // q</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p><strong>çˆ†ç ´e</strong>:å› ä¸ºm2å·²çŸ¥ï¼Œä¸”ä¸m1å…±ç”¨e</p>
<p>è¿™é‡Œæ³¨æ„ç”¨<strong>åŠ å¯†æ–¹å¼çˆ†ç ´</strong>ï¼ˆ$c = m^{e} \mod n$)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(m2, e, n2) == c2:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="ä»£ç -12"><a href="#ä»£ç -12" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line">n2 = <span class="number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line">q = gcd(n1, n2)</span><br><span class="line">p1 = n1 // q</span><br><span class="line">p2 = n2 // q</span><br><span class="line">m2 = <span class="string">&quot;BJD&quot;</span> * <span class="number">32</span></span><br><span class="line">m2 = bytes_to_long(m2.encode())</span><br><span class="line">c2 = <span class="number">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># çˆ†ç ´e</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;for e in range(100000):</span></span><br><span class="line"><span class="string">    if pow(m2, e, n2) == c2:</span></span><br><span class="line"><span class="string">        print(e)</span></span><br><span class="line"><span class="string">        # 52361</span></span><br><span class="line"><span class="string">        break&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">52361</span></span><br><span class="line">c1 = <span class="number">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span></span><br><span class="line">phi1 = (p1-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d1 = <span class="built_in">int</span>(gmpy2.invert(e, phi1))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, d1, n1)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m1))</span><br></pre></td></tr></table></figure>

<h3 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>BUUCTFå¹³å°å‰ç¼€ç»Ÿä¸€ä¸ºflag,è®°å¾—<strong>æ”¹æ ¼å¼</strong>ã€‚</p>
<h2 id="BJDCTF2020-rsa-output"><a href="#BJDCTF2020-rsa-output" class="headerlink" title="[BJDCTF2020]rsa_output"></a>[BJDCTF2020]rsa_output</h2><h3 id="é¢˜ç›®-14"><a href="#é¢˜ç›®-14" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,2767&#125;</span><br><span class="line"></span><br><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,3659&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">message1</span>=20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span><br><span class="line"></span><br><span class="line"><span class="attribute">message2</span>=11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-13"><a href="#é¢˜è§£-13" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><ul>
<li><p>ç¿»è¯‘ä¸€ä¸‹é¢˜ç›®</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">n</span> = <span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line"><span class="attr">e1</span> = <span class="number">2767</span></span><br><span class="line"><span class="attr">e2</span> = <span class="number">3659</span></span><br><span class="line"><span class="attr">c1</span> = <span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line"><span class="attr">c2</span> = <span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¸éš¾å‘ç°ï¼Œè€ƒæŸ¥<strong>å…±æ¨¡æ”»å‡»</strong></p>
</li>
</ul>
<h4 id="ä»£ç -13"><a href="#ä»£ç -13" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line">n = <span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line">e1 = <span class="number">2767</span></span><br><span class="line">c2 = <span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br><span class="line">e2 = <span class="number">3659</span></span><br><span class="line"></span><br><span class="line">s, s1, s2 = gmpy2.gcdext(e1, e2)  <span class="comment"># sä¸ºgcd(e1, e2)</span></span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<h2 id="RSA4"><a href="#RSA4" class="headerlink" title="RSA4"></a>RSA4</h2><h3 id="é¢˜ç›®-15"><a href="#é¢˜ç›®-15" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">N</span> = <span class="number">331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004</span> </span><br><span class="line"><span class="attr">c</span> = <span class="number">310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span></span><br><span class="line"></span><br><span class="line"><span class="attr">N</span> = <span class="number">302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114</span> </span><br><span class="line"><span class="attr">c</span> = <span class="number">112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span></span><br><span class="line"></span><br><span class="line"><span class="attr">N</span> = <span class="number">332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323</span> </span><br><span class="line"><span class="attr">c</span> = <span class="number">10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span></span><br></pre></td></tr></table></figure>

<h2 id="é¢˜è§£-14"><a href="#é¢˜è§£-14" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æ ¡å†…CTFå¹³å°åŒæ¬¾çš„å¯†ç é¢˜</p>
<p>å½“æ—¶æŠ˜ç£¨äº†æˆ‘ä¸€ä¸¤å‘¨ ï¼š  ï¼‰</p>
<ul>
<li><p><strong>äº”è¿›åˆ¶</strong>ï¼šNã€cæ•°å­—å¾ˆæœ‰ç‰¹ç‚¹ï¼Œå„ä½æ•°éƒ½<strong>ä¸è¶…è¿‡5</strong></p>
</li>
<li><p><strong>ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</strong>ï¼š</p>
<ul>
<li>åˆ¤æ–­åœ¨äºè®¸å¤šNã€cï¼›</li>
<li>æœªç»™e(å°è¯•<strong>e=3</strong></li>
</ul>
</li>
</ul>
<h4 id="ä»£ç -14"><a href="#ä»£ç -14" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">mi, ai</span>):</span></span><br><span class="line">    <span class="keyword">assert</span>(reduce(gmpy2.gcd,mi)==<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">n= [<span class="number">331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004</span>, <span class="number">302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114</span>, <span class="number">332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323</span>]</span><br><span class="line">c= [<span class="number">310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span>, <span class="number">112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span>, <span class="number">10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#  äº”è¿›åˆ¶è½¬åè¿›åˆ¶</span></span><br><span class="line">n1 = []</span><br><span class="line">c1 = []</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> n:</span><br><span class="line">    n1.append(<span class="built_in">int</span>(<span class="built_in">str</span>(each), <span class="number">5</span>))</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> c:</span><br><span class="line">    c1.append(<span class="built_in">int</span>(<span class="built_in">str</span>(each), <span class="number">5</span>))</span><br><span class="line">n = n1</span><br><span class="line">c = c1</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚è§£</span></span><br><span class="line">m = gmpy2.iroot(CRT(n, c), e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure>

<h3 id="æ€»ç»“-3"><a href="#æ€»ç»“-3" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul>
<li>å­¦ä¼šå¯¹ç°æœ‰é¢˜å‹çš„åˆ©ç”¨ï¼Œè¯†åˆ«æ–°é¢˜ç›®ä¸­çš„è€è€ƒç‚¹</li>
<li>çŒœæµ‹ä¸­ï¼Œ<strong>eå¾€å¾€ä¸æ˜¯65537å°±å¾ˆå¯èƒ½æ˜¯3</strong></li>
</ul>
<h2 id="WUSTCTF2020-babyrsa"><a href="#WUSTCTF2020-babyrsa" class="headerlink" title="[WUSTCTF2020]babyrsa"></a>[WUSTCTF2020]babyrsa</h2><h3 id="é¢˜ç›®-16"><a href="#é¢˜ç›®-16" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">c</span> = <span class="number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span></span><br><span class="line"><span class="attr">e</span> = <span class="number">65537</span></span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-15"><a href="#é¢˜è§£-15" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>æ²¡ä»€ä¹ˆç‰¹æ®Šçš„å¸¸è§„é¢˜ã€‚</p>
<h4 id="ä»£ç -15"><a href="#ä»£ç -15" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, libnum</span><br><span class="line">c = <span class="number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span></span><br><span class="line">n = <span class="number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">189239861511125143212536989589123569301</span></span><br><span class="line">q = <span class="number">386123125371923651191219869811293586459</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = gmpy2.powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h2 id="GWCTF-2019-BabyRSA"><a href="#GWCTF-2019-BabyRSA" class="headerlink" title="[GWCTF 2019]BabyRSA"></a>[GWCTF 2019]BabyRSA</h2><h3 id="é¢˜ç›®-17"><a href="#é¢˜ç›®-17" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">secret</span><br><span class="line">N=<span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">m1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">m2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">encrypt.txt</span><br><span class="line">import hashlib</span><br><span class="line">import sympy</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;GWHT&#123;******&#125;&#x27;</span></span><br><span class="line">secret = <span class="string">&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">half = <span class="built_in">len</span>(flag) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">flag1 = flag[:half]</span><br><span class="line">flag2 = flag[half:]</span><br><span class="line"></span><br><span class="line">secret_num = getPrime(<span class="number">1024</span>) * bytes_to_long(secret)</span><br><span class="line"></span><br><span class="line">p = sympy.nextprime(secret_num)</span><br><span class="line">q = sympy.nextprime(p)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">F1 = bytes_to_long(flag1)</span><br><span class="line">F2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = F1 + F2</span><br><span class="line">c2 = <span class="built_in">pow</span>(F1, <span class="number">3</span>) + <span class="built_in">pow</span>(F2, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">assert</span>(c2 &lt; N)</span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, e, N)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">output</span> = <span class="built_in">open</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="built_in">output</span>.<span class="built_in">write</span>(<span class="string">&#x27;N=&#x27;</span> + str(N) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">output</span>.<span class="built_in">write</span>(<span class="string">&#x27;m1=&#x27;</span> + str(m1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">output</span>.<span class="built_in">write</span>(<span class="string">&#x27;m2=&#x27;</span> + str(m2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">output</span>.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-16"><a href="#é¢˜è§£-16" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>ä¹ä¸€çœ‹ï¼Œæœ‰äº›å¤´å¤§ï¼Œä»”ç»†ç¢ç£¨ï¼Œæ²¡æœ‰ç»å¯¹éš¾åº¦</p>
<p>é¦–å…ˆï¼Œç†ä¸€ä¸‹é¢˜ç›®æ“ä½œ</p>
<ul>
<li><p>æŠŠflagå¹³åˆ†ä¸ºF1ã€F2</p>
</li>
<li><p>$ c1 = F1 + F2$</p>
<p>$c2 = F1^{3} + F2^{3}$</p>
</li>
<li><p>å…¶åï¼Œä¸€ä¸ªè®©äººç–‘æƒ‘çš„æ“ä½œ</p>
<p>$ m1 = c1^{e} \mod N$</p>
<p>$ m2 = c2^{e} \mod N$</p>
<ul>
<li><p>å› ä¸ºé€šå¸¸ï¼ŒRSAç®—æ³•ç®—æ³•ä¸­ï¼ŒåŠ è§£å¯†æ–¹ç¨‹ä¸ºï¼š</p>
<p>$c = m^{e} \mod n$</p>
<p>$m = c^{d} \mod n$</p>
<p>æ•…ï¼Œè¿™é‡Œçš„æ“ä½œå…·æœ‰è¿·æƒ‘æ€§ã€‚</p>
<p>ä½†ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ˜ç¡®çš„ï¼Œå°±æ˜¯æƒ³åŠæ³•<strong>æ±‚å‡ºc1ã€c2</strong>ï¼Œå†é€šc1ã€c2æƒ³åŠæ³•<strong>æ±‚å‡ºF1ã€F2</strong></p>
<ul>
<li><strong>æ±‚è§£c1ã€c2</strong></li>
</ul>
<p>è¿™é‡Œï¼Œæˆ‘çš„æƒ³æ³•ğŸ’¡æ˜¯ï¼š</p>
<p>æŠŠ m1 è®°ä½œ C1, c1 è®°ä½œ M1;</p>
<p>æŠŠ m2 è®°ä½œ C2, c2 è®°ä½œ M2.</p>
<p>åˆ™ï¼Œæœ‰ï¼š</p>
<p>$ C1 = M1^{e} \mod N$</p>
<p>$ C2 = M2^{e} \mod N$</p>
<p>è¿™æ ·ï¼Œå°±é¡ºçœ¼äº†ï¼Œåªæ˜¯å¸¸è§„çš„æ±‚æ˜æ–‡m</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line"><span class="attribute">p</span> = <span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span></span><br><span class="line"><span class="attribute">q</span> = n // p</span><br><span class="line"><span class="attribute">phi</span> = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attribute">C1</span>=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line"><span class="attribute">C2</span>=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line"><span class="attribute">d</span> = int(gmpy<span class="number">2</span>.invert(e, phi))</span><br><span class="line"><span class="attribute">c1</span> = M<span class="number">1</span> = pow(C<span class="number">1</span>, d, n)</span><br><span class="line"><span class="attribute">c2</span> = M<span class="number">2</span> = pow(C<span class="number">2</span>, d, n)</span><br><span class="line"><span class="comment"># print(M1)</span></span><br><span class="line"><span class="comment">#  c1 = M1 = F1+F2 = 2732509502629189160482346120094198557857912754</span></span><br><span class="line"><span class="comment"># print(M2)</span></span><br><span class="line"><span class="comment"># c2 = M2 = (F1**3 + F2**3) = 5514544075236012543362261483183657422998274674127032311399076783844902086865451355210243586349132992563718009577051164928513093068525554</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>æ±‚è§£F1ã€F2</strong></li>
</ul>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œå·²æ±‚å‡ºï¼š</p>
<p> $c1  = F1+F2$         â€”â€”â€”-1</p>
<p>$c2 = F1^{3} + F2^{3}$</p>
<p>å…¶åé€šè¿‡å°†c1ä¸‰æ¬¡æ–¹åå‡å»c2ï¼Œå¾—åˆ°ï¼š</p>
<p>${c1^{3} - c2\over 3c1} = F1F2$       â€”â€”â€”-2</p>
<p>ç”±å¼1ã€2å¯å¾—F1ã€F2,æ‰€ä»¥ä¸‹é¢å°±è¯¥<strong>è§£æ–¹ç¨‹</strong></p>
<p><code>![image-20220114095336077](https://s2.loli.net/2022/01/14/Dby7tNfOvmYhJF4.png)</code></p>
<ul>
<li><p>æ±‚è§£äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹</p>
<p>è¿™é‡Œä¸€å¼€å§‹æƒ³ä½¿ç”¨Sageï¼Œå¯æƒœï¼Œæ²¡ç”¨æ˜ç™½ã€‚</p>
<p>æœ€åå­¦ä¹ å¹¶ä½¿ç”¨äº†<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_36474809/article/details/104476870">sympy</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸€ç‚¹æ•°å­¦è¿ç®—</span></span><br><span class="line">A = F1F2 = (<span class="built_in">pow</span>(c1, <span class="number">3</span>) - c2) // (<span class="number">3</span>*c1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">F1 Â· F2 = A</span></span><br><span class="line"><span class="string">F1 + F2 = c1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">x = Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y = Symbol(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">solved_value = solve([x * y - A, x + y - c1], [x, y])</span><br><span class="line"><span class="comment"># print(solved_value)</span></span><br><span class="line"><span class="comment"># [(1141553212031156130619789508463772513350070909, 1590956290598033029862556611630426044507841845), (1590956290598033029862556611630426044507841845, 1141553212031156130619789508463772513350070909)]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>å¯è§ï¼Œæ±‚å‡ºäº†F1ã€F2ï¼Œè¿™é‡Œå†è°ƒè¯•ä¸€ä¸‹å…ˆåé¡ºåºï¼Œå³å¯ã€‚</p>
<p>æœ€ç»ˆï¼Œä»£ç å¦‚ä¸‹</p>
<h4 id="ä»£ç -16"><a href="#ä»£ç -16" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, libnum</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">p = <span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">C1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">C2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">c1 = M1 = <span class="built_in">pow</span>(C1, d, n)</span><br><span class="line">c2 = M2 = <span class="built_in">pow</span>(C2, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸€ç‚¹æ•°å­¦è¿ç®—</span></span><br><span class="line">A = F1F2 = (<span class="built_in">pow</span>(c1, <span class="number">3</span>) - c2) // (<span class="number">3</span>*c1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„(pip install sympy)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">F1 Â· F2 = A</span></span><br><span class="line"><span class="string">F1 + F2 = c1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">x = Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y = Symbol(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">solved_value = solve([x * y - A, x + y - c1], [x, y])</span><br><span class="line"></span><br><span class="line">F2 = <span class="built_in">int</span>(solved_value[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">F1 = <span class="built_in">int</span>(solved_value[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>((libnum.n2s(F1) + libnum.n2s(F2)).decode())</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>Harry0597
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://harry0597.com/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" title="å¯’å‡ä¿®ç‚¼è®°ï¼ˆäºŒï¼‰">https://harry0597.com/2021/12/30/å¯’å‡ä¿®ç‚¼è®°ï¼ˆäºŒï¼‰/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%9D%82/" rel="tag"><i class="fa fa-tag"></i> æ‚</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" rel="prev" title="å¯’å‡ä¿®ç‚¼è®°ï¼ˆä¸€ï¼‰">
      <i class="fa fa-chevron-left"></i> å¯’å‡ä¿®ç‚¼è®°ï¼ˆä¸€ï¼‰
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/01/07/2nd%C2%B7BMZCTF%C2%B7Writeup/" rel="next" title="ç¬¬äºŒå±ŠBMZCTFç½‘ç»œå®‰å…¨å…¬å¼€èµ›å®˜æ–¹é¢˜è§£">
      ç¬¬äºŒå±ŠBMZCTFç½‘ç»œå®‰å…¨å…¬å¼€èµ›å®˜æ–¹é¢˜è§£ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-5"><span class="nav-number">1.</span> <span class="nav-text">1.5</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%C2%B7dp%E3%80%81dq%E6%B3%84%E6%BC%8F"><span class="nav-number">1.1.</span> <span class="nav-text">RSAÂ·dpã€dqæ³„æ¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFdp%E3%80%81dq"><span class="nav-number">1.1.1.</span> <span class="nav-text">ä»€ä¹ˆæ˜¯dpã€dq</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E8%A6%81%E7%BB%93%E8%AE%BA"><span class="nav-number">1.1.2.</span> <span class="nav-text">é‡è¦ç»“è®º</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BD%93m-lt-p-%E6%88%96-q%E6%97%B6"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">å½“m &lt; p æˆ– qæ—¶</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%81%E6%98%8E"><span class="nav-number">1.1.3.</span> <span class="nav-text">è¯æ˜</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-number">1.1.3.0.1.</span> <span class="nav-text">ä»£ç å®ç°</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E4%B8%80%E8%88%AC%E7%9A%84"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">æ›´ä¸€èˆ¬çš„</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-1"><span class="nav-number">1.1.3.1.1.</span> <span class="nav-text">ä»£ç å®ç°</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%C2%B7n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9"><span class="nav-number">1.2.</span> <span class="nav-text">RSAÂ·næ˜¯pçš„ræ¬¡æ–¹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%93-n-p-r-%E6%97%B6"><span class="nav-number">1.2.1.</span> <span class="nav-text">å½“$ n &#x3D; p^{r} $æ—¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%93-n-p-r-%C2%B7q-s-%E6%97%B6"><span class="nav-number">1.2.2.</span> <span class="nav-text">å½“$ n &#x3D; p^{r}Â·q^{s} $æ—¶</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">ä¾‹å­</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%C2%B7n%E5%88%86%E8%A7%A3%E4%B8%BA%E5%A4%9A%E4%B8%AA%E7%B4%A0%E6%95%B0"><span class="nav-number">1.3.</span> <span class="nav-text">RSAÂ·nåˆ†è§£ä¸ºå¤šä¸ªç´ æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-number">1.3.1.</span> <span class="nav-text">ç»“è®º</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-number">1.3.2.</span> <span class="nav-text">åŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-number">1.3.3.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%C2%B7e%E5%92%8Cphi%E4%B8%8D%E4%BA%92%E7%B4%A0"><span class="nav-number">1.4.</span> <span class="nav-text">RSAÂ·eå’Œphiä¸äº’ç´ </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E7%AD%96"><span class="nav-number">1.4.1.</span> <span class="nav-text">å¯¹ç­–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-2"><span class="nav-number">1.4.2.</span> <span class="nav-text">ä»£ç å®ç°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%C2%B7NC%E4%B8%8D%E4%BA%92%E7%B4%A0"><span class="nav-number">1.5.</span> <span class="nav-text">RSAÂ·NCä¸äº’ç´ </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E5%9E%8B"><span class="nav-number">1.5.1.</span> <span class="nav-text">é¢˜å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA-1"><span class="nav-number">1.5.2.</span> <span class="nav-text">ç»“è®º</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%81%E6%98%8E-1"><span class="nav-number">1.5.3.</span> <span class="nav-text">è¯æ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E6%B1%82%E8%A7%A3"><span class="nav-number">1.5.4.</span> <span class="nav-text">ä»£ç æ±‚è§£</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%C2%B7rabin%E7%AE%97%E6%B3%95"><span class="nav-number">1.6.</span> <span class="nav-text">RSAÂ·rabinç®—æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E5%BE%81"><span class="nav-number">1.6.1.</span> <span class="nav-text">ç‰¹å¾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-1"><span class="nav-number">1.6.2.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-6-1-7"><span class="nav-number">2.</span> <span class="nav-text">1.6&#x2F;1.7</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Sage"><span class="nav-number">2.1.</span> <span class="nav-text">Sage</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#M1-macOS%C2%B7Sage%E5%AE%89%E8%A3%85"><span class="nav-number">2.1.1.</span> <span class="nav-text">M1 macOSÂ·Sageå®‰è£…</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-number">2.1.1.1.</span> <span class="nav-text">å‚è€ƒèµ„æ–™</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Install-conda"><span class="nav-number">2.1.1.2.</span> <span class="nav-text">Install conda</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Install-SageMath"><span class="nav-number">2.1.1.3.</span> <span class="nav-text">Install SageMath</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#M1-macOS%C2%B7Sage%E8%BF%90%E8%A1%8C"><span class="nav-number">2.1.2.</span> <span class="nav-text">M1 macOSÂ·Sageè¿è¡Œ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Sage%C2%B7%E4%BA%A4%E4%BA%92%E6%A8%A1%E5%BC%8F"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">SageÂ·äº¤äº’æ¨¡å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Sage%C2%B7%E7%BD%91%E9%A1%B5%E6%A8%A1%E5%BC%8F%EF%BC%88%E6%8E%A8%E8%8D%90"><span class="nav-number">2.1.2.2.</span> <span class="nav-text">SageÂ·ç½‘é¡µæ¨¡å¼ï¼ˆæ¨è</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-8"><span class="nav-number">2.2.</span> <span class="nav-text">1.8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#m%E9%AB%98%E4%BD%8D"><span class="nav-number">2.2.1.</span> <span class="nav-text">mé«˜ä½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-2"><span class="nav-number">2.2.2.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#p%E9%AB%98%E4%BD%8D%E6%94%BB%E5%87%BB"><span class="nav-number">2.3.</span> <span class="nav-text">pé«˜ä½æ”»å‡»</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%87%B3%E4%BB%8A"><span class="nav-number">3.</span> <span class="nav-text">è‡³ä»Š</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%94%AE%E7%9B%98%E4%B9%8B%E4%BA%89-%C2%B7-84"><span class="nav-number">3.1.</span> <span class="nav-text">é”®ç›˜ä¹‹äº‰ Â· 84</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">3.1.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">3.1.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-3"><span class="nav-number">3.1.2.1.</span> <span class="nav-text">ä»£ç å®ç°</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easy-CRC-%C2%B7-92"><span class="nav-number">3.2.</span> <span class="nav-text">easy_CRC Â· 92</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="nav-number">3.2.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-1"><span class="nav-number">3.2.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-3"><span class="nav-number">3.2.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa-%C2%B7-97"><span class="nav-number">3.3.</span> <span class="nav-text">rsa Â· 97</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="nav-number">3.3.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#AFCTF2018-MagicNum"><span class="nav-number">4.</span> <span class="nav-text">[AFCTF2018]MagicNum</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#AFCTF2018-%E4%BD%A0%E5%90%AC%E8%BF%87%E4%B8%80%E6%AC%A1%E4%B8%80%E5%AF%86%E4%B9%88%EF%BC%9F"><span class="nav-number">4.1.</span> <span class="nav-text">[AFCTF2018]ä½ å¬è¿‡ä¸€æ¬¡ä¸€å¯†ä¹ˆï¼Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="nav-number">4.2.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-2"><span class="nav-number">4.3.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-4"><span class="nav-number">4.3.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Buuctf-%C2%B7-Crypto"><span class="nav-number">5.</span> <span class="nav-text">Buuctf Â· Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA1"><span class="nav-number">5.1.</span> <span class="nav-text">RSA1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-4"><span class="nav-number">5.1.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-3"><span class="nav-number">5.1.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-5"><span class="nav-number">5.1.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#old-fashion"><span class="nav-number">5.2.</span> <span class="nav-text">old-fashion</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-5"><span class="nav-number">5.3.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-4"><span class="nav-number">5.4.</span> <span class="nav-text">é¢˜è§£</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA3"><span class="nav-number">5.5.</span> <span class="nav-text">RSA3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-6"><span class="nav-number">5.5.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-5"><span class="nav-number">5.5.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-6"><span class="nav-number">5.5.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA2"><span class="nav-number">5.6.</span> <span class="nav-text">RSA2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-7"><span class="nav-number">5.6.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-6"><span class="nav-number">5.6.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-7"><span class="nav-number">5.6.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSAROLL"><span class="nav-number">5.7.</span> <span class="nav-text">RSAROLL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-8"><span class="nav-number">5.7.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-7"><span class="nav-number">5.7.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-8"><span class="nav-number">5.7.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa2"><span class="nav-number">5.8.</span> <span class="nav-text">rsa2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-9"><span class="nav-number">5.8.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-8"><span class="nav-number">5.8.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-9"><span class="nav-number">5.8.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">5.9.</span> <span class="nav-text">æ€»ç»“</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA5"><span class="nav-number">5.10.</span> <span class="nav-text">RSA5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-10"><span class="nav-number">5.10.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-9"><span class="nav-number">5.10.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-10"><span class="nav-number">5.10.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">5.10.3.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NCTF2019-childRSA"><span class="nav-number">5.11.</span> <span class="nav-text">[NCTF2019]childRSA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-11"><span class="nav-number">5.11.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-10"><span class="nav-number">5.11.2.</span> <span class="nav-text">é¢˜è§£</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HDCTF2019-bbbbbbrsa"><span class="nav-number">5.12.</span> <span class="nav-text">[HDCTF2019]bbbbbbrsa</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-12"><span class="nav-number">5.12.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-11"><span class="nav-number">5.12.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-11"><span class="nav-number">5.12.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF2020-RSA"><span class="nav-number">5.13.</span> <span class="nav-text">[BJDCTF2020]RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-13"><span class="nav-number">5.13.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-12"><span class="nav-number">5.13.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-12"><span class="nav-number">5.13.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-2"><span class="nav-number">5.13.3.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF2020-rsa-output"><span class="nav-number">5.14.</span> <span class="nav-text">[BJDCTF2020]rsa_output</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-14"><span class="nav-number">5.14.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-13"><span class="nav-number">5.14.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-13"><span class="nav-number">5.14.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA4"><span class="nav-number">5.15.</span> <span class="nav-text">RSA4</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-15"><span class="nav-number">5.15.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-14"><span class="nav-number">5.16.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-14"><span class="nav-number">5.16.0.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-3"><span class="nav-number">5.16.1.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WUSTCTF2020-babyrsa"><span class="nav-number">5.17.</span> <span class="nav-text">[WUSTCTF2020]babyrsa</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-16"><span class="nav-number">5.17.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-15"><span class="nav-number">5.17.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-15"><span class="nav-number">5.17.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GWCTF-2019-BabyRSA"><span class="nav-number">5.18.</span> <span class="nav-text">[GWCTF 2019]BabyRSA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-17"><span class="nav-number">5.18.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-16"><span class="nav-number">5.18.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-16"><span class="nav-number">5.18.2.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Harry0597"
      src="/images/IMG_2550.JPG">
  <p class="site-author-name" itemprop="name">Harry0597</p>
  <div class="site-description" itemprop="description">Pondering'll do you wonders.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:1915885792@qq.com" title="E-Mail â†’ mailto:1915885792@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>


      
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CS/" rel="tag">CS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-OS/" rel="tag">Mac OS</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Writeup/" rel="tag">Writeup</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">æ‚</a><span class="tag-list-count">6</span></li></ul>
              </canvas>
          </div>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harry0597</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">1.1m</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'SdJfKJYPhm2sNuw1OsouUSUC-MdYXbMMI',
      appKey     : '4pmiJGkm87YwJe40oBXXWYKM',
      placeholder: "è¯„è®ºï¼Œè®©æ€ç»´ç¢°æ’",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://SdJfKJYP.api.lncldglobal.com'
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
