<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/ico" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/hackerrank.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harry0597.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="2022.5.7日9:00-19:00于春秋杯网络安全联赛中所产题解">
<meta property="og:type" content="article">
<meta property="og:title" content="2022年春秋杯网络安全联赛春季赛·Crypto WP">
<meta property="og:url" content="https://harry0597.com/2022/05/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B/index.html">
<meta property="og:site_name" content="Harry&#39;s Blog">
<meta property="og:description" content="2022.5.7日9:00-19:00于春秋杯网络安全联赛中所产题解">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507204308159.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507205949333.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507205850757.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_95676E5FB12E-1.jpeg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220509205640566.png">
<meta property="article:published_time" content="2022-05-09T14:05:38.000Z">
<meta property="article:modified_time" content="2022-05-24T12:44:44.241Z">
<meta property="article:author" content="Harry0597">
<meta property="article:tag" content="Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507204308159.png">

<link rel="canonical" href="https://harry0597.com/2022/05/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2022年春秋杯网络安全联赛春季赛·Crypto WP | Harry's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Harry's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">温故知新</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Harry0597" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://harry0597.com/2022/05/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/IMG_2550.JPG">
      <meta itemprop="name" content="Harry0597">
      <meta itemprop="description" content="Pondering'll do you wonders.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Harry's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2022年春秋杯网络安全联赛春季赛·Crypto WP
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-09 22:05:38" itemprop="dateCreated datePublished" datetime="2022-05-09T22:05:38+08:00">2022-05-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-05-24 20:44:44" itemprop="dateModified" datetime="2022-05-24T20:44:44+08:00">2022-05-24</time>
              </span>

          
    <span>&emsp;</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span>
    <span class="post-meta-item-text">阅读次数：</span>
    <span id="busuanzi_value_page_pv"></span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/05/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/05/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>32k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>29 分钟</span>
            </span>
            <div class="post-description">2022.5.7日9:00-19:00于春秋杯网络安全联赛中所产题解</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="2022年春秋杯网络安全联赛春季赛·Crypto"><a href="#2022年春秋杯网络安全联赛春季赛·Crypto" class="headerlink" title="2022年春秋杯网络安全联赛春季赛·Crypto"></a>2022年春秋杯网络安全联赛春季赛·Crypto</h1><blockquote>
<p>勇者山峰与传说殿堂都看了题</p>
</blockquote>
<p>九点开始守着看的是勇者山峰</p>
<p>当时只有了一道300分的题</p>
<h2 id="notKnapsack"><a href="#notKnapsack" class="headerlink" title="notKnapsack"></a><strong>notKnapsack</strong></h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> FLAG.startswith(<span class="string">b&#x27;flag&#123;&#x27;</span>) <span class="keyword">and</span> FLAG.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">q = <span class="number">210767327475911131359308665806489575328083</span></span><br><span class="line"></span><br><span class="line">flag_bin = <span class="built_in">bin</span>(bytes_to_long(FLAG[<span class="number">5</span>:-<span class="number">1</span>]))[<span class="number">2</span>:]</span><br><span class="line">l = <span class="built_in">len</span>(flag_bin)</span><br><span class="line"></span><br><span class="line">n = random.randint(l, <span class="number">2</span>*l)</span><br><span class="line">cipher = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    r = [random.randint(<span class="number">2</span>, q-<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">    s = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        s = s * r[i] ** <span class="built_in">int</span>(flag_bin[i]) % q</span><br><span class="line">    cipher.append([r, s])</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(cipher))</span><br></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="http://cun.harry0597.com/CTF/output.txt">output.txt</a></li>
</ul>
<p>对output简单处理了下，然后分析加密代码，可知这是累积的特殊背包问题，搜寻无果，z3不好用。</p>
<p>仔细看题目，说不是背包，或许另有妙计。</p>
<p>时间已过去两个半小时。</p>
<p>十一点半，刷新发现又上了一道500分题</p>
<h2 id="Train"><a href="#Train" class="headerlink" title="Train"></a>Train</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">banner = <span class="string">br&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> .oooooo..o                             oooo  oooo  ooooooooooooo                     o8o              </span></span><br><span class="line"><span class="string">d8P&#x27;    `Y8                             `888  `888  8&#x27;   888   `8                     `&quot;&#x27;              </span></span><br><span class="line"><span class="string">Y88bo.      ooo. .oo.  .oo.    .oooo.    888   888       888      oooo d8b  .oooo.   oooo  ooo. .oo.   </span></span><br><span class="line"><span class="string"> `&quot;Y8888o.  `888P&quot;Y88bP&quot;Y88b  `P  )88b   888   888       888      `888&quot;&quot;8P `P  )88b  `888  `888P&quot;Y88b  </span></span><br><span class="line"><span class="string">     `&quot;Y88b  888   888   888   .oP&quot;888   888   888       888       888      .oP&quot;888   888   888   888  </span></span><br><span class="line"><span class="string">oo     .d8P  888   888   888  d8(  888   888   888       888       888     d8(  888   888   888   888  </span></span><br><span class="line"><span class="string">8&quot;&quot;88888P&#x27;  o888o o888o o888o `Y888&quot;&quot;8o o888o o888o     o888o     d888b    `Y888&quot;&quot;8o o888o o888o o888o </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">n0 = <span class="number">30798082519452208630254982405300548841337042015746308462162479889627080155514391987610153873334549377764946092629701</span></span><br><span class="line">g = <span class="number">64146569863628228208271069055817252751116365290967978172021890038925428672043</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">TrainHash</span>(<span class="params">msg</span>):</span></span><br><span class="line">    n = n0</span><br><span class="line">    msg = <span class="built_in">map</span>(<span class="built_in">ord</span>,msg)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> msg :</span><br><span class="line">        n = g * (n+i)</span><br><span class="line">        n = n &amp; (<span class="number">1</span>&lt;&lt;<span class="number">383</span>)</span><br><span class="line">    <span class="keyword">return</span> n - <span class="number">0xf5e33dabb114514</span></span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"></span><br><span class="line">MENU = <span class="string">br&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;OPTION&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span>(<span class="params">self</span>):</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;SERVER &lt;INPUT&gt;: &#x27;</span></span>):</span></span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        proof = (<span class="string">&#x27;&#x27;</span>.join([random.choice(table)<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])).encode()</span><br><span class="line">        sha = sha256(proof).hexdigest().encode()</span><br><span class="line">        self.send(<span class="string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="number">4</span>:] + <span class="string">b&quot;) == &quot;</span> + sha )</span><br><span class="line">        XXXX = self.recv(prompt = <span class="string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(XXXX) != <span class="number">4</span> <span class="keyword">or</span> sha256(XXXX + proof[<span class="number">4</span>:]).hexdigest().encode() != sha:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> sha.decode()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        signal.alarm(<span class="number">30</span>)</span><br><span class="line">        FirstBlockHash = self.proof_of_work()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> FirstBlockHash:</span><br><span class="line">            self.request.close()</span><br><span class="line">        self.send(banner)</span><br><span class="line">        self.send(<span class="string">b&quot;\nPlease give me 2 strings that are same when are hashed  =.=  &quot;</span>)</span><br><span class="line">        string1 = self.recv().decode()</span><br><span class="line">        string2 = self.recv().decode()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> TrainHash(string1) == TrainHash(string2):</span><br><span class="line">            self.send(<span class="string">b&#x27;\nJust do it!~ You can do more!&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> string2.encode()[-<span class="number">50</span>:] == string1.encode()[-<span class="number">50</span>:]:</span><br><span class="line">                self.send(flag)</span><br><span class="line">        self.send(<span class="string">b&quot;\nConnection has been closed  =.=  &quot;</span>)</span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ForkingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10012</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;HOST:POST &quot;</span> + HOST+<span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(PORT))</span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>

<p>简单审计代码，不了解的hash方式。</p>
<p>无所谓，朴素地想着先写py脚本连上靶机互动一下</p>
<p>结果，发了两个字符串<code>flag</code>，直接送给我了flag🤔</p>
<p>回去看代码，发现确实没限定string长度，不好的题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;写自己的HOST&#x27;</span>  <span class="comment"># str</span></span><br><span class="line">PORT = 自己的端口  <span class="comment"># int</span></span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">s.connect((HOST, PORT))</span><br><span class="line">a = <span class="built_in">str</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line">data = <span class="string">&#x27;&#x27;</span>.join(a.strip(<span class="string">&quot;\n&quot;</span>))</span><br><span class="line">sha_key = <span class="string">&#x27;&#x27;</span>.join(data.split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>]).split(<span class="string">&#x27;+&#x27;</span>)[-<span class="number">1</span>]  <span class="comment"># like: dygRhRVGRA146H43</span></span><br><span class="line"><span class="built_in">print</span>(sha_key)</span><br><span class="line">sha_data = data.split(<span class="string">&#x27;== &#x27;</span>)[-<span class="number">1</span>][:-<span class="number">3</span>]  <span class="comment"># like: d06a5396ad875acdf0796cc5b0c083170e38728847085cfd99dadaeda71a3d17</span></span><br><span class="line"><span class="built_in">print</span>(sha_data)</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一关 sha256</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">data</span>):</span></span><br><span class="line">    s = hashlib.sha256()  <span class="comment"># Get the hash algorithm.</span></span><br><span class="line">    s.update(data.encode())  <span class="comment"># Hash the data.</span></span><br><span class="line">    b = s.hexdigest()  <span class="comment"># Get he hash value.</span></span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">list1 = [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;J&quot;</span>,</span><br><span class="line">         <span class="string">&quot;K&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&quot;N&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;P&quot;</span>, <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;R&quot;</span>, <span class="string">&quot;S&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="string">&quot;U&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>,</span><br><span class="line">         <span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;m&quot;</span>, <span class="string">&quot;n&quot;</span>, <span class="string">&quot;o&quot;</span>,</span><br><span class="line">         <span class="string">&quot;p&quot;</span>, <span class="string">&quot;q&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;s&quot;</span>, <span class="string">&quot;t&quot;</span>, <span class="string">&quot;u&quot;</span>, <span class="string">&quot;v&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">yi</span>():</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> list1:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> list1:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> list1:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> list1:</span><br><span class="line">                    flag = <span class="string">&quot;&#123;0&#125;&#123;1&#125;&#123;2&#125;&#123;3&#125;&#123;4&#125;&quot;</span>.<span class="built_in">format</span>(a, b, c, d, sha_key)</span><br><span class="line">                    flag_sha = decry(flag)</span><br><span class="line">                    flag1 = flag[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">str</span>(flag_sha) == <span class="built_in">str</span>(sha_data):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&#x27;恭喜！&#x27;</span>)</span><br><span class="line">                        <span class="keyword">return</span> <span class="built_in">str</span>(flag1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.send((yi()+<span class="string">&#x27;\n&#x27;</span>).encode())</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line">s.send(<span class="string">&#x27;flag\n&#x27;</span>.encode())</span><br><span class="line">s.send(<span class="string">&#x27;flag\n&#x27;</span>.encode())</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br><span class="line"><span class="built_in">print</span>(s.recv(<span class="number">1024</span>))</span><br></pre></td></tr></table></figure>

<p>做核酸、洗澡、睡觉等事件干扰，下午三点左右方才又来看题。</p>
<p>想着勇者山峰没什么了，就登陆了传说殿堂</p>
<p>🤔奇妙啊，一样的题，一样的打法</p>
<p>发现绝对厉害的都在传说殿堂，相对厉害的全在勇者山峰</p>
<p>（到比赛结束前，传说殿堂出一道密码就已经是前30了，勇者前90</p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507204308159.png" alt="image-20220507204308159"></p>
<p>然后就去看了</p>
<h2 id="TrainPlus"><a href="#TrainPlus" class="headerlink" title="TrainPlus"></a>TrainPlus</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> MD_Train <span class="keyword">import</span> MD00Plus</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">banner = <span class="string">br&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ooooooooooooo                     o8o              ooooooooo.   oooo</span></span><br><span class="line"><span class="string">8&#x27;   888   `8                     `&quot;&#x27;              `888   `Y88. `888</span></span><br><span class="line"><span class="string">     888      oooo d8b  .oooo.   oooo  ooo. .oo.    888   .d88&#x27;  888  oooo  oooo   .oooo.o</span></span><br><span class="line"><span class="string">     888      `888&quot;&quot;8P `P  )88b  `888  `888P&quot;Y88b   888ooo88P&#x27;   888  `888  `888  d88(  &quot;8</span></span><br><span class="line"><span class="string">     888       888      .oP&quot;888   888   888   888   888          888   888   888  `&quot;Y88b.</span></span><br><span class="line"><span class="string">     888       888     d8(  888   888   888   888   888          888   888   888  o.  )88b</span></span><br><span class="line"><span class="string">    o888o     d888b    `Y888&quot;&quot;8o o888o o888o o888o o888o        o888o  `V88V&quot;V8P&#x27; 8&quot;&quot;888P&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line">sec = os.urandom(random.randrange(<span class="number">1</span>,<span class="number">26</span>))</span><br><span class="line">GreatThing = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span>(<span class="params">self</span>):</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;SERVER &lt;INPUT&gt;: &#x27;</span></span>):</span></span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        proof = (<span class="string">&#x27;&#x27;</span>.join([random.choice(table)<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])).encode()</span><br><span class="line">        sha = sha256(proof).hexdigest().encode()</span><br><span class="line">        self.send(<span class="string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="number">4</span>:] + <span class="string">b&quot;) == &quot;</span> + sha )</span><br><span class="line">        XXXX = self.recv(prompt = <span class="string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(XXXX) != <span class="number">4</span> <span class="keyword">or</span> sha256(XXXX + proof[<span class="number">4</span>:]).hexdigest().encode() != sha:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> sha.decode()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        signal.alarm(<span class="number">30</span>)</span><br><span class="line">        FirstBlockHash = self.proof_of_work()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> FirstBlockHash:</span><br><span class="line">            self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        self.send(banner)</span><br><span class="line">        self.send(<span class="string">b&quot;:) My Great Thing:&quot;</span> + GreatThing )</span><br><span class="line">        self.send(<span class="string">b&quot;:) The MD00Plus of my GREATTHING:&quot;</span> + MD00Plus(sec).encode())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">            self.send(<span class="string">b&quot;Please tell me the msg &quot;</span>)</span><br><span class="line">            msg = self.recv()</span><br><span class="line">            self.send(<span class="string">b&quot;Please tell me the hash you can forcast.&quot;</span>)</span><br><span class="line">            msg,Hash = msg.split(<span class="string">b&#x27;,&#x27;</span>)</span><br><span class="line">            msg = <span class="built_in">bytes</span>.fromhex(msg.decode())</span><br><span class="line">            Hash = <span class="built_in">bytes</span>.fromhex(Hash.decode())</span><br><span class="line">            <span class="keyword">if</span> GreatThing <span class="keyword">not</span> <span class="keyword">in</span> msg:</span><br><span class="line">                self.send(<span class="string">b&quot;[!]INVALID!&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> MD00Plus(sec + msg).encode() == Hash:</span><br><span class="line">                self.send(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;You Wrong!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ForkingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10114</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;HOST:POST &quot;</span> + HOST+<span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(PORT))</span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MD00Plus</span>(<span class="params">message: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">    h0 = <span class="number">0x114514ab</span></span><br><span class="line">    h1 = <span class="number">0x1919810a</span></span><br><span class="line">    h2 = <span class="number">0xa0189191</span></span><br><span class="line">    h3 = <span class="number">0xba415411</span></span><br><span class="line"></span><br><span class="line">    R = (<span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>) * <span class="number">4</span> + (<span class="number">5</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>) * <span class="number">4</span> + (<span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>) * <span class="number">4</span> + (<span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>) * <span class="number">4</span></span><br><span class="line">    K = (<span class="number">0xd76aa478</span>, <span class="number">0xe8c7b756</span>, <span class="number">0x242070db</span>, <span class="number">0xc1bdceee</span>,</span><br><span class="line">         <span class="number">0xf57c0faf</span>, <span class="number">0x4787c62a</span>, <span class="number">0xa8304613</span>, <span class="number">0xfd469501</span>, <span class="number">0x698098d8</span>,</span><br><span class="line">         <span class="number">0x8b44f7af</span>, <span class="number">0xffff5bb1</span>, <span class="number">0x895cd7be</span>, <span class="number">0x6b901122</span>, <span class="number">0xfd987193</span>,</span><br><span class="line">         <span class="number">0xa679438e</span>, <span class="number">0x49b40821</span>, <span class="number">0xf61e2562</span>, <span class="number">0xc040b340</span>, <span class="number">0x265e5a51</span>,</span><br><span class="line">         <span class="number">0xe9b6c7aa</span>, <span class="number">0xd62f105d</span>, <span class="number">0x02441453</span>, <span class="number">0xd8a1e681</span>, <span class="number">0xe7d3fbc8</span>,</span><br><span class="line">         <span class="number">0x21e1cde6</span>, <span class="number">0xc33707d6</span>, <span class="number">0xf4d50d87</span>, <span class="number">0x455a14ed</span>, <span class="number">0xa9e3e905</span>,</span><br><span class="line">         <span class="number">0xfcefa3f8</span>, <span class="number">0x676f02d9</span>, <span class="number">0x8d2a4c8a</span>, <span class="number">0xfffa3942</span>, <span class="number">0x8771f681</span>,</span><br><span class="line">         <span class="number">0x6d9d6122</span>, <span class="number">0xfde5380c</span>, <span class="number">0xa4beea44</span>, <span class="number">0x4bdecfa9</span>, <span class="number">0xf6bb4b60</span>,</span><br><span class="line">         <span class="number">0xbebfbc70</span>, <span class="number">0x289b7ec6</span>, <span class="number">0xeaa127fa</span>, <span class="number">0xd4ef3085</span>, <span class="number">0x04881d05</span>,</span><br><span class="line">         <span class="number">0xd9d4d039</span>, <span class="number">0xe6db99e5</span>, <span class="number">0x1fa27cf8</span>, <span class="number">0xc4ac5665</span>, <span class="number">0xf4292244</span>,</span><br><span class="line">         <span class="number">0x432aff97</span>, <span class="number">0xab9423a7</span>, <span class="number">0xfc93a039</span>, <span class="number">0x655b59c3</span>, <span class="number">0x8f0ccc92</span>,</span><br><span class="line">         <span class="number">0xffeff47d</span>, <span class="number">0x85845dd1</span>, <span class="number">0x6fa87e4f</span>, <span class="number">0xfe2ce6e0</span>, <span class="number">0xa3014314</span>,</span><br><span class="line">         <span class="number">0x4e0811a1</span>, <span class="number">0xf7537e82</span>, <span class="number">0xbd3af235</span>, <span class="number">0x2ad7d2bb</span>, <span class="number">0xeb86d391</span>)</span><br><span class="line"></span><br><span class="line">    F = <span class="keyword">lambda</span> x, y, z: ((x &amp; y) | ((~x) &amp; z))</span><br><span class="line">    G = <span class="keyword">lambda</span> x, y, z: ((x &amp; z) | (y &amp; (~z)))</span><br><span class="line">    H = <span class="keyword">lambda</span> x, y, z: (x ^ y ^ z)</span><br><span class="line">    I = <span class="keyword">lambda</span> x, y, z: (y ^ (x | (~z)))</span><br><span class="line"></span><br><span class="line">    L = <span class="keyword">lambda</span> x, n: ((x &lt;&lt; n) | (x &gt;&gt; (<span class="number">32</span> - n))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    W = <span class="keyword">lambda</span> i4, i3, i2, i1: (i1 &lt;&lt; <span class="number">24</span>) | (i2 &lt;&lt; <span class="number">16</span>) | (i3 &lt;&lt; <span class="number">8</span>) | i4</span><br><span class="line">    reverse = <span class="keyword">lambda</span> x: (x &lt;&lt; <span class="number">24</span>) &amp; <span class="number">0xff000000</span> | (x &lt;&lt; <span class="number">8</span>) &amp; <span class="number">0x00ff0000</span> | \</span><br><span class="line">                        (x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x0000ff00</span> | (x &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0x000000ff</span></span><br><span class="line"></span><br><span class="line">    ascii_list = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x, message))</span><br><span class="line">    msg_length = <span class="built_in">len</span>(ascii_list) * <span class="number">8</span></span><br><span class="line">    ascii_list.append(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">len</span>(ascii_list) * <span class="number">8</span> + <span class="number">64</span>) % <span class="number">512</span> != <span class="number">0</span>:</span><br><span class="line">        ascii_list.append(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        ascii_list.append((msg_length &gt;&gt; (<span class="number">8</span> * i)) &amp; <span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ascii_list) // <span class="number">64</span>):</span><br><span class="line">        a, b, c, d = h0, h1, h2, h3</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt;= j &lt;= <span class="number">15</span>:</span><br><span class="line">                f = F(b, c, d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">                g = j</span><br><span class="line">            <span class="keyword">elif</span> <span class="number">16</span> &lt;= j &lt;= <span class="number">31</span>:</span><br><span class="line">                f = G(b, c, d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">                g = ((<span class="number">5</span> * j) + <span class="number">1</span>) % <span class="number">16</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="number">32</span> &lt;= j &lt;= <span class="number">47</span>:</span><br><span class="line">                f = H(b, c, d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">                g = ((<span class="number">3</span> * j) + <span class="number">5</span>) % <span class="number">16</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                f = I(b, c, d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">                g = (<span class="number">7</span> * j) % <span class="number">16</span></span><br><span class="line">            aa, dd, cc = d, c, b</span><br><span class="line">            s = i * <span class="number">64</span> + g * <span class="number">4</span></span><br><span class="line">            w = W(ascii_list[s], ascii_list[s + <span class="number">1</span>], ascii_list[s + <span class="number">2</span>], ascii_list[s + <span class="number">3</span>])</span><br><span class="line">            bb = (L((a + f + K[j] + w) &amp; <span class="number">0xffffffff</span>, R[j]) + b) &amp; <span class="number">0xffffffff</span></span><br><span class="line">            a, b, c, d = aa, bb, cc, dd</span><br><span class="line">        h0 = (h0 + a) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        h1 = (h1 + b) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        h2 = (h2 + c) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        h3 = (h3 + d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    h0, h1, h2, h3 = reverse(h0), reverse(h1), reverse(h2), reverse(h3)</span><br><span class="line">    digest = (h0 &lt;&lt; <span class="number">96</span>) | (h1 &lt;&lt; <span class="number">64</span>) | (h2 &lt;&lt; <span class="number">32</span>) | h3</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(digest)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>明显感觉到复杂，没什么人出加上自己调试了半天，交互不好，作罢</p>
<p>看回了传说殿堂第一题</p>
<h2 id="bob’s-enc"><a href="#bob’s-enc" class="headerlink" title="bob’s enc"></a><strong>bob’s enc</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">prime =  <span class="number">2141</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">len</span>(flag)</span><br><span class="line">flag = <span class="built_in">map</span>(<span class="built_in">ord</span>,flag)</span><br><span class="line">flag1 = flag[:<span class="number">21</span>]</span><br><span class="line">flag2 = flag[<span class="number">21</span>:]</span><br><span class="line">row = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">msg1,msg2</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [(x+y)%prime <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(msg1,msg2)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multi</span>(<span class="params">msg1,msg2</span>):</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> msg1:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(l,msg2):</span><br><span class="line">            s += (x*y)%prime</span><br><span class="line">            s %= prime</span><br><span class="line">        out.append(s)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genkey</span>(<span class="params">leng</span>):</span></span><br><span class="line">    l = [[] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(row):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(leng):</span><br><span class="line">            l[x].append(random.randint(<span class="number">0</span>,<span class="number">511</span>))</span><br><span class="line">    <span class="keyword">return</span> l</span><br><span class="line"></span><br><span class="line">key = genkey(<span class="built_in">len</span>(flag1))</span><br><span class="line"><span class="built_in">print</span> key</span><br><span class="line"></span><br><span class="line">cipher1 = multi(key,flag1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> cipher1</span><br><span class="line"></span><br><span class="line">cipher2 = multi(key,flag2)</span><br><span class="line"></span><br><span class="line">noise = [random.randint(<span class="number">0</span>,<span class="number">6</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line"><span class="built_in">print</span> add(noise,cipher2)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">185</span>, <span class="number">96</span>, <span class="number">351</span>, <span class="number">118</span>, <span class="number">421</span>, <span class="number">449</span>, <span class="number">350</span>, <span class="number">349</span>, <span class="number">388</span>, <span class="number">95</span>, <span class="number">341</span>, <span class="number">327</span>, <span class="number">29</span>, <span class="number">156</span>, <span class="number">399</span>, <span class="number">283</span>, <span class="number">292</span>, <span class="number">461</span>, <span class="number">445</span>, <span class="number">120</span>, <span class="number">126</span>], [<span class="number">495</span>, <span class="number">358</span>, <span class="number">192</span>, <span class="number">300</span>, <span class="number">279</span>, <span class="number">277</span>, <span class="number">478</span>, <span class="number">335</span>, <span class="number">231</span>, <span class="number">241</span>, <span class="number">178</span>, <span class="number">314</span>, <span class="number">453</span>, <span class="number">251</span>, <span class="number">133</span>, <span class="number">391</span>, <span class="number">213</span>, <span class="number">132</span>, <span class="number">254</span>, <span class="number">388</span>, <span class="number">46</span>], [<span class="number">428</span>, <span class="number">44</span>, <span class="number">100</span>, <span class="number">483</span>, <span class="number">12</span>, <span class="number">311</span>, <span class="number">57</span>, <span class="number">443</span>, <span class="number">289</span>, <span class="number">90</span>, <span class="number">478</span>, <span class="number">495</span>, <span class="number">399</span>, <span class="number">89</span>, <span class="number">324</span>, <span class="number">275</span>, <span class="number">322</span>, <span class="number">99</span>, <span class="number">343</span>, <span class="number">489</span>, <span class="number">133</span>], [<span class="number">420</span>, <span class="number">358</span>, <span class="number">472</span>, <span class="number">260</span>, <span class="number">267</span>, <span class="number">136</span>, <span class="number">303</span>, <span class="number">491</span>, <span class="number">390</span>, <span class="number">248</span>, <span class="number">430</span>, <span class="number">117</span>, <span class="number">154</span>, <span class="number">244</span>, <span class="number">62</span>, <span class="number">217</span>, <span class="number">204</span>, <span class="number">334</span>, <span class="number">277</span>, <span class="number">231</span>, <span class="number">325</span>], [<span class="number">11</span>, <span class="number">96</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">456</span>, <span class="number">361</span>, <span class="number">292</span>, <span class="number">278</span>, <span class="number">424</span>, <span class="number">237</span>, <span class="number">345</span>, <span class="number">109</span>, <span class="number">475</span>, <span class="number">473</span>, <span class="number">29</span>, <span class="number">250</span>, <span class="number">195</span>, <span class="number">430</span>, <span class="number">114</span>, <span class="number">13</span>, <span class="number">199</span>], [<span class="number">17</span>, <span class="number">91</span>, <span class="number">330</span>, <span class="number">73</span>, <span class="number">384</span>, <span class="number">134</span>, <span class="number">437</span>, <span class="number">161</span>, <span class="number">166</span>, <span class="number">185</span>, <span class="number">499</span>, <span class="number">491</span>, <span class="number">342</span>, <span class="number">129</span>, <span class="number">348</span>, <span class="number">162</span>, <span class="number">478</span>, <span class="number">216</span>, <span class="number">189</span>, <span class="number">311</span>, <span class="number">502</span>], [<span class="number">396</span>, <span class="number">437</span>, <span class="number">98</span>, <span class="number">421</span>, <span class="number">120</span>, <span class="number">443</span>, <span class="number">113</span>, <span class="number">432</span>, <span class="number">9</span>, <span class="number">476</span>, <span class="number">243</span>, <span class="number">122</span>, <span class="number">416</span>, <span class="number">508</span>, <span class="number">287</span>, <span class="number">45</span>, <span class="number">84</span>, <span class="number">322</span>, <span class="number">504</span>, <span class="number">287</span>, <span class="number">251</span>], [<span class="number">187</span>, <span class="number">489</span>, <span class="number">407</span>, <span class="number">204</span>, <span class="number">127</span>, <span class="number">10</span>, <span class="number">302</span>, <span class="number">101</span>, <span class="number">389</span>, <span class="number">113</span>, <span class="number">469</span>, <span class="number">184</span>, <span class="number">249</span>, <span class="number">131</span>, <span class="number">113</span>, <span class="number">18</span>, <span class="number">350</span>, <span class="number">106</span>, <span class="number">486</span>, <span class="number">406</span>, <span class="number">295</span>], [<span class="number">265</span>, <span class="number">425</span>, <span class="number">30</span>, <span class="number">478</span>, <span class="number">471</span>, <span class="number">211</span>, <span class="number">162</span>, <span class="number">323</span>, <span class="number">163</span>, <span class="number">205</span>, <span class="number">187</span>, <span class="number">422</span>, <span class="number">452</span>, <span class="number">226</span>, <span class="number">230</span>, <span class="number">367</span>, <span class="number">478</span>, <span class="number">229</span>, <span class="number">365</span>, <span class="number">395</span>, <span class="number">294</span>], [<span class="number">360</span>, <span class="number">193</span>, <span class="number">180</span>, <span class="number">253</span>, <span class="number">337</span>, <span class="number">453</span>, <span class="number">16</span>, <span class="number">352</span>, <span class="number">243</span>, <span class="number">107</span>, <span class="number">171</span>, <span class="number">46</span>, <span class="number">25</span>, <span class="number">234</span>, <span class="number">46</span>, <span class="number">479</span>, <span class="number">267</span>, <span class="number">267</span>, <span class="number">171</span>, <span class="number">188</span>, <span class="number">127</span>], [<span class="number">379</span>, <span class="number">360</span>, <span class="number">109</span>, <span class="number">360</span>, <span class="number">403</span>, <span class="number">343</span>, <span class="number">75</span>, <span class="number">306</span>, <span class="number">138</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">253</span>, <span class="number">428</span>, <span class="number">401</span>, <span class="number">464</span>, <span class="number">495</span>, <span class="number">21</span>, <span class="number">296</span>, <span class="number">319</span>, <span class="number">410</span>, <span class="number">440</span>], [<span class="number">28</span>, <span class="number">209</span>, <span class="number">1</span>, <span class="number">233</span>, <span class="number">458</span>, <span class="number">266</span>, <span class="number">301</span>, <span class="number">359</span>, <span class="number">469</span>, <span class="number">304</span>, <span class="number">264</span>, <span class="number">368</span>, <span class="number">339</span>, <span class="number">25</span>, <span class="number">490</span>, <span class="number">343</span>, <span class="number">404</span>, <span class="number">488</span>, <span class="number">275</span>, <span class="number">262</span>, <span class="number">274</span>], [<span class="number">180</span>, <span class="number">372</span>, <span class="number">133</span>, <span class="number">341</span>, <span class="number">29</span>, <span class="number">352</span>, <span class="number">326</span>, <span class="number">89</span>, <span class="number">323</span>, <span class="number">479</span>, <span class="number">68</span>, <span class="number">76</span>, <span class="number">247</span>, <span class="number">225</span>, <span class="number">159</span>, <span class="number">163</span>, <span class="number">180</span>, <span class="number">160</span>, <span class="number">171</span>, <span class="number">7</span>, <span class="number">322</span>], [<span class="number">322</span>, <span class="number">295</span>, <span class="number">28</span>, <span class="number">467</span>, <span class="number">361</span>, <span class="number">169</span>, <span class="number">190</span>, <span class="number">71</span>, <span class="number">456</span>, <span class="number">140</span>, <span class="number">456</span>, <span class="number">202</span>, <span class="number">295</span>, <span class="number">424</span>, <span class="number">428</span>, <span class="number">18</span>, <span class="number">286</span>, <span class="number">233</span>, <span class="number">470</span>, <span class="number">303</span>, <span class="number">429</span>], [<span class="number">234</span>, <span class="number">37</span>, <span class="number">128</span>, <span class="number">175</span>, <span class="number">282</span>, <span class="number">509</span>, <span class="number">54</span>, <span class="number">186</span>, <span class="number">177</span>, <span class="number">23</span>, <span class="number">348</span>, <span class="number">487</span>, <span class="number">473</span>, <span class="number">377</span>, <span class="number">81</span>, <span class="number">225</span>, <span class="number">154</span>, <span class="number">511</span>, <span class="number">364</span>, <span class="number">120</span>, <span class="number">280</span>], [<span class="number">262</span>, <span class="number">82</span>, <span class="number">383</span>, <span class="number">490</span>, <span class="number">128</span>, <span class="number">448</span>, <span class="number">289</span>, <span class="number">420</span>, <span class="number">239</span>, <span class="number">374</span>, <span class="number">392</span>, <span class="number">149</span>, <span class="number">217</span>, <span class="number">398</span>, <span class="number">441</span>, <span class="number">480</span>, <span class="number">453</span>, <span class="number">503</span>, <span class="number">318</span>, <span class="number">285</span>, <span class="number">418</span>], [<span class="number">0</span>, <span class="number">347</span>, <span class="number">223</span>, <span class="number">381</span>, <span class="number">469</span>, <span class="number">208</span>, <span class="number">424</span>, <span class="number">435</span>, <span class="number">404</span>, <span class="number">64</span>, <span class="number">107</span>, <span class="number">73</span>, <span class="number">490</span>, <span class="number">116</span>, <span class="number">445</span>, <span class="number">392</span>, <span class="number">194</span>, <span class="number">287</span>, <span class="number">66</span>, <span class="number">325</span>, <span class="number">261</span>], [<span class="number">99</span>, <span class="number">26</span>, <span class="number">489</span>, <span class="number">114</span>, <span class="number">3</span>, <span class="number">351</span>, <span class="number">494</span>, <span class="number">174</span>, <span class="number">369</span>, <span class="number">354</span>, <span class="number">379</span>, <span class="number">187</span>, <span class="number">90</span>, <span class="number">202</span>, <span class="number">286</span>, <span class="number">37</span>, <span class="number">48</span>, <span class="number">397</span>, <span class="number">298</span>, <span class="number">65</span>, <span class="number">499</span>], [<span class="number">455</span>, <span class="number">114</span>, <span class="number">349</span>, <span class="number">401</span>, <span class="number">5</span>, <span class="number">139</span>, <span class="number">314</span>, <span class="number">227</span>, <span class="number">134</span>, <span class="number">258</span>, <span class="number">270</span>, <span class="number">135</span>, <span class="number">287</span>, <span class="number">332</span>, <span class="number">298</span>, <span class="number">272</span>, <span class="number">167</span>, <span class="number">43</span>, <span class="number">271</span>, <span class="number">484</span>, <span class="number">177</span>], [<span class="number">448</span>, <span class="number">78</span>, <span class="number">479</span>, <span class="number">324</span>, <span class="number">170</span>, <span class="number">7</span>, <span class="number">230</span>, <span class="number">173</span>, <span class="number">214</span>, <span class="number">65</span>, <span class="number">91</span>, <span class="number">497</span>, <span class="number">68</span>, <span class="number">391</span>, <span class="number">44</span>, <span class="number">205</span>, <span class="number">364</span>, <span class="number">471</span>, <span class="number">460</span>, <span class="number">312</span>, <span class="number">122</span>], [<span class="number">452</span>, <span class="number">360</span>, <span class="number">448</span>, <span class="number">169</span>, <span class="number">240</span>, <span class="number">496</span>, <span class="number">302</span>, <span class="number">3</span>, <span class="number">354</span>, <span class="number">266</span>, <span class="number">46</span>, <span class="number">22</span>, <span class="number">151</span>, <span class="number">498</span>, <span class="number">461</span>, <span class="number">314</span>, <span class="number">169</span>, <span class="number">88</span>, <span class="number">30</span>, <span class="number">487</span>, <span class="number">258</span>], [<span class="number">282</span>, <span class="number">222</span>, <span class="number">260</span>, <span class="number">503</span>, <span class="number">106</span>, <span class="number">420</span>, <span class="number">315</span>, <span class="number">307</span>, <span class="number">202</span>, <span class="number">238</span>, <span class="number">224</span>, <span class="number">329</span>, <span class="number">351</span>, <span class="number">190</span>, <span class="number">137</span>, <span class="number">294</span>, <span class="number">171</span>, <span class="number">309</span>, <span class="number">19</span>, <span class="number">186</span>, <span class="number">391</span>], [<span class="number">69</span>, <span class="number">501</span>, <span class="number">283</span>, <span class="number">96</span>, <span class="number">159</span>, <span class="number">459</span>, <span class="number">437</span>, <span class="number">192</span>, <span class="number">293</span>, <span class="number">479</span>, <span class="number">79</span>, <span class="number">49</span>, <span class="number">299</span>, <span class="number">205</span>, <span class="number">177</span>, <span class="number">360</span>, <span class="number">36</span>, <span class="number">414</span>, <span class="number">118</span>, <span class="number">194</span>, <span class="number">270</span>], [<span class="number">6</span>, <span class="number">419</span>, <span class="number">459</span>, <span class="number">254</span>, <span class="number">97</span>, <span class="number">455</span>, <span class="number">445</span>, <span class="number">239</span>, <span class="number">277</span>, <span class="number">278</span>, <span class="number">226</span>, <span class="number">23</span>, <span class="number">146</span>, <span class="number">151</span>, <span class="number">273</span>, <span class="number">378</span>, <span class="number">141</span>, <span class="number">281</span>, <span class="number">480</span>, <span class="number">388</span>, <span class="number">213</span>], [<span class="number">181</span>, <span class="number">508</span>, <span class="number">347</span>, <span class="number">447</span>, <span class="number">467</span>, <span class="number">351</span>, <span class="number">503</span>, <span class="number">262</span>, <span class="number">375</span>, <span class="number">74</span>, <span class="number">49</span>, <span class="number">48</span>, <span class="number">364</span>, <span class="number">492</span>, <span class="number">400</span>, <span class="number">305</span>, <span class="number">25</span>, <span class="number">207</span>, <span class="number">278</span>, <span class="number">163</span>, <span class="number">11</span>], [<span class="number">320</span>, <span class="number">94</span>, <span class="number">400</span>, <span class="number">15</span>, <span class="number">201</span>, <span class="number">53</span>, <span class="number">130</span>, <span class="number">137</span>, <span class="number">219</span>, <span class="number">57</span>, <span class="number">20</span>, <span class="number">239</span>, <span class="number">467</span>, <span class="number">352</span>, <span class="number">373</span>, <span class="number">395</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">446</span>, <span class="number">332</span>, <span class="number">41</span>], [<span class="number">205</span>, <span class="number">385</span>, <span class="number">446</span>, <span class="number">185</span>, <span class="number">470</span>, <span class="number">268</span>, <span class="number">308</span>, <span class="number">461</span>, <span class="number">265</span>, <span class="number">75</span>, <span class="number">75</span>, <span class="number">104</span>, <span class="number">108</span>, <span class="number">14</span>, <span class="number">334</span>, <span class="number">499</span>, <span class="number">207</span>, <span class="number">363</span>, <span class="number">94</span>, <span class="number">505</span>, <span class="number">363</span>], [<span class="number">299</span>, <span class="number">292</span>, <span class="number">112</span>, <span class="number">203</span>, <span class="number">7</span>, <span class="number">240</span>, <span class="number">499</span>, <span class="number">343</span>, <span class="number">396</span>, <span class="number">482</span>, <span class="number">383</span>, <span class="number">61</span>, <span class="number">476</span>, <span class="number">101</span>, <span class="number">187</span>, <span class="number">265</span>, <span class="number">428</span>, <span class="number">53</span>, <span class="number">24</span>, <span class="number">342</span>, <span class="number">201</span>], [<span class="number">421</span>, <span class="number">286</span>, <span class="number">305</span>, <span class="number">79</span>, <span class="number">324</span>, <span class="number">216</span>, <span class="number">163</span>, <span class="number">193</span>, <span class="number">362</span>, <span class="number">57</span>, <span class="number">472</span>, <span class="number">449</span>, <span class="number">169</span>, <span class="number">33</span>, <span class="number">280</span>, <span class="number">202</span>, <span class="number">237</span>, <span class="number">376</span>, <span class="number">382</span>, <span class="number">2</span>, <span class="number">1</span>], [<span class="number">379</span>, <span class="number">33</span>, <span class="number">151</span>, <span class="number">51</span>, <span class="number">353</span>, <span class="number">295</span>, <span class="number">145</span>, <span class="number">220</span>, <span class="number">147</span>, <span class="number">251</span>, <span class="number">90</span>, <span class="number">344</span>, <span class="number">96</span>, <span class="number">31</span>, <span class="number">185</span>, <span class="number">250</span>, <span class="number">270</span>, <span class="number">420</span>, <span class="number">365</span>, <span class="number">373</span>, <span class="number">356</span>], [<span class="number">228</span>, <span class="number">299</span>, <span class="number">87</span>, <span class="number">113</span>, <span class="number">458</span>, <span class="number">52</span>, <span class="number">26</span>, <span class="number">228</span>, <span class="number">294</span>, <span class="number">97</span>, <span class="number">384</span>, <span class="number">493</span>, <span class="number">380</span>, <span class="number">209</span>, <span class="number">257</span>, <span class="number">20</span>, <span class="number">375</span>, <span class="number">2</span>, <span class="number">316</span>, <span class="number">129</span>, <span class="number">492</span>], [<span class="number">479</span>, <span class="number">346</span>, <span class="number">57</span>, <span class="number">488</span>, <span class="number">183</span>, <span class="number">185</span>, <span class="number">18</span>, <span class="number">422</span>, <span class="number">209</span>, <span class="number">318</span>, <span class="number">461</span>, <span class="number">159</span>, <span class="number">469</span>, <span class="number">145</span>, <span class="number">44</span>, <span class="number">58</span>, <span class="number">441</span>, <span class="number">490</span>, <span class="number">510</span>, <span class="number">194</span>, <span class="number">192</span>], [<span class="number">254</span>, <span class="number">398</span>, <span class="number">510</span>, <span class="number">159</span>, <span class="number">371</span>, <span class="number">280</span>, <span class="number">331</span>, <span class="number">23</span>, <span class="number">99</span>, <span class="number">150</span>, <span class="number">175</span>, <span class="number">151</span>, <span class="number">42</span>, <span class="number">473</span>, <span class="number">164</span>, <span class="number">35</span>, <span class="number">97</span>, <span class="number">174</span>, <span class="number">115</span>, <span class="number">24</span>, <span class="number">270</span>], [<span class="number">280</span>, <span class="number">76</span>, <span class="number">254</span>, <span class="number">293</span>, <span class="number">491</span>, <span class="number">76</span>, <span class="number">128</span>, <span class="number">301</span>, <span class="number">240</span>, <span class="number">357</span>, <span class="number">192</span>, <span class="number">372</span>, <span class="number">343</span>, <span class="number">34</span>, <span class="number">386</span>, <span class="number">468</span>, <span class="number">313</span>, <span class="number">41</span>, <span class="number">285</span>, <span class="number">507</span>, <span class="number">282</span>], [<span class="number">271</span>, <span class="number">91</span>, <span class="number">507</span>, <span class="number">16</span>, <span class="number">128</span>, <span class="number">8</span>, <span class="number">326</span>, <span class="number">102</span>, <span class="number">355</span>, <span class="number">371</span>, <span class="number">313</span>, <span class="number">292</span>, <span class="number">433</span>, <span class="number">2</span>, <span class="number">459</span>, <span class="number">14</span>, <span class="number">258</span>, <span class="number">498</span>, <span class="number">146</span>, <span class="number">446</span>, <span class="number">309</span>], [<span class="number">386</span>, <span class="number">88</span>, <span class="number">502</span>, <span class="number">4</span>, <span class="number">399</span>, <span class="number">272</span>, <span class="number">49</span>, <span class="number">69</span>, <span class="number">51</span>, <span class="number">465</span>, <span class="number">291</span>, <span class="number">289</span>, <span class="number">417</span>, <span class="number">271</span>, <span class="number">374</span>, <span class="number">337</span>, <span class="number">46</span>, <span class="number">393</span>, <span class="number">19</span>, <span class="number">429</span>, <span class="number">91</span>], [<span class="number">407</span>, <span class="number">35</span>, <span class="number">337</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">460</span>, <span class="number">222</span>, <span class="number">448</span>, <span class="number">499</span>, <span class="number">381</span>, <span class="number">59</span>, <span class="number">468</span>, <span class="number">440</span>, <span class="number">216</span>, <span class="number">86</span>, <span class="number">236</span>, <span class="number">91</span>, <span class="number">18</span>, <span class="number">123</span>, <span class="number">68</span>, <span class="number">145</span>], [<span class="number">384</span>, <span class="number">30</span>, <span class="number">454</span>, <span class="number">419</span>, <span class="number">275</span>, <span class="number">164</span>, <span class="number">72</span>, <span class="number">195</span>, <span class="number">489</span>, <span class="number">458</span>, <span class="number">419</span>, <span class="number">148</span>, <span class="number">269</span>, <span class="number">150</span>, <span class="number">358</span>, <span class="number">188</span>, <span class="number">109</span>, <span class="number">27</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">123</span>], [<span class="number">500</span>, <span class="number">184</span>, <span class="number">195</span>, <span class="number">193</span>, <span class="number">68</span>, <span class="number">19</span>, <span class="number">329</span>, <span class="number">511</span>, <span class="number">280</span>, <span class="number">69</span>, <span class="number">113</span>, <span class="number">124</span>, <span class="number">102</span>, <span class="number">274</span>, <span class="number">43</span>, <span class="number">374</span>, <span class="number">408</span>, <span class="number">64</span>, <span class="number">314</span>, <span class="number">309</span>, <span class="number">473</span>], [<span class="number">72</span>, <span class="number">145</span>, <span class="number">242</span>, <span class="number">2</span>, <span class="number">367</span>, <span class="number">371</span>, <span class="number">143</span>, <span class="number">166</span>, <span class="number">325</span>, <span class="number">74</span>, <span class="number">414</span>, <span class="number">94</span>, <span class="number">269</span>, <span class="number">196</span>, <span class="number">124</span>, <span class="number">94</span>, <span class="number">14</span>, <span class="number">351</span>, <span class="number">111</span>, <span class="number">465</span>, <span class="number">503</span>], [<span class="number">70</span>, <span class="number">47</span>, <span class="number">439</span>, <span class="number">170</span>, <span class="number">306</span>, <span class="number">82</span>, <span class="number">233</span>, <span class="number">36</span>, <span class="number">346</span>, <span class="number">234</span>, <span class="number">157</span>, <span class="number">468</span>, <span class="number">83</span>, <span class="number">85</span>, <span class="number">424</span>, <span class="number">157</span>, <span class="number">258</span>, <span class="number">120</span>, <span class="number">270</span>, <span class="number">136</span>, <span class="number">286</span>], [<span class="number">442</span>, <span class="number">173</span>, <span class="number">254</span>, <span class="number">271</span>, <span class="number">420</span>, <span class="number">507</span>, <span class="number">297</span>, <span class="number">473</span>, <span class="number">296</span>, <span class="number">511</span>, <span class="number">98</span>, <span class="number">133</span>, <span class="number">37</span>, <span class="number">498</span>, <span class="number">468</span>, <span class="number">17</span>, <span class="number">260</span>, <span class="number">318</span>, <span class="number">168</span>, <span class="number">490</span>, <span class="number">124</span>], [<span class="number">50</span>, <span class="number">35</span>, <span class="number">252</span>, <span class="number">472</span>, <span class="number">406</span>, <span class="number">400</span>, <span class="number">439</span>, <span class="number">89</span>, <span class="number">309</span>, <span class="number">393</span>, <span class="number">332</span>, <span class="number">324</span>, <span class="number">260</span>, <span class="number">215</span>, <span class="number">8</span>, <span class="number">322</span>, <span class="number">357</span>, <span class="number">252</span>, <span class="number">124</span>, <span class="number">358</span>, <span class="number">457</span>], [<span class="number">93</span>, <span class="number">102</span>, <span class="number">478</span>, <span class="number">224</span>, <span class="number">428</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">368</span>, <span class="number">113</span>, <span class="number">502</span>, <span class="number">148</span>, <span class="number">7</span>, <span class="number">395</span>, <span class="number">97</span>, <span class="number">73</span>, <span class="number">306</span>, <span class="number">40</span>, <span class="number">395</span>, <span class="number">9</span>, <span class="number">254</span>, <span class="number">319</span>], [<span class="number">282</span>, <span class="number">277</span>, <span class="number">295</span>, <span class="number">425</span>, <span class="number">59</span>, <span class="number">21</span>, <span class="number">136</span>, <span class="number">230</span>, <span class="number">207</span>, <span class="number">1</span>, <span class="number">29</span>, <span class="number">170</span>, <span class="number">14</span>, <span class="number">337</span>, <span class="number">371</span>, <span class="number">437</span>, <span class="number">359</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">374</span>, <span class="number">24</span>], [<span class="number">3</span>, <span class="number">270</span>, <span class="number">289</span>, <span class="number">179</span>, <span class="number">434</span>, <span class="number">489</span>, <span class="number">470</span>, <span class="number">343</span>, <span class="number">478</span>, <span class="number">156</span>, <span class="number">177</span>, <span class="number">72</span>, <span class="number">13</span>, <span class="number">266</span>, <span class="number">475</span>, <span class="number">23</span>, <span class="number">148</span>, <span class="number">102</span>, <span class="number">210</span>, <span class="number">270</span>, <span class="number">323</span>], [<span class="number">464</span>, <span class="number">466</span>, <span class="number">277</span>, <span class="number">191</span>, <span class="number">426</span>, <span class="number">20</span>, <span class="number">266</span>, <span class="number">33</span>, <span class="number">41</span>, <span class="number">249</span>, <span class="number">452</span>, <span class="number">475</span>, <span class="number">265</span>, <span class="number">421</span>, <span class="number">282</span>, <span class="number">250</span>, <span class="number">233</span>, <span class="number">287</span>, <span class="number">495</span>, <span class="number">170</span>, <span class="number">300</span>], [<span class="number">379</span>, <span class="number">35</span>, <span class="number">137</span>, <span class="number">106</span>, <span class="number">155</span>, <span class="number">81</span>, <span class="number">154</span>, <span class="number">382</span>, <span class="number">30</span>, <span class="number">237</span>, <span class="number">294</span>, <span class="number">478</span>, <span class="number">321</span>, <span class="number">384</span>, <span class="number">48</span>, <span class="number">111</span>, <span class="number">150</span>, <span class="number">4</span>, <span class="number">454</span>, <span class="number">446</span>, <span class="number">28</span>], [<span class="number">57</span>, <span class="number">355</span>, <span class="number">94</span>, <span class="number">253</span>, <span class="number">297</span>, <span class="number">424</span>, <span class="number">415</span>, <span class="number">480</span>, <span class="number">68</span>, <span class="number">356</span>, <span class="number">415</span>, <span class="number">73</span>, <span class="number">41</span>, <span class="number">171</span>, <span class="number">491</span>, <span class="number">130</span>, <span class="number">92</span>, <span class="number">180</span>, <span class="number">506</span>, <span class="number">326</span>, <span class="number">463</span>], [<span class="number">279</span>, <span class="number">43</span>, <span class="number">202</span>, <span class="number">35</span>, <span class="number">397</span>, <span class="number">257</span>, <span class="number">120</span>, <span class="number">11</span>, <span class="number">231</span>, <span class="number">369</span>, <span class="number">221</span>, <span class="number">332</span>, <span class="number">47</span>, <span class="number">236</span>, <span class="number">58</span>, <span class="number">278</span>, <span class="number">75</span>, <span class="number">117</span>, <span class="number">33</span>, <span class="number">130</span>, <span class="number">358</span>], [<span class="number">142</span>, <span class="number">335</span>, <span class="number">339</span>, <span class="number">112</span>, <span class="number">38</span>, <span class="number">82</span>, <span class="number">426</span>, <span class="number">211</span>, <span class="number">174</span>, <span class="number">389</span>, <span class="number">137</span>, <span class="number">96</span>, <span class="number">431</span>, <span class="number">113</span>, <span class="number">112</span>, <span class="number">500</span>, <span class="number">145</span>, <span class="number">44</span>, <span class="number">313</span>, <span class="number">96</span>, <span class="number">187</span>], [<span class="number">246</span>, <span class="number">211</span>, <span class="number">400</span>, <span class="number">415</span>, <span class="number">294</span>, <span class="number">234</span>, <span class="number">367</span>, <span class="number">46</span>, <span class="number">371</span>, <span class="number">479</span>, <span class="number">412</span>, <span class="number">197</span>, <span class="number">204</span>, <span class="number">498</span>, <span class="number">18</span>, <span class="number">140</span>, <span class="number">67</span>, <span class="number">237</span>, <span class="number">510</span>, <span class="number">457</span>, <span class="number">298</span>], [<span class="number">258</span>, <span class="number">3</span>, <span class="number">136</span>, <span class="number">284</span>, <span class="number">149</span>, <span class="number">161</span>, <span class="number">456</span>, <span class="number">122</span>, <span class="number">114</span>, <span class="number">383</span>, <span class="number">251</span>, <span class="number">240</span>, <span class="number">453</span>, <span class="number">227</span>, <span class="number">330</span>, <span class="number">33</span>, <span class="number">241</span>, <span class="number">160</span>, <span class="number">306</span>, <span class="number">254</span>, <span class="number">409</span>], [<span class="number">391</span>, <span class="number">115</span>, <span class="number">92</span>, <span class="number">102</span>, <span class="number">359</span>, <span class="number">182</span>, <span class="number">489</span>, <span class="number">313</span>, <span class="number">204</span>, <span class="number">275</span>, <span class="number">206</span>, <span class="number">447</span>, <span class="number">436</span>, <span class="number">286</span>, <span class="number">229</span>, <span class="number">377</span>, <span class="number">374</span>, <span class="number">162</span>, <span class="number">22</span>, <span class="number">384</span>, <span class="number">40</span>], [<span class="number">427</span>, <span class="number">491</span>, <span class="number">362</span>, <span class="number">240</span>, <span class="number">358</span>, <span class="number">296</span>, <span class="number">154</span>, <span class="number">178</span>, <span class="number">278</span>, <span class="number">284</span>, <span class="number">324</span>, <span class="number">422</span>, <span class="number">52</span>, <span class="number">295</span>, <span class="number">490</span>, <span class="number">56</span>, <span class="number">39</span>, <span class="number">378</span>, <span class="number">174</span>, <span class="number">202</span>, <span class="number">496</span>], [<span class="number">29</span>, <span class="number">454</span>, <span class="number">436</span>, <span class="number">6</span>, <span class="number">287</span>, <span class="number">82</span>, <span class="number">154</span>, <span class="number">474</span>, <span class="number">92</span>, <span class="number">272</span>, <span class="number">400</span>, <span class="number">238</span>, <span class="number">352</span>, <span class="number">140</span>, <span class="number">386</span>, <span class="number">504</span>, <span class="number">19</span>, <span class="number">32</span>, <span class="number">334</span>, <span class="number">30</span>, <span class="number">450</span>], [<span class="number">469</span>, <span class="number">123</span>, <span class="number">353</span>, <span class="number">422</span>, <span class="number">175</span>, <span class="number">260</span>, <span class="number">294</span>, <span class="number">18</span>, <span class="number">268</span>, <span class="number">479</span>, <span class="number">60</span>, <span class="number">114</span>, <span class="number">456</span>, <span class="number">55</span>, <span class="number">403</span>, <span class="number">446</span>, <span class="number">166</span>, <span class="number">259</span>, <span class="number">294</span>, <span class="number">215</span>, <span class="number">48</span>], [<span class="number">404</span>, <span class="number">187</span>, <span class="number">426</span>, <span class="number">362</span>, <span class="number">296</span>, <span class="number">239</span>, <span class="number">226</span>, <span class="number">416</span>, <span class="number">306</span>, <span class="number">336</span>, <span class="number">1</span>, <span class="number">448</span>, <span class="number">47</span>, <span class="number">403</span>, <span class="number">367</span>, <span class="number">357</span>, <span class="number">501</span>, <span class="number">425</span>, <span class="number">310</span>, <span class="number">41</span>, <span class="number">303</span>], [<span class="number">339</span>, <span class="number">115</span>, <span class="number">478</span>, <span class="number">416</span>, <span class="number">10</span>, <span class="number">90</span>, <span class="number">188</span>, <span class="number">229</span>, <span class="number">217</span>, <span class="number">441</span>, <span class="number">288</span>, <span class="number">152</span>, <span class="number">394</span>, <span class="number">219</span>, <span class="number">422</span>, <span class="number">376</span>, <span class="number">325</span>, <span class="number">375</span>, <span class="number">6</span>, <span class="number">454</span>, <span class="number">238</span>], [<span class="number">226</span>, <span class="number">226</span>, <span class="number">149</span>, <span class="number">107</span>, <span class="number">418</span>, <span class="number">419</span>, <span class="number">209</span>, <span class="number">108</span>, <span class="number">87</span>, <span class="number">127</span>, <span class="number">202</span>, <span class="number">320</span>, <span class="number">179</span>, <span class="number">234</span>, <span class="number">87</span>, <span class="number">335</span>, <span class="number">195</span>, <span class="number">5</span>, <span class="number">273</span>, <span class="number">142</span>, <span class="number">115</span>], [<span class="number">464</span>, <span class="number">177</span>, <span class="number">77</span>, <span class="number">101</span>, <span class="number">76</span>, <span class="number">19</span>, <span class="number">73</span>, <span class="number">397</span>, <span class="number">296</span>, <span class="number">34</span>, <span class="number">360</span>, <span class="number">107</span>, <span class="number">491</span>, <span class="number">460</span>, <span class="number">510</span>, <span class="number">342</span>, <span class="number">198</span>, <span class="number">118</span>, <span class="number">105</span>, <span class="number">337</span>, <span class="number">239</span>], [<span class="number">464</span>, <span class="number">25</span>, <span class="number">191</span>, <span class="number">113</span>, <span class="number">455</span>, <span class="number">129</span>, <span class="number">247</span>, <span class="number">488</span>, <span class="number">303</span>, <span class="number">27</span>, <span class="number">242</span>, <span class="number">423</span>, <span class="number">336</span>, <span class="number">125</span>, <span class="number">283</span>, <span class="number">332</span>, <span class="number">244</span>, <span class="number">372</span>, <span class="number">175</span>, <span class="number">276</span>, <span class="number">49</span>], [<span class="number">211</span>, <span class="number">367</span>, <span class="number">406</span>, <span class="number">314</span>, <span class="number">177</span>, <span class="number">496</span>, <span class="number">320</span>, <span class="number">385</span>, <span class="number">193</span>, <span class="number">51</span>, <span class="number">423</span>, <span class="number">80</span>, <span class="number">258</span>, <span class="number">44</span>, <span class="number">154</span>, <span class="number">362</span>, <span class="number">215</span>, <span class="number">296</span>, <span class="number">260</span>, <span class="number">424</span>, <span class="number">160</span>], [<span class="number">384</span>, <span class="number">161</span>, <span class="number">92</span>, <span class="number">402</span>, <span class="number">414</span>, <span class="number">443</span>, <span class="number">129</span>, <span class="number">279</span>, <span class="number">272</span>, <span class="number">224</span>, <span class="number">294</span>, <span class="number">319</span>, <span class="number">75</span>, <span class="number">169</span>, <span class="number">242</span>, <span class="number">85</span>, <span class="number">315</span>, <span class="number">402</span>, <span class="number">4</span>, <span class="number">268</span>, <span class="number">88</span>]]</span><br><span class="line">[<span class="number">1702</span>, <span class="number">795</span>, <span class="number">740</span>, <span class="number">373</span>, <span class="number">535</span>, <span class="number">1308</span>, <span class="number">1050</span>, <span class="number">502</span>, <span class="number">40</span>, <span class="number">672</span>, <span class="number">1354</span>, <span class="number">1843</span>, <span class="number">515</span>, <span class="number">231</span>, <span class="number">774</span>, <span class="number">65</span>, <span class="number">978</span>, <span class="number">1340</span>, <span class="number">455</span>, <span class="number">2137</span>, <span class="number">733</span>, <span class="number">307</span>, <span class="number">1604</span>, <span class="number">723</span>, <span class="number">1023</span>, <span class="number">1253</span>, <span class="number">275</span>, <span class="number">1817</span>, <span class="number">404</span>, <span class="number">2035</span>, <span class="number">267</span>, <span class="number">1475</span>, <span class="number">14</span>, <span class="number">2127</span>, <span class="number">15</span>, <span class="number">487</span>, <span class="number">317</span>, <span class="number">757</span>, <span class="number">290</span>, <span class="number">541</span>, <span class="number">100</span>, <span class="number">951</span>, <span class="number">2049</span>, <span class="number">1042</span>, <span class="number">1404</span>, <span class="number">1676</span>, <span class="number">655</span>, <span class="number">1460</span>, <span class="number">1532</span>, <span class="number">273</span>, <span class="number">916</span>, <span class="number">1454</span>, <span class="number">1690</span>, <span class="number">1628</span>, <span class="number">1751</span>, <span class="number">1656</span>, <span class="number">139</span>, <span class="number">156</span>, <span class="number">2102</span>, <span class="number">264</span>, <span class="number">243</span>, <span class="number">455</span>, <span class="number">1564</span>, <span class="number">2072</span>]</span><br><span class="line">[<span class="number">884</span>, <span class="number">1584</span>, <span class="number">681</span>, <span class="number">1713</span>, <span class="number">1916</span>, <span class="number">609</span>, <span class="number">1840</span>, <span class="number">177</span>, <span class="number">1723</span>, <span class="number">1049</span>, <span class="number">254</span>, <span class="number">864</span>, <span class="number">1671</span>, <span class="number">121</span>, <span class="number">2021</span>, <span class="number">1353</span>, <span class="number">1290</span>, <span class="number">1891</span>, <span class="number">556</span>, <span class="number">1786</span>, <span class="number">1553</span>, <span class="number">1548</span>, <span class="number">727</span>, <span class="number">1967</span>, <span class="number">1800</span>, <span class="number">422</span>, <span class="number">1559</span>, <span class="number">1290</span>, <span class="number">642</span>, <span class="number">1406</span>, <span class="number">441</span>, <span class="number">1928</span>, <span class="number">395</span>, <span class="number">279</span>, <span class="number">1125</span>, <span class="number">1273</span>, <span class="number">99</span>, <span class="number">1131</span>, <span class="number">395</span>, <span class="number">76</span>, <span class="number">733</span>, <span class="number">416</span>, <span class="number">924</span>, <span class="number">571</span>, <span class="number">506</span>, <span class="number">822</span>, <span class="number">877</span>, <span class="number">887</span>, <span class="number">860</span>, <span class="number">1755</span>, <span class="number">1385</span>, <span class="number">1861</span>, <span class="number">1754</span>, <span class="number">1851</span>, <span class="number">1046</span>, <span class="number">1724</span>, <span class="number">1866</span>, <span class="number">1427</span>, <span class="number">378</span>, <span class="number">351</span>, <span class="number">146</span>, <span class="number">1367</span>, <span class="number">756</span>, <span class="number">505</span>]</span><br></pre></td></tr></table></figure>

<p>la佬一🩸，好奇心拉满，于是开始研究起来了</p>
<p>化简，易得解flag1要点：<strong>单模多元线性同余方程</strong></p>
<p>就着csdn现学，效率过低🤔</p>
<p>放弃之际，在github上搜到了<a target="_blank" rel="noopener" href="https://github.com/55-AA/mod_equations">优秀的代码</a></p>
<p>处理好数据，解方程，得到前半段flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Author @55-AA</span></span><br><span class="line"><span class="string">19 July, 2016</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Return the greatest common denominator of integers a and b.</span></span><br><span class="line"><span class="string">    gmpy2.gcd(a, b)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a % b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lcm</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> a * b / (gcd(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ax + by = 1</span></span><br><span class="line"><span class="string">    ax ≡ 1 mod b</span></span><br><span class="line"><span class="string">    Return a 3-element tuple (g, x, y), the g  = gcd(a, b)</span></span><br><span class="line"><span class="string">    gmpy2.gcdext(a, b)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mod_inv</span>(<span class="params">a, m</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ax ≡ 1 mod m</span></span><br><span class="line"><span class="string">    gmpy2.invert(a, m)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">assert</span> g == <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2mem</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    0x12233 =&gt; &#x27;\x33\x22\x01&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    pad_even = <span class="keyword">lambda</span> x: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)[<span class="built_in">len</span>(x) % <span class="number">2</span>] + x</span><br><span class="line">    x = <span class="built_in">list</span>(pad_even(<span class="built_in">format</span>(x, <span class="string">&#x27;x&#x27;</span>)).decode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line">    x.reverse()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mem2int</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    &#x27;\x33\x22\x01&#x27; =&gt; 0x12233</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    x = <span class="built_in">list</span>(x)</span><br><span class="line">    x.reverse()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(x).encode(<span class="string">&#x27;hex&#x27;</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"><span class="comment"># class</span></span><br><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GaussMatrix</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    A*X ≡ B (mod p),p为大于0的整数。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    高斯消元求解模线性方程组。先化简为上三角，然后回代求解。</span></span><br><span class="line"><span class="string">    当r(A) &lt;= n时，一定有多解；</span></span><br><span class="line"><span class="string">    当r(A) == n时，有多解或唯一解；</span></span><br><span class="line"><span class="string">    当r(A) != r(A~)时，无解。</span></span><br><span class="line"><span class="string">    r(A)为系数矩阵的秩，r(A)为增广矩阵的秩，n为未知数的个数。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    http://www.docin.com/p-1063811671.html讨论了gcd(|A|, m) = 1时的LU分解解法，</span></span><br><span class="line"><span class="string">    本文包括了gcd(|A|, m) &gt; 1时的解法，</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    化简原则：</span></span><br><span class="line"><span class="string">        1、系数与模互质</span></span><br><span class="line"><span class="string">        2、系数加某一行n次后，对应的系数与模的GCD最小</span></span><br><span class="line"><span class="string">        3、将1或2得到的系数移到对角线上</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    初始化参数：</span></span><br><span class="line"><span class="string">        matrix：方程组的增广矩阵（最后一列为常数项）。</span></span><br><span class="line"><span class="string">            matrix = [</span></span><br><span class="line"><span class="string">                [ 69,  75,  78,  36,  58],</span></span><br><span class="line"><span class="string">                [ 46,  68,  51,  26,  42],</span></span><br><span class="line"><span class="string">                [ 76,  40,  42,  49,  11],</span></span><br><span class="line"><span class="string">                [ 11,  45,   2,  45,   1],</span></span><br><span class="line"><span class="string">                [ 15,  67,  60,  14,  72],</span></span><br><span class="line"><span class="string">                [ 76,  67,  73,  56,  58],</span></span><br><span class="line"><span class="string">                [ 67,  15,  68,  54,  75],</span></span><br><span class="line"><span class="string">            ]    </span></span><br><span class="line"><span class="string">        mod：模数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    函数：</span></span><br><span class="line"><span class="string">        gauss()：求解方程</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    输出变量：</span></span><br><span class="line"><span class="string">        error_str：出错的信息</span></span><br><span class="line"><span class="string">        count：解的数量</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, matrix, mod</span>):</span></span><br><span class="line">        self.matrix = copy.deepcopy(matrix)</span><br><span class="line">        self.d = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        self.r = <span class="built_in">len</span>(matrix)</span><br><span class="line">        self.c = <span class="built_in">len</span>(matrix[<span class="number">0</span>])</span><br><span class="line">        self.N = <span class="built_in">len</span>(matrix[<span class="number">0</span>]) - <span class="number">1</span></span><br><span class="line">        self.mod = mod</span><br><span class="line">        self.count = <span class="number">1</span></span><br><span class="line">        self.error_str = <span class="string">&quot;unknown error&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify_solution</span>(<span class="params">self, solution</span>):</span></span><br><span class="line">        <span class="keyword">for</span> d <span class="keyword">in</span> self.matrix:</span><br><span class="line">            result = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: <span class="number">0</span> <span class="keyword">if</span> <span class="literal">None</span> == y <span class="keyword">else</span> x * y, d, solution):</span><br><span class="line">                result += r</span><br><span class="line">            <span class="keyword">if</span> (result % self.mod) != ((d[-<span class="number">1</span>]) % self.mod):</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">swap_row</span>(<span class="params">self, ra, rb</span>):</span></span><br><span class="line">        (self.d[ra], self.d[rb]) = (self.d[rb], self.d[ra])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">swap_col</span>(<span class="params">self, ca, cb</span>):</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(self.r):</span><br><span class="line">            (self.d[j][ca], self.d[j][cb]) = (self.d[j][cb], self.d[j][ca])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inv_result</span>(<span class="params">self, r, n</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        求解第n个未知数，r已经获得的解。形如：[None,None, ..., n+1, ...]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        a*x ≡ b(mod m)</span></span><br><span class="line"><span class="string">        x有解的条件：gcd(a,m) | b。也即a,m互质时一定有解，不互质时，b整除gcd(a,m)也有解，否则无解。</span></span><br><span class="line"><span class="string">        解的格式为：x0+k(m/gcd(a,m))，其中x0为最小整数特解，k为任意整数。</span></span><br><span class="line"><span class="string">        返回[x0, x1, ...xn]，其中x0 &lt; x1 &lt; xn &lt; m。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        b = self.d[n][self.N]</span><br><span class="line">        a = self.d[n][n]</span><br><span class="line">        m = self.mod</span><br><span class="line">        k = gcd(a, m)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(n + <span class="number">1</span>, self.N):</span><br><span class="line">            b = (b - (self.d[n][j] * r[j] % m)) % m</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> == k:</span><br><span class="line">            <span class="keyword">return</span> [mod_inv(a, m) * b % m]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> k == gcd(k, b):</span><br><span class="line">                a /= k</span><br><span class="line">                b /= k</span><br><span class="line">                m /= k</span><br><span class="line"></span><br><span class="line">                x0 = mod_inv(a, m) * b % m</span><br><span class="line">                x = []</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> xrange(k):</span><br><span class="line">                    x.append(x0 + m * i)</span><br><span class="line">                <span class="keyword">return</span> x</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_min_gcd_row_col</span>(<span class="params">self, i, j</span>):</span></span><br><span class="line">        <span class="comment"># 查找直接互质的对角线系数</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> xrange(i, self.r):</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> xrange(j, self.c - <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">1</span> == gcd(self.d[k][l], self.mod)):</span><br><span class="line">                    <span class="keyword">return</span> [k, l]</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">add_min_gcd</span>(<span class="params">a, b, m</span>):</span></span><br><span class="line">            r = [m, <span class="number">1</span>]</span><br><span class="line">            g = gcd(a, b)</span><br><span class="line">            <span class="keyword">if</span> g:</span><br><span class="line">                i = a / g</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> xrange(i):</span><br><span class="line">                    g = gcd((a + j * b) % m, m)</span><br><span class="line">                    <span class="keyword">if</span> g &lt; r[<span class="number">0</span>]:</span><br><span class="line">                        r[<span class="number">0</span>] = g</span><br><span class="line">                        r[<span class="number">1</span>] = j</span><br><span class="line">                    <span class="keyword">if</span> g == <span class="number">1</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 查找加乘后GCD最小的对角线系数</span></span><br><span class="line">        <span class="comment">#   [加乘后的最大公约数,加乘的倍数,要化简的行号,加乘的行号,要化简的列号]</span></span><br><span class="line">        r = [self.mod, <span class="number">1</span>, i, i + <span class="number">1</span>, j]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> xrange(i, self.r):</span><br><span class="line">            <span class="keyword">for</span> kk <span class="keyword">in</span> xrange(k + <span class="number">1</span>, self.r):</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(j, self.c - <span class="number">1</span>):</span><br><span class="line">                    rr = add_min_gcd(self.d[k][l], self.d[kk][l], self.mod)</span><br><span class="line">                    <span class="keyword">if</span> rr[<span class="number">0</span>] &lt; r[<span class="number">0</span>]:</span><br><span class="line">                        r[<span class="number">0</span>] = rr[<span class="number">0</span>]</span><br><span class="line">                        r[<span class="number">1</span>] = rr[<span class="number">1</span>]</span><br><span class="line">                        r[<span class="number">2</span>] = k</span><br><span class="line">                        r[<span class="number">3</span>] = kk</span><br><span class="line">                        r[<span class="number">4</span>] = l</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="number">1</span> == rr[<span class="number">0</span>]):</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">        g = r[<span class="number">0</span>]</span><br><span class="line">        n = r[<span class="number">1</span>]</span><br><span class="line">        k = r[<span class="number">2</span>]</span><br><span class="line">        kk = r[<span class="number">3</span>]</span><br><span class="line">        l = r[<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> n <span class="keyword">and</span> g &lt; self.mod:</span><br><span class="line">            self.d[k] = <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: (x + n * y) % self.mod, self.d[k], self.d[kk])</span><br><span class="line">        <span class="keyword">return</span> [k, l]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mul_row</span>(<span class="params">self, i, k, j</span>):</span></span><br><span class="line">        a = self.d[k][j]</span><br><span class="line">        b = self.d[i][j]</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">get_mul</span>(<span class="params">a, b, m</span>):</span></span><br><span class="line">            k = gcd(a, m)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> == k:</span><br><span class="line">                <span class="keyword">return</span> mod_inv(a, m) * b % m</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> k == gcd(k, b):</span><br><span class="line">                    <span class="keyword">return</span> mod_inv(a / k, m / k) * (b / k) % (m / k)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> b:</span><br><span class="line">            mul = get_mul(a, b, self.mod)</span><br><span class="line">            <span class="keyword">if</span> <span class="literal">None</span> == mul:</span><br><span class="line">                print_matrix(self.d)</span><br><span class="line">                <span class="keyword">assert</span> (mul != <span class="literal">None</span>)</span><br><span class="line">            self.d[i] = <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: (y - x * mul) % self.mod, self.d[k], self.d[i])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gauss</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        返回解向量，唯一解、多解或无解(None)。</span></span><br><span class="line"><span class="string">        例如：[[61, 25, 116, 164], [61, 60, 116, 94], [61, 95, 116, 24], [61, 130, 116, 129], [61, 165, 116, 59]]</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        self.d = copy.deepcopy(self.matrix)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.r):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> xrange(self.c):</span><br><span class="line">                self.d[i][j] = self.matrix[i][j] % self.mod  <span class="comment"># 把负系数变成正系数</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.r &lt; self.N:</span><br><span class="line">            self.d.extend([[<span class="number">0</span>] * self.c] * (self.N - self.r))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 化简上三角</span></span><br><span class="line">        index = [x <span class="keyword">for</span> x <span class="keyword">in</span> xrange(self.N)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.N):</span><br><span class="line">            tmp = self.find_min_gcd_row_col(i, i)</span><br><span class="line">            <span class="keyword">if</span> (tmp):</span><br><span class="line">                self.swap_row(i, tmp[<span class="number">0</span>])</span><br><span class="line">                (index[i], index[tmp[<span class="number">1</span>]]) = (index[tmp[<span class="number">1</span>]], index[i])</span><br><span class="line">                self.swap_col(i, tmp[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.error_str = <span class="string">&quot;no min&quot;</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, self.r):</span><br><span class="line">                self.mul_row(k, i, i)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print_matrix(self.d)</span></span><br><span class="line">        <span class="keyword">if</span> self.r &gt; self.N:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.N, self.r):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> xrange(self.c):</span><br><span class="line">                    <span class="keyword">if</span> self.d[i][j]:</span><br><span class="line">                        self.error_str = <span class="string">&quot;r(A) != r(A~)&quot;</span></span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 判断解的数量</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(self.N):</span><br><span class="line">            self.count *= gcd(self.d[i][i], self.mod)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.count &gt; <span class="number">100</span>:</span><br><span class="line">            self.error_str = <span class="string">&quot;solution too more:%d&quot;</span> % (self.count)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 回代</span></span><br><span class="line">        result = [[<span class="literal">None</span>] * self.N]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.N - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            new_result = []</span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> result:</span><br><span class="line">                ret = self.inv_result(r, i)</span><br><span class="line">                <span class="keyword">if</span> ret:</span><br><span class="line">                    <span class="keyword">for</span> rr <span class="keyword">in</span> ret:</span><br><span class="line">                        l = r[:]</span><br><span class="line">                        l[i] = rr</span><br><span class="line">                        new_result.append(l)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.error_str = <span class="string">&quot;no inv:i=%d&quot;</span> % (i)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            result = new_result</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 调整列变换导致的未知数顺序变化</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(result)):</span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">xchg</span>(<span class="params">a, b</span>):</span></span><br><span class="line">                result[i][b] = a</span><br><span class="line"></span><br><span class="line">            <span class="built_in">map</span>(xchg, result[i][:], index)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"><span class="comment"># test</span></span><br><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_array</span>(<span class="params">x</span>):</span></span><br><span class="line">    prn = <span class="string">&quot;\t[&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> x:</span><br><span class="line">        <span class="keyword">if</span> j:</span><br><span class="line">            prn += <span class="string">&quot;%3d, &quot;</span> % j</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            prn += <span class="string">&quot;  0, &quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> prn[:-<span class="number">2</span>] + <span class="string">&quot;],&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_matrix</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;[&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">        print_array(i)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;]&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_test</span>(<span class="params">times</span>):</span></span><br><span class="line">    <span class="keyword">import</span> random</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(times):</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;\n============== random test %d ==============\n&quot;</span> % i</span><br><span class="line">        mod = random.randint(<span class="number">5</span>, <span class="number">999</span>)</span><br><span class="line">        col = random.randint(<span class="number">2</span>, <span class="number">30</span>)</span><br><span class="line">        row = random.randint(<span class="number">2</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">        solution = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: random.randint(<span class="number">0</span>, mod - <span class="number">1</span>), [xc <span class="keyword">for</span> xc <span class="keyword">in</span> xrange(col)])</span><br><span class="line"></span><br><span class="line">        matrix = []</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> xrange(row):</span><br><span class="line">            array = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: random.randint(<span class="number">0</span>, mod), [xc <span class="keyword">for</span> xc <span class="keyword">in</span> xrange(col)])</span><br><span class="line"></span><br><span class="line">            t = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: <span class="number">0</span> <span class="keyword">if</span> <span class="literal">None</span> == y <span class="keyword">else</span> x * y, array, solution):</span><br><span class="line">                t += j</span><br><span class="line">            array.append(t % mod)</span><br><span class="line"></span><br><span class="line">            matrix.append(array)</span><br><span class="line"></span><br><span class="line">        run_test(mod, solution, matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">static_test_ex</span>():</span></span><br><span class="line">    mod = <span class="number">37</span></span><br><span class="line">    solution = [<span class="number">6</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">6</span>, <span class="number">42</span>, <span class="number">7</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">27</span>]</span><br><span class="line">    matrix = [</span><br><span class="line">        [<span class="number">32</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">27</span>, <span class="number">14</span>, <span class="number">41</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">37</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">12</span>],</span><br><span class="line">        [<span class="number">23</span>, <span class="number">35</span>, <span class="number">31</span>, <span class="number">25</span>, <span class="number">46</span>, <span class="number">27</span>, <span class="number">48</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">31</span>, <span class="number">24</span>, <span class="number">36</span>],</span><br><span class="line">        [<span class="number">48</span>, <span class="number">10</span>, <span class="number">47</span>, <span class="number">1</span>, <span class="number">42</span>, <span class="number">26</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">41</span>],</span><br><span class="line">        [<span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">36</span>, <span class="number">4</span>, <span class="number">36</span>, <span class="number">18</span>, <span class="number">46</span>, <span class="number">33</span>, <span class="number">20</span>, <span class="number">4</span>, <span class="number">20</span>, <span class="number">39</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">37</span>, <span class="number">3</span>, <span class="number">39</span>, <span class="number">26</span>, <span class="number">33</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">23</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">45</span>, <span class="number">29</span>, <span class="number">32</span>, <span class="number">35</span>],</span><br><span class="line">        [<span class="number">38</span>, <span class="number">8</span>, <span class="number">38</span>, <span class="number">47</span>, <span class="number">1</span>, <span class="number">34</span>, <span class="number">36</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">0</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">21</span>, <span class="number">31</span>, <span class="number">21</span>],</span><br><span class="line">        [<span class="number">21</span>, <span class="number">3</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">7</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">37</span>, <span class="number">30</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">16</span>],</span><br><span class="line">        [<span class="number">7</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">19</span>, <span class="number">34</span>, <span class="number">46</span>, <span class="number">9</span>, <span class="number">33</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">32</span>],</span><br><span class="line">        [<span class="number">13</span>, <span class="number">41</span>, <span class="number">35</span>, <span class="number">25</span>, <span class="number">19</span>, <span class="number">9</span>, <span class="number">44</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">42</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">3</span>, <span class="number">47</span>, <span class="number">29</span>],</span><br><span class="line">        [<span class="number">36</span>, <span class="number">21</span>, <span class="number">36</span>, <span class="number">13</span>, <span class="number">37</span>, <span class="number">40</span>, <span class="number">21</span>, <span class="number">39</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">26</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">23</span>],</span><br><span class="line">        [<span class="number">41</span>, <span class="number">19</span>, <span class="number">28</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">24</span>, <span class="number">27</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">35</span>, <span class="number">3</span>, <span class="number">18</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">36</span>],</span><br><span class="line">        [<span class="number">42</span>, <span class="number">34</span>, <span class="number">17</span>, <span class="number">40</span>, <span class="number">26</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">46</span>, <span class="number">30</span>, <span class="number">14</span>, <span class="number">34</span>, <span class="number">22</span>, <span class="number">39</span>],</span><br><span class="line">        [<span class="number">18</span>, <span class="number">1</span>, <span class="number">40</span>, <span class="number">38</span>, <span class="number">17</span>, <span class="number">45</span>, <span class="number">24</span>, <span class="number">34</span>, <span class="number">34</span>, <span class="number">9</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">45</span>],</span><br><span class="line">        [<span class="number">43</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">29</span>, <span class="number">47</span>, <span class="number">48</span>, <span class="number">28</span>, <span class="number">37</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">35</span>, <span class="number">34</span>, <span class="number">37</span>, <span class="number">44</span>, <span class="number">35</span>],</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    run_test(mod, solution, matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">static_test</span>():</span></span><br><span class="line">    mod = <span class="number">26</span></span><br><span class="line">    solution = [<span class="number">23</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">13</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">11</span>]</span><br><span class="line">    matrix = [</span><br><span class="line">        [<span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>],</span><br><span class="line">        [<span class="number">14</span>, <span class="number">18</span>, <span class="number">23</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">23</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">23</span>],</span><br><span class="line">        [<span class="number">17</span>, <span class="number">5</span>, <span class="number">19</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">5</span>, <span class="number">19</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">5</span>, <span class="number">19</span>],</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(matrix)):</span><br><span class="line">        t = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: <span class="number">0</span> <span class="keyword">if</span> <span class="literal">None</span> == y <span class="keyword">else</span> x * y, matrix[i], solution):</span><br><span class="line">            t += j</span><br><span class="line">        matrix[i].append(t % mod)</span><br><span class="line"></span><br><span class="line">    run_test(mod, solution, matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_test</span>(<span class="params">mod, solution, matrix</span>):</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;row = %d, col = %d&quot;</span> % (<span class="built_in">len</span>(matrix), <span class="built_in">len</span>(matrix[<span class="number">0</span>]) - <span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;mod = %d&quot;</span> % (mod)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;solution =&quot;</span>, solution</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;matrix =&quot;</span></span><br><span class="line">    print_matrix(matrix)</span><br><span class="line"></span><br><span class="line">    g = GaussMatrix(matrix, mod)</span><br><span class="line"></span><br><span class="line">    ret = g.gauss()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;error:&quot;</span></span><br><span class="line">        print_matrix(g.d)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;error_str:&quot;</span>, g.error_str</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;times:&quot;</span>, g.count</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;result:&quot;</span></span><br><span class="line">        print_matrix(ret)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/Users/wenhui/Downloads/bob_enc_5d6979d05829e676ea3154e4be14d553/out.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">            data.append(i)</span><br><span class="line"></span><br><span class="line">    key = []</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&#x27;key.append(&#123;0&#125;)&#x27;</span>.<span class="built_in">format</span>(data[<span class="number">0</span>]))</span><br><span class="line">    key = key[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    s = []</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&#x27;s.append(&#123;0&#125;)&#x27;</span>.<span class="built_in">format</span>(data[<span class="number">1</span>]))</span><br><span class="line">    s = s[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    matrix = []</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">        tmp = key[i]</span><br><span class="line">        tmp.append(s[i])</span><br><span class="line">        matrix.append(tmp)</span><br><span class="line">    mod = <span class="number">2141</span></span><br><span class="line">    s = GaussMatrix(matrix, mod)</span><br><span class="line">    flag1 = s.gauss()</span><br><span class="line">    <span class="built_in">print</span> flag1  <span class="comment"># [[102, 108, 97, 103, 123, 49, 52, 101, 54, 102, 50, 51, 54, 45, 57, 101, 98, 57, 45, 52, 54]]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag1:</span><br><span class="line">        tmp = []</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> i:</span><br><span class="line">            tmp.append(<span class="built_in">chr</span>(each))</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(tmp)</span><br><span class="line"><span class="comment"># [[102, 108, 97, 103, 123, 49, 52, 101, 54, 102, 50, 51, 54, 45, 57, 101, 98, 57, 45, 52, 54]]</span></span><br><span class="line"><span class="comment"># flag&#123;14e6f236-9eb9-46</span></span><br></pre></td></tr></table></figure>

<p>困惑于flag2的长度几何，以及<strong>噪声</strong>的消除方法</p>
<p>这里了解到了<strong>LWE</strong></p>
<blockquote>
<h3 id="LWE问题"><a href="#LWE问题" class="headerlink" title="LWE问题"></a>LWE问题</h3><p>容错学习问题 （LWE问题， Learning With Errors）是一个机器学习领域中的怀疑难解问题，由Oded Regev 在2005年提出，他因此赢得2018年哥德尔奖。这是一个极性学习问题的一般形式。</p>
</blockquote>
<p>但很可惜，一小时内没有成功利用之</p>
<p>比赛结束后，回到勇者山峰，发现密码也三道题了</p>
<ul>
<li>notKnapsack</li>
<li>bob’s enc</li>
<li>TrainPlus</li>
</ul>
<p>传说殿堂也三道</p>
<ul>
<li>bob’s enc</li>
<li>Train</li>
<li>TrainPlus</li>
</ul>
<p>总体而言，难度上，300分的notKnapsack = TrainPlus &gt; bob’s enc &gt;&gt; Train</p>
<p>以及，传说殿堂远远没有勇者山峰卷🤔</p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507205949333.png" alt="传说殿堂"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220507205850757.png" alt="勇者山峰"></p>
<h2 id="后续再跟着其他师傅wp复现吧。"><a href="#后续再跟着其他师傅wp复现吧。" class="headerlink" title="后续再跟着其他师傅wp复现吧。"></a>后续再跟着其他师傅wp复现吧。</h2><h2 id="Bob’enc"><a href="#Bob’enc" class="headerlink" title="Bob’enc"></a>Bob’enc</h2><blockquote>
<p>以下为赛后复现，我决定尽可能多的挖掘此题价值</p>
<ul>
<li>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_53283643/article/details/124652001?spm=1001.2014.3001.5506">尚师傅博客</a></li>
</ul>
</blockquote>
<p><strong>当时的困惑</strong></p>
<ul>
<li>题目生成列表时，行数列数究竟多少没看懂</li>
<li>flag2多长</li>
<li>LWE如何用</li>
</ul>
<p><strong>现在的未知</strong></p>
<ul>
<li>解题的矩阵思维</li>
<li>sage命令背后的数学含义</li>
<li>过了几个月，学校教的线代已忘</li>
</ul>
<p>先上师傅总的题解（…Orz</p>
<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> starmap</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    c1 = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    c2 = <span class="built_in">eval</span>(f.readline())</span><br><span class="line"></span><br><span class="line">prime = <span class="number">2141</span></span><br><span class="line"></span><br><span class="line">K = matrix(Zmod(prime), key[:<span class="number">21</span>])</span><br><span class="line">C1 = vector(Zmod(prime), c1[:<span class="number">21</span>])</span><br><span class="line">m1 = K.inverse() * C1  <span class="comment"># m1 = K\C1</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m1:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Babai&#x27;s Nearest Plane algorithm</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Babai_closest_vector</span>(<span class="params">M, G, target</span>):</span></span><br><span class="line">    small = target</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(M.nrows())):</span><br><span class="line">            c = ((small * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">            small -= M[i] * c</span><br><span class="line">    <span class="keyword">return</span> target - small</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = <span class="number">64</span></span><br><span class="line">n = <span class="number">21</span></span><br><span class="line">q = prime</span><br><span class="line"></span><br><span class="line">A_values = key</span><br><span class="line">b_values = c2</span><br><span class="line"></span><br><span class="line">A = matrix(ZZ, m + n, m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    A[i, i] = q</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[m + y, x] = A_values[x][y]</span><br><span class="line">lattice = IntegerLattice(A, lll_reduce=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">gram = lattice.reduced_basis.gram_schmidt()[<span class="number">0</span>]</span><br><span class="line">target = vector(ZZ, b_values)</span><br><span class="line">res = Babai_closest_vector(lattice.reduced_basis, gram, target)</span><br><span class="line"></span><br><span class="line">R = IntegerModRing(q)</span><br><span class="line">M = Matrix(R, A_values)</span><br><span class="line">ingredients = M.solve_right(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ingredients:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p><strong>C1 = multi(key, flag1)</strong></p>
<p>对于<code>multi</code>，赛时我的理解是：<strong>单模多元线性同余方程</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_95676E5FB12E-1.jpeg" alt="单模多元线性同余方程"></p>
<p>其中out里第一个大列表给了Key（所有ki）,第二个列表给了C1（上图左端所有C），所以我找到解此方程的代码，跑出来就是解了。</p>
<p>值得一提，看题目可知，这有64个方程，21个未知量，所以实际跑解方程的代码让C1 = C1[:21]也可</p>
<p>而在高深的密码人看来，C1是由定义在<strong>整数域上的p模环矩阵K</strong> 乘 <strong>向量F</strong> [f1, f2, …, f21]得到的：</p>
<p><strong>矩阵K</strong></p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[185 <span class="number"> 96 </span>351<span class="number"> 118 </span>421<span class="number"> 449 </span>350<span class="number"> 349 </span>388 <span class="number"> 95 </span>341<span class="number"> 327 </span><span class="number"> 29 </span>156<span class="number"> 399 </span>283<span class="number"> 292 </span>461<span class="number"> 445 </span>120 126]</span><br><span class="line">[495<span class="number"> 358 </span>192<span class="number"> 300 </span>279<span class="number"> 277 </span>478<span class="number"> 335 </span>231<span class="number"> 241 </span>178<span class="number"> 314 </span>453<span class="number"> 251 </span>133<span class="number"> 391 </span>213<span class="number"> 132 </span>254<span class="number"> 388 </span> 46]</span><br><span class="line">[428 <span class="number"> 44 </span>100<span class="number"> 483 </span><span class="number"> 12 </span>311 <span class="number"> 57 </span>443<span class="number"> 289 </span><span class="number"> 90 </span>478<span class="number"> 495 </span>399 <span class="number"> 89 </span>324<span class="number"> 275 </span>322 <span class="number"> 99 </span>343<span class="number"> 489 </span>133]</span><br><span class="line">[420<span class="number"> 358 </span>472<span class="number"> 260 </span>267<span class="number"> 136 </span>303<span class="number"> 491 </span>390<span class="number"> 248 </span>430<span class="number"> 117 </span>154<span class="number"> 244 </span><span class="number"> 62 </span>217<span class="number"> 204 </span>334<span class="number"> 277 </span>231 325]</span><br><span class="line">[<span class="number"> 11 </span><span class="number"> 96 </span><span class="number"> 61 </span><span class="number"> 67 </span>456<span class="number"> 361 </span>292<span class="number"> 278 </span>424<span class="number"> 237 </span>345<span class="number"> 109 </span>475<span class="number"> 473 </span><span class="number"> 29 </span>250<span class="number"> 195 </span>430<span class="number"> 114 </span><span class="number"> 13 </span>199]</span><br><span class="line">[<span class="number"> 17 </span><span class="number"> 91 </span>330 <span class="number"> 73 </span>384<span class="number"> 134 </span>437<span class="number"> 161 </span>166<span class="number"> 185 </span>499<span class="number"> 491 </span>342<span class="number"> 129 </span>348<span class="number"> 162 </span>478<span class="number"> 216 </span>189<span class="number"> 311 </span>502]</span><br><span class="line">[396<span class="number"> 437 </span><span class="number"> 98 </span>421<span class="number"> 120 </span>443<span class="number"> 113 </span>432  <span class="number"> 9 </span>476<span class="number"> 243 </span>122<span class="number"> 416 </span>508<span class="number"> 287 </span><span class="number"> 45 </span><span class="number"> 84 </span>322<span class="number"> 504 </span>287 251]</span><br><span class="line">[187<span class="number"> 489 </span>407<span class="number"> 204 </span>127 <span class="number"> 10 </span>302<span class="number"> 101 </span>389<span class="number"> 113 </span>469<span class="number"> 184 </span>249<span class="number"> 131 </span>113 <span class="number"> 18 </span>350<span class="number"> 106 </span>486<span class="number"> 406 </span>295]</span><br><span class="line">[265<span class="number"> 425 </span><span class="number"> 30 </span>478<span class="number"> 471 </span>211<span class="number"> 162 </span>323<span class="number"> 163 </span>205<span class="number"> 187 </span>422<span class="number"> 452 </span>226<span class="number"> 230 </span>367<span class="number"> 478 </span>229<span class="number"> 365 </span>395 294]</span><br><span class="line">[360<span class="number"> 193 </span>180<span class="number"> 253 </span>337<span class="number"> 453 </span><span class="number"> 16 </span>352<span class="number"> 243 </span>107<span class="number"> 171 </span><span class="number"> 46 </span><span class="number"> 25 </span>234 <span class="number"> 46 </span>479<span class="number"> 267 </span>267<span class="number"> 171 </span>188 127]</span><br><span class="line">[379<span class="number"> 360 </span>109<span class="number"> 360 </span>403<span class="number"> 343 </span><span class="number"> 75 </span>306<span class="number"> 138 </span><span class="number"> 40 </span><span class="number"> 41 </span>253<span class="number"> 428 </span>401<span class="number"> 464 </span>495 <span class="number"> 21 </span>296<span class="number"> 319 </span>410 440]</span><br><span class="line">[<span class="number"> 28 </span>209  <span class="number"> 1 </span>233<span class="number"> 458 </span>266<span class="number"> 301 </span>359<span class="number"> 469 </span>304<span class="number"> 264 </span>368<span class="number"> 339 </span><span class="number"> 25 </span>490<span class="number"> 343 </span>404<span class="number"> 488 </span>275<span class="number"> 262 </span>274]</span><br><span class="line">[180<span class="number"> 372 </span>133<span class="number"> 341 </span><span class="number"> 29 </span>352<span class="number"> 326 </span><span class="number"> 89 </span>323<span class="number"> 479 </span><span class="number"> 68 </span><span class="number"> 76 </span>247<span class="number"> 225 </span>159<span class="number"> 163 </span>180<span class="number"> 160 </span>171  <span class="number"> 7 </span>322]</span><br><span class="line">[322<span class="number"> 295 </span><span class="number"> 28 </span>467<span class="number"> 361 </span>169<span class="number"> 190 </span><span class="number"> 71 </span>456<span class="number"> 140 </span>456<span class="number"> 202 </span>295<span class="number"> 424 </span>428 <span class="number"> 18 </span>286<span class="number"> 233 </span>470<span class="number"> 303 </span>429]</span><br><span class="line">[234 <span class="number"> 37 </span>128<span class="number"> 175 </span>282<span class="number"> 509 </span><span class="number"> 54 </span>186<span class="number"> 177 </span><span class="number"> 23 </span>348<span class="number"> 487 </span>473<span class="number"> 377 </span><span class="number"> 81 </span>225<span class="number"> 154 </span>511<span class="number"> 364 </span>120 280]</span><br><span class="line">[262 <span class="number"> 82 </span>383<span class="number"> 490 </span>128<span class="number"> 448 </span>289<span class="number"> 420 </span>239<span class="number"> 374 </span>392<span class="number"> 149 </span>217<span class="number"> 398 </span>441<span class="number"> 480 </span>453<span class="number"> 503 </span>318<span class="number"> 285 </span>418]</span><br><span class="line">[ <span class="number"> 0 </span>347<span class="number"> 223 </span>381<span class="number"> 469 </span>208<span class="number"> 424 </span>435<span class="number"> 404 </span><span class="number"> 64 </span>107 <span class="number"> 73 </span>490<span class="number"> 116 </span>445<span class="number"> 392 </span>194<span class="number"> 287 </span><span class="number"> 66 </span>325 261]</span><br><span class="line">[<span class="number"> 99 </span><span class="number"> 26 </span>489<span class="number"> 114 </span> <span class="number"> 3 </span>351<span class="number"> 494 </span>174<span class="number"> 369 </span>354<span class="number"> 379 </span>187 <span class="number"> 90 </span>202<span class="number"> 286 </span><span class="number"> 37 </span><span class="number"> 48 </span>397<span class="number"> 298 </span><span class="number"> 65 </span>499]</span><br><span class="line">[455<span class="number"> 114 </span>349<span class="number"> 401 </span> <span class="number"> 5 </span>139<span class="number"> 314 </span>227<span class="number"> 134 </span>258<span class="number"> 270 </span>135<span class="number"> 287 </span>332<span class="number"> 298 </span>272<span class="number"> 167 </span><span class="number"> 43 </span>271<span class="number"> 484 </span>177]</span><br><span class="line">[448 <span class="number"> 78 </span>479<span class="number"> 324 </span>170  <span class="number"> 7 </span>230<span class="number"> 173 </span>214 <span class="number"> 65 </span><span class="number"> 91 </span>497 <span class="number"> 68 </span>391 <span class="number"> 44 </span>205<span class="number"> 364 </span>471<span class="number"> 460 </span>312 122]</span><br><span class="line">[452<span class="number"> 360 </span>448<span class="number"> 169 </span>240<span class="number"> 496 </span>302  <span class="number"> 3 </span>354<span class="number"> 266 </span><span class="number"> 46 </span><span class="number"> 22 </span>151<span class="number"> 498 </span>461<span class="number"> 314 </span>169 <span class="number"> 88 </span><span class="number"> 30 </span>487 258]</span><br></pre></td></tr></table></figure>

<p><strong>向量F</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">49</span>, <span class="number">52</span>, <span class="number">101</span>, <span class="number">54</span>, <span class="number">102</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">45</span>, <span class="number">57</span>, <span class="number">101</span>, <span class="number">98</span>, <span class="number">57</span>, <span class="number">45</span>, <span class="number">52</span>, <span class="number">54</span>]</span><br></pre></td></tr></table></figure>

<p><strong>C1 = K✖️F</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">(1702,</span> <span class="number">795</span><span class="string">,</span> <span class="number">740</span><span class="string">,</span> <span class="number">373</span><span class="string">,</span> <span class="number">535</span><span class="string">,</span> <span class="number">1308</span><span class="string">,</span> <span class="number">1050</span><span class="string">,</span> <span class="number">502</span><span class="string">,</span> <span class="number">40</span><span class="string">,</span> <span class="number">672</span><span class="string">,</span> <span class="number">1354</span><span class="string">,</span> <span class="number">1843</span><span class="string">,</span> <span class="number">515</span><span class="string">,</span> <span class="number">231</span><span class="string">,</span> <span class="number">774</span><span class="string">,</span> <span class="number">65</span><span class="string">,</span> <span class="number">978</span><span class="string">,</span> <span class="number">1340</span><span class="string">,</span> <span class="number">455</span><span class="string">,</span> <span class="number">2137</span><span class="string">,</span> <span class="number">733</span><span class="string">)</span></span><br></pre></td></tr></table></figure>

<p>经过验证，矩阵与向量相乘为每行对应项相乘再求和，以下</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">m</span> =<span class="meta"> [102, 108, 97, 103, 123, 49, 52, 101, 54, 102, 50, 51, 54, 45, 57, 101, 98, 57, 45, 52, 54]</span></span><br><span class="line"><span class="attribute">k</span> = &#x27;<span class="number">185</span>  <span class="number">96</span> <span class="number">351</span> <span class="number">118</span> <span class="number">421</span> <span class="number">449</span> <span class="number">350</span> <span class="number">349</span> <span class="number">388</span>  <span class="number">95</span> <span class="number">341</span> <span class="number">327</span>  <span class="number">29</span> <span class="number">156</span> <span class="number">399</span> <span class="number">283</span> <span class="number">292</span> <span class="number">461</span> <span class="number">445</span> <span class="number">120</span> <span class="number">126</span>&#x27;.split(&#x27; &#x27;)</span><br><span class="line"><span class="attribute">k</span> =<span class="meta"> [int(i) for i in k if i]</span></span><br><span class="line"><span class="attribute">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="attribute">for</span> i in range(len(m)):</span><br><span class="line">    <span class="attribute">sum</span> += (m[i] * k[i]) % <span class="number">2141</span></span><br><span class="line"><span class="attribute">print</span>(sum % <span class="number">2141</span>)</span><br><span class="line"><span class="comment"># 1702</span></span><br></pre></td></tr></table></figure>

<p>故不用复杂的求解多个同余方程，可以直接让$K^{-1}*C1$，即可得到：F</p>
<ul>
<li>注意，这里必须左乘$K^{-1}$,即：$C1 = K<em>F; K^{-1}</em>C1 = F$<ul>
<li>也就是说F是列向量？</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> starmap</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    c1 = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    c2 = <span class="built_in">eval</span>(f.readline())</span><br><span class="line"></span><br><span class="line">prime = <span class="number">2141</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  矩阵求解的思维</span></span><br><span class="line">K = matrix(Zmod(prime), key[:<span class="number">21</span>])  <span class="comment"># 一来，21行足够；二来方阵才可求逆</span></span><br><span class="line">C1 = vector(Zmod(prime), c1[:<span class="number">21</span>])</span><br><span class="line">m1 = K.inverse() * C1</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m1:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><strong>整数域上的环，奇妙！</strong></p>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">noise = [random.randint(<span class="number">0</span>,<span class="number">6</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br></pre></td></tr></table></figure>

<ol>
<li><p>C2 = multi(Key, flag2)</p>
</li>
<li><p>C2 = add(noise, C2) </p>
</li>
</ol>
<p>噪声打断了思绪，得重新整理整理。</p>
<p>赛时也了解到了LWE，但因为不知原理，不懂使用，故无所突破。</p>
<p>按照当时的想法，认为此法能消掉noise就很🐮了，但赛后发现可以直接给到flag2🐮🐮🐮</p>
<p>水平、时间有限，LWE系统的原理学习暂先搁置，先试着读读看使用方法与代码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220509205640566.png" alt="LWE"></p>
<p>简单翻译翻译，在此题中，则是给定Key矩阵，先令矩阵Key*向量flag2后再与noise相加，故：</p>
<ul>
<li>A = Key</li>
<li>s = flag2</li>
<li>e = noise</li>
<li>b = C2</li>
</ul>
<p>而LWE问题就是给<strong>A</strong>、b, 求s</p>
<p>所以一开始所惊叹的<strong>‘能直接求出flag2’</strong>，在此印证</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2-大规模</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> starmap</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"></span><br><span class="line"><span class="comment"># Babai&#x27;s Nearest Plane algorithm</span></span><br><span class="line"><span class="comment"># from: http://mslc.ctf.su/wp/plaidctf-2016-sexec-crypto-300/</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Babai_closest_vector</span>(<span class="params">M, G, target</span>):</span></span><br><span class="line">    small = target</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(M.nrows())):</span><br><span class="line">            c = ((small * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">            small -= M[i] * c</span><br><span class="line">    <span class="keyword">return</span> target - small</span><br><span class="line"></span><br><span class="line"><span class="comment"># A一般为key</span></span><br><span class="line"><span class="comment"># b为密文</span></span><br><span class="line"><span class="comment"># e为噪声</span></span><br><span class="line"><span class="comment"># s为flag（下面的ingredients</span></span><br><span class="line">  </span><br><span class="line">m =   <span class="comment"># A行数</span></span><br><span class="line">n =   <span class="comment"># A列数</span></span><br><span class="line">q =   <span class="comment"># 模数</span></span><br><span class="line"></span><br><span class="line">A_values = </span><br><span class="line">b_values = </span><br><span class="line"></span><br><span class="line">A = matrix(ZZ, m + n, m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    A[i, i] = q</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[m + y, x] = A_values[x][y]</span><br><span class="line">lattice = IntegerLattice(A, lll_reduce=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;LLL done&quot;</span>)</span><br><span class="line">gram = lattice.reduced_basis.gram_schmidt()[<span class="number">0</span>]</span><br><span class="line">target = vector(ZZ, b_values)</span><br><span class="line">res = Babai_closest_vector(lattice.reduced_basis, gram, target)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Closest Vector: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(res))</span><br><span class="line"></span><br><span class="line">R = IntegerModRing(q)</span><br><span class="line">M = Matrix(R, A_values)</span><br><span class="line">ingredients = M.solve_right(res)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ingredients: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(ingredients))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row, b <span class="keyword">in</span> <span class="built_in">zip</span>(A_values, b_values):</span><br><span class="line">    effect = <span class="built_in">sum</span>(starmap(mul, <span class="built_in">zip</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, ingredients), row))) % q</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">abs</span>(b - effect) &lt; <span class="number">2</span> ** <span class="number">37</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ok&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>也发现，我们不需要知道flag2的长度</p>
<h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><ul>
<li>矩阵、向量解题思路</li>
<li>LWE消除噪音</li>
<li>加深对sage的了解</li>
</ul>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Harry0597
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://harry0597.com/2022/05/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B/" title="2022年春秋杯网络安全联赛春季赛·Crypto WP">https://harry0597.com/2022/05/09/2022年春秋杯网络安全联赛春季赛/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Writeup/" rel="tag"><i class="fa fa-tag"></i> Writeup</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/06/RSA%E9%A2%98%E5%9E%8B%E6%80%BB%E7%BB%93/" rel="prev" title="RSA题型总结">
      <i class="fa fa-chevron-left"></i> RSA题型总结
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/10/Sage%E5%BA%94%E7%94%A8%E6%8C%87%E5%8D%97/" rel="next" title="数学概念的Sage实现">
      数学概念的Sage实现 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B%C2%B7Crypto"><span class="nav-number">1.</span> <span class="nav-text">2022年春秋杯网络安全联赛春季赛·Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#notKnapsack"><span class="nav-number">1.1.</span> <span class="nav-text">notKnapsack</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">1.1.1.</span> <span class="nav-text">题目</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Train"><span class="nav-number">1.2.</span> <span class="nav-text">Train</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">题目</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TrainPlus"><span class="nav-number">1.3.</span> <span class="nav-text">TrainPlus</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#bob%E2%80%99s-enc"><span class="nav-number">1.4.</span> <span class="nav-text">bob’s enc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LWE%E9%97%AE%E9%A2%98"><span class="nav-number">1.4.1.</span> <span class="nav-text">LWE问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8E%E7%BB%AD%E5%86%8D%E8%B7%9F%E7%9D%80%E5%85%B6%E4%BB%96%E5%B8%88%E5%82%85wp%E5%A4%8D%E7%8E%B0%E5%90%A7%E3%80%82"><span class="nav-number">1.5.</span> <span class="nav-text">后续再跟着其他师傅wp复现吧。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bob%E2%80%99enc"><span class="nav-number">1.6.</span> <span class="nav-text">Bob’enc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">1.6.1.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag1"><span class="nav-number">1.6.2.</span> <span class="nav-text">flag1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag2"><span class="nav-number">1.6.3.</span> <span class="nav-text">flag2</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7"><span class="nav-number">1.7.</span> <span class="nav-text">收获</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Harry0597"
      src="/images/IMG_2550.JPG">
  <p class="site-author-name" itemprop="name">Harry0597</p>
  <div class="site-description" itemprop="description">Pondering'll do you wonders.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:1915885792@qq.com" title="E-Mail → mailto:1915885792@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>


      
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CS/" rel="tag">CS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-OS/" rel="tag">Mac OS</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Writeup/" rel="tag">Writeup</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">杂</a><span class="tag-list-count">6</span></li></ul>
              </canvas>
          </div>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harry0597</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.1m</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'SdJfKJYPhm2sNuw1OsouUSUC-MdYXbMMI',
      appKey     : '4pmiJGkm87YwJe40oBXXWYKM',
      placeholder: "评论，让思维碰撞",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://SdJfKJYP.api.lncldglobal.com'
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
