<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/ico" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/hackerrank.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harry0597.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="RSA">
<meta property="og:type" content="article">
<meta property="og:title" content="RSA题型总结">
<meta property="og:url" content="https://harry0597.com/2022/05/06/RSA%E9%A2%98%E5%9E%8B%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Harry&#39;s Blog">
<meta property="og:description" content="RSA">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430162816044.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430162816044.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430164731600.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220506153047159.png">
<meta property="article:published_time" content="2022-05-06T11:35:37.000Z">
<meta property="article:modified_time" content="2022-05-06T11:51:58.777Z">
<meta property="article:author" content="Harry0597">
<meta property="article:tag" content="Crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430162816044.png">

<link rel="canonical" href="https://harry0597.com/2022/05/06/RSA%E9%A2%98%E5%9E%8B%E6%80%BB%E7%BB%93/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>RSA题型总结 | Harry's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Harry's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">温故知新</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Harry0597" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://harry0597.com/2022/05/06/RSA%E9%A2%98%E5%9E%8B%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/IMG_2550.JPG">
      <meta itemprop="name" content="Harry0597">
      <meta itemprop="description" content="Pondering'll do you wonders.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Harry's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          RSA题型总结
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-05-06 19:35:37 / 修改时间：19:51:58" itemprop="dateCreated datePublished" datetime="2022-05-06T19:35:37+08:00">2022-05-06</time>
            </span>

          
    <span>&emsp;</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span>
    <span class="post-meta-item-text">阅读次数：</span>
    <span id="busuanzi_value_page_pv"></span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>44k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>40 分钟</span>
            </span>
            <div class="post-description">RSA</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="CLASSICAL-RSA-FOR-CTF"><a href="#CLASSICAL-RSA-FOR-CTF" class="headerlink" title="CLASSICAL RSA FOR CTF"></a>CLASSICAL RSA FOR CTF</h1><h2 id="Crypto-easy-crypto-｜-N中有大合数"><a href="#Crypto-easy-crypto-｜-N中有大合数" class="headerlink" title="Crypto_easy_crypto    ｜    N中有大合数"></a>Crypto_easy_crypto    ｜    N中有大合数</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.cryptohack.org/cryptoctf2020">https://blog.cryptohack.org/cryptoctf2020</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1bb4y1W7vM?spm_id_from=333.999.0.0">N分解出合数</a></li>
</ul>
<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span>(<span class="params">nbit</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p, q, r = [getPrime(nbit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">        <span class="keyword">if</span> isPrime(p + q + r):</span><br><span class="line">            pubkey = (p * q * r, p + q + r)</span><br><span class="line">            privkey = (p, q, r)</span><br><span class="line">            <span class="keyword">return</span> pubkey, privkey</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">msg, pubkey</span>):</span></span><br><span class="line">    enc = <span class="built_in">pow</span>(bytes_to_long(msg.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="number">0x10001</span>, pubkey[<span class="number">0</span>] * pubkey[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">512</span></span><br><span class="line">pubkey, _ = keygen(nbit)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;pubkey =&#x27;</span>, pubkey)</span><br><span class="line"></span><br><span class="line">enc = encrypt(flag, pubkey)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc =&#x27;</span>, enc)</span><br><span class="line"><span class="comment">#pubkey = (763929224901239050077647342425144363318006219360210465113458622937882119766705458273788947718911994090187932947694326848868575500906975653763043489419853300731695950407389203582333794360159494405111004208058198680365172060235321945875374635278292661761319773173838900295933943437761251440819434675631450032782188481758975272071015244168751016874668742536151359822585793537758876078350987062972237271763834743266722655055439868971805843593929839097963319788083763,</span></span><br><span class="line"><span class="comment"># 27750416681837900468631425875797804482827864226099175414717825894823303299159277202974070903630276868248755642608884903122768656427165401563920443482151217)</span></span><br><span class="line"><span class="comment">#enc = 7579294603035135817234501131256282324240132424272000903035801073847222917306092792610406876451698121956232047031639448767323475088170357863653435096746640609325525035329328626562143049656124241263576649974820533800161432666946327226418036826146160288273175521864687122720836795596635067761146519940441817765732160382018434465776749372209181212817247187474685246156193381822044772746654690126746715728166527274933634750443478682812664022009444348448955720226579468781927776133336045525149203384137859868153077820708167146052429014790660921586958660759949399826568136755816563468739111123761288318276379025018708883521</span></span><br></pre></td></tr></table></figure>

<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">b=<span class="number">27750416681837900468631425875797804482827864226099175414717825894823303299159277202974070903630276868248755642608884903122768656427165401563920443482151217</span></span><br><span class="line">c=<span class="number">7579294603035135817234501131256282324240132424272000903035801073847222917306092792610406876451698121956232047031639448767323475088170357863653435096746640609325525035329328626562143049656124241263576649974820533800161432666946327226418036826146160288273175521864687122720836795596635067761146519940441817765732160382018434465776749372209181212817247187474685246156193381822044772746654690126746715728166527274933634750443478682812664022009444348448955720226579468781927776133336045525149203384137859868153077820708167146052429014790660921586958660759949399826568136755816563468739111123761288318276379025018708883521</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">phi = b-<span class="number">1</span></span><br><span class="line">d = libnum.invmod(e, phi)</span><br><span class="line">flag = <span class="built_in">pow</span>(c,d,b)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(flag).decode())</span><br></pre></td></tr></table></figure>

<p>直接把另一堆(<code>p*q*r</code>)忽略了，当成单素数(<code>p+q+r</code>)加密的RSA解🤔</p>
<p>回想起来，原来看过此类问题的解法视频</p>
<p>可惜，被p、q、r唬住了。</p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><ul>
<li><strong>N分解过程中，比m大的合数可以直接忽略</strong><ul>
<li>剩下的也不一定是素数，记得check</li>
</ul>
</li>
</ul>
<p>为什么？不知道</p>
<h2 id="CRT-共d"><a href="#CRT-共d" class="headerlink" title="CRT    |    共d"></a>CRT    |    共d</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;flag is here&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shuffle_flag</span>(<span class="params">s</span>):</span></span><br><span class="line">    str_list = <span class="built_in">list</span>(s)</span><br><span class="line">    shuffle(str_list)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(str_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nl = []</span><br><span class="line">el = []</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count != <span class="number">5</span>:</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = gmpy2.next_prime(bytes_to_long(flag))</span><br><span class="line">    e = gmpy2.invert(d, phi)</span><br><span class="line">    nl.append(n)</span><br><span class="line">    el.append(<span class="built_in">int</span>(e))</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(nl)</span><br><span class="line"><span class="built_in">print</span>(el)</span><br><span class="line"></span><br><span class="line">cl = []</span><br><span class="line">flag = shuffle_flag(flag.decode()).encode()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nl)):</span><br><span class="line">    cl.append(<span class="built_in">pow</span>(bytes_to_long(flag), el[i], nl[i]))</span><br><span class="line"><span class="built_in">print</span>(cl)</span><br></pre></td></tr></table></figure>

<h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###Sage###</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">nl=[<span class="number">92568419674731290088321621356482160506897805615722568594108449347104924357404183476911642777855820991398881156764068184840768873749718093598712551142529474514837161712525386555067489900887826033760157015587905876891826276883359425048106383489316555600680137377034136599761900203863336332834524981581608546277</span>, <span class="number">156396473818563541024482014372866929605198443382524196879362284224099117401220679011156723462510565131555949471059964179767945960498473012008220045105490122503438703770112687917922899337041421537937431868908340506324082719417747902320117904166584374628828367801012533926776313544525573302674702867896838756349</span>, <span class="number">158394833243620345170313957479796081390446308753163267294427471181012679879060921676287361174926310080500003540773261012005682050743188110335872216992843352902160171999286576526304619756655278142788064189969927027027650043645613441449926633380809295720977302961310978360575684689811662689798196832145977450067</span>, <span class="number">160088237013152996062303719345275590040820298863729670660621544625451638541931139026114480452748397901155923890465415946150076272684251867169893163248736673419035618274961179288085209456220719404244194802327491684233804878013160262798831738441790443743813368173495029170393018727204042599457829167334217403039</span>, <span class="number">176125361422384852665447804150030174008849487020728296169340093618559367127086381778331613043595010796295772394708222184703701230685609172767761426620379001062695169120599393984950488304290958534830276649464003949555105491117656796777657620812669612752464591728873199832200616338112460100967288829163217253937</span>]</span><br><span class="line">el=[<span class="number">69312028009355287369151190914681978515224902099126626288106202481561083869512381976466800912049172557479956400189281179789850182367192324370292880508005951892909864237831856642160554901550928757105750738313195248541515727624216048436593804176317465366380022764459799506858495981817822670957526705611211712923</span>, <span class="number">75652848678989239962391202584125835503829570694373189157636155436633908234362973839251550542975725789188895010096917574118924190081886365041870173203566890015476761857546914959928731140619341634983144909962106759048918025248827973161384045263311189477657141886093632791593341193393085433749877270828641736687</span>, <span class="number">33787880341418355427411601538315129862488529656310145182009801227014512555036822623215545927750632031483856865027938518144081751233475248361490189179988637342429805607352670543555743822390555949569061340741015073482051059972283793490798701339277926430357560613555427570475360496737455291914090967005368044847</span>, <span class="number">45894271603047945281790624112313938740541711331584775481261776728213544262108835859642003140814571796838418889270625806159755478669858113687476417240730385707171289922064965084283027730393146219788228689778873266618663473231744646293406030907691363263939114550226424730102211751706087680590823466426973879111</span>, <span class="number">39462780066564051085365889083337472288277223628014907704844994419242541623368920096395581667207909872944692627394665038729398405841875334128211337544205143876652949004817962123951132753801707134333132359039376283331685997619531570270269964807335633423631078057345827010794671894948828680193958561375351954627</span>]</span><br><span class="line">cl=[<span class="number">706565317398633346290694952311166623770389747503953970254889622211015097472765489676349936599997109100148837713409666075736711752497174928509516666210124850782396573268200919345005742905131769799719677758163730270857245509037860252700476102090438501579886321486095767737006847692632649652528793934802014895</span>, <span class="number">39976293505792731417500342473259466413746324373570160856607039564687056797068114044891309890160001547746290678089875953230720229396293686037539133378586045964793387433679304899158546834837314101138069400994334720071006048815998660691472991971598192116289517127819703723844842002711298154106615035755646791235</span>, <span class="number">82622936948791971063481195310587447614375265630407688161651173440160941964839173273115526802240672776681580169092371677673709037579318090622040018030730165371997331146171751228791524747622285256591779419274845659567001522182995468819720594650389854677582186770321424062935881407083956991646633760500152137305</span>, <span class="number">47924672523033740219454774309397006543851002473271747603676349322670782245519637286314088457132590816165876451615235937683074852920250584155682791595116359054889940842281324709426616771765312825842634237678243213350551342690870568516232078792788925700389762945955053433276153136302757700081859531596237286407</span>, <span class="number">157462720644970256050843434459828247139256140406409429896418317109064365936294939244159292550184482469972819258184119865598346921909220060266145241164734603316978286567811044606538176157224828857158099074286931716459626013079677895357212211176535500327064375073662684801175545519382470886239209020257096407424</span>]</span><br><span class="line"></span><br><span class="line">M=iroot(<span class="built_in">int</span>(nl[<span class="number">4</span>]),<span class="built_in">int</span>(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">a=[<span class="number">0</span>]*<span class="number">6</span></span><br><span class="line">a[<span class="number">0</span>]=[M,el[<span class="number">0</span>],el[<span class="number">1</span>],el[<span class="number">2</span>],el[<span class="number">3</span>],el[<span class="number">4</span>]]</span><br><span class="line">a[<span class="number">1</span>]=[<span class="number">0</span>,-nl[<span class="number">0</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">2</span>]=[<span class="number">0</span>,<span class="number">0</span>,-nl[<span class="number">1</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">3</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-nl[<span class="number">2</span>],<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">4</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-nl[<span class="number">3</span>],<span class="number">0</span>]</span><br><span class="line">a[<span class="number">5</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-nl[<span class="number">4</span>]]</span><br><span class="line"></span><br><span class="line">Mat = matrix(ZZ,a)</span><br><span class="line">Mat_LLL=Mat.LLL()</span><br><span class="line">d = <span class="built_in">abs</span>(Mat_LLL[<span class="number">0</span>][<span class="number">0</span>])// M  <span class="comment"># 这里得是整除 ‘//’ ！！！</span></span><br><span class="line">d= <span class="built_in">int</span>(d)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span>(gmpy2.is_prime(d)):</span><br><span class="line">    d -= <span class="number">1</span></span><br><span class="line">flag = <span class="built_in">int</span>(d)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(flag).decode())</span><br></pre></td></tr></table></figure>

<p>或许非预期吧，直接把d用LLL算法求出来了。</p>
<h3 id="结论-1"><a href="#结论-1" class="headerlink" title="结论"></a>结论</h3><ul>
<li>共d用<strong>LLL算法</strong>攻击（<strong>记得<code>d = abs(Mat_LLL[0][0])// M</code>整除!</strong></li>
</ul>
<h2 id="crtrsa-｜-dp小，e-很大"><a href="#crtrsa-｜-dp小，e-很大" class="headerlink" title="crtrsa    ｜    dp小，e 很大"></a>crtrsa    ｜    dp小，e 很大</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_52193383/article/details/120642406?spm=1001.2014.3001.5502">https://blog.csdn.net/qq_52193383/article/details/120642406?spm=1001.2014.3001.5502</a></li>
</ul>
<h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from secret import flagn,p,q</span><br><span class="line"><span class="meta">#p and q are two primes generated by getPrime</span></span><br><span class="line">import random</span><br><span class="line">def key_gen():</span><br><span class="line">    while True:</span><br><span class="line">	dp = random.randint(<span class="number">1</span>,<span class="number">1</span>&lt;&lt;<span class="number">20</span>)</span><br><span class="line">	dq = random.randint(<span class="number">1</span>,q-<span class="number">1</span>)</span><br><span class="line">	if gcd(dp, p - <span class="number">1</span>) == <span class="number">1</span> and gcd(dq, q - <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">	    d = crt([dp,dq],[p-<span class="number">1</span>,q-<span class="number">1</span>])</span><br><span class="line">	    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">	    R = Integers(phi)</span><br><span class="line">	    e = R(d)^-<span class="number">1</span></span><br><span class="line">	    return p*q,e</span><br><span class="line">n,e = key_gen()</span><br><span class="line">print e</span><br><span class="line">print n</span><br><span class="line">print <span class="built_in">pow</span>(flagn,int(e),n)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">e = <span class="number">29535442680028</span><span class="number">66703872076551</span><span class="number">93095372257231</span><span class="number">71227778612992</span><span class="number">93407053391808</span><span class="number">19922065528923</span><span class="number">59830889863726</span><span class="number">30141821049118</span><span class="number">01575201741264</span><span class="number">21489341137231</span><span class="number">74855236142887</span></span><br><span class="line">N = <span class="number">60061281212761</span><span class="number">72470274143101</span><span class="number">47361996375072</span><span class="number">59424584501192</span><span class="number">52491144009018</span><span class="number">46984591798652</span><span class="number">30077488313626</span><span class="number">74341219814935</span><span class="number">24170302602443</span><span class="number">13905313231276</span><span class="number">20970750816983</span></span><br><span class="line">flag = <span class="number">40827774686624</span><span class="number">93175049853412</span><span class="number">96891398047298</span><span class="number">62154972477739</span><span class="number">11290709560282</span><span class="number">22305386351302</span><span class="number">99851158554168</span><span class="number">47643274608394</span><span class="number">46781339111746</span><span class="number">38178050007541</span><span class="number">91093158289399</span></span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>可以看到dp的范围是在[1,1048576]，这个范围应该是可以进行穷举的  -&gt; dp已知</p>
<h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">2953544268002866703872076551930953722572317122777861299293407053391808199220655289235983088986372630141821049118015752017412642148934113723174855236142887</span></span><br><span class="line">n = <span class="number">6006128121276172470274143101473619963750725942458450119252491144009018469845917986523007748831362674341219814935241703026024431390531323127620970750816983</span></span><br><span class="line">c = <span class="number">4082777468662493175049853412968913980472986215497247773911290709560282223053863513029985115855416847643274608394467813391117463817805000754191093158289399</span></span><br><span class="line"><span class="comment">#dp = d % (p-1)     dq = d % (q-1)</span></span><br><span class="line"></span><br><span class="line">m = <span class="number">10000001</span></span><br><span class="line"><span class="keyword">for</span> dp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,(<span class="number">1</span>&lt;&lt;<span class="number">20</span>)+<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(dp)</span><br><span class="line">    temp = <span class="built_in">pow</span>(m,e*dp,n) - m</span><br><span class="line">    p = gmpy2.gcd(n,temp)</span><br><span class="line">    <span class="keyword">if</span> p != <span class="number">1</span>:</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            flag = long_to_bytes(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag <span class="keyword">or</span> <span class="string">b&#x27;ctf&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line"><span class="comment">#dp = 915155</span></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;d67fde91-f6c0-484d-88a4-1778f7fa0c05&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>因 e⋅dp≡1(mod(p−1))，又由费马小定理，对**r (大于1的整数 且 gcd(p, r)=1)**，有 $r^{e⋅dp} ≡ r (modp)$，即 $p | (r^{e⋅dp} − r)$；</p>
<p>又 p | n，很大概率 <strong>$p=gcd(r^{e·dp} − r, n)$</strong></p>
<ul>
<li>当dp较小且已知，e又较大时，对<strong>任意 m</strong>，**$p=gcd(r^{e·dp} − r, n)$**</li>
</ul>
<h2 id="Easy-Rsa-｜-p-1、q-1有公因子"><a href="#Easy-Rsa-｜-p-1、q-1有公因子" class="headerlink" title="Easy_Rsa    ｜ p-1、q-1有公因子"></a>Easy_Rsa    ｜ p-1、q-1有公因子</h2><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_prime</span>(<span class="params">nbits, gamma</span>):</span></span><br><span class="line">    g = getPrime(<span class="built_in">int</span>(nbits * gamma))</span><br><span class="line">    alpha = <span class="number">0.5</span> - gamma</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">        p = <span class="number">2</span> * g * a + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            b = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">            q = <span class="number">2</span> * g * b + <span class="number">1</span></span><br><span class="line">            h = <span class="number">2</span> * g * a * b + a + b</span><br><span class="line">            <span class="keyword">while</span> <span class="keyword">not</span> isPrime(q) <span class="keyword">or</span> isPrime(h) <span class="keyword">or</span> gmpy2.gcd(a, b) != <span class="number">1</span>:</span><br><span class="line">                b = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">                q = <span class="number">2</span> * g * b + <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">nbits, gamma</span>):</span></span><br><span class="line">    p, q = gen_prime(nbits, gamma)</span><br><span class="line">    n = p * q</span><br><span class="line">    e = getPrime(<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">while</span> gmpy2.gcd(e, gmpy2.lcm(p-<span class="number">1</span>,q-<span class="number">1</span>)) != <span class="number">1</span>:</span><br><span class="line">        e = getPrime(<span class="number">16</span>)</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    <span class="keyword">return</span> n, e, c</span><br><span class="line"></span><br><span class="line">n, e, c = encrypt(<span class="number">1024</span>, <span class="number">0.48</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;n =&#x27;</span>, n</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;e =&#x27;</span>, e</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c =&#x27;</span>, c</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line"><span class="comment"># e = 58337</span></span><br><span class="line"><span class="comment"># c = 13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pollard’s rho</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(x, n - <span class="number">1</span>, n) + <span class="number">3</span>) % n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rho</span>(<span class="params">n</span>):</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Factorizing&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x1 = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">        x2 = f(x1, n)</span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = gmpy2.gcd(<span class="built_in">abs</span>(x1 - x2), n)</span><br><span class="line">            <span class="keyword">if</span> p == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> p &gt; <span class="number">1</span> <span class="keyword">and</span> isPrime(p):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Found!&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> (p, n // p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                x1 = f(x1, n)</span><br><span class="line">                x2 = f(f(x2, n), n)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line">e = <span class="number">58337</span></span><br><span class="line">c = <span class="number">13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br><span class="line"></span><br><span class="line">p, q = rho(n)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Factorizing</span></span><br><span class="line"><span class="comment"># Found!</span></span><br><span class="line"><span class="comment"># b&#x27;SangFor&#123;0a8c2220-4c1b-32c8-e8c1-adf92ec7678b&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><h4 id="Common-Prime-RSA"><a href="#Common-Prime-RSA" class="headerlink" title="Common Prime RSA"></a>Common Prime RSA</h4><p>情形：gcd(p−1,q−1)=g</p>
<p>分解的n方法有四种：</p>
<p>（1）<strong>修改Pollard’s rho方法分解n；</strong></p>
<p>（2）知道a、b的值分解n；</p>
<p>（3）知道g的值分解n；</p>
<p>（4）分解N-1。</p>
<h2 id="baby-rsa-｜-p-q-v-i-m-i-1-−-v-i-1-m-i"><a href="#baby-rsa-｜-p-q-v-i-m-i-1-−-v-i-1-m-i" class="headerlink" title="baby_rsa    ｜$p, q=v_i^{m_i+1}−(v_i+1)^{m_i}$"></a><strong>baby_rsa</strong>    ｜$p, q=v_i^{m_i+1}−(v_i+1)^{m_i}$</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_52193383/article/details/120392517?spm=1001.2014.3001.5502">https://blog.csdn.net/qq_52193383/article/details/120392517?spm=1001.2014.3001.5502</a></li>
</ul>
<h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, v1, v2, m1, m2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc_1</span>(<span class="params">val</span>):</span></span><br><span class="line">    p, q = <span class="built_in">pow</span>(v1, (m1+<span class="number">1</span>))-<span class="built_in">pow</span>((v1+<span class="number">1</span>), m1), <span class="built_in">pow</span>(v2, (m2+<span class="number">1</span>))-<span class="built_in">pow</span>((v2+<span class="number">1</span>), m2)</span><br><span class="line">    <span class="keyword">assert</span> isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> (p*q).bit_length() == <span class="number">2048</span> <span class="keyword">and</span> q &lt; p &lt; q &lt;&lt; <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(val, <span class="number">0x10001</span>, p*q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc_2</span>(<span class="params">val</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> val.bit_length() &lt; <span class="number">512</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        fac = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">        <span class="keyword">if</span> isPrime(((fac[<span class="number">0</span>]+fac[<span class="number">1</span>]+fac[<span class="number">2</span>]) &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>):</span><br><span class="line">            n = fac[<span class="number">0</span>]*fac[<span class="number">1</span>]*fac[<span class="number">2</span>]*(((fac[<span class="number">0</span>]+fac[<span class="number">1</span>]+fac[<span class="number">2</span>]) &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    c = <span class="built_in">pow</span>(val, <span class="number">0x10001</span>, n)</span><br><span class="line">    <span class="keyword">return</span> (c, n, ((fac[<span class="number">0</span>]+fac[<span class="number">1</span>]+fac[<span class="number">2</span>]) &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line">    plain1 = bytes_to_long(flag[:<span class="number">21</span>])</span><br><span class="line">    plain2 = bytes_to_long(flag[<span class="number">21</span>:])</span><br><span class="line">    <span class="built_in">print</span>(enc_1(plain1))</span><br><span class="line">    <span class="built_in">print</span>(enc_2(plain2))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">15808773921165746378224649554032774095198531782455904169552223303513940968292896814159288417499220739875833754573943607047855256739976161598599903932981169979509871591999964856806929597805904134099901826858367778386342376768508031554802249075072366710038889306268806744179086648684738023073458982906066972340414398928411147970593935244077925448732772473619783079328351522269170879807064111318871074291073581343039389561175391039766936376267875184581643335916049461784753341115227515163545709454746272514827000601853735356551495685229995637483506735448900656885365353434308639412035003119516693303377081576975540948311</span></span><br><span class="line"><span class="string">(40625981017250262945230548450738951725566520252163410124565622126754739693681271649127104109038164852787767296403697462475459670540845822150397639923013223102912674748402427501588018866490878394678482061561521253365550029075565507988232729032055298992792712574569704846075514624824654127691743944112075703814043622599530496100713378696761879982542679917631570451072107893348792817321652593471794974227183476732980623835483991067080345184978482191342430627490398516912714451984152960348899589532751919272583098764118161056078536781341750142553197082925070730178092561314400518151019955104989790911460357848366016263083, 43001726046955078981344016981790445980199072066019323382068244142888931539602812318023095256474939697257802646150348546779647545152288158607555239302887689137645748628421247685225463346118081238718049701320726295435376733215681415774255258419418661466010403928591242961434178730846537471236142683517399109466429776377360118355173431016107543977241358064093102741819626163467139833352454094472229349598479358367203452452606833796483111892076343745958394932132199442718048720633556310467019222434693785423996656306612262714609076119634814783438111843773649519101169326072793596027594057988365133037041133566146897868269, 39796272592331896400626784951713239526857273168732133046667572399622660330587881579319314094557011554851873068389016629085963086136116425352535902598378739)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h3><p><strong>en1</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430162816044.png" alt="条件"></p>
<p>p，q的比特长度均小于2048（应该更小）。我们可以通过这个条件来枚举v和m，求出该范围内的所有素数，然后再从中选取任意两个素数，求n，长度若为2048bits，则尝试解密。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="comment">#enc_1</span></span><br><span class="line"><span class="attribute">c1</span> = <span class="number">15808773921165746378224649554032774095198531782455904169552223303513940968292896814159288417499220739875833754573943607047855256739976161598599903932981169979509871591999964856806929597805904134099901826858367778386342376768508031554802249075072366710038889306268806744179086648684738023073458982906066972340414398928411147970593935244077925448732772473619783079328351522269170879807064111318871074291073581343039389561175391039766936376267875184581643335916049461784753341115227515163545709454746272514827000601853735356551495685229995637483506735448900656885365353434308639412035003119516693303377081576975540948311</span></span><br><span class="line"><span class="attribute">e1</span> = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">primes</span> =<span class="meta"> []</span></span><br><span class="line"><span class="attribute">for</span> x in range(<span class="number">500</span>):</span><br><span class="line">    <span class="attribute">for</span> y in range(<span class="number">500</span>):</span><br><span class="line">        <span class="attribute">num</span> = pow(x, (y+<span class="number">1</span>))-pow((x+<span class="number">1</span>), y)</span><br><span class="line">        <span class="attribute">if</span> len(bin(num)[<span class="number">2</span>:]) &lt; <span class="number">2048</span>:</span><br><span class="line">            <span class="attribute">if</span> isPrime(num):</span><br><span class="line">                <span class="attribute">primes</span>.append(num)</span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> p in primes:</span><br><span class="line">    <span class="attribute">for</span> q in primes:</span><br><span class="line">        <span class="attribute">n1</span> = p*q</span><br><span class="line">        <span class="attribute">if</span> len(bin(n<span class="number">1</span>)[<span class="number">2</span>:]) == <span class="number">2048</span>:</span><br><span class="line">            <span class="attribute">try</span>:</span><br><span class="line">                <span class="attribute">d1</span> = gmpy<span class="number">2</span>.invert(e<span class="number">1</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">                <span class="attribute">flag</span> = long_to_bytes(pow(c<span class="number">1</span>,d<span class="number">1</span>,n<span class="number">1</span>))</span><br><span class="line">                <span class="attribute">if</span> b&#x27;flag&#x27; in flag or b&#x27;ctf&#x27; in flag:</span><br><span class="line">                    <span class="attribute">print</span>(flag)</span><br><span class="line">            <span class="attribute">except</span>:</span><br><span class="line">                <span class="attribute">pass</span></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;8102c552-3d78-4a&#x27;            </span></span><br></pre></td></tr></table></figure>



<blockquote>
<p> <strong>en2</strong></p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e2 = <span class="number">0x10001</span></span><br><span class="line">c2, n2, p = (<span class="number">40625981017250262945230548450738951725566520252163410124565622126754739693681271649127104109038164852787767296403697462475459670540845822150397639923013223102912674748402427501588018866490878394678482061561521253365550029075565507988232729032055298992792712574569704846075514624824654127691743944112075703814043622599530496100713378696761879982542679917631570451072107893348792817321652593471794974227183476732980623835483991067080345184978482191342430627490398516912714451984152960348899589532751919272583098764118161056078536781341750142553197082925070730178092561314400518151019955104989790911460357848366016263083</span>, <span class="number">43001726046955078981344016981790445980199072066019323382068244142888931539602812318023095256474939697257802646150348546779647545152288158607555239302887689137645748628421247685225463346118081238718049701320726295435376733215681415774255258419418661466010403928591242961434178730846537471236142683517399109466429776377360118355173431016107543977241358064093102741819626163467139833352454094472229349598479358367203452452606833796483111892076343745958394932132199442718048720633556310467019222434693785423996656306612262714609076119634814783438111843773649519101169326072793596027594057988365133037041133566146897868269</span>, <span class="number">39796272592331896400626784951713239526857273168732133046667572399622660330587881579319314094557011554851873068389016629085963086136116425352535902598378739</span>)</span><br><span class="line"><span class="built_in">print</span>(gmpy2.is_prime(p))</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">phi2 = (<span class="number">191</span>-<span class="number">1</span>)*(<span class="number">193</span>-<span class="number">1</span>)*(<span class="number">627383</span>-<span class="number">1</span>)*(<span class="number">1720754738477317127758682285465031939891059835873975157555031327070111123628789833299433549669619325160679719355338187877758311485785197492710491</span>-<span class="number">1</span>)</span><br><span class="line">d2 = <span class="built_in">int</span>(gmpy2.invert(e2, phi2))</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, d2, p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m2))</span><br><span class="line"><span class="comment"># #b&#x27;42-b659-0c96ef827f05&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p> 舍掉合数</p>
<p> <strong>值得注意，剩下的居然还是个合数，得拆了求其phi</strong></p>
</blockquote>
<h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430162816044.png" alt="条件"></p>
<ul>
<li>穷举所有v，m(即穷举所有p、q)</li>
</ul>
<h2 id="special-rsa-e-p-1-amp-e-q-1"><a href="#special-rsa-e-p-1-amp-e-q-1" class="headerlink" title="special_rsa    |  (e|p-1) &amp; (e|q-1)"></a>special_rsa    |  (e|p-1) &amp; (e|q-1)</h2><blockquote>
<p>有限域开e次方，解决问题。</p>
<p><strong>但e不能太大</strong>🤔</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/LaniakeaHarry/article/details/124384460?spm=1001.2014.3001.5502">https://blog.csdn.net/LaniakeaHarry/article/details/124384460?spm=1001.2014.3001.5502</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c = <span class="number">53296318153341311013989348488093143123693921875654781175946491674187297</span></span><br><span class="line">p = <span class="number">953730950786751671162019537171974567</span></span><br><span class="line">q = <span class="number">1189933229053113361422958527792232151</span></span><br><span class="line">e = <span class="number">113</span></span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^e-c</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^e-c</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q])</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(solution)))</span><br></pre></td></tr></table></figure>

<h3 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h3><ul>
<li>(e|p-1) &amp; (e|q-1)， AMM算法解决</li>
</ul>
<h2 id="CVE-OF-RSA-｜p-k-m-65537-a-n"><a href="#CVE-OF-RSA-｜p-k-m-65537-a-n" class="headerlink" title="CVE OF RSA    ｜p=k*m+(65537**a % n)"></a>CVE OF RSA    ｜p=k*m+(65537**a % n)</h2><h3 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">special_rsa</span>(<span class="params">self</span>):</span></span><br><span class="line">    kbits = <span class="number">37</span></span><br><span class="line">    abit = <span class="number">62</span></span><br><span class="line">    M = <span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = getRandomNBitInteger(kbits)</span><br><span class="line">        a = getRandomNBitInteger(abit)</span><br><span class="line">        p = k * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, a, M)</span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        l = getRandomNBitInteger(kbits)</span><br><span class="line">        b = getRandomNBitInteger(abit)</span><br><span class="line">        q = l * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, b, M)</span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    n = p * q</span><br><span class="line">    self.send(<span class="string">b&#x27;n = &#x27;</span> + <span class="built_in">str</span>(n).encode())</span><br><span class="line">    flag = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, n)</span><br><span class="line">    self.send(<span class="string">b&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c).encode())</span><br><span class="line">    self.request.close()</span><br></pre></td></tr></table></figure>

<h3 id="总结-4"><a href="#总结-4" class="headerlink" title="总结"></a>总结</h3><ul>
<li>roca（<a target="_blank" rel="noopener" href="https://crocs.fi.muni.cz/_media/public/papers/nemec_roca_ccs17_preprint.pdf"><strong>The Return of Coppersmith’s Attack</strong></a>）攻击<ul>
<li><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220430164731600.png" alt="m&amp;t"></li>
</ul>
</li>
</ul>
<h2 id="babyrsa-低加密指数广播攻击"><a href="#babyrsa-低加密指数广播攻击" class="headerlink" title="babyrsa    |低加密指数广播攻击"></a>babyrsa    |低加密指数广播攻击</h2><h3 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">n =  []</span><br><span class="line">c =  []</span><br><span class="line">f=<span class="keyword">lambda</span> m,e,n,c:<span class="built_in">pow</span>(m,e,n)==c<span class="comment">#应该是满足这个条件就为1</span></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">sum</span>(<span class="built_in">map</span>(f,[p]*<span class="number">4</span>,[<span class="number">4</span>]*<span class="number">4</span>,n,c))==<span class="number">4</span>)<span class="comment">#也就是说四次加密都是对的，这样总和才能为4</span></span><br><span class="line"><span class="comment">#map(f,m,e,n,c)  e = 4 同明文同指数 多次加密 中国剩余定理</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">cl, nl</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd, nl) == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(nl, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(cl, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, nl)</span><br><span class="line">    cl_ti_nl = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(nl, cl)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, cl_ti_nl) % M</span><br><span class="line"></span><br><span class="line">n =  []</span><br><span class="line">c =  []</span><br><span class="line"></span><br><span class="line">m_4 = CRT(c, n)</span><br><span class="line">p = <span class="built_in">int</span>(gmpy2.iroot(m_4, <span class="number">4</span>)[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure>

<h3 id="总结-5"><a href="#总结-5" class="headerlink" title="总结"></a>总结</h3><ul>
<li>$m^e ≡ c \mod(n)$ 由CRT得$m^e$,开e次方即解</li>
</ul>
<h2 id="Rabin-模4不余3"><a href="#Rabin-模4不余3" class="headerlink" title="Rabin    |模4不余3"></a>Rabin    |模4不余3</h2><ul>
<li><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/5113">https://xz.aliyun.com/t/5113</a></li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> Crypto.Util.number import getPrime</span><br><span class="line"><span class="attribute">from</span> random import randint</span><br><span class="line"><span class="attribute">from</span> libnum import *</span><br><span class="line"><span class="attribute">from</span> gmpy<span class="number">2</span> import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> power(s<span class="number">1</span>, s<span class="number">2</span>, k<span class="number">1</span>, k<span class="number">2</span>, w, p):</span><br><span class="line">    <span class="attribute">return</span> ((s<span class="number">1</span>*k<span class="number">1</span>+s<span class="number">2</span>*k<span class="number">2</span>*w)%p, (s<span class="number">1</span>*k<span class="number">2</span>+s<span class="number">2</span>*k<span class="number">1</span>)%p)</span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> Cipolla_algorithm(p, n):</span><br><span class="line">    <span class="attribute">a</span> = randint(<span class="number">1</span>, p)</span><br><span class="line">    <span class="attribute">w</span> = a ** <span class="number">2</span> - n</span><br><span class="line"></span><br><span class="line">    <span class="attribute">while</span> pow(w, (p-<span class="number">1</span>)/<span class="number">2</span>, p) !=p-<span class="number">1</span> :</span><br><span class="line">        <span class="attribute">a</span> = randint(<span class="number">1</span>, p)</span><br><span class="line">        <span class="attribute">w</span> = a ** <span class="number">2</span> - n</span><br><span class="line"></span><br><span class="line">    <span class="attribute">times</span> = (p+<span class="number">1</span>)/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">k1</span> = <span class="number">1</span></span><br><span class="line">    <span class="attribute">k2</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">first</span> = True</span><br><span class="line"></span><br><span class="line">    <span class="attribute">sum1</span> = <span class="number">1</span></span><br><span class="line">    <span class="attribute">sum2</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">while</span> times != <span class="number">0</span>:</span><br><span class="line">        <span class="attribute">if</span> first:</span><br><span class="line">            <span class="attribute">k1</span>, k<span class="number">2</span>=power(k<span class="number">1</span>, k<span class="number">2</span>, a, <span class="number">1</span>, w, p)</span><br><span class="line">            <span class="attribute">first</span> = False</span><br><span class="line"></span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">k1</span>, k<span class="number">2</span>=power(k<span class="number">1</span>, k<span class="number">2</span>, k<span class="number">1</span>, k<span class="number">2</span>, w, p)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">if</span> times &amp; <span class="number">1</span>:</span><br><span class="line">            <span class="attribute">sum1</span>, sum<span class="number">2</span> = power(sum<span class="number">1</span>, sum<span class="number">2</span>, k<span class="number">1</span>, k<span class="number">2</span>, w, p)</span><br><span class="line">        <span class="attribute">times</span> &gt;&gt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">return</span> sum<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> CRT(c, n):</span><br><span class="line">    <span class="attribute">for</span> i in range(len(n)):</span><br><span class="line">        <span class="attribute">for</span> j in range(i + <span class="number">1</span>, len(n)):</span><br><span class="line">            <span class="attribute">assert</span> gcd(n[i], n[j]) == <span class="number">1</span></span><br><span class="line">    <span class="attribute">assert</span> len(c) == len(n)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">N</span> = reduce(lambda a, b: a*b, n)</span><br><span class="line">    <span class="attribute">x</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">for</span> i, j in zip(c, n):</span><br><span class="line">        <span class="attribute">N_i</span> = N/j</span><br><span class="line">        <span class="attribute">N_i_1</span> = invert(N_i, j)</span><br><span class="line">        <span class="attribute">x</span>+=i*N_i*N_i_<span class="number">1</span></span><br><span class="line">    <span class="attribute">return</span> x % N</span><br><span class="line"></span><br><span class="line"><span class="attribute">if</span> __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    <span class="attribute">p</span> = getPrime(<span class="number">512</span>)</span><br><span class="line">    <span class="attribute">while</span> p % <span class="number">4</span> != <span class="number">1</span>:</span><br><span class="line">        <span class="attribute">p</span> = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">q</span> = getPrime(<span class="number">512</span>)</span><br><span class="line">    <span class="attribute">while</span> q % <span class="number">4</span> != <span class="number">1</span>:</span><br><span class="line">        <span class="attribute">q</span> = getPrime(<span class="number">512</span>)</span><br><span class="line">    <span class="attribute">n</span> = p * q</span><br><span class="line">    <span class="attribute">m</span> = s<span class="number">2</span>n(&#x27;this is plaintext&#x27;)</span><br><span class="line">    <span class="attribute">c</span> = pow(m, <span class="number">2</span>, n)</span><br><span class="line">    <span class="attribute">print</span> &#x27;m is &#x27;+str(m)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">get_x1</span> = Cipolla_algorithm(p, c)</span><br><span class="line">    <span class="attribute">get_x2</span> = Cipolla_algorithm(q, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="attribute">assert</span>  pow(get_x<span class="number">1</span>, <span class="number">2</span>, p) == c % p</span><br><span class="line">    <span class="attribute">assert</span>  pow(get_x<span class="number">2</span>, <span class="number">2</span>, q) == c % q</span><br><span class="line"></span><br><span class="line">    <span class="attribute">c11</span> = get_x<span class="number">1</span></span><br><span class="line">    <span class="attribute">c12</span> = p-get_x<span class="number">1</span></span><br><span class="line">    <span class="attribute">c21</span> = get_x<span class="number">2</span></span><br><span class="line">    <span class="attribute">c22</span> = q-get_x<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">print</span> &#x27;possible m :&#x27; + str(CRT([c<span class="number">11</span>, c<span class="number">21</span>],<span class="meta"> [p, q]))</span></span><br><span class="line"><span class="meta">    print &#x27;possible m :&#x27; + str(CRT([c11, c22], [p, q]))</span></span><br><span class="line"><span class="meta">    print &#x27;possible m :&#x27; + str(CRT([c12, c21], [p, q]))</span></span><br><span class="line"><span class="meta">    print &#x27;possible m :&#x27; + str(CRT([c12, c22], [p, q]))</span></span><br></pre></td></tr></table></figure>

<h3 id="n次同余方程"><a href="#n次同余方程" class="headerlink" title="n次同余方程"></a>n次同余方程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.residue_ntheory <span class="keyword">import</span> nthroot_mod</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">150</span>)</span><br><span class="line">x = randint(<span class="number">1</span>, p)</span><br><span class="line">n = <span class="built_in">pow</span>(x, <span class="number">4</span>, p)</span><br><span class="line"></span><br><span class="line">x1 = nthroot_mod(n,<span class="number">4</span>,p,all_roots=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(x1, <span class="number">4</span>, p) == n</span><br><span class="line"><span class="built_in">print</span> x1</span><br></pre></td></tr></table></figure>



<h2 id="Swedish-RSA-｜多项式RSA"><a href="#Swedish-RSA-｜多项式RSA" class="headerlink" title="Swedish RSA    ｜多项式RSA"></a>Swedish RSA    ｜多项式RSA</h2><ul>
<li><a target="_blank" rel="noopener" href="https://4xwi11.github.io/posts/a0a0f5aa/?highlight=%E5%A4%9A%E9%A1%B9%E5%BC%8F">参考博客</a></li>
<li><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/4545">https://xz.aliyun.com/t/4545</a></li>
<li><a target="_blank" rel="noopener" href="https://4xwi11.github.io/posts/80806ae5/?highlight=%E5%A4%9A%E9%A1%B9%E5%BC%8Frsa">https://4xwi11.github.io/posts/80806ae5/?highlight=多项式rsa</a></li>
</ul>
<h3 id="有限域上的多项式"><a href="#有限域上的多项式" class="headerlink" title="有限域上的多项式"></a>有限域上的多项式</h3><ul>
<li><strong>有限域</strong>：有限个数的集合</li>
<li><strong>有限域多项式</strong>：<strong>系数</strong>属于某个有限域的多项式</li>
<li><strong>有限域下不可约多项式</strong>：一个多项式<strong>不能被拆</strong>成多个同一有限域下多个多项式的乘积</li>
</ul>
<h4 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h4><ol>
<li><p>计算g(n)=g(p)×g(q)</p>
</li>
<li><p>计算g(n)的欧拉函数phi=φ(g(n))</p>
<p><strong>如何求phi</strong></p>
<ul>
<li><p>记在GF(b**r)上, g(x)的次数为a,则：</p>
<p>$$\phi (g(x)) = p^a - 1$$</p>
</li>
</ul>
</li>
<li><p>选一个整数e，(e, phi)=1，并求出逆元d，e×d≡1(mod phi)</p>
</li>
<li><p>加密：$$g(c)=g(m)^e \mod g(n)$$</p>
</li>
<li><p>解密：$$g(m)=g(c)^d \mod g(n)$$</p>
<p><strong>明文转换成多项式</strong></p>
<ul>
<li>将明文每个字符转ascii，作为多项式m的系数</li>
</ul>
</li>
</ol>
<p>其中e和d都是整数，它们和多项式可以进行模幂运算</p>
<h3 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">p = <span class="number">43753</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line"></span><br><span class="line">N = <span class="number">34036</span>*x^<span class="number">177</span> + <span class="number">23068</span>*x^<span class="number">176</span> + <span class="number">13147</span>*x^<span class="number">175</span> + <span class="number">36344</span>*x^<span class="number">174</span> + <span class="number">10045</span>*x^<span class="number">173</span> + <span class="number">41049</span>*x^<span class="number">172</span> + <span class="number">17786</span>*x^<span class="number">171</span> + <span class="number">16601</span>*x^<span class="number">170</span> + <span class="number">7929</span>*x^<span class="number">169</span> + <span class="number">37570</span>*x^<span class="number">168</span> + <span class="number">990</span>*x^<span class="number">167</span> + <span class="number">9622</span>*x^<span class="number">166</span> + <span class="number">39273</span>*x^<span class="number">165</span> + <span class="number">35284</span>*x^<span class="number">164</span> + <span class="number">15632</span>*x^<span class="number">163</span> + <span class="number">18850</span>*x^<span class="number">162</span> + <span class="number">8800</span>*x^<span class="number">161</span> + <span class="number">33148</span>*x^<span class="number">160</span> + <span class="number">12147</span>*x^<span class="number">159</span> + <span class="number">40487</span>*x^<span class="number">158</span> + <span class="number">6407</span>*x^<span class="number">157</span> + <span class="number">34111</span>*x^<span class="number">156</span> + <span class="number">8446</span>*x^<span class="number">155</span> + <span class="number">21908</span>*x^<span class="number">154</span> + <span class="number">16812</span>*x^<span class="number">153</span> + <span class="number">40624</span>*x^<span class="number">152</span> + <span class="number">43506</span>*x^<span class="number">151</span> + <span class="number">39116</span>*x^<span class="number">150</span> + <span class="number">33011</span>*x^<span class="number">149</span> + <span class="number">23914</span>*x^<span class="number">148</span> + <span class="number">2210</span>*x^<span class="number">147</span> + <span class="number">23196</span>*x^<span class="number">146</span> + <span class="number">43359</span>*x^<span class="number">145</span> + <span class="number">34455</span>*x^<span class="number">144</span> + <span class="number">17684</span>*x^<span class="number">143</span> + <span class="number">25262</span>*x^<span class="number">142</span> + <span class="number">982</span>*x^<span class="number">141</span> + <span class="number">24015</span>*x^<span class="number">140</span> + <span class="number">27968</span>*x^<span class="number">139</span> + <span class="number">37463</span>*x^<span class="number">138</span> + <span class="number">10667</span>*x^<span class="number">137</span> + <span class="number">39519</span>*x^<span class="number">136</span> + <span class="number">31176</span>*x^<span class="number">135</span> + <span class="number">27520</span>*x^<span class="number">134</span> + <span class="number">32118</span>*x^<span class="number">133</span> + <span class="number">8333</span>*x^<span class="number">132</span> + <span class="number">38945</span>*x^<span class="number">131</span> + <span class="number">34713</span>*x^<span class="number">130</span> + <span class="number">1107</span>*x^<span class="number">129</span> + <span class="number">43604</span>*x^<span class="number">128</span> + <span class="number">4433</span>*x^<span class="number">127</span> + <span class="number">18110</span>*x^<span class="number">126</span> + <span class="number">17658</span>*x^<span class="number">125</span> + <span class="number">32354</span>*x^<span class="number">124</span> + <span class="number">3219</span>*x^<span class="number">123</span> + <span class="number">40238</span>*x^<span class="number">122</span> + <span class="number">10439</span>*x^<span class="number">121</span> + <span class="number">3669</span>*x^<span class="number">120</span> + <span class="number">8713</span>*x^<span class="number">119</span> + <span class="number">21027</span>*x^<span class="number">118</span> + <span class="number">29480</span>*x^<span class="number">117</span> + <span class="number">5477</span>*x^<span class="number">116</span> + <span class="number">24332</span>*x^<span class="number">115</span> + <span class="number">43480</span>*x^<span class="number">114</span> + <span class="number">33406</span>*x^<span class="number">113</span> + <span class="number">43121</span>*x^<span class="number">112</span> + <span class="number">1114</span>*x^<span class="number">111</span> + <span class="number">17198</span>*x^<span class="number">110</span> + <span class="number">22829</span>*x^<span class="number">109</span> + <span class="number">24424</span>*x^<span class="number">108</span> + <span class="number">16523</span>*x^<span class="number">107</span> + <span class="number">20424</span>*x^<span class="number">106</span> + <span class="number">36206</span>*x^<span class="number">105</span> + <span class="number">41849</span>*x^<span class="number">104</span> + <span class="number">3584</span>*x^<span class="number">103</span> + <span class="number">26500</span>*x^<span class="number">102</span> + <span class="number">31897</span>*x^<span class="number">101</span> + <span class="number">34640</span>*x^<span class="number">100</span> + <span class="number">27449</span>*x^<span class="number">99</span> + <span class="number">30962</span>*x^<span class="number">98</span> + <span class="number">41434</span>*x^<span class="number">97</span> + <span class="number">22125</span>*x^<span class="number">96</span> + <span class="number">24314</span>*x^<span class="number">95</span> + <span class="number">3944</span>*x^<span class="number">94</span> + <span class="number">18400</span>*x^<span class="number">93</span> + <span class="number">38476</span>*x^<span class="number">92</span> + <span class="number">28904</span>*x^<span class="number">91</span> + <span class="number">27936</span>*x^<span class="number">90</span> + <span class="number">41867</span>*x^<span class="number">89</span> + <span class="number">25573</span>*x^<span class="number">88</span> + <span class="number">25659</span>*x^<span class="number">87</span> + <span class="number">33443</span>*x^<span class="number">86</span> + <span class="number">18435</span>*x^<span class="number">85</span> + <span class="number">5934</span>*x^<span class="number">84</span> + <span class="number">38030</span>*x^<span class="number">83</span> + <span class="number">17563</span>*x^<span class="number">82</span> + <span class="number">24086</span>*x^<span class="number">81</span> + <span class="number">36782</span>*x^<span class="number">80</span> + <span class="number">20922</span>*x^<span class="number">79</span> + <span class="number">38933</span>*x^<span class="number">78</span> + <span class="number">23448</span>*x^<span class="number">77</span> + <span class="number">10599</span>*x^<span class="number">76</span> + <span class="number">7156</span>*x^<span class="number">75</span> + <span class="number">29044</span>*x^<span class="number">74</span> + <span class="number">23605</span>*x^<span class="number">73</span> + <span class="number">7657</span>*x^<span class="number">72</span> + <span class="number">28200</span>*x^<span class="number">71</span> + <span class="number">2431</span>*x^<span class="number">70</span> + <span class="number">3860</span>*x^<span class="number">69</span> + <span class="number">23259</span>*x^<span class="number">68</span> + <span class="number">14590</span>*x^<span class="number">67</span> + <span class="number">33631</span>*x^<span class="number">66</span> + <span class="number">15673</span>*x^<span class="number">65</span> + <span class="number">36049</span>*x^<span class="number">64</span> + <span class="number">29728</span>*x^<span class="number">63</span> + <span class="number">22413</span>*x^<span class="number">62</span> + <span class="number">18602</span>*x^<span class="number">61</span> + <span class="number">18557</span>*x^<span class="number">60</span> + <span class="number">23505</span>*x^<span class="number">59</span> + <span class="number">17642</span>*x^<span class="number">58</span> + <span class="number">12595</span>*x^<span class="number">57</span> + <span class="number">17255</span>*x^<span class="number">56</span> + <span class="number">15316</span>*x^<span class="number">55</span> + <span class="number">8948</span>*x^<span class="number">54</span> + <span class="number">38</span>*x^<span class="number">53</span> + <span class="number">40329</span>*x^<span class="number">52</span> + <span class="number">9823</span>*x^<span class="number">51</span> + <span class="number">5798</span>*x^<span class="number">50</span> + <span class="number">6379</span>*x^<span class="number">49</span> + <span class="number">8662</span>*x^<span class="number">48</span> + <span class="number">34640</span>*x^<span class="number">47</span> + <span class="number">38321</span>*x^<span class="number">46</span> + <span class="number">18760</span>*x^<span class="number">45</span> + <span class="number">13135</span>*x^<span class="number">44</span> + <span class="number">15926</span>*x^<span class="number">43</span> + <span class="number">34952</span>*x^<span class="number">42</span> + <span class="number">28940</span>*x^<span class="number">41</span> + <span class="number">13558</span>*x^<span class="number">40</span> + <span class="number">42579</span>*x^<span class="number">39</span> + <span class="number">38015</span>*x^<span class="number">38</span> + <span class="number">33788</span>*x^<span class="number">37</span> + <span class="number">12381</span>*x^<span class="number">36</span> + <span class="number">195</span>*x^<span class="number">35</span> + <span class="number">13709</span>*x^<span class="number">34</span> + <span class="number">31500</span>*x^<span class="number">33</span> + <span class="number">32994</span>*x^<span class="number">32</span> + <span class="number">30486</span>*x^<span class="number">31</span> + <span class="number">40414</span>*x^<span class="number">30</span> + <span class="number">2578</span>*x^<span class="number">29</span> + <span class="number">30525</span>*x^<span class="number">28</span> + <span class="number">43067</span>*x^<span class="number">27</span> + <span class="number">6195</span>*x^<span class="number">26</span> + <span class="number">36288</span>*x^<span class="number">25</span> + <span class="number">23236</span>*x^<span class="number">24</span> + <span class="number">21493</span>*x^<span class="number">23</span> + <span class="number">15808</span>*x^<span class="number">22</span> + <span class="number">34500</span>*x^<span class="number">21</span> + <span class="number">6390</span>*x^<span class="number">20</span> + <span class="number">42994</span>*x^<span class="number">19</span> + <span class="number">42151</span>*x^<span class="number">18</span> + <span class="number">19248</span>*x^<span class="number">17</span> + <span class="number">19291</span>*x^<span class="number">16</span> + <span class="number">8124</span>*x^<span class="number">15</span> + <span class="number">40161</span>*x^<span class="number">14</span> + <span class="number">24726</span>*x^<span class="number">13</span> + <span class="number">31874</span>*x^<span class="number">12</span> + <span class="number">30272</span>*x^<span class="number">11</span> + <span class="number">30761</span>*x^<span class="number">10</span> + <span class="number">2296</span>*x^<span class="number">9</span> + <span class="number">11017</span>*x^<span class="number">8</span> + <span class="number">16559</span>*x^<span class="number">7</span> + <span class="number">28949</span>*x^<span class="number">6</span> + <span class="number">40499</span>*x^<span class="number">5</span> + <span class="number">22377</span>*x^<span class="number">4</span> + <span class="number">33628</span>*x^<span class="number">3</span> + <span class="number">30598</span>*x^<span class="number">2</span> + <span class="number">4386</span>*x + <span class="number">23814</span></span><br><span class="line">c = <span class="number">5209</span>*x^<span class="number">176</span> + <span class="number">10881</span>*x^<span class="number">175</span> + <span class="number">31096</span>*x^<span class="number">174</span> + <span class="number">23354</span>*x^<span class="number">173</span> + <span class="number">28337</span>*x^<span class="number">172</span> + <span class="number">15982</span>*x^<span class="number">171</span> + <span class="number">13515</span>*x^<span class="number">170</span> + <span class="number">21641</span>*x^<span class="number">169</span> + <span class="number">10254</span>*x^<span class="number">168</span> + <span class="number">34588</span>*x^<span class="number">167</span> + <span class="number">27434</span>*x^<span class="number">166</span> + <span class="number">29552</span>*x^<span class="number">165</span> + <span class="number">7105</span>*x^<span class="number">164</span> + <span class="number">22604</span>*x^<span class="number">163</span> + <span class="number">41253</span>*x^<span class="number">162</span> + <span class="number">42675</span>*x^<span class="number">161</span> + <span class="number">21153</span>*x^<span class="number">160</span> + <span class="number">32838</span>*x^<span class="number">159</span> + <span class="number">34391</span>*x^<span class="number">158</span> + <span class="number">832</span>*x^<span class="number">157</span> + <span class="number">720</span>*x^<span class="number">156</span> + <span class="number">22883</span>*x^<span class="number">155</span> + <span class="number">19236</span>*x^<span class="number">154</span> + <span class="number">33772</span>*x^<span class="number">153</span> + <span class="number">5020</span>*x^<span class="number">152</span> + <span class="number">17943</span>*x^<span class="number">151</span> + <span class="number">26967</span>*x^<span class="number">150</span> + <span class="number">30847</span>*x^<span class="number">149</span> + <span class="number">10306</span>*x^<span class="number">148</span> + <span class="number">33966</span>*x^<span class="number">147</span> + <span class="number">43255</span>*x^<span class="number">146</span> + <span class="number">20342</span>*x^<span class="number">145</span> + <span class="number">4474</span>*x^<span class="number">144</span> + <span class="number">3490</span>*x^<span class="number">143</span> + <span class="number">38033</span>*x^<span class="number">142</span> + <span class="number">11224</span>*x^<span class="number">141</span> + <span class="number">30565</span>*x^<span class="number">140</span> + <span class="number">31967</span>*x^<span class="number">139</span> + <span class="number">32382</span>*x^<span class="number">138</span> + <span class="number">9759</span>*x^<span class="number">137</span> + <span class="number">1030</span>*x^<span class="number">136</span> + <span class="number">32122</span>*x^<span class="number">135</span> + <span class="number">42614</span>*x^<span class="number">134</span> + <span class="number">14280</span>*x^<span class="number">133</span> + <span class="number">16533</span>*x^<span class="number">132</span> + <span class="number">32676</span>*x^<span class="number">131</span> + <span class="number">43070</span>*x^<span class="number">130</span> + <span class="number">36009</span>*x^<span class="number">129</span> + <span class="number">28497</span>*x^<span class="number">128</span> + <span class="number">2940</span>*x^<span class="number">127</span> + <span class="number">9747</span>*x^<span class="number">126</span> + <span class="number">22758</span>*x^<span class="number">125</span> + <span class="number">16615</span>*x^<span class="number">124</span> + <span class="number">14086</span>*x^<span class="number">123</span> + <span class="number">13038</span>*x^<span class="number">122</span> + <span class="number">39603</span>*x^<span class="number">121</span> + <span class="number">36260</span>*x^<span class="number">120</span> + <span class="number">32502</span>*x^<span class="number">119</span> + <span class="number">17619</span>*x^<span class="number">118</span> + <span class="number">17700</span>*x^<span class="number">117</span> + <span class="number">15083</span>*x^<span class="number">116</span> + <span class="number">11311</span>*x^<span class="number">115</span> + <span class="number">36496</span>*x^<span class="number">114</span> + <span class="number">1300</span>*x^<span class="number">113</span> + <span class="number">13601</span>*x^<span class="number">112</span> + <span class="number">43425</span>*x^<span class="number">111</span> + <span class="number">10376</span>*x^<span class="number">110</span> + <span class="number">11551</span>*x^<span class="number">109</span> + <span class="number">13684</span>*x^<span class="number">108</span> + <span class="number">14955</span>*x^<span class="number">107</span> + <span class="number">6661</span>*x^<span class="number">106</span> + <span class="number">12674</span>*x^<span class="number">105</span> + <span class="number">21534</span>*x^<span class="number">104</span> + <span class="number">32132</span>*x^<span class="number">103</span> + <span class="number">34135</span>*x^<span class="number">102</span> + <span class="number">43684</span>*x^<span class="number">101</span> + <span class="number">837</span>*x^<span class="number">100</span> + <span class="number">29311</span>*x^<span class="number">99</span> + <span class="number">4849</span>*x^<span class="number">98</span> + <span class="number">26632</span>*x^<span class="number">97</span> + <span class="number">26662</span>*x^<span class="number">96</span> + <span class="number">10159</span>*x^<span class="number">95</span> + <span class="number">32657</span>*x^<span class="number">94</span> + <span class="number">12149</span>*x^<span class="number">93</span> + <span class="number">17858</span>*x^<span class="number">92</span> + <span class="number">35805</span>*x^<span class="number">91</span> + <span class="number">19391</span>*x^<span class="number">90</span> + <span class="number">30884</span>*x^<span class="number">89</span> + <span class="number">42039</span>*x^<span class="number">88</span> + <span class="number">17292</span>*x^<span class="number">87</span> + <span class="number">4694</span>*x^<span class="number">86</span> + <span class="number">1497</span>*x^<span class="number">85</span> + <span class="number">1744</span>*x^<span class="number">84</span> + <span class="number">31071</span>*x^<span class="number">83</span> + <span class="number">26246</span>*x^<span class="number">82</span> + <span class="number">24402</span>*x^<span class="number">81</span> + <span class="number">22068</span>*x^<span class="number">80</span> + <span class="number">39263</span>*x^<span class="number">79</span> + <span class="number">23703</span>*x^<span class="number">78</span> + <span class="number">21484</span>*x^<span class="number">77</span> + <span class="number">12241</span>*x^<span class="number">76</span> + <span class="number">28821</span>*x^<span class="number">75</span> + <span class="number">32886</span>*x^<span class="number">74</span> + <span class="number">43075</span>*x^<span class="number">73</span> + <span class="number">35741</span>*x^<span class="number">72</span> + <span class="number">19936</span>*x^<span class="number">71</span> + <span class="number">37219</span>*x^<span class="number">70</span> + <span class="number">33411</span>*x^<span class="number">69</span> + <span class="number">8301</span>*x^<span class="number">68</span> + <span class="number">12949</span>*x^<span class="number">67</span> + <span class="number">28611</span>*x^<span class="number">66</span> + <span class="number">42654</span>*x^<span class="number">65</span> + <span class="number">6910</span>*x^<span class="number">64</span> + <span class="number">18523</span>*x^<span class="number">63</span> + <span class="number">31144</span>*x^<span class="number">62</span> + <span class="number">21398</span>*x^<span class="number">61</span> + <span class="number">36298</span>*x^<span class="number">60</span> + <span class="number">27158</span>*x^<span class="number">59</span> + <span class="number">918</span>*x^<span class="number">58</span> + <span class="number">38601</span>*x^<span class="number">57</span> + <span class="number">4269</span>*x^<span class="number">56</span> + <span class="number">5699</span>*x^<span class="number">55</span> + <span class="number">36444</span>*x^<span class="number">54</span> + <span class="number">34791</span>*x^<span class="number">53</span> + <span class="number">37978</span>*x^<span class="number">52</span> + <span class="number">32481</span>*x^<span class="number">51</span> + <span class="number">8039</span>*x^<span class="number">50</span> + <span class="number">11012</span>*x^<span class="number">49</span> + <span class="number">11454</span>*x^<span class="number">48</span> + <span class="number">30450</span>*x^<span class="number">47</span> + <span class="number">1381</span>*x^<span class="number">46</span> + <span class="number">32403</span>*x^<span class="number">45</span> + <span class="number">8202</span>*x^<span class="number">44</span> + <span class="number">8404</span>*x^<span class="number">43</span> + <span class="number">37648</span>*x^<span class="number">42</span> + <span class="number">43696</span>*x^<span class="number">41</span> + <span class="number">34237</span>*x^<span class="number">40</span> + <span class="number">36490</span>*x^<span class="number">39</span> + <span class="number">41423</span>*x^<span class="number">38</span> + <span class="number">35792</span>*x^<span class="number">37</span> + <span class="number">36950</span>*x^<span class="number">36</span> + <span class="number">31086</span>*x^<span class="number">35</span> + <span class="number">38970</span>*x^<span class="number">34</span> + <span class="number">12439</span>*x^<span class="number">33</span> + <span class="number">7963</span>*x^<span class="number">32</span> + <span class="number">16150</span>*x^<span class="number">31</span> + <span class="number">11382</span>*x^<span class="number">30</span> + <span class="number">3038</span>*x^<span class="number">29</span> + <span class="number">20157</span>*x^<span class="number">28</span> + <span class="number">23531</span>*x^<span class="number">27</span> + <span class="number">32866</span>*x^<span class="number">26</span> + <span class="number">5428</span>*x^<span class="number">25</span> + <span class="number">21132</span>*x^<span class="number">24</span> + <span class="number">13443</span>*x^<span class="number">23</span> + <span class="number">28909</span>*x^<span class="number">22</span> + <span class="number">42716</span>*x^<span class="number">21</span> + <span class="number">6567</span>*x^<span class="number">20</span> + <span class="number">24744</span>*x^<span class="number">19</span> + <span class="number">8727</span>*x^<span class="number">18</span> + <span class="number">14895</span>*x^<span class="number">17</span> + <span class="number">28172</span>*x^<span class="number">16</span> + <span class="number">30903</span>*x^<span class="number">15</span> + <span class="number">26608</span>*x^<span class="number">14</span> + <span class="number">27314</span>*x^<span class="number">13</span> + <span class="number">42224</span>*x^<span class="number">12</span> + <span class="number">42551</span>*x^<span class="number">11</span> + <span class="number">37726</span>*x^<span class="number">10</span> + <span class="number">11203</span>*x^<span class="number">9</span> + <span class="number">36816</span>*x^<span class="number">8</span> + <span class="number">5537</span>*x^<span class="number">7</span> + <span class="number">20301</span>*x^<span class="number">6</span> + <span class="number">17591</span>*x^<span class="number">5</span> + <span class="number">41279</span>*x^<span class="number">4</span> + <span class="number">7999</span>*x^<span class="number">3</span> + <span class="number">33753</span>*x^<span class="number">2</span> + <span class="number">34551</span>*x + <span class="number">9659</span></span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line"><span class="comment">#sage 里 ^ 与 ** 相同</span></span><br><span class="line">P, Q = N.factor()</span><br><span class="line">P, Q = P[<span class="number">0</span>], Q[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(P.degree(), Q.degree())  <span class="comment"># 次数，即：最高次</span></span><br><span class="line">phi = (p ** P.degree() - <span class="number">1</span>) * (p ** Q.degree() - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = inverse_mod(e, phi)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, N)  <span class="comment"># 多项式m的各系数为明文每个字符对应的ascii码</span></span><br><span class="line">m = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> m.<span class="built_in">list</span>()])</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>

<h2 id="unusualrsa2-｜明文线性关系Franklin-Reiter攻击"><a href="#unusualrsa2-｜明文线性关系Franklin-Reiter攻击" class="headerlink" title="unusualrsa2    ｜明文线性关系Franklin-Reiter攻击"></a>unusualrsa2    ｜明文线性关系Franklin-Reiter攻击</h2><ul>
<li><a target="_blank" rel="noopener" href="https://4xwi11.github.io/posts/80806ae5/?highlight=%E5%A4%9A%E9%A1%B9%E5%BC%8Frsa">https://4xwi11.github.io/posts/80806ae5/?highlight=多项式rsa</a></li>
</ul>
<h3 id="题目-7"><a href="#题目-7" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ********************</span></span><br><span class="line"><span class="comment"># @Author: Lazzaro</span></span><br><span class="line"><span class="comment"># ********************</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, x, y</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(reduce(<span class="keyword">lambda</span> x,y:x&amp;y,[(i-<span class="number">5</span>)*i+<span class="number">6</span>==<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> x]))</span><br><span class="line"><span class="keyword">assert</span>(reduce(<span class="keyword">lambda</span> x,y:x&amp;y,[(j-<span class="number">15</span>)*j+<span class="number">44</span>==<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> y]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(reduce(<span class="keyword">lambda</span> x,y:x*m+y,x),<span class="number">17</span>,n))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(reduce(<span class="keyword">lambda</span> x,y:x*m+y,y),<span class="number">17</span>,n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#23772599983135215481563178266884362291876571759991288577057472733374903836591330410574958472090396886895304944176208711481780781286891334062794555288959410390926474473859289842654809538435377431088422352076225067494924657598298955407771484146155998883073439266427190212827600119365643065276814044272790573450938596830336430371987561905132579730619341196199420897034988685012777895002554746080384319298123154671447844799088258541911028041717897434816921424155687677867019535399434825468160227242441375503664915265223696139025407768146464383537556265875013085702422829200814612395116961538432886116917063119749068212699</span></span><br><span class="line"><span class="comment">#10900151504654409767059699202929100225155892269473271859207513720755903691031362539478242920144073599515746938827937863835169270383721094542639011665235593065932998091574636525973099426040452626893461449084383663453549354608769727777329036059746386523843912382289597182615339786437186169811342356085836838520978047561127661777189045888648773949147220411427306098338616422692914110656004863767719312410906124366000507952960331116878197129010412361636679449281808407214524741732730279777729251515759320442591663641984363061618865267606007355576230009922421807527598213455112981354590909603317525854070358390622096569841</span></span><br><span class="line"><span class="comment">#17298679220717326374674940612143058330715465693318467692839033642321129433471254547497087746971317567301086124779289015934582615377165560688447452762043163082394944604062014490446763247008217251611443338103074143809936437694543761369945095202092750900940979469994907399829695696313513303922266742415376818434932335640062684245008822643258497589196668426788916969378417960200705779461808292296450298558001909603602502604228973101048082095642290047196235959438278631661658312398313171590515776453711432353011579809351076532129444735206408591345372296372378396539831385036814349328459266432393612919118094115543053115450</span></span><br></pre></td></tr></table></figure>

<h3 id="解题脚本"><a href="#解题脚本" class="headerlink" title="解题脚本"></a>解题脚本</h3><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220506153047159.png" alt="image-20220506153047159"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本1</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attack</span>(<span class="params">c1, c2, n, e</span>):</span></span><br><span class="line">    PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="comment"># replace a,b,c,d</span></span><br><span class="line">    g1 = (<span class="number">2</span>*x+<span class="number">3</span>)^e - c1</span><br><span class="line">    g2 = (<span class="number">4</span>*x+<span class="number">11</span>)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">g1, g2</span>):</span></span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line">c1 = <span class="number">10900151504654409767059699202929100225155892269473271859207513720755903691031362539478242920144073599515746938827937863835169270383721094542639011665235593065932998091574636525973099426040452626893461449084383663453549354608769727777329036059746386523843912382289597182615339786437186169811342356085836838520978047561127661777189045888648773949147220411427306098338616422692914110656004863767719312410906124366000507952960331116878197129010412361636679449281808407214524741732730279777729251515759320442591663641984363061618865267606007355576230009922421807527598213455112981354590909603317525854070358390622096569841</span></span><br><span class="line">c2 = <span class="number">17298679220717326374674940612143058330715465693318467692839033642321129433471254547497087746971317567301086124779289015934582615377165560688447452762043163082394944604062014490446763247008217251611443338103074143809936437694543761369945095202092750900940979469994907399829695696313513303922266742415376818434932335640062684245008822643258497589196668426788916969378417960200705779461808292296450298558001909603602502604228973101048082095642290047196235959438278631661658312398313171590515776453711432353011579809351076532129444735206408591345372296372378396539831385036814349328459266432393612919118094115543053115450</span></span><br><span class="line">n = <span class="number">23772599983135215481563178266884362291876571759991288577057472733374903836591330410574958472090396886895304944176208711481780781286891334062794555288959410390926474473859289842654809538435377431088422352076225067494924657598298955407771484146155998883073439266427190212827600119365643065276814044272790573450938596830336430371987561905132579730619341196199420897034988685012777895002554746080384319298123154671447844799088258541911028041717897434816921424155687677867019535399434825468160227242441375503664915265223696139025407768146464383537556265875013085702422829200814612395116961538432886116917063119749068212699</span></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">m1 = attack(c1, c2, n, e)</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="string">&quot;%x&quot;</span> % <span class="built_in">int</span>(m1)))</span><br></pre></td></tr></table></figure>

<h2 id="unusuarsa4-inv-q-p-c-d-没n"><a href="#unusuarsa4-inv-q-p-c-d-没n" class="headerlink" title="unusuarsa4    |inv(q,p),c,d;没n"></a>unusuarsa4    |inv(q,p),c,d;没n</h2><ul>
<li><a target="_blank" rel="noopener" href="https://4xwi11.github.io/posts/80806ae5/?highlight=%E6%9C%89%E9%99%90%E5%9F%9F%E5%BC%80%E6%96%B9#unusuarsa4">参考博客</a>(4xwill师傅yyds</li>
</ul>
<h3 id="题目-8"><a href="#题目-8" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ********************</span></span><br><span class="line"><span class="comment"># @Author: Lazzaro</span></span><br><span class="line"><span class="comment"># ********************</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(invert(q,p))</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q_1 = <span class="number">113350138578125471637271827037682321496361317426731366252238155037440385105997423113671392038498349668206564266165641194668802966439465128197299073392773586475372002967691512324151673246253769186679521811837698540632534357656221715752733588763108463093085549826122278822507051740839450621887847679420115044512</span></span><br><span class="line">d = <span class="number">27451162557471435115589774083548548295656504741540442329428952622804866596982747294930359990602468139076296433114830591568558281638895221175730257057177963017177029796952153436494826699802526267315286199047856818119832831065330607262567182123834935483241720327760312585050990828017966534872294866865933062292893033455722786996125448961180665396831710915882697366767203858387536850040283296013681157070419459208544201363726008380145444214578735817521392863391376821427153094146080055636026442795625833039248405951946367504865008639190248509000950429593990524808051779361516918410348680313371657111798761410501793645137</span></span><br><span class="line">c = <span class="number">619543409290228183446186073184791934402487500047968659800765382797769750763696880547221266055431306972840980865602729031475343233357485820872268765911041297456664938715949124290204230537793877747551374176167292845717246943780371146830637073310108630812389581197831196039107931968703635129091224513813241403591357678410312272233389708366642638825455844282490676862737715585788829936919637988039113463707959069907015464745700766013573282604376277598510224455044288896809217461295080140187509519005245601483583507547733673523120385089098002298314719617693895392148294399937798485146568296114338393548124451378170302291</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h3><h4 id="理论推理"><a href="#理论推理" class="headerlink" title="理论推理"></a><strong>理论推理</strong></h4><ul>
<li>hint1: $$inv(q, p) · phi  \mod p$$</li>
<li>hint2: <ul>
<li>费马小定理</li>
<li>给定r, k1, k2，若 k2|k1，则：$r \mod k2 = (r \mod k1) \mod k2$</li>
</ul>
</li>
</ul>
<p>记inv(q, p) = q1, 题目给了q1，那么有如下性质:</p>
<p>$$q1* q ≡ 1 \mod p$$</p>
<p>构造hint1的格式：</p>
<p><code>q1*phi≡q1*(p-1)*(q-1)≡(p-1)*(q1*q - q1)≡(p-1) (1-q1)≡(1-q1) mod p</code></p>
<p>即：</p>
<p><code>q1*phi + q1 -1 = k*p</code></p>
<p><strong>记kp = q1*phi + q1 -1 ,则：p | kp</strong></p>
<p>接下来，聚焦hint2,任选满足$gcd(g, p) = 1$的g, 则：</p>
<p>$$g^{phi} ≡ 1 \mod n$$    —&gt;     $$g^{phi} ≡ 1 \mod p$$    —&gt;    $$(g^{phi} \mod kp) ≡ 1 \mod p$$</p>
<p>即：</p>
<p>$$p |(g^{phi} \mod kp) - 1$$</p>
<h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a><strong>解题思路</strong></h4><ol>
<li><p>知道e、d,则:$e*d -1 = k’ * phi$</p>
<p>利用此，爆破phi</p>
</li>
<li><p>用爆破出的phi计算<strong>kp</strong></p>
</li>
<li><p>任选两个素数g1, g2（这样有gcd(g, p) =1)</p>
<p>计算出x1 = $(g_1^{phi} \mod kp) -1$, x2 = $(g_2^{phi} \mod kp) -1$</p>
<p>易得：p = gcd(x1, x2)</p>
</li>
<li><p>由phi、p得q、n</p>
</li>
<li><p>RSA解密</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">q1 = <span class="number">113350138578125471637271827037682321496361317426731366252238155037440385105997423113671392038498349668206564266165641194668802966439465128197299073392773586475372002967691512324151673246253769186679521811837698540632534357656221715752733588763108463093085549826122278822507051740839450621887847679420115044512</span></span><br><span class="line">d = <span class="number">27451162557471435115589774083548548295656504741540442329428952622804866596982747294930359990602468139076296433114830591568558281638895221175730257057177963017177029796952153436494826699802526267315286199047856818119832831065330607262567182123834935483241720327760312585050990828017966534872294866865933062292893033455722786996125448961180665396831710915882697366767203858387536850040283296013681157070419459208544201363726008380145444214578735817521392863391376821427153094146080055636026442795625833039248405951946367504865008639190248509000950429593990524808051779361516918410348680313371657111798761410501793645137</span></span><br><span class="line">c = <span class="number">619543409290228183446186073184791934402487500047968659800765382797769750763696880547221266055431306972840980865602729031475343233357485820872268765911041297456664938715949124290204230537793877747551374176167292845717246943780371146830637073310108630812389581197831196039107931968703635129091224513813241403591357678410312272233389708366642638825455844282490676862737715585788829936919637988039113463707959069907015464745700766013573282604376277598510224455044288896809217461295080140187509519005245601483583507547733673523120385089098002298314719617693895392148294399937798485146568296114338393548124451378170302291</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        kp = q1 * phi - q1 + <span class="number">1</span></span><br><span class="line">        x1 = <span class="built_in">pow</span>(<span class="number">3</span>, phi, kp) - <span class="number">1</span></span><br><span class="line">        x2 = <span class="built_in">pow</span>(<span class="number">5</span>, phi, kp) - <span class="number">1</span></span><br><span class="line">        x = gmpy2.gcd(x1, x2)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(<span class="built_in">bin</span>(x)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) == <span class="number">1024</span>:</span><br><span class="line">            p = x</span><br><span class="line">            q = (phi // (p - <span class="number">1</span>)) + <span class="number">1</span></span><br><span class="line">            n = p * q</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line">    k += <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h2 id="unusualrsa1-｜m高位泄漏"><a href="#unusualrsa1-｜m高位泄漏" class="headerlink" title="unusualrsa1    ｜m高位泄漏"></a>unusualrsa1    ｜m高位泄漏</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ********************</span></span><br><span class="line"><span class="comment"># @Author: Lazzaro</span></span><br><span class="line"><span class="comment"># ********************</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(long_to_bytes(randint(<span class="number">0</span>,<span class="number">30</span>))*<span class="number">208</span>+flag)</span><br><span class="line"><span class="keyword">assert</span>(m.bit_length()==<span class="number">2044</span>)</span><br><span class="line"><span class="built_in">print</span>((m&gt;&gt;<span class="number">315</span>)&lt;&lt;<span class="number">315</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m,<span class="number">3</span>,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#14113948189208713011909396304970377626324044633561155020366406284451614054260708934598840781397326960921718892801653205159753091559901114082556464576477585198060530094478860626532455065960136263963965819002575418616768412539016154873800614138683106056209070597212668250136909436974469812231498651367459717175769611385545792201291192023843434476550550829737236225181770896867698281325858412643953550465132756142888893550007041167700300621499970661661288422834479368072744930285128061160879720771910458653611076539210357701565156322144818787619821653007453741709031635862923191561438148729294430924288173571196757351837</span></span><br><span class="line"><span class="comment">#1520800285708753284739523608878585974609134243280728660335545667177630830064371336150456537012842986526527904043383436211487979254140749228004148347597566264500276581990635110200009305900689510908049771218073767918907869112593870878204145615928290375086195098919355531430003571366638390993296583488184959318678321571278510231561645872308920917404996519309473979203661442792048291421574603018835698487725981963573816645574675640357569465990665689618997534740389987351864738104038598104713275375385003471306823348792559733332094774873827383320058176803218213042061965933143968710199376164960850951030741280074168795136</span></span><br><span class="line"><span class="comment">#6635663565033382363211849843446648120305449056573116171933923595209656581213410699649926913276685818674688954045817246263487415328838542489103709103428412175252447323358040041217431171817865818374522191881448865227314554997131690963910348820833080760482835650538394814181656599175839964284713498394589419605748581347163389157651739759144560719049281761889094518791244702056048080280278984031050608249265997808217512349309696532160108250480622956599732443714546043439089844571655280770141647694859907985919056009576606333143546094941635324929407538860140272562570973340199814409134962729885962133342668270226853146819</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-8"><a href="#题解-8" class="headerlink" title="题解"></a>题解</h3><p>m高位泄漏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">14113948189208713011909396304970377626324044633561155020366406284451614054260708934598840781397326960921718892801653205159753091559901114082556464576477585198060530094478860626532455065960136263963965819002575418616768412539016154873800614138683106056209070597212668250136909436974469812231498651367459717175769611385545792201291192023843434476550550829737236225181770896867698281325858412643953550465132756142888893550007041167700300621499970661661288422834479368072744930285128061160879720771910458653611076539210357701565156322144818787619821653007453741709031635862923191561438148729294430924288173571196757351837</span></span><br><span class="line">mbar = <span class="number">1520800285708753284739523608878585974609134243280728660335545667177630830064371336150456537012842986526527904043383436211487979254140749228004148347597566264500276581990635110200009305900689510908049771218073767918907869112593870878204145615928290375086195098919355531430003571366638390993296583488184959318678321571278510231561645872308920917404996519309473979203661442792048291421574603018835698487725981963573816645574675640357569465990665689618997534740389987351864738104038598104713275375385003471306823348792559733332094774873827383320058176803218213042061965933143968710199376164960850951030741280074168795136</span></span><br><span class="line">c = <span class="number">6635663565033382363211849843446648120305449056573116171933923595209656581213410699649926913276685818674688954045817246263487415328838542489103709103428412175252447323358040041217431171817865818374522191881448865227314554997131690963910348820833080760482835650538394814181656599175839964284713498394589419605748581347163389157651739759144560719049281761889094518791244702056048080280278984031050608249265997808217512349309696532160108250480622956599732443714546043439089844571655280770141647694859907985919056009576606333143546094941635324929407538860140272562570973340199814409134962729885962133342668270226853146819</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">kbits = <span class="number">315</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">f = (mbar + x) ^ e - c</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">1</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor = n</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(mbar) + <span class="built_in">int</span>(x0)))</span><br></pre></td></tr></table></figure>

<h2 id="长安杯-2021-checkin-｜威尔逊定理"><a href="#长安杯-2021-checkin-｜威尔逊定理" class="headerlink" title="[长安杯 2021]checkin    ｜威尔逊定理"></a>[长安杯 2021]checkin    ｜威尔逊定理</h2><h3 id="题目-9"><a href="#题目-9" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">16</span>)</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,p-q):</span><br><span class="line">    m = m*i%n</span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(<span class="number">2</span>,e,n))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(m,e,n))</span><br><span class="line"><span class="comment">#4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line"><span class="comment">#3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-9"><a href="#题解-9" class="headerlink" title="题解"></a>题解</h3><p>前置知识</p>
<h4 id="威尔逊定理："><a href="#威尔逊定理：" class="headerlink" title="威尔逊定理："></a>威尔逊定理：</h4><ul>
<li><p>对于<strong>素数p</strong>有充分必要条件：</p>
<p>$$(p-1)! ≡ -1 \mod p$$</p>
</li>
</ul>
<p>聚焦题目,已知：</p>
<ol>
<li>$c1 = 2^e \mod n$</li>
<li>$c2 = m^{e} \mod n$</li>
<li>e = 1049</li>
</ol>
<p>利用 1 ，得到：$c1 - 2^e = k*n$</p>
<p>分解$c1-2^e$再根据位数，<strong>得到p、q</strong></p>
<p>解出<code>m_</code>（此<code>m_</code>显然不是flag对应的long型数字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">c1 =  <span class="number">4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line">c2 = <span class="number">3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line">kn = <span class="built_in">pow</span>(<span class="number">2</span>, e) - c1</span><br><span class="line"><span class="comment"># kn = k*p*q</span></span><br><span class="line"><span class="comment"># 分解得p、q:</span></span><br><span class="line">p = <span class="number">170229264879724117919007372149468684565431232721075153274808454126426741324966131188484635914814926870341378228417496808202497615585946352638507704855332363766887139815236730403246238633855524068161116748612090155595549964229654262432946553891601975628848891407847198187453488358420350203927771308228162321231</span></span><br><span class="line">q = <span class="number">34211</span></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m_ = <span class="built_in">int</span>(<span class="built_in">pow</span>(c2, d, n))  <span class="comment"># m_不是flag对应的m</span></span><br></pre></td></tr></table></figure>

<p>看题目代码里，唯一复杂的部分:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for <span class="selector-tag">i</span> in range(<span class="number">1</span>,<span class="selector-tag">p</span>-<span class="selector-tag">q</span>):</span><br><span class="line">    m = m*i%n</span><br></pre></td></tr></table></figure>

<p>以下，推理其性质</p>
<p>$m_0$(flag对应的)</p>
<p>$m1 = (m_0 * 1) \mod n$</p>
<p>$m2 = (((m_0 * 1)\mod n) *2) \mod n = (m_0 * 1 *2) \mod n$</p>
<p>$ m3 = (((m_0 * 1 *2)\mod n)*3) \mod n = (m_0 * 1 *2 *3) \mod n$</p>
<p>$…$</p>
<p>$m_n = (m_0 * p!) \mod n$</p>
<blockquote>
<p>实际做题时，就是看到<strong>阶乘</strong>才知道利用<strong>威尔逊定理</strong></p>
</blockquote>
<p>由题目，得：</p>
<p>m_ = $(m_0 * (p-q-1)!) \mod n$</p>
<p>等号是兼容同余的，由<a target="_blank" rel="noopener" href="https://blog.csdn.net/linkfqy/article/details/55505413?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165183209316781683963479%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165183209316781683963479&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-3-55505413-null-null.142%5Ev9%5Econtrol,157%5Ev4%5Enew_style&utm_term=%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B%E6%80%A7%E8%B4%A8&spm=1018.2226.3001.4187">同余性质9</a>有：m_ $≡ (m_0 * (p-q-1)!) \mod p$</p>
<p>则，有：m_ $= (m_0 * (p-q-1)!) \mod p$</p>
<p>为使用威尔逊定理，构造出p！</p>
<p><code>(m_ * [(p-q)*(p-q+1)*...*(p-1)] ) mod p  = m_0*(p-1)! mod p</code></p>
<p>由威尔逊定理，得：<code>(m_ * [(p-q)*(p-q+1)*...*(p-1)])  mod p  = m_0*(p-1)! mod p = -m_0 mod p</code></p>
<p>那么，<code>m0 = (inv(-1, p)*m_ * [(p-q)*(p-q+1)*...*(p-1)]) mod p + k*p</code></p>
<p>这里另一个难题是，求<code>m_ * ([p-q)*(p-q+1)*...*(p-1)]) mod p)</code></p>
<p>其实，利用题目的给的格式即可求得，然后爆破m0,解出flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p-q, p):</span><br><span class="line">    m_ = m_ * i % p</span><br><span class="line"></span><br><span class="line">m = -m_ % p  <span class="comment"># 本质上是 inv(-1, p)*m_ % q</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;k=&#x27;</span>, k)</span><br><span class="line">    m += k*p</span><br><span class="line">    flag = libnum.n2s(m)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="总代码"><a href="#总代码" class="headerlink" title="总代码"></a>总代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">c1 =  <span class="number">4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line">c2 = <span class="number">3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line">kn = <span class="built_in">pow</span>(<span class="number">2</span>, e) - c1</span><br><span class="line"><span class="comment"># kn = k*p*q</span></span><br><span class="line"><span class="comment"># 分解得p、q:</span></span><br><span class="line">p = <span class="number">170229264879724117919007372149468684565431232721075153274808454126426741324966131188484635914814926870341378228417496808202497615585946352638507704855332363766887139815236730403246238633855524068161116748612090155595549964229654262432946553891601975628848891407847198187453488358420350203927771308228162321231</span></span><br><span class="line">q = <span class="number">34211</span></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m_ = <span class="built_in">int</span>(<span class="built_in">pow</span>(c2, d, n))  <span class="comment"># m_不是flag对应的m</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p-q, p):</span><br><span class="line">    m_ = m_ * i % p</span><br><span class="line"></span><br><span class="line">m = -m_ % p  <span class="comment"># 本质上是 inv(-1, p)*m_ % q</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Harry0597
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://harry0597.com/2022/05/06/RSA%E9%A2%98%E5%9E%8B%E6%80%BB%E7%BB%93/" title="RSA题型总结">https://harry0597.com/2022/05/06/RSA题型总结/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Crypto/" rel="tag"><i class="fa fa-tag"></i> Crypto</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/04/29/DES%E7%AE%97%E6%B3%95/" rel="prev" title="DES算法">
      <i class="fa fa-chevron-left"></i> DES算法
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/09/2022%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E6%98%A5%E5%AD%A3%E8%B5%9B/" rel="next" title="2022年春秋杯网络安全联赛春季赛·Crypto WP">
      2022年春秋杯网络安全联赛春季赛·Crypto WP <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81NDk1Mi8zMTQyMQ=="></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CLASSICAL-RSA-FOR-CTF"><span class="nav-number">1.</span> <span class="nav-text">CLASSICAL RSA FOR CTF</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-easy-crypto-%EF%BD%9C-N%E4%B8%AD%E6%9C%89%E5%A4%A7%E5%90%88%E6%95%B0"><span class="nav-number">1.1.</span> <span class="nav-text">Crypto_easy_crypto    ｜    N中有大合数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">1.1.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">1.1.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-number">1.1.3.</span> <span class="nav-text">结论</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CRT-%E5%85%B1d"><span class="nav-number">1.2.</span> <span class="nav-text">CRT    |    共d</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-1"><span class="nav-number">1.2.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA-1"><span class="nav-number">1.2.3.</span> <span class="nav-text">结论</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#crtrsa-%EF%BD%9C-dp%E5%B0%8F%EF%BC%8Ce-%E5%BE%88%E5%A4%A7"><span class="nav-number">1.3.</span> <span class="nav-text">crtrsa    ｜    dp小，e 很大</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="nav-number">1.3.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-2"><span class="nav-number">1.3.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">1.3.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Easy-Rsa-%EF%BD%9C-p-1%E3%80%81q-1%E6%9C%89%E5%85%AC%E5%9B%A0%E5%AD%90"><span class="nav-number">1.4.</span> <span class="nav-text">Easy_Rsa    ｜ p-1、q-1有公因子</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="nav-number">1.4.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-3"><span class="nav-number">1.4.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">1.4.3.</span> <span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Common-Prime-RSA"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">Common Prime RSA</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#baby-rsa-%EF%BD%9C-p-q-v-i-m-i-1-%E2%88%92-v-i-1-m-i"><span class="nav-number">1.5.</span> <span class="nav-text">baby_rsa    ｜$p, q&#x3D;v_i^{m_i+1}−(v_i+1)^{m_i}$</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-4"><span class="nav-number">1.5.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-4"><span class="nav-number">1.5.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-2"><span class="nav-number">1.5.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#special-rsa-e-p-1-amp-e-q-1"><span class="nav-number">1.6.</span> <span class="nav-text">special_rsa    |  (e|p-1) &amp; (e|q-1)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-3"><span class="nav-number">1.6.1.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CVE-OF-RSA-%EF%BD%9Cp-k-m-65537-a-n"><span class="nav-number">1.7.</span> <span class="nav-text">CVE OF RSA    ｜p&#x3D;k*m+(65537**a % n)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-5"><span class="nav-number">1.7.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-4"><span class="nav-number">1.7.2.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#babyrsa-%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB"><span class="nav-number">1.8.</span> <span class="nav-text">babyrsa    |低加密指数广播攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-6"><span class="nav-number">1.8.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-5"><span class="nav-number">1.8.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-5"><span class="nav-number">1.8.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rabin-%E6%A8%A14%E4%B8%8D%E4%BD%993"><span class="nav-number">1.9.</span> <span class="nav-text">Rabin    |模4不余3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#n%E6%AC%A1%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B"><span class="nav-number">1.9.1.</span> <span class="nav-text">n次同余方程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Swedish-RSA-%EF%BD%9C%E5%A4%9A%E9%A1%B9%E5%BC%8FRSA"><span class="nav-number">1.10.</span> <span class="nav-text">Swedish RSA    ｜多项式RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%89%E9%99%90%E5%9F%9F%E4%B8%8A%E7%9A%84%E5%A4%9A%E9%A1%B9%E5%BC%8F"><span class="nav-number">1.10.1.</span> <span class="nav-text">有限域上的多项式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="nav-number">1.10.1.1.</span> <span class="nav-text">加解密</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-6"><span class="nav-number">1.10.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#unusualrsa2-%EF%BD%9C%E6%98%8E%E6%96%87%E7%BA%BF%E6%80%A7%E5%85%B3%E7%B3%BBFranklin-Reiter%E6%94%BB%E5%87%BB"><span class="nav-number">1.11.</span> <span class="nav-text">unusualrsa2    ｜明文线性关系Franklin-Reiter攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-7"><span class="nav-number">1.11.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC"><span class="nav-number">1.11.2.</span> <span class="nav-text">解题脚本</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#unusuarsa4-inv-q-p-c-d-%E6%B2%A1n"><span class="nav-number">1.12.</span> <span class="nav-text">unusuarsa4    |inv(q,p),c,d;没n</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-8"><span class="nav-number">1.12.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-7"><span class="nav-number">1.12.2.</span> <span class="nav-text">题解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%90%86%E8%AE%BA%E6%8E%A8%E7%90%86"><span class="nav-number">1.12.2.1.</span> <span class="nav-text">理论推理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="nav-number">1.12.2.2.</span> <span class="nav-text">解题思路</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#unusualrsa1-%EF%BD%9Cm%E9%AB%98%E4%BD%8D%E6%B3%84%E6%BC%8F"><span class="nav-number">1.13.</span> <span class="nav-text">unusualrsa1    ｜m高位泄漏</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-8"><span class="nav-number">1.13.1.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%BF%E5%AE%89%E6%9D%AF-2021-checkin-%EF%BD%9C%E5%A8%81%E5%B0%94%E9%80%8A%E5%AE%9A%E7%90%86"><span class="nav-number">1.14.</span> <span class="nav-text">[长安杯 2021]checkin    ｜威尔逊定理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-9"><span class="nav-number">1.14.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-9"><span class="nav-number">1.14.2.</span> <span class="nav-text">题解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A8%81%E5%B0%94%E9%80%8A%E5%AE%9A%E7%90%86%EF%BC%9A"><span class="nav-number">1.14.2.1.</span> <span class="nav-text">威尔逊定理：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">1.14.3.</span> <span class="nav-text">总代码</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Harry0597"
      src="/images/IMG_2550.JPG">
  <p class="site-author-name" itemprop="name">Harry0597</p>
  <div class="site-description" itemprop="description">Pondering'll do you wonders.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:1915885792@qq.com" title="E-Mail → mailto:1915885792@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>


      
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CS/" rel="tag">CS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-OS/" rel="tag">Mac OS</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Writeup/" rel="tag">Writeup</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">杂</a><span class="tag-list-count">5</span></li></ul>
              </canvas>
          </div>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harry0597</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">470k</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
