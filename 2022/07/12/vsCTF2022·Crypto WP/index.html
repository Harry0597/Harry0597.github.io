<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/ico" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/hackerrank.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harry0597.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="2022&#x2F;7&#x2F;10&#x2F;0:00 - 7&#x2F;11&#x2F;0:00">
<meta property="og:type" content="article">
<meta property="og:title" content="vsCTF2022·Crypto WP">
<meta property="og:url" content="https://harry0597.com/2022/07/12/vsCTF2022%C2%B7Crypto%20WP/index.html">
<meta property="og:site_name" content="Harry&#39;s Blog">
<meta property="og:description" content="2022&#x2F;7&#x2F;10&#x2F;0:00 - 7&#x2F;11&#x2F;0:00">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220711010734262.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220710002807418.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/Art_Final_2022.png">
<meta property="article:published_time" content="2022-07-12T09:53:37.000Z">
<meta property="article:modified_time" content="2022-07-12T10:16:32.744Z">
<meta property="article:author" content="Harry0597">
<meta property="article:tag" content="Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220711010734262.png">

<link rel="canonical" href="https://harry0597.com/2022/07/12/vsCTF2022%C2%B7Crypto%20WP/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>vsCTF2022·Crypto WP | Harry's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Harry's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">温故知新</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Harry0597" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://harry0597.com/2022/07/12/vsCTF2022%C2%B7Crypto%20WP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/IMG_2550.JPG">
      <meta itemprop="name" content="Harry0597">
      <meta itemprop="description" content="Pondering'll do you wonders.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Harry's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          vsCTF2022·Crypto WP
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-12 17:53:37 / 修改时间：18:16:32" itemprop="dateCreated datePublished" datetime="2022-07-12T17:53:37+08:00">2022-07-12</time>
            </span>

          
    <span>&emsp;</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span>
    <span class="post-meta-item-text">阅读次数：</span>
    <span id="busuanzi_value_page_pv"></span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/07/12/vsCTF2022%C2%B7Crypto%20WP/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/07/12/vsCTF2022%C2%B7Crypto%20WP/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>36k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>33 分钟</span>
            </span>
            <div class="post-description">2022/7/10/0:00 - 7/11/0:00</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="vsctf2022·Crypto-WP"><a href="#vsctf2022·Crypto-WP" class="headerlink" title="vsctf2022·Crypto WP"></a>vsctf2022·Crypto WP</h1><h2 id="解题情况"><a href="#解题情况" class="headerlink" title="解题情况"></a>解题情况</h2><p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220711010734262.png" alt="solution"></p>
<p>可惜，差一题AK</p>
<h2 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><ul>
<li><p>chall.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read().strip()</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> p % e != <span class="number">1</span>:</span><br><span class="line">    p = getPrime(<span class="number">128</span>)</span><br><span class="line"><span class="keyword">while</span> q % e != <span class="number">1</span>:</span><br><span class="line">    q = getPrime(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Ciphertext: <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pubkey.pem&quot;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pk = RSA.construct([n, e])</span><br><span class="line">    f.write(pk.exportKey(<span class="string">&#x27;PEM&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ciphertext: 0x459cc234f24a2fb115ff10e272130048d996f5b562964ee6138442a4429af847</span></span><br></pre></td></tr></table></figure></li>
<li><p>pubkey.txt</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN <span class="keyword">PUBLIC</span> <span class="keyword">KEY</span>-----</span><br><span class="line">MDkwDQYJKoZIhvcNAQEBBQADKAAwJQIgc+RINge/zsBmxaAC/gP7Cc/g9t3lV1Nv</span><br><span class="line">n0fVaCXTj+<span class="number">8</span>CAWU=</span><br><span class="line">-----<span class="keyword">END</span> <span class="keyword">PUBLIC</span> <span class="keyword">KEY</span>-----</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>解析公钥，得</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">密钥类型RSA</span><br><span class="line">密钥强度<span class="number">255</span></span><br><span class="line"><span class="function"><span class="title">PN</span><span class="params">(e)</span></span><span class="number">101</span></span><br><span class="line"><span class="function"><span class="title">PN</span><span class="params">(n)</span></span></span><br><span class="line"><span class="number">5241931710023528635805711434963988209377999739420208266404440132</span></span><br><span class="line"><span class="number">8860087685103</span></span><br><span class="line">DER格式</span><br><span class="line"><span class="number">3039300</span>d06092a864886f70d01010105000328003025022073e4483607bfcec066c5a002fe03fb09cfe0f6dde557536f9f47d56825d38fef020165</span><br></pre></td></tr></table></figure>

<ul>
<li><p>e=101</p>
</li>
<li><p>n=5241931710023528635805711434963988209377999739420208266404440132<br>8860087685103</p>
<p>n比较小，可以直接拆</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220710002807418.png" alt="image-20220710002807418"></p>
<p>由题目，知：e｜p-1, e|q-1</p>
<p>模版题，AMM+CRT实现有限域开根，拿到一🩸</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line"><span class="attribute">p</span>=184980129074643957218827272858529362113</span><br><span class="line"><span class="attribute">q</span>=283378097758180413812138939650885549231</span><br><span class="line"><span class="attribute">c</span>=0x459cc234f24a2fb115ff10e272130048d996f5b562964ee6138442a4429af847</span><br><span class="line">n = 52419317100235286358057114349639882093779997394202082664044401328860087685103</span><br><span class="line">e = 101</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">f</span>=a^e-c</span><br><span class="line"><span class="attribute">mps</span>=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">g</span>=a^e-c</span><br><span class="line"><span class="attribute">mqs</span>=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    <span class="attribute">x</span>=mpp[0]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        <span class="attribute">y</span>=mqq[0]</span><br><span class="line">        solution = CRT_list([int(x), int(y)], [p, q])</span><br><span class="line">        <span class="builtin-name">print</span>(libnum.n2s(int(solution)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># vsctf&#123;5m411_Pr1m3_15_Un54f3!&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>vsctf{5m411_Pr1m3_15_Un54f3!}</p>
</blockquote>
<h2 id="Recovery"><a href="#Recovery" class="headerlink" title="Recovery"></a>Recovery</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># I coded this so that I wouldn&#x27;t have to use a database!</span></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">validate</span>(<span class="params">password: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(password) != <span class="number">49</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    key = [<span class="string">&#x27;vs&#x27;</span>.join(<span class="built_in">str</span>(randint(<span class="number">7</span>, <span class="number">9</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(i))) + <span class="string">&#x27;vs&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> password[::-<span class="number">2</span>]]</span><br><span class="line">    gate = [<span class="number">118</span>, <span class="number">140</span>, <span class="number">231</span>, <span class="number">176</span>, <span class="number">205</span>, <span class="number">480</span>, <span class="number">308</span>, <span class="number">872</span>, <span class="number">702</span>, <span class="number">820</span>, <span class="number">1034</span>, <span class="number">1176</span>, <span class="number">1339</span>, <span class="number">1232</span>, <span class="number">1605</span>, <span class="number">1792</span>, <span class="number">782</span>, <span class="number">810</span>, <span class="number">1197</span>, <span class="number">880</span>,</span><br><span class="line">            <span class="number">924</span>, <span class="number">1694</span>, <span class="number">2185</span>, <span class="number">2208</span>, <span class="number">2775</span>]</span><br><span class="line">    <span class="comment"># enumerate(zip(gate, key), 1) 从1开始写key的字典</span></span><br><span class="line">    <span class="keyword">if</span> [randint(a, b[<span class="number">0</span>]) <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(gate, key), <span class="number">1</span>) <span class="keyword">if</span> <span class="built_in">len</span>(b[<span class="number">1</span>]) != <span class="number">3</span> * (b[<span class="number">0</span>] + <span class="number">7</span> * a) // a]:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># a: passwd[a] + passwd[a+24]</span></span><br><span class="line">    hammer = &#123;<span class="built_in">str</span>(a): password[a] + password[a + <span class="built_in">len</span>(password) // <span class="number">2</span>] <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(password) // <span class="number">2</span>, <span class="number">2</span>)&#125;  <span class="comment"># 49//2 = 24</span></span><br><span class="line">    block = <span class="string">b&#x27;c3MxLnRkMy57XzUuaE83LjVfOS5faDExLkxfMTMuR0gxNS5fTDE3LjNfMTkuMzEyMS5pMzIz&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> b64encode(<span class="string">b&#x27;.&#x27;</span>.join([((b + a).encode()) <span class="keyword">for</span> a, b <span class="keyword">in</span> hammer.items()])) != block:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    passwd = <span class="built_in">input</span>(<span class="string">&#x27;Please validate your ID using your password\n&gt; &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> validate(passwd):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Access Granted: You now have gained access to the View Source Flag Vault!&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Access Denied :(&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><p>一道逆向？总之对我而言，因为这种题做的比较少，题目代码看起来有些费劲，看久一点，代码懂了跟着逆就结束了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="string">&quot;&quot;&quot;password = &#x27;sagnajksbgiqkgafg&#x27;</span></span><br><span class="line"><span class="string">print(password[::-2])  # 倒着数，隔一个</span></span><br><span class="line"><span class="string">print([&#x27;vs&#x27; for i in password[::-2]])</span></span><br><span class="line"><span class="string">print([ord(i) for i in password[::-2]])</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">key = [&#x27;vs&#x27;.join(str(randint(7, 9)) for _ in range(ord(i))) + &#x27;vs&#x27; for i in password[::-2]]</span></span><br><span class="line"><span class="string">print(key)</span></span><br><span class="line"><span class="string">print(len(key))</span></span><br><span class="line"><span class="string"># 根据key每组的长度可指导对应ord(i)</span></span><br><span class="line"><span class="string">gate = [118, 140, 231, 176, 205, 480, 308, 872, 702, 820, 1034, 1176, 1339, 1232, 1605, 1792, 782, 810, 1197, 880,</span></span><br><span class="line"><span class="string">        924, 1694, 2185, 2208, 2775]</span></span><br><span class="line"><span class="string">print(len(gate))</span></span><br><span class="line"><span class="string"># 25&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a = b&#x27;.&#x27;.join([((b + a).encode()) for a, b in hammer.items()])</span></span><br><span class="line">a = <span class="string">&#x27;ss1.td3.&#123;_5.hO7.5_9._h11.L_13.GH15._L17.3_19.3121.i323&#x27;</span></span><br><span class="line"><span class="comment"># b = b&#x27;.&#x27;.join([((b + a).encode()) for a, b in hammer.items()])</span></span><br><span class="line">b = a.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">dict_data = &#123;&#125;</span><br><span class="line">a = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">    dict_data[a] = i[<span class="number">0</span>]</span><br><span class="line">    dict_data[a+<span class="number">24</span>] = i[<span class="number">1</span>]</span><br><span class="line">    a += <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> a &gt; <span class="number">23</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dict_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gate = [<span class="number">118</span>, <span class="number">140</span>, <span class="number">231</span>, <span class="number">176</span>, <span class="number">205</span>, <span class="number">480</span>, <span class="number">308</span>, <span class="number">872</span>, <span class="number">702</span>, <span class="number">820</span>, <span class="number">1034</span>, <span class="number">1176</span>, <span class="number">1339</span>, <span class="number">1232</span>, <span class="number">1605</span>, <span class="number">1792</span>, <span class="number">782</span>, <span class="number">810</span>, <span class="number">1197</span>, <span class="number">880</span>,</span><br><span class="line">        <span class="number">924</span>, <span class="number">1694</span>, <span class="number">2185</span>, <span class="number">2208</span>, <span class="number">2775</span>]</span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">p1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> gate:</span><br><span class="line">        tmp = <span class="number">3</span> * (i + <span class="number">7</span> * a) // a</span><br><span class="line">        p1  += <span class="string">&#x27; &#x27;</span> + <span class="built_in">chr</span>(tmp//<span class="number">3</span>)</span><br><span class="line">        a +=<span class="number">1</span></span><br><span class="line">p = p1[::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="comment"># v c f T 3 3 F 4 5 w r _ n i e Y U t 3 W 0 3 T M &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># s t &#123; h 5 _ L G _ 3 3 i s d _ O _ h _ H L _ 1 3</span></span><br><span class="line"><span class="comment">#vsctf&#123;Th353_FL4G5_3 3 i s d _ O _ h _ H L _ 1 3</span></span><br><span class="line"></span><br><span class="line">L = <span class="built_in">list</span>(dict_data.items())  <span class="comment"># 得到列表: L=[(&#x27;a&#x27;, 1), (&#x27;c&#x27;, 3), (&#x27;b&#x27;, 2)]</span></span><br><span class="line">L.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>], reverse=<span class="literal">False</span>)  <span class="comment"># 按列表中，每一个元组的第二个元素从小到大排序。</span></span><br><span class="line">p2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    p2 += <span class="string">&#x27; &#x27;</span> + i[-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(p2)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;vsctf&#123;Th353_FL4G5_w3r3_inside_YOU_th3_WH0L3_T1M3&#125;&#x27;</span>  <span class="comment"># 根据p1、p2手动拼写flag</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># vsctf&#123;Th353_FL4G5_w3r3_inside_YOU_th3_WH0L3_T1M3&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>vsctf{Th353_FL4G5_w3r3_inside_YOU_th3_WH0L3_T1M3}</p>
</blockquote>
<h2 id="Strongest-rsa"><a href="#Strongest-rsa" class="headerlink" title="Strongest rsa"></a>Strongest rsa</h2><blockquote>
<p>I think getStrongPrime is not safe enough, so I implemented an RSA algorithm using the strongest primes ever. I don’t think it’s breakable unless you have a quantum computer!</p>
<p>我认为getStrongPrime不够安全，所以我使用有史以来最强的素数实现了一个RSA算法。我不认为它是易碎的，除非你有一台量子计算机！</p>
</blockquote>
<h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> prevprime, factorial</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getStrongestPrime</span>(<span class="params">nbits</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getStrongPrime(nbits)</span><br><span class="line">        delta = random.randint(<span class="number">0x1337</span>, <span class="number">0x1337</span> + <span class="number">0x1337</span>)</span><br><span class="line">        pp = p - delta</span><br><span class="line">        ppp = prevprime(factorial(pp) % p)  <span class="comment"># 前一个（比它小的）素数阶乘，</span></span><br><span class="line">        <span class="keyword">if</span> gcd(ppp-<span class="number">1</span>, e) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> p, ppp</span><br><span class="line"></span><br><span class="line">NBITS = <span class="number">1024</span></span><br><span class="line">p0, p = getStrongestPrime(NBITS)</span><br><span class="line">q0, q = getStrongestPrime(NBITS)</span><br><span class="line">N = p * q</span><br><span class="line">m = bytes_to_long(FLAG.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p0 = <span class="subst">&#123;p0&#125;</span>\nq0 = <span class="subst">&#123;q0&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;N = <span class="subst">&#123;N&#125;</span>\ne = <span class="subst">&#123;e&#125;</span>\nc = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> delta <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1337</span>, <span class="number">0x1337</span> + <span class="number">0x1337</span>):</span><br><span class="line">    <span class="built_in">print</span>(delta)</span><br><span class="line">    pp = <span class="built_in">int</span>(p0 - delta)</span><br><span class="line">    ppp = prevprime(factorial(pp) % p)</span><br><span class="line">    <span class="keyword">if</span> gcd(ppp-<span class="number">1</span>, e) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> N % ppp == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, ppp)</span><br><span class="line">            </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p0 = 163753477176210014003355280732229891908166074468271556144642666169325605017666799921295576722168608401188682320182653287668989748162506955989407213845500704903463544753049275828138559289189335596749709834289278256382427251831790026921563375111737350084174473833546767952081017613072491759534988253353621530923</span></span><br><span class="line"><span class="string">q0 = 157598184809589313845990455272198459548591786211953253450211152128535343234857067521711590445365424087430728267491317690639227988484930088637483194045435135802590588269993794073236513557034321374876808546159597997280236993358749182432517011554239468502233558179815446959403076134284375214662245037202945590183</span></span><br><span class="line"><span class="string">N = 11884142558095727641000594156833818117849240126500615037738361957005811068956622520280143210434649198031005585252791693777710458190732464123269660559382653636999601459113099276826723072914352276709761755328542359490331355061792823458149611674845846523699218971126655186522340818792078719216860046464292413878045842425132308544311887062610272360069819975798905665533964761527225558339025724872067751916657135473510775709503714808686565298632040214249698116863336246844759838665285888816202570667521796553678688293761589082062045634768520102235077364345013564344229095323239077977717497503322831684471959195555281580807</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 11776079752956619284016871274992903352398310565005810097721997339193718454945819135683541554652454321040530044545154341786048659896370226535387839157317585368391189570502841702311449000698372030666509296004039398083488490698999338894328619127149024309470011330855840757405205104944658961386764569043610715311746676861275270073394069269043429092551681704290340091149637137627751767730812255069347108706434972786681985484368054390699974613090342753508097177008167140924577095976699437810398922852319420301082587264411993737330188227703869101718515748828944300463051133118636928879090217708121368293440440444106196607645</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><p>数据给多了🤔</p>
<p>用威尔逊定理实现阶乘运算，遍历delta即可获取p或q</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> prevprime, factorial</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">p0 = <span class="number">163753477176210014003355280732229891908166074468271556144642666169325605017666799921295576722168608401188682320182653287668989748162506955989407213845500704903463544753049275828138559289189335596749709834289278256382427251831790026921563375111737350084174473833546767952081017613072491759534988253353621530923</span></span><br><span class="line">q0 = <span class="number">157598184809589313845990455272198459548591786211953253450211152128535343234857067521711590445365424087430728267491317690639227988484930088637483194045435135802590588269993794073236513557034321374876808546159597997280236993358749182432517011554239468502233558179815446959403076134284375214662245037202945590183</span></span><br><span class="line">N = <span class="number">11884142558095727641000594156833818117849240126500615037738361957005811068956622520280143210434649198031005585252791693777710458190732464123269660559382653636999601459113099276826723072914352276709761755328542359490331355061792823458149611674845846523699218971126655186522340818792078719216860046464292413878045842425132308544311887062610272360069819975798905665533964761527225558339025724872067751916657135473510775709503714808686565298632040214249698116863336246844759838665285888816202570667521796553678688293761589082062045634768520102235077364345013564344229095323239077977717497503322831684471959195555281580807</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">11776079752956619284016871274992903352398310565005810097721997339193718454945819135683541554652454321040530044545154341786048659896370226535387839157317585368391189570502841702311449000698372030666509296004039398083488490698999338894328619127149024309470011330855840757405205104944658961386764569043610715311746676861275270073394069269043429092551681704290340091149637137627751767730812255069347108706434972786681985484368054390699974613090342753508097177008167140924577095976699437810398922852319420301082587264411993737330188227703869101718515748828944300463051133118636928879090217708121368293440440444106196607645</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solver</span>(<span class="params">p0</span>):</span></span><br><span class="line">    <span class="keyword">for</span> delta <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1337</span>, <span class="number">0x1337</span> + <span class="number">0x1337</span>):</span><br><span class="line">        tmp = <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(delta)</span><br><span class="line">        pp = p0 - delta</span><br><span class="line">        <span class="comment"># tmp = factorial(pp) % p</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p0-delta+<span class="number">1</span>, p0):</span><br><span class="line">            tmp = tmp * i % p0</span><br><span class="line">        tmp = ((-<span class="number">1</span>)*<span class="built_in">int</span>(gmpy2.invert(tmp, p0))) % p0</span><br><span class="line">        ppp = prevprime(tmp)</span><br><span class="line">        <span class="keyword">if</span> gcd(ppp - <span class="number">1</span>, e) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> N % ppp == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;p = &#x27;</span>, ppp)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">solver(q0)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">5605</span></span><br><span class="line"><span class="string">p =  98012277990559371582983072655226283623673957669823428474469843558976683611088649921733473848543984940795021747022803821693331071948319773554362412970452779722021196926620622353412479180070638846582718441833102198044546885761608566645177571964681930259939794787139725829793461617386332420481477517399921209143</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N = <span class="number">11884142558095727641000594156833818117849240126500615037738361957005811068956622520280143210434649198031005585252791693777710458190732464123269660559382653636999601459113099276826723072914352276709761755328542359490331355061792823458149611674845846523699218971126655186522340818792078719216860046464292413878045842425132308544311887062610272360069819975798905665533964761527225558339025724872067751916657135473510775709503714808686565298632040214249698116863336246844759838665285888816202570667521796553678688293761589082062045634768520102235077364345013564344229095323239077977717497503322831684471959195555281580807</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">11776079752956619284016871274992903352398310565005810097721997339193718454945819135683541554652454321040530044545154341786048659896370226535387839157317585368391189570502841702311449000698372030666509296004039398083488490698999338894328619127149024309470011330855840757405205104944658961386764569043610715311746676861275270073394069269043429092551681704290340091149637137627751767730812255069347108706434972786681985484368054390699974613090342753508097177008167140924577095976699437810398922852319420301082587264411993737330188227703869101718515748828944300463051133118636928879090217708121368293440440444106196607645</span></span><br><span class="line">q = <span class="number">98012277990559371582983072655226283623673957669823428474469843558976683611088649921733473848543984940795021747022803821693331071948319773554362412970452779722021196926620622353412479180070638846582718441833102198044546885761608566645177571964681930259939794787139725829793461617386332420481477517399921209143</span></span><br><span class="line">p = N  // q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, N))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># vsctf&#123;Strongest_can_be_the_weakest:(&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>vsctf{Strongest_can_be_the_weakest:(}</p>
</blockquote>
<h2 id="Secure-Grading-System"><a href="#Secure-Grading-System" class="headerlink" title="Secure Grading System"></a><strong>Secure Grading System</strong></h2><blockquote>
<p>VS University needs a reliable grading system for students’ final reports. I was hired and designed the following scheme - upon testing, I can confirm it is cryptographically secure.</p>
<p>Can you show me it is unbreakable? I don’t want someone else to forge student’s signature and replace the original report…</p>
<p>VS大学需要一个可靠的学生期末报告评分系统。我被雇用并设计了以下方案-经过测试，我可以确认它是加密安全的。<br>你能告诉我它是牢不可破的吗？我不希望其他人伪造学生签名并替换原始报告。。。</p>
</blockquote>
<h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> ecdsa</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes, getPrime, size</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG, get_report_content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Grading system documentation (for internal use ONLY)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. The school&#x27;s grader team consists of 3 tutors and a professor.</span></span><br><span class="line"><span class="string">2. To submit the final report, student first needs to pass Proof of Work to show they are not robots.</span></span><br><span class="line"><span class="string">3. The student will sign their report (in text format) with their name and send it to the professor.</span></span><br><span class="line"><span class="string">Professor will verify the signature and make sure the student is THE real student.</span></span><br><span class="line"><span class="string">4. The student will then send 3 copies of their report to each of the tutors for marking.</span></span><br><span class="line"><span class="string">Finally student will receive their scoring.</span></span><br><span class="line"><span class="string">5. REDACTED</span></span><br><span class="line"><span class="string">6. Combining these public-key cryptosystems mentioned above, no way the system will have any vulnerability...</span></span><br><span class="line"><span class="string">Secure data transmission for the win! NO CHEATING IS ALLOWED IN OUR SCHOOL!!!</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Utils</span></span><br><span class="line">BANNER = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> __   __  _______    __   __  __    _  ___   __   __  _______  ______    _______  ___   _______  __   __ </span></span><br><span class="line"><span class="string">|  | |  ||       |  |  | |  ||  |  | ||   | |  | |  ||       ||    _ |  |       ||   | |       ||  | |  |</span></span><br><span class="line"><span class="string">|  |_|  ||  _____|  |  | |  ||   |_| ||   | |  |_|  ||    ___||   | ||  |  _____||   | |_     _||  |_|  |</span></span><br><span class="line"><span class="string">|       || |_____   |  |_|  ||       ||   | |       ||   |___ |   |_||_ | |_____ |   |   |   |  |       |</span></span><br><span class="line"><span class="string">|       ||_____  |  |       ||  _    ||   | |       ||    ___||    __  ||_____  ||   |   |   |  |_     _|</span></span><br><span class="line"><span class="string"> |     |  _____| |  |       || | |   ||   |  |     | |   |___ |   |  | | _____| ||   |   |   |    |   |  </span></span><br><span class="line"><span class="string">  |___|  |_______|  |_______||_|  |__||___|   |___|  |_______||___|  |_||_______||___|   |___|    |___|  </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">STUDENT_NAME = <span class="string">&quot;jayden_vs&quot;</span></span><br><span class="line"></span><br><span class="line">ALLOWED_CHARS = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randbytes</span>(<span class="params">n</span>):</span> <span class="keyword">return</span> <span class="built_in">bytes</span>([random.randint(<span class="number">0</span>,<span class="number">255</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randomize_report</span>(<span class="params">report</span>):</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        rand_bytes = randbytes(<span class="number">8</span>)</span><br><span class="line">        rand_loc = random.randrange(<span class="number">0</span>, <span class="built_in">len</span>(report) * <span class="number">3</span> // <span class="number">4</span>)</span><br><span class="line">        report = report[:rand_loc] + rand_bytes + report[rand_loc:]</span><br><span class="line">    <span class="keyword">return</span> report</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Classes</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProofOfWorkSolver</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, prefix_length=<span class="number">8</span></span>):</span></span><br><span class="line">        self.prefix_length = prefix_length</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generate</span>(<span class="params">self</span>):</span></span><br><span class="line">        prefix = <span class="string">&#x27;&#x27;</span>.join(random.choices(ALLOWED_CHARS, k=self.prefix_length))</span><br><span class="line">        self.nonce = <span class="string">&#x27;&#x27;</span>.join(random.choices(ALLOWED_CHARS, k=<span class="number">16</span>))</span><br><span class="line">        <span class="keyword">return</span> self.nonce, hashlib.sha256((prefix + self.nonce).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify</span>(<span class="params">self, prefix, answer</span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        h = hashlib.sha256((prefix + self.nonce).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">        <span class="keyword">return</span> h == answer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Signature</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, r, s</span>):</span></span><br><span class="line">        self.r = r</span><br><span class="line">        self.s = s</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_sig</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Signature: (<span class="subst">&#123;self.r&#125;</span>, <span class="subst">&#123;self.s&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ecdsa</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, curve=ecdsa.curves.SECP256k1</span>):</span></span><br><span class="line">        self.curve = curve</span><br><span class="line">        self.G = curve.generator</span><br><span class="line">        self.n = self.G.order()</span><br><span class="line">        self.d = random.randrange(<span class="number">1</span>, self.n)</span><br><span class="line">        self.Q = self.d * self.G</span><br><span class="line">        self.recovery = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sign</span>(<span class="params">self, message: <span class="built_in">bytes</span>, hashfunc=hashlib.sha256, resign=<span class="literal">False</span></span>) -&gt; Signature:</span></span><br><span class="line">        H = <span class="built_in">int</span>(hashfunc(message).hexdigest(), <span class="number">16</span>)</span><br><span class="line">        r, s = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> r == <span class="number">0</span> <span class="keyword">or</span> s == <span class="number">0</span>:</span><br><span class="line">            k = random.randrange(<span class="number">1</span>, self.n) <span class="keyword">if</span> <span class="keyword">not</span> resign <span class="keyword">else</span> self.recovery</span><br><span class="line">            self.recovery = k</span><br><span class="line">            R = k * self.G</span><br><span class="line">            r = R.x() % self.n</span><br><span class="line">            s = ((H + r * self.d) * <span class="built_in">pow</span>(k, -<span class="number">1</span>, self.n)) % self.n</span><br><span class="line">        <span class="keyword">return</span> Signature(r=r, s=s)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify</span>(<span class="params">self, message: <span class="built_in">bytes</span>, signature: Signature, hashfunc=hashlib.sha256</span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        H = <span class="built_in">int</span>(hashfunc(message).hexdigest(), <span class="number">16</span>)</span><br><span class="line">        r, s = signature.r, signature.s</span><br><span class="line">        sinv = <span class="built_in">pow</span>(s, -<span class="number">1</span>, self.n)</span><br><span class="line">        u1, u2 = (H * sinv) % self.n, (r * sinv) % self.n</span><br><span class="line">        R = u1 * self.G + u2 * self.Q</span><br><span class="line">        <span class="keyword">return</span> R.x() % self.n == r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rsa</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, bit_len=<span class="number">2048</span></span>):</span></span><br><span class="line">        self.p = getPrime(bit_len // <span class="number">2</span>)</span><br><span class="line">        self.q = getPrime(bit_len // <span class="number">2</span>)</span><br><span class="line">        self.N = self.p * self.q</span><br><span class="line">        self.e = <span class="number">3</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;N = <span class="subst">&#123;self.N&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, message: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> b64encode(long_to_bytes(<span class="built_in">pow</span>(bytes_to_long(message), self.e, self.N)))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        d = <span class="built_in">pow</span>(self.e, -<span class="number">1</span>, (self.p-<span class="number">1</span>) * (self.q-<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> b64encode(long_to_bytes(<span class="built_in">pow</span>(bytes_to_long(ciphertext), d, self.N)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(BANNER)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] System startup...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[!] Welcome to the super secure grading system, <span class="subst">&#123;STUDENT_NAME&#125;</span>.\n&quot;</span>)</span><br><span class="line">    powchal = ProofOfWorkSolver(prefix_length = <span class="number">4</span>)</span><br><span class="line">    nonce, answer = powchal.generate()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;&#x27;&#x27;Please solve the following challenge to show you are not a robot...\n</span></span><br><span class="line"><span class="string">        sha256(???? + <span class="subst">&#123;nonce&#125;</span>) == <span class="subst">&#123;answer&#125;</span>\n&#x27;&#x27;&#x27;</span>)</span><br><span class="line">    prefix = <span class="built_in">input</span>(<span class="string">&quot;Your answer: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> powchal.verify(prefix, answer):</span><br><span class="line">        sys.exit(<span class="string">&#x27;Goodbye, robot!&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[+] Verification successful.\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    report = get_report_content()</span><br><span class="line">    <span class="keyword">assert</span> report <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line">    report = randomize_report(report)</span><br><span class="line">    report_signed = STUDENT_NAME.encode(<span class="string">&#x27;utf-8&#x27;</span>) + report</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Verifying with Professor...&quot;</span>)</span><br><span class="line">    my_ecdsa = Ecdsa(ecdsa.curves.NIST384p)</span><br><span class="line">    sig1 = my_ecdsa.sign(report_signed[:<span class="built_in">len</span>(report_signed) // <span class="number">2</span>])</span><br><span class="line">    sig1.print_sig()</span><br><span class="line">    <span class="keyword">assert</span> my_ecdsa.verify(report_signed[:<span class="built_in">len</span>(report_signed) // <span class="number">2</span>], sig1)</span><br><span class="line">    sig2 = my_ecdsa.sign(report_signed[<span class="built_in">len</span>(report_signed) // <span class="number">2</span>:], hashlib.sha256, <span class="literal">True</span>)</span><br><span class="line">    sig2.print_sig()</span><br><span class="line">    <span class="keyword">assert</span> my_ecdsa.verify(report_signed[<span class="built_in">len</span>(report_signed) // <span class="number">2</span>:], sig2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[+] Verification successful.\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Distributing reports to tutors...&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-] Tutor <span class="subst">&#123;i&#125;</span>:&quot;</span>)</span><br><span class="line">        curr = Rsa(size(bytes_to_long(report)) + <span class="number">64</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Ciphertext = <span class="subst">&#123;curr.encrypt(report).decode(<span class="string">&#x27;utf-8&#x27;</span>)&#125;</span>\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Distribution successful.\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] I don&#x27;t think you can forge it but hey, if you can really do so I will reward you the flag.&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        T = time()</span><br><span class="line">        final_key = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;My secret key when communicating with professor: &quot;</span>).strip())</span><br><span class="line">        <span class="keyword">if</span> final_key == my_ecdsa.d:</span><br><span class="line">            elapsed = <span class="number">1000.0</span> * (time() - T)</span><br><span class="line">            <span class="keyword">if</span> elapsed &gt;= <span class="number">10000</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[x] If you spend too much time the professor will know you are cheating!&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[-] My system is broken :(&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[-] Here is the flag: <span class="subst">&#123;FLAG&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[x] Seems I&#x27;m right, it is super secure!&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        sys.exit(<span class="string">f&quot;[x] Bad hacking attempt!&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><p>正愁没机会、没时间学ECDSA，直接出题了</p>
<p>太好了，已经了解学习了ECC、DSA、快速学过ECDSA后，得到解题思路</p>
<ol start="0">
<li><p>工作量证明</p>
</li>
<li><p>低加密指数广播攻击（e=3）</p>
<p>求出report内容</p>
</li>
<li><p>求出hash(report)</p>
</li>
<li><p>k复用攻击求出私钥d</p>
<p>$k = (s_1 – s_2)^{-1}(H(m_1) – H(m_2)) \mod n$</p>
<p>退化为k已知</p>
<p>$x \equiv r^{-1}(ks-H(m)) \bmod n$      </p>
</li>
</ol>
<p>而ECC只充当提供n（n为其曲线的阶）的角色，复用攻击的思路，都是按照DSA走的</p>
<p>思路清晰了，手动搓代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters, digits</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> ecdsa</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes, getPrime, size</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">ai, mi</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd, mi) == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b2n</span>(<span class="params">C</span>):</span>  <span class="comment"># base64 to num</span></span><br><span class="line">    C = libnum.s2n(base64.b64decode(C.encode()))</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">table = ascii_letters + digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solve</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.sh = remote(<span class="string">&#x27;104.197.118.147&#x27;</span>, <span class="number">10140</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        proof = self.sh.recvuntil(<span class="string">b&#x27;Your answer:&#x27;</span>).decode().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        tail = proof[<span class="number">14</span>].split(<span class="string">&#x27;+ &#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        _<span class="built_in">hash</span> = proof[<span class="number">14</span>].split(<span class="string">&#x27;+ &#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;== &#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(tail)</span><br><span class="line">        <span class="built_in">print</span>(_<span class="built_in">hash</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;开始爆破！&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> product(table, repeat=<span class="number">4</span>):</span><br><span class="line">            head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">            <span class="built_in">print</span>(head)</span><br><span class="line">            t = hashlib.sha256((head + tail).encode()).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> t == _<span class="built_in">hash</span>:</span><br><span class="line">                self.sh.sendline(head.encode())</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;爆破成功！结果是：&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(head)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.proof_of_work()</span><br><span class="line">        self.sh.recvline()</span><br><span class="line">        req = self.sh.recvuntil(<span class="string">b&#x27;My secret key when communicating with professor: &#x27;</span>).decode().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> req:</span><br><span class="line">            <span class="built_in">print</span>(num)</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Hash值获取</span></span><br><span class="line">        <span class="comment"># 低加密指数广播攻击</span></span><br><span class="line">        N1 = <span class="built_in">int</span>(req[<span class="number">10</span>].split(<span class="string">&#x27;= &#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">        N2 = <span class="built_in">int</span>(req[<span class="number">14</span>].split(<span class="string">&#x27;= &#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">        N3 = <span class="built_in">int</span>(req[<span class="number">18</span>].split(<span class="string">&#x27;= &#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">        n = [N1, N2, N3]</span><br><span class="line">        e = <span class="number">3</span></span><br><span class="line">        C1 = b2n(req[<span class="number">11</span>].split(<span class="string">&#x27;= &#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">        C2 = b2n(req[<span class="number">15</span>].split(<span class="string">&#x27;= &#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">        C3 = b2n(req[<span class="number">19</span>].split(<span class="string">&#x27;= &#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">        c = [C1, C2, C3]</span><br><span class="line">        report = gmpy2.iroot(CRT(c, n), e)[<span class="number">0</span>]</span><br><span class="line">        report = libnum.n2s(<span class="built_in">int</span>(report))</span><br><span class="line">        STUDENT_NAME = <span class="string">&quot;jayden_vs&quot;</span></span><br><span class="line">        report_signed = STUDENT_NAME.encode(<span class="string">&#x27;utf-8&#x27;</span>) + report</span><br><span class="line">        report_signed1 = report_signed[:<span class="built_in">len</span>(report_signed) // <span class="number">2</span>]</span><br><span class="line">        report_signed2 = report_signed[<span class="built_in">len</span>(report_signed) // <span class="number">2</span>:]</span><br><span class="line">        H1 = <span class="built_in">int</span>(hashlib.sha256(report_signed1).hexdigest(), <span class="number">16</span>)</span><br><span class="line">        H2 = <span class="built_in">int</span>(hashlib.sha256(report_signed2).hexdigest(), <span class="number">16</span>)</span><br><span class="line">        <span class="built_in">print</span>(H1)</span><br><span class="line">        <span class="built_in">print</span>(H2)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ECDSA复用K攻击</span></span><br><span class="line">        r = <span class="built_in">int</span>(req[<span class="number">3</span>].split(<span class="string">&#x27;(&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">        s1 = <span class="built_in">int</span>(req[<span class="number">3</span>].split(<span class="string">&#x27;, &#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">        s2 = <span class="built_in">int</span>(req[<span class="number">4</span>].split(<span class="string">&#x27;, &#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">        n = ecdsa.curves.NIST384p.order</span><br><span class="line">        <span class="built_in">print</span>(n)</span><br><span class="line">        <span class="built_in">print</span>(s1)</span><br><span class="line">        <span class="built_in">print</span>(s2)</span><br><span class="line">        <span class="comment"># k = (s1 – s2)-1(H(m1) – H(m2))</span></span><br><span class="line">        k = (<span class="built_in">int</span>(gmpy2.invert(s1 - s2, n)) * (H1 - H2)) % n</span><br><span class="line">        x = (<span class="built_in">int</span>(gmpy2.invert(r, n)) * (k * s1 - H1)) % n</span><br><span class="line">        <span class="built_in">print</span>(x)</span><br><span class="line">        self.sh.sendline(<span class="built_in">str</span>(x).encode())</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="built_in">print</span>(self.sh.recvline())</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solution = Solve()</span><br><span class="line">    solution.solve()</span><br><span class="line"></span><br><span class="line"><span class="comment"># vsctf&#123;Buff1ng_PuBL1c_k3y_CrYpT0(Gr4phy)_15_St1LL_1n53cur3&#125;</span></span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">爆破成功！结果是：Be9y</span><br><span class="line"><span class="number">0</span></span><br><span class="line">[+] Verification successful.</span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br><span class="line">[+] Verifying <span class="keyword">with</span> Professor...</span><br><span class="line"><span class="number">3</span></span><br><span class="line">Signature: (<span class="number">10696032246155902563906104050649185893034277025133502155831967499061281463350471622952888012482674899772876856249380</span>, <span class="number">12381713509921542694568592010168868710656175662401371028444002411153420786450646116959981811480307577672216088654178</span>)</span><br><span class="line"><span class="number">4</span></span><br><span class="line">Signature: (<span class="number">10696032246155902563906104050649185893034277025133502155831967499061281463350471622952888012482674899772876856249380</span>, <span class="number">987938099217243971438270141212222363890122728596942603748989842628053024896398083026632795531860669653308404368959</span>)</span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">6</span></span><br><span class="line">[+] Verification successful.</span><br><span class="line"><span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="number">8</span></span><br><span class="line">[+] Distributing reports to tutors...</span><br><span class="line"><span class="number">9</span></span><br><span class="line">[-] Tutor <span class="number">1</span>:</span><br><span class="line"><span class="number">10</span></span><br><span class="line">N = <span class="number">1161023161760782750238633802491278705127676949088254776303326913198835924919101953861297804114633852545060414432991162221057059416832262930964253323570549614192070154743668532506506363664846543956140804867291208028012903542340185367846667027084264072698986350012228267527871082348300243777093482240538167572930028849167655206426742559024946833715833265030284912702509132555100404208817779730022437184961314843912605690778360373391274502341537505166114801499966873635337042534792108703767510754407206833026463980856586075131491278426297486625539003350263228456190944206656513235692161930206314063</span></span><br><span class="line"><span class="number">11</span></span><br><span class="line">Ciphertext = BA+Svm1gwueS+RFpKwolfeCgMe+b3g1P/QUVgXtjiPsTVznSLYQi5wq8z2rG9XyAJ9sVyS1fTFSv+Vsy7iz4pHf8ywWFbkYgqHDKwIjk574do7FNcqvfpxCsooE1nDTIv7PinqphkBnprE+SIVxIIldD6W+MOajXeG/lsyYzp8/K8zQ4ZKOAqfz76DPC7KnM6L/Hu6uhjw5dD7uA921OkAdNOlM0IfYUQtrH0sd1a9K5uPlaqAgufS0plnNIZKVyDX+SnjsmTRCoHN2MFancvgFvLXucqA/5T1IYH+R3d950O3t5DX1yAVUDfoGtq8s0UwydTSRdFQ==</span><br><span class="line"><span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="number">13</span></span><br><span class="line">[-] Tutor <span class="number">2</span>:</span><br><span class="line"><span class="number">14</span></span><br><span class="line">N = <span class="number">925825595975214336494822632492486894101324773866591591791988957684459268487856969525654838131658313810154574351384220293291923878383168495606141033186171486470179956526485189683436468449340364814668731008363382208464867477562062111261405263560421408790966555167560252056787155464340039735936459192868887013179203117547943638079298035399237891691842222691541048776780279797718804344806844138747252044939415264770375614530615075130495526364782666731252113054409760391070541748186925635514209076834479044608647260976748554616371274849370048654606874103248024227455107983317279266311457785663706107</span></span><br><span class="line"><span class="number">15</span></span><br><span class="line">Ciphertext = ArSJF0A1LKGCNTx/EqzXgt4DYqkWKfvMH1JtE03+WOaWlxW2MZB/WrlFrbUooOn/5ijdi3MMDZ0EjOG8R5XkBqfftjTlc14ZNLbyD2Ng1dG1D0aNTHsAwdllKWabQng50V9Lo6vFKWr6t44/9c9dXGU96GFY93SnYGS0q6OvV/hiankMa+cMTlBHf9t07QpJbUvdtndxBi6DWBs+agQPvFk0RhCRxtnPEy74GAkF07XSEo3mS5deE0iBrfr3rDLM6pX1nLZztmk6iWfVKVR9g2znMpTIiKoV7Ztln3neFw3KPwROXaAcVZjGF/CnAzm6YiPAe9A9YA==</span><br><span class="line"><span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="number">17</span></span><br><span class="line">[-] Tutor <span class="number">3</span>:</span><br><span class="line"><span class="number">18</span></span><br><span class="line">N = <span class="number">712076201638752485676207135872954992163746414173068068325713838781731364876176032575979656566675584643314490369383004171135946378330660567679885580883013813041905939993520331609049544777291351937706002330793415374845990902187949070395089618081345997340101742651356766673725206377993462245418682977412001782755507471573520266875405165927821097749677576271172709884438467682669258978663130258330369559842561958027822025379170818104014259088684623816269401124150398180089633354284660251034753920892189847618769784018815136553892056375551870441287319596350092073421806219649271887900483178682837609</span></span><br><span class="line"><span class="number">19</span></span><br><span class="line">Ciphertext = Gga5HhG+elgiXgd6PSlhhnlm6lNAyKR4eowiqtwHT+OQxSGqmS0YcAf36zL6zNv8/ohYAEO/q6woA9Iw3AWI6n2c/Kf91rMwlZxXhlUJhblCfECFzNNFSqxN3ehTP4cn7ACoOdBNo6+4xgdXuAzFAs9kq5H8l+fwJrmhYqWxOWatMcIEVxlW/1a+gaqY+y2SttBLDjXIPFzW5TBUL7Bf3wIhddXL0eGFdUVlJlgLtd5htixz4VPjCwx7K7OSPAPiOAjLD0XuWta64tkYnEyD05QmW0ni3M45fg7jToZk8cO64MVqk9ETu3/5nzdC6uTxWjUf579D6A==</span><br><span class="line"><span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="number">21</span></span><br><span class="line">[+] Distribution successful.</span><br><span class="line"><span class="number">22</span></span><br><span class="line"></span><br><span class="line"><span class="number">23</span></span><br><span class="line">[+] I don<span class="string">&#x27;t think you can forge it but hey, if you can really do so I will reward you the flag.</span></span><br><span class="line"><span class="string">24</span></span><br><span class="line"><span class="string">My secret key when communicating with professor: </span></span><br><span class="line"><span class="string">28243811715606938893897118476809438671171843924595459990859283511336533655525</span></span><br><span class="line"><span class="string">73918594979327201350835686676964264887894323016620896200443156894844644785866</span></span><br><span class="line"><span class="string">39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643</span></span><br><span class="line"><span class="string">12381713509921542694568592010168868710656175662401371028444002411153420786450646116959981811480307577672216088654178</span></span><br><span class="line"><span class="string">987938099217243971438270141212222363890122728596942603748989842628053024896398083026632795531860669653308404368959</span></span><br><span class="line"><span class="string">4044544091455517954515545458458969645881171780236367926856132553049793710774272368874782753017390744199791758018424</span></span><br><span class="line"><span class="string">b&#x27;</span>[-] My system <span class="keyword">is</span> broken :(\n<span class="string">&#x27;</span></span><br><span class="line"><span class="string">b&#x27;</span>[-] Here <span class="keyword">is</span> the flag: vsctf&#123;Buff1ng_PuBL1c_k3y_CrYpT0(Gr4phy)_15_St1LL_1n53cur3&#125;\n<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>vsctf{Buff1ng_PuBL1c_k3y_CrYpT0(Gr4phy)_15_St1LL_1n53cur3}</p>
</blockquote>
<h2 id="Art-Final"><a href="#Art-Final" class="headerlink" title="Art Final"></a>Art Final</h2><blockquote>
<p>School is wrapping up, and I wanted to add some pizzazz to my Art Final, I hope you like it!</p>
<p>学校就要结束了，我想给我的艺术期末考试增添一些趣味，希望你们喜欢</p>
</blockquote>
<h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Teacher, please give me an A</span></span><br><span class="line">import <span class="built_in">random</span></span><br><span class="line"><span class="built_in">from</span> PIL import Image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">boring = Image.<span class="built_in">open</span>(<span class="string">&#x27;Art_Final_2022.png&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).<span class="built_in">convert</span>(<span class="string">&#x27;RGBA&#x27;</span>)</span><br><span class="line">boring_pix = boring.<span class="built_in">load</span>()</span><br><span class="line"></span><br><span class="line">spicy = Image.<span class="built_in">new</span>(<span class="string">&#x27;RGBA&#x27;</span>, boring.size)</span><br><span class="line">spicy_pix = spicy.<span class="built_in">load</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add SPICE</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(boring.size[<span class="number">0</span>] * boring.size[<span class="number">1</span>]):</span><br><span class="line">    x = i % boring.size[<span class="number">0</span>]</span><br><span class="line">    y = i<span class="comment"> // boring.size[0]</span></span><br><span class="line">    rgba = tuple(<span class="built_in">random</span>.randbytes(<span class="number">4</span>))</span><br><span class="line">    spicy_pix[x, y] = tuple([bore ^ spice <span class="keyword">for</span> bore, spice <span class="keyword">in</span> zip(boring_pix[x, y], rgba)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># This final is HOT</span></span><br><span class="line">spicy.save(<span class="string">&#x27;ENHANCED_Final_2022.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># oh shoot, i forgot there needs to be a flag ._.</span></span><br><span class="line"><span class="built_in">from</span> Crypto import Random</span><br><span class="line"><span class="built_in">from</span> Crypto.Cipher import AES</span><br><span class="line"><span class="built_in">from</span> Crypto.Util.Padding import pad</span><br><span class="line"><span class="built_in">from</span> base64 import b64encode</span><br><span class="line"></span><br><span class="line">key = <span class="keyword">bytes</span>(<span class="built_in">random</span>.sample(<span class="built_in">random</span>.randbytes(<span class="number">16</span>), <span class="number">16</span>))</span><br><span class="line">iv = Random.<span class="built_in">new</span>().<span class="built_in">read</span>(AES.block_size)</span><br><span class="line">enc = AES.<span class="built_in">new</span>(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = b64encode(iv + enc.<span class="built_in">encrypt</span>(pad(b<span class="string">&#x27;[REDACTED]&#x27;</span>, AES.block_size))).decode()</span><br><span class="line"></span><br><span class="line">print(flag)  <span class="comment"># Tl5nK8L2KYZRCJCqLF7TbgKLgy1vIkH+KIAJv5/ILFoC+llemcmoLmCQYkiOrJ/orOOV+lwX+cVh+pwE5mtx6w==</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Art_Final_2022</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/Art_Final_2022.png" alt="Art_Final_2022"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/ENHANCED_Final_2022.png">ENHANCED_Final_2022</a></li>
</ul>
<h3 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h3><p>一直对复杂的、陌生的随机数求解没什么积累，这题研究了半天，收获不少</p>
<p>前半部分显而易见，读取两幅图，然后数据异或即可得到<strong>rgba</strong></p>
<p>虽然不懂原理，但试试看就知道，一个元组里有四个数</p>
<p>卡了很久，搜了很多关于<code>random.randbytes</code>的文章，因为已做的题都是预测<code>random.randbits</code>的</p>
<p>没办法，最后死马当活马医，手动测试找规律，没想到真找到了🤔</p>
<p><strong>从<code>randbytes(4)</code>转换成<code>getrandbits(32)</code></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TEST</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">seed = <span class="number">99</span></span><br><span class="line">random.seed(seed)</span><br><span class="line">list1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> random.randbytes(<span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(<span class="built_in">bin</span>(i))[<span class="number">2</span>:], end =<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    list1.append(i)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line">random.seed(seed)</span><br><span class="line">tmp = random.getrandbits(<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bin</span>(tmp))</span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1101001 11011 1101011 1100111 </span></span><br><span class="line"><span class="string">1100111 01101011 00011011 01101001</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>先把<code>random.randbytes(4)</code>获得的四个ASCII数字换成<strong>二进制</strong>并<strong>补齐8位</strong></li>
<li>按右边第一个、右边第二个、左边第二个、左边第一个的顺序拼接</li>
</ol>
<p>研究这个的目的，是实现将<code>randbytes(4)</code>获得的<strong>rgba</strong>数据，转换成<code>getrandbits(32)</code>的形式传给预测器</p>
<p><strong>同理<code>getrandbits(128)</code>到<code>randbytes(16)</code></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TEST</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">seed = <span class="number">99</span></span><br><span class="line">random.seed(seed)</span><br><span class="line">list1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> random.randbytes(<span class="number">16</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(<span class="built_in">bin</span>(i))[<span class="number">2</span>:], end =<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    list1.append(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line">random.seed(seed)</span><br><span class="line">tmp = random.getrandbits(<span class="number">128</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bin</span>(tmp))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1101001 11011 1101011 1100111 110100 1 1111001 1100001 11111110 100100 111000 110011 1011011 11010111 1110100 10011001 </span></span><br><span class="line"><span class="string">0b10011001011101001101011101011011001100110011100000100100111111100110000101111001000000010011010001100111011010110001101101101001</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>我的思路是，从<code>getrandbits(128)</code>（不足128，前补0，方便分组），8个为一组，调换顺序，即可得到<code>randbytes(16)</code>结果</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># TEST</span><br><span class="line">key = &#x27;<span class="number">10011001011101001101011101011011001100110011100000100100111111100110000101111001000000010011010001100111011010110001101101101001</span>&#x27;</span><br><span class="line">L = len(key)</span><br><span class="line">tmp_list = []</span><br><span class="line">if L == <span class="number">127</span>:</span><br><span class="line">    key = &#x27;<span class="number">0</span>&#x27;+key</span><br><span class="line">    L = len(key)</span><br><span class="line">for i in range(L // <span class="number">8</span>):</span><br><span class="line">    tmp_list.append(key[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>])</span><br><span class="line">tmp_list = tmp_list[::-<span class="number">1</span>]</span><br><span class="line">for i in tmp_list:</span><br><span class="line">    print(i, end=&#x27; &#x27;)</span><br><span class="line"># <span class="number">01101001</span> <span class="number">00011011</span> <span class="number">01101011</span> <span class="number">01100111</span> <span class="number">00110100</span> <span class="number">00000001</span> <span class="number">01111001</span> <span class="number">01100001</span> <span class="number">11111110</span> <span class="number">00100100</span> <span class="number">00111000</span> <span class="number">00110011</span> <span class="number">01011011</span> <span class="number">11010111</span> <span class="number">01110100</span> <span class="number">10011001</span></span><br></pre></td></tr></table></figure>

<p>研究这的目的是，预测器获取状态后，利用其<code>getrandbits(128)</code>，来获取<code>randbytes(16)</code>的内容</p>
<p>接下来，按理说只需要想办法整整顺序、ascii换成bytes</p>
<p>还没顾得上顺序的问题，发现ascii((16个)—&gt;str(16bytes)—&gt;bytes(大于16bytes)的问题</p>
<p>（事后反思，觉得是<code>encode()</code>问题）</p>
<p>绝望之际，在网上翻到了代码</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># data = [23, 123, 32, ....]</span></span><br><span class="line"><span class="class"><span class="keyword">data</span> = str(<span class="title">data</span>)</span></span><br><span class="line"><span class="title">key</span> = b&#x27;&#x27;.join([bytes([int(i)]) for i <span class="keyword">in</span> <span class="class"><span class="keyword">data</span>[1:-1].split(&#x27;,&#x27;)])</span></span><br></pre></td></tr></table></figure>

<p>发现长度就对了，应该就是要使用<code>bytes</code>转换而不是<code>.encode()</code>吧</p>
<p>至于提到的顺序问题，其起源于题目代码里这一句</p>
<p><code>key = bytes(random.sample(random.randbytes(16), 16))</code></p>
<p>它实现了十六个字符乱序后再转bytes</p>
<p>本来思路卡住了，突然灵光一转</p>
<p><strong>要不试试用预测器来<code>sample</code>一下（毕竟获得了当时的状态）</strong></p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">from PIL <span class="keyword">import</span> Image</span><br><span class="line">from mt19937predictor <span class="keyword">import</span> MT19937Predictor</span><br><span class="line"></span><br><span class="line">P = MT19937Predictor()  # 生成预测器</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def pad(data):</span><br><span class="line">    <span class="keyword">if</span> len(data) &lt; <span class="number">8</span>:</span><br><span class="line">        data = <span class="string">&#x27;0&#x27;</span> * (<span class="number">8</span> - len(data)) + data</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">boring = Image.<span class="built_in">open</span>(<span class="string">&#x27;/Users/wenhui/Downloads/转专业/Art Final/Art_Final_2022.png&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).convert(<span class="string">&#x27;RGBA&#x27;</span>)</span><br><span class="line">boring_pix = boring.load()</span><br><span class="line"></span><br><span class="line">spicy = Image.<span class="built_in">open</span>(<span class="string">&#x27;/Users/wenhui/Downloads/转专业/Art Final/ENHANCED_Final_2022.png&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">spicy_pix = spicy.load()</span><br><span class="line"></span><br><span class="line"># rgba</span><br><span class="line"><span class="keyword">for</span> i in range(boring.<span class="built_in">size</span>[<span class="number">0</span>] * boring.<span class="built_in">size</span>[<span class="number">1</span>]):</span><br><span class="line">    x = i % boring.<span class="built_in">size</span>[<span class="number">0</span>]</span><br><span class="line">    y = i <span class="comment">// boring.size[0]</span></span><br><span class="line">    tmp = [pad(<span class="built_in">str</span>(bin(bore ^ spice)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) <span class="keyword">for</span> bore, spice in zip(boring_pix[x, y], spicy_pix[x, y])]</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    tmp = <span class="string">&#x27;&#x27;</span>.<span class="built_in">join</span>(tmp[::<span class="number">-1</span>])</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    tmp = <span class="built_in">int</span>(tmp, <span class="number">2</span>)</span><br><span class="line">    P.setrandbits(tmp, <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">key</span> = <span class="built_in">str</span>(bin(P.getrandbits(<span class="number">128</span>)))[<span class="number">2</span>:]</span><br><span class="line">L = len(<span class="built_in">key</span>)</span><br><span class="line">tmp_list = []</span><br><span class="line"><span class="keyword">if</span> L == <span class="number">127</span>:</span><br><span class="line">    <span class="built_in">key</span> = <span class="string">&#x27;0&#x27;</span>+<span class="built_in">key</span></span><br><span class="line">    L = len(<span class="built_in">key</span>)</span><br><span class="line"><span class="keyword">for</span> i in range(L <span class="comment">// 8):</span></span><br><span class="line">    tmp_list.<span class="built_in">append</span>(<span class="built_in">key</span>[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>])</span><br><span class="line">tmp_list = tmp_list[::<span class="number">-1</span>]</span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> i in tmp_list:</span><br><span class="line">    data.<span class="built_in">append</span>(<span class="built_in">int</span>(i, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">str</span>(data)</span><br><span class="line"><span class="built_in">key</span> = b<span class="string">&#x27;&#x27;</span>.<span class="built_in">join</span>([bytes([<span class="built_in">int</span>(i)]) <span class="keyword">for</span> i in data[<span class="number">1</span>:<span class="number">-1</span>].<span class="built_in">split</span>(<span class="string">&#x27;,&#x27;</span>)])</span><br><span class="line"><span class="built_in">key</span> = P.sample(<span class="built_in">key</span>, <span class="number">16</span>)  # 梅森sample获得正确的<span class="built_in">key</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">key</span>)</span><br><span class="line"># [<span class="number">200</span>, <span class="number">37</span>, <span class="number">83</span>, <span class="number">237</span>, <span class="number">0</span>, <span class="number">227</span>, <span class="number">31</span>, <span class="number">86</span>, <span class="number">25</span>, <span class="number">174</span>, <span class="number">165</span>, <span class="number">60</span>, <span class="number">162</span>, <span class="number">16</span>, <span class="number">26</span>, <span class="number">217</span>]</span><br></pre></td></tr></table></figure>

<p>很激动，以为会报错来着，居然真的能这么用，于是拿去解密，出了</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> random</span><br><span class="line"><span class="attribute">from</span> Crypto.Cipher import AES</span><br><span class="line"><span class="attribute">from</span> base<span class="number">64</span> import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">flag</span> = b&#x27;Tl<span class="number">5</span>nK<span class="number">8</span>L<span class="number">2</span>KYZRCJCqLF<span class="number">7</span>TbgKLgy<span class="number">1</span>vIkH+KIAJv<span class="number">5</span>/ILFoC+llemcmoLmCQYkiOrJ/orOOV+lwX+cVh+pwE<span class="number">5</span>mtx<span class="number">6</span>w==&#x27;</span><br><span class="line"><span class="attribute">flag</span> = b<span class="number">64</span>decode(flag)</span><br><span class="line"><span class="attribute">iv</span> = flag[:<span class="number">16</span>]</span><br><span class="line"><span class="attribute">c</span> = flag[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line"><span class="attribute">data0</span> =<span class="meta"> [200, 37, 83, 237, 0, 227, 31, 86, 25, 174, 165, 60, 162, 16, 26, 217]</span></span><br><span class="line"><span class="attribute">print</span>(len(data<span class="number">0</span>))  # <span class="number">16</span>, 终于至少长度对了</span><br><span class="line"><span class="attribute">data</span> = str(data<span class="number">0</span>)</span><br><span class="line"><span class="attribute">key</span> = b&#x27;&#x27;.join([bytes([int(i)]) for i in data[<span class="number">1</span>:-<span class="number">1</span>].split(&#x27;,&#x27;)])  # 绝望之际，网上翻到的合理代码</span><br><span class="line"><span class="attribute">enc</span> = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="attribute">flag</span> = enc.decrypt(c)</span><br><span class="line"><span class="attribute">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;vsctf&#123;1_gu355_R4ND0m_i5nt_tH4T_5p1cy&#125;\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>vsctf{1_gu355_R4ND0m_i5nt_tH4T_5p1cy}</p>
</blockquote>
<h2 id="NIST-Finalist-Revisited（Unsolved）"><a href="#NIST-Finalist-Revisited（Unsolved）" class="headerlink" title="NIST Finalist: Revisited（Unsolved）"></a><strong>NIST Finalist: Revisited（Unsolved）</strong></h2><blockquote>
<p>After careful consideration during the 3rd round of the NIST PQC Standardization Process, NIST has identified 4 candidate algorithms for standardization, which are…</p>
<p>Well, wait. This has nothing to do with the challenge.</p>
<p>After revisiting the 10 <a target="_blank" rel="noopener" href="https://csrc.nist.gov/Projects/lightweight-cryptography/finalists">Finalists</a> of the NIST <em>lightweight</em> crypto standardization process, I think <a target="_blank" rel="noopener" href="https://ascon.iaik.tugraz.at/">ASCON</a> hashing algorithm is a bit too slow with 12 rounds of functions. Maybe changing to 2 rounds could make it WIN the competition?</p>
<p>在第三轮NIST PQC标准化过程中仔细考虑后，NIST确定了4种标准化候选算法，分别是。。。<br>嗯，等等。这与挑战无关。<br>在重访10名[入围者]之后(<a target="_blank" rel="noopener" href="https://csrc.nist.gov/Projects/lightweight-cryptography/finalists)%E5%85%B3%E4%BA%8ENIST%E7%9A%84%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86%E5%8C%96%E8%BF%87%E7%A8%8B%EF%BC%8C%E6%88%91%E8%AE%A4%E4%B8%BA[ASCON](https://ascon.iaik.tugraz.at/)%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95%E6%9C%8912%E8%BD%AE%E5%87%BD%E6%95%B0%EF%BC%8C%E9%80%9F%E5%BA%A6%E6%9C%89%E7%82%B9%E5%A4%AA%E6%85%A2%E3%80%82%E4%B9%9F%E8%AE%B8%E6%8D%A2%E6%88%90%E4%B8%A4%E8%BD%AE%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%B5%A2%E5%BE%97%E6%AF%94%E8%B5%9B%EF%BC%9F">https://csrc.nist.gov/Projects/lightweight-cryptography/finalists)关于NIST的轻量级加密标准化过程，我认为[ASCON](https://ascon.iaik.tugraz.at/)哈希算法有12轮函数，速度有点太慢。也许换成两轮就可以赢得比赛？</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Implementation of Ascon hash function http://ascon.iaik.tugraz.at/</span></span><br><span class="line"><span class="string">Round-Reduced Ascon-Hash adapted from https://github.com/meichlseder/pyascon/blob/master/ascon.py</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">&quot;vsctf&#123;REDACTED&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ascon_xof</span>(<span class="params">message</span>):</span> </span><br><span class="line">    a = <span class="number">2</span></span><br><span class="line">    b = <span class="number">2</span></span><br><span class="line">    rate = <span class="number">8</span> <span class="comment"># bytes</span></span><br><span class="line">    hashlength = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Initialization</span></span><br><span class="line">    tagspec = int_to_bytes(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">    S = bytes_to_state(to_bytes([<span class="number">0</span>, rate * <span class="number">8</span>, a, a-b]) + tagspec + zero_bytes(<span class="number">32</span>))</span><br><span class="line"></span><br><span class="line">    ascon_permutation(S, a)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Message Processing (Absorbing)</span></span><br><span class="line">    m_padding = to_bytes([<span class="number">0x80</span>]) + zero_bytes(rate - (<span class="built_in">len</span>(message) % rate) - <span class="number">1</span>)</span><br><span class="line">    m_padded = message + m_padding</span><br><span class="line"></span><br><span class="line">    <span class="comment"># first s-1 blocks</span></span><br><span class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(m_padded) - rate, rate):</span><br><span class="line">        S[<span class="number">0</span>] ^= bytes_to_int(m_padded[block:block+<span class="number">8</span>])  <span class="comment"># rate=8</span></span><br><span class="line">        ascon_permutation(S, b)</span><br><span class="line">    <span class="comment"># last block</span></span><br><span class="line">    block = <span class="built_in">len</span>(m_padded) - rate</span><br><span class="line">    S[<span class="number">0</span>] ^= bytes_to_int(m_padded[block:block+<span class="number">8</span>])  <span class="comment"># rate=8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Finalization (Squeezing)</span></span><br><span class="line">    H = <span class="string">b&quot;&quot;</span></span><br><span class="line">    ascon_permutation(S, a)</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(H) &lt; hashlength:</span><br><span class="line">        H += int_to_bytes(S[<span class="number">0</span>], <span class="number">8</span>)  <span class="comment"># rate=8</span></span><br><span class="line">        ascon_permutation(S, b)</span><br><span class="line">    <span class="keyword">return</span> H[:hashlength]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ascon_permutation</span>(<span class="params">S, rounds=<span class="number">1</span></span>):</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>-rounds, <span class="number">12</span>):</span><br><span class="line">        <span class="comment"># --- add round constants ---</span></span><br><span class="line">        S[<span class="number">2</span>] ^= (<span class="number">0xf0</span> - r*<span class="number">0x10</span> + r*<span class="number">0x1</span>)</span><br><span class="line">        <span class="comment"># --- substitution layer ---</span></span><br><span class="line">        S[<span class="number">0</span>] ^= S[<span class="number">4</span>]</span><br><span class="line">        S[<span class="number">4</span>] ^= S[<span class="number">3</span>]</span><br><span class="line">        S[<span class="number">2</span>] ^= S[<span class="number">1</span>]</span><br><span class="line">        T = [(S[i] ^ <span class="number">0xFFFFFFFFFFFFFFFF</span>) &amp; S[(i+<span class="number">1</span>)%<span class="number">5</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            S[i] ^= T[(i+<span class="number">1</span>)%<span class="number">5</span>]</span><br><span class="line">        S[<span class="number">1</span>] ^= S[<span class="number">0</span>]</span><br><span class="line">        S[<span class="number">0</span>] ^= S[<span class="number">4</span>]</span><br><span class="line">        S[<span class="number">3</span>] ^= S[<span class="number">2</span>]</span><br><span class="line">        S[<span class="number">2</span>] ^= <span class="number">0XFFFFFFFFFFFFFFFF</span></span><br><span class="line">        <span class="comment"># --- linear diffusion layer ---</span></span><br><span class="line">        S[<span class="number">0</span>] ^= rotr(S[<span class="number">0</span>], <span class="number">19</span>) ^ rotr(S[<span class="number">0</span>], <span class="number">28</span>)</span><br><span class="line">        S[<span class="number">1</span>] ^= rotr(S[<span class="number">1</span>], <span class="number">61</span>) ^ rotr(S[<span class="number">1</span>], <span class="number">39</span>)</span><br><span class="line">        S[<span class="number">2</span>] ^= rotr(S[<span class="number">2</span>],  <span class="number">1</span>) ^ rotr(S[<span class="number">2</span>],  <span class="number">6</span>)</span><br><span class="line">        S[<span class="number">3</span>] ^= rotr(S[<span class="number">3</span>], <span class="number">10</span>) ^ rotr(S[<span class="number">3</span>], <span class="number">17</span>)</span><br><span class="line">        S[<span class="number">4</span>] ^= rotr(S[<span class="number">4</span>],  <span class="number">7</span>) ^ rotr(S[<span class="number">4</span>], <span class="number">41</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zero_bytes</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> n * <span class="string">b&quot;\x00&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_bytes</span>(<span class="params">l</span>):</span> <span class="comment"># where l is a list or bytearray or bytes</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">bytearray</span>(l))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bytes_to_int</span>(<span class="params"><span class="built_in">bytes</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>([bi &lt;&lt; ((<span class="built_in">len</span>(<span class="built_in">bytes</span>) - <span class="number">1</span> - i)*<span class="number">8</span>) <span class="keyword">for</span> i, bi <span class="keyword">in</span> <span class="built_in">enumerate</span>(to_bytes(<span class="built_in">bytes</span>))])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bytes_to_state</span>(<span class="params"><span class="built_in">bytes</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> [bytes_to_int(<span class="built_in">bytes</span>[<span class="number">8</span>*w:<span class="number">8</span>*(w+<span class="number">1</span>)]) <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">int_to_bytes</span>(<span class="params">integer, nbytes</span>):</span></span><br><span class="line">    <span class="keyword">return</span> to_bytes([(integer &gt;&gt; ((nbytes - <span class="number">1</span> - i) * <span class="number">8</span>)) % <span class="number">256</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbytes)])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rotr</span>(<span class="params">val, r</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (val &gt;&gt; r) | ((val &amp; (<span class="number">1</span>&lt;&lt;r)-<span class="number">1</span>) &lt;&lt; (<span class="number">64</span>-r))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bytes_to_hex</span>(<span class="params">b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> b.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_info</span>(<span class="params">data</span>):</span></span><br><span class="line">    maxlen = <span class="built_in">max</span>([<span class="built_in">len</span>(text) <span class="keyword">for</span> (text, val) <span class="keyword">in</span> data])</span><br><span class="line">    <span class="keyword">for</span> text, val <span class="keyword">in</span> data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&#123;text&#125;:&#123;align&#125; 0x&#123;val&#125; (&#123;length&#125; bytes)&quot;</span>.<span class="built_in">format</span>(text=text, align=((maxlen - <span class="built_in">len</span>(text)) * <span class="string">&quot; &quot;</span>), val=bytes_to_hex(val), length=<span class="built_in">len</span>(val)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">collision</span>(<span class="params">m1: <span class="built_in">bytes</span>, m2: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">    <span class="keyword">return</span> ascon_xof(m1) == ascon_xof(m2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;12 rounds of Ascon is surely collision resistant. What about 2-round Ascon?&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;If you can find two collisions for me, I will give you the flag!\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        stage1 = <span class="built_in">input</span>(<span class="string">&quot;1. Please send two hex encoded messages m1, m2 formatted in JSON:\n&quot;</span>).strip()</span><br><span class="line">        stage1_inp = json.loads(stage1)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;m1&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> stage1_inp <span class="keyword">or</span> <span class="string">&quot;m2&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> stage1_inp:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Your input is missing one or more of the required fields. Please try again.&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        m1 = <span class="built_in">bytes</span>.fromhex(stage1_inp[<span class="string">&quot;m1&quot;</span>])</span><br><span class="line">        m2 = <span class="built_in">bytes</span>.fromhex(stage1_inp[<span class="string">&quot;m2&quot;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> m1 == m2:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Don&#x27;t try to cheese it :(&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;admin&quot;</span> <span class="keyword">in</span> m1 <span class="keyword">or</span> <span class="string">b&quot;admin&quot;</span> <span class="keyword">in</span> m2:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Too early to be an admin!&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> collision(m1, m2):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Attempt failed! Two distinct messages have distinct hashes!&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Nice, collision found!\n&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        stage2 = <span class="built_in">input</span>(<span class="string">&quot;2. Please send another two hex encoded messages m1, m2 formatted in JSON:\n&quot;</span>).strip()</span><br><span class="line">        stage2_inp = json.loads(stage2)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;m1&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> stage2_inp <span class="keyword">or</span> <span class="string">&quot;m2&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> stage2_inp:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Your input is missing one or more of the required fields. Please try again.&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        m1 = <span class="built_in">bytes</span>.fromhex(stage2_inp[<span class="string">&quot;m1&quot;</span>])</span><br><span class="line">        m2 = <span class="built_in">bytes</span>.fromhex(stage2_inp[<span class="string">&quot;m2&quot;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> m1 == m2:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Don&#x27;t try to cheese it :(&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;admin&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> m1 <span class="keyword">or</span> <span class="string">b&quot;admin&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> m2:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You need to be admin to get the flag!&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> collision(m1, m2):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Attempt failed! Two distinct messages have distinct hashes!&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Nice, collision found again! Here is your flag: <span class="subst">&#123;FLAG&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Exception raised: &quot;</span>, e)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>一言以蔽之，代码实现了一个经简化的hash算法，需要以16进制给出两数</p>
<p>若能实现数字不同，hash值却相同，（即collisions，碰撞），则能得到flag</p>
<hr>
<p>太累了，两天睡8小时</p>
<p>居然睡着了，醒来只剩一分钟了，之后复现吧</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Harry0597
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://harry0597.com/2022/07/12/vsCTF2022%C2%B7Crypto%20WP/" title="vsCTF2022·Crypto WP">https://harry0597.com/2022/07/12/vsCTF2022·Crypto WP/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Writeup/" rel="tag"><i class="fa fa-tag"></i> Writeup</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/07/12/GoogleCTF2022%C2%B7Crypto%20WP/" rel="prev" title="GoogleCTF2022·Crypto 复现">
      <i class="fa fa-chevron-left"></i> GoogleCTF2022·Crypto 复现
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#vsctf2022%C2%B7Crypto-WP"><span class="nav-number">1.</span> <span class="nav-text">vsctf2022·Crypto WP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%83%85%E5%86%B5"><span class="nav-number">1.1.</span> <span class="nav-text">解题情况</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#babyrsa"><span class="nav-number">1.2.</span> <span class="nav-text">babyrsa</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">1.2.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">1.2.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Recovery"><span class="nav-number">1.3.</span> <span class="nav-text">Recovery</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-1"><span class="nav-number">1.3.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Strongest-rsa"><span class="nav-number">1.4.</span> <span class="nav-text">Strongest rsa</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="nav-number">1.4.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-2"><span class="nav-number">1.4.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Secure-Grading-System"><span class="nav-number">1.5.</span> <span class="nav-text">Secure Grading System</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="nav-number">1.5.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-3"><span class="nav-number">1.5.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Art-Final"><span class="nav-number">1.6.</span> <span class="nav-text">Art Final</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-4"><span class="nav-number">1.6.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-4"><span class="nav-number">1.6.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NIST-Finalist-Revisited%EF%BC%88Unsolved%EF%BC%89"><span class="nav-number">1.7.</span> <span class="nav-text">NIST Finalist: Revisited（Unsolved）</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Harry0597"
      src="/images/IMG_2550.JPG">
  <p class="site-author-name" itemprop="name">Harry0597</p>
  <div class="site-description" itemprop="description">Pondering'll do you wonders.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:1915885792@qq.com" title="E-Mail → mailto:1915885792@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>


      
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CS/" rel="tag">CS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-OS/" rel="tag">Mac OS</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Writeup/" rel="tag">Writeup</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">杂</a><span class="tag-list-count">6</span></li></ul>
              </canvas>
          </div>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harry0597</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">791k</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'SdJfKJYPhm2sNuw1OsouUSUC-MdYXbMMI',
      appKey     : '4pmiJGkm87YwJe40oBXXWYKM',
      placeholder: "评论，让思维碰撞",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://SdJfKJYP.api.lncldglobal.com'
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
