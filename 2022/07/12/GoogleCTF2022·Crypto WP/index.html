<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/ico" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/hackerrank.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harry0597.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="å¤ç°">
<meta property="og:type" content="article">
<meta property="og:title" content="GoogleCTF2022Â·Crypto å¤ç°">
<meta property="og:url" content="https://harry0597.com/2022/07/12/GoogleCTF2022%C2%B7Crypto%20WP/index.html">
<meta property="og:site_name" content="Harry&#39;s Blog">
<meta property="og:description" content="å¤ç°">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220705065825288.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220705180147886.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_BB25E5BF9D40-1.jpeg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220706184618463.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_2A80F05B3E7B-1.jpeg">
<meta property="article:published_time" content="2022-07-12T09:53:09.000Z">
<meta property="article:modified_time" content="2022-07-12T10:16:07.875Z">
<meta property="article:author" content="Harry0597">
<meta property="article:tag" content="Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220705065825288.png">

<link rel="canonical" href="https://harry0597.com/2022/07/12/GoogleCTF2022%C2%B7Crypto%20WP/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>GoogleCTF2022Â·Crypto å¤ç° | Harry's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Harry's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">æ¸©æ•…çŸ¥æ–°</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Harry0597" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://harry0597.com/2022/07/12/GoogleCTF2022%C2%B7Crypto%20WP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/IMG_2550.JPG">
      <meta itemprop="name" content="Harry0597">
      <meta itemprop="description" content="Pondering'll do you wonders.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Harry's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          GoogleCTF2022Â·Crypto å¤ç°
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-07-12 17:53:09 / ä¿®æ”¹æ—¶é—´ï¼š18:16:07" itemprop="dateCreated datePublished" datetime="2022-07-12T17:53:09+08:00">2022-07-12</time>
            </span>

          
    <span>&emsp;</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span>
    <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
    <span id="busuanzi_value_page_pv"></span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/2022/07/12/GoogleCTF2022%C2%B7Crypto%20WP/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/07/12/GoogleCTF2022%C2%B7Crypto%20WP/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>23k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>21 åˆ†é’Ÿ</span>
            </span>
            <div class="post-description">å¤ç°</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="2022GoogleCTFÂ·å¯†ç å¤ç°"><a href="#2022GoogleCTFÂ·å¯†ç å¤ç°" class="headerlink" title="2022GoogleCTFÂ·å¯†ç å¤ç°"></a>2022GoogleCTFÂ·å¯†ç å¤ç°</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>å¤ç°å‚è€ƒ<a target="_blank" rel="noopener" href="https://github.com/google/google-ctf/tree/master/2022">å®˜æ–¹ä»“åº“</a></p>
</blockquote>
<p>å¾ˆé—æ†¾ï¼Œè™½ç„¶å¾ˆçƒ­è¡€ã€æ»¡æ€€æ¿€æƒ…åœ°ç†¬å¤œæ‰“æ¯”èµ›</p>
<p>ä½†è¢«è™çš„ä½“æ— å®Œè‚¤ï¼Œ48hé˜Ÿä¼0è§£</p>
<p>ã€Œä½•æ—¶æ‰èƒ½ç™»é™†æ¢¦ä¸­çš„å½¼å²¸ã€</p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220705065825288.png" alt="FLAG"></p>
<h2 id="ELECTRIC-MAYHEM-CLS"><a href="#ELECTRIC-MAYHEM-CLS" class="headerlink" title="ELECTRIC MAYHEM CLS"></a>ELECTRIC MAYHEM CLS</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><blockquote>
<p>The server presents power traces of a secret firmware crypto operation. The goal is to recover the secret key. Note, the flag is â€˜CTF{XXX}â€™ where XXX is your recovered key.</p>
</blockquote>
<ul>
<li><p>æ–‡ä»¶</p>
</li>
<li><p>é“¾æ¥</p>
<p><a target="_blank" rel="noopener" href="https://electric-mayhem-cls-web.2022.ctfcompetition.com/">https://electric-mayhem-cls-web.2022.ctfcompetition.com</a></p>
</li>
</ul>
<h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><blockquote>
<p>å­¦ä¹ å‚è€ƒ<a target="_blank" rel="noopener" href="https://zenn.dev/kurenaif/articles/ae83691511b966">å¯†ç é­”å¥³çš„wp</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220705180147886.png" alt="image-20220705180147886"></p>
</blockquote>
<p>çœŸæ˜¯ç³Ÿç³•ï¼ŒğŸ§™â€â™€ï¸æŠ„çš„åˆ«çš„å¸ˆå‚…çš„<a target="_blank" rel="noopener" href="https://trmr.hatenablog.com/entry/2018/03/18/220441">åˆ†æä»£ç </a>ï¼ˆä¹Ÿæ˜¯æ—¥æœ¬çš„å¸ˆå‚…ï¼‰</p>
<p>ğŸ§™â€â™€ï¸æ‡‚ä¸æ‡‚åŸç†æˆ‘ä¸çŸ¥ï¼Œä½†å¥¹ç¡®å®æ²¡è®²æ¸…æ¥š</p>
<p>æ¶‰åŠâ€œç”µåŠ›è§£æâ€ï¼Œåœ¨æˆ‘çœ‹æ¥æ˜¯å¾ˆåçš„çŸ¥è¯†ç‚¹ï¼Œä¸å…·å¤‡æ™®é€‚æ€§ï¼Œæš‚ä¸”æç½®</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ref: https://trmr.hatenablog.com/entry/2018/03/18/220441</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">import</span> json</span><br><span class="line"><span class="attribute">import</span> numpy as np</span><br><span class="line"><span class="attribute">import</span> matplotlib.pyplot as plt</span><br><span class="line"><span class="attribute">import</span> scipy.io as sio</span><br><span class="line"><span class="attribute">from</span> Crypto.Cipher import AES</span><br><span class="line"><span class="attribute">import</span> binascii</span><br><span class="line"><span class="attribute">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="attribute">humming</span> =<span class="meta"> [bin(n).count(&quot;1&quot;) for n in range(256)]</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">json_open</span> = open(&#x27;ELECTRIC MAYHEM CLS/stm<span class="number">32</span>f<span class="number">0</span>_aes.json&#x27;, &#x27;r&#x27;)</span><br><span class="line"><span class="attribute">json_load</span> = json.load(json_open)</span><br><span class="line"></span><br><span class="line"><span class="attribute">sbox</span> = (</span><br><span class="line">    <span class="attribute">0x63</span>, <span class="number">0</span>x<span class="number">7</span>c, <span class="number">0</span>x<span class="number">77</span>, <span class="number">0</span>x<span class="number">7</span>b, <span class="number">0</span>xf<span class="number">2</span>, <span class="number">0</span>x<span class="number">6</span>b, <span class="number">0</span>x<span class="number">6</span>f, <span class="number">0</span>xc<span class="number">5</span>, <span class="number">0</span>x<span class="number">30</span>, <span class="number">0</span>x<span class="number">01</span>, <span class="number">0</span>x<span class="number">67</span>, <span class="number">0</span>x<span class="number">2</span>b, <span class="number">0</span>xfe, <span class="number">0</span>xd<span class="number">7</span>, <span class="number">0</span>xab, <span class="number">0</span>x<span class="number">76</span>,</span><br><span class="line">    <span class="attribute">0xca</span>, <span class="number">0</span>x<span class="number">82</span>, <span class="number">0</span>xc<span class="number">9</span>, <span class="number">0</span>x<span class="number">7</span>d, <span class="number">0</span>xfa, <span class="number">0</span>x<span class="number">59</span>, <span class="number">0</span>x<span class="number">47</span>, <span class="number">0</span>xf<span class="number">0</span>, <span class="number">0</span>xad, <span class="number">0</span>xd<span class="number">4</span>, <span class="number">0</span>xa<span class="number">2</span>, <span class="number">0</span>xaf, <span class="number">0</span>x<span class="number">9</span>c, <span class="number">0</span>xa<span class="number">4</span>, <span class="number">0</span>x<span class="number">72</span>, <span class="number">0</span>xc<span class="number">0</span>,</span><br><span class="line">    <span class="attribute">0xb7</span>, <span class="number">0</span>xfd, <span class="number">0</span>x<span class="number">93</span>, <span class="number">0</span>x<span class="number">26</span>, <span class="number">0</span>x<span class="number">36</span>, <span class="number">0</span>x<span class="number">3</span>f, <span class="number">0</span>xf<span class="number">7</span>, <span class="number">0</span>xcc, <span class="number">0</span>x<span class="number">34</span>, <span class="number">0</span>xa<span class="number">5</span>, <span class="number">0</span>xe<span class="number">5</span>, <span class="number">0</span>xf<span class="number">1</span>, <span class="number">0</span>x<span class="number">71</span>, <span class="number">0</span>xd<span class="number">8</span>, <span class="number">0</span>x<span class="number">31</span>, <span class="number">0</span>x<span class="number">15</span>,</span><br><span class="line">    <span class="attribute">0x04</span>, <span class="number">0</span>xc<span class="number">7</span>, <span class="number">0</span>x<span class="number">23</span>, <span class="number">0</span>xc<span class="number">3</span>, <span class="number">0</span>x<span class="number">18</span>, <span class="number">0</span>x<span class="number">96</span>, <span class="number">0</span>x<span class="number">05</span>, <span class="number">0</span>x<span class="number">9</span>a, <span class="number">0</span>x<span class="number">07</span>, <span class="number">0</span>x<span class="number">12</span>, <span class="number">0</span>x<span class="number">80</span>, <span class="number">0</span>xe<span class="number">2</span>, <span class="number">0</span>xeb, <span class="number">0</span>x<span class="number">27</span>, <span class="number">0</span>xb<span class="number">2</span>, <span class="number">0</span>x<span class="number">75</span>,</span><br><span class="line">    <span class="attribute">0x09</span>, <span class="number">0</span>x<span class="number">83</span>, <span class="number">0</span>x<span class="number">2</span>c, <span class="number">0</span>x<span class="number">1</span>a, <span class="number">0</span>x<span class="number">1</span>b, <span class="number">0</span>x<span class="number">6</span>e, <span class="number">0</span>x<span class="number">5</span>a, <span class="number">0</span>xa<span class="number">0</span>, <span class="number">0</span>x<span class="number">52</span>, <span class="number">0</span>x<span class="number">3</span>b, <span class="number">0</span>xd<span class="number">6</span>, <span class="number">0</span>xb<span class="number">3</span>, <span class="number">0</span>x<span class="number">29</span>, <span class="number">0</span>xe<span class="number">3</span>, <span class="number">0</span>x<span class="number">2</span>f, <span class="number">0</span>x<span class="number">84</span>,</span><br><span class="line">    <span class="attribute">0x53</span>, <span class="number">0</span>xd<span class="number">1</span>, <span class="number">0</span>x<span class="number">00</span>, <span class="number">0</span>xed, <span class="number">0</span>x<span class="number">20</span>, <span class="number">0</span>xfc, <span class="number">0</span>xb<span class="number">1</span>, <span class="number">0</span>x<span class="number">5</span>b, <span class="number">0</span>x<span class="number">6</span>a, <span class="number">0</span>xcb, <span class="number">0</span>xbe, <span class="number">0</span>x<span class="number">39</span>, <span class="number">0</span>x<span class="number">4</span>a, <span class="number">0</span>x<span class="number">4</span>c, <span class="number">0</span>x<span class="number">58</span>, <span class="number">0</span>xcf,</span><br><span class="line">    <span class="attribute">0xd0</span>, <span class="number">0</span>xef, <span class="number">0</span>xaa, <span class="number">0</span>xfb, <span class="number">0</span>x<span class="number">43</span>, <span class="number">0</span>x<span class="number">4</span>d, <span class="number">0</span>x<span class="number">33</span>, <span class="number">0</span>x<span class="number">85</span>, <span class="number">0</span>x<span class="number">45</span>, <span class="number">0</span>xf<span class="number">9</span>, <span class="number">0</span>x<span class="number">02</span>, <span class="number">0</span>x<span class="number">7</span>f, <span class="number">0</span>x<span class="number">50</span>, <span class="number">0</span>x<span class="number">3</span>c, <span class="number">0</span>x<span class="number">9</span>f, <span class="number">0</span>xa<span class="number">8</span>,</span><br><span class="line">    <span class="attribute">0x51</span>, <span class="number">0</span>xa<span class="number">3</span>, <span class="number">0</span>x<span class="number">40</span>, <span class="number">0</span>x<span class="number">8</span>f, <span class="number">0</span>x<span class="number">92</span>, <span class="number">0</span>x<span class="number">9</span>d, <span class="number">0</span>x<span class="number">38</span>, <span class="number">0</span>xf<span class="number">5</span>, <span class="number">0</span>xbc, <span class="number">0</span>xb<span class="number">6</span>, <span class="number">0</span>xda, <span class="number">0</span>x<span class="number">21</span>, <span class="number">0</span>x<span class="number">10</span>, <span class="number">0</span>xff, <span class="number">0</span>xf<span class="number">3</span>, <span class="number">0</span>xd<span class="number">2</span>,</span><br><span class="line">    <span class="attribute">0xcd</span>, <span class="number">0</span>x<span class="number">0</span>c, <span class="number">0</span>x<span class="number">13</span>, <span class="number">0</span>xec, <span class="number">0</span>x<span class="number">5</span>f, <span class="number">0</span>x<span class="number">97</span>, <span class="number">0</span>x<span class="number">44</span>, <span class="number">0</span>x<span class="number">17</span>, <span class="number">0</span>xc<span class="number">4</span>, <span class="number">0</span>xa<span class="number">7</span>, <span class="number">0</span>x<span class="number">7</span>e, <span class="number">0</span>x<span class="number">3</span>d, <span class="number">0</span>x<span class="number">64</span>, <span class="number">0</span>x<span class="number">5</span>d, <span class="number">0</span>x<span class="number">19</span>, <span class="number">0</span>x<span class="number">73</span>,</span><br><span class="line">    <span class="attribute">0x60</span>, <span class="number">0</span>x<span class="number">81</span>, <span class="number">0</span>x<span class="number">4</span>f, <span class="number">0</span>xdc, <span class="number">0</span>x<span class="number">22</span>, <span class="number">0</span>x<span class="number">2</span>a, <span class="number">0</span>x<span class="number">90</span>, <span class="number">0</span>x<span class="number">88</span>, <span class="number">0</span>x<span class="number">46</span>, <span class="number">0</span>xee, <span class="number">0</span>xb<span class="number">8</span>, <span class="number">0</span>x<span class="number">14</span>, <span class="number">0</span>xde, <span class="number">0</span>x<span class="number">5</span>e, <span class="number">0</span>x<span class="number">0</span>b, <span class="number">0</span>xdb,</span><br><span class="line">    <span class="attribute">0xe0</span>, <span class="number">0</span>x<span class="number">32</span>, <span class="number">0</span>x<span class="number">3</span>a, <span class="number">0</span>x<span class="number">0</span>a, <span class="number">0</span>x<span class="number">49</span>, <span class="number">0</span>x<span class="number">06</span>, <span class="number">0</span>x<span class="number">24</span>, <span class="number">0</span>x<span class="number">5</span>c, <span class="number">0</span>xc<span class="number">2</span>, <span class="number">0</span>xd<span class="number">3</span>, <span class="number">0</span>xac, <span class="number">0</span>x<span class="number">62</span>, <span class="number">0</span>x<span class="number">91</span>, <span class="number">0</span>x<span class="number">95</span>, <span class="number">0</span>xe<span class="number">4</span>, <span class="number">0</span>x<span class="number">79</span>,</span><br><span class="line">    <span class="attribute">0xe7</span>, <span class="number">0</span>xc<span class="number">8</span>, <span class="number">0</span>x<span class="number">37</span>, <span class="number">0</span>x<span class="number">6</span>d, <span class="number">0</span>x<span class="number">8</span>d, <span class="number">0</span>xd<span class="number">5</span>, <span class="number">0</span>x<span class="number">4</span>e, <span class="number">0</span>xa<span class="number">9</span>, <span class="number">0</span>x<span class="number">6</span>c, <span class="number">0</span>x<span class="number">56</span>, <span class="number">0</span>xf<span class="number">4</span>, <span class="number">0</span>xea, <span class="number">0</span>x<span class="number">65</span>, <span class="number">0</span>x<span class="number">7</span>a, <span class="number">0</span>xae, <span class="number">0</span>x<span class="number">08</span>,</span><br><span class="line">    <span class="attribute">0xba</span>, <span class="number">0</span>x<span class="number">78</span>, <span class="number">0</span>x<span class="number">25</span>, <span class="number">0</span>x<span class="number">2</span>e, <span class="number">0</span>x<span class="number">1</span>c, <span class="number">0</span>xa<span class="number">6</span>, <span class="number">0</span>xb<span class="number">4</span>, <span class="number">0</span>xc<span class="number">6</span>, <span class="number">0</span>xe<span class="number">8</span>, <span class="number">0</span>xdd, <span class="number">0</span>x<span class="number">74</span>, <span class="number">0</span>x<span class="number">1</span>f, <span class="number">0</span>x<span class="number">4</span>b, <span class="number">0</span>xbd, <span class="number">0</span>x<span class="number">8</span>b, <span class="number">0</span>x<span class="number">8</span>a,</span><br><span class="line">    <span class="attribute">0x70</span>, <span class="number">0</span>x<span class="number">3</span>e, <span class="number">0</span>xb<span class="number">5</span>, <span class="number">0</span>x<span class="number">66</span>, <span class="number">0</span>x<span class="number">48</span>, <span class="number">0</span>x<span class="number">03</span>, <span class="number">0</span>xf<span class="number">6</span>, <span class="number">0</span>x<span class="number">0</span>e, <span class="number">0</span>x<span class="number">61</span>, <span class="number">0</span>x<span class="number">35</span>, <span class="number">0</span>x<span class="number">57</span>, <span class="number">0</span>xb<span class="number">9</span>, <span class="number">0</span>x<span class="number">86</span>, <span class="number">0</span>xc<span class="number">1</span>, <span class="number">0</span>x<span class="number">1</span>d, <span class="number">0</span>x<span class="number">9</span>e,</span><br><span class="line">    <span class="attribute">0xe1</span>, <span class="number">0</span>xf<span class="number">8</span>, <span class="number">0</span>x<span class="number">98</span>, <span class="number">0</span>x<span class="number">11</span>, <span class="number">0</span>x<span class="number">69</span>, <span class="number">0</span>xd<span class="number">9</span>, <span class="number">0</span>x<span class="number">8</span>e, <span class="number">0</span>x<span class="number">94</span>, <span class="number">0</span>x<span class="number">9</span>b, <span class="number">0</span>x<span class="number">1</span>e, <span class="number">0</span>x<span class="number">87</span>, <span class="number">0</span>xe<span class="number">9</span>, <span class="number">0</span>xce, <span class="number">0</span>x<span class="number">55</span>, <span class="number">0</span>x<span class="number">28</span>, <span class="number">0</span>xdf,</span><br><span class="line">    <span class="attribute">0x8c</span>, <span class="number">0</span>xa<span class="number">1</span>, <span class="number">0</span>x<span class="number">89</span>, <span class="number">0</span>x<span class="number">0</span>d, <span class="number">0</span>xbf, <span class="number">0</span>xe<span class="number">6</span>, <span class="number">0</span>x<span class="number">42</span>, <span class="number">0</span>x<span class="number">68</span>, <span class="number">0</span>x<span class="number">41</span>, <span class="number">0</span>x<span class="number">99</span>, <span class="number">0</span>x<span class="number">2</span>d, <span class="number">0</span>x<span class="number">0</span>f, <span class="number">0</span>xb<span class="number">0</span>, <span class="number">0</span>x<span class="number">54</span>, <span class="number">0</span>xbb, <span class="number">0</span>x<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> addkey_subbytes(pt, guesskey):</span><br><span class="line">    <span class="attribute">return</span> sbox[pt ^ guesskey]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">N</span> = len(json_load)</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span>(N)</span><br><span class="line"><span class="comment"># print(json_load[0][&#x27;pt&#x27;])</span></span><br><span class="line"><span class="comment"># print(json_load[0][&#x27;ct&#x27;])</span></span><br><span class="line"><span class="comment"># print(json_load[0][&#x27;pm&#x27;])</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">bestguess</span> =<span class="meta"> [0] * 16</span></span><br><span class="line"><span class="meta">data_start = 7</span></span><br><span class="line"><span class="meta">data_end = 200</span></span><br><span class="line"><span class="meta">NUM_POINTS = data_end - data_start</span></span><br><span class="line"><span class="meta">NUM_TRACES = len(json_load)</span></span><br><span class="line"><span class="meta">traces = []</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> pt_ct_pm in json_load:</span><br><span class="line">    <span class="attribute">traces</span>.append(pt_ct_pm[&#x27;pm&#x27;][data_start:data_end])</span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> k_idx in range(<span class="number">16</span>):  # determine key index</span><br><span class="line">    <span class="attribute">cpaoutput</span> =<span class="meta"> [0] * 256</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">    # follow valiables may not be need</span></span><br><span class="line"><span class="meta">    maxcpa = [0] * 256</span></span><br><span class="line"><span class="meta">    bestcor = 0</span></span><br><span class="line"><span class="meta">    bestkey = 0</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">    for kguess in range(256):  # determine word key candidate</span></span><br><span class="line"><span class="meta">        sumnum = np.zeros(NUM_POINTS)</span></span><br><span class="line"><span class="meta">        sumden1 = np.zeros(NUM_POINTS)</span></span><br><span class="line"><span class="meta">        sumden2 = np.zeros(NUM_POINTS)</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">        hyp = np.zeros(NUM_TRACES)</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">        for t_idx in range(NUM_TRACES):  # hypothesis hamming weight</span></span><br><span class="line"><span class="meta">            hyp[t_idx] = humming[addkey_subbytes(json_load[t_idx][&#x27;pt&#x27;][k_idx], kguess)]</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">h_mean</span> = np.mean(hyp, dtype=np.float<span class="number">64</span>)</span><br><span class="line">        <span class="attribute">t_mean</span> = np.mean(traces, axis=<span class="number">0</span>, dtype=np.float<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">assert</span> <span class="number">0</span> &lt; h_mean and h_mean &lt; <span class="number">8</span>, <span class="string">&quot;meanh is not between 0 and 8&quot;</span></span><br><span class="line">        <span class="attribute">assert</span> len(t_mean) == NUM_POINTS, <span class="string">&quot;meant is less than trace points&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">cors</span> =<span class="meta"> []</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">for</span> t_idx in range(NUM_TRACES):</span><br><span class="line">            <span class="attribute">hdiff</span> = (hyp[t_idx] - h_mean)</span><br><span class="line">            <span class="attribute">tdiff</span> = traces[t_idx] - t_mean</span><br><span class="line"></span><br><span class="line">            <span class="attribute">sumnum</span> = sumnum + (hdiff * tdiff)</span><br><span class="line">            <span class="attribute">sumden1</span> = sumden<span class="number">1</span> + hdiff * hdiff</span><br><span class="line">            <span class="attribute">sumden2</span> = sumden<span class="number">2</span> + tdiff * tdiff</span><br><span class="line"></span><br><span class="line">        <span class="attribute">cpaoutput</span>[kguess] = sumnum / np.sqrt(sumden<span class="number">1</span> * sumden<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">maxcpa</span>[kguess] = max(abs(cpaoutput[kguess]))</span><br><span class="line"></span><br><span class="line">    <span class="attribute">bestguess</span>[k_idx] = np.argmax(maxcpa)</span><br><span class="line">    <span class="attribute">print</span>(<span class="string">&quot;[+] best guess key [&#123;0&#125;] is &#123;1:02x&#125; (score: &#123;2&#125;)&quot;</span>.format(k_idx, bestguess[k_idx], maxcpa[bestguess[k_idx]]))</span><br><span class="line"></span><br><span class="line"><span class="attribute">strkey</span> = &#x27;&#x27;.join(map(chr, bestguess))</span><br><span class="line"><span class="attribute">print</span>(strkey)</span><br><span class="line"><span class="comment"># W0ckAwocKaWoCka1</span></span><br><span class="line"><span class="comment"># CTF&#123;W0ckAwocKaWoCka1&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><strong>ä¸è¶³</strong></p>
<ul>
<li>æœç´¢èƒ½åŠ›å¼±äº†ï¼Œæ¥å—æ–°é²œäº‹ç‰©çš„èƒ½åŠ›ä¹Ÿå·®</li>
</ul>
<p><strong>æ”¶è·</strong></p>
<ul>
<li><p>å¯ä»¥å…³æ³¨å…³æ³¨æ—¥éŸ©CTFåœˆå­</p>
<p>ä¸å°‘å¯†ç éš¾é¢˜çš„wpéƒ½æ˜¯æ—¥éŸ©å‡ºçš„ï¼Œå€¼å¾—é‡è§†</p>
</li>
</ul>
<h2 id="CYCLING"><a href="#CYCLING" class="headerlink" title="CYCLING"></a>CYCLING</h2><h3 id="é¢˜ç›®-1"><a href="#é¢˜ç›®-1" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><blockquote>
<p>It is well known that any RSA encryption can be undone by just encrypting the ciphertext over and over again. If the RSA modulus has been chosen badly then the number of encryptions necessary to undo an encryption is small. However, if the modulus is well chosen then a cycle attack can take much longer. This property can be used for a timed release of a message. We have confirmed that it takes a whopping 2^1025-3 encryptions to decrypt the flag. Pack out your quantum computer and perform 2^1025-3 encryptions to solve this challenge. Good luck doing this in 48h.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copyright 2022 Google LLC</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment"># you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment"># You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#      http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment"># See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment"># limitations under the License.</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">It is well known that any RSA encryption can be undone by just encrypting the</span></span><br><span class="line"><span class="string">ciphertext over and over again. If the RSA modulus has been chosen badly then</span></span><br><span class="line"><span class="string">the number of encryptions necessary to undo an encryption is small.</span></span><br><span class="line"><span class="string">If n = 0x112b00148621 then only 209 encryptions are necessary as the following</span></span><br><span class="line"><span class="string">example demonstrates:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>e = 65537</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>n = 0x112b00148621</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>pt = 0xdeadbeef</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span># Encryption</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>ct = pow(pt, e, n)</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span># Decryption via cycling:</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>pt = ct</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>for _ in range(209):</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>Â  pt = pow(pt, e, n)</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span># Assert decryption worked:</span></span><br><span class="line"><span class="string"><span class="meta">&gt;&gt;&gt; </span>assert ct == pow(pt, e, n)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">However, if the modulus is well chosen then a cycle attack can take much longer.</span></span><br><span class="line"><span class="string">This property can be used for a timed release of a message. We have confirmed</span></span><br><span class="line"><span class="string">that it takes a whopping 2^1025-3 encryptions to decrypt the flag. Pack out</span></span><br><span class="line"><span class="string">your quantum computer and perform 2^1025-3 encryptions to solve this</span></span><br><span class="line"><span class="string">challenge. Good luck doing this in 48h.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x99efa9177387907eb3f74dc09a4d7a93abf6ceb7ee102c689ecd0998975cede29f3ca951feb5adfb9282879cc666e22dcafc07d7f89d762b9ad5532042c79060cdb022703d790421a7f6a76a50cceb635ad1b5d78510adf8c6ff9645a1b179e965358e10fe3dd5f82744773360270b6fa62d972d196a810e152f1285e0b8b26f5d54991d0539a13e655d752bd71963f822affc7a03e946cea2c4ef65bf94706f20b79d672e64e8faac45172c4130bfeca9bef71ed8c0c9e2aa0a1d6d47239960f90ef25b337255bac9c452cb019a44115b0437726a9adef10a028f1e1263c97c14a1d7cd58a8994832e764ffbfcc05ec8ed3269bb0569278eea0550548b552b1</span></span><br><span class="line">ct = <span class="number">0x339be515121dab503106cd190897382149e032a76a1ca0eec74f2c8c74560b00dffc0ad65ee4df4f47b2c9810d93e8579517692268c821c6724946438a9744a2a95510d529f0e0195a2660abd057d3f6a59df3a1c9a116f76d53900e2a715dfe5525228e832c02fd07b8dac0d488cca269e0dbb74047cf7a5e64a06a443f7d580ee28c5d41d5ede3604825eba31985e96575df2bcc2fefd0c77f2033c04008be9746a0935338434c16d5a68d1338eabdcf0170ac19a27ec832bf0a353934570abd48b1fe31bc9a4bb99428d1fbab726b284aec27522efb9527ddce1106ba6a480c65f9332c5b2a3c727a2cca6d6951b09c7c28ed0474fdc6a945076524877680</span></span><br><span class="line"><span class="comment"># Decryption via cycling:</span></span><br><span class="line">pt = ct</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">1025</span> - <span class="number">3</span>):</span><br><span class="line">  <span class="built_in">print</span>(_)</span><br><span class="line">  pt = <span class="built_in">pow</span>(pt, e, n)</span><br><span class="line">  <span class="built_in">print</span>(pt)</span><br><span class="line">  <span class="keyword">if</span> ct == <span class="built_in">pow</span>(pt, e, n):</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"><span class="comment"># Assert decryption worked:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print flag:</span></span><br><span class="line"><span class="built_in">print</span>(pt.to_bytes((pt.bit_length() + <span class="number">7</span>)//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>åªæœ‰ä»£ç ï¼Œæ²¡æœ‰è§£é‡ŠåŸç†çš„wpï¼Œçœ‹äº†åŠå°æ—¶ï¼Œçœ‹ä¸æ‡‚ğŸ˜µâ€ğŸ’«</p>
<p>å…ˆæ”¾ç€å§ï¼ˆä¸­æ–‡æ³¨é‡Šæ˜¯æˆ‘å°è¯•ç†è§£æ‰€ç¿»è¯‘çš„ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy, libnum</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¸ç”¨å­—æ®µå¤§å°çš„2**i-1çš„ç´ å› å­è¡¨ã€‚è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºè¯¥æ–‡ä»¶ä¸­çš„å› å¼åˆ†è§£ä»…ä½¿ç”¨è¯•ç”¨é™¤æ³•ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2^(L)-1å°±æ˜¯äºŒè¿›åˆ¶ä¸‹Lä¸ª1</span></span><br><span class="line"><span class="comment"># ä»¥ä¸‹æ•°æ®æ¥è‡ª: factor(2^(L)-1). å¯ç”¨factorç½‘é¡µè€Œä¸æ˜¯sage</span></span><br><span class="line">MERSENNE_PRIME_FACTORS = &#123;</span><br><span class="line">    <span class="number">64</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">6700417</span>],</span><br><span class="line">    <span class="number">96</span>: [<span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">193</span>, <span class="number">241</span>, <span class="number">257</span>, <span class="number">673</span>, <span class="number">65537</span>, <span class="number">22253377</span>],</span><br><span class="line">    <span class="number">128</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>],</span><br><span class="line">    <span class="number">160</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">31</span>, <span class="number">41</span>, <span class="number">257</span>, <span class="number">61681</span>, <span class="number">65537</span>, <span class="number">414721</span>, <span class="number">4278255361</span>,</span><br><span class="line">        <span class="number">44479210368001</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">192</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">193</span>, <span class="number">241</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">673</span>, <span class="number">65537</span>, <span class="number">6700417</span>,</span><br><span class="line">        <span class="number">22253377</span>, <span class="number">18446744069414584321</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">224</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">29</span>, <span class="number">43</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">257</span>, <span class="number">449</span>, <span class="number">2689</span>, <span class="number">5153</span>, <span class="number">65537</span>, <span class="number">15790321</span>,</span><br><span class="line">        <span class="number">183076097</span>, <span class="number">54410972897</span>, <span class="number">358429848460993</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">255</span>: [</span><br><span class="line">        <span class="number">7</span>, <span class="number">31</span>, <span class="number">103</span>, <span class="number">151</span>, <span class="number">2143</span>, <span class="number">11119</span>, <span class="number">106591</span>, <span class="number">131071</span>, <span class="number">949111</span>,</span><br><span class="line">        <span class="number">9520972806333758431</span>, <span class="number">5702451577639775545838643151</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">256</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>,</span><br><span class="line">        <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">384</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">193</span>, <span class="number">241</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">673</span>, <span class="number">769</span>, <span class="number">65537</span>, <span class="number">274177</span>,</span><br><span class="line">        <span class="number">6700417</span>, <span class="number">22253377</span>, <span class="number">67280421310721</span>, <span class="number">18446744069414584321</span>,</span><br><span class="line">        <span class="number">442499826945303593556473164314770689</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">448</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">29</span>, <span class="number">43</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">257</span>, <span class="number">449</span>, <span class="number">641</span>, <span class="number">2689</span>, <span class="number">5153</span>, <span class="number">65537</span>, <span class="number">6700417</span>,</span><br><span class="line">        <span class="number">15790321</span>, <span class="number">183076097</span>, <span class="number">54410972897</span>, <span class="number">358429848460993</span>,</span><br><span class="line">        <span class="number">167773885276849215533569</span>, <span class="number">37414057161322375957408148834323969</span>],</span><br><span class="line">    <span class="number">512</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>,</span><br><span class="line">        <span class="number">1238926361552897</span>, <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span>,</span><br><span class="line">        <span class="number">93461639715357977769163558199606896584051237541638188580280321</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">768</span>: [</span><br><span class="line">        <span class="comment"># factors of 2**384 - 1</span></span><br><span class="line">        <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">193</span>, <span class="number">241</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">673</span>, <span class="number">769</span>, <span class="number">65537</span>, <span class="number">274177</span>,</span><br><span class="line">        <span class="number">6700417</span>, <span class="number">22253377</span>, <span class="number">67280421310721</span>, <span class="number">18446744069414584321</span>,</span><br><span class="line">        <span class="number">442499826945303593556473164314770689</span>,</span><br><span class="line">        <span class="comment"># factors of 2**128 + 1</span></span><br><span class="line">        <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span>,</span><br><span class="line">        <span class="comment"># factors of 2**256 - 2**128 + 1</span></span><br><span class="line">        <span class="number">349621839326921795694385454593</span>,</span><br><span class="line">        <span class="number">331192380488114152600457428497953408512758882817</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">1024</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>,</span><br><span class="line">        <span class="number">1238926361552897</span>, <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span>,</span><br><span class="line">        <span class="number">93461639715357977769163558199606896584051237541638188580280321</span>, <span class="number">2424833</span>,</span><br><span class="line">        <span class="number">7455602825647884208337395736200454918783366342657</span>,</span><br><span class="line">        <span class="number">741640062627530801524787141901937474059940781097519023905821316144415759504705008092818711693940737</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">2048</span>: [</span><br><span class="line">        <span class="number">3</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">257</span>, <span class="number">641</span>, <span class="number">65537</span>, <span class="number">274177</span>, <span class="number">6700417</span>, <span class="number">67280421310721</span>,</span><br><span class="line">        <span class="number">1238926361552897</span>, <span class="number">59649589127497217</span>, <span class="number">5704689200685129054721</span>,</span><br><span class="line">        <span class="number">93461639715357977769163558199606896584051237541638188580280321</span>, <span class="number">2424833</span>,</span><br><span class="line">        <span class="number">7455602825647884208337395736200454918783366342657</span>, <span class="number">45592577</span>, <span class="number">6487031809</span>,</span><br><span class="line">        <span class="number">4659775785220018543264560743076778192897</span>,</span><br><span class="line">        <span class="number">741640062627530801524787141901937474059940781097519023905821316144415759504705008092818711693940737</span>,</span><br><span class="line">        <span class="number">130439874405488189727484768796509903946608530841611892186895295776832416251471863574140227977573104895898783928842923844831149032913798729088601617946094119449010595906710130531906171018354491609619193912488538116080712299672322806217820753127014424577</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prod</span>(<span class="params">f: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;è®¡ç®—ç´¯ç§¯ç»“æœ&quot;&quot;&quot;</span></span><br><span class="line">  res = <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> p <span class="keyword">in</span> f:</span><br><span class="line">    res *= p</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">divisors_from_factors</span>(<span class="params">factors: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;è®¡ç®—ç»™å®šå› å­çš„æ•´æ•°çš„é™¤æ•°åˆ—è¡¨</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; divisors_from_factors([2,5])</span></span><br><span class="line"><span class="string">    [1, 2, 5, 10]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    res = &#123;<span class="number">1</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> factors:</span><br><span class="line">      res |= <span class="built_in">set</span>(x * f <span class="keyword">for</span> x <span class="keyword">in</span> res)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sorted</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CycleLength</span>:</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;Computes properties of RSA keys with a known cycle length.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  An instance of this class gives properties of RSA moduli n with</span></span><br><span class="line"><span class="string">  the property that lambda(lambda(n)) divides max_cycle.</span></span><br><span class="line"><span class="string">  The computation of these properties requires to know the factorization</span></span><br><span class="line"><span class="string">  of max_cycle. Hence we use values for max_cycle for which the factorization</span></span><br><span class="line"><span class="string">  is known. For example one can use max_cycle = 2 * (2^m - 1) and just</span></span><br><span class="line"><span class="string">  look up the factorization of the Mersenne number 2^m - 1.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  This is code that is both used for generating challenges and for solving them.</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, max_cycle_factors: <span class="built_in">list</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Defines the length of the cycle. </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">      max_cycle_factors: a list of prime factors of the maximal cycle</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    self.max_cycle_factors: <span class="built_in">list</span>[<span class="built_in">int</span>] = max_cycle_factors</span><br><span class="line">    self.max_cycle = prod(max_cycle_factors)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># A list of possible divisors of max_cycle</span></span><br><span class="line">    self.max_cycle_divisors = divisors_from_factors(max_cycle_factors)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># A list of primes with the property that r - 1 divides max_cycle.</span></span><br><span class="line">    self.primes_ = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">primes</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns a list of primes r, such that r-1 divides self.max_cycle.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> self.primes_ <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">      self.primes_ = [d + <span class="number">1</span> <span class="keyword">for</span> d <span class="keyword">in</span> self.max_cycle_divisors</span><br><span class="line">                      <span class="keyword">if</span> sympy.isprime(d + <span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">return</span> self.primes_</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">n: <span class="built_in">int</span>, cycle_length: CycleLength, m0: <span class="built_in">int</span> = <span class="number">3</span>, max_attempts: <span class="built_in">int</span> = <span class="number">10</span></span>):</span></span><br><span class="line">  <span class="built_in">print</span>(m0, max_attempts)  <span class="comment"># 3 10</span></span><br><span class="line">  <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(m0, m0 + max_attempts):</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> cycle_length.primes():</span><br><span class="line">      m = <span class="built_in">pow</span>(m, p, n)</span><br><span class="line">      g = gcd(m - <span class="number">1</span>, n)</span><br><span class="line">      <span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n:</span><br><span class="line">        <span class="keyword">return</span> g, n//g</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_challenge</span>(<span class="params">n, cycle_length</span>):</span></span><br><span class="line">  res = solve(n, cycle_length)</span><br><span class="line">  <span class="keyword">if</span> res:</span><br><span class="line">    p, q = res</span><br><span class="line">    <span class="keyword">if</span> <span class="number">1</span> &lt; p &lt; n <span class="keyword">and</span> <span class="number">1</span> &lt; q &lt; n <span class="keyword">and</span> p*q == n:</span><br><span class="line">      <span class="keyword">return</span> p, q </span><br><span class="line">  <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x99efa9177387907eb3f74dc09a4d7a93abf6ceb7ee102c689ecd0998975cede29f3ca951feb5adfb9282879cc666e22dcafc07d7f89d762b9ad5532042c79060cdb022703d790421a7f6a76a50cceb635ad1b5d78510adf8c6ff9645a1b179e965358e10fe3dd5f82744773360270b6fa62d972d196a810e152f1285e0b8b26f5d54991d0539a13e655d752bd71963f822affc7a03e946cea2c4ef65bf94706f20b79d672e64e8faac45172c4130bfeca9bef71ed8c0c9e2aa0a1d6d47239960f90ef25b337255bac9c452cb019a44115b0437726a9adef10a028f1e1263c97c14a1d7cd58a8994832e764ffbfcc05ec8ed3269bb0569278eea0550548b552b1</span></span><br><span class="line">ct = <span class="number">0x339be515121dab503106cd190897382149e032a76a1ca0eec74f2c8c74560b00dffc0ad65ee4df4f47b2c9810d93e8579517692268c821c6724946438a9744a2a95510d529f0e0195a2660abd057d3f6a59df3a1c9a116f76d53900e2a715dfe5525228e832c02fd07b8dac0d488cca269e0dbb74047cf7a5e64a06a443f7d580ee28c5d41d5ede3604825eba31985e96575df2bcc2fefd0c77f2033c04008be9746a0935338434c16d5a68d1338eabdcf0170ac19a27ec832bf0a353934570abd48b1fe31bc9a4bb99428d1fbab726b284aec27522efb9527ddce1106ba6a480c65f9332c5b2a3c727a2cca6d6951b09c7c28ed0474fdc6a945076524877680</span></span><br><span class="line"></span><br><span class="line">m = <span class="number">1024</span>  <span class="comment"># 2^1025 - 3 æ˜¯1025æ¯”ç‰¹ä½çš„æ•°</span></span><br><span class="line">cycle_length = CycleLength([<span class="number">2</span>] + MERSENNE_PRIME_FACTORS[m])  <span class="comment"># æ‰€ä»¥è¡¥ä¸€ä¸ª2</span></span><br><span class="line">p, q = solve_challenge(n, cycle_length)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">pt = <span class="built_in">int</span>(<span class="built_in">pow</span>(ct, d, n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(pt))</span><br><span class="line"><span class="comment"># b&#x27;CTF&#123;Recycling_Is_Great&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<hr>
<p>xchgeaxeaxå¸ˆå‚…åˆ†äº«äº†ä»–æ‰¾åˆ°çš„wpï¼Œè†œæ‹œäº†ä¸‹æ¥è‡ªæ—¥æœ¬çš„<a target="_blank" rel="noopener" href="https://zenn.dev/kurenaif/articles/ae83691511b966">å¯†ç é­”å¥³wp</a></p>
<p>ä¸å¾—ä¸è¯´ï¼ŒæŠ€æœ¯åŠ›æ‹‰æ»¡ï¼Œä½†é­”å¥³ğŸ§™â€â™€ï¸è¡¨è¾¾èƒ½åŠ›å¤ªå·®äº†ã€‚</p>
<p>ä¹Ÿæˆ–è®¸æ˜¯æ—¥è¯­æœºç¿»çš„é—®é¢˜ï¼Œçœ‹èµ·æ¥å®åœ¨å¤ªå·®åŠ²äº†ï¼Œä¸€é¢˜çœ‹ä¸€å¤©â€¦</p>
<p><strong>æ¥åˆ†æä¸€ä¸‹é¢˜ç›®å§ï¼</strong></p>
<blockquote>
<p>It is well known that any RSA encryption can be undone by just encrypting the ciphertext over and over again. </p>
</blockquote>
<p>æ ¹æ®é¢˜æ„ï¼Œâ€œä»»ä½•RSAåŠ å¯†éƒ½èƒ½è¢«å¾ªç¯åŠ å¯†æ‰€è§£å¯†â€</p>
<p>å…¶åï¼Œç»™äº†ä¸ªä¾‹å­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x112b00148621</span></span><br><span class="line">pt = <span class="number">0xdeadbeef</span></span><br><span class="line"><span class="comment"># Encryption</span></span><br><span class="line">ct = <span class="built_in">pow</span>(pt, e, n)</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä¸ºå¯¹æ˜æ–‡ä¸ºdeedbeefåŠ å¯†çš„è¿‡ç¨‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Decryption via cycling:</span></span><br><span class="line">pt = ct</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">209</span>):</span><br><span class="line">	pt = <span class="built_in">pow</span>(pt, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(<span class="built_in">hex</span>(pt)).replace(<span class="string">r&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line"><span class="comment"># deadbeef</span></span><br></pre></td></tr></table></figure>

<p>å¯è§ï¼Œç›´æ¥å¯¹å¯†æ–‡åŠ å¯†209æ¬¡å°±èƒ½å¾—åˆ°æ˜æ–‡</p>
<p>è€Œæ ¹æ®è¿™ä¸ªæ€§è´¨ï¼Œå¯ä»¥äººä¸ºé€‰å¥½eã€næ§åˆ¶å¥½å¾ªç¯æ¬¡æ•°ï¼Œè¾¾åˆ°<strong>å®šæ—¶å…¬å¸ƒæ¶ˆæ¯</strong>çš„åŠŸèƒ½</p>
<p>ä¹‹åï¼Œç»™äº†flagç›¸å…³çš„eã€nã€ctï¼Œä»¥åŠå¾ªç¯æ¬¡æ•°$2^{1025}-3$</p>
<p>å¾ªç¯æ¬¡æ•°è¿‡äºå¤§äº†ï¼Œæ™®é€šæœºå­ç›´æ¥è·‘48hæ—¶é—´åº”è¯¥æ˜¯ä¸å¤Ÿçš„</p>
<p><strong>éœ€è¦æ›´å¥½çš„ç®—æ³•æ±‚è§£é—®é¢˜</strong></p>
<p>èšç„¦å¾ªç¯åŠ å¯†çš„è§£å¯†è¿‡ç¨‹ï¼Œæœ‰ä»¥ä¸‹ï¼š</p>
<p>$mâ‰¡c^{e^{2^{1025}-3}}â‰¡(m^e)^{e^{2^{1025}-3}}â‰¡m^{e^{2^{1025}-2}} \mod n$</p>
<p>å¯å¾—ï¼š</p>
<p>1âƒ£ï¸$dâ‰¡e^{2^{1025}-3}$</p>
<p>2âƒ£ï¸$edâ‰¡e^{2^{1025}-2}â‰¡1 \mod phi$</p>
<p>å¯¹1âƒ£ï¸ï¼Œå› ä¸ºdå¤ªå¤§äº†ï¼Œç®—ä¸å‡ºæ¥ï¼Œå°±ç®—æˆ‘ä»¬æœ‰äº†ç§é’¥dä¹Ÿä¸èƒ½è§£å‡ºæ˜æ–‡ï¼Œè‹¥æƒ³ç€ç¡¬ç®—å‡ºdåŒç›´æ¥å¾ªç¯æ±‚è§£æ²¡æœ¬è´¨åŒºåˆ«</p>
<p>å¯¹2âƒ£ï¸ï¼Œç”±æ¬§æ‹‰å®šç†ï¼Œå¯å¾—ï¼š$\phi(phi) = 2^{1025-2}$ï¼Œè®°ä¸º3âƒ£ï¸</p>
<blockquote>
<p>æ¥ä¸‹æ¥çš„æ‰‹æ³•ï¼Œæˆ‘åªèƒ½ä»è§£é‡Šçš„è§’åº¦å‡ºå‘äº†ï¼Œè‡³äºå½“æ—¶è®©æˆ‘æƒ³ï¼Œåº”è¯¥æ˜¯æƒ³ä¸å‡ºæ¥çš„ã€‚</p>
</blockquote>
<blockquote>
<p>çœ‹åˆ°å®˜æ–¹expé‡Œï¼Œæœ‰ä¸“é—¨çš„åå­—ï¼Œæˆ–è®¸æ˜¯å¸¸ç”¨æ”»å‡»æ–¹æ³•ï¼Ÿè¿˜å¾—å­¦ä¹ </p>
</blockquote>
<p>ä¸ºè§£å†³æ­¤é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªç›¸å¯¹å¤Ÿå°çš„dï¼Œè‡³å°‘æˆ‘ä»¬èƒ½ç®—å‡ºæ¥</p>
<p>å¦‚ä½•å‡å°dçš„å¤§å°åˆä¸å½±å“è§£å¯†å‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ï¼š$d \mod phi$</p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_BB25E5BF9D40-1.jpeg" alt="dmphi"></p>
<p>å…¶å®ï¼Œè¿™æ˜¯èµ°ä¸é€šçš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“phiæ˜¯å¤šå°‘ï¼Œè¿™æ ·åè€Œè®©æœªçŸ¥é‡è¶Šæ¥è¶Šå¤šäº†</p>
<p>ä½†ï¼Œä¹Ÿä¸æ˜¯æ²¡æœ‰æ”¶è·ï¼Œé’ˆå¯¹phiä¸çŸ¥çš„é—®é¢˜ï¼Œå¯ä»¥åˆ©ç”¨3âƒ£ï¸ï¼Œæœ‰ï¼š</p>
<p>$\phi(phi) = 2^{1025}-2$</p>
<p>æ‹†ä¹‹ï¼Œå¾—ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220706184618463.png" alt="phi(phi)"></p>
<p>è€Œè®¾$n=p*q$,åˆ™è®¾ï¼š$phi=(p-1)â€¢(q-1)=Aâ€¢Bâ€¢Câ€¢Dâ€¢Eâ€¢Fâ€¢â€¦$</p>
<p>åˆï¼š$\phi(phi) = 2^{1025}-2=(A-1)â€¢(B-1)â€¢(C-1)â€¢(D-1)â€¢(E-1)â€¢(F-1)â€¢â€¦$</p>
<p>$=aâ€¢bâ€¢câ€¢dâ€¢eâ€¢fâ€¢gâ€¢hâ€¢â€¦$</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ$A-1$å¯èƒ½è¢«æ‹†æˆäº†$aâ€¢b$, $B-1$å¯èƒ½è¢«æ‹†æˆäº†$câ€¢eâ€¢h$</p>
<p>æ‰€ä»¥ï¼Œæ’åˆ—ç»„åˆå¹¶ç›¸ä¹˜$\phi(phi)$çš„ç´ å› å­ï¼Œå†+1ï¼Œæˆ‘ä»¬èƒ½å¾—åˆ°å«æœ‰phiçš„å¼å­</p>
<p>$(aâ€¢b+1)(aâ€¢c+1)(aâ€¢d+1)Â·Â·Â·(aâ€¢bâ€¢c+1)Â·Â·Â·(câ€¢eâ€¢h+1)Â·Â·Â·$</p>
<p>å°±ä¼šå¾—åˆ°$Kâ€¢Aâ€¢Bâ€¢Câ€¢Dâ€¢Eâ€¢Fâ€¦=K*phi$</p>
<p>æ€»ä¹‹ï¼Œåˆ©ç”¨$\phi(phi)$çš„ç´ å› å­ï¼Œæˆ‘ä»¬èƒ½æ¢å¤å‡º$K*phi$</p>
<p>å®ç°ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">lambda_lambda_divs = [</span><br><span class="line"> <span class="number">2</span>,</span><br><span class="line"> <span class="number">3</span>,</span><br><span class="line"> <span class="number">5</span>,</span><br><span class="line"> <span class="number">17</span>,</span><br><span class="line"> <span class="number">257</span>,</span><br><span class="line"> <span class="number">641</span>,</span><br><span class="line"> <span class="number">65537</span>,</span><br><span class="line"> <span class="number">274177</span>,</span><br><span class="line"> <span class="number">2424833</span>,</span><br><span class="line"> <span class="number">6700417</span>,</span><br><span class="line"> <span class="number">67280421310721</span>,</span><br><span class="line"> <span class="number">1238926361552897</span>,</span><br><span class="line"> <span class="number">59649589127497217</span>,</span><br><span class="line"> <span class="number">5704689200685129054721</span>,</span><br><span class="line"> <span class="number">7455602825647884208337395736200454918783366342657</span>,</span><br><span class="line"> <span class="number">93461639715357977769163558199606896584051237541638188580280321</span>,</span><br><span class="line"> <span class="number">741640062627530801524787141901937474059940781097519023905821316144415759504705008092818711693940737</span></span><br><span class="line"> ]</span><br><span class="line"></span><br><span class="line">lambda_lambda = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> lambda_lambda_divs:</span><br><span class="line">    lambda_lambda *= d</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> lambda_lambda == <span class="number">2</span>**<span class="number">1025</span>-<span class="number">2</span></span><br><span class="line"></span><br><span class="line">lambda_candidate = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> lambda_lambda_divs:</span><br><span class="line">    lambda_candidate *= (d+<span class="number">1</span>)**<span class="number">10</span></span><br><span class="line"></span><br><span class="line">cand = lambda_lambda_divs[:<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">res = <span class="number">1</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> L <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lambda_lambda_divs) + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> subset <span class="keyword">in</span> itertools.combinations(lambda_lambda_divs, L):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;cnt&#125;</span>&quot;</span>)</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        a = <span class="number">2</span>*math.prod(subset)+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(a):</span><br><span class="line">            res *= a</span><br></pre></td></tr></table></figure>

<p>å†å›åˆ°<strong>å¦‚ä½•å‡å°dçš„å¤§å°åˆä¸å½±å“è§£å¯†</strong>è¿™ä¸ªé—®é¢˜ï¼Œä¸éš¾å‘ç°ï¼š</p>
<p><strong>å¯ç”¨$d \mod K*phi$</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/IMG_2A80F05B3E7B-1.jpeg" alt="dmkphi"></p>
<p>ä¹Ÿå³ï¼šå¯åˆ©ç”¨è¾ƒå°çš„$d \mod K*phi$ï¼ˆåŸæ¥dä¸º$e^{2^{1025}-3}$ï¼‰æ¥å½“ç§é’¥dï¼Œè§£å¯†å‡ºæ˜æ–‡m</p>
<p><strong>ï¼ˆå‰é¢ç®—å¾—çš„K*phiè®°ä¸ºresï¼‰</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="built_in">pow</span>(e,<span class="number">2</span>**<span class="number">1025</span>-<span class="number">3</span>,res)  <span class="comment"># d mod K*phi</span></span><br><span class="line">pt = <span class="built_in">pow</span>(ct, p, n)</span><br><span class="line"><span class="built_in">print</span>(pt.to_bytes((pt.bit_length() + <span class="number">7</span>)//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode())</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°è¿™<code>p = pow(e,2**1025-3,res)</code>ï¼Œä¼šå‘ç°è¿™è®¡ç®—é‡ä¹Ÿä¸å°ï¼Œèƒ½ä¸èƒ½ä¼˜åŒ–å‘¢ï¼Ÿ</p>
<p>$e^{2^{1025}-3}â‰¡e^{2^{1025}-2}â€¢e^{-1}â‰¡e^{-1} \mod Kâ€¢phi$</p>
<p>ï¼ˆå“ªä½å¸ˆå‚…æ¥æ•™ä¸€ä¸‹æˆ‘ï¼Œä¸ºä»€ä¹ˆå¯ä»¥ï¼‰</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">p</span> = <span class="built_in">pow</span>(<span class="keyword">e</span>,-<span class="number">1</span>,<span class="keyword">res</span>)  # d <span class="keyword">mod</span> K*phi</span><br><span class="line"><span class="keyword">pt</span> = <span class="built_in">pow</span>(ct, <span class="keyword">p</span>, n)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">pt</span>.to_bytes((<span class="keyword">pt</span>.bit_length() + <span class="number">7</span>)//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode())</span><br></pre></td></tr></table></figure>

<h4 id="æ€»ä»£ç "><a href="#æ€»ä»£ç " class="headerlink" title="æ€»ä»£ç "></a>æ€»ä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x99efa9177387907eb3f74dc09a4d7a93abf6ceb7ee102c689ecd0998975cede29f3ca951feb5adfb9282879cc666e22dcafc07d7f89d762b9ad5532042c79060cdb022703d790421a7f6a76a50cceb635ad1b5d78510adf8c6ff9645a1b179e965358e10fe3dd5f82744773360270b6fa62d972d196a810e152f1285e0b8b26f5d54991d0539a13e655d752bd71963f822affc7a03e946cea2c4ef65bf94706f20b79d672e64e8faac45172c4130bfeca9bef71ed8c0c9e2aa0a1d6d47239960f90ef25b337255bac9c452cb019a44115b0437726a9adef10a028f1e1263c97c14a1d7cd58a8994832e764ffbfcc05ec8ed3269bb0569278eea0550548b552b1</span></span><br><span class="line">ct = <span class="number">0x339be515121dab503106cd190897382149e032a76a1ca0eec74f2c8c74560b00dffc0ad65ee4df4f47b2c9810d93e8579517692268c821c6724946438a9744a2a95510d529f0e0195a2660abd057d3f6a59df3a1c9a116f76d53900e2a715dfe5525228e832c02fd07b8dac0d488cca269e0dbb74047cf7a5e64a06a443f7d580ee28c5d41d5ede3604825eba31985e96575df2bcc2fefd0c77f2033c04008be9746a0935338434c16d5a68d1338eabdcf0170ac19a27ec832bf0a353934570abd48b1fe31bc9a4bb99428d1fbab726b284aec27522efb9527ddce1106ba6a480c65f9332c5b2a3c727a2cca6d6951b09c7c28ed0474fdc6a945076524877680</span></span><br><span class="line"></span><br><span class="line">lambda_lambda_divs = [</span><br><span class="line"> <span class="number">2</span>,</span><br><span class="line"> <span class="number">3</span>,</span><br><span class="line"> <span class="number">5</span>,</span><br><span class="line"> <span class="number">17</span>,</span><br><span class="line"> <span class="number">257</span>,</span><br><span class="line"> <span class="number">641</span>,</span><br><span class="line"> <span class="number">65537</span>,</span><br><span class="line"> <span class="number">274177</span>,</span><br><span class="line"> <span class="number">2424833</span>,</span><br><span class="line"> <span class="number">6700417</span>,</span><br><span class="line"> <span class="number">67280421310721</span>,</span><br><span class="line"> <span class="number">1238926361552897</span>,</span><br><span class="line"> <span class="number">59649589127497217</span>,</span><br><span class="line"> <span class="number">5704689200685129054721</span>,</span><br><span class="line"> <span class="number">7455602825647884208337395736200454918783366342657</span>,</span><br><span class="line"> <span class="number">93461639715357977769163558199606896584051237541638188580280321</span>,</span><br><span class="line"> <span class="number">741640062627530801524787141901937474059940781097519023905821316144415759504705008092818711693940737</span></span><br><span class="line"> ]</span><br><span class="line"></span><br><span class="line">lambda_lambda = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> lambda_lambda_divs:</span><br><span class="line">    lambda_lambda *= d</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> lambda_lambda == <span class="number">2</span>**<span class="number">1025</span>-<span class="number">2</span></span><br><span class="line"></span><br><span class="line">lambda_candidate = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> lambda_lambda_divs:</span><br><span class="line">    lambda_candidate *= (d+<span class="number">1</span>)**<span class="number">10</span></span><br><span class="line"></span><br><span class="line">cand = lambda_lambda_divs[:<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">res = <span class="number">1</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> L <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lambda_lambda_divs) + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> subset <span class="keyword">in</span> itertools.combinations(lambda_lambda_divs, L):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;cnt&#125;</span>&quot;</span>)</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        a = <span class="number">2</span>*math.prod(subset)+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(a):</span><br><span class="line">            res *= a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="built_in">pow</span>(e,-<span class="number">1</span>,res)</span><br><span class="line">pt = <span class="built_in">pow</span>(ct, p, n)</span><br><span class="line"><span class="built_in">print</span>(pt.to_bytes((pt.bit_length() + <span class="number">7</span>)//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode())</span><br><span class="line"><span class="comment"># CTF&#123;Recycling_Is_Great&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul>
<li><p>Cycle attack on RSA</p>
<p>å¾ªç¯æ”»å‡»ç»™äº†ç¡®å®šæ¬¡æ•°ï¼Œå³å¯æ”»ç ´</p>
</li>
<li><p>é€šè¿‡$\phi(phi)$è·å¾—$K*phi$</p>
</li>
<li><p>då¯ä»¥æ”¾ç¼©æˆ$d \mod K*phi$</p>
</li>
</ul>
<h2 id="MAYBE-SOMEDAY"><a href="#MAYBE-SOMEDAY" class="headerlink" title="MAYBE SOMEDAY"></a>MAYBE SOMEDAY</h2><h3 id="é¢˜ç›®-2"><a href="#é¢˜ç›®-2" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><blockquote>
<p>Leave me your ciphertexts. I will talk to you later.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copyright 2022 Google LLC</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment"># you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment"># You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#      http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment"># See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment"># limitations under the License.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="keyword">as</span> get_prime</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># Suppose gcd(p, q) = 1. Find x such that</span></span><br><span class="line"><span class="comment">#   1. 0 &lt;= x &lt; p * q, and</span></span><br><span class="line"><span class="comment">#   2. x = a (mod p), and</span></span><br><span class="line"><span class="comment">#   3. x = b (mod q).</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crt</span>(<span class="params">a, b, p, q</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a*<span class="built_in">pow</span>(q, -<span class="number">1</span>, p)*q + b*<span class="built_in">pow</span>(p, -<span class="number">1</span>, q)*p) % (p*q)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L</span>(<span class="params">x, n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (x-<span class="number">1</span>) // n</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Paillier</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        p = get_prime(<span class="number">1024</span>)</span><br><span class="line">        q = get_prime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">        n = p * q</span><br><span class="line">        Î» = (p-<span class="number">1</span>) * (q-<span class="number">1</span>) // math.gcd(p-<span class="number">1</span>, q-<span class="number">1</span>) <span class="comment"># lcm(p-1, q-1)</span></span><br><span class="line">        g = random.randint(<span class="number">0</span>, n-<span class="number">1</span>)</span><br><span class="line">        Âµ = <span class="built_in">pow</span>(L(<span class="built_in">pow</span>(g, Î», n**<span class="number">2</span>), n), -<span class="number">1</span>, n)</span><br><span class="line"></span><br><span class="line">        self.n = n</span><br><span class="line">        self.Î» = Î»</span><br><span class="line">        self.g = g</span><br><span class="line">        self.Âµ = Âµ</span><br><span class="line"></span><br><span class="line">        self.p = p</span><br><span class="line">        self.q = q</span><br><span class="line"></span><br><span class="line">    <span class="comment"># https://www.rfc-editor.org/rfc/rfc3447#section-7.2.1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">self, m</span>):</span></span><br><span class="line">        padding_size = <span class="number">2048</span>//<span class="number">8</span> - <span class="number">3</span> - <span class="built_in">len</span>(m)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> padding_size &lt; <span class="number">8</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;message too long&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        random_padding = <span class="string">b&#x27;\0&#x27;</span> * padding_size</span><br><span class="line">        <span class="keyword">while</span> <span class="string">b&#x27;\0&#x27;</span> <span class="keyword">in</span> random_padding:</span><br><span class="line">            random_padding = os.urandom(padding_size)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;\x00\x02&#x27;</span> + random_padding + <span class="string">b&#x27;\x00&#x27;</span> + m</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unpad</span>(<span class="params">self, m</span>):</span></span><br><span class="line">        <span class="keyword">if</span> m[:<span class="number">2</span>] != <span class="string">b&#x27;\x00\x02&#x27;</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;decryption error&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        random_padding, m = m[<span class="number">2</span>:].split(<span class="string">b&#x27;\x00&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(random_padding) &lt; <span class="number">8</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;decryption error&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public_key</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> (self.n, self.g)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">secret_key</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> (self.Î», self.Âµ)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, m</span>):</span></span><br><span class="line">        g = self.g</span><br><span class="line">        n = self.n</span><br><span class="line"></span><br><span class="line">        m = self.pad(m)</span><br><span class="line">        m = <span class="built_in">int</span>.from_bytes(m, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        r = random.randint(<span class="number">0</span>, n-<span class="number">1</span>)</span><br><span class="line">        c = <span class="built_in">pow</span>(g, m, n**<span class="number">2</span>) * <span class="built_in">pow</span>(r, n, n**<span class="number">2</span>) % n**<span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, c</span>):</span></span><br><span class="line">        Î» = self.Î»</span><br><span class="line">        Âµ = self.Âµ</span><br><span class="line">        n = self.n</span><br><span class="line"></span><br><span class="line">        m = L(<span class="built_in">pow</span>(c, Î», n**<span class="number">2</span>), n) * Âµ % n</span><br><span class="line">        m = m.to_bytes(<span class="number">2048</span>//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.unpad(m)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fast_decrypt</span>(<span class="params">self, c</span>):</span></span><br><span class="line">        Î» = self.Î»</span><br><span class="line">        Âµ = self.Âµ</span><br><span class="line">        n = self.n</span><br><span class="line">        p = self.p</span><br><span class="line">        q = self.q</span><br><span class="line"></span><br><span class="line">        rp = <span class="built_in">pow</span>(c, Î», p**<span class="number">2</span>)</span><br><span class="line">        rq = <span class="built_in">pow</span>(c, Î», q**<span class="number">2</span>)</span><br><span class="line">        r = crt(rp, rq, p**<span class="number">2</span>, q**<span class="number">2</span>)</span><br><span class="line">        m = L(r, n) * Âµ % n</span><br><span class="line">        m = m.to_bytes(<span class="number">2048</span>//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.unpad(m)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span>(<span class="params">p</span>):</span></span><br><span class="line">    secret = os.urandom(<span class="number">2</span>)</span><br><span class="line">    secret = hashlib.sha512(secret).hexdigest().encode()</span><br><span class="line"></span><br><span class="line">    c0 = p.encrypt(secret)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c0 = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># # The secret has 16 bits of entropy.</span></span><br><span class="line">    <span class="comment"># # Hence 16 oracle calls should be sufficient, isn&#x27;t it?</span></span><br><span class="line">    <span class="comment"># for _ in range(16):</span></span><br><span class="line">    <span class="comment">#     c = int(input())</span></span><br><span class="line">    <span class="comment">#     try:</span></span><br><span class="line">    <span class="comment">#         p.decrypt(c)</span></span><br><span class="line">    <span class="comment">#         print(&#x27;ğŸ˜€&#x27;)</span></span><br><span class="line">    <span class="comment">#     except:</span></span><br><span class="line">    <span class="comment">#         print(&#x27;ğŸ˜¡&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># I decided to make it non-interactive to make this harder.</span></span><br><span class="line">    <span class="comment"># Good news: I&#x27;ll give you 25% more oracle calls to compensate, anyways.</span></span><br><span class="line">    cs = [<span class="built_in">int</span>(<span class="built_in">input</span>()) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cs:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            p.fast_decrypt(c)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;ğŸ˜€&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;ğŸ˜¡&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    guess = <span class="built_in">input</span>().encode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> guess != secret: <span class="keyword">raise</span> Exception(<span class="string">&#x27;incorrect guess!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">      flag = f.read()</span><br><span class="line"></span><br><span class="line">    p = Paillier()</span><br><span class="line">    n, g = p.public_key()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;g = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Once is happenstance. Twice is coincidence...</span></span><br><span class="line">        <span class="comment"># Sixteen times is a recovery of the pseudorandom number generator.</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            challenge(p)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;ğŸ’¡&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;ğŸ <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ğŸ‘‹&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h3 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><blockquote>
<p>å­¦ä¹ å‚è€ƒxchgeaxeaxå¸ˆå‚…æ‰¾åˆ°çš„<a target="_blank" rel="noopener" href="https://buaq.net/go-116119.html">æ—¥è¯­wp</a></p>
</blockquote>
<p>å…³äºåŒæ€çš„é€‰æ‹©å¯†æ–‡æ”»å‡»ï¼Œæ—¶é—´ä¸å¤Ÿï¼Œå¤ç°çš„è¯ï¼Œä¸‹æ¬¡ä¸€å®šï¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ptrlib <span class="keyword">import</span> Socket</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">table = []</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> product(<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>)), repeat=<span class="number">2</span>):</span><br><span class="line">    table.append(hashlib.sha512(<span class="built_in">bytes</span>(b)).hexdigest())</span><br><span class="line"></span><br><span class="line">size = <span class="number">10</span></span><br><span class="line">basenum = <span class="built_in">int</span>(<span class="string">&quot;3000&quot;</span> * size, <span class="number">16</span>)</span><br><span class="line">basealp = <span class="built_in">int</span>(<span class="string">&quot;6100&quot;</span> * size, <span class="number">16</span>)</span><br><span class="line">one = <span class="built_in">int</span>(<span class="string">&quot;0100&quot;</span> * size, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">sock = Socket(<span class="string">&quot;nc maybe-someday.2022.ctfcompetition.com 1337&quot;</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">int</span>(sock.recvlineafter(<span class="string">&quot;n = &quot;</span>))</span><br><span class="line">g = <span class="built_in">int</span>(sock.recvlineafter(<span class="string">&quot;g = &quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> stage <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;stage: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(stage + <span class="number">1</span>))</span><br><span class="line">    c0 = <span class="built_in">int</span>(sock.recvlineafter(<span class="string">&quot;c0 = &quot;</span>))</span><br><span class="line"></span><br><span class="line">    c1 = c0 * <span class="built_in">pow</span>(g, <span class="number">0xff</span> &lt;&lt; <span class="number">1024</span>, n ** <span class="number">2</span>) % (n ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    cs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        <span class="keyword">if</span> i &lt;= <span class="number">9</span>:</span><br><span class="line">            cs.append(c1 * inverse(<span class="built_in">pow</span>(g, (basenum + one * i) &lt;&lt; (<span class="number">1024</span> - size * <span class="number">8</span> * <span class="number">2</span>), n ** <span class="number">2</span>), n ** <span class="number">2</span>) % (n ** <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">elif</span> i &lt;= <span class="number">0xf</span>:</span><br><span class="line">            cs.append(</span><br><span class="line">                c1 * inverse(<span class="built_in">pow</span>(g, (basealp + one * (i - <span class="number">10</span>)) &lt;&lt; (<span class="number">1024</span> - size * <span class="number">8</span> * <span class="number">2</span>), n ** <span class="number">2</span>), n ** <span class="number">2</span>) % (n ** <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cs.append(c1 * inverse(<span class="built_in">pow</span>(g, (basenum + one * (i - <span class="number">16</span>)) &lt;&lt; (<span class="number">1024</span> - size * <span class="number">8</span> * <span class="number">2</span> - <span class="number">8</span>), n ** <span class="number">2</span>), n ** <span class="number">2</span>) % (</span><br><span class="line">                        n ** <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cs:</span><br><span class="line">        sock.sendline(<span class="built_in">str</span>(c))</span><br><span class="line"></span><br><span class="line">    isin = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">    <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(cs):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;ğŸ˜€&#x27;</span> <span class="keyword">in</span> sock.recvline().decode():</span><br><span class="line">            isin[i] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> table:</span><br><span class="line">        head = h[:<span class="number">2</span> * size][::<span class="number">2</span>]</span><br><span class="line">        head2 = h[:<span class="number">2</span> * size + <span class="number">1</span>][<span class="number">1</span>::<span class="number">2</span>]</span><br><span class="line">        match = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            <span class="keyword">if</span> isin[i] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">not</span> <span class="keyword">in</span> head:</span><br><span class="line">                    match = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">in</span> head:</span><br><span class="line">                    match = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">if</span> isin[i + <span class="number">0x10</span>] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">not</span> <span class="keyword">in</span> head2:</span><br><span class="line">                    match = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">in</span> head2:</span><br><span class="line">                    match = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> match:</span><br><span class="line">            sock.sendline(h)</span><br><span class="line">            line = sock.recvline().decode()</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;ğŸ’¡&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(line)</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;bad luck&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;not found&quot;</span>)</span><br><span class="line"></span><br><span class="line">sock.interactive()</span><br><span class="line"><span class="comment"># CTF&#123;p4dd1n9_or4cl3_w1th_h0mom0rph1c_pr0p3r7y_c0m6in3d_in7o_a_w31rd_m47h_puzz1e&#125;</span></span><br></pre></td></tr></table></figure>












    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>Harry0597
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://harry0597.com/2022/07/12/GoogleCTF2022%C2%B7Crypto%20WP/" title="GoogleCTF2022Â·Crypto å¤ç°">https://harry0597.com/2022/07/12/GoogleCTF2022Â·Crypto WP/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Writeup/" rel="tag"><i class="fa fa-tag"></i> Writeup</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/07/12/%E6%9D%82%E8%AE%B0%E4%BA%8C/" rel="prev" title="æ‚è®°äºŒ">
      <i class="fa fa-chevron-left"></i> æ‚è®°äºŒ
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/07/12/vsCTF2022%C2%B7Crypto%20WP/" rel="next" title="vsCTF2022Â·Crypto WP">
      vsCTF2022Â·Crypto WP <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#2022GoogleCTF%C2%B7%E5%AF%86%E7%A0%81%E5%A4%8D%E7%8E%B0"><span class="nav-number">1.</span> <span class="nav-text">2022GoogleCTFÂ·å¯†ç å¤ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ELECTRIC-MAYHEM-CLS"><span class="nav-number">1.2.</span> <span class="nav-text">ELECTRIC MAYHEM CLS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">1.2.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">1.2.2.</span> <span class="nav-text">é¢˜è§£</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">1.2.3.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CYCLING"><span class="nav-number">1.3.</span> <span class="nav-text">CYCLING</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-1"><span class="nav-number">1.3.2.</span> <span class="nav-text">é¢˜è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">æ€»ä»£ç </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">1.3.3.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MAYBE-SOMEDAY"><span class="nav-number">1.4.</span> <span class="nav-text">MAYBE SOMEDAY</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="nav-number">1.4.1.</span> <span class="nav-text">é¢˜ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-2"><span class="nav-number">1.4.2.</span> <span class="nav-text">é¢˜è§£</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Harry0597"
      src="/images/IMG_2550.JPG">
  <p class="site-author-name" itemprop="name">Harry0597</p>
  <div class="site-description" itemprop="description">Pondering'll do you wonders.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:1915885792@qq.com" title="E-Mail â†’ mailto:1915885792@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>


      
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CS/" rel="tag">CS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-OS/" rel="tag">Mac OS</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Writeup/" rel="tag">Writeup</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">æ‚</a><span class="tag-list-count">6</span></li></ul>
              </canvas>
          </div>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harry0597</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">791k</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'SdJfKJYPhm2sNuw1OsouUSUC-MdYXbMMI',
      appKey     : '4pmiJGkm87YwJe40oBXXWYKM',
      placeholder: "è¯„è®ºï¼Œè®©æ€ç»´ç¢°æ’",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://SdJfKJYP.api.lncldglobal.com'
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
