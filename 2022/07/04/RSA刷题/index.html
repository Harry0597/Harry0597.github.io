<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="200x200" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/ico" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/hackerrank.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harry0597.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="此文将会持续更新有趣的、利用已学知识即可解的rsa题目">
<meta property="og:type" content="article">
<meta property="og:title" content="RSA刷题">
<meta property="og:url" content="https://harry0597.com/2022/07/04/RSA%E5%88%B7%E9%A2%98/index.html">
<meta property="og:site_name" content="Harry&#39;s Blog">
<meta property="og:description" content="此文将会持续更新有趣的、利用已学知识即可解的rsa题目">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220513165548541.png">
<meta property="article:published_time" content="2022-07-04T14:38:27.000Z">
<meta property="article:modified_time" content="2022-12-30T13:00:27.913Z">
<meta property="article:author" content="Harry0597">
<meta property="article:tag" content="Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220513165548541.png">

<link rel="canonical" href="https://harry0597.com/2022/07/04/RSA%E5%88%B7%E9%A2%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>RSA刷题 | Harry's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Harry's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">温故知新</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Harry0597" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://harry0597.com/2022/07/04/RSA%E5%88%B7%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/IMG_2550.JPG">
      <meta itemprop="name" content="Harry0597">
      <meta itemprop="description" content="Pondering'll do you wonders.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Harry's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          RSA刷题
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-04 22:38:27" itemprop="dateCreated datePublished" datetime="2022-07-04T22:38:27+08:00">2022-07-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-12-30 21:00:27" itemprop="dateModified" datetime="2022-12-30T21:00:27+08:00">2022-12-30</time>
              </span>

          
    <span>&emsp;</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span>
    <span class="post-meta-item-text">阅读次数：</span>
    <span id="busuanzi_value_page_pv"></span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/07/04/RSA%E5%88%B7%E9%A2%98/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/07/04/RSA%E5%88%B7%E9%A2%98/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>74k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:07</span>
            </span>
            <div class="post-description">此文将会持续更新有趣的、利用已学知识即可解的rsa题目</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="funnyrsa1"><a href="#funnyrsa1" class="headerlink" title="funnyrsa1"></a>funnyrsa1</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e1 = <span class="number">14606334023791426</span></span><br><span class="line">p1 = <span class="number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span></span><br><span class="line">q1 = <span class="number">130968576816900149996914427770826228884925960001279609559095138835900329492765336419489982304805369724685145941218640504262821549441728192761733409684831633194346504685627189375724517070780334885673563409259345291959439026700006694655545512308390416859315892447092639503318475587220630455745460309886030186593</span></span><br><span class="line">c1 = <span class="number">11402389955595766056824801105373550411371729054679429421548608725777586555536302409478824585455648944737304660137306241012321255955693234304201530700362069004620531537922710568821152217381257446478619320278993539785699090234418603086426252498046106436360959622415398647198014716351359752734123844386459925553497427680448633869522591650121047156082228109421246662020164222925272078687550896012363926358633323439494967417041681357707006545728719651494384317497942177993032739778398001952201667284323691607312819796036779374423837576479275454953999865750584684592993292347483309178232523897058253412878901324740104919248</span></span><br><span class="line"></span><br><span class="line">e2 = <span class="number">13813369129257838</span></span><br><span class="line">p2 = <span class="number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span></span><br><span class="line">q2 = <span class="number">94582257784130735233174402362819395926641026753071039760251190444144495369829487705195913337502962816079184062352678128843179586054535283861793827497892600954650126991213176547276006780610945133603745974181504975165082485845571788686928859549252522952174376071500707863379238688200493621993937563296490615649</span></span><br><span class="line">c2 = <span class="number">7984888899827615209197324489527982755561403577403539988687419233579203660429542197972867526015619223510964699107198708420785278262082902359114040327940253582108364104049849773108799812000586446829979564395322118616382603675257162995702363051699403525169767736410365076696890117813211614468971386159587698853722658492385717150691206731593509168262529568464496911821756352254486299361607604338523750318977620039669792468240086472218586697386948479265417452517073901655900118259488507311321060895347770921790483894095085039802955700146474474606794444308825840221205073230671387989412399673375520605000270180367035526919</span></span><br></pre></td></tr></table></figure>

<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ul>
<li>gcd(e1, phi) = 14</li>
<li>e1 | p1 - 1    &amp;    e1 | q1 -  1</li>
</ul>
<p>e, phi不互素的第二种情况</p>
<p>这里头脑风暴一下，就可解决（非预期？</p>
<ol>
<li><p>直接对c1在有限域开e1次方，开不出来（e1太大了</p>
</li>
<li><p>对c1开14次方，便得到$c_1 ^ \frac{1}{14}$,有：</p>
<p>$$c_1 ^ \frac{1}{14} = m^ \frac{e1}{14} \mod n$$</p>
<p>即：$$c1’ = m^{e’} \mod n$$</p>
<p>此时，e1’ = e1/14, gcd(e1, phi1) = 1</p>
</li>
<li><p>e1‘, phi互素了，解出m</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">14</span></span><br><span class="line">e1 = <span class="number">14606334023791426</span> // <span class="number">14</span></span><br><span class="line">p = <span class="number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span></span><br><span class="line">q = <span class="number">130968576816900149996914427770826228884925960001279609559095138835900329492765336419489982304805369724685145941218640504262821549441728192761733409684831633194346504685627189375724517070780334885673563409259345291959439026700006694655545512308390416859315892447092639503318475587220630455745460309886030186593</span></span><br><span class="line">c = <span class="number">11402389955595766056824801105373550411371729054679429421548608725777586555536302409478824585455648944737304660137306241012321255955693234304201530700362069004620531537922710568821152217381257446478619320278993539785699090234418603086426252498046106436360959622415398647198014716351359752734123844386459925553497427680448633869522591650121047156082228109421246662020164222925272078687550896012363926358633323439494967417041681357707006545728719651494384317497942177993032739778398001952201667284323691607312819796036779374423837576479275454953999865750584684592993292347483309178232523897058253412878901324740104919248</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e1, phi)</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^e-c</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^e-c</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q])</span><br><span class="line">        m = <span class="built_in">int</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(solution), d, p*q))</span><br><span class="line">        flag = libnum.n2s(m)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Over.&#x27;</span>)</span><br><span class="line"><span class="comment"># b&quot;flag&#123;gcd_e&amp;\xcf\x86_isn&#x27;t_1&#125;&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对乱码部分hex解码，得：</p>
<p><code>flag&#123;gcd_e&amp;φ_isn&#39;t_1&#125;</code></p>
</li>
</ol>
<h2 id="ctfshow·EASYRSA"><a href="#ctfshow·EASYRSA" class="headerlink" title="ctfshow·EASYRSA"></a>ctfshow·EASYRSA</h2><blockquote>
<p>ROARCTF复现</p>
</blockquote>
<h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(flag.startwith(<span class="string">&#x27;flag&#123;&#x27;</span>)) <span class="keyword">and</span> (flag.endwith(<span class="string">&#x27;&#125;&#x27;</span>))</span><br><span class="line"><span class="keyword">assert</span>(is_prime(beta) <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(beta)[<span class="number">2</span>:]) == <span class="number">512</span>) </span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(x)[<span class="number">2</span>:]) == <span class="built_in">len</span>(<span class="built_in">bin</span>(y)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># This is tip!!!</span></span><br><span class="line"><span class="keyword">assert</span>(tip == <span class="number">2</span>*x*y*beta + x + y)</span><br><span class="line"></span><br><span class="line">p = <span class="number">2</span>*x*beta + <span class="number">1</span></span><br><span class="line">q = <span class="number">2</span>*y*beta + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(is_prime(p) <span class="keyword">and</span> is_prime(q))</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">enc = powmod(m,e,n)</span><br><span class="line"><span class="comment">#n=17986052241518124152579698727005505088573670763293762110375836247355612011054569717338676781772224186355540833136105641118789391002684013237464006860953174190278718294774874590936823847040556879723368745745863499521381501281961534965719063185861101706333863256855553691578381034302217163536137697146370869852180388385732050177505306982196493799420954022912860262710497234529008765582379823928557307038782793649826879316617865012433973899266322533955187594070215597700782682186705964842947435512183808651329554499897644733096933800570431036589775974437965028894251544530715336418443795864241340792616415926241778326529055663</span></span><br><span class="line"><span class="comment">#e=65537</span></span><br><span class="line"><span class="comment">#enc=10760807485718247466823893305767047250503197383143218026814141719093776781403513881079114556890534223832352132446445237573389249010880862460738448945011264928270648357652595432015646424427464523486856294998582949173459779764873664665361437483861277508734208729366952221351049574873831620714889674755106545281174797387906705765430764314845841490492038801926675266705606453163826755694482549401843247482172026764635778484644547733877083368527255145572732954216461334217963127783632702980064435718785556011795841651015143521512315148320334442235923393757396733821710592667519724592789856065414299022191871582955584644441117223</span></span><br><span class="line"><span class="comment">#beta=11864389277042761216996641604675717452843530574016671576684180662096506094587545173005905433938758559675517932481818900399893444422743930613073261450555599</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><p>我写的颇为费劲，起初想通过n // pow(beta, 2)得到4xy</p>
<p>再利用%来获得x+y来解方程</p>
<p>以上都是不可行的，因为通过简单判断，知道p、q都是大于beta的</p>
<ul>
<li><p>还得向tip看齐</p>
</li>
<li><p>然后根据余数遍历k来爆破x+y，从而得到x*y</p>
<p>最近做的题居然都偏向于这种易被我忽视的</p>
</li>
<li><p>解出x, y</p>
</li>
<li><p>发现p、q是素数</p>
</li>
<li><p>求解rsa</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">17986052241518124152579698727005505088573670763293762110375836247355612011054569717338676781772224186355540833136105641118789391002684013237464006860953174190278718294774874590936823847040556879723368745745863499521381501281961534965719063185861101706333863256855553691578381034302217163536137697146370869852180388385732050177505306982196493799420954022912860262710497234529008765582379823928557307038782793649826879316617865012433973899266322533955187594070215597700782682186705964842947435512183808651329554499897644733096933800570431036589775974437965028894251544530715336418443795864241340792616415926241778326529055663</span></span><br><span class="line">enc = <span class="number">10760807485718247466823893305767047250503197383143218026814141719093776781403513881079114556890534223832352132446445237573389249010880862460738448945011264928270648357652595432015646424427464523486856294998582949173459779764873664665361437483861277508734208729366952221351049574873831620714889674755106545281174797387906705765430764314845841490492038801926675266705606453163826755694482549401843247482172026764635778484644547733877083368527255145572732954216461334217963127783632702980064435718785556011795841651015143521512315148320334442235923393757396733821710592667519724592789856065414299022191871582955584644441117223</span></span><br><span class="line">beta = <span class="number">11864389277042761216996641604675717452843530574016671576684180662096506094587545173005905433938758559675517932481818900399893444422743930613073261450555599</span></span><br><span class="line">tip = (n - <span class="number">1</span>) // (<span class="number">2</span> * beta)  <span class="comment"># 2xy*beta+x+y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a = (x+y) % beta = tip % beta</span></span><br><span class="line"><span class="comment"># x+y = k*beta + a</span></span><br><span class="line">a = tip % beta</span><br><span class="line">x = <span class="number">4668043289052029901343771698523052922596858535604154804368853607181324334964567257637285439401177209511493949633696749298641147411501031244979219281057378320</span></span><br><span class="line">y = <span class="number">6843057810980339658872333593534427464545104752516312442185148369974064674864085821085976673212477585701065946365239235648157162338024362013460418665527344009</span></span><br><span class="line">p = <span class="number">2</span>*x*beta + <span class="number">1</span></span><br><span class="line">q = <span class="number">2</span>*y*beta + <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> gmpy2.is_prime(p)</span><br><span class="line"><span class="keyword">assert</span> gmpy2.is_prime(q)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(enc, d, n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># 求x, y</span></span><br><span class="line"><span class="string">k = 0</span></span><br><span class="line"><span class="string">while True:</span></span><br><span class="line"><span class="string">    x_a_y = k*beta + a</span></span><br><span class="line"><span class="string">    print(k)</span></span><br><span class="line"><span class="string">    if (tip-x_a_y) % beta == 0:</span></span><br><span class="line"><span class="string">        xy = (tip-x_a_y) // (2*beta)</span></span><br><span class="line"><span class="string">        x = Int(&#x27;x&#x27;)</span></span><br><span class="line"><span class="string">        y = Int(&#x27;y&#x27;)</span></span><br><span class="line"><span class="string">        S = Solver()</span></span><br><span class="line"><span class="string">        S.add(x+y == x_a_y)</span></span><br><span class="line"><span class="string">        S.add(x*y == xy)</span></span><br><span class="line"><span class="string">        S.add(x &gt; 0, y &gt; 0)</span></span><br><span class="line"><span class="string">        if str(S.check()) == &#x27;sat&#x27;:</span></span><br><span class="line"><span class="string">            print(S.model())</span></span><br><span class="line"><span class="string">    k += 1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="ctfshow大🐮杯·小二难度R54"><a href="#ctfshow大🐮杯·小二难度R54" class="headerlink" title="ctfshow大🐮杯·小二难度R54"></a>ctfshow大🐮杯·小二难度R54</h2><p>刷知乎刷到的题🤔，la佬出的签到题</p>
<p>做的<strong>破为曲折</strong>，记录一下</p>
<h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">x</span><span class="punctuation">,</span> y <span class="operator">=</span> [random_prime(<span class="number">2</span> ^ <span class="number">1024</span> - <span class="number">1</span><span class="punctuation">,</span> False<span class="punctuation">,</span> <span class="number">2</span> ^ <span class="number">1023</span>) for _ in range(<span class="number">2</span>)]</span><br><span class="line"># <span class="keyword">x</span> * y<span class="punctuation">,</span> pow(<span class="number">2021</span> * <span class="keyword">x</span> + <span class="number">501</span> * y<span class="punctuation">,</span> <span class="keyword">x</span> * y - <span class="keyword">x</span> - y<span class="punctuation">,</span> <span class="keyword">x</span> * y)<span class="punctuation">,</span> pow(flag<span class="punctuation">,</span> <span class="number">0</span>o<span class="number">200001</span><span class="punctuation">,</span> <span class="keyword">x</span> * y)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">20947495659013288660808536751393787394664606045798093048128257278988208709333248671898749660848208653968668634891579612784633367362177864996602736258460476691940723323282467207875842974409286563660436709535601954405015261428106261369927836045794170912665351432105165546188591486357060490032334793140396757102052999128194027485573053073959574695808224922102635888141991154365047911830780778957642166757152369955362399379720841279167832886144458760347392316082994786119404006382441787685301119197529946566027319295285387108473752590621030421978808950305190250697199878929419723511578437404000924310974770501204226510397</span>, <span class="number">12911378830212711575909332427930495830030418987483519620282504671823307660633472092466534392403086505995560725428252134905285658936113891795434303336259751169171583600394870893708505805256284455729584616439559184469715186920464999723861722097244025658190194027561300165723184060071016117033960821040587421503448139025974851980482004179865110864844573575034406782936965166402665401330436229441569042660851847498727291447251591027480750458209012729510702196684303778564353025395186191064801000127420683298000173389589468742142444444759536629401472836827952997758216526858512433131954439154124668711408079361172485321041</span>, <span class="number">13390681135321846035598057088735733735860895610541899486616159864716324918810264721878447895634342127744578566110322466944217562868186608760962032192994397783118528288276520451944892998435079744244578731427626946331165523865930693902700790185275273534104979885060728696532991031786741950704918951536399577118136416956670893081637730646528913282395731901667720418372650030593319596584787752412110672058692368924987360383096340538971725402687347195347344826404005229912821371282465882351660619944919637382790572267512735645269618163597227604601321699186335016345484182059187046972681187078878556533926780789183784240737</span>]</span><br></pre></td></tr></table></figure>

<h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><p>可见 把x、y当作p、q,则有：</p>
<ul>
<li>p、q  is prime</li>
<li>给了一下值<ul>
<li>p*q   即n</li>
<li>$(2021•p+501•q)^{pq-p-q} \mod n$</li>
<li>$c = flag^e \mod n$</li>
<li>e = 0o200001  (十六进制下的65537)</li>
</ul>
</li>
</ul>
<p>一开始觉得怪复杂的，后然看到幂pq-p-q，想到的有威尔逊定理和欧拉定理，显然后者可能有效</p>
<p>于是观察到$(p-1)*(q-1) = pq-p-q+1$</p>
<p>尝试构造之，设$A = (2021•p+501•q)$，$tmp = (2021•p+501•q)^{pq-p-q} \mod n$则：</p>
<p>$tmp*A = A^{\phi (n)} \mod n = 1 \mod n$</p>
<p>我是很不情愿尝试拆开来直接爆破的，但前几次做题都有这操作，这里也情不自禁想：</p>
<p>$tmp•A = k•n +1$, 所以遍历k使得kn+1能被tmp整除，则爆破出A</p>
<p>然后用z3解方程得到p、q</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n, tmp, c = ...</span><br><span class="line">S = Solver()</span><br><span class="line"></span><br><span class="line">e = <span class="number">0o200001</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(k)</span><br><span class="line">    <span class="keyword">if</span> (k*n + <span class="number">1</span>) % tmp == <span class="number">0</span>:</span><br><span class="line">        a = (k*n + <span class="number">1</span>) // tmp</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        p = Int(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">        q = Int(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">        S.add(q &gt; <span class="number">0</span>)</span><br><span class="line">        S.add(p &gt; <span class="number">0</span>)</span><br><span class="line">        S.add(<span class="number">2021</span>*p + <span class="number">501</span>*q == a)</span><br><span class="line">        <span class="keyword">if</span> S.check():</span><br><span class="line">            <span class="built_in">print</span>(S.model())</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    k += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>实际跑起来，几分钟都没结果，作罢</p>
<p><strong>然后再仔细观察👀</strong></p>
<p>$tmp*A = 1 \mod n$</p>
<p>🤔啊这，逆元嘛，这不是</p>
<p>易得：<strong>A = inv(tmp, n)</strong></p>
<p>于是，觉得万事大吉！</p>
<p>(其实题目里<code>random_prime(2 ^ 1024 - 1, False, 2 ^ 1023)</code>没看懂，猜测生成素数是小于2\^1024-1，大于2\^1023的)</p>
<p>上z3</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">from z3 import<span class="operator"> *</span></span><br><span class="line"><span class="operator"></span></span><br><span class="line"><span class="operator"></span>n, tmp, c = <span class="number">20947495659013288660808536751393787394664606045798093048128257278988208709333248671898749660848208653968668634891579612784633367362177864996602736258460476691940723323282467207875842974409286563660436709535601954405015261428106261369927836045794170912665351432105165546188591486357060490032334793140396757102052999128194027485573053073959574695808224922102635888141991154365047911830780778957642166757152369955362399379720841279167832886144458760347392316082994786119404006382441787685301119197529946566027319295285387108473752590621030421978808950305190250697199878929419723511578437404000924310974770501204226510397</span>, <span class="number">12911378830212711575909332427930495830030418987483519620282504671823307660633472092466534392403086505995560725428252134905285658936113891795434303336259751169171583600394870893708505805256284455729584616439559184469715186920464999723861722097244025658190194027561300165723184060071016117033960821040587421503448139025974851980482004179865110864844573575034406782936965166402665401330436229441569042660851847498727291447251591027480750458209012729510702196684303778564353025395186191064801000127420683298000173389589468742142444444759536629401472836827952997758216526858512433131954439154124668711408079361172485321041</span>, <span class="number">13390681135321846035598057088735733735860895610541899486616159864716324918810264721878447895634342127744578566110322466944217562868186608760962032192994397783118528288276520451944892998435079744244578731427626946331165523865930693902700790185275273534104979885060728696532991031786741950704918951536399577118136416956670893081637730646528913282395731901667720418372650030593319596584787752412110672058692368924987360383096340538971725402687347195347344826404005229912821371282465882351660619944919637382790572267512735645269618163597227604601321699186335016345484182059187046972681187078878556533926780789183784240737</span></span><br><span class="line">S = <span class="constructor">Solver()</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0o200001</span></span><br><span class="line">A = <span class="built_in">int</span>(gmpy2.invert(tmp, n))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="constructor">Int(&#x27;<span class="params">p</span>&#x27;)</span></span><br><span class="line">q = <span class="constructor">Int(&#x27;<span class="params">q</span>&#x27;)</span></span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add(q &gt; <span class="number">2</span>**<span class="number">1023</span>)</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add(q &lt; <span class="number">2</span>*<span class="number">1024</span>-<span class="number">1</span>)</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add((p &gt; <span class="number">2</span>**<span class="number">1023</span>))</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add(p &lt; <span class="number">2</span>*<span class="number">1024</span>-<span class="number">1</span>)</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>add((<span class="number">2021</span>*p + <span class="number">501</span>*q) % n<span class="operator"> == </span>A)</span><br><span class="line"><span class="keyword">if</span> <span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>check<span class="literal">()</span>:</span><br><span class="line">    print(<span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>model<span class="literal">()</span>)</span><br><span class="line">    print(<span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>model<span class="literal">()</span><span class="literal">[<span class="number">0</span>]</span>)</span><br><span class="line">    print(<span class="keyword">type</span>(<span class="module-access"><span class="module"><span class="identifier">S</span>.</span></span>model<span class="literal">()</span>))</span><br><span class="line"></span><br><span class="line">q =<span class="operator"> ...</span></span><br><span class="line"><span class="operator"></span>p =<span class="operator"> ...</span></span><br><span class="line"><span class="operator"></span>phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">int</span>(pow(c, d, n))</span><br><span class="line">print(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<p><code>S.add(q &lt; 2*1024-1)</code>、<code>S.add(p &lt; 2*1024-1)</code>这两句一加上就报错，没办法删了，解出来的p、q也不满足大小要求😭</p>
<p>看了下<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/370374186">wp</a></p>
<p>奥！傻了，n=p*q忘记加了</p>
<p>再用z3跑，出了，我觉得万事大吉！</p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">n, tmp, c = </span><br><span class="line">e = <span class="number">0</span>o200001</span><br><span class="line"></span><br><span class="line">A = <span class="keyword">int</span>(gmpy2.invert(tmp, n))</span><br><span class="line">from z3 import *</span><br><span class="line"><span class="meta"># S = Solver()</span></span><br><span class="line"><span class="meta"># p = Int(&#x27;p&#x27;)</span></span><br><span class="line"><span class="meta"># q = Int(&#x27;q&#x27;)</span></span><br><span class="line"><span class="meta"># S.add(q &gt; 2**1023)</span></span><br><span class="line"><span class="meta"># S.add((p &gt; 2**1023))</span></span><br><span class="line"><span class="meta"># S.add(p*q == n)</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"># S.add((2021*p + 501*q) % n == A)</span></span><br><span class="line"><span class="meta"># if S.check():</span></span><br><span class="line"><span class="meta">#     print(S.model())</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">118025808013874567502972067396154378205921004159004592806833496003217679639841107629090128959992942958292926872941356148283178987927403535617729247751812776636333788905610726461255956234207606642302396722821445909489968841256943549868105578713493559907241758893208485830735235619636112619927867287431575647321</span></span><br><span class="line">q = <span class="number">177482332140024816122816575300851746457741976238942019223639223243373845838446387378093437677008231609976122718397287922224412805145965728166071230572137942154170172214953182121671014605624049869925600226560127948579957435119412752482229481128742488177414523194528098131635883615390771259266866469500527361157</span></span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="keyword">int</span>(pow(c, d, n))</span><br><span class="line">print(libnum.n2s(m))</span><br><span class="line"><span class="meta"># emkkocy&#123;lnyu_wp_kxs_kc_ahz_dvjg_by?&#125;</span></span><br></pre></td></tr></table></figure>

<p>❓这明显是古典加密过了</p>
<p>尝试了凯撒、维吉尼亚、quip无果</p>
<p>实在没办法，看了下<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/370374186">wp</a>,春哥写的有些复杂（我看不下去😕），但我看到其解题的思想</p>
<p><strong>于是，自己开始尝试当密码学家了！</strong></p>
<p>明确已知和未知</p>
<ul>
<li>c = emkkocy{lnyu_wp_kxs_kc_ahz_dvjg_by?}</li>
<li>m = ctfshow….</li>
</ul>
<p>显然，像是<code>&#123; _ &#125;</code>这些符号没有参与加密，剔除之</p>
<p>于是有</p>
<ul>
<li>c =  emkkocylnyuwpkxskcahzdvjgby</li>
<li>m = ctfshow</li>
</ul>
<p>古典的本质是规律，尝试找到这些字符ASCII之间的关系</p>
<p>用密文-已知明文（c-m=key）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;emkkocy&#123;lnyu_wp_kxs_kc_ahz_dvjg_by?&#125;&#x27;</span></span><br><span class="line">flag_ = <span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    a = <span class="built_in">ord</span>(flag[i])</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        b = <span class="built_in">ord</span>(flag_[i])</span><br><span class="line">        key.append(a - b)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="comment"># [2, -7, 5, -8, 7, -12, 2]</span></span><br></pre></td></tr></table></figure>

<p>🤔没什么特别明显的规律，因为2出现了两次不妨大胆猜测一个周期有：2, -7, 5, -8, 7, -12</p>
<p>则：明文 = 密文 - 密钥 (m=c-key)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">2</span>, -<span class="number">7</span>, <span class="number">5</span>, -<span class="number">8</span>, <span class="number">7</span>, -<span class="number">12</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;emkkocylnyuwpkxskcahzdvjgby&#x27;</span>  <span class="comment"># 去掉非字母部分</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag_ = <span class="built_in">ord</span>(flag[i]) - key[i % <span class="number">6</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag_), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># ctfshowsinnrs&#123;do_ouloveit</span></span><br></pre></td></tr></table></figure>

<p>有不是字母的字符，这就得约定好范围（小写字母）</p>
<p>这种思路源自 凯撒密码为代表的古典密码 用的 mod26 的思想</p>
<p>于是有：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">2</span>, -<span class="number">7</span>, <span class="number">5</span>, -<span class="number">8</span>, <span class="number">7</span>, -<span class="number">12</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;emkkocylnyuwpkxskcahzdvjgby&#x27;</span>  <span class="comment"># 去掉非字母部分</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))  <span class="comment"># 97</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>))  <span class="comment"># 122</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag_ = <span class="built_in">ord</span>(flag[i]) - key[i % <span class="number">6</span>]</span><br><span class="line">    <span class="keyword">if</span> flag_ &lt; <span class="number">97</span>:</span><br><span class="line">        flag_ = <span class="number">122</span> - (<span class="number">97</span> - flag_) + <span class="number">1</span>  <span class="comment"># like 96 对应122（z）</span></span><br><span class="line">    <span class="keyword">if</span> flag_ &gt; <span class="number">122</span>:</span><br><span class="line">        flag_ = (flag_-<span class="number">122</span>) + <span class="number">97</span> - <span class="number">1</span>  <span class="comment"># like 123 对应 97(a)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag_), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># ctfshowsigninrsadoyouloveit</span></span><br></pre></td></tr></table></figure>

<p>可知，flag为<code>ctfshow&#123;sign_in_rsa_do_you_love_it?&#125;</code></p>
<h3 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h3><p>除了学会灵活性的处理rsa问题外，还对古典密码加深了认知</p>
<p>这后一点尤为关键，队内已出现过只差一步解密出flag的情况了，密码手得给力，一锤定音！</p>
<p>总之，对于古典密码找规律解密，有：</p>
<ul>
<li>古典明文以<strong>字母</strong>为内容</li>
<li>古典算法以<strong>模的运算</strong>为方法</li>
<li>古典解密以<strong>约束住范围</strong>为关键</li>
</ul>
<p>👴不只会 一一对应的古典密码解密了</p>
<p>哦耶✌️</p>
<p>（<strong>实测维吉尼亚还得要全部密文来破解正确密钥！此法无效</strong>）</p>
<h2 id="ctfshow-摆烂杯-easy-peasy"><a href="#ctfshow-摆烂杯-easy-peasy" class="headerlink" title="ctfshow 摆烂杯 easy-peasy"></a>ctfshow 摆烂杯 easy-peasy</h2><p>据说还是签到题（la佬恐怖如斯Orz）</p>
<h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line"><span class="keyword">assert</span>(l == <span class="number">86</span>)</span><br><span class="line">m = bytes_to_long(<span class="string">b&#x27;\x00&#x27;</span> * (l - <span class="number">1</span>) + flag + <span class="string">b&#x27;\x00&#x27;</span> * (l - <span class="number">2</span>))</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 23570098360097260908266914080954003513706885568390448463720576188146956287111601604870247233822682630020002051748117520481402155749832096007629686239669192722978473890311246293580246256300691145653885805730865515297134808702766299205253761028235483781919393575836334910012714628455073300114978717047912395404034141622115001451888302617428376998024080880564792294546406688814397757714979980790018933407614160131827023349206138480523080173634617167828920519758917549492886733519381497665596997617399404664611446202014908853898043742964782757859701755202188366852773164911994663079171498909577012208742001609095258401847</span></span><br><span class="line"><span class="comment"># c = 7802816471025387606454709075933309958303134972861203739854774032383575355964299097074709350633475519273512630813578801152996777689686451397201513854823239337669091889776200179028891111154423623765139235199507280104544068425347533121731521700106757148551520759776111224072064131087547685154285120156917449926992033491342535410929828988598182819897435365878832122138552492908774845437576910276499625679469289655841639181182040186931130789588869657335253479416209378458303531995734157105918063227453396477282662136225029972745246845372963076381252679409317314514131852117346576265346926741908194011319430767975281696400</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><ul>
<li>n分不出来，没有p、q，无法直接有限域开方</li>
<li>e=3，维纳无效，低e攻击跑了很久没结果</li>
</ul>
<p>觉得能利用的只有m末尾的<code>b&#39;\x00&#39; * (l - 2)</code>，但🤔想不出，没见过，实在不知如何利用</p>
<p>看其他师傅的<a target="_blank" rel="noopener" href="https://www.aisoutu.com/a/2109167">题解</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/Harry0597/Imag@master/uPic/image-20220513165548541.png" alt="破题点"></p>
<p>🐮啊.</p>
<p>但I=86，I-2不是84吗？(确实是师傅着急写错了)</p>
<p>我领悟</p>
<p>不知道p、q就断然不是有限域开方</p>
<p><strong>e=3,只能对应低e攻击</strong></p>
<p>再由以上规律，得：</p>
<p>$m = (flag)•16^{2•84}$</p>
<p>$c = m^e \mod n = flag^3 • 16^{2•3•84}\mod n$</p>
<p>$c’ = c•inv(16^{2•3•84}, n) \mod n = flag^3 \mod n $</p>
<p>将c改小后，简单的低加密指数即可解！</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">import</span> gmpy2</span><br><span class="line"><span class="built_in">import</span> libnum</span><br><span class="line"><span class="comment"># m越长越不利于爆破出结果</span></span><br><span class="line"></span><br><span class="line">def de(c, e, n):</span><br><span class="line">    <span class="attr">k</span> = <span class="number">0</span></span><br><span class="line">    while True:</span><br><span class="line">        print(k)</span><br><span class="line">        <span class="attr">mm</span> = c + n*k</span><br><span class="line">        result, <span class="attr">flag</span> = gmpy2.iroot(mm, e)</span><br><span class="line">        <span class="keyword">if</span> <span class="attr">True</span> == flag:</span><br><span class="line">            return result</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line"><span class="attr">e</span> = <span class="number">3</span></span><br><span class="line"><span class="attr">n</span> = <span class="number">23570098360097260908266914080954003513706885568390448463720576188146956287111601604870247233822682630020002051748117520481402155749832096007629686239669192722978473890311246293580246256300691145653885805730865515297134808702766299205253761028235483781919393575836334910012714628455073300114978717047912395404034141622115001451888302617428376998024080880564792294546406688814397757714979980790018933407614160131827023349206138480523080173634617167828920519758917549492886733519381497665596997617399404664611446202014908853898043742964782757859701755202188366852773164911994663079171498909577012208742001609095258401847</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">7802816471025387606454709075933309958303134972861203739854774032383575355964299097074709350633475519273512630813578801152996777689686451397201513854823239337669091889776200179028891111154423623765139235199507280104544068425347533121731521700106757148551520759776111224072064131087547685154285120156917449926992033491342535410929828988598182819897435365878832122138552492908774845437576910276499625679469289655841639181182040186931130789588869657335253479416209378458303531995734157105918063227453396477282662136225029972745246845372963076381252679409317314514131852117346576265346926741908194011319430767975281696400</span></span><br><span class="line"><span class="attr">A</span> = <span class="number">16</span>**(<span class="number">6</span>*<span class="number">84</span>)</span><br><span class="line">c *= int(gmpy2.invert(A, n))</span><br><span class="line"><span class="attr">c</span> = c % n  <span class="comment"># 容易忘，c不能比n大</span></span><br><span class="line"><span class="attr">m</span> = de(c,e,n)</span><br><span class="line">print(libnum.n2s(int(m)).decode())</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li><p><strong>byte后每加一个16进制的‘0’则扩大为原来的16倍</strong></p>
</li>
<li><p>对于低e攻击，<strong>flag越长爆破越久以至于失效</strong>，所以我们最好能降低flag长度</p>
</li>
</ul>
<h2 id="ctfshow-摆烂杯-比烂为主"><a href="#ctfshow-摆烂杯-比烂为主" class="headerlink" title="ctfshow 摆烂杯 比烂为主"></a>ctfshow 摆烂杯 比烂为主</h2><p>太长了，i‘m lazy dog</p>
<h2 id="ctfshow-卷王杯-真·简单·不卷·现代密码签到"><a href="#ctfshow-卷王杯-真·简单·不卷·现代密码签到" class="headerlink" title="ctfshow 卷王杯 真·简单·不卷·现代密码签到"></a>ctfshow 卷王杯 真·简单·不卷·现代密码签到</h2><h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import bytes_to_long</span><br><span class="line">from secrets import p,q,r,s,t,flag</span><br><span class="line"></span><br><span class="line">n = p * q * r * s * t</span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">m = bytes_to_long(os.urandom(<span class="number">500</span>) + flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line">print(p,q,r,s,t,sep=&#x27;\n&#x27;)</span><br><span class="line">print(c)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p, q, r, s, t = [<span class="number">14533236770094</span><span class="number">43037475489121</span><span class="number">60113939198078</span><span class="number">05143602947796</span><span class="number">03489683159139</span><span class="number">56664143693347</span><span class="number">22670260043860</span><span class="number">86939337681345</span><span class="number">75289286283267</span><span class="number">81072313789590</span><span class="number">31538290018262</span><span class="number">23446477799895</span><span class="number">49326542256234</span><span class="number">89170122167900</span><span class="number">77395795861238</span><span class="number">25735703515268</span><span class="number">78336390854157</span><span class="number">63850743538206</span><span class="number">98678141893973</span><span class="number">75117159577389</span><span class="number">82536382066693</span><span class="number">82215986070126</span>3,</span><br><span class="line"><span class="number">11666045825306</span><span class="number">76080440655233</span><span class="number">10547233337730</span><span class="number">58390213375609</span><span class="number">54733393900577</span><span class="number">38510707447906</span><span class="number">97118857721727</span><span class="number">48610473794040</span><span class="number">14140178165569</span><span class="number">60440446889771</span><span class="number">28468761084444</span><span class="number">68370709141219</span><span class="number">30229160140865</span><span class="number">27420062681860</span><span class="number">59762087155933</span><span class="number">13183732395267</span><span class="number">56279662998108</span><span class="number">91805398890428</span><span class="number">42057542516069</span><span class="number">65312366604809</span><span class="number">33905879208166</span><span class="number">09059148279476</span>3,</span><br><span class="line"><span class="number">15793172240285</span><span class="number">32454214362706</span><span class="number">09912823260313</span><span class="number">73094128315285</span><span class="number">64446419694032</span><span class="number">38646482562190</span><span class="number">53103839312408</span><span class="number">72325547547464</span><span class="number">64603598717356</span><span class="number">25557016608150</span><span class="number">15737273369772</span><span class="number">92059427220330</span><span class="number">16904461167497</span><span class="number">35697669668384</span><span class="number">98453232642731</span><span class="number">73795879170608</span><span class="number">69577622446869</span><span class="number">53294662693939</span><span class="number">60430086496163</span><span class="number">73255363793210</span><span class="number">27705854708492</span><span class="number">45333069070553</span>1,</span><br><span class="line"><span class="number">10097345168744</span><span class="number">95188547426737</span><span class="number">78783266158999</span><span class="number">45107205860634</span><span class="number">82220187978911</span><span class="number">47675959983616</span><span class="number">21000348447657</span><span class="number">76121344823119</span><span class="number">93701677242007</span><span class="number">75955695149438</span><span class="number">28330705633699</span><span class="number">64294544839433</span><span class="number">67108703759615</span><span class="number">97538252490189</span><span class="number">50693369209927</span><span class="number">95166777526708</span><span class="number">68961803957761</span><span class="number">50188902057785</span><span class="number">21476723065848</span><span class="number">72675872898099</span><span class="number">18132337927575</span><span class="number">67386856897667</span>9,</span><br><span class="line"><span class="number">93960345071948</span><span class="number">25523388212168</span><span class="number">36507975121293</span><span class="number">33868351496468</span><span class="number">89883473677044</span><span class="number">13987433007457</span><span class="number">03393838320587</span><span class="number">99895367825427</span><span class="number">22454003449285</span><span class="number">86394089488734</span><span class="number">27189754005167</span><span class="number">39966759736423</span><span class="number">47859306921527</span><span class="number">43085067333424</span><span class="number">34411801834609</span><span class="number">27865980713929</span><span class="number">78996358760854</span><span class="number">75548584912646</span><span class="number">14271309608925</span><span class="number">63427228229296</span><span class="number">40028976503550</span><span class="number">47792764365447</span>,</span><br><span class="line"><span class="number">91445979203817</span><span class="number">74885442906257</span><span class="number">31114946570229</span><span class="number">50572386009739</span><span class="number">73598305004391</span><span class="number">53461877036309</span><span class="number">85650745413847</span><span class="number">71979931799878</span><span class="number">38143926484813</span><span class="number">78103538584182</span><span class="number">00992191234142</span><span class="number">74019448957354</span><span class="number">03816811612193</span><span class="number">32611454834544</span><span class="number">29163462845625</span><span class="number">76701788434846</span><span class="number">98324641739324</span><span class="number">68749738801840</span><span class="number">62140416572783</span><span class="number">23855749902661</span><span class="number">75244879612251</span><span class="number">70619208805520</span><span class="number">11343608609622</span><span class="number">88578761723875</span><span class="number">87693989720099</span><span class="number">49575526258430</span><span class="number">28264881703909</span><span class="number">12847963305853</span><span class="number">49957724522615</span><span class="number">10510273593025</span><span class="number">89695621031122</span><span class="number">38020133587096</span><span class="number">82638602812847</span><span class="number">18523772255253</span><span class="number">57348919204333</span><span class="number">12169543266233</span><span class="number">94430043277489</span><span class="number">73224423132988</span><span class="number">37629884386205</span><span class="number">66310454882858</span><span class="number">59621661802413</span><span class="number">20179396288379</span><span class="number">49155135104679</span><span class="number">12312842687601</span><span class="number">47811704041901</span><span class="number">34680599837772</span><span class="number">73699192408773</span><span class="number">55180658145819</span><span class="number">73246200652105</span><span class="number">23913467414181</span><span class="number">48087528020358</span><span class="number">01470777890638</span><span class="number">08832356486197</span><span class="number">27137661588322</span><span class="number">15582655910692</span><span class="number">23727607585313</span><span class="number">24024361951552</span><span class="number">11806004351141</span><span class="number">31162272519949</span><span class="number">10146408993544</span><span class="number">12517514266834</span><span class="number">47701142156416</span><span class="number">86611362712676</span><span class="number">59196410340429</span><span class="number">27519834229168</span><span class="number">53633195227569</span><span class="number">81225115027451</span><span class="number">77547569813354</span><span class="number">28056582837296</span><span class="number">87038101588578</span><span class="number">59460406828090</span><span class="number">19968332476095</span><span class="number">61056829025771</span><span class="number">89283246483314</span><span class="number">68936557086221</span><span class="number">74073331032433</span><span class="number">36691401424548</span><span class="number">70238787640922</span><span class="number">89772784986912</span><span class="number">00028282744239</span><span class="number">51209137311011</span><span class="number">17921772289798</span><span class="number">67318546462714</span><span class="number">52129625693837</span><span class="number">46186362065657</span><span class="number">91541769138267</span><span class="number">08078984240079</span><span class="number">69732267338169</span><span class="number">39794717596194</span><span class="number">09023242568850</span><span class="number">48902343049776</span><span class="number">12220790858557</span><span class="number">63924636743774</span><span class="number">09754954500116</span><span class="number">76714198668471</span><span class="number">43881429968932</span><span class="number">52088822619184</span><span class="number">60708833888406</span><span class="number">18791252734662</span><span class="number">89128949210597</span><span class="number">35420931656953</span><span class="number">23656017890918</span><span class="number">05873725894569</span><span class="number">26690219114173</span><span class="number">19320204833217</span><span class="number">25385644896604</span><span class="number">40225377822914</span><span class="number">09742080795778</span><span class="number">42017850241660</span><span class="number">11709377791129</span>]</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h3><p>易得，n的所有因子均为素数</p>
<p>小e，起初想把除p、q外的因子合并集体忽略一试，后发现m很大<code>m = bytes_to_long(os.urandom(500) + flag)</code>,无果</p>
<p>后使用不太熟悉的脚本来有限域开方,得解</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本2</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = 2</span><br><span class="line">p, q, r, s, t, c = (145332367700944303747548912160113939198078051436029477960348968315913956664143693347226702600438608693933768134575289286283267810723137895903153829001826223446477799895493265422562348917012216790077395795861238257357035152687833639085415763850743538206986781418939737511715957738982536382066693822159860701263,</span><br><span class="line">116660458253067608044065523310547233337730583902133756095473339390057738510707447906971188577217274861047379404014140178165569604404468897712846876108444468370709141219302291601408652742006268186059762087155933131837323952675627966299810891805398890428420575425160696531236660480933905879208166090591482794763,</span><br><span class="line">157931722402853245421436270609912823260313730941283152856444641969403238646482562190531038393124087232554754746464603598717356255570166081501573727336977292059427220330169044611674973569766966838498453232642731737958791706086957762244686953294662693939604300864961637325536379321027705854708492453330690705531,</span><br><span class="line">100973451687449518854742673778783266158999451072058606348222018797891147675959983616210003484476577612134482311993701677242007759556951494382833070563369964294544839433671087037596159753825249018950693369209927951667775267086896180395776150188902057785214767230658487267587289809918132337927575673868568976679,</span><br><span class="line">93960345071948255233882121683650797512129333868351496468898834736770441398743300745703393838320587998953678254272245400344928586394089488734271897540051673996675973642347859306921527430850673334243441180183460927865980713929789963587608547554858491264614271309608925634272282292964002897650355047792764365447,</span><br><span class="line">9144597920381774885442906257311149465702295057238600973973598305004391534618770363098565074541384771979931799878381439264848137810353858418200992191234142740194489573540381681161219332611454834544291634628456257670178843484698324641739324687497388018406214041657278323855749902661752448796122517061920880552011343608609622885787617238758769398972009949575526258430282648817039091284796330585349957724522615105102735930258969562103112238020133587096826386028128471852377225525357348919204333121695432662339443004327748973224423132988376298843862056631045488285859621661802413201793962883794915513510467912312842687601478117040419013468059983777273699192408773551806581458197324620065210523913467414181480875280203580147077789063808832356486197271376615883221558265591069223727607585313240243619515521180600435114131162272519949101464089935441251751426683447701142156416866113627126765919641034042927519834229168536331952275698122511502745177547569813354280565828372968703810158857859460406828090199683324760956105682902577189283246483314689365570862217407333103243336691401424548702387876409228977278498691200028282744239512091373110111792177228979867318546462714521296256938374618636206565791541769138267080789842400796973226733816939794717596194090232425688504890234304977612220790858557639246367437740975495450011676714198668471438814299689325208882261918460708833888406187912527346628912894921059735420931656953236560178909180587372589456926690219114173193202048332172538564489660440225377822914097420807957784201785024166011709377791129)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">f</span>=a^e-c</span><br><span class="line"><span class="attribute">mps</span>=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">g</span>=a^e-c</span><br><span class="line"><span class="attribute">mqs</span>=g.monic().roots()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># r</span></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(r),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">f</span>=a^e-c</span><br><span class="line"><span class="attribute">mrs</span>=f.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="comment"># s</span></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(s),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">f</span>=a^e-c</span><br><span class="line"><span class="attribute">mss</span>=f.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="comment"># t</span></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(t),<span class="attribute">implementation</span>=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="attribute">f</span>=a^e-c</span><br><span class="line"><span class="attribute">mts</span>=f.monic().roots()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    A = mpp[0]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        B = mqq[0]</span><br><span class="line">        <span class="keyword">for</span> mrr <span class="keyword">in</span> mrs:</span><br><span class="line">            C = mrr[0]</span><br><span class="line">            <span class="keyword">for</span> mss <span class="keyword">in</span> mss:</span><br><span class="line">                D = mss[0]</span><br><span class="line">                <span class="keyword">for</span> mtt <span class="keyword">in</span> mts:</span><br><span class="line">                    E = mtt[0]</span><br><span class="line">                    solution = CRT_list([int(A), int(B), int(C), int(D), int(E)], [p, q, r, s, t])</span><br><span class="line">                    flag = str(libnum.n2s(int(solution)))</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                        <span class="builtin-name">print</span>(flag)</span><br><span class="line">                        break</span><br><span class="line">                break</span><br><span class="line">            break</span><br><span class="line">        break</span><br><span class="line">    break</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">&#x27;恭喜！&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ctfshow{D0_y0u_R3aLly_Kn0w_Ra8IN_alg0RI7HM?}’</p>
</blockquote>
<p>惭愧，e=2确实应该优先考虑rabin的🤔</p>
<h2 id="安徽省赛·Cross-Fire"><a href="#安徽省赛·Cross-Fire" class="headerlink" title="安徽省赛·Cross_Fire"></a>安徽省赛·Cross_Fire</h2><ul>
<li>题目与题解来自<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Sentry-InkCity/p/15484426.html">Sentry_InkCity 师傅</a></li>
</ul>
<h3 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n,n2s</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(plaintext)&gt;<span class="number">128</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m=s2n(plaintext)</span><br><span class="line">p=getPrime(<span class="number">500</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">r=getPrime(<span class="number">1024</span>)</span><br><span class="line">hint1=p*q*r</span><br><span class="line">hint2=next_prime(p)*next_prime(q)*next_prime(r)</span><br><span class="line">n=next_prime(<span class="number">123</span>*p+<span class="number">456</span>)*next_prime(<span class="number">233</span>*q+<span class="number">233</span>)*next_prime(<span class="number">666</span>*r+<span class="number">666</span>)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint1=&quot;</span>,hint1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint2=&quot;</span>,hint2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">hint1= 66597706438052968602907975635364474124624609040691375744383573309100970537667852695911406578339583406993354597653539587007399024156000284162006381513057917653763467490913961403796256103799712489840324677890516295291754752667080587689619591977796148937147026181153407872286012339573004262967216008992456987530280248046317633785368985937352761743401538167742790063446090181640923337990535120783172231525752911772643973809736013911022053243030289179238536988831429875919863032051710061637295482848897179403927441453047333367742504111531477527219109139209305898423562329209375385774722090035022238350104808001927840789351874748994613148197348389169808276135120368108948370654768586592518609889834086412071206692748953099899446867217942417300125520378227882738726940028929</span></span><br><span class="line"><span class="string">hint2= 66597706438052968602907975635364474124624609040691375744383573309100970537667852695911406578339583406993354597653539587007399024156000284162006381519250037838090700817357286993539595751890863552857025186501118668940000586180857161834771657275281213521087010590085823066429019242511957345355841205805490396285530197202608369351669705515187871274740384884445010749950651326231261308185878145343225072286358030343013074077614396504748731540529394175170653286604110001303387433196918194353309815286558369700754725062771941489664316582212235229725924291159030267475029526286194732206037792356401019048507530494720324382797923052122766854647054667572207470351698834488250064200327557388850421313632751275068766021705342276955127790709872384961830995521889674866200643581197</span></span><br><span class="line"><span class="string">e= 65537</span></span><br><span class="line"><span class="string">n= 1271143363426234578109032622706784368982452702551117975547220359092039459949589311614475250751670324493441017909825758822014002389769016887770094631267325830636300148439767061540517538240094507617502786636783685853116121519909167755693185341466272016646232460012649033718198945340871434729792726475237884312244749128647675044166254114409979208613136490968091271215324179363007030770031883104198634577994666369930225951242263540549447415742095183638116238138212512007206154136596565735565134655180583298422538746349678634986942613303728294063886412713958813109459261894779056221585991240656450995515329105180293668452080201635903397760758605883754955173299769359099672851020901544947845931039456152020654355740641530636597180573996251235682717406311406638139251493213898068501</span></span><br><span class="line"><span class="string">c= 1216485134271178449567116916754420573073303455397620989326464150108908572336526711707238151485187836142308657852844139181641136164876989706372528330194558764108985905734554870749686706876362171680539349216110583849976294434959121174943229853669205013854742739444539161076289486434305028669545715151531610132849739705231210851708893517910447015945450432744842995436173783966889593804335503774508824344205419870078981016701436069437155486571657204182510954434683255699530711440688659074538879785922444601494725802905576491078834520957416860895991743319707987718280613091465577249499325647665822748760483739502978877174961037108839466736686647462799492964587695553596641935803152814769663732674949417986994233658218593205643014847168221928973615157533648368075119704854913178864</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h3><p>太🥬了，没有任何思路</p>
<p>看了师傅题解后，发现搁置的知识点突然攻击我</p>
<p><strong>以连分素数为基础的维纳攻击</strong></p>
<ul>
<li><p>连分素数分解出p</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N1= <span class="number">66597706438052968602907975635364474124624609040691375744383573309100970537667852695911406578339583406993354597653539587007399024156000284162006381513057917653763467490913961403796256103799712489840324677890516295291754752667080587689619591977796148937147026181153407872286012339573004262967216008992456987530280248046317633785368985937352761743401538167742790063446090181640923337990535120783172231525752911772643973809736013911022053243030289179238536988831429875919863032051710061637295482848897179403927441453047333367742504111531477527219109139209305898423562329209375385774722090035022238350104808001927840789351874748994613148197348389169808276135120368108948370654768586592518609889834086412071206692748953099899446867217942417300125520378227882738726940028929</span></span><br><span class="line">N2= <span class="number">1271143363426234578109032622706784368982452702551117975547220359092039459949589311614475250751670324493441017909825758822014002389769016887770094631267325830636300148439767061540517538240094507617502786636783685853116121519909167755693185341466272016646232460012649033718198945340871434729792726475237884312244749128647675044166254114409979208613136490968091271215324179363007030770031883104198634577994666369930225951242263540549447415742095183638116238138212512007206154136596565735565134655180583298422538746349678634986942613303728294063886412713958813109459261894779056221585991240656450995515329105180293668452080201635903397760758605883754955173299769359099672851020901544947845931039456152020654355740641530636597180573996251235682717406311406638139251493213898068501</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">continuedFra</span>(<span class="params">x, y</span>):</span> <span class="comment">#不断生成连分数的项</span></span><br><span class="line">    cF = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cF += [x // y]</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cF</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Simplify</span>(<span class="params">ctnf</span>):</span> <span class="comment">#化简</span></span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> ctnf[::-<span class="number">1</span>]: <span class="comment">#注意这里是倒叙遍历</span></span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> (numerator, denominator) <span class="comment">#把连分数分成分子和算出来的分母</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getit</span>(<span class="params">c</span>):</span></span><br><span class="line">    cf=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(c)):</span><br><span class="line">        cf.append(Simplify(c[:i])) <span class="comment">#各个阶段的连分数的分子和分母</span></span><br><span class="line">    <span class="keyword">return</span> cf <span class="comment">#得到一串连分数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wienerAttack</span>(<span class="params">e, n</span>):</span></span><br><span class="line">    cf=continuedFra(e,n)</span><br><span class="line">    <span class="keyword">for</span> (Q2,Q1) <span class="keyword">in</span> getit(cf):<span class="comment">#遍历得到的连分数，令分子分母分别是Q2，Q1</span></span><br><span class="line">        <span class="keyword">if</span> Q1 == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> N1%Q1==<span class="number">0</span> <span class="keyword">and</span> Q1!=<span class="number">1</span>:<span class="comment">#满足这个条件就找到了</span></span><br><span class="line">            <span class="keyword">return</span> Q1</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;not find!&#x27;</span>)</span><br><span class="line">Q1=wienerAttack(N1,N2)</span><br><span class="line"><span class="built_in">print</span>(Q1)</span><br></pre></td></tr></table></figure>
</li>
<li><p>相邻素数<strong>爆破</strong>求解q、r</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">q = <span class="built_in">Symbol</span>(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">r = <span class="built_in">Symbol</span>(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">qr = <span class="number">24000465830725710567609789107532324217407562259754653134149621603287774548503009977306790950765445986759457303910590756566445763189685864660421027894624160496364130162710203056019260859349197460287247433237333855820008311336990774902044072459096643794460636549390819914523204123744097150936438700304426418945328341075502713761684579112067780970129462407486292351679441221444463557410246953331098106055732155261630435421138374418050504535474800628754964367103623724936338041432343848497819682915988508211563927368529558866912220856126132024687748646133065560766894641603193094511181987021442275364527221213343560893411</span></span><br><span class="line">qr1 =  <span class="number">24000465830725710567609789107532324217407562259754653134149621603287774548503009977306790950765445986759457303910590756566445763189685864660421027894624160496364130162710203056019260859349197460287247433237333855820008311336990774902044072459096643794460636549390819914523204123744097150936438700304426419195181206357035254463948831711777035126077563377919684721062749439252724456974588213705559491260601777470792467850627398598289093915869715222818079606170004475810187367332322557611964471968738992807153326972570559359950761752890888829934863609591544119615229826879764045397320279541476417371138268264031865992001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">if</span> i %<span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">5000</span>):</span><br><span class="line">        <span class="keyword">if</span> j %<span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> solve([q * r -qr,(q + i) * (r + j) - qr1],[q,r]) != []:</span><br><span class="line">            <span class="built_in">print</span>(solve([q * r -qr,(q + i) * (r + j) - qr1],[q,r]))</span><br><span class="line">        <span class="keyword">if</span> j % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;i=&quot;</span>,i,<span class="string">&quot;   j=&quot;</span>,j)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
</ul>
<h4 id="疑惑"><a href="#疑惑" class="headerlink" title="疑惑"></a>疑惑</h4><ul>
<li>连分素数（维纳攻击）的适用条件与具体原理</li>
<li>相邻素数爆破可太久了，有没有更好的解决方式？</li>
</ul>
<h2 id="BUU·-INSHack2017-rsa16m"><a href="#BUU·-INSHack2017-rsa16m" class="headerlink" title="BUU·[INSHack2017]rsa16m"></a>BUU·<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[INSHack2017]rsa16m">[INSHack2017]rsa16m</a></h2><h3 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h3><ul>
<li><p>给了组巨大的n、c</p>
</li>
<li><p>e=65537</p>
</li>
</ul>
<h3 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h3><p>由$m^e \mod n= c$且m较小可知：</p>
<p>$m^e &lt; n$,所以：$c = m^e$,即：$m = c^{1/e}$</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="title">with</span> open(&#x27;rsa_16m.txt&#x27;) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="class"><span class="keyword">data</span> = f.readlines()</span></span><br><span class="line">    n = int(<span class="class"><span class="keyword">data</span>[0].split(&#x27;= &#x27;)[-1], 16)</span></span><br><span class="line">    c = int(<span class="class"><span class="keyword">data</span>[1].split(&#x27;= &#x27;)[-1], 16)</span></span><br><span class="line">    e = int(<span class="class"><span class="keyword">data</span>[2].split(&#x27;= &#x27;)[-1], 16)</span></span><br><span class="line">    # m^e = c</span><br><span class="line">    m = int(gmpy2.iroot(c, e)[<span class="number">0</span>])</span><br><span class="line">    print(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>17年出的题，当时应该挺新颖有趣的哈哈。</p>
<p>而解题思路在低e攻击中有所体现</p>
<h2 id="Common"><a href="#Common" class="headerlink" title="Common"></a>Common</h2><h3 id="题目-大致"><a href="#题目-大致" class="headerlink" title="题目(大致)"></a>题目(大致)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">m1 = flag[<span class="number">21</span>:]</span><br><span class="line">m2 = flag[:<span class="number">21</span>]</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e1, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e2, n)</span><br><span class="line"><span class="comment"># e1 =  28720970875923431651096339432854172528258265954461865674640550905460254396153781189674547341687577425387833579798322688436040388359600753225864838008717449960738481507237546818409576080342018413998438508242156786918906491731633276138883100372823397583184685654971806498370497526719232024164841910708290088581</span></span><br><span class="line"><span class="comment"># e2 =  131021266002802786854388653080729140273443902141665778170604465113620346076511262124829371838724811039714548987535108721308165699613894661841484523537507024099679248417817366537529114819815251239300463529072042548335699747397368129995809673969216724195536938971493436488732311727298655252602350061303755611563</span></span><br><span class="line"><span class="comment"># n =  159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781117564072817251103154968492955749973403646311198170703330345340987100788144707482536112028286039187104750378366564167383729662815980782817121382587188922253</span></span><br><span class="line"><span class="comment"># c1 =  125774545911886560112703402972153322080506025378797523936708278181480201146872577291738201370911792392950418121767343486509724963000477466590009600240375221563806039364611362947152096656513910712238094956240996452246301471555709823003175801134035094856941903678067489942047840663479442285170087613352040341832</span></span><br><span class="line"><span class="comment"># c2 =  125874844114757588984441500491946737723620819049276461078841545869549114013042058416210220287667061892072831243333341942699313440553285306436999725802970995457080384300690875762412008576026273931144721166609563493297003298586115510199518494430188305644317422640652955882264990001338974742192006748451975507803</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h3><p>看到common，脑子里只有共模攻击，可悲</p>
<p>仔细看会发现，有两个m，<strong>不满足共模攻击</strong>（n, m相同）</p>
<p>去la佬RSA总结里找，找对了代码，居然只会照搬，事后看wp觉得自己连个合格的脚本小子都不是😢</p>
<p>先贴一下题解</p>
<p><strong>多组低解密指数攻击</strong></p>
<ul>
<li>求phi</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e1 =  <span class="number">28720970875923431651096339432854172528258265954461865674640550905460254396153781189674547341687577425387833579798322688436040388359600753225864838008717449960738481507237546818409576080342018413998438508242156786918906491731633276138883100372823397583184685654971806498370497526719232024164841910708290088581</span></span><br><span class="line">e2 =  <span class="number">131021266002802786854388653080729140273443902141665778170604465113620346076511262124829371838724811039714548987535108721308165699613894661841484523537507024099679248417817366537529114819815251239300463529072042548335699747397368129995809673969216724195536938971493436488732311727298655252602350061303755611563</span></span><br><span class="line">N =  <span class="number">159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781117564072817251103154968492955749973403646311198170703330345340987100788144707482536112028286039187104750378366564167383729662815980782817121382587188922253</span></span><br><span class="line">c1 =  <span class="number">125774545911886560112703402972153322080506025378797523936708278181480201146872577291738201370911792392950418121767343486509724963000477466590009600240375221563806039364611362947152096656513910712238094956240996452246301471555709823003175801134035094856941903678067489942047840663479442285170087613352040341832</span></span><br><span class="line">c2 =  <span class="number">125874844114757588984441500491946737723620819049276461078841545869549114013042058416210220287667061892072831243333341942699313440553285306436999725802970995457080384300690875762412008576026273931144721166609563493297003298586115510199518494430188305644317422640652955882264990001338974742192006748451975507803</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>):</span><br><span class="line">    alpha2 = i/<span class="number">1000</span></span><br><span class="line">    M1 = <span class="built_in">int</span>(gmpy2.mpz(N)**<span class="number">0.5</span>)</span><br><span class="line">    M2 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1</span>+alpha2) ) </span><br><span class="line">    D = diagonal_matrix(ZZ, [N, M1, M2, <span class="number">1</span>])</span><br><span class="line">    B = Matrix(ZZ, </span><br><span class="line">               [ [<span class="number">1</span>, -N,   <span class="number">0</span>,  N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>, e1, -e1, -e1*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,  e2, -e2*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>, e1*e2] ]) * D</span><br><span class="line">    L = B.LLL()</span><br><span class="line">    v = Matrix(ZZ, L[<span class="number">0</span>])</span><br><span class="line">    x = v * B**(-<span class="number">1</span>)</span><br><span class="line">    phi = (x[<span class="number">0</span>,<span class="number">1</span>]/x[<span class="number">0</span>,<span class="number">0</span>]*e1).floor()</span><br><span class="line">    <span class="built_in">print</span>(phi)</span><br></pre></td></tr></table></figure>

<ul>
<li>求m1、m2</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e1 =  <span class="number">28720970875923431651096339432854172528258265954461865674640550905460254396153781189674547341687577425387833579798322688436040388359600753225864838008717449960738481507237546818409576080342018413998438508242156786918906491731633276138883100372823397583184685654971806498370497526719232024164841910708290088581</span></span><br><span class="line">e2 =  <span class="number">131021266002802786854388653080729140273443902141665778170604465113620346076511262124829371838724811039714548987535108721308165699613894661841484523537507024099679248417817366537529114819815251239300463529072042548335699747397368129995809673969216724195536938971493436488732311727298655252602350061303755611563</span></span><br><span class="line">n =  <span class="number">159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781117564072817251103154968492955749973403646311198170703330345340987100788144707482536112028286039187104750378366564167383729662815980782817121382587188922253</span></span><br><span class="line">c1 =  <span class="number">125774545911886560112703402972153322080506025378797523936708278181480201146872577291738201370911792392950418121767343486509724963000477466590009600240375221563806039364611362947152096656513910712238094956240996452246301471555709823003175801134035094856941903678067489942047840663479442285170087613352040341832</span></span><br><span class="line">c2 =  <span class="number">125874844114757588984441500491946737723620819049276461078841545869549114013042058416210220287667061892072831243333341942699313440553285306436999725802970995457080384300690875762412008576026273931144721166609563493297003298586115510199518494430188305644317422640652955882264990001338974742192006748451975507803</span></span><br><span class="line">phi = <span class="number">159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781092330556185082570865052488981154655643850588559740031994465378408628749828052127213663711396922494795088638471519778995496857305118321851028470398469453660</span></span><br><span class="line">d1 = <span class="built_in">int</span>(gmpy2.invert(e1, phi))</span><br><span class="line">d2 = <span class="built_in">int</span>(gmpy2.invert(e2, phi))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(c1, d1, n))).decode() + libnum.n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(c2, d2, n))).decode())</span><br></pre></td></tr></table></figure>

<h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><p>因为$d = inv(e, phi)$，所以$ed = k•\phi + 1$，即：$d = \frac{k•\phi +1}{e}$</p>
<p>而e真的很大（正常就65537），想来d就大不了，即：<strong>低解密指数</strong></p>
<ul>
<li>低加密指数广播攻击需要给出e</li>
<li>多组低解密指数攻击不需要（也不能给出d）</li>
</ul>
<h2 id="CBCTF-·-check-in"><a href="#CBCTF-·-check-in" class="headerlink" title="CBCTF · check in"></a>CBCTF · check in</h2><h3 id="题目-7"><a href="#题目-7" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">from sympy import isprime,nextprime</span><br><span class="line">from Crypto.Util.number import getPrime as getprime ,long_to_bytes,bytes_to_long,inverse</span><br><span class="line">from vanish import flag</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def Getprime(g):</span><br><span class="line"> while True:</span><br><span class="line">     p=g*random.randint(<span class="number">1</span>,g)+<span class="number">1</span></span><br><span class="line">     if isprime(p):</span><br><span class="line">         return p</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">g=getprime(<span class="number">512</span>)</span><br><span class="line">p=Getprime(g)</span><br><span class="line">q=Getprime(g)</span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">def lcm(a,b):</span><br><span class="line"> return (a*b)/gcd(a,b)</span><br><span class="line"></span><br><span class="line">print &#x27;lcm(p-1,q-1): %d&#x27;%(lcm(p-<span class="number">1</span>,q-<span class="number">1</span>))</span><br><span class="line">print &#x27;n: %d&#x27;%(p*q)</span><br><span class="line">print &#x27;c: %d&#x27;%(<span class="built_in">pow</span>(m,e,p*q))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">lcm(p-1,q-1): <span class="number">29222879530390</span><span class="number">78574260547774</span><span class="number">24534209029911</span><span class="number">75027283185502</span><span class="number">22457400590398</span><span class="number">62631690962406</span><span class="number">56898659768251</span><span class="number">13117015324335</span><span class="number">58965851162065</span><span class="number">46809026765977</span><span class="number">24039834384184</span><span class="number">44139320224862</span><span class="number">39027317290376</span><span class="number">87897026754970</span><span class="number">51302933523560</span><span class="number">70399197681533</span><span class="number">77464180992024</span><span class="number">57922773864183</span><span class="number">38948725614463</span><span class="number">60542260845098</span><span class="number">19464450297183</span><span class="number">69662946357705</span><span class="number">49928182336250</span><span class="number">83970076966359</span><span class="number">82211082237545</span><span class="number">03785162149872</span><span class="number">12352918853377</span><span class="number">20080893169582</span><span class="number">69978029470880</span><span class="number">43347867588786</span><span class="number">24750037193583</span><span class="number">88640472814681</span><span class="number">538094520154</span>0</span><br><span class="line">n: <span class="number">22285828148883</span><span class="number">22539771891137</span><span class="number">73397118125709</span><span class="number">79007008842697</span><span class="number">80928959802985</span><span class="number">61527528834111</span><span class="number">16203166857885</span><span class="number">11492461651695</span><span class="number">42869710055411</span><span class="number">30375554688818</span><span class="number">95905318207963</span><span class="number">27453758953234</span><span class="number">51661338200896</span><span class="number">94201148988443</span><span class="number">49651475107485</span><span class="number">79661360411573</span><span class="number">36680322417272</span><span class="number">18377740935159</span><span class="number">72689086256775</span><span class="number">12781049274972</span><span class="number">32576950095975</span><span class="number">52980046434070</span><span class="number">23188886359792</span><span class="number">41164818358288</span><span class="number">89792197856539</span><span class="number">27285023667015</span><span class="number">99092944199206</span><span class="number">13674483651230</span><span class="number">92899330885934</span><span class="number">80101341113217</span><span class="number">35509549389615</span><span class="number">20075931155848</span><span class="number">84399182472372</span><span class="number">71872976634200</span><span class="number">31211934554344</span><span class="number">56893317117917</span><span class="number">52377227169713</span><span class="number">90081142435747</span><span class="number">79627269811809</span><span class="number">73378035593163</span><span class="number">19210494963021</span><span class="number">25838661328536</span><span class="number">02396623549535</span><span class="number">52369582646607</span></span><br><span class="line">c: <span class="number">22011068530185</span><span class="number">81355094419701</span><span class="number">17199773103684</span><span class="number">37500819167035</span><span class="number">04266002782698</span><span class="number">73128831769054</span><span class="number">62423363458907</span><span class="number">02261049147276</span><span class="number">08404727129322</span><span class="number">73149691531380</span><span class="number">29180802403349</span><span class="number">98051905085769</span><span class="number">94727203334003</span><span class="number">48342466190619</span><span class="number">77824778467435</span><span class="number">92717365692750</span><span class="number">19018808569614</span><span class="number">56688081374561</span><span class="number">95855292921556</span><span class="number">39979431043005</span><span class="number">51190554834576</span><span class="number">76854723407632</span><span class="number">30813956617014</span><span class="number">12276847727223</span><span class="number">65184670640161</span><span class="number">33244646900977</span><span class="number">04195984879357</span><span class="number">98348487735480</span><span class="number">18337874928875</span><span class="number">04655072115457</span><span class="number">56525286418503</span><span class="number">15494384644468</span><span class="number">80605802181260</span><span class="number">37484412461927</span><span class="number">57443085386516</span><span class="number">15581433730768</span><span class="number">12759224735643</span><span class="number">25028703523754</span><span class="number">31907211720208</span><span class="number">32181999612501</span><span class="number">57611091952832</span><span class="number">03836639332227</span><span class="number">51948339270356</span><span class="number">39232266868638</span></span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="题解-8"><a href="#题解-8" class="headerlink" title="题解"></a>题解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lcm=<span class="number">29222879530390785742605477742453420902991175027283185502224574005903986263169096240656898659768251131170153243355896585116206546809026765977240398343841844413932022486239027317290376878970267549705130293352356070399197681533774641809920245792277386418338948725614463605422608450981946445029718369662946357705499281823362508397007696635982211082237545037851621498721235291885337720080893169582699780294708804334786758878624750037193583886404728146815380945201540</span></span><br><span class="line">n=<span class="number">2228582814888322539771891137733971181257097900700884269780928959802985615275288341111620316685788511492461651695428697100554113037555468881895905318207963274537589532345166133820089694201148988443496514751074857966136041157336680322417272183777409351597268908625677512781049274972325769500959755298004643407023188886359792411648183582888979219785653927285023667015990929441992061367448365123092899330885934801013411132173550954938961520075931155848843991824723727187297663420031211934554344568933171179175237722716971390081142435747796272698118097337803559316319210494963021258386613285360239662354953552369582646607</span></span><br><span class="line">c=<span class="number">2201106853018581355094419701171997731036843750081916703504266002782698731288317690546242336345890702261049147276084047271293227314969153138029180802403349980519050857699472720333400348342466190619778247784674359271736569275019018808569614566880813745619585529292155639979431043005511905548345767685472340763230813956617014122768477272236518467064016133244646900977041959848793579834848773548018337874928875046550721154575652528641850315494384644468806058021812603748441246192757443085386516155814337307681275922473564325028703523754319072117202083218199961250157611091952832038366393322275194833927035639232266868638</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,lcm)  <span class="comment"># 事实上，lcm乘多少都可以</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<h3 id="同态加密"><a href="#同态加密" class="headerlink" title="同态加密"></a>同态加密</h3><ul>
<li><a target="_blank" rel="noopener" href="https://jayxv.github.io/2020/05/14/密码学学习笔记之paillier%20cryptosystem/">参考</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="keyword">as</span> getprime ,long_to_bytes,bytes_to_long,inverse</span><br><span class="line"><span class="keyword">from</span> vanish <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> isprime,nextprime</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getprime(<span class="number">512</span>)  <span class="comment"># 酱紫写？？</span></span><br><span class="line">q=nextprime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">r=random.randint(<span class="number">1</span>,n)</span><br><span class="line">g=random.randint(<span class="number">1</span>,n)</span><br><span class="line"></span><br><span class="line">c=(<span class="built_in">pow</span>(g,m,n*n)*<span class="built_in">pow</span>(r,n,n*n))%(n*n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;c=%d&quot;</span>%(c)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;n=%d&quot;</span>%(n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;g=%d&quot;</span>%(g)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=14643617840485727260687883789514337554960495078025159182484344940901600090810578182116617501128323641882943106663241094886209190199404002314247096613925999812837877843566116787148411743428714726661042213165729562285577768043368385746666607442372252641495230532588344276427261824205414379772728577442269620217619275</span></span><br><span class="line"><span class="string">n=5650215343715484415924649393302012617620686312875699289646188186788806118580423414401283971780836312947326343790326120926819026727018136169739576760024802083</span></span><br><span class="line"><span class="string">g=786539430846729749998127835613552594423101498023741082894370020014675937062722533682541592019332908209917194089077366019472368764411032602494945304850258108</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>$c = （g^m \mod n^2）*（r^n \mod n^2）\mod n^2 = g^m * r^n \mod n^2$</p>
<p>给c、n、g</p>
<blockquote>
<p>Paillier密码，于1999年由Pascal Paillier发明，是一种用于公钥加密的概率非对称算法。该算法具有加法同态的性质 ; 这意味着，仅给出公钥和m1、m2加密，可以计算出m1 + m2</p>
</blockquote>
<h5 id="模式1"><a href="#模式1" class="headerlink" title="模式1"></a>模式1</h5><ol>
<li>大素数p、q满足$gcd(pq, (p-1)*(q-1)) = 1$</li>
<li>$n=p\cdot q，λ = lcm(p-1, q-1) = \frac{(p-1)\cdot (q-1) }{ gcd(p-1,q-1)}$</li>
<li>选g,  $0&lt;g&lt;n^2$</li>
<li>$L(x) = \frac{x-1}{n}$</li>
<li>$μ = (L(g^λ \pmod {n^2} ))^{-1} \pmod n$</li>
<li>公钥：（n, g）</li>
<li>私钥：（λ，μ）</li>
</ol>
<h5 id="模式2"><a href="#模式2" class="headerlink" title="模式2"></a>模式2</h5><p>在模式1的基础上，改写g，λ，μ</p>
<ol>
<li>$g=n+1$</li>
<li>$λ = φ(n) = (p-1)\cdot (q-1)$</li>
<li>$μ = φ(n)^{-1} \pmod n$</li>
</ol>
<h5 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h5><ol>
<li><p>明文m需要满足$0≤m＜n$</p>
</li>
<li><p>选择随机 r，且满足$gcd(r,n)=1$</p>
</li>
<li><p>密文：$c=g^m⋅r^n(\mod n^2)$</p>
</li>
</ol>
<h5 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h5><p>$m = ( L( c^λ \pmod {n^2} ) \cdot μ ) \pmod n$</p>
<h3 id="题解-9"><a href="#题解-9" class="headerlink" title="题解"></a>题解</h3><p>分解n,得到p、q </p>
<p>然后跟着解密步骤解就完事了</p>
<p>🤔但p的bit数好像根题目不符</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="constructor">L(<span class="params">x</span>)</span>:</span><br><span class="line">    return (x - <span class="number">1</span>) <span class="comment">// n</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">14643617840485727260687883789514337554960495078025159182484344940901600090810578182116617501128323641882943106663241094886209190199404002314247096613925999812837877843566116787148411743428714726661042213165729562285577768043368385746666607442372252641495230532588344276427261824205414379772728577442269620217619275</span></span><br><span class="line">n = <span class="number">5650215343715484415924649393302012617620686312875699289646188186788806118580423414401283971780836312947326343790326120926819026727018136169739576760024802083</span></span><br><span class="line">g = <span class="number">786539430846729749998127835613552594423101498023741082894370020014675937062722533682541592019332908209917194089077366019472368764411032602494945304850258108</span></span><br><span class="line"># print(factor(n))</span><br><span class="line">p = <span class="number">521</span></span><br><span class="line">q = <span class="number">10844943078148722487379365438199640340922622481527253914867923583087919613398125555472713957352852807960319277908495433640727498516349589577235272092178123</span></span><br><span class="line">la = ((p - <span class="number">1</span>)<span class="operator"> * </span>(q - <span class="number">1</span>)) <span class="comment">// int(gmpy2.gcd(p - 1, q - 1))</span></span><br><span class="line">tmp = <span class="constructor">L(<span class="params">int</span>(<span class="params">pow</span>(<span class="params">g</span>, <span class="params">la</span>, <span class="params">n</span> <span class="operator">**</span> 2)</span>))</span><br><span class="line">miu = <span class="built_in">int</span>(gmpy2.invert(tmp, n))</span><br><span class="line">m = (<span class="constructor">L(<span class="params">int</span>(<span class="params">pow</span>(<span class="params">c</span>, <span class="params">la</span>, <span class="params">n</span> <span class="operator">**</span> 2)</span>)<span class="operator"> * </span>miu)) % n</span><br><span class="line">print(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h3 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h3><p>同态加密基于rsa的<strong>大素数分解难题</strong>，能得到p、q又有公钥就可解</p>
<h2 id="HZNUCTF校赛·math1"><a href="#HZNUCTF校赛·math1" class="headerlink" title="HZNUCTF校赛·math1"></a>HZNUCTF校赛·math1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">phi = n - p - q + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">m = p * getPrime(<span class="number">135</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m, phi * getPrime(<span class="number">69</span>) + <span class="number">1</span>, n)</span><br><span class="line">flag = <span class="string">b&quot;HZNUCTF&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(m).encode()).hexdigest().encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p ^ q ^ x = <span class="subst">&#123;p ^ q ^ getPrime(<span class="number">100</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># n = 27963651181285314865245223420841376949170358907033350824157378307987529217967991046373794961962733982506983121192630829109141085046224889488610665139200726263728575086325474153370048617139175155262273813416260466529090140061623799460692881049637337480902401228983124051195350877685069281198499676151295387541487095621386248400085706944431571931100086046020193927566333993198580530464009149542183771408158783932309677038461604312997489255869750091721432213923367520176509845949128808520689563162109940702067960753814992404492253609346481785015501090495665364667572730774672925265663102438782954524410643148314614834421</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># c = 4112542234772265176907045140450105601374470669674397930575891050044126457030160166683760719042621526735064403906550294282692637793834725289405872203962576032128609572771779107747278189191796105964591794849874405525188273203917555992638684936192155868595119909648305108899175081741865334855359578531440348739274118813283368968474494522365300464616479</span></span><br><span class="line"><span class="comment"># p ^ q ^ x = 20322403539370874641338228395838205584791500136939852001791339832796937713367291083719519539069010591274070142977525555745107989472468046373764089233806857920378983806258439075231320039084798858470920027262481032484629504006942867681413153495094107614132308526877912014998940951049975837247629492037044418733</span></span><br></pre></td></tr></table></figure>

<h3 id="题解-10"><a href="#题解-10" class="headerlink" title="题解"></a>题解</h3><p>将<code>phi * getPrime(69) + 1</code>当作e，由逆元定义，易得：d=1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = </span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,<span class="number">1</span>, n))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = <span class="string">b&quot;HZNUCTF&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(m).encode()).hexdigest().encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;HZNUCTF&#123;a664dad27b1a4bf0dd56f71bba4a8b1d&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Cop-Run"><a href="#Cop-Run" class="headerlink" title="Cop! Run!!"></a>Cop! Run!!</h2><h3 id="题目-8"><a href="#题目-8" class="headerlink" title="题目"></a>题目</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">n = <span class="number">1</span> &lt;&lt; <span class="number">8</span></span><br><span class="line">p = getPrime(n)</span><br><span class="line">print(p)</span><br><span class="line"></span><br><span class="line">P.&lt;t&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = t * t + randrange(p)</span><br><span class="line">print(f)</span><br><span class="line"></span><br><span class="line">x = [randrange(p)]</span><br><span class="line">x += [f(x[<span class="number">0</span>])]</span><br><span class="line">print([x_ &gt;&gt; (n - ceil(<span class="number">5</span> * n / <span class="number">7</span>)) for x_ in x])</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">y = f(x[-<span class="number">1</span>])</span><br><span class="line">for i in range(<span class="number">7</span>):</span><br><span class="line">    y = f(y)</span><br><span class="line">    flag ^^= int(y)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"><span class="number">92946459607669</span><span class="number">93751377410225</span><span class="number">00572952497185</span><span class="number">93723232674702</span><span class="number">21285428735887</span><span class="number">313578</span>3</span><br><span class="line">t^2 + <span class="number">43844336985235</span><span class="number">86373441963163</span><span class="number">04259153882987</span><span class="number">91521868754583</span><span class="number">03290471864433</span><span class="number">311559</span>0</span><br><span class="line">[<span class="number">32486428330566</span><span class="number">35029095920782</span><span class="number">09562633794911</span><span class="number">359211649526</span>6, <span class="number">48839352219196</span><span class="number">23989344404485</span><span class="number">02547934602810</span><span class="number">168278179039</span>2]</span><br><span class="line"><span class="number">19320752909712</span><span class="number">57937786625190</span><span class="number">51231322609402</span><span class="number">86615581991593</span><span class="number">35983673951023</span><span class="number">13904490702547</span>833</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="题解-11"><a href="#题解-11" class="headerlink" title="题解"></a>题解</h3><ul>
<li>二元Coppersmith乱杀</li>
</ul>
<p>（根据题目构造好函数求低位就可以利用二元Coppersmith求得x列表</p>
<ul>
<li>flag解密过程与加密过程一致</li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SageMath</span></span><br><span class="line"><span class="attribute">load</span>(&#x27;coppersmith.sage&#x27;)</span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"><span class="attribute">n</span> = <span class="number">1</span> &lt;&lt; <span class="number">8</span></span><br><span class="line"><span class="attribute">bits</span> = n - ceil(<span class="number">5</span> * n / <span class="number">7</span>)</span><br><span class="line"><span class="attribute">p</span> = <span class="number">92946459607669937513774102250057295249718593723232674702212854287358873135783</span></span><br><span class="line"><span class="attribute">P</span>.&lt;x<span class="number">0</span>_<span class="number">0</span>, x<span class="number">1</span>_<span class="number">0</span>&gt; = PolynomialRing(Zmod(p))</span><br><span class="line"><span class="attribute">tmp</span> = <span class="number">43844336985235863734419631630425915388298791521868754583032904718644333115590</span></span><br><span class="line"><span class="attribute">x0_1</span> = <span class="number">3248642833056635029095920782095626337949113592116495266</span> &lt;&lt; bits</span><br><span class="line"><span class="attribute">x1_1</span> = <span class="number">4883935221919623989344404485025479346028101682781790392</span> &lt;&lt; bits</span><br><span class="line"><span class="attribute">f</span> = (x<span class="number">0</span>_<span class="number">1</span>+x<span class="number">0</span>_<span class="number">0</span>)**<span class="number">2</span> + tmp - (x<span class="number">1</span>_<span class="number">1</span>+x<span class="number">1</span>_<span class="number">0</span>)</span><br><span class="line"><span class="attribute">x0_0</span>, x<span class="number">1</span>_<span class="number">0</span> = small_roots(f, (<span class="number">2</span>^bits, <span class="number">2</span>^bits), <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="attribute">x0</span> = x<span class="number">0</span>_<span class="number">1</span> + int(x<span class="number">0</span>_<span class="number">0</span>)</span><br><span class="line"><span class="attribute">x1</span> = x<span class="number">1</span>_<span class="number">1</span> + int(x<span class="number">1</span>_<span class="number">0</span>)</span><br><span class="line"><span class="attribute">x</span> =<span class="meta"> [x0, x1]</span></span><br><span class="line"><span class="attribute">flag</span> = <span class="number">193207529097125793778662519051231322609402866155819915933598367395102313904490702547833</span></span><br><span class="line"><span class="attribute">P</span>.&lt;t&gt; = PolynomialRing(Zmod(p))</span><br><span class="line"><span class="attribute">f</span> = t * t + tmp</span><br><span class="line"><span class="attribute">y</span> = f(x[-<span class="number">1</span>])</span><br><span class="line"><span class="attribute">for</span> i in range(<span class="number">7</span>):</span><br><span class="line">    <span class="attribute">y</span> = f(y)</span><br><span class="line">    <span class="attribute">flag</span> ^^= int(y)</span><br><span class="line"><span class="attribute">print</span>(libnum.n<span class="number">2</span>s(int(flag)))</span><br></pre></td></tr></table></figure>

<h2 id="NSSCTF·-强网杯-2019-copperstudy"><a href="#NSSCTF·-强网杯-2019-copperstudy" class="headerlink" title="NSSCTF·[强网杯 2019]copperstudy"></a>NSSCTF·[强网杯 2019]copperstudy</h2><p>模版套娃题</p>
<p>（NSSCTF复现的有些问题，可能存在代码对了没结果的情况，做的颇为费时</p>
<h3 id="题目-9"><a href="#题目-9" class="headerlink" title="题目"></a>题目</h3><p>只给了靶机地址与端口, 连接后开始挑战</p>
<h3 id="题解-12"><a href="#题解-12" class="headerlink" title="题解"></a>题解</h3><ul>
<li><p>sha256爆破</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(base) wenhui@<span class="symbol">Harrys</span>-<span class="symbol">MacBook</span>-<span class="symbol">Pro</span> ~ <span class="comment">% nc 1.14.71.254 28406</span></span><br><span class="line">[+]proof: skr=os.urandom(<span class="number">8</span>)</span><br><span class="line">[+]hashlib.sha256(skr).hexdigest()=<span class="number">67328</span>fdbc950d58d6194a09ca7ad2751d5cdef2e75d4bd57cd9f06d5813f0ad0</span><br><span class="line">[+]skr[<span class="number">0</span>:<span class="number">5</span>].encode(<span class="string">&#x27;hex&#x27;</span>)=e2130d4e25</span><br><span class="line">[-]skr.encode(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line">e2130d4e254fd917</span><br><span class="line">proof completed</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">data</span>):</span></span><br><span class="line">    s = hashlib.sha256()  <span class="comment"># Get the hash algorithm.</span></span><br><span class="line">    s.update(data)  <span class="comment"># Hash the data.</span></span><br><span class="line">    b = s.hexdigest()  <span class="comment"># Get he hash value.</span></span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sha = <span class="string">&#x27;323b72a6cd69d0b7780ec5a7f5ca467888cab27ddd2e4aa4e60b73a94e12c77d&#x27;</span></span><br><span class="line">hex5 = <span class="string">&#x27;190a2e347c&#x27;</span></span><br><span class="line">hex5 = hex5.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line">table = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">skr = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table, repeat=<span class="number">3</span>):</span><br><span class="line">    i = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">    skr = hex5 + i</span><br><span class="line">    <span class="built_in">print</span>(skr)</span><br><span class="line">    skr_ = decry(skr)</span><br><span class="line">    <span class="keyword">if</span> skr_ == sha:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;OK&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(skr.encode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>已知m高位</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[+]</span>Generating challenge <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>n=<span class="number">24356325449465878008573189069822683605566325207916003425572312871257434066735339351419022606651978564409319854124040390674260674732564840194350117020415343008229943042334102640238880933567550793561550749967150961083366558936482352374990331852259346471621770085261320898538402590645945335446391581595043991636430048371479572927936823346342473370679940627084184474965268493672815645510317544641300573456793341459261030239478468256474697145442446703874239050652733363969490084736015234648029721030296379935311207385820508381103059781709196062980850466538106046617857536788261456423074851392626599614225296568220684082233</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>e=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>m=random<span class="selector-class">.getrandbits</span>(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>c=pow(m,e,n)=<span class="number">279116358436840581010075391425636114595316473734626962378925974945912936713312369021195130534903624351919224866669072204225138654025018245713127331395303380222577110932576056933575781802632335925559470076545360667419161465650880040669969136201922200324547177017394013299202303169894435173</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>((m&gt;&gt;<span class="number">72</span>)&lt;&lt;<span class="number">72</span>)=<span class="number">653524334392227601010919065348707977696937791058152587391549467964777834749978354872413711237120</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[-]</span>long_to_bytes(m)<span class="selector-class">.encode</span>(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>e53534354467b39323534303365663262613837316331313365623038353131363636356631347d</span><br><span class="line">challenge1 completed</span><br></pre></td></tr></table></figure>



</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">17641791540530228694286135185364074270246417140538172343866345466143247980659455424376045685494166279876110132203178803899115680922576583783724143783790241934890713111735488241729348106606502962464794620278410346388397359673075821123140990941942289674002895075430115017639376231448894324816030053817634283366169122125231411123494823295007054961127500058834017497105743260495984200175488365511990260484741462938371341033116032935020587367904271953619183649263518669540687237751562870973258276042987062056763970912250995314217713966476714492906919554248815811082015216774212685970371820986012163337575801128737022100901</span></span><br><span class="line">mbar = <span class="number">653524334392227600317610369760395325667407883325756386751869881379847068844170310055337360621568</span></span><br><span class="line">c = <span class="number">279116358436840580121751323591931874995783037840229208462822785113356478604601761572940996937612929433055849494515561733423792677427130977192018567922037737644911574834397373382160864107212935056196095912820832399095116695115669158974901004546975979648317608777413620402597811562020634469</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">kbits = <span class="number">72</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">f = (mbar + x) ^ e - c</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">1</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor = n</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(mbar) + <span class="built_in">int</span>(x0)).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>

<ul>
<li><p>已知p高位</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[+]</span>Generating challenge <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>n=<span class="number">23411615301291435655477801748625769339716407033511189983098780086891046009303028158463324140747944603588215418067393823094137876411379397381410031095697696292166476032512871410272768379677559567972276031538034846795245203959238906540111544506685078584531349272589770893813281618844530003255759935566936903284897174521506447857387462971045194978917820434934738691829707246515997926007217221181797932139498440604926293194444820566068160382363378745057906848008922430323300850797214158795943526446652900363836595788985435156443232660016272234951129406706808949692152532652106869678988356843173692120312556632060687880277</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>m=random<span class="selector-class">.getrandbits</span>(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>c=pow(m,e,n)=<span class="number">20816687484629729248358599515200912090054626605187551167120440993080422432047195669753081296607778685789965152636292757077874182391701553297762409167922636195265302544331699555007035722696233758502329524496584833047661025920311619881120186355000799849110094937608332808435206343994582498338158558465886308617345046792992841949660056279285857662920319320845051388660815881694032340263668979130325615050235744767268030400030419743994149379045928464190406672664167865665901137911387554138311249666942277285098274888564033164491871776333496136941304304822482118466906618116810675882818933948662360186284886643033894106033</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>((p&gt;&gt;<span class="number">128</span>)&lt;&lt;<span class="number">128</span>)=<span class="number">168129018477669834191979662452833171533865381169326621445539439928300089595715365788571138946327251430738085293790548033554213639388233113347470851361022852297671479442101374855849510028550686558156349265097691151737089307186764069936608051965694418753664327625349371264720709116711249000736290817929925099520</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[-]</span>long_to_bytes(m)<span class="selector-class">.encode</span>(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>e53534354467b63653832653937626262333535616338353030303563306234336335306232357d</span><br><span class="line">challenge2 completed</span><br></pre></td></tr></table></figure>



</li>
</ul>
  <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="attribute">import</span> libnum, gmpy<span class="number">2</span></span><br><span class="line"><span class="attribute">c</span> = <span class="number">11137144779427596512325170685147473562579382171362503478475347640064577221517156636753228911996179961656510854973657786717656831471849897729940758053634217813748772532744785202527028799463823823951772911580724026290152964384253894559215344542770992252528792774895912147793520115570149507132169954672432261296536921008916861400631531765187550047503023916993544848424696991248835704817941853830044856268328430457918271247908784305049525074525029765749136180181560277025886732703297510912964179476813614319822496848845364727714491057767489809429555415276322397248388069790294482714516847353457868720649928392324385783659</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">20830947925132665202608201476543152873707285891221124190904503664462033960785788367156025547382844076879484108425075427999117558274080485370433894095168224986681460752870638969251201797984438385751454853811849334656135699018814782166761946734037568555000233999876021096147306660374648595995387615158849254147278615137349869283097560770056763007765458447973952497550521101298016814755832737137678555795393691003900822094504217885765408832692854710255311214322215461040107114896262753620554174647040295543768855026488354367051909095849614827812242316337627929542206753163951992499102075017588133211511519442589868399209</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attribute">kbit</span> = <span class="number">128</span></span><br><span class="line"><span class="attribute">p0</span> = <span class="number">118940119210016317990045155801100877489358068423123091575907183556540755690934705051716625103536230858583816920450205621200746207520769560428951671838067737785302213169572869149358081263673577776906772000439883491594209298392583037331881591354747527243747594112438728757721325095719043772720836197132036734976</span></span><br><span class="line"><span class="attribute">PR</span>.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"><span class="attribute">f</span> = p<span class="number">0</span>+x</span><br><span class="line"><span class="attribute">x</span> = f.small_roots(X=<span class="number">2</span>^kbit, beta=<span class="number">0</span>.<span class="number">4</span>)</span><br><span class="line"><span class="comment"># [1543502407706049247756460709245532058042364294454474880044105, 420644368256035122521364007269668769246032840480767531547935]</span></span><br><span class="line"><span class="attribute">p</span> = p<span class="number">0</span>+int(x[<span class="number">0</span>])</span><br><span class="line"><span class="attribute">q</span> = n // p</span><br><span class="line"><span class="attribute">d</span> = int(gmpy<span class="number">2</span>.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br><span class="line"><span class="attribute">m</span> = int(pow(c, d, n))</span><br><span class="line"><span class="attribute">print</span>(libnum.n<span class="number">2</span>s(m).hex())</span><br></pre></td></tr></table></figure>

<ul>
<li><p>给了d低位，但跑不出来，用低e攻击秒出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[+]</span>Generating challenge <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>n=<span class="number">89773856865647532789133848688372646776565366548252598781217905632498934212599593153200577780255807845681796915152934480943076563244617360693170810625153463474211910134539180021228359564467810301969996364868063052147561336853528490258438355476747407405146293273491444021091430384405451231994292618908534380557</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>e=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>m=random<span class="selector-class">.getrandbits</span>(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>c=pow(m,e,n)=<span class="number">279116358436840586974709590248388946576516187502518179576988811874767402972588315731516153520734651957821612329831372799017402780741995987375258636667865079100987795289407232620878830630802280166734640423706695819192808948526182697434731647473235541700077832678666281560894630034271897701</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>d&amp;((<span class="number">1</span>&lt;&lt;<span class="number">512</span>)-<span class="number">1</span>)=<span class="number">49802280372024724635830244988989932315803129085391269518611260496201496486820364910639967526858055384357625463893876156338160967361580798877826917845419</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[-]</span>long_to_bytes(m)<span class="selector-class">.encode</span>(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>e53534354467b61663735633934373838343032666637646236383865613739623062383562617d</span><br><span class="line">challenge3 completed</span><br></pre></td></tr></table></figure>



</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="comment"># m越长越不利于爆破出结果</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">a,b = gmpy2.iroot(mm, e)</span></span><br><span class="line"><span class="string">a 为 mm开e次方的结果，b为是否刚好开得出来（True/False）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">de</span>(<span class="params">c, e, n</span>):</span></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        mm = c + n*k</span><br><span class="line">        result, flag = gmpy2.iroot(mm, e)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span> == flag:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">n=<span class="number">91046679824709970162166510393984349436507160355504054099795745710843918232291158893173392345202539943129024459721861867023537200311589378076393008186869632816007290025155710690087286079985123881126900629981074014645167000252730113633981429235819837855381591602381430468841314334641325933457672374936644601001</span></span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">c=<span class="number">279116358436840580418940102891469361711985570618086638410015681467792988932869992663175128601830997392899009434533165482291158081783499352092021651217760633821487767077178436162836170197174297227386919476479085259086862455979023948465984342333447127816627669958590898325507691223787985253</span></span><br><span class="line">m=de(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure>

<ul>
<li><p>低加密指数广播攻击</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge 4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">e</span>=3</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">m</span>=random.getrandbits(512)</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">n1</span>=124563768792509416008021985841989981753081792478825800792286148435153131654283140323871125343656088446362263151697679035960009773023601459103303176772978649138999131316408093332655524416277152851939729963632286727238149879320579508735328790324506013446484343697799236052707784724755318248649291652344571831589</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">c1</span>=pow(m,e,n1)=279116358436840587566517694780928913487931485947614234823704404472617434263815671470444622266041047403738401080570039104060390493635635368662340875816838891757569305641456773339288967618075926659958357128374510362586125506882728421087631651655548042939805790783968753171259731111234177125</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">n2</span>=84561797704957266384491892654217513080694101006520363876005508497555421491740438708265907215897849175263004958278087751419225733590045477508001930670477095753833707256639507434950981063366889326293773824286487630076834730686515093065667286594656088214885435486297779174231374502701401724440519010791267672247</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">c2</span>=pow(m,e,n2)=279116358436840587566517694780928913487931485947614234823704404472617434263815671470444622266041047403738401080570039104060390493635635368662340875816838891757569305641456773339288967618075926659958357128374510362586125506882728421087631651655548042939805790783968753171259731111234177125</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">n3</span>=68490468751767969355094121227532448791974100305463186385862867801481483238694557331841003069191634601446560572940776531299769320776951684806416392460319020564810717065235353421959188531834413019658113978451922955896227028787460869516167582878879171620869415099300899129116470300679216567233807270409324443567</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">c3</span>=pow(m,e,n3)=279116358436840587566517694780928913487931485947614234823704404472617434263815671470444622266041047403738401080570039104060390493635635368662340875816838891757569305641456773339288967618075926659958357128374510362586125506882728421087631651655548042939805790783968753171259731111234177125</span><br><span class="line"></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line">4e53534354467b65636238363236376433663162623736363732373431646635353930613463617d</span><br><span class="line">challenge4 completed</span><br></pre></td></tr></table></figure>



</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span>(<span class="params">ai, mi</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd, mi) == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n = [<span class="number">108736816241175665148273398258758080018960946338287263364569374726302196169162605670881735552997454446042995869651449282714639817085183228827146377987324938368188209657339192168670905752630070180008635819292194863047273313500409087217920196986541427006384815578060250088479783691454217221007011624615314023899</span>, <span class="number">125311072436452106223310243651666447263593613934983230425360328449529562394786242626857578081604150972806837244925660405048300400604492591126681020111390674731777377449723245786875368033901438466732844507365503701957616443294592677795315630591380298492356628165441987010153245453234081489921029340196899395331</span>,</span><br><span class="line">     <span class="number">145952553475400806121889743433836062205241126114628994131042124255411306520718902459725859533701853065633604102288257122762822143440371454643188884668825711330843803637043792113112949317335498541040720711359198080384919545170988381565195230298044019615673547840211274883413248354873966128295173063309521168793</span>]</span><br><span class="line">c = [<span class="number">279116358436840587095249496686254280407332053342087519248181392057376438009454609418875798499072335086788124425593780862179185140902876002463710935769268790619149829113441912759030007987894680912774697528843208252759906296795513540716051082272447068540992498830366255300897173712420417125</span>, <span class="number">279116358436840587095249496686254280407332053342087519248181392057376438009454609418875798499072335086788124425593780862179185140902876002463710935769268790619149829113441912759030007987894680912774697528843208252759906296795513540716051082272447068540992498830366255300897173712420417125</span>,</span><br><span class="line">     <span class="number">279116358436840587095249496686254280407332053342087519248181392057376438009454609418875798499072335086788124425593780862179185140902876002463710935769268790619149829113441912759030007987894680912774697528843208252759906296795513540716051082272447068540992498830366255300897173712420417125</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">#  五进制转十进制</span></span><br><span class="line"><span class="string">n1 = []</span></span><br><span class="line"><span class="string">c1 = []</span></span><br><span class="line"><span class="string">for each in n:</span></span><br><span class="line"><span class="string">    n1.append(int(str(each), 5))</span></span><br><span class="line"><span class="string">for each in c:</span></span><br><span class="line"><span class="string">    c1.append(int(str(each), 5))</span></span><br><span class="line"><span class="string">n = n1</span></span><br><span class="line"><span class="string">c = c1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用中国剩余定理求解</span></span><br><span class="line">m = gmpy2.iroot(CRT(c, n), e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>

<ul>
<li><p>明文线性相关</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge 5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">n</span>=21429425398210967707909628859942973537224436647532980230726493099305742824766270853929975972690303041909526001733991446303871137522439503328925032466304256374647359518452449746921513559066080682460078094776752212082321993409045104876731233286545426838926300103834290157528384506385481519688666000782856609900851612966748184414791450182758413018973605263391254135754688148513923482024316942640211588559652059925484962822975577587275910085801634523858135106240262529639244908508123451583901185630426915824725575396390698386609888739848106462455208373547256248127515773962595744124798303915247122445176133387866920105233</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">e</span>=7</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">m</span>=random.getrandbits(512)</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">c</span>=pow(m,e,n)=3913355162506843667079312859018190210750453812024216931887013212736340446942162694100894791135119403317486675866999568493278124809272327516322633309413823913596448870616331557266099673907258759210921465394812506017015841046660045982292478544487202676877585076443587857982785230839097210888481000514300634948079175019815712503927918346384686657080274822468346123329902364959230990767464857544305639690661300813431789147490002490485680400671384441342427462071211423204456959983657856469034361843518906932742755839477892090867737525818438595032896123389082695556216022212240001190090281258165331416657932822805874602168</span><br><span class="line"></span><br><span class="line">[+]<span class="attribute">x</span>=pow(m+1,e,n)=3913355162506843667079312859018190210750999153615046231990422792509829450409212168507688057410976245834264140419108113476107790991506117144211120541710779587327967147999832294267428915095580485615923712261506555190257352674496596197869320069747269797902622599010051829852374293544522141824192458083264555499712388195731657971351737292981358503624428934337287306553109606196697224316949028722924520843757990451867544386438405893429648867504042574932635621879182744390170108609387296218948392041657682468255953226052675102710060363708081291924114406497165841292907447536561975232950061358289722917586138566490502779459</span><br><span class="line"></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line">4e53534354467b66373736396634343634313131323264393431613034303630663635643966617d</span><br><span class="line">challenge5 completed</span><br></pre></td></tr></table></figure>



</li>
</ul>
  <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#脚本1</span></span><br><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="attribute">import</span> libnum</span><br><span class="line"><span class="attribute">def</span> attack(c<span class="number">1</span>, c<span class="number">2</span>, n, e):</span><br><span class="line">    <span class="attribute">PR</span>.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="comment"># replace a,b,c,d</span></span><br><span class="line">    <span class="attribute">g1</span> = (x)^e - c<span class="number">1</span></span><br><span class="line">    <span class="attribute">g2</span> = (x+<span class="number">1</span>)^e - c<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">def</span> gcd(g<span class="number">1</span>, g<span class="number">2</span>):</span><br><span class="line">        <span class="attribute">while</span> g<span class="number">2</span>:</span><br><span class="line">            <span class="attribute">g1</span>, g<span class="number">2</span> = g<span class="number">2</span>, g<span class="number">1</span> % g<span class="number">2</span></span><br><span class="line">        <span class="attribute">return</span> g<span class="number">1</span>.monic()</span><br><span class="line">    <span class="attribute">return</span> -gcd(g<span class="number">1</span>, g<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="attribute">c1</span> = <span class="number">7418469310902085437902845069810907325748187977112113013220980112424442407226613760137761252552648007440383331950784228115986488475925283144593824500894571405880353340364207514694865844222508784001099834491784492065366210845193614581254153562661925385483663311199429650248093515309902747077140513942599407673983337470272240847775515213386498877652829223938536140405276402077587122957982174528164436480795702083875459915633643501521880665049597701799478311622533919864653221378168651815325375699506672607343438523384457249220358586701209073706415789620321939705636356508188823859264169488961318134313316063366665910206</span></span><br><span class="line"><span class="attribute">c2</span> = <span class="number">7418469310902085437902845069810907325748733318702942313324389630211155769858788619682593335606609874466071236380121906106667783380907883818266786633397419722492444714853781910785481012125683973018650974770499567295703842779905172289953314716678797071300101083018194616487898334829834287716319231206235032949259157514750919737173561247151807407433293665350985762009700294101008050532709741770671530046518254092265430246868161574567969187502303931582046841847862821179049361509293491493411427903204699783947564964113915141948898374580142274167217290438324911526116560240686491037292687977366065861177410333052288211017</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">15369301775722059379429609723694490645255566936766905366291805492170763202593417656003920322518507848926288093010156491021125903284959504824779141231360967938816670520213388416181376350025270847161283019625359588420327428720596770506411481513335537892798306797489759059676798449378078117722107191381693669966064104766048590386108378235589500841522523925342214114615411024645758263462037005808907358130815114751124039909396193753673415118331184548463083765708917853412605088824688043832076082343772226366300855419378276186462741799922089994387916401407026411238770214496917807205333955808483034512681150324952200389371</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">7</span></span><br><span class="line"><span class="attribute">m1</span> = attack(c<span class="number">1</span>, c<span class="number">2</span>, n, e)</span><br><span class="line"><span class="attribute">print</span>(libnum.n<span class="number">2</span>s(int(m<span class="number">1</span>)).hex())</span><br></pre></td></tr></table></figure>

<ul>
<li><p>大e，Boneh Durfee攻击</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[+]</span>Generating challenge <span class="number">6</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>n=<span class="number">28433765123193272413937762328478900250760726527540970528301125490692394193031349424192977308025178980197573233532541331581039212649482368461209698222920253798119078082671456554327106356072755216440255350551249872704198183911243201154461425078130834820720266808857878403255335514633434963386337641056957575165904599192527874783819857605968879265626890622973853987796385119695123510693355367524397097570051202427674198944461737328738571947837456929308212464789234856571770942917129100514149090445032962309425666609028922888756077436344010090550110050333505553564704195272515880559514315921553383277840399836719879267731</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>d=random<span class="selector-class">.getrandbits</span>(<span class="number">1024</span>*<span class="number">0.270</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>e=invmod(d,phin)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>hex(e)=<span class="number">811064441382390422335857185171964973819180142301034110312988812579005103329415811219397407236358334135487556791344847049720438309636553312944761097650405633450388819857262840347127104523831328363719063788724868945425984301234811155086117303272342049043287977725138042272369408683842806781452249258950318980189467107669120017021224184673163673234831941754189977759548338864842058620085924302835065610153298473720275399826055185583261279983714863993762808707903048297439473962219973732254616170084914227048491750377156055199702452409838475535269005815857545489975713790116627357389141915361080713898345310344819398011</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>m=random<span class="selector-class">.getrandbits</span>(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span>c=pow(m,e,n)=<span class="number">2215549666936383194009635202892010085709856759041385283571550251738688341878837204412349600843761936463943527306046381600377509428569282671471506183509982449074173134639828628105390619414363248600509852727320877722437239205741142553919197277254271177715138457833445878021907118662246369477491944116273889264876060672674938035936224599859202705638000108999326600486767306332492774808128640611101750088219310107966545884546610768651618457937614209194972795161283251661411131762647432150736155121251925910033554158554435962239917000949778234952957874313580236210225985749573493184918938295299027272872552712367286649836</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[-]</span>long_to_bytes(m)<span class="selector-class">.encode</span>(<span class="string">&#x27;hex&#x27;</span>)=</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>e53534354467b35336232333561643933383663343862633564316639333961663233306130357d</span><br><span class="line">challenge6 completed</span><br><span class="line"></span><br><span class="line">NSSCTF&#123;<span class="number">43</span>de032b-<span class="number">1431</span>-<span class="number">4082</span>-a701-a198cc3dbe8e&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Boneh Durfee代码已分享过，此处略</span></span><br><span class="line"><span class="comment"># 但需要注意NSSCTF复现的有些问题，偶尔会分不出d，需要重开 ：  （</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">d = <span class="number">5415090862251732317442024436621547096348588561944422740935945311625453350444967843</span></span><br><span class="line">n=<span class="number">28433765123193272413937762328478900250760726527540970528301125490692394193031349424192977308025178980197573233532541331581039212649482368461209698222920253798119078082671456554327106356072755216440255350551249872704198183911243201154461425078130834820720266808857878403255335514633434963386337641056957575165904599192527874783819857605968879265626890622973853987796385119695123510693355367524397097570051202427674198944461737328738571947837456929308212464789234856571770942917129100514149090445032962309425666609028922888756077436344010090550110050333505553564704195272515880559514315921553383277840399836719879267731</span></span><br><span class="line">e=<span class="number">0x811064441382390422335857185171964973819180142301034110312988812579005103329415811219397407236358334135487556791344847049720438309636553312944761097650405633450388819857262840347127104523831328363719063788724868945425984301234811155086117303272342049043287977725138042272369408683842806781452249258950318980189467107669120017021224184673163673234831941754189977759548338864842058620085924302835065610153298473720275399826055185583261279983714863993762808707903048297439473962219973732254616170084914227048491750377156055199702452409838475535269005815857545489975713790116627357389141915361080713898345310344819398011</span></span><br><span class="line">c=<span class="number">2215549666936383194009635202892010085709856759041385283571550251738688341878837204412349600843761936463943527306046381600377509428569282671471506183509982449074173134639828628105390619414363248600509852727320877722437239205741142553919197277254271177715138457833445878021907118662246369477491944116273889264876060672674938035936224599859202705638000108999326600486767306332492774808128640611101750088219310107966545884546610768651618457937614209194972795161283251661411131762647432150736155121251925910033554158554435962239917000949778234952957874313580236210225985749573493184918938295299027272872552712367286649836</span></span><br><span class="line">m=<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>



</li>
</ul>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Harry0597
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://harry0597.com/2022/07/04/RSA%E5%88%B7%E9%A2%98/" title="RSA刷题">https://harry0597.com/2022/07/04/RSA刷题/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Writeup/" rel="tag"><i class="fa fa-tag"></i> Writeup</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/07/04/2022ACTF%E5%AF%86%E7%A0%81%E5%A4%8D%E7%8E%B0/" rel="prev" title="2022ACTF·密码复现">
      <i class="fa fa-chevron-left"></i> 2022ACTF·密码复现
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/07/07/CISCN2022%C2%B7Crypto/" rel="next" title="CISCN2022·Crypto">
      CISCN2022·Crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#funnyrsa1"><span class="nav-number">1.</span> <span class="nav-text">funnyrsa1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">1.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">1.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ctfshow%C2%B7EASYRSA"><span class="nav-number">2.</span> <span class="nav-text">ctfshow·EASYRSA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="nav-number">2.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-1"><span class="nav-number">2.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ctfshow%E5%A4%A7%F0%9F%90%AE%E6%9D%AF%C2%B7%E5%B0%8F%E4%BA%8C%E9%9A%BE%E5%BA%A6R54"><span class="nav-number">3.</span> <span class="nav-text">ctfshow大🐮杯·小二难度R54</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="nav-number">3.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-2"><span class="nav-number">3.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7"><span class="nav-number">3.3.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ctfshow-%E6%91%86%E7%83%82%E6%9D%AF-easy-peasy"><span class="nav-number">4.</span> <span class="nav-text">ctfshow 摆烂杯 easy-peasy</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="nav-number">4.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-3"><span class="nav-number">4.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">4.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ctfshow-%E6%91%86%E7%83%82%E6%9D%AF-%E6%AF%94%E7%83%82%E4%B8%BA%E4%B8%BB"><span class="nav-number">5.</span> <span class="nav-text">ctfshow 摆烂杯 比烂为主</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ctfshow-%E5%8D%B7%E7%8E%8B%E6%9D%AF-%E7%9C%9F%C2%B7%E7%AE%80%E5%8D%95%C2%B7%E4%B8%8D%E5%8D%B7%C2%B7%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E7%AD%BE%E5%88%B0"><span class="nav-number">6.</span> <span class="nav-text">ctfshow 卷王杯 真·简单·不卷·现代密码签到</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-4"><span class="nav-number">6.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-4"><span class="nav-number">6.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E5%BE%BD%E7%9C%81%E8%B5%9B%C2%B7Cross-Fire"><span class="nav-number">7.</span> <span class="nav-text">安徽省赛·Cross_Fire</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-5"><span class="nav-number">7.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-5"><span class="nav-number">7.2.</span> <span class="nav-text">题解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%96%91%E6%83%91"><span class="nav-number">7.2.1.</span> <span class="nav-text">疑惑</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BUU%C2%B7-INSHack2017-rsa16m"><span class="nav-number">8.</span> <span class="nav-text">BUU·[INSHack2017]rsa16m</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-6"><span class="nav-number">8.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-6"><span class="nav-number">8.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">8.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Common"><span class="nav-number">9.</span> <span class="nav-text">Common</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-%E5%A4%A7%E8%87%B4"><span class="nav-number">9.1.</span> <span class="nav-text">题目(大致)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-7"><span class="nav-number">9.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-2"><span class="nav-number">9.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CBCTF-%C2%B7-check-in"><span class="nav-number">10.</span> <span class="nav-text">CBCTF · check in</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-7"><span class="nav-number">10.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-8"><span class="nav-number">10.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86"><span class="nav-number">10.3.</span> <span class="nav-text">同态加密</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A8%A1%E5%BC%8F1"><span class="nav-number">10.3.0.1.</span> <span class="nav-text">模式1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A8%A1%E5%BC%8F2"><span class="nav-number">10.3.0.2.</span> <span class="nav-text">模式2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86"><span class="nav-number">10.3.0.3.</span> <span class="nav-text">加密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%AF%86"><span class="nav-number">10.3.0.4.</span> <span class="nav-text">解密</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-9"><span class="nav-number">10.4.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-3"><span class="nav-number">10.5.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HZNUCTF%E6%A0%A1%E8%B5%9B%C2%B7math1"><span class="nav-number">11.</span> <span class="nav-text">HZNUCTF校赛·math1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-10"><span class="nav-number">11.1.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cop-Run"><span class="nav-number">12.</span> <span class="nav-text">Cop! Run!!</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-8"><span class="nav-number">12.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-11"><span class="nav-number">12.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NSSCTF%C2%B7-%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-copperstudy"><span class="nav-number">13.</span> <span class="nav-text">NSSCTF·[强网杯 2019]copperstudy</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-9"><span class="nav-number">13.1.</span> <span class="nav-text">题目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-12"><span class="nav-number">13.2.</span> <span class="nav-text">题解</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Harry0597"
      src="/images/IMG_2550.JPG">
  <p class="site-author-name" itemprop="name">Harry0597</p>
  <div class="site-description" itemprop="description">Pondering'll do you wonders.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:1915885792@qq.com" title="E-Mail → mailto:1915885792@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>


      
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CS/" rel="tag">CS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-OS/" rel="tag">Mac OS</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Writeup/" rel="tag">Writeup</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">杂</a><span class="tag-list-count">6</span></li></ul>
              </canvas>
          </div>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harry0597</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.1m</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'SdJfKJYPhm2sNuw1OsouUSUC-MdYXbMMI',
      appKey     : '4pmiJGkm87YwJe40oBXXWYKM',
      placeholder: "评论，让思维碰撞",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://SdJfKJYP.api.lncldglobal.com'
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
